OBJECT Table 91 User Setup
{
  OBJECT-PROPERTIES
  {
    Date=10/22/21;
    Time=[ 3:26:56 AM];
    Modified=Yes;
    Version List=NAVW111.00.00.23572,SE0.60.18,TPZ2992,3187,3307;
  }
  PROPERTIES
  {
    OnInsert=VAR
               User@1000 : Record 2000000120;
             BEGIN
               IF "E-Mail" <> '' THEN
                 EXIT;
               IF "User ID" <> '' THEN
                 EXIT;
               User.SETRANGE("User Name","User ID");
               IF User.FINDFIRST THEN
                 "E-Mail" := COPYSTR(User."Contact Email",1,MAXSTRLEN("E-Mail"));
             END;

    OnDelete=VAR
               NotificationSetup@1000 : Record 1512;
             BEGIN
               NotificationSetup.SETRANGE("User ID","User ID");
               NotificationSetup.DELETEALL(TRUE);
             END;

    CaptionML=[ENU=User Setup;
               ESM=Configuraci¢n usuarios;
               FRC=Configuration des utilisateurs;
               ENC=User Setup];
    LookupPageID=Page119;
    DrillDownPageID=Page119;
  }
  FIELDS
  {
    { 1   ;   ;User ID             ;Code50        ;TableRelation=User."User Name";
                                                   OnValidate=VAR
                                                                UserMgt@1000 : Codeunit 418;
                                                              BEGIN
                                                                UserMgt.ValidateUserID("User ID");
                                                              END;

                                                   OnLookup=VAR
                                                              UserMgt@1000 : Codeunit 418;
                                                            BEGIN
                                                              UserMgt.LookupUserID("User ID");
                                                            END;

                                                   ValidateTableRelation=No;
                                                   DataClassification=EndUserIdentifiableInformation;
                                                   CaptionML=[ENU=User ID;
                                                              ESM=Id. usuario;
                                                              FRC=Code utilisateur;
                                                              ENC=User ID];
                                                   NotBlank=Yes }
    { 2   ;   ;Allow Posting From  ;Date          ;OnValidate=BEGIN
                                                                UserSetupManagement.CheckAllowedPostingDates("Allow Posting From","Allow Posting To");
                                                              END;

                                                   CaptionML=[ENU=Allow Posting From;
                                                              ESM=Permitir registro desde;
                                                              FRC=D‚but p‚riode report;
                                                              ENC=Allow Posting From] }
    { 3   ;   ;Allow Posting To    ;Date          ;OnValidate=BEGIN
                                                                UserSetupManagement.CheckAllowedPostingDates("Allow Posting From","Allow Posting To");
                                                              END;

                                                   CaptionML=[ENU=Allow Posting To;
                                                              ESM=Permitir registro hasta;
                                                              FRC=Fin p‚riode report;
                                                              ENC=Allow Posting To] }
    { 4   ;   ;Register Time       ;Boolean       ;CaptionML=[ENU=Register Time;
                                                              ESM=Registrar tiempo conexi¢n;
                                                              FRC=Registre temps;
                                                              ENC=Register Time] }
    { 10  ;   ;Salespers./Purch. Code;Code20      ;TableRelation=Salesperson/Purchaser;
                                                   OnValidate=VAR
                                                                UserSetup@1000 : Record 91;
                                                              BEGIN
                                                                IF "Salespers./Purch. Code" <> '' THEN BEGIN
                                                                  ValidateSalesPersonPurchOnUserSetup(Rec);
                                                                  UserSetup.SETCURRENTKEY("Salespers./Purch. Code");
                                                                  UserSetup.SETRANGE("Salespers./Purch. Code","Salespers./Purch. Code");
                                                                  IF UserSetup.FINDFIRST THEN
                                                                    ERROR(Text001,"Salespers./Purch. Code",UserSetup."User ID");
                                                                  UpdateSalesPerson;
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Salespers./Purch. Code;
                                                              ESM=C¢d. vendedor/comprador;
                                                              FRC=Code de repr‚sentant/d'achat;
                                                              ENC=Salespers./Purch. Code] }
    { 11  ;   ;Approver ID         ;Code50        ;TableRelation="User Setup"."User ID";
                                                   OnValidate=BEGIN
                                                                { //EB 2017 12/15/17 - matching old approval proccess
                                                                IF "Approver ID" = "User ID" THEN
                                                                  FIELDERROR("Approver ID");
                                                                  }
                                                              END;

                                                   OnLookup=VAR
                                                              UserSetup@1000 : Record 91;
                                                            BEGIN
                                                              { //EB 2017 12/15/17 - matching old approval proccess
                                                              UserSetup.SETFILTER("User ID",'<>%1',"User ID");
                                                              IF PAGE.RUNMODAL(PAGE::"Approval User Setup",UserSetup) = ACTION::LookupOK THEN
                                                                VALIDATE("Approver ID",UserSetup."User ID");
                                                              }
                                                            END;

                                                   DataClassification=EndUserIdentifiableInformation;
                                                   CaptionML=[ENU=Approver ID;
                                                              ESM=Id. aprobador;
                                                              FRC=Code approbateur;
                                                              ENC=Approver ID] }
    { 12  ;   ;Sales Amount Approval Limit;Integer;OnValidate=BEGIN
                                                                IF "Unlimited Sales Approval" AND ("Sales Amount Approval Limit" <> 0) THEN
                                                                  ERROR(Text003,FIELDCAPTION("Sales Amount Approval Limit"),FIELDCAPTION("Unlimited Sales Approval"));
                                                                IF "Sales Amount Approval Limit" < 0 THEN
                                                                  ERROR(Text005);
                                                              END;

                                                   CaptionML=[ENU=Sales Amount Approval Limit;
                                                              ESM=Importe l¡mite aprob. ventas;
                                                              FRC=Limite d'approbation de montant de vente;
                                                              ENC=Sales Amount Approval Limit];
                                                   BlankZero=Yes }
    { 13  ;   ;Purchase Amount Approval Limit;Integer;
                                                   OnValidate=BEGIN
                                                                IF "Unlimited Purchase Approval" AND ("Purchase Amount Approval Limit" <> 0) THEN
                                                                  ERROR(Text003,FIELDCAPTION("Purchase Amount Approval Limit"),FIELDCAPTION("Unlimited Purchase Approval"));
                                                                IF "Purchase Amount Approval Limit" < 0 THEN
                                                                  ERROR(Text005);
                                                              END;

                                                   CaptionML=[ENU=Purchase Amount Approval Limit;
                                                              ESM=Importe l¡mite aprob. compras;
                                                              FRC=Limite d'approbation de montant d'achat;
                                                              ENC=Purchase Amount Approval Limit];
                                                   BlankZero=Yes }
    { 14  ;   ;Unlimited Sales Approval;Boolean   ;OnValidate=BEGIN
                                                                IF "Unlimited Sales Approval" THEN
                                                                  "Sales Amount Approval Limit" := 0;
                                                              END;

                                                   CaptionML=[ENU=Unlimited Sales Approval;
                                                              ESM=Aprobaci¢n venta ilimitada;
                                                              FRC=Montant illimit‚ de vente autoris‚;
                                                              ENC=Unlimited Sales Approval] }
    { 15  ;   ;Unlimited Purchase Approval;Boolean;OnValidate=BEGIN
                                                                IF "Unlimited Purchase Approval" THEN
                                                                  "Purchase Amount Approval Limit" := 0;
                                                              END;

                                                   CaptionML=[ENU=Unlimited Purchase Approval;
                                                              ESM=Aprobaci¢n compra ilimitada;
                                                              FRC=Montant illimit‚ d'achat autoris‚;
                                                              ENC=Unlimited Purchase Approval] }
    { 16  ;   ;Substitute          ;Code50        ;TableRelation="User Setup"."User ID";
                                                   OnValidate=BEGIN
                                                                IF Substitute = "User ID" THEN
                                                                  FIELDERROR(Substitute);
                                                              END;

                                                   OnLookup=VAR
                                                              UserSetup@1000 : Record 91;
                                                            BEGIN
                                                              UserSetup.SETFILTER("User ID",'<>%1',"User ID");
                                                              IF PAGE.RUNMODAL(PAGE::"Approval User Setup",UserSetup) = ACTION::LookupOK THEN
                                                                VALIDATE(Substitute,UserSetup."User ID");
                                                            END;

                                                   DataClassification=EndUserIdentifiableInformation;
                                                   CaptionML=[ENU=Substitute;
                                                              ESM=Sustituir;
                                                              FRC=Substitut;
                                                              ENC=Substitute] }
    { 17  ;   ;E-Mail              ;Text100       ;OnValidate=VAR
                                                                MailManagement@1000 : Codeunit 9520;
                                                              BEGIN
                                                                UpdateSalesPerson;
                                                                MailManagement.ValidateEmailAddressField("E-Mail");
                                                              END;

                                                   ExtendedDatatype=E-Mail;
                                                   CaptionML=[ENU=E-Mail;
                                                              ESM=Correo electr¢nico;
                                                              FRC=Courriel;
                                                              ENC=E-Mail] }
    { 19  ;   ;Request Amount Approval Limit;Integer;
                                                   OnValidate=BEGIN
                                                                IF "Unlimited Request Approval" AND ("Request Amount Approval Limit" <> 0) THEN
                                                                  ERROR(Text003,FIELDCAPTION("Request Amount Approval Limit"),FIELDCAPTION("Unlimited Request Approval"));
                                                                IF "Request Amount Approval Limit" < 0 THEN
                                                                  ERROR(Text005);
                                                              END;

                                                   CaptionML=[ENU=Request Amount Approval Limit;
                                                              ESM=Imp. l¡m. aprob. solic. compra;
                                                              FRC=Limite d'approbation de demande d'achat;
                                                              ENC=Request Amount Approval Limit];
                                                   BlankZero=Yes }
    { 20  ;   ;Unlimited Request Approval;Boolean ;OnValidate=BEGIN
                                                                IF "Unlimited Request Approval" THEN
                                                                  "Request Amount Approval Limit" := 0;
                                                              END;

                                                   CaptionML=[ENU=Unlimited Request Approval;
                                                              ESM=Aprob. solic. compra ilimitada;
                                                              FRC=Montant illimit‚ de demande d'achat autoris‚;
                                                              ENC=Unlimited Request Approval] }
    { 21  ;   ;Approval Administrator;Boolean     ;OnValidate=VAR
                                                                UserSetup@1000 : Record 91;
                                                              BEGIN
                                                                IF "Approval Administrator" THEN BEGIN
                                                                  UserSetup.SETRANGE("Approval Administrator",TRUE);
                                                                  IF NOT UserSetup.ISEMPTY THEN
                                                                    FIELDERROR("Approval Administrator");
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Approval Administrator;
                                                              ESM=Administrador aprobaci¢n;
                                                              FRC=Administrateur approbation;
                                                              ENC=Approval Administrator] }
    { 31  ;   ;License Type        ;Option        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(User."License Type" WHERE (User Name=FIELD(User ID)));
                                                   CaptionML=[ENU=License Type;
                                                              ESM=Tipo de licencia;
                                                              FRC=Type licence;
                                                              ENC=Licence Type];
                                                   OptionCaptionML=[ENU=Full User,Limited User,Device Only User,Windows Group,External User;
                                                                    ESM=Usuario completo,Usuario limitado,Usuario solo dispositivo,Grupo Windows,Usuario externo;
                                                                    FRC=Utilisateur complet,Utilisateur limit‚,Utilisateur avec p‚riph‚rique uniquement,Groupe Windows,Utilisateur externe;
                                                                    ENC=Full User,Limited User,Device Only User,Windows Group,External User];
                                                   OptionString=Full User,Limited User,Device Only User,Windows Group,External User }
    { 950 ;   ;Time Sheet Admin.   ;Boolean       ;CaptionML=[ENU=Time Sheet Admin.;
                                                              ESM=Admin. parte horas;
                                                              FRC=Admin. feuille de temps;
                                                              ENC=Time Sheet Admin.] }
    { 5600;   ;Allow FA Posting From;Date         ;CaptionML=[ENU=Allow FA Posting From;
                                                              ESM=A/F Permitir registro desde;
                                                              FRC=Autoriser report immo. de;
                                                              ENC=Allow FA Posting From] }
    { 5601;   ;Allow FA Posting To ;Date          ;CaptionML=[ENU=Allow FA Posting To;
                                                              ESM=A/F Permitir registro hasta;
                                                              FRC=Autoriser report immo. …;
                                                              ENC=Allow FA Posting To] }
    { 5700;   ;Sales Resp. Ctr. Filter;Code10     ;TableRelation="Responsibility Center".Code;
                                                   CaptionML=[ENU=Sales Resp. Ctr. Filter;
                                                              ESM=Filtro centro resp. vent.;
                                                              FRC=Filtre centre gestion vente;
                                                              ENC=Sales Resp. Ctr. Filter] }
    { 5701;   ;Purchase Resp. Ctr. Filter;Code10  ;TableRelation="Responsibility Center";
                                                   CaptionML=[ENU=Purchase Resp. Ctr. Filter;
                                                              ESM=Filtro centro resp. compras;
                                                              FRC=Filtre centre gestion achat;
                                                              ENC=Purchase Resp. Ctr. Filter] }
    { 5900;   ;Service Resp. Ctr. Filter;Code10   ;TableRelation="Responsibility Center";
                                                   CaptionML=[ENU=Service Resp. Ctr. Filter;
                                                              ESM=Filtro centro resp. servicio;
                                                              FRC=Filtre centre gestion service;
                                                              ENC=Service Resp. Ctr. Filter] }
    { 50000;  ;Default Location    ;Code10        ;TableRelation=Location }
    { 50001;  ;Default Division    ;Code10         }
    { 50015;  ;Sales Margin % Approver;Boolean    ;Description=TOP150 }
    { 50016;  ;Credit Limit Approver;Boolean      ;Description=TOP150 }
    { 50017;  ;Line Pricing Approver;Boolean      ;Description=TOP150 }
    { 50018;  ;Overdue Bal. Approver;Boolean      ;Description=TOP150 }
    { 50019;  ;Shortcut Dimension 5 Filter;Text250;TableRelation="Dimension Value".Code WHERE (Dimension Code=FILTER(DIVISION));
                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=ENU=Shortcut Dimension 5 Filter;
                                                   Description=TOP010B;
                                                   CaptionClass='1,4,5' }
    { 50030;  ;Price Book Filter   ;Code50        ;CaptionML=ENU=Price Book Filter }
    { 50100;  ;Mfr. Rep. Filter    ;Code20        ;CaptionML=ENU=Mfr. Rep. Filter (E);
                                                   Description=RS1.07 }
    { 50101;  ;Mfr. Rep. Filter (L);Code20        ;DataClassification=ToBeClassified;
                                                   CaptionML=ENU=Mfr. Rep. Filter (L);
                                                   Description=RS1.07 }
    { 50102;  ;Mfr. Rep. Filter (P);Code20        ;DataClassification=ToBeClassified;
                                                   CaptionML=ENU=Mfr. Rep. Filter (P);
                                                   Description=RS1.07 }
    { 50105;  ;Location Filter     ;Code20        ;CaptionML=ENU=Location Filter }
    { 50200;  ;Shortcut Dimension 5 Code;Code20   ;OnValidate=BEGIN
                                                                //TOP020 KT ABCSI Sales Orders by Division 02052015
                                                                IF ("Shortcut Dimension 5 Code" <> '') THEN BEGIN
                                                                  GLSetup.GET;
                                                                  IF GLSetup."Shortcut Dimension 5 Code" <> '' THEN BEGIN
                                                                    IF NOT DimVal.GET(GLSetup."Shortcut Dimension 5 Code","Shortcut Dimension 5 Code") THEN
                                                                      ERROR(
                                                                        STRSUBSTNO(ab003,
                                                                          GLSetup."Shortcut Dimension 5 Code","Shortcut Dimension 5 Code"));
                                                                  END ELSE
                                                                    ERROR(ab002,GLSetup.TABLECAPTION);
                                                                END;
                                                                //TOP020 KT ABCSI Sales Orders by Division 02052015
                                                              END;

                                                   OnLookup=BEGIN
                                                              //<Tpz2829> Event Conversion
                                                              {
                                                              LookupShortcutDimCode(5,"Shortcut Dimension 5 Code"); //TOP020 KT ABCSI Sales Orders by Division 01222015
                                                              VALIDATE("Shortcut Dimension 5 Code");
                                                              }
                                                              //<Tpz2829> Event Conversion
                                                              Table91EventSubscriber.Tb_91_LookupShortcutDimCode(Rec,5,"Shortcut Dimension 5 Code"); //<Tpz2829> Event Conversion
                                                            END;

                                                   Description=TOP020;
                                                   CaptionClass='1,2,5' }
    { 50300;  ;Allow Sales CM Posting;Boolean     ;Description=TPZ_HD9960 }
    { 50301;  ;Allow Override SOM  ;Boolean       ;DataClassification=ToBeClassified;
                                                   Description=TPZ2992 }
    { 51005;  ;OSR/CSR/ISR/Mfr. Rep. Admin.;Boolean;
                                                   CaptionML=ENU=OSR/CSR/ISR/Mfr. Rep. Admin. }
    { 51074;  ;Manual Margin Approval;Boolean     ;CaptionML=ENU=Manual Margin Approval }
    { 51406;  ;Min. Order Amount Approval;Boolean ;CaptionML=ENU=Min. Order Amount Approval }
    { 51407;  ;Free Freight Approval;Boolean      ;CaptionML=ENU=Free Freight Approval }
    { 51700;  ;Comm. / Hdlg Admin. ;Boolean        }
    { 51701;  ;User signature      ;Text250       ;Description=TOP1542 }
    { 51702;  ;User SMTP Override  ;Boolean       ;Description=TOP1542 }
    { 51704;  ;Warehouse Employee  ;Boolean       ;Description=TPZ1968 //For sales release report }
    { 51705;  ;DSHIP API Integration;Boolean      ;DataClassification=ToBeClassified;
                                                   Description=3187 }
    { 51706;  ;Daily Posting Range Exception;Boolean;
                                                   DataClassification=ToBeClassified;
                                                   Description=3307 }
    { 14000601;;Receive Station    ;Code10        ;TableRelation="Receive Station";
                                                   CaptionML=ENU=Receive Station }
    { 14000701;;Packing Station    ;Code10        ;TableRelation="Packing Station".Code;
                                                   CaptionML=ENU=Packing Station }
    { 14000901;;E-Mail User Rule   ;Code10        ;TableRelation="E-Mail User Rule";
                                                   CaptionML=ENU=E-Mail User Rule }
    { 14000902;;E-Mail Sender Name ;Text100       ;CaptionML=ENU=E-Mail Sender Name }
    { 14000903;;E-Mail Sender Address;Text50      ;CaptionML=ENU=E-Mail Sender Address }
  }
  KEYS
  {
    {    ;User ID                                 ;Clustered=Yes }
    {    ;Salespers./Purch. Code                   }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      Text001@1000 : TextConst 'ENU=The %1 Salesperson/Purchaser code is already assigned to another User ID %2.;ESM=El c¢digo de Vendedor/Comprador %1 ya est  asignado a otro id. usuario %2.;FRC=Le code de vendeur/acheteur %1 est d‚j… attribu‚ … un autre code utilisateur %2.;ENC=The %1 Salesperson/Purchaser code is already assigned to another User ID %2.';
      Text003@1002 : TextConst 'ENU="You cannot have both a %1 and %2. ";ESM="No puede tener un %1 y una %2. ";FRC="Vous ne pouvez pas avoir … la fois un %1 et un %2. ";ENC="You cannot have both a %1 and %2. "';
      Text005@1004 : TextConst 'ENU=You cannot have approval limits less than zero.;ESM=No puede tener l¡mites de aprobaci¢n inferiores a cero.;FRC=Impossible d''avoir une limite d''approbation inf‚rieure … z‚ro.;ENC=You cannot have approval limits less than zero.';
      SalesPersonPurchaser@1011 : Record 13;
      PrivacyBlockedGenericErr@1013 : TextConst '@@@="%1 = salesperson / purchaser code.";ENU=Privacy Blocked must not be true for Salesperson / Purchaser %1.;ESM=La opci¢n Privacidad bloqueada no debe ser verdadera para el Vendedor/Comprador %1.;FRC=Le champ Confidentialit‚ bloqu‚e ne doit pas avoir la valeur true pour le repr‚sentant/l''acheteur %1.;ENC=Privacy Blocked must not be true for Salesperson / Purchaser %1.';
      UserSetupManagement@1001 : Codeunit 5700;
      "****ABCSI Globals****"@1000000003 : Integer;
      DimMgt@1000000002 : Codeunit 408;
      GLSetup@1000000001 : Record 98;
      DimVal@1000000000 : Record 349;
      ab002@1000000005 : TextConst 'ENU=This Shortcut Dimension is not defined in the %1.;ESM=Este Shortcut de dimensi¢n no est  def. en el %1.;FRC=La dimension de ce raccourci n''est pas d‚finie dans le %1.;ENC=This Shortcut Dimension is not defined in the %1.';
      ab003@1000000004 : TextConst 'ENU=%1 is not an available %2 for that dimension.;ESM=%1 no est  disponible %2 para esa dimensi¢n.;FRC=%1 n''est pas un %2 disponible pour cette dimension.;ENC=%1 is not an available %2 for that dimension.';
      Table91EventSubscriber@1000000006 : Codeunit 51780;

    [External]
    PROCEDURE CreateApprovalUserSetup@3(User@1000 : Record 2000000120);
    VAR
      UserSetup@1001 : Record 91;
      ApprovalUserSetup@1002 : Record 91;
    BEGIN
      ApprovalUserSetup.INIT;
      ApprovalUserSetup.VALIDATE("User ID",User."User Name");
      ApprovalUserSetup.VALIDATE("Sales Amount Approval Limit",GetDefaultSalesAmountApprovalLimit);
      ApprovalUserSetup.VALIDATE("Purchase Amount Approval Limit",GetDefaultPurchaseAmountApprovalLimit);
      ApprovalUserSetup.VALIDATE("E-Mail",User."Contact Email");
      UserSetup.SETRANGE("Sales Amount Approval Limit",UserSetup.GetDefaultSalesAmountApprovalLimit);
      IF UserSetup.FINDFIRST THEN
        ApprovalUserSetup.VALIDATE("Approver ID",UserSetup."Approver ID");
      IF ApprovalUserSetup.INSERT THEN;
    END;

    [External]
    PROCEDURE GetDefaultSalesAmountApprovalLimit@1() : Integer;
    VAR
      UserSetup@1001 : Record 91;
      DefaultApprovalLimit@1000 : Integer;
      LimitedApprovers@1002 : Integer;
    BEGIN
      UserSetup.SETRANGE("Unlimited Sales Approval",FALSE);

      IF UserSetup.FINDFIRST THEN BEGIN
        DefaultApprovalLimit := UserSetup."Sales Amount Approval Limit";
        LimitedApprovers := UserSetup.COUNT;
        UserSetup.SETRANGE("Sales Amount Approval Limit",DefaultApprovalLimit);
        IF LimitedApprovers = UserSetup.COUNT THEN
          EXIT(DefaultApprovalLimit);
      END;

      // Return 0 if no user setup exists or no default value is found
      EXIT(0);
    END;

    [External]
    PROCEDURE GetDefaultPurchaseAmountApprovalLimit@2() : Integer;
    VAR
      UserSetup@1002 : Record 91;
      DefaultApprovalLimit@1001 : Integer;
      LimitedApprovers@1000 : Integer;
    BEGIN
      UserSetup.SETRANGE("Unlimited Purchase Approval",FALSE);

      IF UserSetup.FINDFIRST THEN BEGIN
        DefaultApprovalLimit := UserSetup."Purchase Amount Approval Limit";
        LimitedApprovers := UserSetup.COUNT;
        UserSetup.SETRANGE("Purchase Amount Approval Limit",DefaultApprovalLimit);
        IF LimitedApprovers = UserSetup.COUNT THEN
          EXIT(DefaultApprovalLimit);
      END;

      // Return 0 if no user setup exists or no default value is found
      EXIT(0);
    END;

    [External]
    PROCEDURE HideExternalUsers@5();
    VAR
      PermissionManager@1001 : Codeunit 9002;
      OriginalFilterGroup@1000 : Integer;
    BEGIN
      IF NOT PermissionManager.SoftwareAsAService THEN
        EXIT;

      OriginalFilterGroup := FILTERGROUP;
      FILTERGROUP := 2;
      CALCFIELDS("License Type");
      SETFILTER("License Type",'<>%1',"License Type"::"External User");
      FILTERGROUP := OriginalFilterGroup;
    END;

    LOCAL PROCEDURE UpdateSalesPerson@4();
    VAR
      SalespersonPurchaser@1000 : Record 13;
    BEGIN
      IF ("E-Mail" <> '') AND SalespersonPurchaser.GET("Salespers./Purch. Code") THEN BEGIN
        SalespersonPurchaser."E-Mail" := COPYSTR("E-Mail",1,MAXSTRLEN(SalespersonPurchaser."E-Mail"));
        SalespersonPurchaser.MODIFY;
      END;
    END;

    LOCAL PROCEDURE ValidateSalesPersonPurchOnUserSetup@298(UserSetup2@1000 : Record 91);
    BEGIN
      IF UserSetup2."Salespers./Purch. Code" <> '' THEN
        IF SalesPersonPurchaser.GET(UserSetup2."Salespers./Purch. Code") THEN
          IF SalesPersonPurchaser.VerifySalesPersonPurchaserPrivacyBlocked(SalesPersonPurchaser) THEN
            ERROR(PrivacyBlockedGenericErr,UserSetup2."Salespers./Purch. Code")
    END;

    BEGIN
    {
      TOP010 KT ABCSI Stock Status Quick Quote Screen 12082014
        - Added Fields
          # 50000 Default Location
          # 50010 Default Division

      TOP020 KT ABCSI Sales Orders by Division Code 01262015
        - Added new field "Shortcut Dimension 5 Code"
        - Added manual lookup for "Shortcut Dimension 5 Code" and added function LookupShortcutDimCode( )

      TOP150 - KT ABCSI Sales Order Margin Review 04032015
        - Added fields # 50015 Sales Margin % Approver, 50016 Credit Limit Approver, 50017 Line Pricing Approver, 50018 Overdue Bal. Approver

      TOP010B KT ABCSI SSQQ Division Code 07132015
        - Added a new field 50019 "Shortcut Dimension 5 Filter"
      2015-05-29 TPZ573 VCHERNYA
        Min. Order Amount Approval and Free Freight Approval fields have been created
      2015-07-01 TPZ159 VCHERNYA
        Mfr. Rep. Filter, Price Book Filter, and Location Filter fields have been created
      2015-07-30 TPZ858 TAKHMETO
        Comm. / Hdlg Admin. field has been created
      2015-08-19 TPZ589 VCHERNYA
        Manual Margin Approval field has been created
      2015-01-29 TPZ1015 TAKHMETO
        OSR/CSR/ISR/Mfr. Rep. Admin. field has been added
      2016-10-18 TPZ_HD_9960 SDESAI
        Added new field:"Allow Sales CM Posting" (50300)
        To control posting of Sales Credit memos.
      2017-08-05 TPZ1968 EBAGIM
        added new field "Warehouse Employee" to filter out warehouse employees from release by our report
      2019.04.15 - RS1.07 - New Filter conditions for MFR fields
    }
    END.
  }
}

