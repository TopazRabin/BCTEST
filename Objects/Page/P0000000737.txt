OBJECT Page 737 VAT Return Period List
{
  OBJECT-PROPERTIES
  {
    Date=04/25/19;
    Time=12:00:00 PM;
    Version List=NAVW111.00.00.31747;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Tax Return Periods;
               ESM=Per°odos de devoluci¢n de IVA;
               FRC=PÇriodes de retour TVA;
               ENC=Tax Return Periods];
    SourceTable=Table737;
    PageType=List;
    CardPageID=VAT Return Period Card;
    OnOpenPage=BEGIN
                 VATReportSetup.GET;
                 IsEditable := VATReportSetup."Manual Receive Period CU ID" = 0;
               END;

    OnAfterGetRecord=BEGIN
                       InitPageControllers;
                     END;

    OnInsertRecord=BEGIN
                     IF NOT IsEditable THEN
                       ERROR('');
                   END;

    OnAfterGetCurrRecord=BEGIN
                           InitPageControllers;
                         END;

    ActionList=ACTIONS
    {
      { 10      ;    ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 11      ;1   ;Action    ;
                      Name=Get VAT Return Periods;
                      CaptionML=[ENU=Get Tax Return Periods;
                                 ESM=Obtener per°odos de liquidaci¢n de IVA;
                                 FRC=Obtenir les pÇriodes de retour TVA;
                                 ENC=Get Tax Return Periods];
                      ToolTipML=[ENU=Load the Tax return periods that are set up in the system.;
                                 ESM=Carga los periodos de devoluci¢n de IVA configurados en el sistema.;
                                 FRC=Chargez les pÇriodes de retour TVA qui sont configurÇes dans le systäme.;
                                 ENC=Load the Tax return periods that are set up in the system.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Visible=NOT IsEditable;
                      PromotedIsBig=Yes;
                      Image=GetLines;
                      PromotedCategory=Process;
                      PromotedOnly=Yes;
                      OnAction=VAR
                                 VATReportMgt@1000 : Codeunit 737;
                               BEGIN
                                 VATReportMgt.GetVATReturnPeriods;
                               END;
                                }
      { 12      ;1   ;Action    ;
                      Name=Create VAT Return;
                      CaptionML=[ENU=Create Tax Return;
                                 ESM=Crear devoluci¢n de IVA;
                                 FRC=CrÇer un retour TVA;
                                 ENC=Create Tax Return];
                      ToolTipML=[ENU=Create a new Tax return from the selected Tax return period.;
                                 ESM=Permite crear una nueva devoluci¢n de IVA desde el per°odo de devoluci¢n de IVA seleccionado.;
                                 FRC=CrÇez un retour TVA Ö partir de la pÇriode de retour TVA sÇlectionnÇe.;
                                 ENC=Create a new Tax return from the selected Tax return period.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Enabled=CreateVATReturnEnabled;
                      PromotedIsBig=Yes;
                      Image=RefreshLines;
                      PromotedCategory=Process;
                      PromotedOnly=Yes;
                      OnAction=VAR
                                 VATReturnPeriod@1000 : Record 737;
                                 VATReportMgt@1001 : Codeunit 737;
                               BEGIN
                                 CurrPage.SETSELECTIONFILTER(VATReturnPeriod);
                                 IF VATReturnPeriod.COUNT = 1 THEN
                                   VATReportMgt.CreateVATReturnFromVATPeriod(Rec);
                               END;
                                }
      { 13      ;0   ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 14      ;1   ;Action    ;
                      Name=Open VAT Return Card;
                      CaptionML=[ENU=Open Tax Return Card;
                                 ESM=Tarjeta de devoluci¢n de IVA pendiente;
                                 FRC=Ouvrir la fiche retour TVA;
                                 ENC=Open Tax Return Card];
                      ToolTipML=[ENU=Open the Tax return card for the selected Tax return period.;
                                 ESM=Abre la tarjeta de devoluci¢n de IVA para el per°odo de devoluci¢n de IVA seleccionado.;
                                 FRC=Ouvrez la fiche retour TVA pour la pÇriode de retour TVA sÇlectionnÇe.;
                                 ENC=Open the Tax return card for the selected Tax return period.];
                      ApplicationArea=#Basic,#Suite;
                      Enabled=OpenVATReturnEnabled;
                      Image=ShowList;
                      OnAction=VAR
                                 VATReturnPeriod@1000 : Record 737;
                                 VATReportMgt@1001 : Codeunit 737;
                               BEGIN
                                 CurrPage.SETSELECTIONFILTER(VATReturnPeriod);
                                 IF VATReturnPeriod.COUNT = 1 THEN
                                   VATReportMgt.OpenVATReturnCardFromVATPeriod(Rec);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1   ;    ;Container ;
                ContainerType=ContentArea }

    { 2   ;1   ;Group     ;
                Editable=IsEditable;
                GroupType=Repeater }

    { 3   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the start date of the Tax return period.;
                           ESM=Especifica la fecha en la que comienza el per°odo de devoluci¢n de IVA.;
                           FRC=SpÇcifie la date de dÇbut de la pÇriode de retour TVA.;
                           ENC=Specifies the start date of the Tax return period.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Start Date" }

    { 4   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the end date of the Tax return period.;
                           ESM=Especifica la fecha en la que termina el per°odo de devoluci¢n de IVA.;
                           FRC=SpÇcifie la date de fin de la pÇriode de retour TVA.;
                           ENC=Specifies the end date of the Tax return period.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="End Date" }

    { 5   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the due date for the Tax return period.;
                           ESM=Especifica la fecha de vencimiento para el per°odo de devoluci¢n de IVA.;
                           FRC=SpÇcifie la date d'ÇchÇance de la pÇriode de retour TVA.;
                           ENC=Specifies the due date for the Tax return period.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Due Date";
                StyleExpr=WarningStyleExpr }

    { 6   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the status of the Tax return period.;
                           ESM=Especifica el estado del per°odo de devoluci¢n de IVA.;
                           FRC=SpÇcifie l'Çtat de la pÇriode de retour TVA.;
                           ENC=Specifies the status of the Tax return period.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=Status;
                StyleExpr=WarningStyleExpr }

    { 7   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the Tax return period received date.;
                           ESM=Especifica la fecha de recepci¢n del per°odo de devoluci¢n de IVA.;
                           FRC=SpÇcifie la date de rÇception pour la pÇriode de retour TVA.;
                           ENC=Specifies the Tax return period received date.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Received Date" }

    { 15  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the associated Tax return.;
                           ESM=Especifica el n£mero de la devoluci¢n de IVA asociada.;
                           FRC=SpÇcifie le numÇro du retour TVA associÇ.;
                           ENC=Specifies the number of the associated Tax return.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="VAT Return No.";
                OnDrillDown=BEGIN
                              DrillDownVATReturn;
                            END;
                             }

    { 16  ;2   ;Field     ;
                Name=VATReturnStatus;
                CaptionML=[ENU=Tax Return Status;
                           ESM=Estado de devoluci¢n de IVA;
                           FRC=êtat du retour TVA;
                           ENC=Tax Return Status];
                ToolTipML=[ENU=Specifies the status of the associated Tax return.;
                           ESM=Especifica el estado de la devoluci¢n de IVA asociada.;
                           FRC=SpÇcifie l'Çtat du retour TVA associÇ.;
                           ENC=Specifies the status of the associated Tax return.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=VATReturnStatus;
                Editable=FALSE;
                OnDrillDown=BEGIN
                              DrillDownVATReturn;
                            END;
                             }

    { 8   ;    ;Container ;
                ContainerType=FactBoxArea }

    { 9   ;1   ;Part      ;
                ApplicationArea=#Basic,#Suite;
                SubPageLink=No.=FIELD(No.);
                PagePartID=Page736;
                PartType=Page }

  }
  CODE
  {
    VAR
      VATReportSetup@1000 : Record 743;
      WarningStyleExpr@1001 : Text;
      CreateVATReturnEnabled@1002 : Boolean;
      OpenVATReturnEnabled@1005 : Boolean;
      IsEditable@1003 : Boolean;
      VATReturnStatus@1006 : ' ,Open,Released,Submitted,Accepted,Closed,Rejected,Canceled';

    LOCAL PROCEDURE InitPageControllers@2();
    BEGIN
      CreateVATReturnEnabled := (Status = Status::Open) AND ("VAT Return No." = '');
      OpenVATReturnEnabled := (Status = Status::Open) OR ("VAT Return No." <> '');
      CALCFIELDS("VAT Return Status");
      IF "VAT Return No." <> '' THEN
        VATReturnStatus := "VAT Return Status" + 1
      ELSE
        VATReturnStatus := VATReturnStatus::" ";
      CheckOpenOrOverdue;
    END;

    LOCAL PROCEDURE CheckOpenOrOverdue@1();
    BEGIN
      IF (Status = Status::Open) AND ("Due Date" <> 0D) AND
         (("Due Date" < WORKDATE) OR
          VATReportSetup.IsPeriodReminderCalculation AND
          ("Due Date" >= WORKDATE) AND ("Due Date" <= CALCDATE(VATReportSetup."Period Reminder Calculation",WORKDATE)))
      THEN
        WarningStyleExpr := 'Unfavorable'
      ELSE
        WarningStyleExpr := '';
    END;

    BEGIN
    END.
  }
}

