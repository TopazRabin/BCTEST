OBJECT Page 1310 O365 Activities
{
  OBJECT-PROPERTIES
  {
    Date=02/22/18;
    Time=12:00:00 PM;
    Version List=NAVW111.00.00.20783;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Activities;
               ESM=Actividades;
               FRC=Activit‚s;
               ENC=Activities];
    SourceTable=Table1313;
    PageType=CardPart;
    RefreshOnActivate=Yes;
    ShowFilter=No;
    OnInit=BEGIN
             IF UserTours.IsAvailable AND O365GettingStartedMgt.AreUserToursEnabled THEN
               O365GettingStartedMgt.UpdateGettingStartedVisible(TileGettingStartedVisible,ReplayGettingStartedVisible);
           END;

    OnOpenPage=VAR
                 BookingSync@1002 : Record 6702;
                 OCRServiceMgt@1000 : Codeunit 1294;
                 RoleCenterNotificationMgt@1001 : Codeunit 1430;
               BEGIN
                 RESET;
                 IF NOT GET THEN BEGIN
                   INIT;
                   INSERT;
                   COMMIT;
                 END;
                 SETFILTER("Due Date Filter",'>=%1',WORKDATE);
                 SETFILTER("Overdue Date Filter",'<%1',WORKDATE);
                 SETFILTER("Due Next Week Filter",'%1..%2',CALCDATE('<1D>',WORKDATE),CALCDATE('<1W>',WORKDATE));
                 SETRANGE("User ID Filter",USERID);

                 HasCamera := CameraProvider.IsAvailable;
                 IF HasCamera THEN
                   CameraProvider := CameraProvider.Create;

                 PrepareOnLoadDialog;

                 ShowBookings := BookingSync.IsSetup;
                 ShowCamera := TRUE;
                 ShowStartActivities := TRUE;
                 ShowSalesActivities := TRUE;
                 ShowPurchasesActivities := TRUE;
                 ShowPaymentsActivities := TRUE;
                 ShowIncomingDocuments := TRUE;
                 ShowProductVideosActivities := TRUE;
                 ShowAwaitingIncomingDoc := OCRServiceMgt.OcrServiceIsEnable;
                 ShowIntercompanyActivities := TRUE;

                 RoleCenterNotificationMgt.ShowNotifications;
               END;

    OnAfterGetRecord=VAR
                       DocExchServiceSetup@1000 : Record 1275;
                     BEGIN
                       CalculateCueFieldValues;
                       ShowDocumentsPendingDocExchService := FALSE;
                       IF DocExchServiceSetup.GET THEN
                         ShowDocumentsPendingDocExchService := DocExchServiceSetup.Enabled;
                       SetActivityGroupVisibility;
                     END;

    OnAfterGetCurrRecord=VAR
                           RoleCenterNotificationMgt@1000 : Codeunit 1430;
                         BEGIN
                           IF UserTours.IsAvailable AND O365GettingStartedMgt.AreUserToursEnabled THEN
                             O365GettingStartedMgt.UpdateGettingStartedVisible(TileGettingStartedVisible,ReplayGettingStartedVisible);
                           RoleCenterNotificationMgt.HideEvaluationNotificationAfterStartingTrial;
                         END;

    ActionList=ACTIONS
    {
      { 6       ;    ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 7       ;1   ;Action    ;
                      Name=Set Up Cues;
                      CaptionML=[ENU=Set Up Cues;
                                 ESM=Configuraci¢n de pilas;
                                 FRC=Param‚trer piles;
                                 ENC=Set Up Cues];
                      ToolTipML=[ENU=Set up the cues (status tiles) related to the role.;
                                 ESM=Permite configurar las pilas (ventanas de estado) relacionadas con el rol.;
                                 FRC=D‚finissez les piles (mosa‹ques d'‚tat) li‚es au r“le.;
                                 ENC=Set up the cues (status tiles) related to the role.];
                      ApplicationArea=#Basic,#Suite;
                      Image=Setup;
                      OnAction=VAR
                                 CueRecordRef@1000 : RecordRef;
                               BEGIN
                                 CueRecordRef.GETTABLE(Rec);
                                 CueSetup.OpenCustomizePageForCurrentUser(CueRecordRef.NUMBER);
                               END;
                                }
      { 36      ;1   ;ActionGroup;
                      Name=Show/Hide Activities;
                      CaptionML=[ENU=Show/Hide Activities;
                                 ESM=Mostrar u ocultar actividades;
                                 FRC=Afficher/Masquer les activit‚s;
                                 ENC=Show/Hide Activities];
                      Image=Answers }
      { 37      ;2   ;Action    ;
                      Name=[Sales ];
                      CaptionML=[ENU=Sales;
                                 ESM=Ventas;
                                 FRC=Ventes;
                                 ENC=Sales];
                      ToolTipML=[ENU=View the list of ongoing sales orders.;
                                 ESM=Permite ver la lista de pedidos de venta.;
                                 FRC=Affichez la liste des documents de vente en cours.;
                                 ENC=View the list of ongoing sales orders.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Codeunit 1329;
                      Image=Sales }
      { 38      ;2   ;Action    ;
                      Name=Purchases;
                      CaptionML=[ENU=Purchases;
                                 ESM=Compras;
                                 FRC=Achats;
                                 ENC=Purchases];
                      ToolTipML=[ENU=View the list of ongoing purchase orders.;
                                 ESM=Permite ver la lista de pedidos de compra en curso.;
                                 FRC=Affichez la liste des bons de commande en cours.;
                                 ENC=View the list of ongoing purchase orders.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Codeunit 1331;
                      Image=Purchase }
      { 39      ;2   ;Action    ;
                      Name=Payments;
                      CaptionML=[ENU=Payments;
                                 ESM=Pagos;
                                 FRC=Paiements;
                                 ENC=Payments];
                      ToolTipML=[ENU=Specifies the amount that relates to payments.;
                                 ESM=Especifica el importe relacionado con los pagos.;
                                 FRC=Sp‚cifie le montant associ‚ aux paiements.;
                                 ENC=Specifies the amount that relates to payments.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Codeunit 1332;
                      Image=Payment }
      { 41      ;2   ;Action    ;
                      Name=Incoming Documents;
                      CaptionML=[ENU=Incoming Documents;
                                 ESM=Documentos entrantes;
                                 FRC=Documents entrants;
                                 ENC=Incoming Documents];
                      ToolTipML=[ENU=View the list of incoming documents, such as vendor invoices in PDF or as image files, that you can manually or automatically create document records, such as purchase invoices. The external files that represent incoming documents can be attached at any process stage, including to posted documents and to the resulting vendor, customer, and general ledger entries.;
                                 ESM=Permite ver la lista de documentos entrantes (por ejemplo, facturas de proveedor en PDF o como archivos de imagen) a partir de los cuales se pueden crear registros de documento de forma manual o autom tica (por ejemplo, facturas de compra). Los archivos externos que representan los documentos entrantes se pueden asociar a cualquier etapa del proceso, incluidos los documentos registrados y los movimiento de proveedor, cliente y contabilidad general resultantes.;
                                 FRC=Affichez la liste des documents entrants, par exemple les factures fournisseur dans des fichiers PDF ou image, pour lesquels vous pouvez cr‚er manuellement ou automatiquement des enregistrements de document, tels que des factures achat. Les fichiers externes qui repr‚sentent les documents entrants peuvent ˆtre joints … n'importe quel stade du processus, notamment aux documents report‚s et aux ‚critures GL, client et fournisseur qui en r‚sultent.;
                                 ENC=View the list of incoming documents, such as vendor invoices in PDF or as image files, that you can manually or automatically create document records, such as purchase invoices. The external files that represent incoming documents can be attached at any process stage, including to posted documents and to the resulting vendor, customer, and general ledger entries.];
                      ApplicationArea=#Suite;
                      RunObject=Codeunit 1333;
                      Image=Documents }
      { 53      ;2   ;Action    ;
                      Name=User Tasks;
                      CaptionML=[ENU=User Tasks;
                                 ESM=Tareas de usuario;
                                 FRC=Tƒches utilisateur;
                                 ENC=User Tasks];
                      ToolTipML=[ENU=Show or hide the User Task cue.;
                                 ESM=Mostrar u ocultar la pila de la tarea de usuario.;
                                 FRC=Afficher ou masquer la pile Tƒche utilisateur.;
                                 ENC=Show or hide the User Task cue.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Codeunit 1347;
                      Image=Task }
      { 40      ;2   ;Action    ;
                      Name=Start;
                      CaptionML=[ENU=Start;
                                 ESM=Iniciar;
                                 FRC=D‚marrer;
                                 ENC=Start];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Codeunit 1328;
                      Image=NewDocument }
      { 45      ;2   ;Action    ;
                      Name=Product Videos;
                      CaptionML=[ENU=Product Videos;
                                 ESM=V¡deos de productos;
                                 FRC=Vid‚os produits;
                                 ENC=Product Videos];
                      ToolTipML=[ENU=View the list of product videos.;
                                 ESM=Permite ver la lista de v¡deos de productos.;
                                 FRC=Affichez la liste des vid‚os produits.;
                                 ENC=View the list of product videos.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Codeunit 1345;
                      Image=Filed }
    }
  }
  CONTROLS
  {
    { 1   ;0   ;Container ;
                ContainerType=ContentArea }

    { 35  ;1   ;Group     ;
                Name=Welcome;
                CaptionML=[ENU=Welcome;
                           ESM=Bienvenido;
                           FRC=Bienvenue;
                           ENC=Welcome];
                Visible=TileGettingStartedVisible;
                GroupType=CueGroup;
                ActionList=ACTIONS
                {
                  { 4       ;    ;Action    ;
                                  Name=GettingStartedTile;
                                  CaptionML=[ENU=Return to Getting Started;
                                             ESM=Volver a la introducci¢n;
                                             FRC=Revenir … la mise en route;
                                             ENC=Return to Getting Started];
                                  ToolTipML=[ENU=Learn how to get started with Dynamics NAV.;
                                             ESM=Ofrece una introducci¢n a Dynamics NAV.;
                                             FRC=D‚couvrez comment commencer avec Dynamics NAV.;
                                             ENC=Learn how to get started with Dynamics NAV.];
                                  ApplicationArea=#Basic,#Suite;
                                  Image=TileVideo;
                                  OnAction=BEGIN
                                             O365GettingStartedMgt.LaunchWizard(TRUE,FALSE);
                                           END;
                                            }
                }
                 }

    { 10  ;1   ;Group     ;
                CaptionML=[ENU=Ongoing Sales;
                           ESM=Ventas en curso;
                           FRC=Vente en cours;
                           ENC=Ongoing Sales];
                Visible=ShowSalesActivities;
                GroupType=CueGroup }

    { 13  ;2   ;Field     ;
                CaptionML=[ENU=Quotes;
                           ESM=Ofertas;
                           FRC=Devis;
                           ENC=Quotes];
                ToolTipML=[ENU=Specifies sales quotes that have not yet been converted to invoices or orders.;
                           ESM=Especifica las cotizaciones de venta que todav¡a no se han convertido en facturas u ¢rdenes.;
                           FRC=Sp‚cifie les devis qui n'ont pas encore ‚t‚ convertis en factures ou en commandes.;
                           ENC=Specifies sales quotes that have not yet been converted to invoices or orders.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ongoing Sales Quotes";
                DrillDownPageID=Sales Quotes }

    { 20  ;2   ;Field     ;
                CaptionML=[ENU=Orders;
                           ESM=Pedidos;
                           FRC=Commandes;
                           ENC=Orders];
                ToolTipML=[ENU=Specifies sales orders that are not yet posted or only partially posted.;
                           ESM=Especifica las ¢rdenes de venta que todav¡a no se han registrado o que se han registrado solo parcialmente.;
                           FRC=Sp‚cifie les documents de vente qui ne sont pas encore report‚s ou qui ne le sont que partiellement.;
                           ENC=Specifies sales orders that are not yet posted or only partially posted.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ongoing Sales Orders";
                DrillDownPageID=Sales Order List }

    { 2   ;2   ;Field     ;
                CaptionML=[ENU=Invoices;
                           ESM=Facturas;
                           FRC=Factures;
                           ENC=Invoices];
                ToolTipML=[ENU=Specifies sales invoices that are not yet posted or only partially posted.;
                           ESM=Especifica las facturas de venta que todav¡a no se han registrado o que solo se han registrado parcialmente.;
                           FRC=Sp‚cifie les factures de vente qui ne sont pas encore report‚es ou qui ne le sont que partiellement.;
                           ENC=Specifies sales invoices that are not yet posted or only partially posted.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ongoing Sales Invoices";
                DrillDownPageID=Sales Invoice List }

    { 3   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the sum of sales in the current month.;
                           ESM=Especifica la suma de ventas del mes actual.;
                           FRC=Sp‚cifie la somme des ventes du mois en cours.;
                           ENC=Specifies the sum of sales in the current month.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Sales This Month";
                DrillDownPageID=Sales Invoice List;
                OnDrillDown=BEGIN
                              ActivitiesMgt.DrillDownSalesThisMonth;
                            END;
                             }

    { 46  ;2   ;Field     ;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Uninvoiced Bookings";
                Visible=ShowBookings;
                Enabled=ShowBookings;
                OnDrillDown=VAR
                              BookingManager@1000 : Codeunit 6721;
                            BEGIN
                              BookingManager.InvoiceBookingItems;
                            END;
                             }

    { 28  ;1   ;Group     ;
                CaptionML=[ENU=Document Exchange Service;
                           ESM=Servicio de intercambio de documentos;
                           FRC=Service d'‚change de documents;
                           ENC=Document Exchange Service];
                Visible=ShowDocumentsPendingDocExchService;
                GroupType=CueGroup }

    { 27  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies sales invoices that await sending to the customer through the document exchange service.;
                           ESM=Especifica las facturas de venta que hay que enviar al cliente a trav‚s del servicio de intercambio de documentos.;
                           FRC=Sp‚cifie les factures de vente qui attendent d'ˆtre envoy‚es au client via le service d'‚change de documents.;
                           ENC=Specifies sales invoices that await sending to the customer through the document exchange service.];
                ApplicationArea=#Suite;
                SourceExpr="Sales Inv. - Pending Doc.Exch.";
                Visible=ShowDocumentsPendingDocExchService;
                DrillDownPageID=Posted Sales Invoices }

    { 26  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies sales credit memos that await sending to the customer through the document exchange service.;
                           ESM=Especifica las notas de cr‚dito de venta que hay que enviar al cliente a trav‚s del servicio de intercambio de documentos.;
                           FRC=Sp‚cifie les notes de cr‚dit de vente qui attendent d'ˆtre envoy‚es au client via le service d'‚change de documents.;
                           ENC=Specifies sales credit memos that await sending to the customer through the document exchange service.];
                ApplicationArea=#Suite;
                SourceExpr="Sales CrM. - Pending Doc.Exch.";
                Visible=ShowDocumentsPendingDocExchService;
                DrillDownPageID=Posted Sales Credit Memos }

    { 9   ;1   ;Group     ;
                CaptionML=[ENU=Purchases;
                           ESM=Compras;
                           FRC=Achats;
                           ENC=Purchases];
                Visible=ShowPurchasesActivities;
                GroupType=CueGroup }

    { 42  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies purchases orders that are not posted or only partially posted.;
                           ESM=Especifica las ¢rdenes de compra que no se han registrado o que se han registrado solo parcialmente.;
                           FRC=Sp‚cifie les bons de commande qui ne sont pas encore report‚s ou qui ne le sont que partiellement.;
                           ENC=Specifies purchases orders that are not posted or only partially posted.];
                ApplicationArea=#Suite;
                SourceExpr="Purchase Orders";
                DrillDownPageID=Purchase Order List }

    { 5   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies purchases invoices that are not posted or only partially posted.;
                           ESM=Especifica las facturas de compra que todav¡a no se han registrado o que se han registrado parcialmente.;
                           FRC=Sp‚cifie les factures d'achat qui ne sont pas report‚es ou qui ne le sont que partiellement.;
                           ENC=Specifies purchases invoices that are not posted or only partially posted.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ongoing Purchase Invoices";
                DrillDownPageID=Purchase Invoices }

    { 18  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the sum of your overdue payments to vendors.;
                           ESM=Especifica la suma de los pagos vencidos a los proveedores.;
                           FRC=Sp‚cifie la somme des paiements que vous devez … des fournisseurs.;
                           ENC=Specifies the sum of your overdue payments to vendors.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Overdue Purch. Invoice Amount";
                OnDrillDown=BEGIN
                              ActivitiesMgt.DrillDownOverduePurchaseInvoiceAmount;
                            END;
                             }

    { 11  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of payments to vendors that are due next week.;
                           ESM=Especifica el n£mero de pagos a proveedores que vencen la pr¢xima semana.;
                           FRC=Sp‚cifie le nombre de paiements dus … des fournisseurs la semaine suivante.;
                           ENC=Specifies the number of payments to vendors that are due next week.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Purch. Invoices Due Next Week" }

    { 24  ;1   ;Group     ;
                CaptionML=[ENU=Approvals;
                           ESM=Aprobaciones;
                           FRC=Approbations;
                           ENC=Approvals];
                Visible=FALSE;
                GroupType=CueGroup }

    { 25  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of approval requests that require your approval.;
                           ESM=Especifica el n£mero de solicitudes de aprobaci¢n que requieren su aprobaci¢n.;
                           FRC=Sp‚cifie le nombre de demandes d'approbation que vous devez approuver.;
                           ENC=Specifies the number of approval requests that require your approval.];
                ApplicationArea=#Suite;
                SourceExpr="Requests to Approve";
                DrillDownPageID=Requests to Approve }

    { 47  ;1   ;Group     ;
                CaptionML=[ENU=Intercompany;
                           ESM=Empresas vinculadas;
                           FRC=Intersoci‚t‚s;
                           ENC=Intercompany];
                Visible=ShowIntercompanyActivities;
                GroupType=CueGroup }

    { 48  ;2   ;Field     ;
                CaptionML=[ENU=Pending Inbox Transactions;
                           ESM=Trans. band. ent. pendientes;
                           FRC=Transactions boŒte r‚cep en attente;
                           ENC=Pending Inbox Transactions];
                ApplicationArea=#Intercompany;
                SourceExpr="IC Inbox Transactions";
                Visible="IC Inbox Transactions" <> 0;
                DrillDownPageID=IC Inbox Transactions }

    { 49  ;2   ;Field     ;
                CaptionML=[ENU=Pending Outbox Transactions;
                           ESM=Trans. band. sal. pendientes;
                           FRC=Transactions boŒte d'envoi en attente;
                           ENC=Pending Outbox Transactions];
                ApplicationArea=#Intercompany;
                SourceExpr="IC Outbox Transactions";
                Visible="IC Outbox Transactions" <> 0;
                DrillDownPageID=IC Outbox Transactions }

    { 12  ;1   ;Group     ;
                CaptionML=[ENU=Payments;
                           ESM=Pagos;
                           FRC=Paiements;
                           ENC=Payments];
                Visible=ShowPaymentsActivities;
                GroupType=CueGroup }

    { 17  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the sum of overdue payments from customers.;
                           ESM=Especifica la suma de pagos vencidos de los clientes.;
                           FRC=Sp‚cifie la somme des paiements dus par des clients.;
                           ENC=Specifies the sum of overdue payments from customers.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Overdue Sales Invoice Amount";
                OnDrillDown=BEGIN
                              ActivitiesMgt.DrillDownCalcOverdueSalesInvoiceAmount;
                            END;
                             }

    { 29  ;2   ;Field     ;
                CaptionML=[ENU=Unprocessed Payments;
                           ESM=Pagos sin procesar;
                           FRC=Paiements non trait‚s;
                           ENC=Unprocessed Payments];
                ToolTipML=[ENU=Specifies imported bank transactions for payments that are not yet reconciled in the Payment Reconciliation Journal window.;
                           ESM=Especifica las transacciones bancarias importadas para los pagos que todav¡a no se conciliaron en la ventana Diario de conciliaci¢n de pagos.;
                           FRC=Sp‚cifie les transactions bancaires import‚es pour des paiements qui ne sont pas encore rapproch‚s dans la fenˆtre Journal de rapprochement bancaire.;
                           ENC=Specifies imported bank transactions for payments that are not yet reconciled in the Payment Reconciliation Journal window.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Non-Applied Payments";
                OnDrillDown=BEGIN
                              CODEUNIT.RUN(CODEUNIT::"Pmt. Rec. Journals Launcher");
                            END;

                Image=Cash }

    { 19  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies how long customers took to pay invoices in the last three months. This is the average number of days from when invoices are issued to when customers pay the invoices.;
                           ESM=Especifica el tiempo que emplearon los clientes para pagar las facturas en los £ltimos tres meses. Este es el n£mero promedio de d¡as desde que se emiten las facturas hasta que los clientes las pagan.;
                           FRC=Sp‚cifie le d‚lai aprŠs lequel les clients ont pay‚ les factures au cours des troisÿderniers mois. Il s'agit du nombre moyen de jours entre la date d'‚mission des factures et le moment o— les clients les paient.;
                           ENC=Specifies how long customers took to pay invoices in the last three months. This is the average number of days from when invoices are issued to when customers pay the invoices.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Average Collection Days" }

    { 33  ;1   ;Group     ;
                CaptionML=[ENU=Camera;
                           ESM=C mara;
                           FRC=Appareil photo;
                           ENC=Camera];
                Visible=ShowCamera;
                GroupType=CueGroup;
                ActionList=ACTIONS
                {
                  { 21      ;    ;Action    ;
                                  Name=CreateIncomingDocumentFromCamera;
                                  CaptionML=[ENU=Create Incoming Doc. from Camera;
                                             ESM=Crear doc. entrante desde c mara;
                                             FRC=Cr‚er un document entrant … partir de l'appareil photo;
                                             ENC=Create Incoming Doc. from Camera];
                                  ToolTipML=[ENU=Create an incoming document by taking a photo of the document with your mobile device camera. The photo will be attached to the new document.;
                                             ESM=Permite crear un documento entrante tomando una foto del documento con la c mara del dispositivo m¢vil. La foto se adjunta al nuevo documento.;
                                             FRC=Cr‚ez un document entrant en prenant une photo du document avec l'appareil photo de votre p‚riph‚rique mobile. La photo est jointe au nouveau document.;
                                             ENC=Create an incoming document by taking a photo of the document with your mobile device camera. The photo will be attached to the new document.];
                                  ApplicationArea=#Suite;
                                  Image=TileCamera;
                                  OnAction=VAR
                                             CameraOptions@1000 : DotNet "'Microsoft.Dynamics.Nav.ClientExtensions, Version=11.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35'.Microsoft.Dynamics.Nav.Client.Capabilities.CameraOptions";
                                           BEGIN
                                             IF NOT HasCamera THEN
                                               EXIT;

                                             CameraOptions := CameraOptions.CameraOptions;
                                             CameraOptions.Quality := 100; // 100%
                                             CameraProvider.RequestPictureAsync(CameraOptions);
                                           END;
                                            }
                }
                 }

    { 34  ;1   ;Group     ;
                CaptionML=[ENU=Incoming Documents;
                           ESM=Documentos entrantes;
                           FRC=Documents entrants;
                           ENC=Incoming Documents];
                Visible=ShowIncomingDocuments;
                GroupType=CueGroup }

    { 30  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies incoming documents that are assigned to you.;
                           ESM=Especifica los documentos entrantes que tiene asignados.;
                           FRC=Sp‚cifie les documents entrants qui vous sont assign‚s.;
                           ENC=Specifies incoming documents that are assigned to you.];
                ApplicationArea=#Suite;
                SourceExpr="My Incoming Documents" }

    { 32  ;2   ;Field     ;
                Name=Awaiting Verfication;
                DrillDown=Yes;
                ToolTipML=[ENU=Specifies incoming documents in OCR processing that require you to log on to the OCR service website to manually verify the OCR values before the documents can be received.;
                           ESM=Especifica los documentos entrantes en el procesamiento de OCR que le exigen iniciar sesi¢n en el sitio web del servicio de OCR para comprobar manualmente los valores de OCR antes de que puedan recibirse los documentos.;
                           FRC=Sp‚cifie les documents entrants dans le processus OCR pour lesquels vous devez vous connecter au site Web du service OCR pour v‚rifier manuellement les valeurs OCR avant de pouvoir recevoir les documents.;
                           ENC=Specifies incoming documents in OCR processing that require you to log on to the OCR service website to manually verify the OCR values before the documents can be received.];
                ApplicationArea=#Suite;
                SourceExpr="Inc. Doc. Awaiting Verfication";
                Visible=ShowAwaitingIncomingDoc;
                OnDrillDown=VAR
                              OCRServiceSetup@1000 : Record 1270;
                            BEGIN
                              IF OCRServiceSetup.GET THEN
                                IF OCRServiceSetup.Enabled THEN
                                  HYPERLINK(OCRServiceSetup."Sign-in URL");
                            END;
                             }

    { 50  ;1   ;Group     ;
                CaptionML=[ENU=My User Tasks;
                           ESM=Mis tareas de usuario;
                           FRC=Mes tƒches utilisateur;
                           ENC=My User Tasks];
                Visible=ShowUserTaskActivities;
                GroupType=CueGroup }

    { 51  ;2   ;Field     ;
                CaptionML=[ENU=Pending User Tasks;
                           ESM=Tareas de usuario pendientes;
                           FRC=Tƒches utilisateur en attente;
                           ENC=Pending User Tasks];
                ToolTipML=[ENU=Specifies the number of pending tasks that are assigned to you.;
                           ESM=Especifica el n£mero de tareas pendientes que tiene asignadas.;
                           FRC=Sp‚cifie le nombre de tƒches en attente qui vous sont assign‚es.;
                           ENC=Specifies the number of pending tasks that are assigned to you.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Pending Tasks";
                DrillDownPageID=User Task List;
                Image=Checklist }

    { 14  ;1   ;Group     ;
                CaptionML=[ENU=Start;
                           ESM=Iniciar;
                           FRC=D‚marrer;
                           ENC=Start];
                Visible=ShowStartActivities;
                GroupType=CueGroup;
                ActionList=ACTIONS
                {
                  { 15      ;    ;Action    ;
                                  CaptionML=[ENU=Sales Quote;
                                             ESM=Cotizaci¢n venta;
                                             FRC=Devis;
                                             ENC=Sales Quote];
                                  ToolTipML=[ENU=Offer items or services to a customer.;
                                             ESM=Permite ofrecer productos o servicios a un cliente.;
                                             FRC=Proposez des articles ou des services … un client.;
                                             ENC=Offer items or services to a customer.];
                                  ApplicationArea=#Basic,#Suite;
                                  RunObject=Page 41;
                                  Image=TileNew;
                                  RunPageMode=Create }
                  { 31      ;    ;Action    ;
                                  CaptionML=[ENU=Sales Order;
                                             ESM=Pedido venta;
                                             FRC=Document de vente;
                                             ENC=Sales Order];
                                  ToolTipML=[ENU=Create a new sales order for items or services that require partial posting or order confirmation.;
                                             ESM=Permite crear un nuevo pedido de ventas de productos o servicios que requieren un registro parcial o una confirmaci¢n de pedido.;
                                             FRC=Cr‚ez un document de vente pour des articles ou des services n‚cessitant un report partiel ou une confirmation commande.;
                                             ENC=Create a new sales order for items or services that require partial posting or order confirmation.];
                                  ApplicationArea=#Basic,#Suite;
                                  RunObject=Page 42;
                                  Image=TileNew;
                                  RunPageMode=Create }
                  { 16      ;    ;Action    ;
                                  CaptionML=[ENU=Sales Invoice;
                                             ESM=Factura venta;
                                             FRC=Facture vente;
                                             ENC=Sales Invoice];
                                  ToolTipML=[ENU=Create a new invoice for the sales of items or services. Invoice quantities cannot be posted partially.;
                                             ESM=Permite crear una nueva factura para las ventas de productos o servicios. Las cantidades de la factura no se pueden registrar de forma parcial.;
                                             FRC=Cr‚er une facture pour la vente des articles ou des services. Il est impossible de valider partiellement les quantit‚s factur‚es.;
                                             ENC=Create a new invoice for the sales of items or services. Invoice quantities cannot be posted partially.];
                                  ApplicationArea=#Basic,#Suite;
                                  RunObject=Page 43;
                                  Image=TileNew;
                                  RunPageMode=Create }
                  { 22      ;    ;Action    ;
                                  CaptionML=[ENU=Purchase Invoice;
                                             ESM=Factura compra;
                                             FRC=Facture achat;
                                             ENC=Purchase Invoice];
                                  ToolTipML=[ENU=Create a new purchase invoice for items or services.;
                                             ESM=Permite crear una nueva factura de compra de productos o servicios.;
                                             FRC=Cr‚ez une facture achat pour les articles ou les services.;
                                             ENC=Create a new purchase invoice for items or services.];
                                  ApplicationArea=#Basic,#Suite;
                                  RunObject=Page 51;
                                  Image=TileNew;
                                  RunPageMode=Create }
                  { 100     ;    ;Action    ;
                                  CaptionML=[ENU=Sales Return Order;
                                             ESM=Pedido dev. venta;
                                             FRC=Retour commande vte;
                                             ENC=Sales Return Order];
                                  ToolTipML=[ENU=Create a new sales return order for items or services.;
                                             ESM=Permite crear un pedido de devoluci¢n de venta de productos o servicios.;
                                             FRC=Cr‚ez un retour vente pour les articles ou les services.;
                                             ENC=Create a new sales return order for items or services.];
                                  ApplicationArea=#SalesReturnOrder;
                                  RunObject=Page 6630;
                                  Image=TileNew;
                                  RunPageMode=Create }
                }
                 }

    { 52  ;1   ;Group     ;
                CaptionML=[ENU=Product Videos;
                           ESM=V¡deos de productos;
                           FRC=Vid‚os produits;
                           ENC=Product Videos];
                Visible=ShowProductVideosActivities;
                GroupType=CueGroup;
                ActionList=ACTIONS
                {
                  { 43      ;    ;Action    ;
                                  CaptionML=[ENU=Product Videos;
                                             ESM=V¡deos de productos;
                                             FRC=Vid‚os produits;
                                             ENC=Product Videos];
                                  ToolTipML=[ENU=Open a list of videos that showcase some of the product capabilities.;
                                             ESM=Permite abrir una lista de v¡deos donde se presentan algunas de las caracter¡sticas de cada producto.;
                                             FRC=Ouvrez la liste des vid‚os qui pr‚sentent certaines des fonctions de produit.;
                                             ENC=Open a list of videos that showcase some of the product capabilities.];
                                  ApplicationArea=#Basic,#Suite;
                                  RunObject=Page 1470;
                                  Image=TileVideo }
                }
                 }

    { 44  ;1   ;Group     ;
                CaptionML=[ENU=Get started;
                           ESM=Introducci¢n;
                           FRC=D‚marrer;
                           ENC=Get started];
                Visible=ReplayGettingStartedVisible;
                GroupType=CueGroup;
                ActionList=ACTIONS
                {
                  { 23      ;    ;Action    ;
                                  Name=ShowStartInMyCompany;
                                  CaptionML=[ENU=Try with my own data;
                                             ESM=Probar con mis propios datos;
                                             FRC=Essayer avec mes donn‚es;
                                             ENC=Try with my own data];
                                  ToolTipML=[ENU=Set up My Company with the settings you choose. We'll show you how, it's easy.;
                                             ESM=Permite configurar Mi empresa con las opciones que elija. Le mostraremos c¢mo hacerlo, es f cil.;
                                             FRC=Configurez Ma compagnie avec les paramŠtres que vous s‚lectionnez. Nous allons vous montrer comme c'est simple.;
                                             ENC=Set up My Company with the settings you choose. We'll show you how, it's easy.];
                                  ApplicationArea=#Basic,#Suite;
                                  Visible=FALSE;
                                  Image=TileSettings;
                                  OnAction=BEGIN
                                             IF UserTours.IsAvailable AND O365GettingStartedMgt.AreUserToursEnabled THEN
                                               UserTours.StartUserTour(O365GettingStartedMgt.GetChangeCompanyTourID);
                                           END;
                                            }
                  { 8       ;    ;Action    ;
                                  Name=ReplayGettingStarted;
                                  CaptionML=[ENU=Replay Getting Started;
                                             ESM=Repetir Introducci¢n;
                                             FRC=Revoir la mise en route;
                                             ENC=Replay Getting Started];
                                  ToolTipML=[ENU=Show the Getting Started guide again.;
                                             ESM=Muestra la gu¡a Introducci¢n de nuevo.;
                                             FRC=Affichez … nouveau le guide de d‚marrage rapide.;
                                             ENC=Show the Getting Started guide again.];
                                  ApplicationArea=#Basic,#Suite;
                                  Image=TileVideo;
                                  OnAction=VAR
                                             O365GettingStarted@1000 : Record 1309;
                                           BEGIN
                                             IF O365GettingStarted.GET(USERID,ClientTypeManagement.GetCurrentClientType) THEN BEGIN
                                               O365GettingStarted."Tour in Progress" := FALSE;
                                               O365GettingStarted."Current Page" := 1;
                                               O365GettingStarted.MODIFY;
                                               COMMIT;
                                             END;

                                             O365GettingStartedMgt.LaunchWizard(TRUE,FALSE);
                                           END;
                                            }
                }
                 }

  }
  CODE
  {
    VAR
      ActivitiesMgt@1009 : Codeunit 1311;
      CueSetup@1005 : Codeunit 9701;
      O365GettingStartedMgt@1004 : Codeunit 1309;
      ClientTypeManagement@1023 : Codeunit 4;
      CameraProvider@1007 : DotNet "'Microsoft.Dynamics.Nav.ClientExtensions, Version=11.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35'.Microsoft.Dynamics.Nav.Client.Capabilities.CameraProvider" WITHEVENTS RUNONCLIENT;
      UserTours@1001 : DotNet "'Microsoft.Dynamics.Nav.ClientExtensions, Version=11.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35'.Microsoft.Dynamics.Nav.Client.Capabilities.UserTours" WITHEVENTS RUNONCLIENT;
      PageNotifier@1002 : DotNet "'Microsoft.Dynamics.Nav.ClientExtensions, Version=11.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35'.Microsoft.Dynamics.Nav.Client.PageNotifier" WITHEVENTS RUNONCLIENT;
      HasCamera@1008 : Boolean;
      ShowBookings@1020 : Boolean;
      ShowCamera@1003 : Boolean;
      ShowDocumentsPendingDocExchService@1006 : Boolean;
      ShowStartActivities@1010 : Boolean;
      ShowIncomingDocuments@1011 : Boolean;
      ShowPaymentsActivities@1012 : Boolean;
      ShowPurchasesActivities@1013 : Boolean;
      ShowSalesActivities@1014 : Boolean;
      ShowAwaitingIncomingDoc@1015 : Boolean;
      ShowProductVideosActivities@1019 : Boolean;
      ShowIntercompanyActivities@1021 : Boolean;
      TileGettingStartedVisible@1000 : Boolean;
      ReplayGettingStartedVisible@1016 : Boolean;
      HideNpsDialog@1017 : Boolean;
      WhatIsNewTourVisible@1018 : Boolean;
      ShowUserTaskActivities@1022 : Boolean;

    LOCAL PROCEDURE CalculateCueFieldValues@6();
    BEGIN
      IF FIELDACTIVE("Overdue Sales Invoice Amount") THEN
        "Overdue Sales Invoice Amount" := ActivitiesMgt.CalcOverdueSalesInvoiceAmount(FALSE);
      IF FIELDACTIVE("Overdue Purch. Invoice Amount") THEN
        "Overdue Purch. Invoice Amount" := ActivitiesMgt.CalcOverduePurchaseInvoiceAmount(FALSE);
      IF FIELDACTIVE("Sales This Month") THEN
        "Sales This Month" := ActivitiesMgt.CalcSalesThisMonthAmount(FALSE);
      IF FIELDACTIVE("Top 10 Customer Sales YTD") THEN
        "Top 10 Customer Sales YTD" := ActivitiesMgt.CalcTop10CustomerSalesRatioYTD;
      IF FIELDACTIVE("Average Collection Days") THEN
        "Average Collection Days" := ActivitiesMgt.CalcAverageCollectionDays;
      IF FIELDACTIVE("Uninvoiced Bookings") THEN
        "Uninvoiced Bookings" := ActivitiesMgt.CalcUninvoicedBookings;
    END;

    LOCAL PROCEDURE SetActivityGroupVisibility@12();
    VAR
      StartActivitiesMgt@1001 : Codeunit 1328;
      SalesActivitiesMgt@1002 : Codeunit 1329;
      PurchasesActivitiesMgt@1003 : Codeunit 1331;
      PaymentsActivitiesMgt@1004 : Codeunit 1332;
      IncDocActivitiesMgt@1005 : Codeunit 1333;
      ProductVideosActivitiesMgt@1000 : Codeunit 1345;
      UserTaskActivitiesMgt@1006 : Codeunit 1347;
    BEGIN
      ShowStartActivities := StartActivitiesMgt.IsActivitiesVisible;
      ShowSalesActivities := SalesActivitiesMgt.IsActivitiesVisible;
      ShowPurchasesActivities := PurchasesActivitiesMgt.IsActivitiesVisible;
      ShowPaymentsActivities := PaymentsActivitiesMgt.IsActivitiesVisible;
      ShowIncomingDocuments := IncDocActivitiesMgt.IsActivitiesVisible;
      ShowProductVideosActivities := ProductVideosActivitiesMgt.IsActivitiesVisible;
      ShowCamera := HasCamera AND ShowIncomingDocuments;
      ShowIntercompanyActivities := ("IC Inbox Transactions" <> 0) OR ("IC Outbox Transactions" <> 0);
      ShowUserTaskActivities := UserTaskActivitiesMgt.IsActivitiesVisible;
    END;

    LOCAL PROCEDURE StartWhatIsNewTour@45(hasTourCompleted@1000 : Boolean);
    VAR
      O365UserTours@1001 : Record 1314;
      TourID@1003 : Integer;
    BEGIN
      TourID := O365GettingStartedMgt.GetWhatIsNewTourID;

      IF O365UserTours.AlreadyCompleted(TourID) THEN
        EXIT;

      IF NOT hasTourCompleted THEN BEGIN
        UserTours.StartUserTour(TourID);
        WhatIsNewTourVisible := TRUE;
        EXIT;
      END;

      IF WhatIsNewTourVisible THEN BEGIN
        O365UserTours.MarkAsCompleted(TourID);
        WhatIsNewTourVisible := FALSE;
      END;
    END;

    LOCAL PROCEDURE PrepareOnLoadDialog@30();
    BEGIN
      IF PrepareUserTours THEN
        EXIT;
      PreparePageNotifier;
    END;

    LOCAL PROCEDURE PreparePageNotifier@8();
    BEGIN
      IF NOT PageNotifier.IsAvailable THEN
        EXIT;
      PageNotifier := PageNotifier.Create;
      PageNotifier.NotifyPageReady;
    END;

    LOCAL PROCEDURE PrepareUserTours@9() : Boolean;
    VAR
      NetPromoterScore@1002 : Record 1433;
    BEGIN
      IF (NOT UserTours.IsAvailable) OR (NOT O365GettingStartedMgt.AreUserToursEnabled) THEN
        EXIT(FALSE);
      UserTours := UserTours.Create;
      UserTours.NotifyShowTourWizard;
      IF O365GettingStartedMgt.IsGettingStartedSupported THEN BEGIN
        HideNpsDialog := O365GettingStartedMgt.WizardHasToBeLaunched(FALSE);
        IF HideNpsDialog THEN
          NetPromoterScore.DisableRequestSending;
      END;
      EXIT(TRUE);
    END;

    EVENT CameraProvider@1007::PictureAvailable@10(PictureName@1001 : Text;PictureFilePath@1000 : Text);
    VAR
      IncomingDocument@1002 : Record 130;
    BEGIN
      IncomingDocument.CreateIncomingDocumentFromServerFile(PictureName,PictureFilePath);
      CurrPage.UPDATE;
    END;

    EVENT UserTours@1001::ShowTourWizard@13(hasTourCompleted@1000 : Boolean);
    VAR
      NetPromoterScoreMgt@1001 : Codeunit 1432;
    BEGIN
      IF O365GettingStartedMgt.IsGettingStartedSupported THEN
        IF O365GettingStartedMgt.LaunchWizard(FALSE,hasTourCompleted) THEN
          EXIT;

      IF (NOT hasTourCompleted) AND (NOT HideNpsDialog) THEN
        IF NetPromoterScoreMgt.ShowNpsDialog THEN BEGIN
          HideNpsDialog := TRUE;
          EXIT;
        END;

      StartWhatIsNewTour(hasTourCompleted);
    END;

    EVENT UserTours@1001::IsTourInProgressResultReady@14(isInProgress@1000 : Boolean);
    BEGIN
    END;

    EVENT PageNotifier@1002::PageReady@9();
    VAR
      NetPromoterScoreMgt@1000 : Codeunit 1432;
    BEGIN
      IF O365GettingStartedMgt.WizardShouldBeOpenedForDevices THEN BEGIN
        COMMIT;
        PAGE.RUNMODAL(PAGE::"O365 Getting Started Device");
        EXIT;
      END;

      IF NOT HideNpsDialog THEN
        IF NetPromoterScoreMgt.ShowNpsDialog THEN
          HideNpsDialog := TRUE;
    END;

    BEGIN
    END.
  }
}

