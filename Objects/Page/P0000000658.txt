OBJECT Page 658 Approval Entries
{
  OBJECT-PROPERTIES
  {
    Date=10/13/21;
    Time=[ 5:05:39 AM];
    Modified=Yes;
    Version List=NAVW111.00.00.33015,3300,002;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[ENU=Approval Entries;
               ESM=Movimientos aprobaci¢n;
               FRC=êcritures approbation;
               ENC=Approval Entries];
    SourceTable=Table454;
    SourceTableView=SORTING(Table ID,Document Type,Document No.,Date-Time Sent for Approval)
                    ORDER(Ascending);
    PageType=List;
    OnOpenPage=VAR
                 Filterstring@1000 : Text;
               BEGIN
                 Page658EventPublisher.Pg658_OnOpenPage(Rec,Filterstring,Overdue);  //TPZ2829 Event Conversion
               END;

    OnAfterGetRecord=BEGIN
                       Overdue := Overdue::" ";
                       IF FormatField(Rec) THEN
                         Overdue := Overdue::Yes;
                       Page658EventPublisher.Pg658_OnAfterGetRecord(Rec,StyleText,Billto_CustNo,Location_Code,Shipment_Method,Shipping_Agent_Code,StyleTextLimitType,StyleTextImarkCust);//<TPZ2829 Event Conversion VAH 3300
                     END;

    OnAfterGetCurrRecord=VAR
                           RecRef@1000 : RecordRef;
                         BEGIN
                           ShowChangeFactBox := CurrPage.Change.PAGE.SetFilterFromApprovalEntry(Rec);
                           DelegateEnable := CanCurrentUserEdit;
                           ShowRecCommentsEnabled := RecRef.GET("Record ID to Approve");
                         END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 33      ;1   ;ActionGroup;
                      CaptionML=[ENU=&Show;
                                 ESM=&Mostrar;
                                 FRC=&Afficher;
                                 ENC=&Show];
                      Image=View }
      { 38      ;2   ;Action    ;
                      CaptionML=[ENU=Document;
                                 ESM=Registro;
                                 FRC=Enregistrement;
                                 ENC=Record];
                      ToolTipML=[ENU=Open the document, journal line, or card that the approval request is for.;
                                 ESM=Abre el documento, la l°nea del diario o la ficha a la que corresponde a la solicitud de aprobaci¢n.;
                                 FRC=Ouvrez le document, la ligne feuille ou la fiche pour laquelle l'approbation est demandÇe.;
                                 ENC=Open the document, journal line, or card that the approval request is for.];
                      ApplicationArea=#Suite;
                      Promoted=Yes;
                      Enabled=TRUE;
                      PromotedIsBig=Yes;
                      Image=Document;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 ApprovalComments@1000000000 : Page 660;
                               BEGIN
                                 {
                                 //TOP230 KT ABCSI CRP 2 Fixes 05012015 - Start
                                 ApprovalComments.Setfilters("Table ID","Document Type","Document No.");
                                 ApprovalComments.RUNMODAL;
                                 //TOP230 KT ABCSI CRP 2 Fixes 05012015 - End
                                 }

                                 ShowRecord;
                               END;
                                }
      { 42      ;2   ;Action    ;
                      Name=Comments;
                      CaptionML=[ENU=Comments;
                                 ESM=Comentarios;
                                 FRC=Commentaires;
                                 ENC=Comments];
                      ToolTipML=[ENU=View or add comments for the record.;
                                 ESM=Permite ver o agregar comentarios para el registro.;
                                 FRC=Afficher ou ajouter des commentaires pour l'enregistrement.;
                                 ENC=View or add comments for the record.];
                      ApplicationArea=#Suite;
                      Promoted=Yes;
                      Enabled=TRUE;
                      PromotedIsBig=Yes;
                      Image=ViewComments;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 ApprovalsMgmt@1001 : Codeunit 1535;
                                 RecRef@1000 : RecordRef;
                                 ApprovalComments@1000000000 : Page 660;
                               BEGIN

                                 //TOP230 KT ABCSI CRP 2 Fixes 05012015 - Start
                                 //<TPZ2474>
                                 //ApprovalComments.Setfilters("Table ID","Document Type","Document No.");
                                 //ApprovalComments.RUNMODAL;

                                 {//TOP230 KT ABCSI CRP 2 Fixes 05012015 - Start
                                 ApprovalComments.Setfilters("Table ID","Document Type","Document No.");
                                 ApprovalComments.RUNMODAL;
                                 //TOP230 KT ABCSI CRP 2 Fixes 05012015 - End
                                 //{=======} TARGET
                                 RecRef.GET("Record ID to Approve");
                                 CLEAR(ApprovalsMgmt);
                                 ApprovalsMgmt.GetApprovalCommentForWorkflowStepInstanceID(RecRef,"Workflow Step Instance ID");
                                 //{<<<<<<<}
                                 }
                               END;
                                }
      { 49      ;2   ;Action    ;
                      CaptionML=[ENU=O&verdue Entries;
                                 ESM=Movs. &vencidos;
                                 FRC=êcritures Ç&chues;
                                 ENC=O&verdue Entries];
                      ToolTipML=[ENU=View approval requests that are overdue.;
                                 ESM=Permite ver las solicitudes de aprobaci¢n vencidas.;
                                 FRC=Affichez les demandes d'approbation qui sont Çchues.;
                                 ENC=View approval requests that are overdue.];
                      ApplicationArea=#Suite;
                      Image=OverdueEntries;
                      OnAction=BEGIN
                                 SETFILTER(Status,'%1|%2',Status::Created,Status::Open);
                                 SETFILTER("Due Date",'<%1',TODAY);
                               END;
                                }
      { 50      ;2   ;Action    ;
                      CaptionML=[ENU=All Entries;
                                 ESM=Todos los movs.;
                                 FRC=Toutes les Çcritures;
                                 ENC=All Entries];
                      ToolTipML=[ENU=View all approval entries.;
                                 ESM=Permite ver todos los movimientos de aprobaci¢n.;
                                 FRC=Affichez toutes les Çcritures d'approbation.;
                                 ENC=View all approval entries.];
                      ApplicationArea=#Suite;
                      Image=Entries;
                      OnAction=BEGIN
                                 SETRANGE(Status);
                                 SETRANGE("Due Date");
                               END;
                                }
      { 1000000005;2 ;Action    ;
                      Name=CreditMgt;
                      CaptionML=ENU=Customer Credit Mgt.;
                      Promoted=Yes;
                      Image=TaskQualityMeasure;
                      PromotedCategory=Process }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1000000017;1 ;Action    ;
                      Name=Approve;
                      CaptionML=[ENU=&Approve;
                                 ESM=&Aprobar;
                                 FRC=&Approuver;
                                 ENC=&Approve];
                      Promoted=Yes;
                      Visible=TRUE;
                      PromotedIsBig=Yes;
                      Image=Approve;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 ApprovalEntry@1001 : Record 454;
                               BEGIN
                                 CurrPage.SETSELECTIONFILTER(ApprovalEntry);
                                 IF ApprovalEntry.FIND('-') THEN
                                   REPEAT
                                     ApprovalMgt.ApproveApprovalRequest(ApprovalEntry);
                                   UNTIL ApprovalEntry.NEXT = 0;
                               END;
                                }
      { 1000000015;1 ;Action    ;
                      Name=Reject;
                      CaptionML=[ENU=&Reject;
                                 ESM=&Rechazar;
                                 FRC=&Rejeter;
                                 ENC=&Reject];
                      Promoted=Yes;
                      Visible=TRUE;
                      PromotedIsBig=Yes;
                      Image=Reject;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 ApprovalEntry@1001 : Record 454;
                                 ApprovalSetup@1002 : Record 452;
                                 ApprovalCommentLine@1005 : Record 455;
                                 ApprovalComment@1000 : Page 660;
                               BEGIN
                                 CurrPage.SETSELECTIONFILTER(ApprovalEntry);
                                 IF ApprovalEntry.FIND('-') THEN
                                   REPEAT
                                     IF NOT ApprovalSetup.GET THEN
                                       ERROR(Text004);
                                     IF ApprovalSetup."Request Rejection Comment" = TRUE THEN BEGIN
                                       ApprovalCommentLine.SETRANGE("Table ID",ApprovalEntry."Table ID");
                                       ApprovalCommentLine.SETRANGE("Document Type",ApprovalEntry."Document Type");
                                       ApprovalCommentLine.SETRANGE("Document No.",ApprovalEntry."Document No.");
                                       ApprovalComment.SETTABLEVIEW(ApprovalCommentLine);
                                       IF ApprovalComment.RUNMODAL = ACTION::OK THEN
                                         ApprovalMgt.RejectApprovalRequest(ApprovalEntry);
                                     END ELSE
                                       ApprovalMgt.RejectApprovalRequest(ApprovalEntry);

                                   UNTIL ApprovalEntry.NEXT = 0;
                               END;
                                }
      { 35      ;1   ;Action    ;
                      AccessByPermission=TableData 454=M;
                      CaptionML=[ENU=&Delegate;
                                 ESM=&Delegar;
                                 FRC=&DÇlÇguer;
                                 ENC=&Delegate];
                      ToolTipML=[ENU=Delegate the approval request to another approver that has been set up as your substitute approver.;
                                 ESM=Permite delegar la solicitud de aprobaci¢n en otro aprobador que se ha configurado como su aprobador sustituto.;
                                 FRC=DÇlÇguez la demande d'approbation Ö un autre approbateur dÇfini comme remplaáant.;
                                 ENC=Delegate the approval request to another approver that has been set up as your substitute approver.];
                      ApplicationArea=#Suite;
                      Promoted=Yes;
                      Enabled=TRUE;
                      PromotedIsBig=Yes;
                      Image=Delegate;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 ApprovalEntry@1001 : Record 454;
                                 ApprovalsMgmt@1000 : Codeunit 1535;
                               BEGIN
                                 CurrPage.SETSELECTIONFILTER(ApprovalEntry);
                                 ApprovalsMgmt.DelegateApprovalRequests(ApprovalEntry);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 40  ;2   ;Field     ;
                CaptionML=[ENU=Overdue;
                           ESM=Vencidos;
                           FRC=En retard;
                           ENC=Overdue];
                ToolTipML=[ENU=Specifies that the approval is overdue.;
                           ESM=Especifica que la aprobaci¢n ha vencido.;
                           FRC=SpÇcifie que l'approbation est arrivÇe Ö ÇchÇance.;
                           ENC=Specifies that the approval is overdue.];
                ApplicationArea=#Suite;
                SourceExpr=Overdue;
                Editable=False }

    { 3   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the ID of the table where the record that is subject to approval is stored.;
                           ESM=Especifica el id. de la tabla en la que se almacena el registro sujeto a aprobaci¢n.;
                           FRC=SpÇcifie le code de la table dans laquelle l'enregistrement soumis Ö approbation est stockÇ.;
                           ENC=Specifies the ID of the table where the record that is subject to approval is stored.];
                ApplicationArea=#Advanced;
                SourceExpr="Table ID";
                Visible=FALSE }

    { 45  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the type of limit that applies to the approval template:;
                           ESM=Especifica el tipo de l°mite que se aplica a la plantilla de aprobaci¢n:;
                           FRC=SpÇcifie le type de limite applicable au modäle d'approbationˇ:;
                           ENC=Specifies the type of limit that applies to the approval template:];
                ApplicationArea=#Suite;
                SourceExpr="Limit Type";
                StyleExpr=StyleTextLimitType }

    { 43  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies which approvers apply to this approval template:;
                           ESM=Especifica los aprobadores correspondientes a esta plantilla de aprobaci¢n:;
                           FRC=SpÇcifie les approbateurs qui s'appliquent Ö ce modäle d'approbationˇ:;
                           ENC=Specifies which approvers apply to this approval template:];
                ApplicationArea=#Suite;
                SourceExpr="Approval Type" }

    { 6   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the type of document that an approval entry has been created for. Approval entries can be created for six different types of sales or purchase documents:;
                           ESM=Especifica el tipo de documento para el que se ha creado un movimiento de aprobaci¢n. Se pueden crear movimientos de aprobaci¢n para seis tipos diferentes de documentos de compra o venta:;
                           FRC=SpÇcifie le type de document pour lequel une Çcriture approbation a ÇtÇ crÇÇe. Les Çcritures approbation peuvent àtre crÇÇes pour sixˇdiffÇrents types de documents vente ou achatˇ:;
                           ENC=Specifies the type of document that an approval entry has been created for. Approval entries can be created for six different types of sales or purchase documents:];
                ApplicationArea=#Advanced;
                SourceExpr="Document Type";
                Visible=FALSE }

    { 8   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the document number copied from the relevant sales or purchase document, such as a purchase order or a sales quote.;
                           ESM=Especifica el n£mero de documento copiado del documento compra o venta correspondiente, como un pedido de compra o una oferta de venta.;
                           FRC=SpÇcifie le numÇro du document copiÇ depuis le document vente ou achat appropriÇ, tel qu'une commande achat ou un devis.;
                           ENC=Specifies the document number copied from the relevant sales or purchase document, such as a purchase order or a sales quote.];
                ApplicationArea=#Advanced;
                SourceExpr="Document No.";
                Visible=FALSE }

    { 9   ;2   ;Field     ;
                Name=Details;
                ToolTipML=[ENU=Specifies the record that the approval is related to.;
                           ESM=Especifica el registro al que est† relacionada la aprobaci¢n.;
                           FRC=SpÇcifie l'enregistrement auquel l'approbation est associÇe.;
                           ENC=Specifies the record that the approval is related to.];
                ApplicationArea=#Suite;
                SourceExpr=RecordDetails }

    { 10  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the order of approvers when an approval workflow involves more than one approver.;
                           ESM=Especifica el orden de los aprobadores cuando en un flujo de trabajo de aprobaci¢n intervienen varios aprobadores.;
                           FRC=SpÇcifie l'ordre des approbateurs lorsqu'un flux de travail approbation implique plusieurs approbateurs.;
                           ENC=Specifies the order of approvers when an approval workflow involves more than one approver.];
                ApplicationArea=#Suite;
                SourceExpr="Sequence No." }

    { 1000000000;2;Field  ;
                SourceExpr="Customer No.";
                StyleExpr=StyleTextImarkCust }

    { 1000000008;2;Field  ;
                SourceExpr="Customer Name";
                StyleExpr=StyleTextImarkCust }

    { 1000000009;2;Field  ;
                SourceExpr="Customer PO No." }

    { 1000000018;2;Field  ;
                SourceExpr="Approval Code" }

    { 21  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the approval status for the entry:;
                           ESM=Especifica de estado de aprobaci¢n del movimiento:;
                           FRC=SpÇcifie le statut d'approbation pour l'Çcritureˇ:;
                           ENC=Specifies the approval status for the entry:];
                ApplicationArea=#Suite;
                SourceExpr=Status }

    { 1000000001;2;Field  ;
                SourceExpr="Whse. Shpt. Requested" }

    { 1000000002;2;Field  ;
                SourceExpr="Approval Reason Code";
                StyleExpr=StyleTextLimitType }

    { 1000000003;2;Field  ;
                SourceExpr="Warning Message";
                StyleExpr=StyleTextLimitType }

    { 14  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the ID of the user who sent the approval request for the document to be approved.;
                           ESM=Especifica el id. del usuario que ha enviado la solicitud de aprobaci¢n del documento para su aprobaci¢n.;
                           FRC=SpÇcifie le code de l'utilisateur qui a envoyÇ la demande d'approbation pour le document Ö approuver.;
                           ENC=Specifies the ID of the user who sent the approval request for the document to be approved.];
                ApplicationArea=#Suite;
                SourceExpr="Sender ID" }

    { 16  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code for the salesperson or purchaser that was in the document to be approved. It is not a mandatory field, but is useful if a salesperson or a purchaser responsible for the customer/vendor needs to approve the document before it is processed.;
                           ESM=Especifica el c¢digo del vendedor o el comprador especificado en el documento para aprobar. No es un campo obligatorio, pero resulta £til si un vendedor o un comprador responsable del cliente o el proveedor necesita que se apruebe el documento antes de procesarlo.;
                           FRC=SpÇcifie le code du vendeur ou de l'acheteur dans le document Ö approuver. Il n'est pas obligatoire, mais il est utile si un vendeur ou un acheteur responsable pour le client/fournisseur doit approuver le document avant qu'il ne soit traitÇ.;
                           ENC=Specifies the code for the salesperson or purchaser that was in the document to be approved. It is not a mandatory field, but is useful if a salesperson or a purchaser responsible for the customer/vendor needs to approve the document before it is processed.];
                ApplicationArea=#Suite;
                SourceExpr="Salespers./Purch. Code" }

    { 18  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the ID of the user who must approve the document.;
                           ESM=Especifica el ID del usuario que debe aprobar el documento.;
                           FRC=SpÇcifie le code de l'utilisateur qui doit approuver le document.;
                           ENC=Specifies the ID of the user who must approve the document.];
                ApplicationArea=#Suite;
                SourceExpr="Approver ID" }

    { 1000000010;2;Field  ;
                SourceExpr="Manual Approval";
                Visible=FALSE }

    { 36  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code of the currency of the amounts on the sales or purchase lines.;
                           ESM=Especifica el c¢digo de divisa de los importes de las l°neas de venta o compra.;
                           FRC=SpÇcifie le code de la devise des montants des lignes vente ou achat.;
                           ENC=Specifies the code of the currency of the amounts on the sales or purchase lines.];
                ApplicationArea=#Suite;
                SourceExpr="Currency Code" }

    { 34  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the total amount (excl. tax) on the document awaiting approval. The amount is stated in the local currency.;
                           ESM=Especifica el importe total (sin IVA) del documento en espera de aprobaci¢n. El importe se indica en la divisa local.;
                           FRC=SpÇcifie le montant total (hors TVA) du document en attente d'approbation. Le montant est exprimÇ dans la devise sociÇtÇ.;
                           ENC=Specifies the total amount (excl. Tax) on the document awaiting approval. The amount is stated in the local currency.];
                ApplicationArea=#Suite;
                SourceExpr="Amount (LCY)" }

    { 47  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the remaining credit (in $) that exists for the customer.;
                           ESM=Especifica el crÇdito (en DL) que le queda al cliente.;
                           FRC=SpÇcifie le crÇdit restant (en DS) qui existe pour le client.;
                           ENC=Specifies the remaining credit (in $) that exists for the customer.];
                ApplicationArea=#Suite;
                SourceExpr="Available Credit Limit (LCY)" }

    { 1000000004;2;Field  ;
                SourceExpr="Overdue Balance (LCY)" }

    { 1000000006;2;Field  ;
                SourceExpr="Margin %" }

    { 1000000007;2;Field  ;
                SourceExpr="Margin Amount (LCY)" }

    { 23  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the date and the time that the document was sent for approval.;
                           ESM=Especifica la fecha y la hora en que se envi¢ el documento para su aprobaci¢n.;
                           FRC=SpÇcifie la date et l'heure auxquelles le document a ÇtÇ envoyÇ pour approbation.;
                           ENC=Specifies the date and the time that the document was sent for approval.];
                ApplicationArea=#Suite;
                SourceExpr="Date-Time Sent for Approval" }

    { 25  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the date when the approval entry was last modified. If, for example, the document approval is canceled, this field will be updated accordingly.;
                           ESM=Especifica la fecha en que se modific¢ por £ltima vez el movimiento de aprobaci¢n. Si, por ejemplo, se cancela la aprobaci¢n del documento, este campo se actualizar† en consecuencia.;
                           FRC=SpÇcifie la date Ö laquelle l'Çcriture approbation a ÇtÇ modifiÇe pour la derniäre fois. Si l'approbation du document est annulÇe, ce champ est mis Ö jour en consÇquence.;
                           ENC=Specifies the date when the approval entry was last modified. If, for example, the document approval is cancelled, this field will be updated accordingly.];
                ApplicationArea=#Suite;
                SourceExpr="Last Date-Time Modified" }

    { 27  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the ID of the user who last modified the approval entry. If, for example, the document approval is canceled, this field will be updated accordingly.;
                           ESM=Especifica el id. del usuario que modific¢ por £ltima vez el movimiento de aprobaci¢n. Si, por ejemplo, se cancela la aprobaci¢n del documento, este campo se actualizar† en consecuencia.;
                           FRC=SpÇcifie l'ID de l'utilisateur qui a modifiÇ l'Çcriture approbation pour la derniäre fois. Si l'approbation du document est annulÇe, ce champ est mis Ö jour en consÇquence.;
                           ENC=Specifies the ID of the user who last modified the approval entry. If, for example, the document approval is cancelled, this field will be updated accordingly.];
                ApplicationArea=#Suite;
                SourceExpr="Last Modified By User ID" }

    { 29  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies whether there are comments relating to the approval of the record. If you want to read the comments, choose the field to open the Approval Comment Sheet window.;
                           ESM=Especifica si hay comentarios relativos a la aprobaci¢n del registro. Si desea leer los comentarios, seleccione el campo para abrir la ventana Hoja comentarios.;
                           FRC=Indique s'il existe des commentaires relatifs Ö l'approbation de l'enregistrement. Pour lire les commentaires, choisissez le champ pour ouvrir la fenàtre Feuille de commentaires d'approbation.;
                           ENC=Specifies whether there are comments relating to the approval of the record. If you want to read the comments, choose the field to open the Approval Comment Sheet window.];
                ApplicationArea=#Suite;
                SourceExpr=Comment;
                StyleExpr=StyleText }

    { 31  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies when the record must be approved, by one or more approvers.;
                           ESM=Especifica cu†ndo uno o varios aprobadores deben aprobar el registro.;
                           FRC=Indique la date Ö laquelle l'enregistrement doit àtre approuvÇ et par qui.;
                           ENC=Specifies when the record must be approved, by one or more approvers.];
                ApplicationArea=#Suite;
                SourceExpr="Due Date" }

    { 1000000011;2;Field  ;
                SourceExpr="Shortcut Dimension 5 Code";
                Visible=FALSE }

    { 1000000012;2;Field  ;
                CaptionML=ENU=Bill-to Customer No.;
                SourceExpr=Billto_CustNo }

    { 1000000013;2;Field  ;
                CaptionML=ENU=Location Code;
                SourceExpr=Location_Code }

    { 1000000014;2;Field  ;
                CaptionML=ENU=Shipment Method Code;
                SourceExpr=Shipment_Method }

    { 1000000016;2;Field  ;
                Name=shipping_Agent_Code;
                CaptionML=ENU=Shipping Agent Code;
                SourceExpr=Shipping_Agent_Code }

    { 7   ;0   ;Container ;
                ContainerType=FactBoxArea }

    { 11  ;1   ;Part      ;
                Name=Change;
                ApplicationArea=#Suite;
                PagePartID=Page1527;
                Visible=ShowChangeFactBox;
                Enabled=FALSE;
                Editable=FALSE;
                PartType=Page;
                ShowFilter=No;
                UpdatePropagation=SubPart }

    { 5   ;1   ;Part      ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 4   ;1   ;Part      ;
                Visible=TRUE;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      ApprovalMgt@1000000012 : Codeunit 1535;
      Usersetup@1000 : Record 91;
      Overdue@1005 : 'Yes, ';
      RecordIDText@1001 : Text;
      ShowChangeFactBox@1002 : Boolean;
      DelegateEnable@1003 : Boolean;
      ShowRecCommentsEnabled@1004 : Boolean;
      ApproveVisible@1000000010 : Boolean INDATASET;
      RejectVisible@1000000011 : Boolean INDATASET;
      "***ABCSI Globals***"@1000000000 : Integer;
      CustRec@1000000001 : Record 18;
      SalesHeader@1000000002 : Record 36;
      StyleText@1000000003 : Text[20];
      tmpCust@1000000006 : Record 18;
      Billto_CustNo@1000000004 : Code[20];
      Location_Code@1000000005 : Code[10];
      Shipment_Method@1000000008 : Code[10];
      tmpSalesHeader@1000000007 : Record 36;
      Shipping_Agent_Code@1000000009 : Code[20];
      Text001@1000000015 : TextConst 'ENU=You can only delegate open approval entries.;ESM=S¢lo puede delegar los movs. aprobaci¢n abiertos.;FRC=Vous ne pouvez dÇlÇguer que les Çcritures d''approbation ouvertes.;ENC=You can only delegate open approval entries.';
      Text002@1000000014 : TextConst 'ENU="The selected approval(s) have been delegated. ";ESM="Se han delegado las aprobaciones seleccionadas. ";FRC="La ou les approbations sÇlectionnÇes ont ÇtÇ dÇlÇguÇes. ";ENC="The selected approval(s) have been delegated. "';
      Text004@1000000013 : TextConst 'ENU=Approval Setup not found.;ESM=No se encontr¢ la configuraci¢n de la aprobaci¢n;FRC=ParamÇtrage approbation introuvable.;ENC=Approval Setup not found.';
      Page658EventPublisher@1000000016 : Codeunit 51871;
      StyleTextLimitType@1000000017 : Text;
      StyleTextImarkCust@1000000018 : Text;

    [External]
    PROCEDURE Setfilters@1(TableId@1001 : Integer;DocumentType@1002 : 'Quote,Order,Invoice,Credit Memo,Blanket Order,Return Order';DocumentNo@1003 : Code[20]);
    BEGIN
      IF TableId <> 0 THEN BEGIN
        FILTERGROUP(2);
        SETCURRENTKEY("Table ID","Document Type","Document No.","Date-Time Sent for Approval");
        SETRANGE("Table ID",TableId);
        SETRANGE("Document Type",DocumentType);
        IF DocumentNo <> '' THEN
          SETRANGE("Document No.",DocumentNo);
        FILTERGROUP(0);
      END;
      // <TPZ589>
      {IF NOT (Usersetup.GET(USERID) AND Usersetup."Manual Margin Approval") THEN BEGIN
        ApproveVisible := FALSE;
        RejectVisible := FALSE;
      END;
      }
      // </TPZ589>
    END;

    LOCAL PROCEDURE FormatField@2(ApprovalEntry@1000 : Record 454) : Boolean;
    BEGIN
      IF Status IN [Status::Created,Status::Open] THEN BEGIN
        IF ApprovalEntry."Due Date" < TODAY THEN
          EXIT(TRUE);

        EXIT(FALSE);
      END;
    END;

    [External]
    PROCEDURE CalledFrom@3();
    BEGIN
      Overdue := Overdue::" ";
    END;

    BEGIN
    {
      TOP150 - KT ABCSI Sales Order Margin Review 04032015
        - Added fields Whse. Shpt. Requested, Approval Reason Code, Warning Message, Overdue Balance (LCY)
        - Added new Action for opening Customer Credit Management page
        - Commented the line of code on OnOpenPage trigger

      TOP230 KT ABCSI CRP 2 Fixes 05012015
        - Added fields Customer No., Customer Name, Customer PO No.
        - Cleared the default RunObject, RunPageView, RunPageLink and added a code under OnAction trigger to open the Comment Sheet page

      2015-08-04 TPZ589 VCHERNYA
        Credit Limit/Overdue Bal. filtering has been added, Approve and Reject page actions have been
          made visible for users with Manual Margin Approval check marked in User Setup
        Manual Approval field has been added
      2016-03-10 TPZ1257 EBAGIM
        Approval Screen if comment exist Color in red

      2016-03-10 TPZ1258 EBAGIM
       Added fields: Bill-to Customer Number, Location Code,Shipment Method Code,Shipping Agent Code
      2019-01-04 UCHOUHAN TPZ2474
        Commented old function call and Added new functon called code to update "Record ID to Approve".

      001 08182021 VAh TPZ3300 StyleExpression StyleTextLimitType added in Fields "Limit Type", "Approval Reason Code","Warning Message"
          Parameter Added in functions

      002 10132021 UTK TPZ3356 StyleExpression StyleTextImarkCust added in Fields "Customer No." and "Customer Name".
          StyleTextImarkCust Parameter Added in function call at OnAfterGetRecord.
    }
    END.
  }
}

