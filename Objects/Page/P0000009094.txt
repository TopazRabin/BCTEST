OBJECT Page 9094 Vendor Statistics FactBox
{
  OBJECT-PROPERTIES
  {
    Date=10/22/20;
    Time=[ 4:57:39 AM];
    Version List=NAVW111.00.00.20348;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Vendor Statistics;
               ESM=Estad¡sticas proveedor;
               FRC=Statistiques fournisseur;
               ENC=Vendor Statistics];
    SourceTable=Table23;
    PageType=CardPart;
    OnInit=BEGIN
             ShowVendorNo := TRUE;
           END;

    OnOpenPage=BEGIN
                 ;ESACC_EasySecurity(TRUE);
               END;

    OnFindRecord=BEGIN
                   TotalAmountLCY := 0;

                   EXIT(FIND(Which));
                 END;

    OnAfterGetRecord=BEGIN
                       FILTERGROUP(4);
                       SETAUTOCALCFIELDS("Balance (LCY)","Outstanding Orders (LCY)","Amt. Rcd. Not Invoiced (LCY)","Outstanding Invoices (LCY)");
                       TotalAmountLCY := "Balance (LCY)" + "Outstanding Orders (LCY)" + "Amt. Rcd. Not Invoiced (LCY)" + "Outstanding Invoices (LCY)";
                     END;

  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 13  ;1   ;Field     ;
                CaptionML=[ENU=Vendor No.;
                           ESM=N§ proveedor;
                           FRC=Nø fournisseur;
                           ENC=Vendor No.];
                ToolTipML=[ENU=Specifies the number of the vendor. The field is either filled automatically from a defined number series, or you enter the number manually because you have enabled manual number entry in the number-series setup.;
                           ESM=Especifica el n£mero del proveedor. El campo se rellena autom ticamente a partir de una serie num‚rica definida o de forma manual porque se habilit¢ la entrada manual de n£meros en la configuraci¢n de series num‚ricas.;
                           FRC=Sp‚cifie le num‚ro du fournisseur. Le champ est soit renseign‚ automatiquement … partir d'une s‚rie de num‚ros d‚finie, soit vous entrez manuellement le num‚ro car vous avez activ‚ la saisie manuelle de num‚ros dans la configuration de la s‚rie de num‚ros.;
                           ENC=Specifies the number of the vendor. The field is either filled automatically from a defined number series, or you enter the number manually because you have enabled manual number entry in the number-series setup.];
                ApplicationArea=#All;
                SourceExpr="No.";
                Visible=ESACC_F1_Visible AND (ShowVendorNo);
                Editable=ESACC_F1_Editable;
                HideValue=ESACC_F1_HideValue;
                OnDrillDown=BEGIN
                              ShowDetails;
                            END;
                             }

    { 4   ;1   ;Field     ;
                ToolTipML=[ENU=Specifies the total value of your completed purchases from the vendor in the current fiscal year. It is calculated from amounts excluding tax on all completed purchase invoices and credit memos.;
                           ESM=Especifica el valor total de sus compras completadas al proveedor en el ejercicio actual. Se calcula a partir de importes sin IVA sobre facturas y notas de cr‚dito de compra completadas.;
                           FRC=Sp‚cifie la valeur totale de vos achats termin‚s auprŠs du fournisseur au cours de l'exercice financier en cours. Elle est calcul‚e … partir des montants hors TVA sur toutes les notes de cr‚dit et factures achat termin‚es.;
                           ENC=Specifies the total value of your completed purchases from the vendor in the current fiscal year. It is calculated from amounts excluding tax on all completed purchase invoices and credit memos.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Balance (LCY)";
                Visible=ESACC_F59_Visible;
                HideValue=ESACC_F59_HideValue;
                OnDrillDown=VAR
                              VendLedgEntry@1001 : Record 25;
                              DtldVendLedgEntry@1000 : Record 380;
                            BEGIN
                              DtldVendLedgEntry.SETRANGE("Vendor No.","No.");
                              COPYFILTER("Global Dimension 1 Filter",DtldVendLedgEntry."Initial Entry Global Dim. 1");
                              COPYFILTER("Global Dimension 2 Filter",DtldVendLedgEntry."Initial Entry Global Dim. 2");
                              COPYFILTER("Currency Filter",DtldVendLedgEntry."Currency Code");
                              VendLedgEntry.DrillDownOnEntries(DtldVendLedgEntry);
                            END;
                             }

    { 5   ;1   ;Field     ;
                ToolTipML=[ENU=Specifies the sum of outstanding orders (in $) to this vendor.;
                           ESM=Especifica la suma de pedidos pendientes (en la divisa local) realizados a este proveedor.;
                           FRC=Sp‚cifie le total des commandes ouvertes (en $) pour ce fournisseur.;
                           ENC=Specifies the sum of outstanding orders (in $) to this vendor.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Outstanding Orders (LCY)";
                Visible=ESACC_F113_Visible;
                HideValue=ESACC_F113_HideValue }

    { 6   ;1   ;Field     ;
                CaptionML=[ENU=Amt. Rcd. Not Invd. ($);
                           ESM=Cdad. recibida no fact. ($);
                           FRC=Montant re‡u non factur‚ ($);
                           ENC=Amt. Rcd. Not Invd. ($)];
                ToolTipML=[ENU=Specifies the total invoice amount (in $) for the items you have received but not yet been invoiced for.;
                           ESM=Especifica el importe total de la factura (en la divisa local) referente a los productos que recibi¢, pero que todav¡a no le han facturado.;
                           FRC=Sp‚cifie le montant de facture total (en $) pour les articles que vous avez re‡us mais qui ne vous ont pas encore ‚t‚ factur‚s.;
                           ENC=Specifies the total invoice amount (in $) for the items you have received but not yet been invoiced for.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Amt. Rcd. Not Invoiced (LCY)";
                Visible=ESACC_F114_Visible;
                HideValue=ESACC_F114_HideValue }

    { 7   ;1   ;Field     ;
                ToolTipML=[ENU=Specifies the sum of the vendor's outstanding purchase invoices in $.;
                           ESM=Especifica la suma de las facturas de compra pendientes del proveedor en la divisa local.;
                           FRC=Sp‚cifie la somme des factures achat ouvertes du fournisseur en devise soci‚t‚.;
                           ENC=Specifies the sum of the vendor's outstanding purchase invoices in $.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Outstanding Invoices (LCY)";
                Visible=ESACC_F126_Visible;
                HideValue=ESACC_F126_HideValue }

    { 9   ;1   ;Field     ;
                CaptionML=[ENU=Total ($);
                           ESM=Total ($);
                           FRC=Total ($);
                           ENC=Total ($)];
                ToolTipML=[ENU=Specifies the payment amount that you owe the vendor for completed purchases plus purchases that are still ongoing.;
                           ESM=Especifica el importe de pago que debe al proveedor por las compras completadas m s las compras en curso.;
                           FRC=Sp‚cifie le montant rŠglement que vous devez au fournisseur pour les achats effectu‚s et pour ceux toujours en cours.;
                           ENC=Specifies the payment amount that you owe the vendor for completed purchases plus purchases that are still ongoing.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=TotalAmountLCY;
                AutoFormatType=1 }

    { 12  ;1   ;Field     ;
                Name=Balance Due (LCY);
                CaptionML=[ENU=Balance Due ($);
                           ESM=Saldo vencido ($);
                           FRC=Solde d– ($);
                           ENC=Balance Due ($)];
                ApplicationArea=#Advanced;
                SourceExpr=CalcOverDueBalance;
                CaptionClass=FORMAT(STRSUBSTNO(Text000,FORMAT(WORKDATE)));
                OnDrillDown=VAR
                              VendLedgEntry@1001 : Record 25;
                              DtldVendLedgEntry@1000 : Record 380;
                            BEGIN
                              DtldVendLedgEntry.SETFILTER("Vendor No.","No.");
                              COPYFILTER("Global Dimension 1 Filter",DtldVendLedgEntry."Initial Entry Global Dim. 1");
                              COPYFILTER("Global Dimension 2 Filter",DtldVendLedgEntry."Initial Entry Global Dim. 2");
                              COPYFILTER("Currency Filter",DtldVendLedgEntry."Currency Code");
                              VendLedgEntry.DrillDownOnOverdueEntries(DtldVendLedgEntry);
                            END;
                             }

    { 1   ;1   ;Field     ;
                CaptionML=[ENU=Invoiced Prepayment Amount ($);
                           ESM=Importe anticipo facturado ($);
                           FRC=Montant acompte factur‚ DS;
                           ENC=Invoiced Prepayment Amount ($)];
                ToolTipML=[ENU=Specifies your payments to the vendor, based on invoiced prepayments.;
                           ESM=Especifica los pagos al proveedor, en funci¢n de los anticipos facturados.;
                           FRC=Sp‚cifie vos paiements vers‚s au fournisseur en fonction des paiements anticip‚s factur‚s.;
                           ENC=Specifies your payments to the vendor, based on invoiced prepayments.];
                ApplicationArea=#Prepayments;
                SourceExpr=GetInvoicedPrepmtAmountLCY }

  }
  CODE
  {
    VAR
      ESACC_ESFLADSMgt@14123801 : Codeunit 14123801;
      ESACC_F1_Visible@900000010 : Boolean INDATASET;
      ESACC_F1_Editable@900000011 : Boolean INDATASET;
      ESACC_F1_HideValue@900000012 : Boolean INDATASET;
      ESACC_F59_Visible@900000590 : Boolean INDATASET;
      ESACC_F59_HideValue@900000592 : Boolean INDATASET;
      ESACC_F113_Visible@900001130 : Boolean INDATASET;
      ESACC_F113_HideValue@900001132 : Boolean INDATASET;
      ESACC_F114_Visible@900001140 : Boolean INDATASET;
      ESACC_F114_HideValue@900001142 : Boolean INDATASET;
      ESACC_F126_Visible@900001260 : Boolean INDATASET;
      ESACC_F126_HideValue@900001262 : Boolean INDATASET;
      TotalAmountLCY@1014 : Decimal;
      Text000@1018 : TextConst 'ENU=Overdue Amounts ($) as of %1;ESM=Importes vencidos ($) a %1;FRC=Montants en souffrance ($) en date %1;ENC=Overdue Amounts ($) as of %1';
      ShowVendorNo@1000 : Boolean;

    LOCAL PROCEDURE ESACC_EasySecurity@14123801(OpenObject@14123801 : Boolean);
    VAR
      SetFilters@14123802 : Codeunit 14123812;
      TempBoolean@14123803 : Boolean;
    BEGIN
      IF OpenObject THEN BEGIN
        SetFilters.Filter23(Rec,8,9094);

        TempBoolean := CurrPage.EDITABLE;
        IF ESACC_ESFLADSMgt.PageGeneral(23,9094,TempBoolean) THEN
          CurrPage.EDITABLE := TempBoolean;
      END;

      ESACC_ESFLADSMgt.PageControl(
        23,9094,0,1,
        ESACC_F1_Visible,ESACC_F1_Editable,ESACC_F1_HideValue);

      ESACC_ESFLADSMgt.PageControl(
        23,9094,0,59,
        ESACC_F59_Visible,TempBoolean,ESACC_F59_HideValue);

      ESACC_ESFLADSMgt.PageControl(
        23,9094,0,113,
        ESACC_F113_Visible,TempBoolean,ESACC_F113_HideValue);

      ESACC_ESFLADSMgt.PageControl(
        23,9094,0,114,
        ESACC_F114_Visible,TempBoolean,ESACC_F114_HideValue);

      ESACC_ESFLADSMgt.PageControl(
        23,9094,0,126,
        ESACC_F126_Visible,TempBoolean,ESACC_F126_HideValue);

      ESACC_EasySecurityManual(OpenObject);
    END;

    LOCAL PROCEDURE ESACC_EasySecurityManual@14123811(OpenObject@14123811 : Boolean);
    BEGIN
    END;

    LOCAL PROCEDURE ShowDetails@1102601000();
    BEGIN
      PAGE.RUN(PAGE::"Vendor Card",Rec);
    END;

    [External]
    PROCEDURE SetVendorNoVisibility@2(Visible@1000 : Boolean);
    BEGIN
      ShowVendorNo := Visible;
    END;

    BEGIN
    END.
  }
}

