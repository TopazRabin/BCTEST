OBJECT Page 50066 Stock Status Wksh. MFR
{
  OBJECT-PROPERTIES
  {
    Date=10/22/20;
    Time=[ 4:57:39 AM];
    Modified=Yes;
    Version List=TOP010,TOPFIX,010B,010C,TPZHOTFIX,010E,170;
  }
  PROPERTIES
  {
    InsertAllowed=No;
    DeleteAllowed=No;
    ModifyAllowed=Yes;
    SourceTable=Table18;
    PageType=Card;
    RefreshOnActivate=Yes;
    OnOpenPage=BEGIN

                 IF FromDocPage THEN BEGIN
                   FILTERGROUP := 2;
                   SETRANGE("No.",CustRec."No.");
                   FILTERGROUP := 0;
                 END;

                 ActivateFields;

                 UserSetup.GET(USERID); //TOP010B KT ABCSI - SSQQ Division Code 07/13/2015
                 ;ESACC_EasySecurity(TRUE);
               END;

    OnAfterGetRecord=BEGIN
                       IF "No." <> xRec."No." THEN
                         BEGIN
                           NewCustQuote := TRUE;
                           NewCust := TRUE;
                           CustNo := "No.";

                           //TOPFIX KT ABCSI 06172015
                           IF NOT FromDocPage THEN BEGIN
                             IF CustDiv.GET("No.",DivisionCodeFilter) THEN BEGIN
                               IF (CustDiv."Location Code" <> '') THEN
                                 LocationCode := CustDiv."Location Code"
                               ELSE
                                 LocationCode := CompanyInformation."Location Code";
                             END;
                           END;
                           //TOPFIX KT ABCSI 06172015
                         END;

                       // <TPZ820>
                       // Commented out because it makes impossible to determine the current record that
                       //   S. S. Item Avail. by Loc. Mtx. page should be opened at
                       // RefreshLines;
                       // </TPZ820>
                     END;

    OnAfterGetCurrRecord=BEGIN
                           RefreshLines;
                         END;

    ActionList=ACTIONS
    {
      { 1000000096;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 1000000095;1 ;ActionGroup;
                      CaptionML=[ENU=&Customer;
                                 ESM=&Cliente;
                                 FRC=&Client;
                                 ENC=&Customer];
                      Image=Customer }
      { 1000000002;2 ;Action    ;
                      Name=Find Customer;
                      ShortCutKey=Ctrl+S;
                      Promoted=Yes;
                      Visible=ESACC_C1000000002_Visible;
                      Enabled=ESACC_C1000000002_Enabled;
                      Image=Find;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CustRecLookup := Rec;
                                 IF PAGE.RUNMODAL(0,CustRecLookup) = ACTION::LookupOK THEN BEGIN
                                   CustNo := CustRecLookup."No.";
                                   Rec := CustRecLookup;
                                   Rec.FIND('=');
                                   CurrPage.UPDATE(FALSE);
                                 END;
                               END;
                                }
      { 1000000029;2 ;Action    ;
                      Name=Customer Card;
                      ShortCutKey=Shift+F7;
                      RunObject=Page 21;
                      RunPageLink=No.=FIELD(No.);
                      Visible=ESACC_C1000000029_Visible;
                      Enabled=ESACC_C1000000029_Enabled;
                      Image=Customer;
                      RunPageMode=Edit }
      { 1000000094;2 ;Action    ;
                      CaptionML=[ENU=Co&mments;
                                 ESM=C&omentarios;
                                 FRC=Co&mmentaires;
                                 ENC=Co&mments];
                      RunObject=Page 124;
                      RunPageLink=Table Name=CONST(Customer),
                                  No.=FIELD(No.);
                      Visible=ESACC_C1000000094_Visible;
                      Enabled=ESACC_C1000000094_Enabled;
                      Image=ViewComments }
      { 1000000093;2 ;ActionGroup;
                      CaptionML=[ENU=Dimensions;
                                 ESM=Dimensiones;
                                 FRC=Dimensions;
                                 ENC=Dimensions];
                      Image=Dimensions }
      { 1000000092;3 ;Action    ;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=[ENU=Dimensions-Single;
                                 ESM=Dimensiones-Individual;
                                 FRC=Dimensions - Simples;
                                 ENC=Dimensions-Single];
                      RunObject=Page 540;
                      RunPageLink=Table ID=CONST(18),
                                  No.=FIELD(No.);
                      Visible=ESACC_C1000000092_Visible;
                      Enabled=ESACC_C1000000092_Enabled;
                      Image=Dimensions }
      { 1000000091;3 ;Action    ;
                      CaptionML=[ENU=Dimensions-&Multiple;
                                 ESM=Dimensiones-&M£ltiple;
                                 FRC=Dimensions - &Multiples;
                                 ENC=Dimensions-&Multiple];
                      Visible=ESACC_C1000000091_Visible;
                      Enabled=ESACC_C1000000091_Enabled;
                      Image=DimensionSets;
                      OnAction=VAR
                                 Cust@1001 : Record 18;
                                 DefaultDimMultiple@1002 : Page 542;
                               BEGIN
                                 CurrPage.SETSELECTIONFILTER(Cust);
                                 DefaultDimMultiple.SetMultiCust(Cust);
                                 DefaultDimMultiple.RUNMODAL;
                               END;
                                }
      { 1000000088;2 ;Action    ;
                      CaptionML=[ENU=Ship-&to Addresses;
                                 ESM=Di&recci¢n env¡o;
                                 FRC=&Adresse (destinataire);
                                 ENC=Ship-&to Addresses];
                      RunObject=Page 301;
                      RunPageLink=Customer No.=FIELD(No.);
                      Visible=ESACC_C1000000088_Visible;
                      Enabled=ESACC_C1000000088_Enabled;
                      Image=ShipAddress }
      { 1000000087;2 ;Action    ;
                      CaptionML=[ENU=C&ontact;
                                 ESM=&Contacto;
                                 FRC=C&ontact;
                                 ENC=C&ontact];
                      Visible=ESACC_C1000000087_Visible;
                      Enabled=ESACC_C1000000087_Enabled;
                      Image=ContactPerson;
                      OnAction=BEGIN
                                 ShowContact;
                               END;
                                }
      { 1000000086;2 ;Action    ;
                      CaptionML=[ENU=Cross Re&ferences;
                                 ESM=Referencias cru&zadas;
                                 FRC=Ren&vois;
                                 ENC=Cross Re&ferences];
                      RunObject=Page 5723;
                      RunPageView=SORTING(Cross-Reference Type,Cross-Reference Type No.);
                      RunPageLink=Cross-Reference Type=CONST(Customer),
                                  Cross-Reference Type No.=FIELD(No.);
                      Visible=ESACC_C1000000086_Visible;
                      Enabled=ESACC_C1000000086_Enabled;
                      Image=Change }
      { 1000000077;2 ;Separator  }
      { 1000000063;1 ;ActionGroup;
                      CaptionML=[ENU=Documents;
                                 ESM=Documentos;
                                 FRC=Documents;
                                 ENC=Documents];
                      Image=Documents }
      { 1000000028;2 ;Action    ;
                      Name=Order Summary;
                      CaptionML=ENU=Show Order Summary;
                      Promoted=Yes;
                      Visible=ESACC_C1000000028_Visible;
                      Enabled=ESACC_C1000000028_Enabled;
                      Image=ViewWorksheet;
                      PromotedCategory=Process;
                      OnAction=BEGIN

                                 IF "Location Code" = '' THEN BEGIN
                                   IF (UserSetup.GET(USERID)) AND (UserSetup."Default Location" <> '') THEN
                                     "Location Code" := UserSetup."Default Location"
                                   ELSE
                                     "Location Code" := "Location Code";
                                 END;

                                 CurrPage."Stock Status Quick Quote".PAGE.SetUserFilters("No.","Location Code",DivisionCodeFilter);
                                 CurrPage."Stock Status Quick Quote".PAGE.Refresh(NewCustQuote);
                                 CurrPage."Stock Status Quick Quote".PAGE.ShowWorksheet;
                               END;
                                }
      { 1000000062;2 ;Action    ;
                      CaptionML=[ENU=Quotes;
                                 ESM=Cotizaciones;
                                 FRC=Devis;
                                 ENC=Quotes];
                      RunObject=Page 9300;
                      RunPageView=SORTING(Sell-to Customer No.);
                      RunPageLink=Sell-to Customer No.=FIELD(No.);
                      Visible=ESACC_C1000000062_Visible;
                      Enabled=ESACC_C1000000062_Enabled;
                      Image=Quote }
      { 1000000061;2 ;Action    ;
                      CaptionML=[ENU=Orders;
                                 ESM=Pedidos;
                                 FRC=Commandes;
                                 ENC=Orders];
                      RunObject=Page 9305;
                      RunPageView=SORTING(Sell-to Customer No.);
                      RunPageLink=Sell-to Customer No.=FIELD(No.);
                      Visible=ESACC_C1000000061_Visible;
                      Enabled=ESACC_C1000000061_Enabled;
                      Image=Document }
      { 1000000060;2 ;Action    ;
                      CaptionML=[ENU=Return Orders;
                                 ESM=Devoluciones;
                                 FRC=Retours;
                                 ENC=Return Orders];
                      RunObject=Page 9304;
                      RunPageView=SORTING(Sell-to Customer No.);
                      RunPageLink=Sell-to Customer No.=FIELD(No.);
                      Visible=ESACC_C1000000060_Visible;
                      Enabled=ESACC_C1000000060_Enabled;
                      Image=ReturnOrder }
      { 1000000015;1 ;ActionGroup;
                      CaptionML=ENU=Related Info.;
                      Image=ReferenceData }
      { 1000000016;2 ;Action    ;
                      Name=Customer Order;
                      RunObject=Page 10009;
                      RunPageView=SORTING(Sell-to Customer No.);
                      RunPageLink=Sell-to Customer No.=FIELD(No.);
                      Visible=ESACC_C1000000016_Visible;
                      Enabled=ESACC_C1000000016_Enabled;
                      Image=Order }
      { 1000000017;2 ;Action    ;
                      Name=Customer Order Line Status;
                      RunObject=Page 10010;
                      RunPageView=SORTING(Sell-to Customer No.);
                      RunPageLink=Sell-to Customer No.=FIELD(No.);
                      Visible=ESACC_C1000000017_Visible;
                      Enabled=ESACC_C1000000017_Enabled;
                      Image=Line }
      { 1000000018;2 ;Action    ;
                      Name=Sales Invoice List;
                      RunObject=Page 9301;
                      RunPageView=SORTING(Sell-to Customer No.);
                      RunPageLink=Sell-to Customer No.=FIELD(No.);
                      Visible=ESACC_C1000000018_Visible;
                      Enabled=ESACC_C1000000018_Enabled;
                      Image=Invoice }
      { 1000000019;2 ;Action    ;
                      Name=Sales Credit Memos List;
                      RunObject=Page 9302;
                      RunPageView=SORTING(Sell-to Customer No.);
                      RunPageLink=Sell-to Customer No.=FIELD(No.);
                      Visible=ESACC_C1000000019_Visible;
                      Enabled=ESACC_C1000000019_Enabled;
                      Image=CreditMemo }
      { 1000000022;1 ;ActionGroup;
                      CaptionML=ENU=Process;
                      ActionContainerType=HomeItems;
                      Image=RefreshLines }
      { 1000000023;2 ;Action    ;
                      Name=Refresh Lines;
                      Promoted=Yes;
                      Visible=ESACC_C1000000023_Visible;
                      Enabled=ESACC_C1000000023_Enabled;
                      Image=SuggestLines;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 RefreshLines;
                               END;
                                }
      { 1000000038;2 ;Action    ;
                      ShortCutKey=F11;
                      CaptionML=ENU=Items b&y Location;
                      Promoted=Yes;
                      Visible=ESACC_C1000000038_Visible;
                      Enabled=ESACC_C1000000038_Enabled;
                      Image=ItemAvailbyLoc;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 StockStatusWkshLine@1000000013 : Record 50000;
                                 MatrixRecord@1000000012 : Record 14;
                                 MatrixRecords@1000000011 : ARRAY [32] OF Record 14;
                                 MatrixRecordRef@1000000010 : RecordRef;
                                 SSItemsByLocMtx@1000000009 : Page 51170;
                                 MatrixMgt@1000000008 : Codeunit 9200;
                                 UserSetupMgt@1000000007 : Codeunit 5700;
                                 MATRIX_SetWanted@1000000006 : 'Initial,Previous,Same,Next';
                                 MATRIX_CaptionSet@1000000005 : ARRAY [32] OF Text[1024];
                                 MATRIX_CaptionRange@1000000004 : Text[100];
                                 MATRIX_PKFirstRecInCurrSet@1000000003 : Text[100];
                                 MATRIX_CurrSetLength@1000000002 : Integer;
                                 CaptionFieldNo@1000000001 : Integer;
                                 CurrentMatrixRecordOrdinal@1000000000 : Integer;
                               BEGIN
                                 // <TPZ820>
                                 MatrixRecord.SETRANGE("Use As In-Transit",FALSE);
                                 MatrixRecord.SETFILTER(Code,'26|1|76|25');

                                 CLEAR(MATRIX_CaptionSet);
                                 CLEAR(MatrixRecords);
                                 CurrentMatrixRecordOrdinal := 1;

                                 MatrixRecordRef.GETTABLE(MatrixRecord);
                                 MatrixRecordRef.SETTABLE(MatrixRecord);


                                 CaptionFieldNo := MatrixRecord.FIELDNO(Code);

                                 MatrixMgt.GenerateMatrixData(MatrixRecordRef,0,ARRAYLEN(MatrixRecords),CaptionFieldNo,MATRIX_PKFirstRecInCurrSet,
                                   MATRIX_CaptionSet,MATRIX_CaptionRange,MATRIX_CurrSetLength);

                                 IF MATRIX_CurrSetLength > 0 THEN BEGIN
                                   MatrixRecord.SETPOSITION(MATRIX_PKFirstRecInCurrSet);

                                   MatrixRecord.FIND;
                                   REPEAT
                                     MatrixRecords[CurrentMatrixRecordOrdinal].COPY(MatrixRecord);
                                     CurrentMatrixRecordOrdinal := CurrentMatrixRecordOrdinal + 1;
                                   UNTIL (CurrentMatrixRecordOrdinal > MATRIX_CurrSetLength) OR (MatrixRecord.NEXT <> 1);
                                 END;

                                 StockStatusWkshLine.RESET;
                                 SSItemsByLocMtx.Load(MATRIX_CaptionSet,MatrixRecords,MatrixRecord);
                                 SSItemsByLocMtx.SETTABLEVIEW(StockStatusWkshLine);

                                 IF StockStatusWkshLine.GET(CurrPage."Stock Status Quick Quote".PAGE.GetItemNo) THEN
                                   SSItemsByLocMtx.SETRECORD(StockStatusWkshLine);
                                 SSItemsByLocMtx.RUNMODAL;
                                 // </TPZ820>
                               END;
                                }
      { 1000000042;2 ;Action    ;
                      Name=AddtoDocument;
                      CaptionML=ENU=Add to Document;
                      Promoted=Yes;
                      Visible=ESACC_C1000000042_Visible AND (AddtoDocumentActionVisible);
                      Enabled=ESACC_C1000000042_Enabled;
                      Image=Add;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 IF DocumentNo = '' THEN
                                   ERROR(ab008);

                                 CurrPage."Stock Status Quick Quote".PAGE.NewOrderQuote(DocumentType,DocumentNo);  //TOP170 KT ABCSI Sales Order Updates 04012015
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1000000000;0;Container;
                ContainerType=ContentArea }

    { 1000000001;1;Group  ;
                CaptionML=ENU=General;
                GroupType=Group }

    { 1000000035;2;Field  ;
                SourceExpr="No.";
                Visible=ESACC_F1_Visible;
                Editable=FALSE;
                HideValue=ESACC_F1_HideValue }

    { 1000000014;2;Field  ;
                Name=LocationCode;
                CaptionML=ENU=Location Code;
                SourceExpr=LocationCode;
                Editable=LocCodeEditable;
                Style=Standard;
                StyleExpr=TRUE;
                OnValidate=BEGIN
                             CustDiv.RESET;
                             CustDiv.SETRANGE("Customer No.","No.");
                             CustDiv.SETRANGE("Location Code",LocationCode);
                             CustDiv.FINDFIRST;
                             RefreshLines;
                           END;

                OnLookup=BEGIN
                           GLSetup.GET;
                           IF GLSetup."Shortcut Dimension 5 Code" = '' THEN
                             ERROR(ab005,GLSetup.TABLECAPTION);

                           CustDiv.RESET;
                           CustDiv.SETRANGE("Customer No.","No.");
                           IF PAGE.RUNMODAL(50007,CustDiv) = ACTION::LookupOK THEN BEGIN
                             LocationCode := CustDiv."Location Code"
                           END;
                           RefreshLines
                         END;
                          }

    { 1000000031;2;Field  ;
                SourceExpr=Blocked;
                Visible=ESACC_F39_Visible;
                Editable=FALSE;
                HideValue=ESACC_F39_HideValue;
                QuickEntry=FALSE }

    { 1000000034;2;Field  ;
                SourceExpr=Name;
                Visible=ESACC_F2_Visible;
                Editable=FALSE;
                HideValue=ESACC_F2_HideValue;
                QuickEntry=FALSE }

    { 1000000033;2;Field  ;
                Name=Division Code Filter;
                SourceExpr=DivisionCodeFilter;
                Editable=DivCodeEditable;
                OnValidate=BEGIN
                             //TOP10B KT ABCSI - SSQQ Division Code 07082015
                             IF DivisionCodeFilter = '' THEN
                               ERROR('Division Code Filter can not be blank');

                             GLSetup.GET;
                             IF NOT DimVal.GET(GLSetup."Shortcut Dimension 5 Code",DivisionCodeFilter) THEN
                               ERROR(ab006);

                             UserSetup.GET(USERID);
                             IF UserSetup."Shortcut Dimension 5 Filter" <> '' THEN BEGIN
                               IF STRPOS(UserSetup."Shortcut Dimension 5 Filter",DivisionCodeFilter) = 0 THEN
                                 ERROR(ab007,DivisionCodeFilter);
                             END;

                             IF xDivisionCodeFilter <> DivisionCodeFilter THEN
                               CurrPage."Stock Status Quick Quote".PAGE.UserPrompt;

                             xDivisionCodeFilter := DivisionCodeFilter;
                             //TOP10B KT ABCSI - SSQQ Division Code 07082015

                             RefreshLines;
                           END;

                OnLookup=BEGIN
                           //TOP10B KT ABCSI - SSQQ Division Code 07132015
                           IF NOT DivCodeEditable THEN
                             ERROR('You are not allowed to change Division Code \when this page is opened from Sales Quote/Order');

                           GLSetup.GET;
                           IF GLSetup."Shortcut Dimension 5 Code" = '' THEN
                             GLSetup.FIELDERROR("Shortcut Dimension 5 Code");


                           UserSetup.GET(USERID);
                           IF UserSetup."Shortcut Dimension 5 Filter" <> '' THEN BEGIN
                             DimVal.RESET;
                             DimVal.SETRANGE("Dimension Code",GLSetup."Shortcut Dimension 5 Code");
                             DimVal.SETFILTER(Code,UserSetup."Shortcut Dimension 5 Filter");
                             IF PAGE.RUNMODAL(0,DimVal) = ACTION::LookupOK THEN BEGIN
                               DivisionCodeFilter := DimVal.Code;
                             END;
                           END ELSE BEGIN
                             DimVal.RESET;
                             DimVal.SETRANGE("Dimension Code",GLSetup."Shortcut Dimension 5 Code");
                             IF PAGE.RUNMODAL(0,DimVal) = ACTION::LookupOK THEN BEGIN
                               DivisionCodeFilter := DimVal.Code;
                             END;
                           END;

                           IF xDivisionCodeFilter <> DivisionCodeFilter THEN
                             CurrPage."Stock Status Quick Quote".PAGE.UserPrompt;

                           xDivisionCodeFilter := DivisionCodeFilter;

                           RefreshLines;
                           //TOP10B KT ABCSI - SSQQ Division Code 07132015
                         END;

                QuickEntry=FALSE }

    { 1000000039;1;Group  ;
                CaptionML=ENU=Sales Document;
                Visible=SalesGroupVisible;
                GroupType=Group }

    { 1000000041;2;Field  ;
                Name=DocumentType;
                CaptionML=ENU=Document Type;
                SourceExpr=DocumentType;
                Editable=FALSE;
                QuickEntry=FALSE }

    { 1000000040;2;Field  ;
                Name=DocumentNo;
                CaptionML=ENU=Document No.;
                SourceExpr=DocumentNo;
                Editable=FALSE;
                QuickEntry=FALSE }

    { 1000000004;1;Group  ;
                CaptionML=ENU=Item;
                GroupType=Group }

    { 1000000012;2;Field  ;
                Name=ItemNoFilter;
                CaptionML=ENU=Item No. Filter;
                SourceExpr=ItemNoFilter;
                OnValidate=BEGIN
                             //TOP10C KT ABCSI - SSQQ Item Search 07082015
                             CurrPage."Stock Status Quick Quote".PAGE.FindItemNo(ItemNoFilter);
                             //CurrPage."Item FactBox".PAGE.UserUpdate;
                             //TOP10C KT ABCSI - SSQQ Item Search 07082015
                           END;
                            }

    { 1000000003;2;Field  ;
                Name=VendItemNoFilter;
                CaptionML=ENU=Vendor Item No. Filter;
                SourceExpr=VendItemNoFilter;
                OnValidate=BEGIN
                             //TOP10E KT ABCSI - Additional Stock Status 07282015
                             CurrPage."Stock Status Quick Quote".PAGE.FindVendItemNo(VendItemNoFilter);
                             //CurrPage."Item FactBox".PAGE.UserUpdate;
                             //TOP10E KT ABCSI - Additional Stock Status 07282015
                           END;
                            }

    { 1000000044;1;Group  ;
                CaptionML=ENU=Item Description;
                Visible=FALSE;
                GroupType=Group }

    { 1000000045;2;Field  ;
                CaptionML=ENU=Item Description Filter;
                SourceExpr=DescriptionFilter;
                OnValidate=BEGIN
                             // <TPZ1055>
                             CurrPage."Stock Status Quick Quote".PAGE.FilterByItemDescription(DescriptionFilter);
                             //CurrPage."Item FactBox".PAGE.UserUpdate;
                             // </TPZ1055>
                           END;
                            }

    { 1000000046;2;Field  ;
                CaptionML=ENU=Item Description 2 Filter;
                SourceExpr=Description2Filter;
                OnValidate=BEGIN
                             // <TPZ1055>
                             CurrPage."Stock Status Quick Quote".PAGE.FilterByItemDescription2(Description2Filter);
                             //CurrPage."Item FactBox".PAGE.UserUpdate;
                             // </TPZ1055>
                           END;
                            }

    { 1000000006;1;Part   ;
                Name=Stock Status Quick Quote;
                SubPageView=SORTING(Sorting Order)
                            ORDER(Ascending);
                PagePartID=Page50064;
                PartType=Page }

    { 1000000005;0;Container;
                ContainerType=FactBoxArea }

    { 1000000008;1;Part   ;
                SubPageLink=No.=FIELD(No.),
                            Currency Filter=FIELD(Currency Filter),
                            Date Filter=FIELD(Date Filter),
                            Global Dimension 1 Filter=FIELD(Global Dimension 1 Filter),
                            Global Dimension 2 Filter=FIELD(Global Dimension 2 Filter);
                PagePartID=Page9080;
                PartType=Page }

    { 1000000007;1;Part   ;
                SubPageLink=No.=FIELD(No.),
                            Currency Filter=FIELD(Currency Filter),
                            Date Filter=FIELD(Date Filter),
                            Global Dimension 1 Filter=FIELD(Global Dimension 1 Filter),
                            Global Dimension 2 Filter=FIELD(Global Dimension 2 Filter);
                PagePartID=Page9082;
                Visible=FALSE;
                PartType=Page }

    { 1000000009;1;Part   ;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1000000010;1;Part   ;
                PartType=System;
                SystemPartID=Notes }

    { 1000000011;1;Part   ;
                PartType=System;
                SystemPartID=MyNotes }

  }
  CODE
  {
    VAR
      ESACC_ESFLADSMgt@14123801 : Codeunit 14123801;
      ESACC_C1000000002_Visible@915000020 : Boolean INDATASET;
      ESACC_C1000000002_Enabled@915000023 : Boolean INDATASET;
      ESACC_C1000000016_Visible@915000160 : Boolean INDATASET;
      ESACC_C1000000016_Enabled@915000163 : Boolean INDATASET;
      ESACC_C1000000017_Visible@915000170 : Boolean INDATASET;
      ESACC_C1000000017_Enabled@915000173 : Boolean INDATASET;
      ESACC_C1000000018_Visible@915000180 : Boolean INDATASET;
      ESACC_C1000000018_Enabled@915000183 : Boolean INDATASET;
      ESACC_C1000000019_Visible@915000190 : Boolean INDATASET;
      ESACC_C1000000019_Enabled@915000193 : Boolean INDATASET;
      ESACC_C1000000023_Visible@915000230 : Boolean INDATASET;
      ESACC_C1000000023_Enabled@915000233 : Boolean INDATASET;
      ESACC_C1000000028_Visible@915000280 : Boolean INDATASET;
      ESACC_C1000000028_Enabled@915000283 : Boolean INDATASET;
      ESACC_C1000000029_Visible@915000290 : Boolean INDATASET;
      ESACC_C1000000029_Enabled@915000293 : Boolean INDATASET;
      ESACC_C1000000038_Visible@915000380 : Boolean INDATASET;
      ESACC_C1000000038_Enabled@915000383 : Boolean INDATASET;
      ESACC_C1000000042_Visible@915000420 : Boolean INDATASET;
      ESACC_C1000000042_Enabled@915000423 : Boolean INDATASET;
      ESACC_C1000000060_Visible@915000600 : Boolean INDATASET;
      ESACC_C1000000060_Enabled@915000603 : Boolean INDATASET;
      ESACC_C1000000061_Visible@915000610 : Boolean INDATASET;
      ESACC_C1000000061_Enabled@915000613 : Boolean INDATASET;
      ESACC_C1000000062_Visible@915000620 : Boolean INDATASET;
      ESACC_C1000000062_Enabled@915000623 : Boolean INDATASET;
      ESACC_C1000000086_Visible@915000860 : Boolean INDATASET;
      ESACC_C1000000086_Enabled@915000863 : Boolean INDATASET;
      ESACC_C1000000087_Visible@915000870 : Boolean INDATASET;
      ESACC_C1000000087_Enabled@915000873 : Boolean INDATASET;
      ESACC_C1000000088_Visible@915000880 : Boolean INDATASET;
      ESACC_C1000000088_Enabled@915000883 : Boolean INDATASET;
      ESACC_C1000000091_Visible@915000910 : Boolean INDATASET;
      ESACC_C1000000091_Enabled@915000913 : Boolean INDATASET;
      ESACC_C1000000092_Visible@915000920 : Boolean INDATASET;
      ESACC_C1000000092_Enabled@915000923 : Boolean INDATASET;
      ESACC_C1000000094_Visible@915000940 : Boolean INDATASET;
      ESACC_C1000000094_Enabled@915000943 : Boolean INDATASET;
      ESACC_F1_Visible@900000010 : Boolean INDATASET;
      ESACC_F1_Editable@900000011 : Boolean INDATASET;
      ESACC_F1_HideValue@900000012 : Boolean INDATASET;
      ESACC_F2_Visible@900000020 : Boolean INDATASET;
      ESACC_F2_Editable@900000021 : Boolean INDATASET;
      ESACC_F2_HideValue@900000022 : Boolean INDATASET;
      ESACC_F39_Visible@900000390 : Boolean INDATASET;
      ESACC_F39_Editable@900000391 : Boolean INDATASET;
      ESACC_F39_HideValue@900000392 : Boolean INDATASET;
      ItemNoFilter@1000000001 : Code[20];
      VendItemNoFilter@1000000039 : Text[30];
      DescriptionFilter@1000000051 : Text[50];
      Description2Filter@1000000052 : Text[50];
      ToItemNo@1000000000 : Code[20];
      LocationCode@1000000002 : Code[10];
      SalesHeader@1000000023 : Record 36;
      SalesLine@1000000022 : Record 37;
      SalesPrice@1000000021 : Record 7002;
      StockStatusQuickQuote@1000000020 : Record 50000;
      QuickQuoteWorkSheet@1000000019 : Record 50001;
      Item@1000000018 : Record 27;
      CommentLine@1000000017 : Record 97;
      UserSetup@1000000016 : Record 91;
      CompanyInformation@1000000015 : Record 79;
      SearchMethod@1000000014 : '1,2';
      SalesLineNo@1000000010 : Integer;
      NewCustQuote@1000000009 : Boolean;
      CustComm@1000000008 : ARRAY [3] OF Text[80];
      DocPrint@1000000006 : Codeunit 229;
      ChangeLocation@1000000005 : Boolean;
      xLocation@1000000004 : Code[10];
      NewCust@1000000003 : Boolean;
      stockstatus@1000000007 : TEMPORARY Record 50000;
      ItemRec@1000000011 : Record 27;
      MakeSubPageVisible@1000000012 : Boolean;
      DivisionCodeFilter@1000000013 : Code[20];
      xDivisionCodeFilter@1000000036 : Code[20];
      FromCustPage@1000000024 : Boolean;
      FromDocPage@1000000040 : Boolean;
      CustRec@1000000025 : Record 18;
      CustNo@1000000026 : Code[20];
      CustRecLookup@1000000027 : Record 18;
      CustPageList@1000000028 : Page 22;
      Text0001@1000000029 : TextConst 'ENU=Customer No. Could not be found';
      CustDiv@1000000030 : Record 50007;
      GLSetup@1000000031 : Record 98;
      ab005@1000000032 : TextConst 'ENU=This Shortcut Dimension is not defined in the %1.;ESM=Este Shortcut de dimensi¢n no est  def. en el %1.;FRC=La dimension de ce raccourci n''est pas d‚finie dans le %1.;ENC=This Shortcut Dimension is not defined in the %1.';
      CustDivFilter@1000000033 : Text;
      DimVal@1000000034 : Record 349;
      DimMgt@1000000037 : Codeunit 408;
      ab006@1000000035 : TextConst 'ENU=Dimension Code is not valid.';
      ab007@1000000038 : TextConst 'ENU=You are not authorized for the Division Code %1';
      DocumentNo@1000000042 : Code[20];
      DocumentType@1000000041 : 'Order,Quote';
      LocCodeEditable@1000000043 : Boolean;
      DivCodeEditable@1000000044 : Boolean;
      ab008@1000000045 : TextConst 'ENU=Document No. is empty. Items cannot be added. \Please choose Create Sales Order or Create Sales Quote';
      ab009@1000000046 : TextConst 'ENU=Cannot create Sales Order or Sales Quote when Document No. exists. Please choose Add to Document';
      SalesOrderActionVisible@1000000047 : Boolean;
      SalesQuoteActionVisible@1000000048 : Boolean;
      AddtoDocumentActionVisible@1000000049 : Boolean;
      SalesGroupVisible@1000000050 : Boolean;
      JobName@1000000053 : Code[30];
      TPZJobName@1000000054 : TextConst 'ENU=Page Name Must be entered before creating a quote';

    LOCAL PROCEDURE ESACC_EasySecurity@14123801(OpenObject@14123801 : Boolean);
    VAR
      SetFilters@14123802 : Codeunit 14123812;
      TempBoolean@14123803 : Boolean;
    BEGIN
      IF OpenObject THEN BEGIN
        SetFilters.Filter18(Rec,8,50066);

        TempBoolean := CurrPage.EDITABLE;
        IF ESACC_ESFLADSMgt.PageGeneral(18,50066,TempBoolean) THEN
          CurrPage.EDITABLE := TempBoolean;
      END;

      ESACC_ESFLADSMgt.PageControl(
        18,50066,1,1000000002,
        ESACC_C1000000002_Visible,ESACC_C1000000002_Enabled,TempBoolean);

      ESACC_ESFLADSMgt.PageControl(
        18,50066,1,1000000016,
        ESACC_C1000000016_Visible,ESACC_C1000000016_Enabled,TempBoolean);

      ESACC_ESFLADSMgt.PageControl(
        18,50066,1,1000000017,
        ESACC_C1000000017_Visible,ESACC_C1000000017_Enabled,TempBoolean);

      ESACC_ESFLADSMgt.PageControl(
        18,50066,1,1000000018,
        ESACC_C1000000018_Visible,ESACC_C1000000018_Enabled,TempBoolean);

      ESACC_ESFLADSMgt.PageControl(
        18,50066,1,1000000019,
        ESACC_C1000000019_Visible,ESACC_C1000000019_Enabled,TempBoolean);

      ESACC_ESFLADSMgt.PageControl(
        18,50066,1,1000000023,
        ESACC_C1000000023_Visible,ESACC_C1000000023_Enabled,TempBoolean);

      ESACC_ESFLADSMgt.PageControl(
        18,50066,1,1000000028,
        ESACC_C1000000028_Visible,ESACC_C1000000028_Enabled,TempBoolean);

      ESACC_ESFLADSMgt.PageControl(
        18,50066,1,1000000029,
        ESACC_C1000000029_Visible,ESACC_C1000000029_Enabled,TempBoolean);

      ESACC_ESFLADSMgt.PageControl(
        18,50066,1,1000000038,
        ESACC_C1000000038_Visible,ESACC_C1000000038_Enabled,TempBoolean);

      ESACC_ESFLADSMgt.PageControl(
        18,50066,1,1000000042,
        ESACC_C1000000042_Visible,ESACC_C1000000042_Enabled,TempBoolean);

      ESACC_ESFLADSMgt.PageControl(
        18,50066,1,1000000060,
        ESACC_C1000000060_Visible,ESACC_C1000000060_Enabled,TempBoolean);

      ESACC_ESFLADSMgt.PageControl(
        18,50066,1,1000000061,
        ESACC_C1000000061_Visible,ESACC_C1000000061_Enabled,TempBoolean);

      ESACC_ESFLADSMgt.PageControl(
        18,50066,1,1000000062,
        ESACC_C1000000062_Visible,ESACC_C1000000062_Enabled,TempBoolean);

      ESACC_ESFLADSMgt.PageControl(
        18,50066,1,1000000086,
        ESACC_C1000000086_Visible,ESACC_C1000000086_Enabled,TempBoolean);

      ESACC_ESFLADSMgt.PageControl(
        18,50066,1,1000000087,
        ESACC_C1000000087_Visible,ESACC_C1000000087_Enabled,TempBoolean);

      ESACC_ESFLADSMgt.PageControl(
        18,50066,1,1000000088,
        ESACC_C1000000088_Visible,ESACC_C1000000088_Enabled,TempBoolean);

      ESACC_ESFLADSMgt.PageControl(
        18,50066,1,1000000091,
        ESACC_C1000000091_Visible,ESACC_C1000000091_Enabled,TempBoolean);

      ESACC_ESFLADSMgt.PageControl(
        18,50066,1,1000000092,
        ESACC_C1000000092_Visible,ESACC_C1000000092_Enabled,TempBoolean);

      ESACC_ESFLADSMgt.PageControl(
        18,50066,1,1000000094,
        ESACC_C1000000094_Visible,ESACC_C1000000094_Enabled,TempBoolean);

      ESACC_ESFLADSMgt.PageControl(
        18,50066,0,1,
        ESACC_F1_Visible,ESACC_F1_Editable,ESACC_F1_HideValue);

      ESACC_ESFLADSMgt.PageControl(
        18,50066,0,2,
        ESACC_F2_Visible,ESACC_F2_Editable,ESACC_F2_HideValue);

      ESACC_ESFLADSMgt.PageControl(
        18,50066,0,39,
        ESACC_F39_Visible,ESACC_F39_Editable,ESACC_F39_HideValue);

      ESACC_EasySecurityManual(OpenObject);
    END;

    LOCAL PROCEDURE ESACC_EasySecurityManual@14123811(OpenObject@14123811 : Boolean);
    BEGIN
    END;

    PROCEDURE RefreshLines@1000000000();
    BEGIN
      //TOPFIX KT ABCSI 06172015 Comment started
      {
      IF ("Location Code" <> '') AND ("Location Code" <> xRec."Location Code") THEN
        ChangeLocation := TRUE
      ELSE
        ChangeLocation := FALSE;

      IF ChangeLocation THEN
        IF "Location Code" <> '' THEN
          LocationCode := "Location Code"
        ELSE
          LocationCode := CompanyInformation."Location Code";
      }
      //TOPFIX KT ABCSI 06172015 Comment ended

      CurrPage."Stock Status Quick Quote".PAGE.SetUserFilters("No.",LocationCode,DivisionCodeFilter);
      CurrPage."Stock Status Quick Quote".PAGE.Refresh(NewCustQuote);

      //CurrPage."Item FactBox".PAGE.SetUserFilters(LocationCode);
      //CurrPage."Item FactBox".PAGE.UserUpdate;
      //CurrPage."Stock Status Quick Quote".PAGE.UserUpdate;
      NewCustQuote := FALSE;
      NewCust := FALSE;
    END;

    PROCEDURE SetFromCustPage@1000000002(varFromCustPage@1000000000 : Boolean;varCustRec@1000000001 : Record 18);
    BEGIN
      FromCustPage := varFromCustPage;
      CustRec := varCustRec;
    END;

    PROCEDURE SetFromDocumentPage@1000000003(varFromDocPage@1000000000 : Boolean;varCustRec@1000000001 : Record 18;varDocType@1000000004 : 'Order,Quote';varDocNo@1000000003 : Code[20];varLocCode@1000000005 : Code[10];varDivisionCodeFilter@1000000002 : Code[20]);
    BEGIN
      FromDocPage := varFromDocPage;
      CustRec := varCustRec;
      DocumentType := varDocType;
      DocumentNo := varDocNo;
      LocationCode := varLocCode;
      DivisionCodeFilter := varDivisionCodeFilter;
    END;

    PROCEDURE SetDivisionCodeFilter@1000000001(varDivisionCodeFilter@1000000000 : Code[20]);
    BEGIN
      DivisionCodeFilter := varDivisionCodeFilter;
      xDivisionCodeFilter := varDivisionCodeFilter;
    END;

    PROCEDURE ActivateFields@1000000005();
    BEGIN
      LocCodeEditable := NOT FromDocPage;
      DivCodeEditable := NOT FromDocPage;
      SalesOrderActionVisible := NOT FromDocPage;
      SalesQuoteActionVisible := NOT FromDocPage;
      AddtoDocumentActionVisible := FromDocPage;
      SalesGroupVisible := FromDocPage;
    END;

    BEGIN
    {
      TOP010 KT ABCSI Stock Status Quick Quote Screen 06042015
        - Created Stock Status Quick quote page
        - Renamed Action Lost Opportunity to Capture Lost Opportunity
        - Updated the default Sorting of the page in the SubPageView property of the Page Part Stock Status Quick Quote

      TOP10B KT ABCSI - SSQQ Division Code 07082015
        - Division Code made non-editable
        - Added code under Division Code Filter OnValidate trigger

      TOP10C KT ABCSI - SSQQ Item Search 07082015
        - Added a new field Item No. Filter

      TOP10E KT ABCSI - Additional Stock Status 07282015
        - Added a new field Vendor Item No. Filter

      TOP170 KT ABCSI - Sales Order Updates
        - Changed related to SSQQ to make it work when it is opened from Sales Quote/Order ribbon

      2015-06-11 TPZ699 VCHERNYA
        Item Units of Measure (Item Units of Measure FactBox) page part has been added
      2015-06-19 TPZ591 VCHERNYA
        Sorting has been changed to Sorting Order field in Stock Status Quick Quote page part
      2015-06-30 TPZ449 VCHERNYA
        Last Prices page action has been added
      2015-07-01 TPZ835 VCHERNYA
        Item Comments page part has been added
      2015-07-13 TPZ820 VCHERNYA
        Items by Location page action has been added
      2015-10-06 TPZ1055 VCHERNYA
        Description Filter and Description 2 Filter fields have been added
      2016-10-26 TPZ1698 EBAGIM
        Page has been added
    }
    END.
  }
}

