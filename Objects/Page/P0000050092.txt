OBJECT Page 50092 Contact Management
{
  OBJECT-PROPERTIES
  {
    Date=10/27/21;
    Time=10:07:56 AM;
    Modified=Yes;
    Version List=3385;
  }
  PROPERTIES
  {
    OnOpenPage=BEGIN
                 YearVar := YearVar::"2021";
                 DateVar := TODAY;
                 CurrPage."Total Contacts".PAGE.SetOptionChoice(FORMAT(YearVar));
                 CurrPage."Total Contact Group by Job".PAGE.SetOptionChoice(FORMAT(YearVar));
                 CurrPage."Total Prospects".PAGE.SetOptionChoice(FORMAT(YearVar));
                 CurrPage."Total Prospects Group by Job".PAGE.SetOptionChoice(FORMAT(YearVar));
               END;

    ActionList=ACTIONS
    {
      { 1000000006;  ;ActionContainer;
                      Name=Action;
                      ActionContainerType=NewDocumentItems }
      { 1000000008;1 ;Action    ;
                      Name=Refresh Data;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=RefreshLines;
                      PromotedOnly=Yes;
                      OnAction=VAR
                                 ContactManagementCU@1000000000 : Codeunit 52004;
                               BEGIN
                                 CLEAR(ContactManagementCU);
                                 ContactManagementCU.Setfilterfun(DateVar);
                                 ContactManagementCU.RUN;
                               END;
                                }
      { 1000000007;1 ;Action    ;
                      Name=Export Data;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=ExportContact;
                      PromotedOnly=Yes;
                      OnAction=VAR
                                 ContactManagementCU@1000000000 : Codeunit 52004;
                               BEGIN
                                 CLEAR(ContactManagementCU);
                                 ContactManagementCU.Setfilterfun(DateVar);
                                 ContactManagementCU.ExportData;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1000000000;;Container;
                Name=Contacts;
                ContainerType=ContentArea }

    { 1000000009;1;Group  ;
                Name=General;
                GroupType=Group }

    { 1000000001;2;Field  ;
                SourceExpr=YearVar;
                OnValidate=BEGIN
                             //ERROR('p');
                             CurrPage."Total Contacts".PAGE.SetOptionChoice(FORMAT(YearVar));
                             CurrPage."Total Contact Group by Job".PAGE.SetOptionChoice(FORMAT(YearVar));

                             CurrPage."Total Prospects".PAGE.SetOptionChoice(FORMAT(YearVar));
                             CurrPage."Total Prospects Group by Job".PAGE.SetOptionChoice(FORMAT(YearVar));
                             CurrPage.UPDATE(FALSE);
                           END;
                            }

    { 1000000010;2;Field  ;
                Name=Date;
                SourceExpr=DateVar }

    { 1000000002;1;Part   ;
                Name=Total Contacts;
                CaptionML=ENU=Total Contacts;
                PagePartID=Page50093;
                PartType=Page }

    { 1000000003;1;Part   ;
                Name=Total Contact Group by Job;
                CaptionML=ENU=Total Contact Group by Job;
                PagePartID=Page50094;
                PartType=Page }

    { 1000000004;1;Part   ;
                Name=Total Prospects;
                CaptionML=ENU=Total Prospects;
                PagePartID=Page50095;
                PartType=Page }

    { 1000000005;1;Part   ;
                Name=Total Prospects Group by Job;
                CaptionML=ENU=Total Prospects Group by Job;
                PagePartID=Page50096;
                PartType=Page }

  }
  CODE
  {
    VAR
      YearVar@1000000000 : '2020,2021,2022,2023';
      DateVar@1000000001 : Date;

    BEGIN
    END.
  }
}

