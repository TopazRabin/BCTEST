OBJECT Page 14000575 Suggested Order
{
  OBJECT-PROPERTIES
  {
    Date=02/23/21;
    Time=12:38:01 PM;
    Modified=Yes;
    Version List=UBP3.03,TPZ;
  }
  PROPERTIES
  {
    CaptionML=ENU=Suggested Order;
    LinksAllowed=No;
    SourceTable=Table14000565;
    PageType=Document;
    OnOpenPage=BEGIN
                 // 2015+ >>
                 IsNotWindowsClient := (CURRENTCLIENTTYPE <> CLIENTTYPE::Windows);
                 IsWindowsClient := (CURRENTCLIENTTYPE = CLIENTTYPE::Windows);
                 // 2015+ <<
               END;

    OnDeleteRecord=BEGIN
                     CurrPage.SAVERECORD;
                   END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 3       ;1   ;Action    ;
                      Name=Suggested Order Line Review;
                      RunObject=Page 14097503;
                      RunPageView=SORTING(Buy-from Vendor No.,Document No.,Line No.);
                      RunPageLink=Buy-from Vendor No.=FIELD(Buy-from Vendor No.),
                                  Document No.=FIELD(No.);
                      Image=ReviewWorksheet }
      { 49      ;1   ;Action    ;
                      ShortCutKey=F7;
                      CaptionML=ENU=Statistics;
                      Promoted=Yes;
                      Image=Statistics;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 PAGE.RUNMODAL(PAGE::"Suggested Order Statistics",Rec);
                               END;
                                }
      { 53      ;1   ;Action    ;
                      CaptionML=ENU=&Transfer Orders;
                      ToolTipML=ENU=Open transfer orders;
                      RunObject=Page 5742;
                      RunPageView=SORTING(Suggested Order No.)
                                  WHERE(Suggested Order No.=FILTER(<>''));
                      RunPageLink=Suggested Order No.=FIELD(Posting No.);
                      Image=Document }
      { 1240020000;1 ;Action    ;
                      CaptionML=ENU=Transfer Lines;
                      ToolTipML=ENU=Open transfer lines;
                      RunObject=Page 5749;
                      RunPageView=SORTING(Suggested Order No.,Suggested Order Line No.)
                                  ORDER(Ascending);
                      RunPageLink=Suggested Order No.=FIELD(No.);
                      Image=GetLines }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 50      ;1   ;Action    ;
                      CaptionML=ENU=Create &Purchase Order;
                      ToolTipML=ENU=Create purchase order and posted suggested order;
                      Promoted=Yes;
                      Image=CalculateLines;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CreatePurchOrderYesNo.CreatePurchOrder(Rec);
                               END;
                                }
      { 52      ;1   ;Action    ;
                      CaptionML=ENU=Create &Transfer Order;
                      ToolTipML=ENU=Create transfer order and posted transfer order;
                      Promoted=Yes;
                      Image=CalculateInventory;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CreateTransOrderYesNo.CreateTransferOrder(Rec);
                               END;
                                }
      { 1000000002;1 ;Action    ;
                      CaptionML=ENU=&Remove Line Point Items;
                      Visible=FALSE;
                      Image=DeleteQtyToHandle;
                      OnAction=BEGIN
                                 SuggestedOrderLine.RESET;
                                 SuggestedOrderLine.SETRANGE("Buy-from Vendor No.","Buy-from Vendor No.");
                                 SuggestedOrderLine.SETRANGE("Document No.","No.");
                                 SuggestedOrderLine.SETRANGE("Purchase Reason",SuggestedOrderLine."Purchase Reason"::"Line Point");
                                 IF CONFIRM(Text000,FALSE) THEN BEGIN
                                   SuggestedOrderLine.DELETEALL;
                                   CurrPage.UPDATE;
                                 END;
                               END;
                                }
      { 41      ;1   ;Action    ;
                      CaptionML=ENU=&Print;
                      Promoted=Yes;
                      Image=Print;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 SuggestedOrderHeader.SETRANGE("Buy-from Vendor No.","Buy-from Vendor No.");
                                 SuggestedOrderHeader.SETRANGE("No.","No.");
                                 REPORT.RUN(REPORT::"Suggested Order",TRUE,TRUE,SuggestedOrderHeader);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1240020016;1;Group  ;
                CaptionML=ENU=General;
                Visible=IsWindowsClient }

    { 1240020015;2;Field  ;
                Name=No.2;
                SourceExpr="No.";
                Editable=FALSE }

    { 1240020014;2;Field  ;
                Name=Buy-from Vendor No.2;
                SourceExpr="Buy-from Vendor No.";
                Importance=Promoted;
                Editable=FALSE }

    { 1240020013;2;Field  ;
                Name=Buy-from Vendor Name2;
                SourceExpr="Buy-from Vendor Name";
                Editable=FALSE }

    { 1240020012;2;Field  ;
                Name=Buy-from Address2;
                SourceExpr="Buy-from Address";
                Importance=Additional;
                Editable=FALSE }

    { 1240020011;2;Field  ;
                Name=Buy-from Address 2_2;
                SourceExpr="Buy-from Address 2";
                Importance=Additional;
                Editable=FALSE }

    { 1240020010;2;Field  ;
                Name=Buy-from Post Code2;
                SourceExpr="Buy-from Post Code";
                Importance=Additional;
                Editable=FALSE }

    { 1240020009;2;Field  ;
                Name=Buy-from City2;
                SourceExpr="Buy-from City";
                Importance=Additional;
                Editable=FALSE }

    { 1240020008;2;Field  ;
                Name=Buy-from Contact2;
                SourceExpr="Buy-from Contact";
                Editable=FALSE }

    { 1240020007;2;Field  ;
                Name=Creation Date2;
                SourceExpr="Creation Date";
                Importance=Promoted;
                Editable=FALSE }

    { 1240020006;2;Field  ;
                Name=Created By2;
                SourceExpr="Created By";
                Importance=Promoted;
                Editable=FALSE }

    { 1240020005;2;Field  ;
                Name=Document Date2;
                SourceExpr="Document Date";
                Importance=Promoted }

    { 1240020004;2;Field  ;
                Name=Requested Receipt Date2;
                SourceExpr="Requested Receipt Date";
                Importance=Promoted }

    { 1240020003;2;Field  ;
                Name=Purchaser Code2;
                SourceExpr="Purchaser Code" }

    { 39  ;1   ;Part      ;
                Name=SugOrderLines;
                SubPageView=SORTING(Buy-from Vendor No.,Document No.,Line No.);
                SubPageLink=Buy-from Vendor No.=FIELD(Buy-from Vendor No.),
                            Document No.=FIELD(No.);
                PagePartID=Page14000576 }

    { 1   ;1   ;Group     ;
                CaptionML=ENU=General;
                Visible=IsNotWindowsClient }

    { 2   ;2   ;Field     ;
                SourceExpr="No.";
                Editable=FALSE }

    { 4   ;2   ;Field     ;
                SourceExpr="Buy-from Vendor No.";
                Importance=Promoted;
                Editable=FALSE }

    { 6   ;2   ;Field     ;
                SourceExpr="Buy-from Vendor Name";
                Editable=FALSE }

    { 8   ;2   ;Field     ;
                SourceExpr="Buy-from Address";
                Importance=Additional;
                Editable=FALSE }

    { 10  ;2   ;Field     ;
                SourceExpr="Buy-from Address 2";
                Importance=Additional;
                Editable=FALSE }

    { 12  ;2   ;Field     ;
                SourceExpr="Buy-from Post Code";
                Importance=Additional;
                Editable=FALSE }

    { 14  ;2   ;Field     ;
                SourceExpr="Buy-from City";
                Importance=Additional;
                Editable=FALSE }

    { 16  ;2   ;Field     ;
                SourceExpr="Buy-from Contact";
                Editable=FALSE }

    { 45  ;2   ;Field     ;
                SourceExpr="Creation Date";
                Importance=Promoted;
                Editable=FALSE }

    { 47  ;2   ;Field     ;
                SourceExpr="Created By";
                Importance=Promoted;
                Editable=FALSE }

    { 34  ;2   ;Field     ;
                SourceExpr="Document Date";
                Importance=Promoted }

    { 36  ;2   ;Field     ;
                SourceExpr="Requested Receipt Date";
                Importance=Promoted }

    { 1240030005;2;Field  ;
                SourceExpr="Purchaser Code" }

    { 1900531001;1;Group  ;
                CaptionML=ENU=Ship-to }

    { 18  ;2   ;Field     ;
                ToolTipML=ENU=Specifies a location code for the warehouse or distribution center where your items are handled and stored before being sold.;
                SourceExpr="Location Code";
                Importance=Promoted }

    { 20  ;2   ;Field     ;
                SourceExpr="Ship-to Name" }

    { 22  ;2   ;Field     ;
                SourceExpr="Ship-to Address" }

    { 24  ;2   ;Field     ;
                SourceExpr="Ship-to Address 2" }

    { 26  ;2   ;Field     ;
                SourceExpr="Ship-to Post Code" }

    { 28  ;2   ;Field     ;
                SourceExpr="Ship-to City" }

    { 30  ;2   ;Field     ;
                SourceExpr="Ship-to Contact" }

    { 32  ;2   ;Field     ;
                SourceExpr="Shipment Method Code" }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 1904831707;1;Part   ;
                SubPageLink=Buy-from Vendor No.=FIELD(Buy-from Vendor No.),
                            No.=FIELD(No.);
                PagePartID=Page14097470;
                PartType=Page }

    { 1000000003;1;Part   ;
                CaptionML=ENU=Prior/Next Gen. Item;
                SubPageLink=Document No.=FIELD(Document No.),
                            Location Code=FIELD(Location Code),
                            No.=FIELD(No.);
                PagePartID=Page50075;
                ProviderID=39;
                PartType=Page }

    { 1000000000;1;Part   ;
                SubPageLink=No.=FIELD(No.),
                            Location Filter=FIELD(Location Code);
                PagePartID=Page50074;
                ProviderID=39;
                PartType=Page }

    { 1000000005;1;Part   ;
                SubPageLink=Buy-from Vendor No.=FIELD(Buy-from Vendor No.),
                            Document No.=FIELD(Document No.),
                            Line No.=FIELD(Line No.);
                PagePartID=Page50081;
                ProviderID=39;
                PartType=Page }

    { 1905426907;1;Part   ;
                SubPageLink=Buy-from Vendor No.=FIELD(Buy-from Vendor No.),
                            Document No.=FIELD(Document No.),
                            Line No.=FIELD(Line No.);
                PagePartID=Page14097474;
                ProviderID=39;
                PartType=Page }

    { 1903615707;1;Part   ;
                SubPageLink=Buy-from Vendor No.=FIELD(Buy-from Vendor No.),
                            Document No.=FIELD(Document No.),
                            Line No.=FIELD(Line No.);
                PagePartID=Page14097471;
                ProviderID=39;
                PartType=Page }

    { 1240020001;1;Part   ;
                SubPageView=SORTING(Item No.,Variant Code,Surplus Available);
                SubPageLink=Item No.=FIELD(No.),
                            Variant Code=FIELD(Variant Code),
                            Surplus Available=CONST(Yes),
                            Transfer To Location Code=FIELD(Location Code),
                            Buy-from Vendor No.=FIELD(Buy-from Vendor No.),
                            Suggested Order No.=FIELD(Document No.),
                            Suggested Order Line No.=FIELD(Line No.),
                            On Hand Qty. (Base)=FIELD("Quantity (Base)"),
                            Surplus Quantity (Base)=FIELD("Qty. to Transfer (Base)"),
                            Replenishment Source Type=CONST(Vendor);
                PagePartID=Page14000551;
                ProviderID=39;
                PartType=Page }

    { 1240020002;1;Part   ;
                SubPageLink=Location Code=FIELD(Location Code),
                            Item No.=FIELD(No.),
                            Variant Code=FIELD(Variant Code);
                PagePartID=Page14097479;
                ProviderID=39;
                PartType=Page }

    { 1000000001;1;Part   ;
                Name=Purchase Price FB;
                CaptionML=ENU=Purchase Prices;
                SubPageView=SORTING(Item No.,Vendor No.,Starting Date,Currency Code,Variant Code,Unit of Measure Code,Minimum Quantity)
                            WHERE(Blocked=CONST(No));
                SubPageLink=Item No.=FIELD(No.);
                PagePartID=Page14098065;
                ProviderID=39;
                PartType=Page;
                ShowFilter=No }

  }
  CODE
  {
    VAR
      SuggestedOrderHeader@1000 : Record 14000565;
      SuggestedOrderLine@1000000000 : Record 14000566;
      CreatePurchOrderYesNo@14000500 : Codeunit 14000560;
      CreateTransOrderYesNo@1001 : Codeunit 14000565;
      Text000@1000000001 : TextConst 'ENU=Remove Line Point Items?';
      IsNotWindowsClient@1240020000 : Boolean;
      IsWindowsClient@1240020001 : Boolean;
      ItemSubstitionFactBox2@1000000002 : Page 50075;

    BEGIN
    {
      2018-03-08 TPZ2235 SC
        Add Item Substitution factbox
      2020-04-28 TPZ2840 RSAH
        Add Prior and Next Generation fields to the Suggested Order page - Created a New factbod and linked
      TPZ2858 06022020 RSAH - Using ABC before the item is actually blocked - Added Factbox
    }
    END.
  }
}

