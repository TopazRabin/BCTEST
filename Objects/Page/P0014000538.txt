OBJECT Page 14000538 Surplus List
{
  OBJECT-PROPERTIES
  {
    Date=11/01/20;
    Time=12:00:00 PM;
    Version List=UBP3.03;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=ENU=Surplus List;
    LinksAllowed=No;
    SourceTable=Table14000584;
    PageType=List;
    ActionList=ACTIONS
    {
      { 1240020006;  ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1240020024;1 ;ActionGroup;
                      CaptionML=ENU=&Proc. Unit }
      { 1240020032;2 ;Action    ;
                      Name=ReCalculateSurplus;
                      CaptionML=ENU=Calculate for Procurement Unit;
                      Image=AdjustVATExemption;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 ProcUnit@1240020001 : Record 14000555;
                                 CalcSurplus@1240020000 : Codeunit 14000577;
                               BEGIN
                                 ProcUnit.GET("Location Code", "Item No.", "Variant Code");
                                 CalcSurplus.ByPUC(ProcUnit);
                                 CurrPage.UPDATE(FALSE);
                               END;
                                }
      { 1240020009;2 ;Action    ;
                      ShortCutKey=Shift+F7;
                      CaptionML=ENU=&Procurement Unit;
                      RunObject=Page 14000558;
                      RunPageView=SORTING(Location Code,Item No.,Variant Code)
                                  ORDER(Ascending);
                      RunPageLink=Location Code=FIELD(Location Code),
                                  Item No.=FIELD(Item No.),
                                  Variant Code=FIELD(Variant Code);
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=BankAccountRec;
                      PromotedCategory=Process }
      { 1240020013;2 ;Action    ;
                      CaptionML=ENU=Location Inventory Roll Up;
                      Image=BOMVersions;
                      OnAction=VAR
                                 ProcUnit@1240020000 : Record 14000555;
                               BEGIN
                                 DisplayLocInvRollup();
                               END;
                                }
      { 1240020007;2 ;Action    ;
                      ShortCutKey=Shift+F11;
                      CaptionML=ENU=View &Forecast;
                      Image=CalculateRegenerativePlan;
                      OnAction=VAR
                                 ProcUnit@1240020001 : Record 14000555;
                                 ForecastView@1240020000 : Page 14002661;
                               BEGIN
                                 ProcUnit.GET("Location Code", "Item No.", "Variant Code");
                                 CLEAR(ForecastView);
                                 ForecastView.SetLTHDate("Surplus Date");
                                 ForecastView.SetProcUnitandSourceNo(ProcUnit,'');
                                   ForecastView.RUN;
                               END;
                                }
      { 1240020019;2 ;Action    ;
                      CaptionML=ENU=Item &Usage;
                      RunObject=Page 14000564;
                      RunPageLink=Location Code=FIELD(Location Code),
                                  Item No.=FIELD(Item No.),
                                  Variant Code=FIELD(Variant Code);
                      Image=ItemTrackingLedger }
      { 1240020010;2 ;Action    ;
                      CaptionML=ENU=Vendor &Performance;
                      RunObject=Page 14000561;
                      RunPageView=SORTING(Location Code,Vendor,Item No.,Variant Code,Exclude From Performance,Date Received)
                                  ORDER(Ascending);
                      RunPageLink=Location Code=FIELD(Location Code),
                                  Item No.=FIELD(Item No.),
                                  Variant Code=FIELD(Variant Code);
                      Image=MachineCenterLoad }
      { 1240020030;1 ;ActionGroup;
                      CaptionML=ENU=Surplus }
      { 1240020028;2 ;Action    ;
                      CaptionML=ENU=(Surplus) Location Inventory Roll Up;
                      Image=BOMVersions;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 LocInvRollUpRTC@1240020000 : Page 14097475;
                                 HorizonDate@1240020001 : Date;
                                 ProcUnit@1240020002 : Record 14000555;
                               BEGIN
                                 CLEAR(LocInvRollUpRTC);
                                 LocInvRollUpRTC.SetUseSurplusFactor(TRUE);
                                 HorizonDate := "Surplus Date";
                                 ProcUnit.GET("Location Code", "Item No.", "Variant Code");
                                 IF HorizonDate > 0D THEN
                                   LocInvRollUpRTC.LoadRollUPLines(ProcUnit, HorizonDate)
                                 ELSE
                                   LocInvRollUpRTC.LoadProcUnit(ProcUnit);
                                 LocInvRollUpRTC.RUN;
                               END;
                                }
      { 1240020027;2 ;Action    ;
                      ShortCutKey=Shift+F11;
                      CaptionML=ENU=(Surplus) View &Forecast;
                      Image=CalculateRegenerativePlan;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 ForecastView@1240020000 : Page 14002661;
                                 ProcUnit@1240020001 : Record 14000555;
                               BEGIN
                                 ProcUnit.GET("Location Code", "Item No.", "Variant Code");
                                 CLEAR(ForecastView);
                                 ForecastView.SetUseSurplusFactor(TRUE);
                                 ForecastView.SetLTHDate("Surplus Date");
                                 ForecastView.SetProcUnitandSourceNo(ProcUnit,'');
                                 ForecastView.RUN;
                               END;
                                }
      { 1240020026;1 ;ActionGroup;
                      CaptionML=ENU=Excess }
      { 1240020025;2 ;Action    ;
                      CaptionML=ENU=(Excess) Location Inventory Roll Up;
                      Image=BOMVersions;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 LocInvRollUpRTC@1240020000 : Page 14097475;
                                 HorizonDate@1240020001 : Date;
                                 ProcUnit@1240020002 : Record 14000555;
                               BEGIN
                                 ProcUnit.GET("Location Code", "Item No.", "Variant Code");
                                 CLEAR(LocInvRollUpRTC);
                                 LocInvRollUpRTC.SetUseExcessFactor(TRUE);
                                 HorizonDate := "Excess Date";
                                 IF HorizonDate > 0D THEN
                                   LocInvRollUpRTC.LoadRollUPLines(ProcUnit, HorizonDate)
                                 ELSE
                                   LocInvRollUpRTC.LoadProcUnit(ProcUnit);
                                 LocInvRollUpRTC.RUN;
                               END;
                                }
      { 1240020023;2 ;Action    ;
                      ShortCutKey=Shift+F11;
                      CaptionML=ENU=(Excess) View &Forecast;
                      Image=CalculateRegenerativePlan;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 ForecastView@1240020000 : Page 14002661;
                                 ProcUnit@1240020001 : Record 14000555;
                               BEGIN
                                 ProcUnit.GET("Location Code", "Item No.", "Variant Code");
                                 CLEAR(ForecastView);
                                 ForecastView.SetUseExcessFactor(TRUE);
                                 ForecastView.SetLTHDate("Excess Date");
                                 ForecastView.SetProcUnitandSourceNo(ProcUnit,'');
                                 ForecastView.RUN;
                               END;
                                }
      { 1240020022;1 ;Action    ;
                      CaptionML=ENU=&Surplus List;
                      RunObject=Page 14000538;
                      RunPageView=SORTING(Item No.,Variant Code,Surplus Available)
                                  ORDER(Ascending);
                      RunPageLink=Item No.=FIELD(Item No.),
                                  Location Code=FIELD(Location Code),
                                  Variant Code=FIELD(Variant Code);
                      Image=ResourceCosts;
                      PromotedCategory=Process }
      { 1240020021;  ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 1240020020;1 ;Action    ;
                      Name=[Location ] }
      { 1240020018;1 ;Action    ;
                      Name=Inventory Management Setup }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1240030000;1;Group  ;
                GroupType=Repeater }

    { 1240030001;2;Field  ;
                ToolTipML=ENU=Specifies a location code for the warehouse or distribution center where your items are handled and stored before being sold.;
                ApplicationArea=#All;
                SourceExpr="Location Code" }

    { 1240030003;2;Field  ;
                ToolTipML=ENU=Item number;
                ApplicationArea=#All;
                SourceExpr="Item No." }

    { 1240030005;2;Field  ;
                ApplicationArea=#All;
                SourceExpr="Variant Code";
                Visible=FALSE }

    { 1240030009;2;Field  ;
                ToolTipML=ENU=Purchasing unit of measure;
                ApplicationArea=#All;
                SourceExpr="Unit of Measure Code";
                Editable=FALSE }

    { 1240020015;2;Field  ;
                SourceExpr="Unit Cost";
                Visible=FALSE }

    { 1240030011;2;Field  ;
                ToolTipML=ENU=Nonstock and no forecast;
                ApplicationArea=#All;
                SourceExpr="Nonstock Item" }

    { 1240020012;2;Field  ;
                SourceExpr="On Hand Qty. (Base)";
                Visible=FALSE }

    { 1240020016;2;Field  ;
                SourceExpr="On Hand Amount";
                Visible=FALSE }

    { 1240020014;2;Field  ;
                SourceExpr="Good Qty. (Base)";
                Visible=FALSE }

    { 1240020017;2;Field  ;
                SourceExpr="Good Amount";
                Visible=FALSE }

    { 1240030022;2;Field  ;
                ApplicationArea=#All;
                SourceExpr="Surplus Date" }

    { 1240020002;2;Field  ;
                ApplicationArea=#All;
                SourceExpr="Surplus Quantity (Base)";
                Visible=FALSE }

    { 1240030007;2;Field  ;
                ToolTipML=ENU=Surplus inventory quantity;
                ApplicationArea=#All;
                SourceExpr="Surplus Quantity";
                Visible=FALSE }

    { 1240020011;2;Field  ;
                ApplicationArea=#All;
                SourceExpr="Surplus Amount";
                Visible=FALSE }

    { 1240030024;2;Field  ;
                ToolTipML=ENU=Surplus inventory quantity;
                ApplicationArea=#All;
                SourceExpr="Outstanding Surplus Qty (Base)" }

    { 1240030013;2;Field  ;
                ApplicationArea=#All;
                SourceExpr="Extended Cost";
                Visible=FALSE }

    { 1240020008;2;Field  ;
                ApplicationArea=#All;
                SourceExpr="Excess Date";
                Visible=FALSE }

    { 1240020003;2;Field  ;
                ApplicationArea=#All;
                SourceExpr="Excess Quantity";
                Visible=FALSE }

    { 1240020004;2;Field  ;
                ApplicationArea=#All;
                SourceExpr="Excess Quantity (Base)";
                Visible=FALSE }

    { 1240020005;2;Field  ;
                ApplicationArea=#All;
                SourceExpr="Excess Amount";
                Visible=FALSE }

    { 1240030015;2;Field  ;
                ToolTipML=ENU=Quantity to be transferred from this location;
                ApplicationArea=#All;
                SourceExpr="Quantity To Transfer";
                Visible=FALSE }

    { 1240030017;2;Field  ;
                ApplicationArea=#All;
                SourceExpr="Transfer To Location Code";
                Visible=FALSE }

    { 1240030026;2;Field  ;
                ToolTipML=ENU=Item class based on COGS or percentage of items;
                ApplicationArea=#All;
                SourceExpr="Item Class Description" }

    { 1240030028;2;Field  ;
                ToolTipML=ENU=Ranking code based on sales order 'hits';
                ApplicationArea=#All;
                SourceExpr="Ranking Code" }

    { 1240020001;0;Container;
                ContainerType=FactBoxArea }

    { 1240020000;1;Part   ;
                SubPageLink=Location Code=FIELD(Location Code),
                            Item No.=FIELD(Item No.),
                            Variant Code=FIELD(Variant Code);
                PagePartID=Page14097479;
                PartType=Page }

  }
  CODE
  {
    VAR
      UBP@1240020000 : Codeunit 14000564;

    PROCEDURE DisplayLocInvRollup@1240030011();
    VAR
      Text001@1240030002 : TextConst 'ENU=Your system is not currently configured to roll up forecast and demand via replenishment path.';
      ProcUnit@1240020000 : Record 14000555;
      LocInvRollUpRTC@1240030004 : Page 14097475;
    BEGIN
      ProcUnit.GET("Location Code", "Item No.", "Variant Code");
      CLEAR(LocInvRollUpRTC);
      LocInvRollUpRTC.LoadProcUnit(ProcUnit);
      LocInvRollUpRTC.RUN;
    END;

    BEGIN
    END.
  }
}

