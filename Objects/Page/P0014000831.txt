OBJECT Page 14000831 Posted Sales Shipments (BOL)
{
  OBJECT-PROPERTIES
  {
    Date=02/25/19;
    Time=12:00:00 PM;
    Version List=SE0.61;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=ENU=Posted Sales Shipments (BOL);
    SourceTable=Table110;
    PageType=List;
    OnOpenPage=BEGIN
                 PackingStation.GetPackingStation;
               END;

    OnAfterGetRecord=BEGIN
                       //<TPZ2301>
                       "EDI ASN" := FALSE;
                       CheckEDITradePartner;
                       //</TPZ2301>
                     END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 17      ;1   ;ActionGroup;
                      CaptionML=ENU=&Shipment }
      { 18      ;2   ;Action    ;
                      ShortCutKey=Shift+F7;
                      CaptionML=ENU=Card;
                      RunObject=Page 130;
                      RunPageLink=No.=FIELD(No.);
                      Image=EditLines }
      { 23      ;2   ;Action    ;
                      CaptionML=ENU=Posted P&ackages;
                      RunObject=Page 14000714;
                      RunPageView=SORTING(Source Type,Source Subtype,Posted Source ID,Bill of Lading No.);
                      RunPageLink=Source Type=CONST(36),
                                  Posted Source ID=FIELD(No.);
                      Promoted=Yes;
                      Image=ItemTracing;
                      PromotedCategory=Process }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 21      ;1   ;ActionGroup;
                      CaptionML=ENU=F&unctions }
      { 22      ;2   ;Action    ;
                      ShortCutKey=F7;
                      CaptionML=ENU=Add to Bill of Lading;
                      Promoted=Yes;
                      Image=NewDocument;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 IF BillOfLadingNo = '' THEN
                                   ERROR(Text001);

                                 BillOfLading.GET(BillOfLadingNo);
                                 BillOfLading.TESTFIELD(Released,FALSE);

                                 CurrPage.SETSELECTIONFILTER(SalesShipmentHeader);
                                 SalesShipmentHeader.LOCKTABLE;
                                 IF SalesShipmentHeader.FIND('-') THEN
                                   REPEAT
                                     BillOfLadingWorksheetMgt.AddSalesShipment(
                                       BillOfLading,SalesShipmentHeader,PackingStation."Show Posted Doc. BOL Warnings");
                                   UNTIL SalesShipmentHeader.NEXT = 0;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 1000000001;2;Field  ;
                Name=EDI ASN;
                SourceExpr="EDI ASN" }

    { 2   ;2   ;Field     ;
                SourceExpr="No." }

    { 4   ;2   ;Field     ;
                SourceExpr="Sell-to Customer No." }

    { 6   ;2   ;Field     ;
                SourceExpr="Ship-to Code" }

    { 8   ;2   ;Field     ;
                SourceExpr="Ship-to Name" }

    { 24  ;2   ;Field     ;
                SourceExpr="Ship-to Address";
                Visible=FALSE }

    { 26  ;2   ;Field     ;
                SourceExpr="Ship-to Address 2";
                Visible=FALSE }

    { 30  ;2   ;Field     ;
                SourceExpr="Ship-to Post Code";
                Visible=FALSE }

    { 28  ;2   ;Field     ;
                SourceExpr="Ship-to City";
                Visible=FALSE }

    { 32  ;2   ;Field     ;
                SourceExpr="Ship-to County";
                Visible=FALSE }

    { 10  ;2   ;Field     ;
                ToolTipML=ENU=Specifies the Bill of Lading No. that contains this record.;
                SourceExpr="Bill of Lading No." }

    { 19  ;2   ;Field     ;
                SourceExpr="Package used on Bill of Lading" }

    { 12  ;2   ;Field     ;
                SourceExpr="External Document No." }

    { 34  ;2   ;Field     ;
                SourceExpr="Shipping Agent Code" }

    { 36  ;2   ;Field     ;
                ToolTipML=ENU=Specifies the E-Ship Agent Service used to ship the packages.;
                SourceExpr="E-Ship Agent Service" }

  }
  CODE
  {
    VAR
      SalesShipmentHeader@1000000000 : Record 110;
      BillOfLading@1000000001 : Record 14000822;
      PackingStation@1240030000 : Record 14000709;
      BillOfLadingWorksheetMgt@1240030001 : Codeunit 14000822;
      BillOfLadingNo@1000000003 : Code[20];
      Text001@1001 : TextConst 'ENU=Current Bill of Lading No. is not set.';
      "EDI ASN"@1000000002 : Boolean;

    PROCEDURE SetBillOfLadingCode@1(NewBillOfLadingNo@1000000000 : Code[20]);
    BEGIN
      BillOfLadingNo := NewBillOfLadingNo;
    END;

    LOCAL PROCEDURE CheckEDITradePartner@1000000000();
    VAR
      EDIDocument@1000000000 : Record 14002353;
    BEGIN
      //<TPZ2301>
      EDIDocument.RESET;
      EDIDocument.SETRANGE("Trade Partner No.","EDI Trade Partner");
      EDIDocument.SETRANGE("EDI Document No.",'856');
      EDIDocument.SETRANGE(Type,EDIDocument.Type::Export);
      EDIDocument.SETRANGE(Status,EDIDocument.Status::Production);
      IF EDIDocument.FINDFIRST THEN BEGIN
        "EDI ASN" := "EDI Order";
      END;
      //</TPZ2301>
    END;

    BEGIN
    {
      06-19-2018 TPZ2301 DKUMAR
       Added EDI Order Field.
    }
    END.
  }
}

