OBJECT Page 27032 DIOT Setup Wizard
{
  OBJECT-PROPERTIES
  {
    Date=10/26/19;
    Time=12:00:00 PM;
    Version List=NAVNA11.00.00.37606;
  }
  PROPERTIES
  {
    CaptionML=[ENU=DIOT Setup Wizard;
               ESM=Asistente para instalaci¢n de DIOT;
               FRC=Assistant configuration DIOT;
               ENC=DIOT Setup Wizard];
    SourceTable=Table3;
    PageType=NavigatePage;
    OnOpenPage=BEGIN
                 CODEUNIT.RUN(CODEUNIT::"DIOT Installation");
                 Step := Step::Welcome;
                 ShowWelcomeStep;
               END;

    ActionList=ACTIONS
    {
      { 1310008 ;    ;ActionContainer;
                      Name=Processing;
                      ActionContainerType=ActionItems }
      { 1310009 ;1   ;Action    ;
                      Name=ActionBack;
                      CaptionML=[ENU=Back;
                                 ESM=Atr s;
                                 FRC=Retour;
                                 ENC=Back];
                      ApplicationArea=#Basic, #Suite;
                      Enabled=BackActionEnabled;
                      InFooterBar=Yes;
                      Image=PreviousRecord;
                      OnAction=BEGIN
                                 NextStep(TRUE);
                               END;
                                }
      { 1310010 ;1   ;Action    ;
                      Name=ActionNext;
                      CaptionML=[ENU=Next;
                                 ESM=Siguiente;
                                 FRC=Suivant;
                                 ENC=Next];
                      ApplicationArea=#Basic, #Suite;
                      Enabled=NextActionEnabled;
                      InFooterBar=Yes;
                      Image=NextRecord;
                      OnAction=BEGIN
                                 NextStep(FALSE);
                               END;
                                }
      { 1310011 ;1   ;Action    ;
                      Name=ActionFinish;
                      CaptionML=[ENU=Finish;
                                 ESM=Terminar;
                                 FRC=Terminer;
                                 ENC=Finish];
                      ApplicationArea=#Basic, #Suite;
                      Enabled=FinishActionEnabled;
                      InFooterBar=Yes;
                      Image=Approve;
                      OnAction=BEGIN
                                 FinishAction;
                               END;
                                }
      { 1310012 ;1   ;Action    ;
                      Name=OpenDIOTConceptList;
                      CaptionML=[ENU=Open DIOT Concepts;
                                 ESM=Conceptos de DIOT abiertos;
                                 FRC=Concepts DIOT ouverts;
                                 ENC=Open DIOT Concepts];
                      ApplicationArea=#Basic, #Suite;
                      Visible=ThirdStepVisible;
                      InFooterBar=Yes;
                      Image=SetupList;
                      OnAction=BEGIN
                                 DIOTConceptsPage.RUNMODAL;
                                 CLEAR(DIOTConceptsPage);
                               END;
                                }
      { 1310013 ;1   ;Action    ;
                      Name=OpenVendorDIOTTypeList;
                      CaptionML=[ENU=Open Vendor List;
                                 ESM=Lista de proveedores abiertos;
                                 FRC=Ouvrir la liste des fournisseurs;
                                 ENC=Open Vendor List];
                      ApplicationArea=#Basic, #Suite;
                      Visible=SecondStepVisible;
                      InFooterBar=Yes;
                      Image=SetupList;
                      OnAction=BEGIN
                                 SetupVendorDIOTTypePage.RUNMODAL;
                                 CLEAR(SetupVendorDIOTTypePage);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1310000; ;Container ;
                Name=General;
                CaptionML=[ENU=General;
                           ESM=General;
                           FRC=G‚n‚ral;
                           ENC=General];
                ContainerType=ContentArea }

    { 1310001;1;Group     ;
                Name=Welcome;
                CaptionML=[ENU=Welcome to the DIOT Setup Wizard;
                           ESM=Bienvenido al asistente para instalaci¢n de DIOT;
                           FRC=Bienvenue dans l'Assistant Configuration DIOT;
                           ENC=Welcome to the DIOT Setup Wizard];
                Visible=WelcomeStepVisible;
                GroupType=Group;
                InstructionalTextML=[ENU=The DIOT is a monthly/quarterly declaration that is required by Mexican SAT. This extension will export your data to a properly formatted file that you can import into the government-provided tool. This wizard will guide you through setting up DIOT for the Mexico version of Dynamics 365 Business Central. If you do not want to set this up right now, close this page.;
                                     ESM=La DIOT es una declaraci¢n mensual/trimestral que es necesaria para el SAT. mexicano. Este extensi¢n exportar  los datos a un archivo con el formato apropiado que se pueda importar a la herramienta proporcionada por el gobierno. Este asistente le guiar  a trav‚s de la configuraci¢n de DIOT para la versi¢n M‚xico de Dynamics 365 Business Central. Si no desea configurar este bot¢n ahora, cierre esta p gina.;
                                     FRC=La d‚claration DIOT est un relev‚ mensuel/trimestriel requis par le SAT mexicain. Cette extension va exporter vos donn‚es dans un fichier au format correct que vous pouvez importer dans l'outil fourni par le gouvernement. Cet Assistant va vous guider tout au long de la configuration de la d‚claration DIOT pour la version mexicaine de Dynamics 365 Business central. Si vous ne souhaitez pas effectuer cette configuration maintenant, fermez cette page.;
                                     ENC=The DIOT is a monthly/quarterly declaration that is required by Mexican SAT. This extension will export your data to a properly formatted file that you can import into the government-provided tool. This wizard will guide you through setting up DIOT for the Mexico version of Dynamics 365 Business Central. If you do not want to set this up right now, close this page.] }

    { 1310002;1;Group     ;
                Name=FirstStep;
                CaptionML=[ENU=FirstStep;
                           ESM=FirstStep;
                           FRC=FirstStep;
                           ENC=FirstStep];
                Visible=FirstStepVisible;
                GroupType=Group }

    { 1310007;2;Group     ;
                Name=DIOTOperationTypeDescription;
                CaptionML=[ENU=Set up default DIOT Type of Operation;
                           ESM=Configurar el tipo de operaci¢n predeterminado de DIOT;
                           FRC=Configurer le type d'op‚ration DIOT par d‚faut;
                           ENC=Set up default DIOT Type of Operation];
                GroupType=Group;
                InstructionalTextML=[ENU=DIOT requires all reported operations with vendors to have a type. In this step, you can set up a default value that all new vendors will get upon creation. If you specify this value with the wizard now, all vendors in your database will be updated with the value. Note that vendors that do not operate in Mexico cannot have the Lease and Rent operation type. Do not select Lease and Rent unless all the vendors you work with operate in Mexico.;
                                     ESM=DIOT requiere que todas las operaciones con proveedores est‚n registradas para tener un tipo. En este paso, puede configurar un valor predeterminado que los proveedores nuevos obtendr n al crearse. Si especifica este valor con el asistente ahora, todos los proveedores de la base de datos se actualizar n con el valor. Tenga en cuenta que los proveedores que no operan en M‚xico no pueden tener el tipo de operaci¢n arrendar y alquilar. No seleccione arrendar ni alquilar a menos que todos los proveedores con los que trabaje en M‚xico.;
                                     FRC=La d‚claration DIOT exige que toutes les op‚rations signal‚es avec fournisseurs aient un type. Cette ‚tape vous permet de configurer une valeur par d‚faut que tous les nouveaux fournisseurs obtiendront dŠs leur cr‚ation. Si vous sp‚cifiez cette valeur … l'aide de l'Assistant maintenant, tous les fournisseurs de votre base de donn‚es seront mis … jour avec la valeur. Notez que les fournisseurs qui n'exercent pas au Mexique ne peuvent pas avoir le type d'op‚ration Location et loyer. Ne s‚lectionnez pas Location et loyer, … moins que tous les fournisseurs avec lesquels vous travaillez exercent au Mexique.;
                                     ENC=DIOT requires all reported operations with vendors to have a type. In this step, you can set up a default value that all new vendors will get upon creation. If you specify this value with the wizard now, all vendors in your database will be updated with the value. Note that vendors that do not operate in Mexico cannot have the Lease and Rent operation type. Do not select Lease and Rent unless all the vendors you work with operate in Mexico.] }

    { 1310006;2;Field     ;
                Name=DefaultDIOTVendorType;
                CaptionML=[ENU=Default Vendor DIOT Type of Operation;
                           ESM=Tipo de operaci¢n de la DIOT del proveedor predeterminado;
                           FRC=Type d'op‚ration DIOT fournisseur par d‚faut;
                           ENC=Default Vendor DIOT Type of Operation];
                ToolTipML=[ENU=Specifies the default DIOT operation type to be used for all vendors.;
                           ESM=Especifica el tipo de operaci¢n de DIOT predeterminado que se va a usar para todos los proveedores.;
                           FRC=Sp‚cifie le type d'op‚ration DIOT par d‚faut … utiliser pour tous les fournisseurs.;
                           ENC=Specifies the default DIOT operation type to be used for all vendors.];
                ApplicationArea=#Basic, #Suite;
                SourceExpr=DummyPurchasesPayablesSetup."DIOT Default Vendor Type";
                OnValidate=BEGIN
                             DummyPurchasesPayablesSetup.MODIFY(TRUE);
                           END;
                            }

    { 1310003;1;Group     ;
                Name=SecondStep;
                CaptionML=[ENU=Set up individual DIOT Type of Operation for Vendors;
                           ESM=Configurar el tipo de operaci¢n de DIOT individual para proveedores;
                           FRC=Configurer le type d'op‚ration DIOT individuel pour les fournisseurs;
                           ENC=Set up individual DIOT Type of Operation for Vendors];
                Visible=SecondStepVisible;
                GroupType=Group;
                InstructionalTextML=[ENU=DIOT requires all reported operations with vendors to have a type. In this step, you can set up a type for each vendor individually. This value will be used for all operations with the vendor, unless you specifically set another value in the individual document when posting. Currently, all vendors have a DIOT operation type equal to the default value that you selected in the previous step. If you do not want to change any existing vendors, you can ignore this step.;
                                     ESM=DIOT requiere que todas las operaciones con proveedores est‚n registradas para tener un tipo. En este paso, puede configurar un tipo para cada proveedor de forma individual. Este valor se usar  para todas las operaciones con el proveedor, a menos que defina espec¡ficamente otro valor en el documento individual al registrar. Actualmente, todos los proveedores tienen un tipo de operaci¢n DIOT igual al valor predeterminado que se seleccion¢ en el paso anterior. Si no desea modificar ninguno de los proveedores existentes, puede ignorar este paso.;
                                     FRC=La d‚claration DIOT exige que toutes les op‚rations signal‚es avec fournisseurs aient un type. Cette ‚tape vous permet de configurer un type pour chaque fournisseur individuellement. Cette valeur sera utilis‚e pour toutes les op‚rations avec ce fournisseur, sauf si vous d‚finissez sp‚cifiquement une autre valeur dans le document sp‚cifique lors du report. Actuellement, tous les fournisseurs ont un type d'op‚ration DIOT correspondant … la valeur par d‚faut que vous avez s‚lectionn‚e … l'‚tape pr‚c‚dente. Si vous ne souhaitez pas modifier les fournisseurs existants, vous pouvez ignorer cette ‚tape.;
                                     ENC=DIOT requires all reported operations with vendors to have a type. In this step, you can set up a type for each vendor individually. This value will be used for all operations with the vendor, unless you specifically set another value in the individual document when posting. Currently, all vendors have a DIOT operation type equal to the default value that you selected in the previous step. If you do not want to change any existing vendors, you can ignore this step.] }

    { 1310004;1;Group     ;
                Name=ThirdStep;
                CaptionML=[ENU=Set up DIOT Concepts;
                           ESM=Configuraci¢n de conceptos de DIOT;
                           FRC=Configurer les concepts DIOT;
                           ENC=Set up DIOT Concepts];
                Visible=ThirdStepVisible;
                GroupType=Group;
                InstructionalTextML=[ENU=DIOT uses several concept definitions to provide Tax-related information to SAT. You must link your existing or future Tax posting setups to the appropriate concepts for this report to produce correct and valid numbers. Please set the links up on the DIOT Concept Links page.;
                                     ESM=DIOT usa varias definiciones de concepto para proporcionar reportaci¢n relacionada con el IVA a SAT. Debe vincular su configuraci¢n de registro de IVA existente o futura a los conceptos adecuados para este reporte para generar n£meros correctos y v lidos. Configure los v¡nculos hacia arriba en la p gina v¡nculos de concepto de DIOT.;
                                     FRC=La d‚claration DIOT utilise plusieurs d‚finitions de concept pour fournir des informations relatives … la TVA … SAT. Vous devez lier vos configurations de report TVA existantes ou futures avec les concepts appropri‚s de ce rapport pour produire des chiffres corrects et valides. Configurez les liens sur la page Liens concept DIOT.;
                                     ENC=DIOT uses several concept definitions to provide tax-related information to SAT. You must link your existing or future tax posting setups to the appropriate concepts for this report to produce correct and valid numbers. Please set the links up on the DIOT Concept Links page.] }

    { 1310005;1;Group     ;
                Name=Finish;
                CaptionML=[ENU=All done!;
                           ESM=­Listo!;
                           FRC=Tout est termin‚!;
                           ENC=All done!];
                Visible=FinishStepVisible;
                GroupType=Group;
                InstructionalTextML=[ENU=Seems like you are all done! Now you can choose the Generate DIOT Report action to generate the DIOT file from your data.;
                                     ESM=Parece que ya ha terminado. Ahora puede elegir la acci¢n generar reporte de DIOT para generar el archivo DIOT a partir de los datos.;
                                     FRC=Il semble que vous ayez termin‚! Vous pouvez … pr‚sent choisir l'action G‚n‚rer un rapport DIOT pour g‚n‚rer le fichier DIOT … partir de vos donn‚es.;
                                     ENC=Seems like you are all done! Now you can choose the Generate DIOT Report action to generate the DIOT file from your data.] }

  }
  CODE
  {
    VAR
      DummyPurchasesPayablesSetup@1310000 : Record 312;
      DIOTConceptsPage@1310002 : Page 27030;
      SetupVendorDIOTTypePage@1310003 : Page 27034;
      BackActionEnabled@1310004 : Boolean;
      NextActionEnabled@1310005 : Boolean;
      FinishActionEnabled@1310006 : Boolean;
      WelcomeStepVisible@1310007 : Boolean;
      FirstStepVisible@1310008 : Boolean;
      SecondStepVisible@1310009 : Boolean;
      ThirdStepVisible@1310010 : Boolean;
      FinishStepVisible@1310011 : Boolean;
      Step@1310012 : 'Welcome,First,Second,Third,Finish';

    LOCAL PROCEDURE FinishAction@1310001();
    BEGIN
      CurrPage.CLOSE;
    END;

    LOCAL PROCEDURE NextStep@1310002(Backwards@1310000 : Boolean);
    BEGIN
      DoActionOnNext(Step);
      IF Backwards THEN
        Step := Step - 1
      ELSE
        Step := Step + 1;
      EnableControls;
    END;

    LOCAL PROCEDURE EnableControls@1310003();
    BEGIN
      HideAllControls;

      CASE Step OF
        Step::Welcome:
          ShowWelcomeStep;
        Step::First:
          ShowFirstStep;
        Step::Second:
          ShowSecondStep;
        Step::Third:
          ShowThirdStep;
        Step::Finish:
          ShowFinish;
      END;
    END;

    LOCAL PROCEDURE ShowWelcomeStep@1310004();
    BEGIN
      NextActionEnabled := TRUE;
      WelcomeStepVisible := TRUE;
    END;

    LOCAL PROCEDURE ShowFirstStep@1310013();
    BEGIN
      BackActionEnabled := TRUE;
      NextActionEnabled := TRUE;
      FirstStepVisible := TRUE;
    END;

    LOCAL PROCEDURE ShowSecondStep@1310005();
    BEGIN
      BackActionEnabled := TRUE;
      NextActionEnabled := TRUE;
      SecondStepVisible := TRUE;
    END;

    LOCAL PROCEDURE ShowThirdStep@1310006();
    BEGIN
      BackActionEnabled := TRUE;
      NextActionEnabled := TRUE;
      ThirdStepVisible := TRUE;
    END;

    LOCAL PROCEDURE ShowFinish@1310007();
    BEGIN
      BackActionEnabled := TRUE;
      FinishActionEnabled := TRUE;
      FinishStepVisible := TRUE;
    END;

    LOCAL PROCEDURE HideAllControls@1310008();
    BEGIN
      FinishActionEnabled := FALSE;
      BackActionEnabled := FALSE;
      NextActionEnabled := FALSE;

      WelcomeStepVisible := FALSE;
      FirstStepVisible := FALSE;
      SecondStepVisible := FALSE;
      ThirdStepVisible := FALSE;
      FinishStepVisible := FALSE;
    END;

    LOCAL PROCEDURE DoActionOnNext@1310009(CurrentStep@1310000 : Option);
    BEGIN
      CASE CurrentStep OF
        Step::First:
          UpdateTypeOnVendors;
      END;
    END;

    LOCAL PROCEDURE UpdateTypeOnVendors@1310010();
    VAR
      Vendor@1310000 : Record 23;
      PurchasesPayablesSetup@1310001 : Record 312;
    BEGIN
      PurchasesPayablesSetup.GET;
      IF PurchasesPayablesSetup."DIOT Default Vendor Type" = PurchasesPayablesSetup."DIOT Default Vendor Type"::" " THEN
        EXIT;
      IF NOT Vendor.ISEMPTY THEN
        Vendor.MODIFYALL("DIOT-Type of Operation",PurchasesPayablesSetup."DIOT Default Vendor Type");
    END;

    BEGIN
    END.
  }
}

