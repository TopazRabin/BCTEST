OBJECT Page 50083 Topaz Inventory File  List
{
  OBJECT-PROPERTIES
  {
    Date=12/15/20;
    Time=12:00:00 AM;
    Modified=Yes;
    Version List=TPZ3001;
  }
  PROPERTIES
  {
    SourceTable=Table50056;
    DelayedInsert=Yes;
    PageType=List;
    ShowFilter=No;
    OnOpenPage=BEGIN
                 InventoryStatusVisibla := FALSE;
                 InventoryStatusItemCatVis:= FALSE;
                 ErrorLogVsb := FALSE;
                 IF GETFILTER("Option Choice") = 'INVENTORYSTATUS' THEN BEGIN
                   InventoryStatusVisibla := TRUE;
                   CurrPage.CAPTION('Inventory Status');
                 END;
                 IF GETFILTER("DefaultCode 20_1") = 'INVENTORYITEMCAT' THEN BEGIN
                   InventoryStatusItemCatVis:= TRUE;
                   CurrPage.CAPTION('Item Category Code');
                 END;
                 IF GETFILTER("DefaultCode 20") = 'INVENTORYSTATUSERROR' THEN BEGIN
                   CurrPage.CAPTION('Error Log');
                   ErrorLogVsb := TRUE;
                 END;
                 FilterString := GETVIEW;
               END;

    OnAfterGetRecord=BEGIN
                       IF GETFILTER("Option Choice") = 'INVENTORYSTATUS' THEN
                         InventoryStatusVisibla := TRUE;
                       IF GETFILTER("DefaultCode 20_1") = 'INVENTORYITEMCAT' THEN
                         InventoryStatusItemCatVis:= TRUE;
                       IF GETFILTER("DefaultCode 20") = 'INVENTORYSTATUSERROR' THEN BEGIN
                         CurrPage.CAPTION('Error Log');
                         ErrorLogVsb := TRUE;
                       END;
                       SETVIEW(FilterString);
                     END;

    ActionList=ACTIONS
    {
      { 1000000003;  ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1000000010;1 ;Action    ;
                      Name=Item Category;
                      Promoted=Yes;
                      Visible=InventoryStatusVisibla;
                      PromotedIsBig=Yes;
                      Image=ItemGroup;
                      OnAction=VAR
                                 TopazSetup@1000000000 : Record 50056;
                                 TopazList@1000000001 : Page 50083;
                               BEGIN
                                 TopazSetup.RESET;
                                 TopazSetup.SETRANGE("DefaultCode 20_3",Option);
                                 TopazSetup.SETRANGE("DefaultCode 20_1" , 'INVENTORYITEMCAT');
                                 TopazList.SETTABLEVIEW(TopazSetup);
                                 TopazList.RUNMODAL;
                               END;
                                }
      { 1000000019;1 ;Action    ;
                      Name=Error Log;
                      Promoted=Yes;
                      Visible=InventoryStatusVisibla;
                      Image=ErrorLog;
                      OnAction=VAR
                                 TopazSetup@1000000001 : Record 50056;
                                 TopazList@1000000000 : Page 50083;
                               BEGIN
                                 TopazSetup.RESET;
                                 TopazSetup.SETRANGE(Option,Option);
                                 TopazSetup.SETRANGE("DefaultCode 20" , 'INVENTORYSTATUSERROR');
                                 TopazList.SETTABLEVIEW(TopazSetup);
                                 TopazList.EDITABLE(FALSE);
                                 TopazList.RUNMODAL;
                               END;
                                }
      { 1000000021;1 ;Action    ;
                      Name=Process;
                      Visible=InventoryStatusVisibla;
                      OnAction=VAR
                                 InventoryStatusReport@1000000000 : Codeunit 51992;
                               BEGIN
                                 IF NOT InventoryStatusReport.ExportDataandCreateFile(Rec) THEN BEGIN
                                   InventoryStatusReport.TopazSetupLog(Rec.Option,TRUE);//Error handling, save record
                                 END ELSE BEGIN
                                   CLEARLASTERROR;
                                   IF InventoryStatusReport.SendEmail(Rec) THEN BEGIN
                                     InventoryStatusReport.TopazSetupLog(Rec.Option,FALSE);//Error handling if notification failed
                                     Rec.DefaultDate := TODAY;
                                     IF Rec.MODIFY THEN;
                                     COMMIT;
                                   END ELSE CLEARLASTERROR;
                                 END;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1000000000;0;Container;
                ContainerType=ContentArea }

    { 1000000001;1;Group  ;
                Name=Group;
                GroupType=Repeater }

    { 1000000002;2;Field  ;
                CaptionML=ENU=Customer No.;
                SourceExpr=Option;
                Visible=InventoryStatusVisibla;
                OnValidate=VAR
                             CustLoc@1000000000 : Record 18;
                           BEGIN
                             CustLoc.GET(Option);
                             "Option Choice" := 'INVENTORYSTATUS';
                             Option := CustLoc."No.";
                             "DefaultText 30" := CustLoc.Name;
                           END;

                OnLookup=VAR
                           CustLoc@1000000000 : Record 18;
                         BEGIN
                           IF CustLoc.GET(Option) THEN;
                           CustLoc.RESET;
                           IF PAGE.RUNMODAL(0,CustLoc) = ACTION::LookupOK THEN BEGIN
                             Option := CustLoc."No.";
                             "Option Choice" := 'INVENTORYSTATUS';
                             "DefaultText 30" := CustLoc.Name;
                           END;
                         END;
                          }

    { 1000000008;2;Field  ;
                CaptionML=ENU=Customer Name;
                SourceExpr="DefaultText 30";
                Visible=InventoryStatusVisibla;
                OnValidate=BEGIN
                             TESTFIELD(Option);
                           END;
                            }

    { 1000000004;2;Field  ;
                CaptionML=ENU=Report Format;
                SourceExpr="DefaultCode 20";
                Visible=InventoryStatusVisibla;
                OnValidate=BEGIN
                             TESTFIELD(Option);
                           END;
                            }

    { 1000000005;2;Field  ;
                CaptionML=ENU=Report Cadence;
                SourceExpr="DefaultCode 20_1";
                Visible=InventoryStatusVisibla;
                OnValidate=BEGIN
                             TESTFIELD(Option);
                           END;
                            }

    { 1000000006;2;Field  ;
                CaptionML=ENU=Delivery Method;
                SourceExpr="DefaultCode 20_2";
                Visible=InventoryStatusVisibla;
                OnValidate=BEGIN
                             TESTFIELD(Option);
                           END;
                            }

    { 1000000012;2;Field  ;
                CaptionML=ENU=Requested File Name;
                SourceExpr=DefaultText250;
                Visible=InventoryStatusVisibla;
                OnValidate=BEGIN
                             TESTFIELD(Option);
                           END;
                            }

    { 1000000017;2;Field  ;
                CaptionML=ENU=Final Report Destination(To Email);
                SourceExpr="To Email";
                Visible=InventoryStatusVisibla;
                OnValidate=BEGIN
                             TESTFIELD(Option);
                           END;
                            }

    { 1000000018;2;Field  ;
                SourceExpr="CC Email";
                Visible=InventoryStatusVisibla;
                OnValidate=BEGIN
                             TESTFIELD(Option);
                           END;
                            }

    { 1000000015;2;Field  ;
                CaptionML=ENU=Enable;
                SourceExpr="Default Boolean";
                Visible=InventoryStatusVisibla;
                OnValidate=BEGIN
                             TESTFIELD(Option);
                           END;
                            }

    { 1000000007;2;Field  ;
                Name=Columns to be Excluded;
                CaptionML=ENU=Columns to be Excluded;
                SourceExpr="DefaultText 30_1";
                Visible=InventoryStatusVisibla }

    { 1000000020;2;Field  ;
                CaptionML=ENU=Last Run Date;
                SourceExpr=DefaultDate;
                Visible=InventoryStatusVisibla }

    { 1000000009;2;Field  ;
                Name=Item Category Code;
                CaptionML=ENU=Item Category Code;
                SourceExpr=Option;
                Visible=InventoryStatusItemCatVis;
                OnValidate=BEGIN
                             IF (Option = 'MISC') OR (Option = 'PKG') THEN
                               ERROR('Item Category Code %1 is not allowed.',Option);"DefaultCode 20_3" := GETFILTER("DefaultCode 20_3");
                             "Option Choice" := "DefaultCode 20_3";
                             "DefaultCode 20_1" := 'INVENTORYITEMCAT';
                           END;
                            }

    { 1000000011;2;Field  ;
                Name=CustName;
                CaptionML=ENU=Customer No.;
                SourceExpr=Option;
                Visible=ErrorLogVsb;
                Editable=false }

    { 1000000013;2;Field  ;
                Name=Error Type;
                SourceExpr="DefaultText 30";
                Visible=ErrorLogVsb;
                Editable=false }

    { 1000000014;2;Field  ;
                Name=Error Description;
                SourceExpr=DefaultText250;
                Visible=ErrorLogVsb;
                Editable=false }

    { 1000000016;2;Field  ;
                Name=Error Date;
                SourceExpr=DefaultDate;
                Visible=ErrorLogVsb;
                Editable=false }

  }
  CODE
  {
    VAR
      InventoryStatusVisibla@1000000000 : Boolean;
      InventoryStatusItemCatVis@1000000001 : Boolean;
      ErrorLogVsb@1000000002 : Boolean;
      FilterString@1000000003 : Text;

    BEGIN
    END.
  }
}

