OBJECT Page 23044502 WHI Component Usage
{
  OBJECT-PROPERTIES
  {
    Date=04/29/19;
    Time=10:30:34 AM;
    Version List=WHI2.4.7684.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Component Usage;
               ESM=Uso del componente;
               FRC=Utilisation du composant;
               ENC=Component Usage];
    InsertAllowed=No;
    DeleteAllowed=No;
    SourceTable=Table23044501;
    PageType=List;
  }
  CONTROLS
  {
    { 1000000000;;Container;
                ContainerType=ContentArea }

    { 1000000001;1;Field  ;
                CaptionML=[ENU=Document No. Filter;
                           ESM=Filtrar por Documento No.;
                           FRC=Filtre par No. Document;
                           ENC=Document No. Filter];
                ToolTipML=[ENU=Filter to a specific document.;
                           ESM=Filtrar a un documento espec¡fico.;
                           FRC=Filtrer vers un document sp‚cifique.;
                           ENC=Filter to a specific document.];
                SourceExpr=sDocumentNoFilter;
                OnValidate=BEGIN
                             onDocNumberChange(sDocumentNoFilter);
                           END;
                            }

    { 1000000002;1;Group  ;
                GroupType=Repeater }

    { 1000000005;2;Field  ;
                ToolTipML=[ENU=Contains the ID of the user that created the component usage line.;
                           ESM=Contiene el ID del usuario que cre¢ la l¡nea de uso del componente.;
                           FRC=Contient l'ID de l'utilisateur qui a cr‚‚ la ligne d'utilisation du composant.;
                           ENC=Contains the ID of the user that created the component usage line.];
                SourceExpr="User ID";
                Visible=FALSE }

    { 1000000006;2;Field  ;
                ToolTipML=[ENU=Specifies the number of the production order to which component usage has been recorded for.;
                           ESM=Especifica el n£mero de la orden de producci¢n para la que se ha registrado el uso de componentes.;
                           FRC=Sp‚cifie le num‚ro de l'ordre de fabrication pour lequel l'utilisation des composants a ‚t‚ enregistr‚e.;
                           ENC=Specifies the number of the production order to which component usage has been recorded for.];
                SourceExpr="Prod. Order No." }

    { 1000000007;2;Field  ;
                ToolTipML=[ENU=Specifies the production order line number to which component usage has been recorded for.;
                           ESM=Especifica el n£mero de l¡nea de orden de producci¢n para el que se ha registrado el uso de componentes.;
                           FRC=Sp‚cifie le num‚ro de ligne de l'ordre de fabrication pour lequel l'utilisation des composants a ‚t‚ enregistr‚e.;
                           ENC=Specifies the production order line number to which component usage has been recorded for.];
                SourceExpr="Prod. Order Line No.";
                Visible=FALSE }

    { 1000000008;2;Field  ;
                ToolTipML=[ENU=Specifies the number of the item to be produced.;
                           ESM=Especifica el n£mero del art¡culo a producir.;
                           FRC=Sp‚cifie le num‚ro de l'article … produire.;
                           ENC=Specifies the number of the item to be produced.];
                SourceExpr="Prod. Source No." }

    { 1000000009;2;Field  ;
                ToolTipML=[ENU=Specifies a code if you have set up variant codes in the Item Variants window.;
                           ESM=Especifica un c¢digo si ha configurado c¢digos de variante en la ventana Variantes de elementos.;
                           FRC=Sp‚cifie un code si vous avez configur‚ des codes de variante dans la fenˆtre Variantes de poste.;
                           ENC=Specifies a code if you have set up variant codes in the Item Variants window.];
                SourceExpr="Prod. Source Variant Code";
                Visible=FALSE }

    { 1000000010;2;Field  ;
                ToolTipML=[ENU=Specifies the serial number if the production order line contains an item that was posted with serial number tracking.;
                           ESM=Especifica el n£mero de serie si la l¡nea de orden de producci¢n contiene un art¡culo que se public¢ con el seguimiento del n£mero de serie.;
                           FRC=Sp‚cifie le num‚ro de s‚rie si la ligne d'ordre de fabrication contient un article qui a ‚t‚ enregistr‚ avec le suivi du num‚ro de s‚rie.;
                           ENC=Specifies the serial number if the production order line contains an item that was posted with serial number tracking.];
                SourceExpr="Prod. Serial No." }

    { 1000000011;2;Field  ;
                ToolTipML=[ENU=Specifies the lot number if the production order line contains an item that was posted with lot number tracking.;
                           ESM=Especifica el n£mero de lote si la l¡nea de orden de producci¢n contiene un art¡culo que se public¢ con el seguimiento del n£mero de lote.;
                           FRC=Sp‚cifie le num‚ro de lot si la ligne d'ordre de fabrication contient un article qui a ‚t‚ enregistr‚ avec un suivi du num‚ro de lot.;
                           ENC=Specifies the lot number if the production order line contains an item that was posted with lot number tracking.];
                SourceExpr="Prod. Lot No." }

    { 1000000012;2;Field  ;
                ToolTipML=[ENU=Specifies the number of the item being consumed.;
                           ESM=Especifica el n£mero del art¡culo que se consume.;
                           FRC=Sp‚cifie le num‚ro de l'article en cours de consommation.;
                           ENC=Specifies the number of the item being consumed.];
                SourceExpr="Cons. Item No." }

    { 1000000003;2;Field  ;
                Name=fldDescription;
                CaptionML=[ENU=Description;
                           ESM=Descripci¢n;
                           FRC=Description;
                           ENC=Description];
                ToolTipML=[ENU=Specifies the description of the item.;
                           ESM=Especifica la descripci¢n del art¡culo.;
                           FRC=Sp‚cifie la description de l'‚l‚ment.;
                           ENC=Specifies the description of the item.];
                SourceExpr=getDescription;
                Visible=False }

    { 1000000013;2;Field  ;
                ToolTipML=[ENU=Specifies the code for the variant set up on the consumption line.;
                           ESM=Especifica el c¢digo para la variante configurada en la l¡nea de consumo.;
                           FRC=Sp‚cifie le code de la variante configur‚e sur la ligne de consommation.;
                           ENC=Specifies the code for the variant set up on the consumption line.];
                SourceExpr="Cons. Variant Code";
                Visible=FALSE }

    { 1000000014;2;Field  ;
                ToolTipML=[ENU=Specifies the serial number if the consumption entry line contains an item that was posted with serial number tracking.;
                           ESM=Especifica el n£mero de serie si la l¡nea de entrada de consumo contiene un art¡culo que se public¢ con el seguimiento del n£mero de serie.;
                           FRC=Sp‚cifie le num‚ro de s‚rie si la ligne de saisie de consommation contient un article qui a ‚t‚ enregistr‚ avec le suivi du num‚ro de s‚rie.;
                           ENC=Specifies the serial number if the consumption entry line contains an item that was posted with serial number tracking.];
                SourceExpr="Cons. Serial No." }

    { 1000000015;2;Field  ;
                ToolTipML=[ENU=Specifies the lot number if the consumption entry line contains an item that was posted with lot number tracking.;
                           ESM=Especifica el n£mero de lote si la l¡nea de entrada de consumo contiene un art¡culo que se public¢ con el seguimiento del n£mero de lote.;
                           FRC=Sp‚cifie le num‚ro de lot si la ligne de saisie de consommation contient un article qui a ‚t‚ enregistr‚ avec un suivi du num‚ro de lot.;
                           ENC=Specifies the lot number if the consumption entry line contains an item that was posted with lot number tracking.];
                SourceExpr="Cons. Lot No." }

    { 1000000016;2;Field  ;
                ToolTipML=[ENU=Contains the text representation of the scanned barcode.;
                           ESM=Contiene la representaci¢n de texto del c¢digo de barras escaneado.;
                           FRC=Contient la repr‚sentation textuelle du code … barres num‚ris‚.;
                           ENC=Contains the text representation of the scanned barcode.];
                SourceExpr="Cons. Barcode Data";
                Visible=FALSE }

    { 1000000017;2;Field  ;
                ToolTipML=[ENU=Specifies a consumption quantity for the item.;
                           ESM=Especifica una cantidad de consumo para el art¡culo.;
                           FRC=Sp‚cifie une quantit‚ de consommation pour l'article.;
                           ENC=Specifies a consumption quantity for the item.];
                SourceExpr="Cons. Quantity" }

    { 1000000004;2;Field  ;
                ToolTipML=[ENU=Specifies the unit of measure code used for the consumption entry.;
                           ESM=Especifica el c¢digo de unidad de medida utilizado para la entrada de consumo.;
                           FRC=Sp‚cifie le code d'unit‚ de mesure utilis‚ pour l'entr‚e de consommation.;
                           ENC=Specifies the unit of measure code used for the consumption entry.];
                SourceExpr="Cons. Unit of Measure Code" }

  }
  CODE
  {
    VAR
      sDocumentNoFilter@1000000001 : Text[100];
      recItem@1000000000 : Record 27;

    LOCAL PROCEDURE getDescription@1000000025() : Text[100];
    BEGIN
      IF( recItem.GET("Cons. Item No.") ) THEN BEGIN
        EXIT(recItem.Description + recItem."Description 2");
      END
      ELSE BEGIN
        EXIT('');
      END;
    END;

    LOCAL PROCEDURE onDocNumberChange@1000000033(psDocumentNoFilter@1000000000 : Text[100]);
    VAR
      lrecItemLedgerEntry@1000000001 : Record 32;
      lrecSalesShipmentHeader@1000000004 : Record 110;
      lsSerialNoFilter@1000000002 : Text[100];
      lsProdOrderNoFilter@1000000003 : Text[100];
      lsDocumentNoFilterTemp@1000000005 : Text[100];
      liCount@1000000006 : Integer;
    BEGIN
      CLEAR(lsSerialNoFilter);
      CLEAR(lsProdOrderNoFilter);

      IF( psDocumentNoFilter <> '' ) THEN BEGIN
        lsDocumentNoFilterTemp := psDocumentNoFilter;

        // first check to see if it's a sales document no.
        // if it is, grab the sales shipment and use that
        lrecSalesShipmentHeader.SETFILTER("Order No.",psDocumentNoFilter);
        lrecSalesShipmentHeader.SETFILTER("No.",'<>%1','');
        liCount := 0;
        IF( lrecSalesShipmentHeader.FIND('-') ) THEN BEGIN
          REPEAT
            IF( liCount <> 0 ) THEN
              lsDocumentNoFilterTemp  := lsDocumentNoFilterTemp + '|'
            ELSE
              lsDocumentNoFilterTemp := lsDocumentNoFilterTemp + lrecSalesShipmentHeader."No.";

            liCount := liCount + 1;
          UNTIL( lrecSalesShipmentHeader.NEXT=0 );
        END;

        // try to find based on the sales shipment
        lrecItemLedgerEntry.RESET;
        lrecItemLedgerEntry.SETFILTER("Document No.",lsDocumentNoFilterTemp);
        lrecItemLedgerEntry.SETRANGE("Entry Type",lrecItemLedgerEntry."Entry Type"::Sale);
        lrecItemLedgerEntry.SETFILTER("Serial No.",'<>%1','');
        liCount := 0;
        IF( lrecItemLedgerEntry.FIND('-') ) THEN BEGIN
          REPEAT
            IF( liCount <> 0 ) THEN
              lsSerialNoFilter := lsSerialNoFilter + '|'
            ELSE
              lsSerialNoFilter := lsSerialNoFilter + lrecItemLedgerEntry."Serial No.";

            liCount := liCount + 1;
          UNTIL( lrecItemLedgerEntry.NEXT=0 );
        END
        ELSE BEGIN
          // try to find it based on production order
          lrecItemLedgerEntry.RESET;
          lrecItemLedgerEntry.SETFILTER("Document No.",psDocumentNoFilter);
          lrecItemLedgerEntry.SETFILTER("Entry Type",'%1|%2',
             lrecItemLedgerEntry."Entry Type"::Output,
             lrecItemLedgerEntry."Entry Type"::Consumption);
          IF( lrecItemLedgerEntry.FIND('-') ) THEN BEGIN
            lsProdOrderNoFilter := psDocumentNoFilter;
          END;
        END;
      END;

      Rec.FILTERGROUP(2);
      Rec.SETFILTER("Prod. Serial No.",lsSerialNoFilter);
      Rec.SETFILTER("Prod. Order No.",lsProdOrderNoFilter);
      Rec.FILTERGROUP(0);


      CurrPage.UPDATE(FALSE);


      IF( (lsSerialNoFilter='') AND (lsProdOrderNoFilter='') ) THEN BEGIN
        // could possibly show error
      END;
    END;

    BEGIN
    {
      ************************
      Copyright Notice
      This objects content is copyright of Insight Works 2011.  All rights reserved.
      Any redistribution or reproduction of part or all of the contents in any form is prohibited.
      ************************
    }
    END.
  }
}

