OBJECT Page 50052 Mfr. Rep. List
{
  OBJECT-PROPERTIES
  {
    Date=07/01/20;
    Time=12:00:00 AM;
    Modified=Yes;
    Version List=TOP110;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=ENU=Mfr. Rep. List;
    SourceTable=Table50027;
    PageType=List;
    CardPageID=Mfr. Rep. Card;
    OnOpenPage=BEGIN
                 // <TPZ858>
                 CommHdlgVisible := UserMgt.GetCommHdlgAdmin(USERID);
                 // </TPZ858>
               END;

    ActionList=ACTIONS
    {
      { 1000000020;  ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 1000000021;1 ;ActionGroup;
                      CaptionML=[ENU=&Mfr. Rep.;
                                 ESM=Ve&ndedor;
                                 FRC=&ReprÇsentant;
                                 ENC=&Salesperson];
                      Image=SalesPerson }
      { 1000000032;2 ;Action    ;
                      Name=<Page Mfr. Rep. Division Commissions>;
                      CaptionML=ENU=Division Commissions;
                      RunObject=Page 51711;
                      RunPageLink=Mfr. Rep. Code=FIELD(Code);
                      Visible=CommHdlgVisible;
                      Image=EmployeeAgreement }
      { 1000000019;2 ;Action    ;
                      Name=<Page Mfr. Rep. Comm. Exceptions>;
                      CaptionML=ENU=Commission &Exceptions;
                      RunObject=Page 51701;
                      RunPageLink=Mfr. Rep. Code=FIELD(Code);
                      Visible=CommHdlgVisible;
                      Image=AgreementQuote }
      { 1000000027;2 ;Action    ;
                      CaptionML=ENU=E-&Mail List;
                      RunObject=Page 14000908;
                      RunPageLink=Table ID=CONST(50027),
                                  Code=FIELD(Code);
                      Image=Email }
      { 1000000024;1 ;ActionGroup;
                      CaptionML=[ENU=History;
                                 ESM=Historial;
                                 FRC=Historique;
                                 ENC=History];
                      Image=History }
      { 1000000023;2 ;Action    ;
                      Name=<Page Commission Ledger Entries>;
                      ShortCutKey=Ctrl+F7;
                      CaptionML=[ENU=Commission Ledger E&ntries;
                                 ESM=&Movimientos;
                                 FRC=ê&critures comptables;
                                 ENC=Ledger E&ntries];
                      RunObject=Page 51709;
                      RunPageLink=Account No.=CONST(MFR. REP.),
                                  Account Type=FIELD(Code);
                      Promoted=No;
                      Visible=CommHdlgVisible;
                      Image=VendorLedger;
                      PromotedCategory=Process }
      { 1000000026;2 ;Action    ;
                      CaptionML=ENU=Change Log Entries;
                      Image=History;
                      OnAction=VAR
                                 ChangeLogEntry@1000000000 : Record 405;
                               BEGIN
                                 // <TPZ129>
                                 ChangeLogEntry.RESET;
                                 ChangeLogEntry.SETRANGE("Table No.",DATABASE::"Mfr. Rep.");
                                 ChangeLogEntry.SETRANGE("Primary Key Field 1 Value",Code);
                                 PAGE.RUNMODAL(PAGE::"Change Log Entries",ChangeLogEntry);
                                 // </TPZ129>
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1000000000;0;Container;
                ContainerType=ContentArea }

    { 1000000001;1;Group  ;
                Name=Group;
                GroupType=Repeater }

    { 1000000002;2;Field  ;
                SourceExpr=Code;
                OnAssistEdit=BEGIN
                               IF AssistEdit(xRec) THEN
                                 CurrPage.UPDATE;
                             END;
                              }

    { 1000000003;2;Field  ;
                SourceExpr=Name }

    { 1000000004;2;Field  ;
                SourceExpr="Name 2";
                Visible=FALSE }

    { 1000000005;2;Field  ;
                SourceExpr=Address }

    { 1000000006;2;Field  ;
                SourceExpr="Address 2" }

    { 1000000007;2;Field  ;
                SourceExpr=City }

    { 1000000012;2;Field  ;
                SourceExpr=County }

    { 1000000011;2;Field  ;
                SourceExpr="Post Code" }

    { 1000000010;2;Field  ;
                SourceExpr="Country/Region Code" }

    { 1000000008;2;Field  ;
                SourceExpr=Contact }

    { 1000000009;2;Field  ;
                SourceExpr="Phone No." }

    { 1000000015;2;Field  ;
                SourceExpr="Fax No.";
                Visible=FALSE }

    { 1000000013;2;Field  ;
                SourceExpr="E-Mail";
                Visible=FALSE }

    { 1000000014;2;Field  ;
                SourceExpr="Home Page";
                Visible=FALSE }

    { 1000000025;2;Field  ;
                SourceExpr="Responsibility Center";
                Visible=FALSE }

    { 1000000031;2;Field  ;
                SourceExpr="Location Code" }

    { 1000000029;2;Field  ;
                SourceExpr="Pay-to Mfr. Rep. Code";
                Visible=CommHdlgVisible }

    { 1000000028;2;Field  ;
                SourceExpr="Pay-to Vendor No.";
                Visible=CommHdlgVisible }

    { 1000000030;2;Field  ;
                SourceExpr="Send Source Documents";
                Visible=CommHdlgVisible }

    { 1000000016;0;Container;
                ContainerType=FactBoxArea }

    { 1000000017;1;Part   ;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1000000018;1;Part   ;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      UserMgt@1000000001 : Codeunit 5700;
      CommHdlgVisible@1000000000 : Boolean;
      Codeunit46EventSubscriber@1000000002 : Codeunit 51745;

    PROCEDURE GetSelectionFilter@2() : Text;
    VAR
      MfrRep@1000000000 : Record 50027;
      SelectionFilterManagement@1002 : Codeunit 46;
    BEGIN
      // <TPZ092>
      CurrPage.SETSELECTIONFILTER(MfrRep);
      EXIT(Codeunit46EventSubscriber.GetSelectionFilterForMfrRep(MfrRep));//TPZ2829 Event Conversion
      // </TPZ092>
    END;

    BEGIN
    {
      TOP110 KT ABCSI Salesperson 03302015
        - Created this page as part of this SMT

      2015-04-07 TPZ572 VCHERNYA
        Fields have been reordered
      2015-04-22 TPZ92 TAKHMETO
        Responsibility Center, Pay-to Mfr. Rep. Code,
        Pay-to Vendor Code, Send Comm. Source Documents fields have been created,
        Page Action Action Group Mfr. Rep., Mfr. Rep. Division Commissions and Action Comm. Exceptions,
        PageAction ActionGroup History, Page Commission Ledger Entries, Page E-Mail List Entries have been created
      2015-06-25 TPZ129 TAKHMETO
        Action Change Log Entries has been added
      2015-07-07 TPZ195 VCHERNYA
        Location Code field has been added
      2015-07-30 TPZ858 TAKHMETO
        Managing commission / handling visibility has been added
    }
    END.
  }
}

