OBJECT Page 23044617 DSHIP Freight Prices
{
  OBJECT-PROPERTIES
  {
    Date=03/15/19;
    Time=[ 1:02:11 PM];
    Version List=DSHIP2.2.2;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Dynamic Ship Freight Prices;
               ESM=Precios de flete de Dynamic Ship;
               FRC=Prix du fret Dynamic Ship;
               ENC=Dynamic Ship Freight Prices];
    SaveValues=Yes;
    SourceTable=Table23044610;
    DelayedInsert=Yes;
    PageType=Worksheet;
  }
  CONTROLS
  {
    { 1000000000;;Container;
                ContainerType=ContentArea }

    { 1000000001;1;Group  ;
                CaptionML=[ENU=General;
                           ESM=General;
                           FRC=G‚n‚ral;
                           ENC=General];
                GroupType=Group }

    { 1000000020;2;Group  ;
                GroupType=Group }

    { 1000000002;3;Field  ;
                Name=<Sales Type Filter>;
                CaptionML=[ENU=Sales Type Filter;
                           ESM=Filtro tipo ventas;
                           FRC=Filtre type vente;
                           ENC=Sales Type Filter];
                OptionCaptionML=[ENU=" ,Customer,Customer Price Group,All Customers,Campaign";
                                 ESM=" ,Cliente,Grupo precio cliente,Todos los clientes,Campa¤a";
                                 FRC=" ,Client,Groupe de prix du client,Tous les clients,Promotion";
                                 ENC=" ,Customer,Customer Price Group,All Customers,Campaign"];
                SourceExpr=codSalesTypeFilter;
                OnValidate=BEGIN
                             codSalesCodeFilter := '';
                             setRecFilters;
                           END;
                            }

    { 1000000003;3;Field  ;
                Name=<Sales Code Filter>;
                CaptionML=[ENU=Sales Code Filter;
                           ESM=Filtro c¢d. ventas;
                           FRC=Filtre code vente;
                           ENC=Sales Code Filter];
                SourceExpr=codSalesCodeFilter;
                OnValidate=BEGIN
                             setRecFilters;
                           END;

                OnLookup=VAR
                           lpgCustList@1000000007 : Page 22;
                           lpgCustPriceGrList@1000000006 : Page 7;
                           lpgCampaignList@1000000005 : Page 5087;
                         BEGIN

                           IF codSalesTypeFilter = codSalesTypeFilter::"All Customers" THEN
                             EXIT;

                           CASE codSalesTypeFilter OF
                             codSalesTypeFilter::Customer:
                               BEGIN
                                 lpgCustList.LOOKUPMODE := TRUE;
                                 IF lpgCustList.RUNMODAL = ACTION::LookupOK THEN
                                   Text := lpgCustList.GetSelectionFilter
                                 ELSE
                                   EXIT(FALSE);
                               END;
                             codSalesTypeFilter::"Customer Price Group":
                               BEGIN
                                 lpgCustPriceGrList.LOOKUPMODE := TRUE;
                                 IF lpgCustPriceGrList.RUNMODAL = ACTION::LookupOK THEN
                                   Text := lpgCustPriceGrList.GetSelectionFilter
                                 ELSE
                                   EXIT(FALSE);
                               END;
                             codSalesTypeFilter::Campaign:
                               BEGIN
                                 lpgCampaignList.LOOKUPMODE := TRUE;
                                 IF lpgCampaignList.RUNMODAL = ACTION::LookupOK THEN
                                   Text := lpgCampaignList.GetSelectionFilter
                                 ELSE
                                   EXIT(FALSE);
                               END;
                           END;

                           EXIT(TRUE);
                         END;
                          }

    { 1000000006;2;Field  ;
                Name=<Maximum Rate Filter>;
                CaptionML=[ENU=Maximum Rate Filter;
                           ESM=Filtro de tasa m xima;
                           FRC=Filtre de taux maximal;
                           ENC=Maximum Rate Filter];
                SourceExpr=dMaximumRateFilter;
                OnValidate=BEGIN
                             setRecFilters;
                           END;
                            }

    { 1000000019;2;Group  ;
                GroupType=Group }

    { 1000000004;3;Field  ;
                Name=<Carrier Filter>;
                CaptionML=[ENU=Carrier Filter;
                           ESM=Filtro portador;
                           FRC=Filtre de support;
                           ENC=Carrier Filter];
                SourceExpr=codCarrierFilter;
                OnValidate=BEGIN
                             codShipmentOptionFilter := '';
                             setRecFilters;
                           END;

                OnLookup=VAR
                           lpgShippingAgents@1000000000 : Page 428;
                           lrecShippingAgent@1000000001 : Record 291;
                         BEGIN

                           lpgShippingAgents.LOOKUPMODE := TRUE;
                           IF lpgShippingAgents.RUNMODAL = ACTION::LookupOK THEN BEGIN
                             lpgShippingAgents.GETRECORD(lrecShippingAgent);
                             Text := lrecShippingAgent.Code;
                           END ELSE BEGIN
                             EXIT(FALSE);
                           END;

                           EXIT(TRUE);
                         END;
                          }

    { 1000000005;3;Field  ;
                Name=<Shipment Option Filter>;
                CaptionML=[ENU=Carrier Service Filter;
                           ESM=Filtro de servicio de operador;
                           FRC=Filtre de service de transporteur;
                           ENC=Carrier Service Filter];
                SourceExpr=codShipmentOptionFilter;
                OnValidate=BEGIN
                             setRecFilters;
                           END;

                OnLookup=VAR
                           lpgCarrierServices@1000000000 : Page 23044618;
                           lrecCarrierServices@1000000001 : Record 23044611;
                           lrecSelectedService@1000000002 : Record 23044611;
                         BEGIN

                           IF (codCarrierFilter <> '') THEN BEGIN
                             lrecCarrierServices.SETRANGE("Shipping Agent Code", codCarrierFilter);
                           END;

                           lpgCarrierServices.SETTABLEVIEW(lrecCarrierServices);
                           lpgCarrierServices.EDITABLE(FALSE);
                           lpgCarrierServices.LOOKUPMODE := TRUE;
                           IF lpgCarrierServices.RUNMODAL = ACTION::LookupOK THEN BEGIN
                             lpgCarrierServices.GETRECORD(lrecSelectedService);
                             Text := lrecSelectedService."Service Name";
                           END ELSE BEGIN
                             EXIT(FALSE);
                           END;
                           EXIT(TRUE);
                         END;
                          }

    { 1000000007;1;Group  ;
                GroupType=Repeater }

    { 1000000009;2;Field  ;
                SourceExpr="Sales Type" }

    { 1000000010;2;Field  ;
                SourceExpr="Sales Code" }

    { 1000000011;2;Field  ;
                SourceExpr="Shipping Agent Code" }

    { 1000000022;2;Field  ;
                SourceExpr="Shipping Agent Service Code" }

    { 1000000012;2;Field  ;
                CaptionML=[ENU=Service Name;
                           ESM=Nombre del Servicio;
                           FRC=Nom du service;
                           ENC=Service Name];
                SourceExpr="Service Name" }

    { 1000000024;2;Field  ;
                SourceExpr="Minimum Order Total" }

    { 1000000013;2;Field  ;
                SourceExpr="Maximum Rate" }

    { 1000000014;2;Field  ;
                SourceExpr="Markup %" }

    { 1000000025;2;Field  ;
                SourceExpr="Markup Amount" }

    { 1000000015;2;Field  ;
                SourceExpr="Fixed Price" }

    { 1000000023;2;Field  ;
                SourceExpr="Line Discount Percentage" }

    { 1000000008;2;Field  ;
                ToolTipML=ENU=Combined Markup applies as Markup Percentage then Markup Amount;
                SourceExpr="Rate Handling" }

    { 1000000021;2;Field  ;
                SourceExpr="Rounding Precision" }

    { 1000000016;;Container;
                ContainerType=FactBoxArea }

    { 1000000017;1;Part   ;
                Name=<RecordLinks>;
                CaptionML=[ENU=Dynamic Ship Freight Prices Links;
                           ESM=Precios din micos de fletes de embarcaciones;
                           FRC=Dynamique navire fret les prix liens;
                           ENC=Dynamic Ship Freight Prices Links];
                PartType=System;
                SystemPartID=RecordLinks }

    { 1000000018;1;Part   ;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      codSalesTypeFilter@1000000000 : ' ,Customer,Customer Price Group,All Customers,Campaign';
      codSalesCodeFilter@1000000001 : Code[10];
      codCarrierFilter@1000000002 : Code[20];
      codShipmentOptionFilter@1000000003 : Text[100];
      dMaximumRateFilter@1000000004 : Decimal;

    LOCAL PROCEDURE setRecFilters@1000000000();
    BEGIN
      //<FUNC>
      //  Description: Set filters based on the selections
      //
      //  Called From: This page
      //  Side Effect: None
      //</FUNC>

      IF (codSalesTypeFilter <> codSalesTypeFilter::" ") THEN
        SETRANGE("Sales Type", codSalesTypeFilter)
      ELSE
        SETRANGE("Sales Type");

      IF (codSalesCodeFilter <> '') THEN
        SETRANGE("Sales Code", codSalesCodeFilter)
      ELSE
        SETRANGE("Sales Code");

      IF (codCarrierFilter <> '') THEN
        SETRANGE("Shipping Agent Code", codCarrierFilter)
      ELSE
        SETRANGE("Shipping Agent Code");

      IF (codShipmentOptionFilter <> '') THEN
        SETRANGE("Service Name", codShipmentOptionFilter)
      ELSE
        SETRANGE("Service Name");

      SETFILTER("Maximum Rate", '>=%1', dMaximumRateFilter);

      CurrPage.UPDATE(FALSE);
    END;

    BEGIN
    END.
  }
}

