OBJECT Page 11123333 SC - Customers Top Activity
{
  OBJECT-PROPERTIES
  {
    Date=04/18/17;
    Time=[ 1:00:00 PM];
    Version List=SCW19.2.0;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=ENU="Customers - Top Active ";
    SourceTable=Table11123330;
    SourceTableView=SORTING(Decimal Value)
                    ORDER(Descending);
    PageType=ListPart;
    SourceTableTemporary=Yes;
    OnOpenPage=BEGIN
                 UpdateData;
               END;

    OnAfterGetRecord=BEGIN
                       IF Customer.GET(Key) THEN
                         CustomerName := Customer.Name;
                     END;

    ActionList=ACTIONS
    {
      { 11123306;0   ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 11123305;1   ;Action    ;
                      ShortCutKey=Return;
                      CaptionML=ENU=Open;
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 21;
                      RunPageView=SORTING(No.);
                      RunPageLink=No.=FIELD(Key);
                      Image=ViewDetails;
                      RunPageMode=View }
      { 11123304;1   ;Separator  }
      { 11123303;1   ;Action    ;
                      Name=Refresh;
                      CaptionML=ENU=Refresh;
                      ApplicationArea=#Basic,#Suite;
                      Image=Refresh;
                      OnAction=BEGIN
                                 UpdateData;
                               END;
                                }
      { 11123302;1   ;Separator  }
    }
  }
  CONTROLS
  {
    { 11123311;0;Container;
                ContainerType=ContentArea }

    { 11123310;1;Group    ;
                GroupType=Repeater }

    { 11123309;2;Field    ;
                Name=Custoner No.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=Key }

    { 11123308;2;Field    ;
                Name=Customer Name;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=CustomerName }

    { 11123307;2;Field    ;
                Name=No. of Orders;
                CaptionML=ENU=No. of Orders;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Decimal Value" }

  }
  CODE
  {
    VAR
      Customer@1000 : Record 18;
      CustomerName@1001 : Text;

    LOCAL PROCEDURE UpdateData@2();
    VAR
      RoleCenterMgt@1000 : Codeunit 11123332;
    BEGIN
      Rec.DELETEALL;
      RoleCenterMgt.GetCustomerOrdersCount(Rec);
      CurrPage.UPDATE(FALSE);
    END;

    BEGIN
    END.
  }
}

