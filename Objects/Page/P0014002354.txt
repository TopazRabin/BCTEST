OBJECT Page 14002354 E.D.I. Segments
{
  OBJECT-PROPERTIES
  {
    Date=02/25/19;
    Time=12:00:00 PM;
    Version List=SE0.61;
  }
  PROPERTIES
  {
    CaptionML=ENU=E.D.I. Segments;
    SourceTable=Table14002354;
    DelayedInsert=Yes;
    PageType=List;
    AutoSplitKey=No;
    RefreshOnActivate=Yes;
    OnOpenPage=BEGIN
                 DocumentCaption := CurrPage.CAPTION;
               END;

    OnAfterGetRecord=BEGIN
                       IF ISSERVICETIER THEN BEGIN
                         CurrPage.CAPTION := '';
                         CurrPage.CAPTION :=
                           DocumentCaption + ' - ' + "Trade Partner No." + ' ' + "EDI Document No." + ' ' + Version + ' ' +
                           FORMAT(Type);
                       END ELSE BEGIN
                         CurrPage.CAPTION := '';
                         CurrPage.CAPTION :=
                           "Trade Partner No." + ' ' + "EDI Document No." + ' ' + Version + ' ' + FORMAT(Type) + ' - ' +
                           DocumentCaption;
                       END;
                     END;

    OnInsertRecord=BEGIN
                     InsertedByPage(TRUE);
                   END;

    OnQueryClosePage=BEGIN
                       EDISegment.RESET;
                       EDISegment.SETRANGE("Trade Partner No.","Trade Partner No.");
                       EDISegment.SETRANGE("Navision Document","Navision Document");
                       EDISegment.SETRANGE("EDI Document No.","EDI Document No.");
                       EDISegment.SETRANGE(Version,Version);
                       EDISegment.SETRANGE(Type,Type);
                       IF EDISegment.FINDSET THEN BEGIN
                         EDISegment.CALCFIELDS("Element Mapping Error");
                         EDISegment.CALCFIELDS("Conditional Mapping Error");
                         IF EDISegment."Element Mapping Error" OR EDISegment."Conditional Mapping Error" THEN
                           IF CONFIRM(
                             Text001 +
                             Text002)
                         THEN
                           EXIT(TRUE)
                         ELSE
                           EXIT(FALSE);
                       END;
                     END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 20      ;1   ;ActionGroup;
                      CaptionML=ENU=&Segment }
      { 21      ;2   ;Action    ;
                      ShortCutKey=Ctrl+F7;
                      CaptionML=ENU=&Elements;
                      ToolTipML=ENU=Displays the Element page associated to the Segment.;
                      RunObject=Page 14002355;
                      RunPageLink=Trade Partner No.=FIELD(Trade Partner No.),
                                  Navision Document=FIELD(Navision Document),
                                  EDI Document No.=FIELD(EDI Document No.),
                                  Version=FIELD(Version),
                                  Type=FIELD(Type),
                                  Segment=FIELD(Segment);
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=GetLines;
                      PromotedCategory=Process }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 18      ;1   ;ActionGroup;
                      CaptionML=ENU=F&unctions }
      { 19      ;2   ;Action    ;
                      CaptionML=ENU=&Copy Segment;
                      ToolTipML=ENU=Allows a Segment to be copied from one EDI Document to another.;
                      Promoted=Yes;
                      Image=Copy;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CopySegment;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 14  ;2   ;Field     ;
                ToolTipML=ENU=For inbound files, lines will be processed in the order in which they are received.  For outbound files, used to identify the order each Segment line is to be processed.;
                SourceExpr="Processing Sequence" }

    { 6   ;2   ;Field     ;
                ToolTipML=ENU=Options are 'Segment' & 'Command.' Commands are used to define specific data groups for processing like types of data lines. Valid Commands which define the inbound order line loop are LINE BEGIN & LINE END. ASN hierarchial levels are those with HL-.;
                SourceExpr="Segment Type" }

    { 2   ;2   ;Field     ;
                ToolTipML=ENU=For inbound files, defined as referenced in the Interface file (only 1 instance per Segment). For outbound files, must be unique as as this Segment ID will not be used in the export file allowing for multiple Segment ofsame type (ex. N1-ST, N1-BT).;
                SourceExpr=Segment }

    { 8   ;2   ;Field     ;
                ToolTipML=ENU=Indicates a mapping error at the element level. An error message will be displayed if importing or exporting documents with element mapping errors.;
                SourceExpr="Element Mapping Error" }

    { 16  ;2   ;Field     ;
                ToolTipML=ENU=Indicates a mapping error at the conditional level. An error message will be displayed if importing documents with conditional mapping errors.;
                SourceExpr="Conditional Mapping Error" }

    { 4   ;2   ;Field     ;
                ToolTipML=ENU=Free-form Segment Name.;
                SourceExpr="Segment Name" }

    { 1240030000;2;Field  ;
                ToolTipML=ENU=For for outbound mapping, enable when a Segment may be repeated.  This field is used with the "Maximum" field.;
                SourceExpr="Repeat Segment";
                Visible=TRUE }

    { 1240030002;2;Field  ;
                ToolTipML=ENU=Used with the "Repeat Segment" field.  Set the maximum number of times the Segment may repeat based on the Trade Partner's mapping guide.  If not set, the Segment will repeat until all records are reported.;
                SourceExpr=Maximum;
                Visible=TRUE }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 1907175207;1;Part   ;
                SubPageLink=Trade Partner No.=FIELD(Trade Partner No.),
                            Navision Document=FIELD(Navision Document),
                            EDI Document No.=FIELD(EDI Document No.),
                            Type=FIELD(Type),
                            Version=FIELD(Version),
                            Segment=FIELD(Segment);
                PagePartID=Page14050313;
                Visible=TRUE;
                PartType=Page }

  }
  CODE
  {
    VAR
      EDISegment@1240020017 : Record 14002354;
      DocumentCaption@1240020000 : Text[30];
      Text001@1240020016 : TextConst 'ENU=Element and/or Conditional mapping errors exist for this map.';
      Text002@1240020018 : TextConst 'ENU=\Do you want to close the document?';

    BEGIN
    END.
  }
}

