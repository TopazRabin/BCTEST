OBJECT Page 14123901 ES Object Explorer
{
  OBJECT-PROPERTIES
  {
    Date=04/30/18;
    Time=12:00:00 PM;
    Version List=ES1.41.51;
  }
  PROPERTIES
  {
    CaptionML=ENU=Object Explorer;
    SaveValues=Yes;
    SourceTable=Table14123901;
    PageType=List;
    SourceTableTemporary=Yes;
    OnOpenPage=VAR
                 Object@1240520008 : Record 2000000001;
               BEGIN
                 Window.OPEN(Text001);

                 Object.RESET;
                 Object.SETRANGE(Type,Object.Type::Table,Object.Type::Query);
                 IF Object.FIND('-') THEN BEGIN
                   REPEAT
                     Window.UPDATE(1,STRSUBSTNO('%1 %2 %3',Object.Type,Object.ID,Object.Name));
                     Object.CALCFIELDS(Caption);
                     TRANSFERFIELDS(Object);
                     INSERT;
                   UNTIL Object.NEXT = 0;

                   FIND('-');
                 END;

                 Window.CLOSE;
               END;

    OnAfterGetRecord=BEGIN
                       OnAfterGetCurrRecord;
                     END;

    OnNewRecord=BEGIN
                  OnAfterGetCurrRecord;
                END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 1240520062;1 ;ActionGroup;
                      CaptionML=ENU=O&bject }
      { 1240520047;2 ;Action    ;
                      ShortCutKey=F7;
                      CaptionML=ENU=Object Where-Used;
                      Promoted=Yes;
                      Image=Where-Used;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 ObjectWhereUsed;
                               END;
                                }
      { 1240520048;2 ;ActionGroup;
                      CaptionML=ENU=Logins and Permissions }
      { 1240520080;3 ;Action    ;
                      CaptionML=ENU=Relations (Logins and Permissions);
                      RunObject=Page 14123601;
                      RunPageLink=Object Type=FIELD(Object Type),
                                  Object ID=FIELD(Object ID);
                      Promoted=Yes;
                      Image=Track;
                      PromotedCategory=Process }
      { 1240520081;3 ;Action    ;
                      CaptionML=ENU=Where-Used in Relations (Logins and Permissions);
                      RunObject=Page 14123601;
                      RunPageLink=Relation Object Type=FIELD(Object Type),
                                  Relation Object ID=FIELD(Object ID);
                      Promoted=No;
                      Image=Where-Used;
                      PromotedCategory=Process }
      { 1240520082;3 ;Action    ;
                      CaptionML=ENU=Variables (Logins and Permissions);
                      RunObject=Page 14123605;
                      RunPageLink=Object Type=FIELD(Object Type),
                                  Object ID=FIELD(Object ID);
                      Promoted=No;
                      Image=Track;
                      PromotedCategory=Process }
      { 1240520083;3 ;Action    ;
                      CaptionML=ENU=Where-Used in Variables (Logins and Permissions);
                      RunObject=Page 14123605;
                      RunPageLink=Variable Object Type=FIELD(Object Type),
                                  Variable Object ID=FIELD(Object ID);
                      Promoted=No;
                      Image=Where-Used;
                      PromotedCategory=Process }
      { 1240520053;2 ;ActionGroup;
                      CaptionML=ENU=Field Level and Data Security }
      { 1240520180;3 ;Action    ;
                      CaptionML=ENU=Relations (Field Level and Data Security);
                      RunObject=Page 14123810;
                      RunPageLink=Object Type=FIELD(Object Type),
                                  Object ID=FIELD(Object ID);
                      Promoted=Yes;
                      Image=Track;
                      PromotedCategory=Process }
      { 1240520181;3 ;Action    ;
                      CaptionML=ENU=Where-Used in Relations (Field Level and Data Security);
                      RunObject=Page 14123601;
                      RunPageLink=Relation Object Type=FIELD(Object Type),
                                  Relation Object ID=FIELD(Object ID);
                      Promoted=No;
                      Image=Where-Used;
                      PromotedCategory=Process }
      { 1240520182;3 ;Action    ;
                      CaptionML=ENU=Controls;
                      RunObject=Page 14123811;
                      RunPageLink=Object Type=FIELD(Object Type),
                                  Object ID=FIELD(Object ID);
                      Promoted=No;
                      Image=EntriesList;
                      PromotedCategory=Process }
      { 1240520049;2 ;ActionGroup;
                      CaptionML=ENU=Live }
      { 1240520280;3 ;Action    ;
                      CaptionML=ENU=Relations (Live);
                      RunObject=Page 14123603;
                      RunPageLink=Object Type=FIELD(Object Type),
                                  Object ID=FIELD(Object ID);
                      Promoted=Yes;
                      Image=Track;
                      PromotedCategory=Process }
      { 1240520281;3 ;Action    ;
                      CaptionML=ENU=Where-Used in Relations (Live);
                      RunObject=Page 14123603;
                      RunPageLink=Relation Object Type=FIELD(Object Type),
                                  Relation Object ID=FIELD(Object ID);
                      Promoted=No;
                      Image=Where-Used;
                      PromotedCategory=Process }
      { 1240520282;3 ;Action    ;
                      CaptionML=ENU=Variables (Live);
                      RunObject=Page 14123606;
                      RunPageLink=Object Type=FIELD(Object Type),
                                  Object ID=FIELD(Object ID);
                      Promoted=No;
                      Image=Track;
                      PromotedCategory=Process }
      { 1240520283;3 ;Action    ;
                      CaptionML=ENU=Where-Used in Variables (Live);
                      RunObject=Page 14123606;
                      RunPageLink=Variable Object Type=FIELD(Object Type),
                                  Variable Object ID=FIELD(Object ID);
                      Promoted=No;
                      Image=Where-Used;
                      PromotedCategory=Process }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1240520044;1 ;ActionGroup;
                      CaptionML=ENU=F&unctions;
                      Image=Action }
      { 1240520084;2 ;Action    ;
                      ShortCutKey=Ctrl+F9;
                      CaptionML=ENU=Run Object;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Start;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 ExecuteObject;
                               END;
                                }
      { 1240520056;2 ;Action    ;
                      CaptionML=ENU=Set DBM Table No. in All Filtered Objects;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Delegate;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 ExportSelectedObjects(TRUE,FALSE);
                               END;
                                }
      { 1240520057;2 ;Action    ;
                      CaptionML=ENU=Reset DBM Table No.;
                      Promoted=Yes;
                      Image=ReOpen;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 ResetDBMTableNo(TRUE,TRUE);
                               END;
                                }
      { 1240520046;2 ;Action    ;
                      CaptionML=ENU=Filter Only Licensed Objects;
                      Promoted=Yes;
                      Image=FilterLines;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 SETRANGE("Read Permission (License)","Read Permission (License)"::Yes);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1240520042;1;Field  ;
                CaptionML=ENU=Filename;
                SourceExpr=FileName;
                OnAssistEdit=VAR
                               CommonDialog@1240520008 : Codeunit 14123901;
                             BEGIN
                               FileName := CommonDialog.OpenFile(Text002,FileName,1,'',1);
                             END;
                              }

    { 1240520008;1;Group  ;
                Editable=FALSE;
                GroupType=Repeater }

    { 1240520009;2;Field  ;
                SourceExpr="Object Type" }

    { 1240520011;2;Field  ;
                SourceExpr="Object ID" }

    { 1240520013;2;Field  ;
                SourceExpr=Name }

    { 1240520015;2;Field  ;
                SourceExpr=Modified }

    { 1240520025;2;Field  ;
                SourceExpr="Version List" }

    { 1240520021;2;Field  ;
                SourceExpr=Date }

    { 1240520023;2;Field  ;
                SourceExpr=Time }

    { 1240520019;2;Field  ;
                SourceExpr="BLOB Size" }

    { 1240520017;2;Field  ;
                SourceExpr=Compiled }

    { 1240520054;2;Field  ;
                SourceExpr="Skip During Export" }

    { 1240520089;2;Field  ;
                SourceExpr="Export Error" }

    { 1240520027;2;Field  ;
                SourceExpr=Caption;
                Visible=FALSE }

    { 1240520001;2;Field  ;
                CaptionML=ENU=License Permissions;
                SourceExpr=Permissions(TRUE) }

    { 1240520029;2;Field  ;
                SourceExpr="Read Permission (License)" }

    { 1240520031;2;Field  ;
                SourceExpr="Insert Permission (License)" }

    { 1240520033;2;Field  ;
                SourceExpr="Modify Permission (License)" }

    { 1240520035;2;Field  ;
                SourceExpr="Delete Permission (License)" }

    { 1240520037;2;Field  ;
                SourceExpr="Execute Permission (License)" }

    { 1240520003;2;Field  ;
                SourceExpr=Relations }

    { 1240520007;2;Field  ;
                SourceExpr="Where-used as Relations" }

    { 1240520005;2;Field  ;
                SourceExpr=Variables }

    { 1240520051;2;Field  ;
                SourceExpr="Where-used as Variables" }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 1906991407;1;Part   ;
                SubPageLink=Object Type=FIELD(Object Type),
                            Object ID=FIELD(Object ID);
                PagePartID=Page14123834;
                Visible=TRUE;
                PartType=Page }

  }
  CODE
  {
    VAR
      Window@1240520009 : Dialog;
      FileName@1240520010 : Text[250];
      Text001@1001 : TextConst 'ENU=Loading objects\#1################################################';
      Text002@1002 : TextConst 'ENU=Select Object Text-file';
      Text003@1003 : TextConst 'ENU=Filename must be entered.';
      Text004@1004 : TextConst 'ENU=Do you want to overwrite the existing file "%1"?';
      Text005@1005 : TextConst 'ENU=Preparing objects\#1################################################';
      Text006@1006 : TextConst 'ENU=Process %1 objects?';

    PROCEDURE ExportSelectedObjects@1240520008(SetDBMTableNo@1240520001 : Boolean;OnlyLicensedObjects@1240520002 : Boolean);
    VAR
      ESObjectExplorer@1240520009 : Record 14123901;
      ObjectsToExport@1240520008 : Integer;
    BEGIN
      IF NOT SetDBMTableNo THEN BEGIN
        IF FileName = '' THEN
          ERROR(Text003);

        IF EXISTS(FileName) THEN
          IF NOT CONFIRM(Text004,FALSE,FileName) THEN
            EXIT;
      END;

      ESObjectExplorer := Rec;
      IF Rec.FIND('-') THEN BEGIN
        IF GUIALLOWED THEN
          Window.OPEN(Text005);

        ESObjectExplorer.ClearExportObjects;
        REPEAT
          IF GUIALLOWED THEN
            Window.UPDATE(1,STRSUBSTNO('%1 %2 %3',"Object Type","Object ID",Name));

          ObjectsToExport := ObjectsToExport + 1;
          ESObjectExplorer.AddExportObject(Rec);
        UNTIL NEXT = 0;

        IF GUIALLOWED THEN
          Window.CLOSE;

        IF CONFIRM(Text006,TRUE,ObjectsToExport) THEN
          ESObjectExplorer.ExportNeededObjects(
            FileName,FALSE,FALSE,TRUE,FALSE,FALSE,FALSE,TRUE,SetDBMTableNo,OnlyLicensedObjects,0);
      END;

      Rec := ESObjectExplorer;
    END;

    PROCEDURE TestExportSelectedObjects@1240520009();
    VAR
      ESObjectProperty@1240520001 : Record 14123522;
    BEGIN
      ESObjectProperty.TestExport(TRUE);
    END;

    LOCAL PROCEDURE OnAfterGetCurrRecord@19077479();
    BEGIN
      xRec := Rec;
      CALCFIELDS(Relations,Variables,"Where-used as Relations","Where-used as Variables");
    END;

    BEGIN
    END.
  }
}

