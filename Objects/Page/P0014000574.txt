OBJECT Page 14000574 Period End Processing
{
  OBJECT-PROPERTIES
  {
    Date=11/01/20;
    Time=12:00:00 PM;
    Version List=UBP3.03;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=ENU=Period End Processing;
    ApplicationArea=#All;
    SourceTable=Table14;
    SourceTableView=SORTING(Code)
                    ORDER(Ascending)
                    WHERE(Use As In-Transit=CONST(No));
    PageType=List;
    OnInit=BEGIN
             "Adjusted Period AlertVisible" := TRUE;
           END;

    OnOpenPage=BEGIN
                 InvMgtSetup.GET;
                 IF InvMgtSetup."Reforecast Changed Units" = InvMgtSetup."Reforecast Changed Units"::"All Items" THEN
                   "Adjusted Period AlertVisible" := TRUE
                 ELSE
                   "Adjusted Period AlertVisible" := FALSE;
                 SETRANGE("Enable Adv. Forecasting", TRUE);
               END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 1240020004;1 ;Action    ;
                      ShortCutKey=Shift+F7;
                      CaptionML=ENU=Location Card;
                      ApplicationArea=#All;
                      RunObject=Page 5703;
                      RunPageView=SORTING(Code);
                      RunPageLink=Code=FIELD(Code);
                      Image=AddToHome }
      { 1240020008;1 ;Action    ;
                      CaptionML=ENU=Location Usage Redirect;
                      ApplicationArea=#All;
                      RunObject=Page 14000527;
                      RunPageLink=Location Code=FIELD(Code);
                      Image=SelectItemSubstitution }
      { 1240020001;1 ;Action    ;
                      CaptionML=ENU=Procurement &Units;
                      ApplicationArea=#All;
                      RunObject=Page 14000559;
                      RunPageView=SORTING(Location Code,Item No.,Variant Code)
                                  ORDER(Ascending);
                      RunPageLink=Location Code=FIELD(Code);
                      Image=BankAccountRec }
      { 20      ;1   ;Action    ;
                      ShortCutKey=Ctrl+F7;
                      CaptionML=ENU=Location Inventory Periods;
                      ApplicationArea=#All;
                      RunObject=Page 14000554;
                      RunPageLink=Location Code=FIELD(Code);
                      Image=WorkCenterCalendar }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 18      ;1   ;Action    ;
                      ShortCutKey=F7;
                      CaptionML=ENU=Select Location;
                      ApplicationArea=#All;
                      Promoted=No;
                      Image=SelectLineToApply;
                      OnAction=VAR
                                 locLocation@1240020000 : Record 14;
                               BEGIN
                                 CurrPage.SETSELECTIONFILTER(locLocation);
                                 locLocation.SETRANGE("Enable Adv. Forecasting", TRUE);
                                 IF locLocation.FINDSET THEN BEGIN
                                   REPEAT
                                     IF locLocation."Select Period End Processing" = '' THEN
                                       locLocation."Select Period End Processing" := USERID
                                     ELSE
                                       locLocation."Select Period End Processing" := '';
                                     locLocation.MODIFY(FALSE);
                                   UNTIL locLocation.NEXT = 0;
                                 END;
                                 CurrPage.UPDATE(FALSE);
                               END;
                                }
      { 21      ;1   ;Action    ;
                      CaptionML=ENU=Process &Multiple Period End;
                      ApplicationArea=#All;
                      Promoted=No;
                      Image=AutoReserve;
                      OnAction=BEGIN
                                 PeriodEndYesNo.MultiplePeriodEnd;
                               END;
                                }
      { 1240020010;1 ;Action    ;
                      CaptionML=ENU=Batch Re-Open Period End;
                      RunObject=Report 14002666;
                      Image=ReOpen }
      { 24      ;1   ;Action    ;
                      CaptionML=ENU=Procurement Unit Setup &Review;
                      ApplicationArea=#All;
                      Promoted=No;
                      Image=BankAccountRec;
                      OnAction=BEGIN
                                 Location := Rec;
                                 Location.SETRECFILTER;
                                 REPORT.RUNMODAL(REPORT::"Procurement Unit Review",TRUE,FALSE,Location);
                               END;
                                }
      { 1240020000;1 ;Action    ;
                      CaptionML=ENU=Process Usage Redirect;
                      ApplicationArea=#All;
                      Promoted=No;
                      Image=SelectItemSubstitution;
                      OnAction=BEGIN
                                 IF CONFIRM(Text001,FALSE) THEN
                                   GlobalUsageRedirect.RUN;
                               END;
                                }
      { 1240030006;1 ;Action    ;
                      CaptionML=ENU=Reforecast &Changed Items;
                      ApplicationArea=#All;
                      Promoted=No;
                      Image=Replan;
                      OnAction=BEGIN
                                 IF CONFIRM(Text002,FALSE) THEN BEGIN
                                   CLEAR(UpdateProcUnitLocFilters);
                                   UpdateProcUnitLocFilters.ByLocation('','');
                                   Location.RESET;
                                   Location.SETRANGE("Enable Adv. Forecasting",TRUE);
                                   IF Location.FIND('-') THEN
                                     REPEAT
                                       Reforecast.ProcessLocation(Location);
                                     UNTIL Location.NEXT = 0;
                                 END;
                               END;
                                }
      { 1240030001;1 ;Action    ;
                      CaptionML=ENU=Create &Production Plan;
                      ApplicationArea=#All;
                      Promoted=No;
                      Image=CalculateLines;
                      OnAction=VAR
                                 CreateProdPlanYesNo@1240020000 : Codeunit 14002674;
                                 LocationFilterRec@1240020001 : Record 14;
                               BEGIN
                                 COMMIT;
                                 CLEAR(CreateProdPlanYesNo);
                                 CreateProdPlanYesNo.SetOverrideExecutionModeProd;
                                 LocationFilterRec.SETRANGE("Select Period End Processing", USERID);
                                 CreateProdPlanYesNo.SetGlobalLocationFilters(LocationFilterRec);
                                 CLEARLASTERROR;
                                 IF NOT CreateProdPlanYesNo.RUN THEN BEGIN
                                   MESSAGE(GETLASTERRORTEXT);
                                 END;
                               END;
                                }
      { 5       ;1   ;Action    ;
                      CaptionML=ENU=Create Assembly Forecast;
                      ApplicationArea=#All;
                      Image=AssemblyOrder;
                      OnAction=VAR
                                 CreateProdPlanYesNo@1240020000 : Codeunit 14002674;
                                 LocationFilterRec@1240020001 : Record 14;
                               BEGIN
                                 COMMIT;
                                 CLEAR(CreateProdPlanYesNo);
                                 CreateProdPlanYesNo.SetOverrideExecutionModeAssy;
                                 LocationFilterRec.SETRANGE("Select Period End Processing", USERID);
                                 CreateProdPlanYesNo.SetGlobalLocationFilters(LocationFilterRec);
                                 CLEARLASTERROR;
                                 IF NOT CreateProdPlanYesNo.RUN THEN BEGIN
                                   MESSAGE(GETLASTERRORTEXT);
                                 END;
                               END;
                                }
      { 1240020006;1 ;Action    ;
                      CaptionML=ENU=Create Assy./Prod. Forecast;
                      ApplicationArea=#All;
                      Image=Production;
                      OnAction=VAR
                                 CreateProdPlanYesNo@1240020000 : Codeunit 14002674;
                                 LocationFilterRec@1240020001 : Record 14;
                               BEGIN
                                 COMMIT;
                                 CLEAR(CreateProdPlanYesNo);
                                 LocationFilterRec.SETRANGE("Select Period End Processing", USERID);
                                 CreateProdPlanYesNo.SetGlobalLocationFilters(LocationFilterRec);
                                 CLEARLASTERROR;
                                 IF NOT CreateProdPlanYesNo.RUN THEN BEGIN
                                   MESSAGE(GETLASTERRORTEXT);
                                 END;
                               END;
                                }
      { 1240020007;1 ;Action    ;
                      CaptionML=ENU=&Restart Assy./Prod. Forecast;
                      ApplicationArea=#All;
                      Promoted=No;
                      Image=Replan;
                      OnAction=VAR
                                 CreateProdPlan@1240020000 : Codeunit 14002675;
                                 LocationFilterRec@1240020001 : Record 14;
                               BEGIN
                                 COMMIT;
                                 CLEAR(CreateProdPlan);
                                 LocationFilterRec.SETRANGE("Select Period End Processing", USERID);
                                 IF LocationFilterRec.FINDSET THEN BEGIN
                                   IF CONFIRM(Text003,FALSE) THEN BEGIN
                                     REPEAT
                                       CreateProdPlan.ByLocation(LocationFilterRec,TRUE);
                                     UNTIL LocationFilterRec.NEXT = 0;
                                   END;
                                 END;
                                 CurrPage.UPDATE(FALSE);
                               END;
                                }
      { 1240020002;1 ;Separator  }
      { 1240020003;1 ;Action    ;
                      CaptionML=ENU=&Create New Location Inventory Periods;
                      ApplicationArea=#All;
                      Promoted=No;
                      Image=CreateYear;
                      OnAction=BEGIN
                                 InventoryManagement.CreateNewLocInvPeriods(Rec);
                               END;
                                }
      { 3       ;1   ;Action    ;
                      CaptionML=ENU=&Re-Calculate Vendor Lead Time;
                      ApplicationArea=#All;
                      Promoted=No;
                      Image=CalculateWIP;
                      OnAction=VAR
                                 UBP@1000 : Codeunit 14000564;
                               BEGIN
                                 UBP.RecalcVendorLeadTime(Rec);
                               END;
                                }
      { 1240020005;1 ;Action    ;
                      CaptionML=ENU=Calculate Surplus;
                      ApplicationArea=#All;
                      Image=StaleCheck;
                      OnAction=VAR
                                 CalcSurplus@1240020000 : Codeunit 14000577;
                               BEGIN
                                 CLEAR(CalcSurplus);
                                 CalcSurplus.CreateYesNo;
                               END;
                                }
      { 1240020011;1 ;Action    ;
                      CaptionML=ENU=Calculate External Forecast;
                      ApplicationArea=#All;
                      Image=StatisticsGroup;
                      OnAction=VAR
                                 CalcExternalForecast@1240020000 : Codeunit 14000570;
                               BEGIN
                                 CLEAR(CalcExternalForecast);
                                 CalcExternalForecast.MultiplePeriodEnd;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 2   ;2   ;Field     ;
                ApplicationArea=#All;
                SourceExpr=Code }

    { 4   ;2   ;Field     ;
                ApplicationArea=#All;
                SourceExpr=Name }

    { 1240020009;2;Field  ;
                ApplicationArea=#All;
                SourceExpr="Enable Adv. Forecasting";
                Visible=FALSE;
                Editable=FALSE }

    { 13  ;2   ;Field     ;
                CaptionML=ENU=Select Processing;
                ApplicationArea=#All;
                SourceExpr="Select Period End Processing" }

    { 6   ;2   ;Field     ;
                ApplicationArea=#All;
                SourceExpr="Last Day-End Date" }

    { 22  ;2   ;Field     ;
                ApplicationArea=#All;
                SourceExpr="Last Closed Period Date" }

    { 1240030007;2;Field  ;
                ApplicationArea=#All;
                SourceExpr="Reforecast Required Units" }

    { 1240030009;2;Field  ;
                ApplicationArea=#All;
                SourceExpr="Variant Summarize Pending";
                Visible=FALSE }

    { 1240030011;2;Field  ;
                ApplicationArea=#All;
                SourceExpr="Redirect From Pending" }

    { 1240030013;2;Field  ;
                ApplicationArea=#All;
                SourceExpr="Redirect To Pending" }

    { 1240030004;2;Field  ;
                ApplicationArea=#All;
                SourceExpr="Redirect Delete Pending" }

    { 1240030015;2;Field  ;
                ApplicationArea=#All;
                SourceExpr="Reforecast Items" }

    { 1240030002;2;Field  ;
                ApplicationArea=#All;
                SourceExpr="Adjusted Period Alert";
                Visible="Adjusted Period AlertVisible" }

  }
  CODE
  {
    VAR
      InvMgtSetup@1240030000 : Record 14000551;
      Location@14000500 : Record 14;
      PeriodEndYesNo@14000501 : Codeunit 14000556;
      Text001@1240020000 : TextConst 'ENU=This function will process all pending usage redirects for all Locations and will set all Proc. Units involved to be reforecast.  Do you wish to continue?';
      GlobalUsageRedirect@1240020001 : Codeunit 14000573;
      Reforecast@1240020002 : Codeunit 14000571;
      Text002@1240020003 : TextConst 'ENU=This function will update all Proc. Unit Filters and reforecast all Proc. Units flagged to be reforecast.  Do you wish to continue?';
      UpdateProcUnitLocFilters@1240020004 : Codeunit 14000581;
      InventoryManagement@1240020005 : Codeunit 14000553;
      "Adjusted Period AlertVisible"@19056059 : Boolean INDATASET;
      Text003@1240020006 : TextConst 'ENU=Do you wish to restart the Assembly/Production Plan for all selected locations?';

    BEGIN
    END.
  }
}

