OBJECT Page 11123303 SC - Startup Wizard
{
  OBJECT-PROPERTIES
  {
    Date=04/18/17;
    Time=[ 1:00:00 PM];
    Version List=SCW19.2.0;
  }
  PROPERTIES
  {
    CaptionML=ENU=Sana Commerce Startup Wizard;
    InsertAllowed=No;
    DeleteAllowed=No;
    LinksAllowed=No;
    PageType=NavigatePage;
    OnInit=BEGIN
             CancelEnable := TRUE;
             NextEnable := TRUE;
             AllVisibleEnable := TRUE;
             ControlCustomerTemplateEnable := TRUE;
             SelectManuallyEnable := TRUE;
             ProjectedDateCalculationEditab := TRUE;
             LocationCodeSourceEditable := TRUE;
           END;

    OnOpenPage=VAR
                 Webshop@11123303 : Record 11123313;
                 UpgradeMgt@11123302 : Codeunit 11123380;
               BEGIN
                 SetFormPosition;
                 SetFormDafaults;

                 ShowStep(GlobalStepNo);
                 UpgradeMgt.RUN;
               END;

    OnClosePage=BEGIN
                  CheckAndClearCatalogFilterLine;
                END;

    ActionList=ACTIONS
    {
      { 11123365;0   ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 11123364;1   ;Action    ;
                      Name=Back;
                      CaptionML=ENU=< &Back;
                      ApplicationArea=#Basic,#Suite;
                      Enabled=BackEnable;
                      InFooterBar=Yes;
                      Image=PreviousRecord;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 GlobalStepNo := GlobalStepNo - 1;
                                 ShowStep(GlobalStepNo);
                                 CurrPage.UPDATE(TRUE);
                               END;
                                }
      { 11123363;1   ;Action    ;
                      Name=Next;
                      CaptionML=ENU=&Next >;
                      ApplicationArea=#Basic,#Suite;
                      Enabled=NextEnable;
                      InFooterBar=Yes;
                      Image=NextRecord;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 IF Step1Visible THEN
                                   CheckWebshopId(GlobalWebshopId);
                                 IF Step7Visible THEN
                                   CatalogFilterVisible := TRUE;
                                 IF Step8Visible THEN
                                   CheckCustomerTemplateCode;
                                 IF Step9Visible THEN
                                   SetInstructions;

                                 GlobalStepNo := GlobalStepNo + 1;
                                 ShowStep(GlobalStepNo);
                               END;
                                }
      { 11123362;1   ;Action    ;
                      Name=Finish;
                      CaptionML=ENU=&Finish;
                      ApplicationArea=#Basic,#Suite;
                      Enabled=FinishEnable;
                      InFooterBar=Yes;
                      Image=Approve;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CurrPage.CLOSE;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 11123367;0;Container;
                ContainerType=ContentArea }

    { 11123360;1;Group    ;
                Name=Step0;
                Visible=Step0Visible }

    { 11123361;2;Field    ;
                ApplicationArea=#Basic,#Suite;
                CaptionClass=Text19038597;
                Style=Strong;
                StyleExpr=TRUE }

    { 11123358;2;Field    ;
                ApplicationArea=#Basic,#Suite;
                CaptionClass=Text19046416;
                MultiLine=Yes }

    { 11123359;1;Group    ;
                Name=Step1;
                Visible=Step1Visible }

    { 11123356;2;Field    ;
                ApplicationArea=#Basic,#Suite;
                CaptionClass=Text19004890;
                Style=Strong;
                StyleExpr=TRUE }

    { 11123357;2;Field    ;
                ApplicationArea=#Basic,#Suite;
                CaptionClass=Text19074208;
                MultiLine=Yes }

    { 11123354;2;Field    ;
                CaptionML=ENU=Webshop ID;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=GlobalWebshopId }

    { 11123355;2;Field    ;
                CaptionML=ENU=Template Customer No.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=GlobalTemplateCustomerNo;
                OnValidate=BEGIN
                             CheckCustomer(GlobalTemplateCustomerNo);
                           END;

                OnLookup=BEGIN
                           RunFormCustomerTemplateNo;
                         END;
                          }

    { 11123352;1;Group    ;
                Name=Step2;
                Visible=Step2Visible }

    { 11123353;2;Field    ;
                ApplicationArea=#Basic,#Suite;
                CaptionClass=Text19011831;
                Style=Strong;
                StyleExpr=TRUE }

    { 11123350;2;Field    ;
                ApplicationArea=#Basic,#Suite;
                CaptionClass=Text19004549;
                MultiLine=Yes }

    { 11123351;2;Field    ;
                CaptionML=ENU=Payment Method Code;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=GlobalPaymentMethod;
                TableRelation="Payment Method" }

    { 11123348;2;Field    ;
                CaptionML=ENU=Payment Cost Type;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=GlobalPaymentCostType;
                OnValidate=BEGIN
                             GlobalPaymentCostNo := '';
                           END;
                            }

    { 11123349;2;Field    ;
                CaptionML=ENU=Payment Cost No.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=GlobalPaymentCostNo;
                OnValidate=BEGIN
                             CheckValue(GlobalPaymentCostType,GlobalPaymentCostNo);
                           END;

                OnLookup=BEGIN
                           RunFormByTable(GlobalPaymentCostType,GlobalPaymentCostNo);
                         END;
                          }

    { 11123346;1;Group    ;
                Name=Step3;
                Visible=Step3Visible }

    { 11123347;2;Field    ;
                ApplicationArea=#Basic,#Suite;
                CaptionClass=Text19026012;
                Style=Strong;
                StyleExpr=TRUE }

    { 11123344;2;Field    ;
                ApplicationArea=#Basic,#Suite;
                CaptionClass=Text19011054;
                MultiLine=Yes }

    { 11123345;2;Field    ;
                CaptionML=ENU=Shipping Cost Type;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=GlobalShippingCostType;
                OnValidate=BEGIN
                             GlobalShippingCostNo := '';
                           END;
                            }

    { 11123342;2;Field    ;
                CaptionML=ENU=Shipping Cost No.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=GlobalShippingCostNo;
                OnValidate=BEGIN
                             CheckValue(GlobalShippingCostType,GlobalShippingCostNo);
                           END;

                OnLookup=BEGIN
                           RunFormByTable(GlobalShippingCostType,GlobalShippingCostNo);
                         END;
                          }

    { 11123343;1;Group    ;
                Name=Step4;
                Visible=Step4Visible }

    { 11123340;2;Field    ;
                ApplicationArea=#Basic,#Suite;
                CaptionClass=Text19064482;
                Style=Strong;
                StyleExpr=TRUE }

    { 11123341;2;Field    ;
                ApplicationArea=#Basic,#Suite;
                CaptionClass=Text19052583;
                MultiLine=Yes }

    { 11123338;2;Field    ;
                CaptionML=ENU=Quote Nos.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=GlobalQuoteNos;
                TableRelation="No. Series" }

    { 11123339;2;Field    ;
                CaptionML=ENU=Order Nos.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=GlobalOrderNos;
                TableRelation="No. Series" }

    { 11123336;2;Field    ;
                CaptionML=ENU=Guest Nos.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=GlobalGuestNos;
                TableRelation="No. Series" }

    { 11123337;1;Group    ;
                Name=Step5;
                Visible=Step5Visible }

    { 11123334;2;Field    ;
                CaptionML=ENU=Ordering;
                ApplicationArea=#Basic,#Suite;
                Style=Strong;
                StyleExpr=TRUE }

    { 11123335;2;Field    ;
                ApplicationArea=#Basic,#Suite;
                CaptionClass=Text19011055;
                StyleExpr=TRUE }

    { 11123332;2;Field    ;
                CaptionML=ENU=Order Processing;
                ApplicationArea=#Basic,#Suite;
                Style=Strong;
                StyleExpr=TRUE }

    { 11123333;2;Field    ;
                CaptionML=ENU=Order Type;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=GlobalOrderType;
                OnValidate=BEGIN
                             ValidateOrderType;
                           END;
                            }

    { 11123330;2;Field    ;
                CaptionML=ENU=Synchronized Basket Type;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=GlobalSynchronizedBasketType;
                OnValidate=BEGIN
                             ValidateOrderType;
                           END;
                            }

    { 11123331;2;Field    ;
                CaptionML=ENU=Quote Promotable by Default;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=GlobalQuotePromotable }

    { 11123328;1;Group    ;
                Name=Step6;
                Visible=Step6Visible;
                GroupType=Group }

    { 11123329;2;Field    ;
                ApplicationArea=#Basic,#Suite;
                CaptionClass=Text11123307;
                Style=Strong;
                StyleExpr=TRUE }

    { 11123326;2;Field    ;
                ApplicationArea=#Basic,#Suite;
                CaptionClass=Text11123306 }

    { 11123327;2;Field    ;
                ApplicationArea=#Basic,#Suite;
                CaptionClass=Text11123308;
                Style=Strong;
                StyleExpr=TRUE }

    { 11123324;2;Field    ;
                CaptionML=ENU=Enable Document Downloads;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=GlobalEnableDocumentDownloads }

    { 11123325;2;Field    ;
                ApplicationArea=#Basic,#Suite;
                CaptionClass=Text11123309;
                Style=Strong;
                StyleExpr=TRUE }

    { 11123323;2;Field    ;
                CaptionML=ENU=Enable Product Attachment Downloads;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=GlobalEnableProdAttachmen }

    { 11123322;2;Field    ;
                CaptionML=ENU=Enable Document Attachment Downloads;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=GlobalEnableDocumentAttachment }

    { 11123320;1;Group    ;
                Name=Step7;
                Visible=Step7Visible }

    { 11123321;2;Field    ;
                ApplicationArea=#Basic,#Suite;
                CaptionClass=Text19015087;
                Style=Strong;
                StyleExpr=TRUE }

    { 11123318;2;Field    ;
                ApplicationArea=#Basic,#Suite;
                CaptionClass=Text19012378;
                MultiLine=Yes }

    { 11123319;2;Field    ;
                CaptionML=ENU=Location Code Source;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=GlobalLocationCodeSource;
                OnValidate=BEGIN
                             GlobalLocationCode := '';
                             LocationCodeSourceEditable := GlobalLocationCodeSource = GlobalLocationCodeSource::Webshop;
                           END;
                            }

    { 11123316;2;Field    ;
                Name=LocationCodeSource;
                CaptionML=ENU=Location Code;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=GlobalLocationCode;
                TableRelation=Location;
                Enabled=LocationCodeSourceEditable;
                Editable=LocationCodeSourceEditable;
                OnLookup=BEGIN
                           RunFormLocation;
                         END;
                          }

    { 11123317;2;Field    ;
                Name=InventoryCalculation;
                CaptionML=ENU=Inventory Calculation;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=GlobalInventoryCalculation;
                OnValidate=BEGIN
                             EVALUATE(GlobalProjectedDateCalculation,'');
                             ProjectedDateCalculationEditab := GlobalInventoryCalculation = GlobalInventoryCalculation::"Projected Available Balance"
                             ;
                           END;
                            }

    { 11123314;2;Field    ;
                Name=ProjectedDateCalculation;
                CaptionML=ENU=Projected Date Calculation;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=GlobalProjectedDateCalculation;
                Editable=ProjectedDateCalculationEditab }

    { 11123315;1;Group    ;
                Name=Step8;
                CaptionML=ENU=<Step8>;
                Visible=Step8Visible;
                GroupType=Group }

    { 11123312;2;Field    ;
                ApplicationArea=#Basic,#Suite;
                CaptionClass=Text19026810;
                Style=Strong;
                StyleExpr=TRUE }

    { 11123313;2;Field    ;
                ApplicationArea=#Basic,#Suite;
                CaptionClass=Text19010313;
                MultiLine=Yes }

    { 11123310;2;Field    ;
                Name=SelectManually;
                CaptionML=ENU=Select Manually;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=GlobalSelectManuallyVisibility;
                Enabled=SelectManuallyEnable;
                OnValidate=BEGIN
                             GlobalSelectManuallyVisiOnPush;
                           END;
                            }

    { 11123311;2;Field    ;
                Name=AllVisible;
                CaptionML=ENU=Visible All;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=GlobalAllVisibleInWebshop;
                Enabled=AllVisibleEnable;
                OnValidate=BEGIN
                             GlobalAllVisibleInWebshoOnPush;
                           END;
                            }

    { 11123308;2;Field    ;
                Name=ControlCustomerTemplate;
                CaptionML=ENU=Customer Template Code;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=GlobalCustomerTemplateCode;
                TableRelation="Customer Template";
                Enabled=ControlCustomerTemplateEnable;
                OnLookup=BEGIN
                           IF GlobalAllVisibleInWebshop THEN
                             RunFormCustomerTemplateList;
                         END;
                          }

    { 11123309;1;Group    ;
                Name=Step9;
                CaptionML=ENU=<Step9>;
                Visible=Step9Visible;
                GroupType=Group }

    { 11123306;2;Field    ;
                ApplicationArea=#Basic,#Suite;
                CaptionClass=Text19007493;
                Style=Strong;
                StyleExpr=TRUE }

    { 11123307;2;Field    ;
                ApplicationArea=#Basic,#Suite;
                CaptionClass=Text19066381;
                MultiLine=Yes }

    { 11123304;2;Field    ;
                CaptionML=ENU=Update Items Visibility;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=GlobalUpdateVisibility }

    { 11123305;1;Group    ;
                Name=Step10;
                CaptionML=ENU=<Step10>;
                Visible=Step10Visible;
                GroupType=Group }

    { 11123302;2;Field    ;
                ApplicationArea=#Basic,#Suite;
                CaptionClass=Text19045373;
                Style=Strong;
                StyleExpr=TRUE }

    { 11123303;2;Field    ;
                ApplicationArea=#Basic,#Suite;
                CaptionClass=Text19035030;
                MultiLine=Yes }

  }
  CODE
  {
    VAR
      GlobalCountryRegion@11123318 : Record 9;
      GlobalWebshopId@11123304 : Code[50];
      GlobalTemplateCustomerNo@11123305 : Code[20];
      GlobalPaymentMethod@11123306 : Code[10];
      GlobalPaymentCostNo@11123308 : Code[20];
      GlobalShippingCostNo@11123311 : Code[20];
      GlobalCustomerTemplateCode@11123313 : Code[10];
      GlobalQuoteNos@11123302 : Code[10];
      GlobalOrderNos@11123322 : Code[10];
      GlobalGuestNos@11123348 : Code[10];
      GlobalLocationCode@11123325 : Code[10];
      GlobalProjectedDateCalculation@11123327 : DateFormula;
      GlobalPaymentCostType@11123309 : ' ,G/L Account,Item,Resource,Fixed Asset,Charge (Item)';
      GlobalShippingCostType@11123310 : ' ,G/L Account,Item,Resource,Fixed Asset,Charge (Item)';
      GlobalLocationCodeSource@11123324 : 'Customer,Webshop';
      GlobalInventoryCalculation@11123326 : 'Inventory - Qty. on Sales Orders,Projected Available Balance';
      GlobalOrderType@11123331 : 'Order,Quote';
      GlobalSynchronizedBasketType@11123330 : 'Order,Quote';
      GlobalCatalogFilter@11123303 : Text[1024];
      GlobalStepNo@11123307 : Integer;
      text11123301@11123314 : TextConst 'ENU=Webshop ID cannot be empty. Please enter a value.';
      text11123302@11123315 : TextConst 'ENU=Webshop ID %1 already exist.';
      GlobalAllVisibleInWebshop@11123312 : Boolean;
      text11123303@11123316 : TextConst 'ENU=Customer Template Code cannot be empty.';
      GlobalSelectManuallyVisibility@11123317 : Boolean;
      GlobalGenerateValidationRules@11123319 : Boolean;
      GlobalUpdateVisibility@11123320 : Boolean;
      GlobalSanaRolePermissions@11123321 : Boolean;
      text11123304@11123323 : TextConst 'ENU=Value %1 does not exist.';
      GlobalQuotePromotable@11123328 : Boolean;
      text11123305@11123334 : TextConst 'ENU=The minimum permitted for field %1 value is 0.';
      GlobalEnableDocumentDownloads@11123340 : Boolean;
      GlobalEnableProdAttachmen@11123342 : Boolean;
      GlobalEnableDocumentAttachment@11123341 : Boolean;
      LocationCodeSourceEditable@19035620 : Boolean INDATASET;
      ProjectedDateCalculationEditab@19027450 : Boolean INDATASET;
      SelectManuallyEnable@19014166 : Boolean INDATASET;
      ControlCustomerTemplateEnable@19070302 : Boolean INDATASET;
      AllVisibleEnable@19001615 : Boolean INDATASET;
      Step1Visible@19067551 : Boolean INDATASET;
      Step5Visible@19067683 : Boolean INDATASET;
      Step8Visible@19067336 : Boolean INDATASET;
      Step11Visible@19004802 : Boolean INDATASET;
      Step0Visible@19067584 : Boolean INDATASET;
      Step2Visible@19067406 : Boolean INDATASET;
      Step3Visible@19067629 : Boolean INDATASET;
      Step4Visible@19067716 : Boolean INDATASET;
      Step6Visible@19067522 : Boolean INDATASET;
      Step7Visible@19067745 : Boolean INDATASET;
      Step9Visible@19067303 : Boolean INDATASET;
      Step10Visible@19013506 : Boolean INDATASET;
      FinishEnable@19079943 : Boolean INDATASET;
      BackEnable@19029006 : Boolean INDATASET;
      NextEnable@19007695 : Boolean INDATASET;
      CancelEnable@19016484 : Boolean INDATASET;
      CatalogFilterVisible@11123399 : Boolean;
      CancelXPos@19007686 : Integer;
      CancelYPos@19003745 : Integer;
      CancelHeight@19054177 : Integer;
      CancelWidth@19035161 : Integer;
      FrmXPos@19006598 : Integer;
      FrmYPos@19016646 : Integer;
      FrmHeight@19058551 : Integer;
      FrmWidth@19057698 : Integer;
      Text19038597@19053743 : TextConst 'ENU=Welcome to Sana Commerce startup wizard';
      Text19046416@19021181 : TextConst 'ENU=This wizard will guide you through the Sana Commerce setup and help you to configure the initial settings that are required for the correct functioning of the Sana Commerce webshop. To continue, click "Next".';
      Text19011831@19030580 : TextConst 'ENU=Online payment';
      Text19004549@19042036 : TextConst 'ENU=Specify the default payment method code (optional). It is used for sales orders during online payments. The payment cost coming from the webshop is booked on the ledger account specified in the "Payment Cost No." field and is stored as a sales line.';
      Text19064482@19054856 : TextConst 'ENU=Numbering';
      Text19052583@19018190 : TextConst 'ENU=Sana Commerce uses the default Microsoft Dynamics NAV functionality (No. Series) to generate the unique identifiers for sales orders, sales quotes and guest customer accounts.';
      Text19015087@19060103 : TextConst 'ENU=Warehouse';
      Text19012378@19023499 : TextConst 'ENU=You can use location code either from the customer card or set up the default location code for a webstore that will be used for all customers.';
      Text19026810@19076349 : TextConst 'ENU=Countries';
      Text19010313@19015871 : TextConst 'ENU=Select "Visible in Webshop" for countries that should be available in the webshop for customer registration, shipping address and prospect orders. Customer registration and prospect orders also require the customer template for each visible country.';
      Text19007493@19029924 : TextConst 'ENU=Update items visibility';
      Text19066381@19022282 : TextConst 'ENU=Update visibility of all items in the webshop. All items are validated by the default rules of orderability. Those items that satisfy the orderability criteria are automatically made visible in the webshop.';
      Text19045373@19053508 : TextConst 'ENU=Finish';
      Text19035030@19019824 : TextConst 'ENU=You have successfully completed the Sana Commerce startup wizard. If items are ready, update webshop index by running the "Product import" task in Sana Admin. Now your webshop is ready for trading. Thank you for choosing Sana Commerce.';
      Text19060509@19013476 : TextConst 'ENU=Webshop filter';
      Text19019342@19073151 : TextConst 'ENU=On this step you can set up webshop filters to show only those items, and allow to order only those customers, salespeople and contacts in the Sana webshop which are necessary for your online business.';
      Text19048515@19070791 : TextConst 'ENU=Data validation rules';
      Text19060342@19031928 : TextConst 'ENU=For the correct functioning of the Sana Commerce solution generate the default data validation rules, which affect data retrieving. Only data which satisfies the selected criteria can be processed.';
      Text19030651@19070803 : TextConst 'ENU=Roles and permissions';
      Text19013693@19028904 : TextConst 'ENU=Import the Sana role with a set of permissions. This role can be assigned to the user in Microsoft Dynamics NAV to give access to all Sana Commerce objects.';
      Text19004890@11123335 : TextConst 'ENU=General';
      Text19074208@11123336 : TextConst 'ENU=Create a webshop. ID should be the same as in the Sana Store SQL database. Template customer is used for customer registration, to show prices for the not signed in visitors, suggest items from a particular inventory location and for items indexing.';
      Text19026012@11123337 : TextConst 'ENU=Online shipment';
      Text19011054@11123338 : TextConst 'ENU=Specify the ledger account for the shipping costs. The shipping cost coming from the webshop is booked on the ledger account specified in the "Shipping Cost No." field and is stored as a sales line.';
      Text19011055@11123339 : TextConst 'ENU=Quotes and orders are all part of a sales process. Sana supports all Microsoft Dynamics NAV sales documents as well as a possibility to convert quotes into sales orders. Set up ordering settings to meet your sales process requirements.';
      Text11123306@11123344 : TextConst 'ENU=Use the document downloads option to allow customers generate printable reports for sales documents directly from Sana webshop. Use the product and document attachment downloads options to show item and sales document attachments in a Sana webshop.';
      Text11123307@11123345 : TextConst 'ENU=Downloading';
      Text11123308@11123346 : TextConst 'ENU=Document Downloads';
      Text11123309@11123347 : TextConst 'ENU=Attachment Downloads';

    PROCEDURE SetFormPosition@11123316();
    VAR
      FormWidth@11123302 : Integer;
    BEGIN

      FormWidth := CancelXPos + CancelWidth + 220;
      FrmXPos := ROUND((FrmWidth - FormWidth) / 2,1) + FrmXPos;
      FrmYPos := 3000;
      FrmHeight := CancelYPos + CancelHeight + 220;
      FrmWidth := FormWidth;
    END;

    PROCEDURE SetFormDafaults@11123317();
    BEGIN
      GlobalStepNo := 0;
      CatalogFilterVisible := FALSE;

      ControlCustomerTemplateEnable := GlobalAllVisibleInWebshop;
      ProjectedDateCalculationEditab := GlobalInventoryCalculation = GlobalInventoryCalculation::"Projected Available Balance";
      LocationCodeSourceEditable := GlobalLocationCodeSource = GlobalLocationCodeSource::Webshop;
    END;

    LOCAL PROCEDURE ShowStep@11123334(StepNo@1001 : Integer);
    BEGIN
      Step0Visible := FALSE;
      Step1Visible := FALSE;
      Step2Visible := FALSE;
      Step3Visible := FALSE;
      Step4Visible := FALSE;
      Step5Visible := FALSE;
      Step6Visible := FALSE;
      Step7Visible := FALSE;
      Step8Visible := FALSE;
      Step9Visible := FALSE;
      Step10Visible := FALSE;
      FinishEnable := FALSE;
      BackEnable := TRUE;
      NextEnable := TRUE;

      CASE StepNo OF
        0 :
            BEGIN
              Step0Visible := TRUE;
              IF Step0Visible THEN
                BackEnable := FALSE;
            END;
        1 : Step1Visible := TRUE;
        2 : Step2Visible := TRUE;
        3 : Step3Visible := TRUE;
        4 : Step4Visible := TRUE;
        5 : Step5Visible := TRUE;
        6 : Step6Visible := TRUE;
        7 : Step7Visible := TRUE;
        8 : Step8Visible := TRUE;
        9 : Step9Visible := TRUE;
        10 :
            BEGIN
            Step10Visible := TRUE;
            IF Step10Visible THEN BEGIN
                FinishEnable := TRUE;
                BackEnable := FALSE;
                CancelEnable := FALSE;
                NextEnable := FALSE;
              END;
            END;
      END;
    END;

    PROCEDURE OpenCatalogFilters@11123351();
    VAR
      CatalogFilter@11123304 : Record 11123309;
      CatalogFilters@11123303 : Page 11123309;
    BEGIN
      CatalogFilter.FILTERGROUP(2);
      CatalogFilter.SETRANGE(Code,GlobalWebshopId);
      CatalogFilter.FILTERGROUP(0);

      CLEAR(CatalogFilters);
      CatalogFilters.SETTABLEVIEW(CatalogFilter);
      CatalogFilters.RUNMODAL;
    END;

    PROCEDURE SetWebService@11123304();
    VAR
      ExecutionContext@11123303 : Codeunit 11123305;
    BEGIN
      CASE ExecutionContext.GetVersionNav OF
        6 : SetWebServiceLine('SC_NAV2009_WebService');
      ELSE
        SetWebServiceLine('SC_NAV_WebService');
      END;
    END;

    PROCEDURE SetWebServiceLine@11123305(ServiceName@11123304 : Text[240]);
    VAR
      WebService@11123303 : Record 2000000076;
    BEGIN
      WebService.SETRANGE("Object Type",WebService."Object Type"::Codeunit);
      WebService.SETRANGE("Service Name",ServiceName);
      IF WebService.ISEMPTY THEN BEGIN
        WebService.INIT;
        WebService."Object Type" := WebService."Object Type"::Codeunit;
        WebService."Object ID" := 11123303;
        WebService."Service Name" := ServiceName;
        WebService.Published := TRUE;
        WebService.INSERT;
      END;
    END;

    PROCEDURE SetEnableSana@1100088000();
    VAR
      SCSetup@1100088000 : Record 11123305;
      Operation@1100088001 : Record 11123302;
      Validation@1100088002 : Codeunit 11123310;
    BEGIN
      IF NOT SCSetup.GET THEN BEGIN
        SCSetup.INIT;
        SCSetup.INSERT(TRUE);
      END;

      SCSetup.GET;
      IF NOT SCSetup."Enable Sana Commerce" THEN BEGIN
         Operation.SetDefaults;
         SCSetup.MODIFYALL("Enable Sana Commerce",TRUE);
      END;
    END;

    PROCEDURE SetVisibleCountryRegion@11123326();
    VAR
      SettingsFunctions@11123302 : Codeunit 11123311;
    BEGIN
      IF GlobalAllVisibleInWebshop THEN
        SettingsFunctions.SetAllCountriesRegionsVisible(GlobalCustomerTemplateCode);
    END;

    PROCEDURE SetValidationRules@11123308();
    VAR
      Setup@11123303 : Record 11123305;
      Validation@11123302 : Codeunit 11123310;
    BEGIN
      GlobalGenerateValidationRules := NOT Validation.ValidationRulesExist;
      IF GlobalGenerateValidationRules THEN BEGIN
        Validation.SetGlobalHideConfirm(TRUE);
        Validation.SetDefaults(0,Setup);
      END;
    END;

    PROCEDURE SetVisibilityItems@11123318();
    BEGIN
      IF GlobalUpdateVisibility THEN
        REPORT.RUNMODAL(11123302,FALSE);
    END;

    PROCEDURE RunFormCustomerTemplateList@11123302();
    VAR
      CustomerTemplate@11123302 : Record 5105;
    BEGIN
      IF PAGE.RUNMODAL(5156,CustomerTemplate) = ACTION::LookupOK THEN
        GlobalCustomerTemplateCode := CustomerTemplate.Code;
    END;

    PROCEDURE RunFormCustomerTemplateNo@11123332();
    VAR
      Customer@11123302 : Record 18;
    BEGIN
      IF PAGE.RUNMODAL(22,Customer) = ACTION::LookupOK THEN
        GlobalTemplateCustomerNo := Customer."No.";
    END;

    PROCEDURE RunFormCountriesRegions@11123342();
    VAR
      SettingsFunctions@11123302 : Codeunit 11123311;
      CountriesRegions@11123303 : Page 10;
    BEGIN
      CountriesRegions.SETTABLEVIEW(GlobalCountryRegion);
      CountriesRegions.RUNMODAL;
    END;

    PROCEDURE RunFormByTable@11123335(Type@11123303 : ' ,G/L Account,Item,Resource,Fixed Asset,Charge (Item)';VAR CostNo@11123304 : Code[20]);
    VAR
      GLAccount@11123309 : Record 15;
      Item@11123308 : Record 27;
      Resource@11123307 : Record 156;
      FixedAsset@11123306 : Record 5600;
      ItemCharge@11123305 : Record 5800;
    BEGIN
      CASE Type OF
        1 : IF PAGE.RUNMODAL(18,GLAccount) = ACTION::LookupOK THEN
              CostNo := GLAccount."No.";
        2 : IF PAGE.RUNMODAL(31,Item) = ACTION::LookupOK THEN
              CostNo := Item."No.";
        3 : IF PAGE.RUNMODAL(77,Resource) = ACTION::LookupOK THEN
              CostNo := Resource."No.";
        4 : IF PAGE.RUNMODAL(5601,FixedAsset) = ACTION::LookupOK THEN
              CostNo := FixedAsset."No.";
        5 : IF PAGE.RUNMODAL(5800,ItemCharge) = ACTION::LookupOK THEN
              CostNo := ItemCharge."No.";
      END;
    END;

    PROCEDURE RunFormLocation@11123313();
    VAR
      Location@11123302 : Record 14;
    BEGIN
      IF PAGE.RUNMODAL(15,Location) = ACTION::LookupOK THEN
        GlobalLocationCode := Location.Code;
    END;

    PROCEDURE CheckWebshopId@11123323(WebshopId@11123303 : Code[50]);
    VAR
      Webshop@11123304 : Record 11123313;
    BEGIN
      IF WebshopId = '' THEN
        ERROR(text11123301);

      Webshop.SETRANGE(ID,WebshopId);
      IF NOT Webshop.ISEMPTY THEN
        ERROR(text11123302,WebshopId);
    END;

    PROCEDURE CheckCustomerTemplateCode@11123311();
    BEGIN
      IF GlobalAllVisibleInWebshop AND (GlobalCustomerTemplateCode = '') THEN
        ERROR(text11123303);
    END;

    PROCEDURE SetInstructions@11123348();
    BEGIN
      IF SetWebshop THEN BEGIN
        SetWebService;
        SetEnableSana;
        SetRolesPermissions;
        SetVisibleCountryRegion;
        SetValidationRules;
        SetVisibilityItems;
      END;
    END;

    PROCEDURE SetWebshop@11123324() LineInsert : Boolean;
    VAR
      Webshop@11123302 : Record 11123313;
    BEGIN
      WITH Webshop DO BEGIN
        INIT;
        ID := GlobalWebshopId;
        "Template Customer No." := GlobalTemplateCustomerNo;
        "Payment Method Code" := GlobalPaymentMethod;
        "Shipping Cost No." := GlobalShippingCostNo;
        "Shipping Cost Type" := GlobalShippingCostType;
        "Payment Cost No." := GlobalPaymentCostNo;
        "Payment Cost Type" := GlobalPaymentCostType;
        "Quote Nos." := GlobalQuoteNos;
        "Order Nos." := GlobalOrderNos;
        "Guest Nos." := GlobalGuestNos;
        "Location Code Source" := GlobalLocationCodeSource;
        "Location Code" := GlobalLocationCode;
        "Inventory Calculation" := GlobalInventoryCalculation;
        "Projected Date Calculation" := GlobalProjectedDateCalculation;
        "Order Type" := GlobalOrderType;
        "Synchronized Basket Type" := GlobalSynchronizedBasketType;
        "Quote Promotable" := GlobalQuotePromotable;
        "Enable Document Downloads" := GlobalEnableDocumentDownloads;
        "Enable Product Attachment" := GlobalEnableProdAttachmen;
        "Enable Document Attachment" := GlobalEnableDocumentAttachment;
        IF INSERT THEN
          LineInsert := TRUE;
      END;
    END;

    PROCEDURE SetRolesPermissions@11123344();
    VAR
      SettingsFunctions@11123302 : Codeunit 11123311;
    BEGIN
      IF GlobalSanaRolePermissions THEN
        SettingsFunctions.SetSanaRolePermissions;
    END;

    PROCEDURE CheckAndClearCatalogFilterLine@11123303();
    VAR
      Webshop@11123302 : Record 11123313;
      CatalogFilter@11123303 : Record 11123309;
    BEGIN
      IF Webshop.GET(GlobalWebshopId) THEN
        EXIT;

      CatalogFilter.SETRANGE(Code,GlobalWebshopId);
      CatalogFilter.DELETEALL;
    END;

    PROCEDURE CheckValue@11123329(Type@11123303 : ' ,G/L Account,Item,Resource,Fixed Asset,Charge (Item)';InValue@11123304 : Code[20]);
    VAR
      GLAccount@11123309 : Record 15;
      Item@11123308 : Record 27;
      Resource@11123307 : Record 156;
      FixedAsset@11123306 : Record 5600;
      ItemCharge@11123305 : Record 5800;
    BEGIN
      IF InValue = '' THEN
        EXIT;

      CASE Type OF
        0 : ERROR(text11123304,InValue);
        1 : IF NOT GLAccount.GET(InValue) THEN
              ERROR(text11123304,InValue);
        2 : IF NOT Item.GET(InValue) THEN
              ERROR(text11123304,InValue);
        3 : IF NOT Resource.GET(InValue) THEN
              ERROR(text11123304,InValue);
        4 : IF NOT FixedAsset.GET(InValue) THEN
              ERROR(text11123304,InValue);
        5 : IF NOT ItemCharge.GET(InValue) THEN
              ERROR(text11123304,InValue);
      END;
    END;

    PROCEDURE CheckCustomer@11123338(InValue@11123302 : Code[20]);
    VAR
      Customer@11123303 : Record 18;
    BEGIN
      IF InValue <> '' THEN
        Customer.GET(InValue);
    END;

    PROCEDURE ValidateOrderType@11123343();
    BEGIN
      IF GlobalOrderType = GlobalOrderType::Quote THEN
        GlobalSynchronizedBasketType := GlobalSynchronizedBasketType::Quote;
    END;

    LOCAL PROCEDURE GlobalAllVisibleInWebshoOnPush@19015469();
    BEGIN
      GlobalCustomerTemplateCode := '';
      ControlCustomerTemplateEnable := GlobalAllVisibleInWebshop;
      SelectManuallyEnable := NOT GlobalAllVisibleInWebshop;
    END;

    LOCAL PROCEDURE GlobalSelectManuallyVisiOnPush@19051556();
    BEGIN
      AllVisibleEnable := NOT GlobalSelectManuallyVisibility;

      IF GlobalSelectManuallyVisibility THEN
        RunFormCountriesRegions;
    END;

    BEGIN
    END.
  }
}

