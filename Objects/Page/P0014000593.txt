OBJECT Page 14000593 Procurement Unit Card Sum.
{
  OBJECT-PROPERTIES
  {
    Date=03/27/19;
    Time=12:00:00 PM;
    Version List=UBP3.00;
  }
  PROPERTIES
  {
    CaptionML=ENU=Procurement Unit Summary Card;
    SourceTable=Table14000555;
    PageType=Card;
    OnInit=BEGIN
             "Maximum Days SupplyEditable" := TRUE;
             "Minimum Days SupplyEditable" := TRUE;
             "Maximum InventoryEditable" := TRUE;
             "Minimum InventoryEditable" := TRUE;
           END;

    OnAfterGetRecord=BEGIN
                       SetFields;
                     END;

    ActionList=ACTIONS
    {
      { 1240020027;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 1240020015;1 ;Action    ;
                      CaptionML=ENU=Location Inventory &Roll Up;
                      Image=BOMVersions;
                      OnAction=BEGIN
                                 UBP.DisplayLocInvRollup(Rec);
                               END;
                                }
      { 1240020010;1 ;Action    ;
                      ShortCutKey=Shift+F11;
                      CaptionML=ENU=View &Forecast;
                      ToolTipML=ENU=Demand and supply plan;
                      Image=CalculateRegenerativePlan;
                      OnAction=VAR
                                 ForecastView@1240020000 : Page 14002661;
                               BEGIN
                                 CLEAR(ForecastView);
                                 ForecastView.SetProcUnitandSourceNo(Rec,'');
                                 ForecastView.RUN;
                               END;
                                }
      { 1240020025;1 ;Action    ;
                      CaptionML=ENU=&Item;
                      RunObject=Page 30;
                      RunPageLink=No.=FIELD(Item No.);
                      Promoted=No;
                      Image=NewItem;
                      PromotedCategory=Process }
      { 1240020023;1 ;Action    ;
                      CaptionML=ENU=Procurement Unit &Edit;
                      RunObject=Page 14000545;
                      RunPageView=SORTING(Item No.,Variant Code,Location Code)
                                  ORDER(Ascending);
                      RunPageLink=Item No.=FIELD(Item No.);
                      Image=EditList }
      { 1240020022;1 ;Action    ;
                      CaptionML=ENU=Item &Classification;
                      ToolTipML=ENU=Current and past assigned item classification by date;
                      RunObject=Page 14000557;
                      RunPageView=SORTING(Location Code,Item No.,Variant Code,Starting Date,Ending Date)
                                  ORDER(Ascending);
                      RunPageLink=Location Code=FIELD(Location Code),
                                  Item No.=FIELD(Item No.),
                                  Variant Code=FIELD(Variant Code);
                      Promoted=No;
                      Image=ImplementPriceChange;
                      PromotedCategory=Process }
      { 1240020021;1 ;Action    ;
                      CaptionML=ENU=Item &Usage;
                      ToolTipML=ENU=Summarized item usage and related data by period;
                      Promoted=Yes;
                      Image=ItemTrackingLedger;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 ItemUsage@1240020000 : Record 14000557;
                               BEGIN
                                 ItemUsage.SETRANGE("Location Code","Location Code");
                                 ItemUsage.SETRANGE("Item No.","Item No.");
                                 ItemUsage.SETRANGE("Variant Code","Variant Code");
                                 ItemUsage.SETRANGE("Location Filter","Location Code");
                                 PAGE.RUNMODAL(PAGE::"Item Usage List",ItemUsage);
                               END;
                                }
      { 1240020020;1 ;Action    ;
                      CaptionML=ENU=Vendor &Performance;
                      ToolTipML=ENU=Vendor delivery performance by receipt and purchase order;
                      RunObject=Page 14000561;
                      RunPageView=SORTING(Location Code,Vendor,Item No.,Variant Code,Exclude From Performance,Date Received)
                                  ORDER(Ascending);
                      RunPageLink=Location Code=FIELD(Location Code),
                                  Item No.=FIELD(Item No.),
                                  Variant Code=FIELD(Variant Code);
                      Promoted=No;
                      Image=MachineCenterLoad;
                      PromotedCategory=Process }
      { 1240020019;1 ;Action    ;
                      CaptionML=ENU=&Vendor Buying Calendar;
                      ToolTipML=ENU=Vendor Buyin Calendar;
                      Promoted=Yes;
                      Image=VendorLedger;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 VendBuyingCalendar@1240020000 : Record 14000563;
                               BEGIN
                                 IF "Replenishment Source Type" = "Replenishment Source Type"::Vendor THEN BEGIN
                                   VendBuyingCalendar.RESET;
                                   VendBuyingCalendar.SETRANGE("Vendor No.","Replenishment Source Code");
                                   VendBuyingCalendar.SETRANGE("Location Code","Location Code");
                                   PAGE.RUNMODAL(PAGE::"Vendor Buying Calendar",VendBuyingCalendar);
                                 END;
                               END;
                                }
      { 1240020018;1 ;Action    ;
                      CaptionML=ENU=Ledger &Entries;
                      ToolTipML=ENU=Detail of usage;
                      Promoted=No;
                      Image=ItemLedger;
                      OnAction=BEGIN
                                 UBP.ItemLedgerEntryLookup(Rec, TRUE);
                               END;
                                }
      { 1240020017;1 ;Action    ;
                      ShortCutKey=Ctrl+F7;
                      CaptionML=ENU=Usage &Ledger Entries;
                      Promoted=No;
                      Image=ItemLedger;
                      OnAction=BEGIN
                                 UBP.UsageLedgerEntryLookup(Rec, FALSE);
                               END;
                                }
      { 1240020016;1 ;Action    ;
                      CaptionML=ENU=&Calculation Lines;
                      ToolTipML=ENU=Detail of replenishment calculation;
                      RunObject=Page 14000583;
                      RunPageView=SORTING(Location Code,Item No.,Variant Code,Line No.)
                                  ORDER(Ascending);
                      RunPageLink=Location Code=FIELD(Location Code),
                                  Item No.=FIELD(Item No.),
                                  Variant Code=FIELD(Variant Code);
                      Promoted=No;
                      Image=CalculateInvoiceDiscount;
                      PromotedCategory=Process }
      { 1240020014;1 ;Action    ;
                      CaptionML=ENU=Replenishment Path;
                      ToolTipML=ENU=Replenishment path;
                      Promoted=No;
                      Image=RoutingVersions;
                      OnAction=BEGIN
                                 UBP.DisplayReplenishmentPath(Rec);
                               END;
                                }
      { 1240020013;1 ;Separator  }
      { 1240020012;1 ;Action    ;
                      CaptionML=ENU=Unusual Usage &Adj.;
                      ToolTipML=ENU=Unusual usage adjustment by month;
                      RunObject=Page 14002657;
                      RunPageView=SORTING(Location Code,Item No.,Variant Code,Starting Date,Ending Date)
                                  ORDER(Ascending);
                      RunPageLink=Location Code=FIELD(Location Code),
                                  Item No.=FIELD(Item No.),
                                  Variant Code=FIELD(Variant Code),
                                  Source No.=FILTER(='');
                      Promoted=No;
                      Image=CalculateDepreciation;
                      PromotedCategory=Process }
      { 1240020011;1 ;Action    ;
                      CaptionML=ENU=Formula &Detail;
                      ToolTipML=ENU=Shows forecast formula and variances in best fit formula selection (only for marked items);
                      RunObject=Page 14002658;
                      RunPageLink=Location Code=FIELD(Location Code),
                                  Item No.=FIELD(Item No.),
                                  Variant Code=FIELD(Variant Code);
                      Promoted=No;
                      Image=ItemWorksheet;
                      PromotedCategory=Process }
      { 1240020009;1 ;Separator  }
      { 1240020008;1 ;Action    ;
                      CaptionML=ENU=&Usage Redirect;
                      RunObject=Page 14000588;
                      RunPageLink=Location Code=FIELD(Location Code),
                                  Item No.=FIELD(Item No.),
                                  Variant Code=FIELD(Variant Code);
                      Image=SelectItemSubstitution;
                      PromotedCategory=Process }
      { 1240020007;1 ;Action    ;
                      CaptionML=ENU=&Additional Stock Quantity;
                      RunObject=Page 14002711;
                      RunPageView=SORTING(Location Code,Item No.,Variant Code,Customer No.);
                      RunPageLink=Location Code=FIELD(Location Code),
                                  Item No.=FIELD(Item No.),
                                  Variant Code=FIELD(Variant Code);
                      Promoted=No;
                      Image=VATStatement;
                      PromotedCategory=Process }
      { 1240020006;1 ;Action    ;
                      CaptionML=ENU=&Surplus List;
                      RunObject=Page 14000538;
                      RunPageView=SORTING(Item No.,Variant Code,Surplus Available)
                                  ORDER(Ascending);
                      RunPageLink=Item No.=FIELD(Item No.),
                                  Surplus Available=CONST(Yes);
                      Promoted=No;
                      Image=ResourceCosts;
                      PromotedCategory=Process }
      { 1240020005;1 ;Action    ;
                      CaptionML=ENU=A&lert;
                      RunObject=Page 14002718;
                      RunPageLink=Item No.=FIELD(Item No.),
                                  Location Code=FIELD(Location Code),
                                  Variant Code=FIELD(Variant Code);
                      Promoted=No;
                      Image=Approve;
                      PromotedCategory=Process }
      { 1240020004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1240020001;1 ;Action    ;
                      CaptionML=ENU=&Reforecast Item;
                      Promoted=No;
                      Image=Replan;
                      OnAction=VAR
                                 Reforecast@1240020001 : Codeunit 14000571;
                                 UpdateProcUnitLocFilters@1240020000 : Codeunit 14000581;
                               BEGIN
                                 CLEAR(UpdateProcUnitLocFilters);
                                 UpdateProcUnitLocFilters.ByLocation('',"Item No.");
                                 CurrPage.UPDATE(FALSE);
                                 CLEAR(Reforecast);
                                 Reforecast.ByItem("Item No.");
                                 CurrPage.UPDATE(FALSE);
                               END;
                                }
      { 1240020002;1 ;Action    ;
                      CaptionML=ENU=&Clone Usage;
                      Promoted=No;
                      Image=Copy;
                      OnAction=BEGIN
                                 ProcUnit.RESET;
                                 ProcUnit.SETRANGE("Location Code","Location Code");
                                 ProcUnit.SETRANGE("Item No.","Item No.");
                                 ProcUnit.SETRANGE("Variant Code","Variant Code");
                                 REPORT.RUNMODAL(REPORT::"Clone Usage",TRUE,FALSE,ProcUnit);
                               END;
                                }
      { 1240020000;1 ;Action    ;
                      CaptionML=ENU=Recalculate &Ave. Lead Time;
                      Promoted=No;
                      Image=ReverseLines;
                      OnAction=VAR
                                 VendPerfCalc@1240020000 : Codeunit 14000551;
                               BEGIN
                                 VendPerfCalc.CalcAveLeadTime(Rec);
                                 CurrPage.UPDATE(TRUE);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1240020088;0;Container;
                ContainerType=ContentArea }

    { 1240020087;1;Group  ;
                CaptionML=ENU=General }

    { 1240020086;2;Field  ;
                ToolTipML=ENU=Specifies a location code for the warehouse or distribution center where your items are handled and stored before being sold.;
                SourceExpr="Location Code";
                Importance=Promoted }

    { 1240020085;2;Field  ;
                ToolTipML=ENU=Item number;
                SourceExpr="Item No.";
                Importance=Promoted;
                Editable=FALSE }

    { 1240020084;2;Field  ;
                SourceExpr=Description }

    { 1240020083;2;Field  ;
                SourceExpr="Variant Code" }

    { 1240020082;2;Field  ;
                SourceExpr="Summarize Variant Detail" }

    { 1240020089;2;Field  ;
                SourceExpr="Summarize Pending" }

    { 1240020090;2;Field  ;
                SourceExpr="Preferred Variant" }

    { 1240020081;2;Field  ;
                ToolTipML=ENU=First date of sales order shipment;
                SourceExpr="First Stocked Date";
                Importance=Promoted }

    { 1240020080;2;Field  ;
                ToolTipML=ENU=Not forecasted and not stocked;
                SourceExpr="Nonstock Unit" }

    { 1240020079;2;Field  ;
                SourceExpr="Include Drop Ship Usage" }

    { 1240020078;2;Field  ;
                SourceExpr=Review;
                Importance=Additional }

    { 1240020077;2;Field  ;
                SourceExpr=Alert;
                Importance=Additional }

    { 1240020076;2;Field  ;
                SourceExpr="Reforecast Item" }

    { 1240020075;2;Field  ;
                SourceExpr="Change Reforecast Required" }

    { 1240020074;2;Field  ;
                ToolTipML=ENU=Calculated average lead time based on purchase order receipts;
                SourceExpr="Average Lead Time (Days)" }

    { 1240020073;2;Field  ;
                SourceExpr="Usage Formula Status";
                Editable=FALSE }

    { 1240020072;2;Field  ;
                SourceExpr="Replenishment Hierarchy";
                Editable=FALSE }

    { 1240020071;2;Field  ;
                SourceExpr="Purchaser Code" }

    { 1240020070;2;Group  ;
                CaptionML=ENU=Ordering }

    { 1240020069;3;Field  ;
                SourceExpr="Stocking Rule Code";
                Importance=Additional }

    { 1240020068;3;Field  ;
                SourceExpr="Replenishment Source Type";
                Importance=Promoted;
                OnValidate=BEGIN
                             SetFields;
                           END;
                            }

    { 1240020067;3;Field  ;
                SourceExpr="Replenishment Source Code";
                Importance=Promoted;
                OnValidate=BEGIN
                             SetFields;
                           END;
                            }

    { 1240020053;3;Field  ;
                SourceExpr="Division Code";
                Importance=Additional }

    { 1240020066;3;Field  ;
                SourceExpr="Replenishment Model";
                Importance=Promoted;
                OnValidate=BEGIN
                             SetFields;
                           END;
                            }

    { 1240020065;3;Field  ;
                SourceExpr="Order Qty. Method";
                Importance=Promoted }

    { 1240020064;3;Field  ;
                CaptionML=ENU=Safety Stock Calc. Method;
                SourceExpr="Safety Stock Calc. Method";
                Importance=Additional }

    { 1240020063;3;Field  ;
                CaptionML=ENU=Target Customer Service Level;
                SourceExpr="Target Customer Service Level";
                Importance=Additional }

    { 1240020062;3;Field  ;
                SourceExpr="Maximum Inventory";
                Editable="Maximum InventoryEditable" }

    { 1240020061;3;Field  ;
                SourceExpr="Minimum Inventory";
                Editable="Minimum InventoryEditable" }

    { 1240020060;3;Field  ;
                SourceExpr="Maximum Days Supply";
                Importance=Promoted;
                Editable="Maximum Days SupplyEditable" }

    { 1240020059;3;Field  ;
                SourceExpr="Minimum Days Supply";
                Importance=Promoted;
                Editable="Minimum Days SupplyEditable" }

    { 1240020026;3;Field  ;
                SourceExpr="Maximum Shelf Stock" }

    { 1240020003;3;Field  ;
                SourceExpr="Minimum Shelf Stock";
                Visible=FALSE }

    { 1240020058;3;Field  ;
                ToolTipML=ENU=Unit of measure for purchase orders.;
                SourceExpr="Purchase Unit of Measure" }

    { 1240020057;3;Field  ;
                ToolTipML=ENU=Order multiple for suggested orders;
                SourceExpr="Order Multiple" }

    { 1240020056;3;Field  ;
                ToolTipML=ENU=Minimum order quantity;
                SourceExpr="Order Minimum" }

    { 1240020055;3;Field  ;
                SourceExpr="LTH Order Add Days";
                Importance=Additional }

    { 1240020054;3;Field  ;
                ToolTipML=ENU=Safety stock days;
                SourceExpr="Safety Stock Days" }

    { 1240020091;3;Field  ;
                Name=Additional Stock Quantity;
                CaptionML=ENU=Additional Stock Quantity;
                SourceExpr=CalcAdditionalStock }

    { 1240020052;1;Group  ;
                CaptionML=ENU=Ranking }

    { 1240020051;2;Field  ;
                ToolTipML=ENU=Item class based on COGS or percentage of items;
                SourceExpr="Item Class Description";
                Importance=Promoted }

    { 1240020050;2;Field  ;
                ToolTipML=ENU=Ranking code based on sales order 'hits';
                SourceExpr="Ranking Code";
                Importance=Promoted }

    { 1240020049;2;Field  ;
                SourceExpr="Periods With Sales";
                Importance=Promoted }

    { 1240020048;2;Field  ;
                SourceExpr="Date Created";
                Importance=Promoted }

    { 1240020047;2;Field  ;
                SourceExpr="Date Changed" }

    { 1240020046;2;Field  ;
                SourceExpr="User ID" }

    { 1240020045;1;Group  ;
                CaptionML=ENU=Frozen Controls }

    { 1240020044;2;Field  ;
                SourceExpr="Frozen Lead Time (Days)";
                Importance=Promoted }

    { 1240020043;2;Field  ;
                SourceExpr="Frozen Lead Time Expir. Date";
                Importance=Promoted }

    { 1240020042;2;Field  ;
                SourceExpr="Frozen Usage per Day" }

    { 1240020041;2;Field  ;
                SourceExpr="Frozen Usage Expiration Date" }

    { 1240020040;2;Field  ;
                SourceExpr="Frozen Formula";
                Importance=Promoted }

    { 1240020039;2;Field  ;
                SourceExpr="Frozen Formula Expiration Date" }

    { 1240020038;2;Field  ;
                SourceExpr="Frozen Formula Group" }

    { 1240020037;2;Field  ;
                SourceExpr="Frozen Formula Group Exp. Date" }

    { 1240020036;2;Field  ;
                SourceExpr="Frozen Order Point" }

    { 1240020035;2;Field  ;
                SourceExpr="Frozen Order Point Expiration" }

    { 1240020034;2;Field  ;
                SourceExpr="Frozen Safety Allowance %" }

    { 1240020033;2;Field  ;
                SourceExpr="Frozen Safety Expiration Date" }

    { 1240020032;2;Field  ;
                SourceExpr="Sporadic Rule" }

    { 1240020031;2;Field  ;
                SourceExpr="Imported Lead Time (Days)" }

    { 1240020030;2;Field  ;
                SourceExpr="Safety Stock Modifier" }

    { 1240020029;0;Container;
                ContainerType=FactBoxArea }

    { 1240020028;1;Part   ;
                SubPageLink=Location Code=FIELD(Location Code),
                            Item No.=FIELD(Item No.),
                            Variant Code=FIELD(Variant Code);
                PagePartID=Page14097479;
                PartType=Page }

    { 1240020024;1;Part   ;
                CaptionML=ENU=Item Usage;
                SubPageLink=Location Code=FIELD(Location Code),
                            Item No.=FIELD(Item No.),
                            Variant Code=FIELD(Variant Code);
                PagePartID=Page14097457;
                PartType=Page;
                ShowFilter=No }

  }
  CODE
  {
    VAR
      UBP@15000552 : Codeunit 14000564;
      ProcUnit@1240020000 : Record 14000555;
      "Minimum InventoryEditable"@19074586 : Boolean INDATASET;
      "Maximum InventoryEditable"@19007492 : Boolean INDATASET;
      "Minimum Days SupplyEditable"@19062502 : Boolean INDATASET;
      "Maximum Days SupplyEditable"@19059626 : Boolean INDATASET;

    PROCEDURE SetFields@1();
    BEGIN
      IF "Replenishment Model" = "Replenishment Model"::"Usage Based Procurement" THEN BEGIN
        "Minimum InventoryEditable" := FALSE;
        "Maximum InventoryEditable" := FALSE;
        "Minimum Days SupplyEditable" := FALSE;
        "Maximum Days SupplyEditable" := FALSE;
      END ELSE IF "Replenishment Model" = "Replenishment Model"::"Min/Max" THEN BEGIN
        "Minimum InventoryEditable" := TRUE;
        "Maximum InventoryEditable" := TRUE;
        "Minimum Days SupplyEditable" := TRUE;
        "Maximum Days SupplyEditable" := TRUE;
      END;
    END;

    LOCAL PROCEDURE CalcAdditionalStock@1240020000() : Decimal;
    VAR
      ProcUnit2@1240020000 : Record 14000555;
    BEGIN
      ProcUnit2.COPY(Rec);
      ProcUnit2.SETFILTER("Location Filter", "Location Code");
      EXIT(ProcUnit2.AdditionalStockQty);
    END;

    BEGIN
    END.
  }
}

