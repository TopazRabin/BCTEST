OBJECT Page 14000559 Procurement Unit List
{
  OBJECT-PROPERTIES
  {
    Date=02/26/21;
    Time=[ 1:56:02 PM];
    Modified=Yes;
    Version List=UBP3.02;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=ENU=Procurement Unit List;
    SourceTable=Table14000555;
    DelayedInsert=Yes;
    PageType=List;
    CardPageID=Procurement Unit Card;
    OnOpenPage=VAR
                 AdditionalStock@1240020000 : Record 14002702;
                 ForecastUserSetup@1240020001 : Record 14097451;
               BEGIN
                 QtyExpVisible := FALSE;
                 IF InvMgtSetup.GET THEN;
                   QtyExpVisible := InvMgtSetup."Show Qty Exp. on Proc. List";
                 IF NOT QtyExpVisible THEN
                   IF ForecastUserSetup.GET(USERID) THEN
                     QtyExpVisible := ForecastUserSetup."Show Qty Exp. on Proc. List";
                 SummaryVisible := UBP.SummarizeVariantDetail;
                 AdditionalStockVisible := NOT AdditionalStock.ISEMPTY;
               END;

    OnAfterGetRecord=BEGIN
                       //<TPZ2322>
                       {QtyExpVisible := FALSE;
                       SummaryVisible := UBP.SummarizeVariantDetail;
                       AdditionalStockVisible := NOT AdditionalStock.ISEMPTY;
                       }
                       SETFILTER("Location Filter",UBP.GetLocationFilter(Rec,FALSE));
                       SETFILTER("Prod. Order Status Filter",UBP.GetProductionStatusFilter);
                       QtyExpected;
                       OnAfterGetCurrRecord;
                       //</TPZ2322>
                     END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 1240030044;1 ;Action    ;
                      CaptionML=ENU=Location Inventory Roll Up;
                      Image=BOMVersions;
                      OnAction=BEGIN
                                 UBP.DisplayLocInvRollup(Rec);
                               END;
                                }
      { 1240030012;1 ;Action    ;
                      ShortCutKey=Shift+F11;
                      CaptionML=ENU=View &Forecast;
                      Image=CalculateRegenerativePlan;
                      OnAction=VAR
                                 ForecastView@1240020000 : Page 14002661;
                               BEGIN
                                 CLEAR(ForecastView);
                                 ForecastView.SetProcUnitandSourceNo(Rec,'');
                                 ForecastView.RUN;
                               END;
                                }
      { 1240030001;1 ;Action    ;
                      Name=PUCSummaryCard;
                      ShortCutKey=Shift+F7;
                      CaptionML=ENU=Summary Card;
                      Promoted=No;
                      Visible=SummaryVisible;
                      PromotedIsBig=No;
                      Image=TeamSales;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 SumVarMsg@1240020000 : TextConst 'ENU=No summary procurement unit exists for Location %1 Item %2.';
                                 ProcUnit2@1240020001 : Record 14000555;
                               BEGIN
                                 IF ProcUnit2.GET("Location Code", "Item No.", '') THEN
                                   PAGE.RUN(PAGE::"Procurement Unit Card Sum.",ProcUnit2)
                                 ELSE
                                   MESSAGE(STRSUBSTNO(SumVarMsg, "Location Code", "Item No."));
                               END;
                                }
      { 1240020003;1 ;Action    ;
                      CaptionML=ENU=&Item;
                      RunObject=Page 30;
                      RunPageView=SORTING(No.);
                      RunPageLink=No.=FIELD(Item No.);
                      Image=NewItem }
      { 1240020002;1 ;Action    ;
                      CaptionML=ENU=Procurement Unit &Edit;
                      RunObject=Page 14000545;
                      RunPageView=SORTING(Item No.,Variant Code,Location Code)
                                  ORDER(Ascending);
                      RunPageLink=Item No.=FIELD(Item No.);
                      Image=EditList }
      { 1240030002;1 ;Action    ;
                      CaptionML=ENU=Item &Classification;
                      RunObject=Page 14000557;
                      RunPageView=SORTING(Location Code,Item No.,Variant Code,Starting Date,Ending Date)
                                  ORDER(Ascending);
                      RunPageLink=Location Code=FIELD(Location Code),
                                  Item No.=FIELD(Item No.),
                                  Variant Code=FIELD(Variant Code);
                      Promoted=No;
                      Image=ImplementPriceChange;
                      PromotedCategory=Process }
      { 1240030003;1 ;Action    ;
                      CaptionML=ENU=Item &Usage;
                      RunObject=Page 14000564;
                      RunPageLink=Location Code=FIELD(Location Code),
                                  Item No.=FIELD(Item No.),
                                  Variant Code=FIELD(Variant Code);
                      Promoted=Yes;
                      Image=ItemTrackingLedger;
                      PromotedCategory=Process }
      { 1240030004;1 ;Action    ;
                      CaptionML=ENU=Vendor &Performance;
                      RunObject=Page 14000561;
                      RunPageView=SORTING(Location Code,Vendor,Item No.,Variant Code,Exclude From Performance,Date Received)
                                  ORDER(Ascending);
                      RunPageLink=Location Code=FIELD(Location Code),
                                  Item No.=FIELD(Item No.),
                                  Variant Code=FIELD(Variant Code);
                      Promoted=No;
                      Image=MachineCenterLoad;
                      PromotedCategory=Process }
      { 1240030005;1 ;Action    ;
                      CaptionML=ENU=&Vendor Buying Calendar;
                      Promoted=Yes;
                      Image=VendorLedger;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 VendBuyingCalendar@1240020001 : Record 14000563;
                               BEGIN
                                 IF "Replenishment Source Type" = "Replenishment Source Type"::Vendor THEN BEGIN
                                   VendBuyingCalendar.RESET;
                                   VendBuyingCalendar.SETRANGE("Vendor No.","Replenishment Source Code");
                                   VendBuyingCalendar.SETRANGE("Location Code","Location Code");
                                   VendBuyingCalendar.SETRANGE("Division Code", "Division Code");
                                   PAGE.RUNMODAL(PAGE::"Vendor Buying Calendar",VendBuyingCalendar);
                                 END;
                               END;
                                }
      { 1240030006;1 ;Action    ;
                      Name=Item Ledger Entries;
                      CaptionML=ENU=Ledger &Entries;
                      Image=ItemLedger;
                      OnAction=BEGIN
                                 UBP.ItemLedgerEntryLookup(Rec, TRUE);
                               END;
                                }
      { 8       ;1   ;Action    ;
                      Name=Usage Ledger Entries;
                      ShortCutKey=Ctrl+F7;
                      CaptionML=ENU=Usage &Ledger Entries;
                      Image=ItemLedger;
                      OnAction=BEGIN
                                 UBP.UsageLedgerEntryLookup(Rec, FALSE);
                               END;
                                }
      { 1240020015;1 ;Action    ;
                      CaptionML=ENU=&Calculation Lines;
                      RunObject=Page 14000583;
                      RunPageView=SORTING(Location Code,Item No.,Variant Code,Line No.)
                                  ORDER(Ascending);
                      RunPageLink=Location Code=FIELD(Location Code),
                                  Item No.=FIELD(Item No.),
                                  Variant Code=FIELD(Variant Code);
                      Promoted=No;
                      Image=CalculateInvoiceDiscount;
                      PromotedCategory=Process }
      { 1240030046;1 ;Action    ;
                      CaptionML=ENU=Replenishment Path;
                      Promoted=No;
                      Image=RoutingVersions;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 UBP.DisplayReplenishmentPath(Rec);
                               END;
                                }
      { 1240020007;1 ;Action    ;
                      Name=<Action1240020002>;
                      CaptionML=ENU=Replenishment Path Alert;
                      RunObject=Page 14097511;
                      RunPageLink=Item No.=FIELD(Item No.);
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=RoutingVersions;
                      PromotedCategory=Process }
      { 1240030009;1 ;Action    ;
                      CaptionML=ENU=Unusual Usage &Adj.;
                      RunObject=Page 14002657;
                      RunPageView=SORTING(Location Code,Item No.,Variant Code,Starting Date,Ending Date)
                                  ORDER(Ascending);
                      RunPageLink=Location Code=FIELD(Location Code),
                                  Item No.=FIELD(Item No.),
                                  Variant Code=FIELD(Variant Code),
                                  Source No.=FILTER(='');
                      Promoted=No;
                      Image=CalculateDepreciation;
                      PromotedCategory=Process }
      { 1240030011;1 ;Action    ;
                      CaptionML=ENU=Formula &Detail;
                      RunObject=Page 14002658;
                      RunPageLink=Location Code=FIELD(Location Code),
                                  Item No.=FIELD(Item No.),
                                  Variant Code=FIELD(Variant Code);
                      Promoted=No;
                      Image=ItemWorksheet;
                      PromotedCategory=Process }
      { 12      ;1   ;Action    ;
                      CaptionML=ENU=&Usage Redirect;
                      RunObject=Page 14000588;
                      RunPageLink=Location Code=FIELD(Location Code),
                                  Item No.=FIELD(Item No.),
                                  Variant Code=FIELD(Variant Code);
                      Promoted=Yes;
                      Image=SelectItemSubstitution;
                      PromotedCategory=Process }
      { 11      ;1   ;Action    ;
                      CaptionML=ENU=&Additional Stock Quantity;
                      RunObject=Page 14002711;
                      RunPageView=SORTING(Location Code,Item No.,Variant Code,Customer No.);
                      RunPageLink=Location Code=FIELD(Location Code),
                                  Item No.=FIELD(Item No.),
                                  Variant Code=FIELD(Variant Code);
                      Promoted=No;
                      Image=VATStatement;
                      PromotedCategory=Process }
      { 10      ;1   ;Action    ;
                      CaptionML=ENU=&Surplus List;
                      RunObject=Page 14000538;
                      RunPageView=SORTING(Item No.,Variant Code,Surplus Available)
                                  ORDER(Ascending);
                      RunPageLink=Item No.=FIELD(Item No.),
                                  Surplus Available=CONST(Yes);
                      Promoted=No;
                      Image=ResourceCosts;
                      PromotedCategory=Process }
      { 9       ;1   ;Action    ;
                      CaptionML=ENU=A&lert;
                      RunObject=Page 14002718;
                      RunPageLink=Item No.=FIELD(Item No.),
                                  Location Code=FIELD(Location Code),
                                  Variant Code=FIELD(Variant Code);
                      Promoted=No;
                      Image=Approve;
                      PromotedCategory=Process }
      { 1000000009;1 ;Action    ;
                      CaptionML=ENU=Change Log Entries;
                      Image=History;
                      OnAction=VAR
                                 ChangeLogEntry@1000000000 : Record 405;
                                 ChangeLogMgt@1000000001 : Codeunit 423;
                               BEGIN
                                 ChangeLogs;
                               END;
                                }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1240020001;1 ;Action    ;
                      CaptionML=ENU=Reforecast Item;
                      Promoted=No;
                      Image=Replan;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 Reforecast@1240020001 : Codeunit 14000571;
                                 UpdateProcUnitLocFilters@1240020000 : Codeunit 14000581;
                               BEGIN
                                 CLEAR(UpdateProcUnitLocFilters);
                                 UpdateProcUnitLocFilters.ByLocation('',"Item No.");
                                 CurrPage.UPDATE(FALSE);
                                 CLEAR(Reforecast);
                                 Reforecast.ByItem("Item No.");
                                 CurrPage.UPDATE(FALSE);
                               END;
                                }
      { 1240020014;1 ;Action    ;
                      Name=CalcFillRate;
                      CaptionML=ENU=Calculate Fill Rate;
                      Image=AutofillQtyToHandle;
                      OnAction=VAR
                                 ProcUnit2@1240020000 : Record 14000555;
                               BEGIN
                                 ProcUnit2.SETFILTER("Location Code",Rec."Location Code");
                                 ProcUnit2.SETFILTER("Item No.",Rec."Item No.");
                                 ProcUnit2.SETFILTER("Variant Code", Rec."Variant Code");
                                 REPORT.RUNMODAL(REPORT::"Current Fill Rate",TRUE,FALSE,ProcUnit2);
                               END;
                                }
      { 1240020008;1 ;Action    ;
                      CaptionML=ENU=Count Procurement Units;
                      Image=Calculate;
                      OnAction=VAR
                                 locProcUnit@1240020000 : Record 14000555;
                               BEGIN
                                 locProcUnit.COPYFILTERS(Rec);
                                 UBP.CountProcUnitInFilter(locProcUnit,TRUE);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 2   ;2   ;Field     ;
                SourceExpr="Location Code" }

    { 4   ;2   ;Field     ;
                SourceExpr="Item No." }

    { 6   ;2   ;Field     ;
                SourceExpr="Variant Code";
                Visible=FALSE }

    { 1240030048;2;Field  ;
                SourceExpr=Review;
                Visible=FALSE }

    { 21  ;2   ;Field     ;
                SourceExpr=Description }

    { 1240030042;2;Field  ;
                SourceExpr="Variant Description";
                Visible=FALSE }

    { 1240030018;2;Field  ;
                Name=Qty. Expected;
                CaptionML=ENU=QtyExpected;
                DecimalPlaces=0:2;
                SourceExpr=CalcQtyExpected;
                Visible=QtyExpVisible }

    { 1240030028;2;Field  ;
                SourceExpr="Nonstock Unit" }

    { 1240020006;2;Field  ;
                SourceExpr="Usage Formula Status";
                Visible=FALSE;
                Editable=FALSE }

    { 1240020005;2;Field  ;
                SourceExpr="Replenishment Hierarchy";
                Visible=FALSE;
                Editable=FALSE }

    { 1240020004;2;Field  ;
                SourceExpr="Purchaser Code" }

    { 1240030026;2;Field  ;
                SourceExpr="Summarize Variant Detail";
                Visible=FALSE }

    { 1240030016;2;Field  ;
                SourceExpr="Preferred Variant";
                Visible=FALSE }

    { 1240020011;2;Field  ;
                SourceExpr="Fill Rate Percentage";
                Visible=FALSE }

    { 1240020013;2;Field  ;
                ToolTipML=ENU="The total demand as calculated by the fill rate configuration.  This field is used to filter to the procurement units with demand per the calculation.  ";
                SourceExpr="Fill Rate Total Demand";
                Visible=FALSE }

    { 1240020012;2;Field  ;
                SourceExpr="Fill Rate Calculation Date";
                Visible=FALSE }

    { 1240030045;2;Field  ;
                SourceExpr="Average Lead Time (Days)" }

    { 1000000000;2;Field  ;
                SourceExpr="Replenishment Source Type" }

    { 1000000002;2;Field  ;
                SourceExpr="Replenishment Source Code" }

    { 1240030020;2;Field  ;
                SourceExpr="Replenishment Model" }

    { 1240020019;2;Field  ;
                SourceExpr="Division Code";
                Visible=FALSE }

    { 1240030034;2;Field  ;
                SourceExpr="Safety Stock Calc. Method" }

    { 1240030036;2;Field  ;
                SourceExpr="Target Customer Service Level" }

    { 1240030032;2;Field  ;
                SourceExpr="Safety Stock Days" }

    { 1240030040;2;Field  ;
                SourceExpr="Purchase Unit of Measure" }

    { 1240030030;2;Field  ;
                SourceExpr="Order Qty. Method" }

    { 1240030022;2;Field  ;
                SourceExpr="Order Multiple" }

    { 1240030024;2;Field  ;
                SourceExpr="Order Minimum" }

    { 1240030038;2;Field  ;
                Name=Additional Stock Qty.;
                CaptionML=ENU=Additional Stock Quantity;
                DecimalPlaces=0:5;
                SourceExpr=CalcAdditionalStock;
                Visible=AdditionalStockVisible;
                Editable=FALSE }

    { 1000000008;2;Field  ;
                SourceExpr="Maximum Inventory";
                Visible=FALSE }

    { 1000000010;2;Field  ;
                SourceExpr="Minimum Inventory";
                Visible=FALSE }

    { 1000000006;2;Field  ;
                SourceExpr="Maximum Days Supply";
                Visible=FALSE }

    { 1000000004;2;Field  ;
                SourceExpr="Minimum Days Supply";
                Visible=FALSE }

    { 1240020016;2;Field  ;
                SourceExpr="Maximum Shelf Stock";
                Visible=FALSE }

    { 1240020000;2;Field  ;
                SourceExpr="Minimum Shelf Stock";
                Visible=FALSE }

    { 1240030010;2;Field  ;
                SourceExpr="Item Class Description";
                Visible=FALSE }

    { 1240030014;2;Field  ;
                SourceExpr="Ranking Code";
                Visible=FALSE }

    { 1240020017;2;Field  ;
                SourceExpr="Frozen Lead Time (Days)";
                Visible=FALSE }

    { 1240020018;2;Field  ;
                SourceExpr="Frozen Lead Time Expir. Date";
                Visible=FALSE }

    { 1000000005;2;Field  ;
                SourceExpr=Inventory }

    { 1000000001;2;Field  ;
                SourceExpr="Qty. on Purchase Order" }

    { 1000000003;2;Field  ;
                SourceExpr="Qty. on Sales Order" }

    { 3   ;0   ;Container ;
                ContainerType=FactBoxArea }

    { 1170000001;1;Part   ;
                Visible=TRUE;
                PartType=System;
                SystemPartID=Notes }

    { 5   ;1   ;Part      ;
                SubPageLink=Location Code=FIELD(Location Code),
                            Item No.=FIELD(Item No.),
                            Variant Code=FIELD(Variant Code);
                PagePartID=Page14097479;
                PartType=Page }

    { 1240020009;1;Part   ;
                CaptionML=ENU=Replenishment Alerts;
                SubPageLink=Location Code=FIELD(Location Code),
                            Item No.=FIELD(Item No.),
                            Variant Code=FIELD(Variant Code);
                PagePartID=Page14097459;
                PartType=Page;
                ShowFilter=No }

    { 7   ;1   ;Part      ;
                CaptionML=ENU=Item Usage;
                SubPageLink=Location Code=FIELD(Location Code),
                            Item No.=FIELD(Item No.),
                            Variant Code=FIELD(Variant Code);
                PagePartID=Page14097457;
                Visible=FALSE;
                PartType=Page;
                ShowFilter=No }

    { 1240020010;1;Part   ;
                SubPageView=SORTING(Level)
                            ORDER(Ascending);
                SubPageLink=Location Code=FIELD(Location Code),
                            Item No.=FIELD(Item No.),
                            Variant Code=FIELD(Variant Code);
                PagePartID=Page14000530;
                Visible=FALSE;
                PartType=Page;
                ShowFilter=No }

  }
  CODE
  {
    VAR
      UBP@1240030002 : Codeunit 14000564;
      QtyExpVisible@1240020003 : Boolean;
      SummaryVisible@1240020004 : Boolean;
      AdditionalStockVisible@1240020000 : Boolean;
      InvMgtSetup@1240020001 : Record 14000551;

    LOCAL PROCEDURE CalcQtyExpected@1240020000() : Decimal;
    VAR
      ProcUnit2@1240020000 : Record 14000555;
    BEGIN
      IF QtyExpVisible THEN BEGIN
        ProcUnit2.COPY(Rec);
        EXIT(ProcUnit2.QtyExpected);
      END;
    END;

    LOCAL PROCEDURE CalcAdditionalStock@1240020001() : Decimal;
    VAR
      ProcUnit2@1240020000 : Record 14000555;
    BEGIN
      IF AdditionalStockVisible THEN BEGIN
        ProcUnit2.COPY(Rec);
        ProcUnit2.SETFILTER("Location Filter", "Location Code");
        EXIT(ProcUnit2.AdditionalStockQty);
      END;
    END;

    LOCAL PROCEDURE ChangeLog@1000000001();
    VAR
      Codeunit423EventSubscriber@1000000000 : Codeunit 51876;
    BEGIN
      //TPZ2916
      Codeunit423EventSubscriber.CU423_OpenSSRSReport(DATABASE::"Procurement Unit", "Location Code", "Item No.","Variant Code");
    END;

    LOCAL PROCEDURE ChangeLogs@1000000000();
    VAR
      Codeunit423EventSubscriber@1000000000 : Codeunit 51876;
      ChangeLogEntry@1000000001 : Record 405;
    BEGIN
      Codeunit423EventSubscriber.CU423_OpenSSRSReport(DATABASE::"Procurement Unit", "Location Code", "Item No.","Variant Code");
      {
      ChangeLogEntry.RESET;
      ChangeLogEntry.SETRANGE("Table No.",DATABASE::"Procurement Unit");
      ChangeLogEntry.SETRANGE("Primary Key Field 1 Value","Location Code");
      ChangeLogEntry.SETRANGE("Primary Key Field 2 Value","Item No.");
      ChangeLogEntry.SETRANGE("Primary Key Field 3 Value","Variant Code");
      PAGE.RUNMODAL(PAGE::"Change Log Entries",ChangeLogEntry);
      }
    END;

    LOCAL PROCEDURE OnAfterGetCurrRecord@19077479();
    BEGIN
      //<TPZ2322>
      xRec := Rec;
      SETFILTER("Location Filter",UBP.GetLocationFilter(Rec,FALSE));
      SETFILTER("Prod. Order Status Filter",UBP.GetProductionStatusFilter);
      QtyExpected;
      //</TPZ2322>
    END;

    BEGIN
    END.
  }
}

