OBJECT Page 14050001 UPSlink Setup
{
  OBJECT-PROPERTIES
  {
    Date=02/25/19;
    Time=12:00:00 PM;
    Version List=SE0.61;
  }
  PROPERTIES
  {
    CaptionML=ENU=UPSlink Setup;
    SourceTable=Table14050001;
    PageType=Card;
    OnOpenPage=BEGIN
                 RESET;
                 FILTERGROUP(2);
                 SETRANGE("Primary Key",'');
                 FILTERGROUP(0);
                 IF NOT GET THEN BEGIN
                   INIT;
                   INSERT(TRUE);
                 END;
               END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 43      ;1   ;ActionGroup;
                      CaptionML=ENU=&Setup }
      { 45      ;2   ;Action    ;
                      CaptionML=ENU=&Zone;
                      RunObject=Page 14000766 }
      { 46      ;2   ;Action    ;
                      CaptionML=ENU=&Zone Chart;
                      RunObject=Page 14000763 }
      { 48      ;2   ;Action    ;
                      CaptionML=ENU=&Rates (Commercial);
                      RunObject=Page 14000764;
                      RunPageView=WHERE(Residential=FILTER(No)) }
      { 51      ;2   ;Action    ;
                      CaptionML=ENU=&Rates (Residential);
                      RunObject=Page 14000764;
                      RunPageView=WHERE(Residential=FILTER(Yes)) }
      { 1240020004;2 ;Action    ;
                      CaptionML=ENU=&Rates (List);
                      RunObject=Page 14050008;
                      RunPageView=WHERE(Residential=FILTER(No)) }
      { 1240020006;2 ;Action    ;
                      CaptionML=ENU=&Rates (List Residential);
                      RunObject=Page 14050008;
                      RunPageView=WHERE(Residential=FILTER(Yes)) }
      { 49      ;2   ;Action    ;
                      CaptionML=ENU=&Hundred Weight Rates (Commercial);
                      RunObject=Page 14000765;
                      RunPageView=WHERE(Residential=FILTER(No)) }
      { 52      ;2   ;Action    ;
                      CaptionML=ENU=&Hundred Weight Rates (Residential);
                      RunObject=Page 14000765;
                      RunPageView=WHERE(Residential=FILTER(Yes)) }
      { 1240020005;2 ;Action    ;
                      CaptionML=ENU=&Hundred Weight Rates (List);
                      RunObject=Page 14050009;
                      RunPageView=WHERE(Residential=FILTER(No)) }
      { 1240020007;2 ;Action    ;
                      CaptionML=ENU=&Hundred Weight Rates (List Residential);
                      RunObject=Page 14050009;
                      RunPageView=WHERE(Residential=FILTER(Yes)) }
      { 41      ;2   ;Action    ;
                      CaptionML=ENU=&Accessorial Charges;
                      RunObject=Page 14000767 }
      { 1240030004;2 ;Action    ;
                      CaptionML=ENU=Get Registry Commissioning Values from Workstation;
                      Visible=FALSE;
                      OnAction=BEGIN
                                 UPSlinkMgt.GetRegistryCommissioningValues;
                               END;
                                }
      { 14050605;2   ;Action    ;
                      CaptionML=ENU=&SE World Ease Addresses;
                      RunObject=Page 14050605 }
      { 1240020008;2 ;Action    ;
                      CaptionML=ENU=UPS World Ease &Ports of Entry;
                      RunObject=Page 14050604;
                      OnAction=BEGIN
                                 PAGE.RUN(PAGE::"SE World Ease Ports of Entry");
                               END;
                                }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 44      ;1   ;ActionGroup;
                      CaptionML=ENU=F&unctions }
      { 73      ;2   ;Action    ;
                      CaptionML=ENU=Open &Fuel Surcharge Web Site;
                      Promoted=Yes;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 UPSlinkFuelSurcharge@1240020000 : Record 14050022;
                               BEGIN
                                 IF UPPERCASE(FORMAT(TODAY,0,'<Weekday Text>')) IN ['MONDAY','TUESDAY','WEDNESDAY'] THEN
                                   HYPERLINK(UPSlinkFuelSurcharge.Current)
                                 ELSE
                                   HYPERLINK(UPSlinkFuelSurcharge.Previous);
                               END;
                                }
      { 141     ;2   ;Action    ;
                      CaptionML=ENU=UPSlink &Mail;
                      RunObject=Page 14050006;
                      Promoted=Yes;
                      PromotedCategory=Process }
      { 1240030026;2 ;ActionGroup;
                      CaptionML=ENU=Registration }
      { 1240030010;3 ;Action    ;
                      CaptionML=ENU=Read/Accept License Agreement;
                      OnAction=BEGIN
                                 CreateUPSlinkLicenseAgreement;
                               END;
                                }
      { 108     ;3   ;Action    ;
                      CaptionML=ENU=Communication &Setup;
                      OnAction=BEGIN
                                 UPSlinkMgt.CommunicationSetup;
                               END;
                                }
      { 109     ;3   ;Action    ;
                      CaptionML=ENU=&Commissioning;
                      OnAction=BEGIN
                                 UPSlinkMgt.Commissioning;
                                 CurrPage.UPDATE;
                               END;
                                }
      { 1240030000;3 ;Action    ;
                      CaptionML=ENU=Re-Commission;
                      OnAction=BEGIN
                                 UPSlinkMgt.ReCommission;
                                 CurrPage.UPDATE;
                               END;
                                }
      { 1240030054;2 ;Action    ;
                      CaptionML=ENU=Setup Additional Workstation;
                      OnAction=BEGIN
                                 UPSlinkMgt.SetRegistryCommissioningValues;
                                 UPSlinkMgt.CommunicationSetup;
                                 UPSlinkMgt.CreateUPSlinkWorkFIles;
                               END;
                                }
      { 1240020002;2 ;Action    ;
                      CaptionML=ENU=Check UPS Install;
                      OnAction=BEGIN
                                 CheckUPSSetup;
                               END;
                                }
      { 1240020013;2 ;Action    ;
                      CaptionML=ENU=UPS Rate Version;
                      OnAction=BEGIN
                                 MESSAGE(Text002, GetUPSRateVersion);
                               END;
                                }
      { 1240020009;2 ;ActionGroup;
                      CaptionML=ENU=UPS Debugging }
      { 1240020010;3 ;Action    ;
                      CaptionML=ENU=Debugging On;
                      OnAction=BEGIN
                                 UPSlinkDebugging(TRUE);
                               END;
                                }
      { 1240020011;3 ;Action    ;
                      CaptionML=ENU=Debugging Off;
                      OnAction=BEGIN
                                 UPSlinkDebugging(FALSE);
                               END;
                                }
      { 1240020001;2 ;Action    ;
                      CaptionML=ENU=Update UPSlink Software Version;
                      OnAction=BEGIN
                                 UPSlinkMgt.UpdateUPSlinkCommSoftwareVersion(TRUE,TRUE);
                               END;
                                }
      { 1240020014;2 ;Action    ;
                      CaptionML=ENU=Import UPS World Ease &Ports of Entry;
                      OnAction=BEGIN
                                 UPSlinkMgt.ImportPortOfEntryTable;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                CaptionML=ENU=General }

    { 2   ;2   ;Field     ;
                SourceExpr="Primary Account No." }

    { 8   ;2   ;Field     ;
                DecimalPlaces=0:2;
                SourceExpr="Air Fuel Surcharge";
                Editable=False }

    { 76  ;2   ;Field     ;
                DecimalPlaces=0:2;
                SourceExpr="Ground Fuel Surcharge";
                Editable=False }

    { 10  ;2   ;Field     ;
                SourceExpr="Surcharge Type" }

    { 1240030013;2;Field  ;
                SourceExpr="Manual Commercial Invoice" }

    { 1240030011;2;Field  ;
                SourceExpr="Online Address Validation";
                OnValidate=BEGIN
                             OnlineAddressValidationOnPush;
                           END;
                            }

    { 1240030015;2;Field  ;
                SourceExpr="Process Val. Resp. Upon Rcpt.";
                OnValidate=BEGIN
                             ProcessValRespUponRcptOnAfterV;
                           END;
                            }

    { 1240030017;2;Field  ;
                SourceExpr="Online Addr. Val. Result" }

    { 1240030021;2;Field  ;
                SourceExpr="Manually Apply Files Over 1M" }

    { 1240030050;2;Field  ;
                SourceExpr=Commissioned }

    { 1240030006;2;Field  ;
                SourceExpr="Mailbox ID" }

    { 1240030023;2;Field  ;
                SourceExpr="Set Registry Before OCX Call" }

    { 1240030005;2;Field  ;
                SourceExpr="UPSlink Integration" }

    { 1240030029;2;Field  ;
                SourceExpr=Demo }

    { 1240020003;2;Field  ;
                SourceExpr="Manually Read UPSlink Mail" }

    { 1900168601;1;Group  ;
                CaptionML=ENU=Primary Account }

    { 1240030030;2;Field  ;
                SourceExpr="Billing Company Name" }

    { 1240030032;2;Field  ;
                SourceExpr="Billing Address" }

    { 1240030034;2;Field  ;
                SourceExpr="Billing Address 2" }

    { 1240030036;2;Field  ;
                SourceExpr="Billing Address 3" }

    { 1240030038;2;Field  ;
                SourceExpr="Billing City" }

    { 1240030048;2;Field  ;
                SourceExpr="Billing State" }

    { 1240030046;2;Field  ;
                SourceExpr="Billing Zip Code" }

    { 1240030042;2;Field  ;
                SourceExpr="Billing UPS Country Code" }

    { 1240030044;2;Field  ;
                SourceExpr="Billing Phone" }

    { 1240030040;2;Field  ;
                SourceExpr="Billing Contact" }

    { 14050601;2;Field    ;
                SourceExpr="World Ease Nos." }

    { 1904195901;1;Group  ;
                CaptionML=ENU=Versions }

    { 1240030027;2;Field  ;
                SourceExpr="Manifest Version" }

    { 1240030002;2;Field  ;
                SourceExpr="Rate Version" }

    { 1240030008;2;Field  ;
                SourceExpr="PhoneList Version" }

    { 1240030052;2;Field  ;
                SourceExpr="ISC Alc. Bev. Serial No." }

    { 1240030001;2;Field  ;
                SourceExpr="WW Validation Data Version" }

    { 1240030055;2;Field  ;
                CaptionML=ENU=Comm. Inv. Removal Ctry Ver.;
                SourceExpr="Comm. Inv. Removal Ctry Ver." }

    { 1240020000;2;Field  ;
                SourceExpr="Terms and Conditions Version" }

    { 14050603;2;Field    ;
                SourceExpr="Port Of Entry Serial No." }

    { 1240020012;2;Field  ;
                SourceExpr="UPS Comm. Software Version" }

  }
  CODE
  {
    VAR
      UPSlinkMgt@1240030001 : Codeunit 14050002;
      Text001@1240020001 : TextConst 'ENU=UPS has discontinued this service.';
      Text002@1240020000 : TextConst 'ENU=Rate Version is %1.';

    LOCAL PROCEDURE ProcessValRespUponRcptOnAfterV@19007165();
    BEGIN
       IF "Process Val. Resp. Upon Rcpt." THEN BEGIN
         "Process Val. Resp. Upon Rcpt." := FALSE;
         MODIFY();
       END;

      MESSAGE(Text001);
    END;

    LOCAL PROCEDURE OnlineAddrValResultOnInputChan@19067295(VAR Text@19028590 : Text[1024]);
    BEGIN
      ERROR(Text001);
    END;

    LOCAL PROCEDURE OnlineAddressValidationOnPush@19021748();
    BEGIN
       IF "Online Address Validation" THEN BEGIN
         "Online Address Validation" := FALSE;
         MODIFY();
       END;

      MESSAGE(Text001);
    END;

    BEGIN
    {
      2015-03-24 TPZ535 VCHERNYA
        Billing State / ZIP Code caption for Billing State field has been removed
    }
    END.
  }
}

