OBJECT Page 23044302 IWX Calculate Plate Weight
{
  OBJECT-PROPERTIES
  {
    Date=04/25/19;
    Time=[ 1:31:49 PM];
    Version List=IWX2.4.7684.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Calculate Plate Weight;
               ESM=Calcular el peso de la placa;
               FRC=Calculer le poids de la plaque;
               ENC=Calculate Plate Weight];
    OnOpenPage=BEGIN
                 dWeight := 0;
                 dSheets := 1;
               END;

  }
  CONTROLS
  {
    { 1000000000;;Container;
                ContainerType=ContentArea }

    { 1000000001;1;Field  ;
                Name=fldNumberSheets;
                CaptionML=[ENU=Number of Sheets;
                           ESM=N£mero de hojas;
                           FRC=Nombre de feuilles;
                           ENC=Number of Sheets];
                ToolTipML=ENU=The number of items;
                SourceExpr=dSheets;
                OnValidate=BEGIN
                             calcWeight;
                           END;
                            }

    { 1000000002;1;Field  ;
                Name=fldLength;
                CaptionML=[ENU=Length (inches);
                           ESM=Longitud (Pulgadas);
                           FRC=Longueur (pouces);
                           ENC=Length (inches)];
                ToolTipML=ENU=The length of the item;
                SourceExpr=dLength;
                OnValidate=BEGIN
                             calcWeight;
                           END;
                            }

    { 1000000003;1;Field  ;
                Name=fldWidth;
                CaptionML=[ENU=Width (inches);
                           ESM=Ancho (pulgadas);
                           FRC=Largeur (pouces);
                           ENC=Width (inches)];
                ToolTipML=ENU=The width of the item;
                SourceExpr=dWidth;
                OnValidate=BEGIN
                             calcWeight;
                           END;
                            }

    { 1000000004;1;Field  ;
                Name=fldThickness;
                CaptionML=[ENU=Thickness (inches);
                           ESM=Espesor (Pulgadas);
                           FRC=paisseur (pouces);
                           ENC=Thickness (inches)];
                ToolTipML=ENU=The thickness of the item;
                SourceExpr=dThickness;
                OnValidate=BEGIN
                             calcWeight;
                           END;
                            }

    { 1000000005;1;Field  ;
                Name=fldResult;
                CaptionML=[ENU=Result (pounds);
                           ESM=Resultado (libras);
                           FRC=R‚sultat (livres);
                           ENC=Result (pounds)];
                ToolTipML=ENU=The resulting value;
                SourceExpr=dWeight;
                Editable=FALSE }

  }
  CODE
  {
    VAR
      dSheets@1000000004 : Decimal;
      dLength@1000000003 : Decimal;
      dWidth@1000000002 : Decimal;
      dThickness@1000000001 : Decimal;
      dWeight@1000000000 : Decimal;

    PROCEDURE setCountLine@1000000002(VAR lrecCountLine@1000000000 : Record 23044301);
    VAR
      lrecItem@1000000001 : Record 27;
    BEGIN
      IF lrecItem.GET(lrecCountLine."Item No.") THEN
        setThicknessByDesc(lrecItem.Description);
    END;

    PROCEDURE getQuantity@1000000000() : Decimal;
    BEGIN
      calcWeight;
      EXIT(dWeight);
    END;

    LOCAL PROCEDURE setThicknessByDesc@1000000001(sDesc@1000000000 : Text[30]);
    VAR
      lnPos@1000000001 : Integer;
      lnWidthPos@1000000002 : Integer;
    BEGIN
      // Parses the provided description to get the plate thickness, if possible

      IF COPYSTR(sDesc, 1, 1)='0' THEN BEGIN
       lnPos := STRPOS(sDesc, ' ');
       IF lnPos>1 THEN BEGIN
         // got thickness string, so try for number
         IF EVALUATE(dThickness, COPYSTR(sDesc, 1, lnPos-1)) THEN BEGIN
           // got thickness, now see if there's a width as well
           lnWidthPos := STRPOS(sDesc, ' X ');
           IF lnWidthPos>0 THEN BEGIN
             lnPos := STRPOS(COPYSTR(sDesc, lnWidthPos+3, 30), ' ');
             IF lnPos>0 THEN
               IF EVALUATE(dWidth, COPYSTR(sDesc, lnWidthPos+3, lnPos-1)) THEN ;
           END;//if widthpos
         END;//if thickness
       END;//if
      END;//if
    END;

    LOCAL PROCEDURE calcWeight@1000000021();
    BEGIN
      // calculates weight
      dWeight := ROUND(dSheets * dLength * dWidth * dThickness *0.283, 1);
    END;

    BEGIN
    {
      ************************
      Copyright Notice
      This objects content is copyright of Insight Works 2011.  All rights reserved.
      Any redistribution or reproduction of part or all of the contents in any form is prohibited.
      ************************
    }
    END.
  }
}

