OBJECT Page 14000855 Posted Bill of Ladings
{
  OBJECT-PROPERTIES
  {
    Date=02/25/19;
    Time=12:00:00 PM;
    Version List=SE0.61;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=ENU=Posted Bill of Ladings;
    SourceTable=Table14000822;
    SourceTableView=WHERE(Posted=CONST(Yes));
    PageType=List;
    CardPageID=Posted Bill of Lading;
    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 11      ;1   ;ActionGroup;
                      CaptionML=ENU=&Bill of Lading }
      { 1032    ;2   ;Action    ;
                      ShortCutKey=Ctrl+F7;
                      CaptionML=ENU=Information Lines;
                      RunObject=Page 14000838;
                      RunPageLink=Bill of Lading No.=FIELD(No.);
                      Image=Info }
      { 1028    ;2   ;Action    ;
                      CaptionML=ENU=Summary;
                      RunObject=Page 14000826;
                      RunPageLink=Bill of Lading No.=FIELD(No.),
                                  Bill of Lading Type=CONST(Standard);
                      Promoted=Yes;
                      Image=BOMVersions;
                      PromotedCategory=Process }
      { 1021    ;2   ;Action    ;
                      CaptionML=ENU=ASN Summary;
                      RunObject=Page 14000832;
                      RunPageLink=Bill of Lading No.=FIELD(No.),
                                  Bill of Lading Type=CONST("ASN (EDI)") }
      { 1033    ;2   ;Action    ;
                      CaptionML=ENU=Shipping Agent Options;
                      OnAction=BEGIN
                                 Shipping.ShowOptPageShipBillOfLading(Rec);
                               END;
                                }
      { 1026    ;2   ;Action    ;
                      CaptionML=ENU=E-&Mail List;
                      ToolTipML=ENU=Specifies a list of E-Mail Addresses associated to this record.;
                      OnAction=VAR
                                 EMailListEntry@1240030001 : Record 14000908;
                               BEGIN
                                 EMailListEntry.RESET;
                                 EMailListEntry.SETRANGE("Table ID",DATABASE::"Bill of Lading");
                                 EMailListEntry.SETRANGE(Code,"No.");
                                 CASE "Ship-to Type" OF
                                   "Ship-to Type"::Customer:
                                     PAGE.RUNMODAL(PAGE::"E-Mail List Entries",EMailListEntry);
                                   "Ship-to Type"::Vendor:
                                     PAGE.RUNMODAL(PAGE::"E-Mail List Entries (Edit)",EMailListEntry);
                                 END;
                               END;
                                }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1031    ;1   ;ActionGroup;
                      CaptionML=ENU=F&unctions }
      { 1024    ;2   ;Action    ;
                      CaptionML=ENU=Reopen Bill of Lading;
                      Image=ReOpen;
                      OnAction=BEGIN
                                 IF CONFIRM(Text001,FALSE,"No.") THEN
                                   BOLMgt.UnPostBillOfLading(Rec);
                               END;
                                }
      { 1102    ;2   ;Action    ;
                      CaptionML=ENU=Send E-Mail Notification;
                      Image=SendMail;
                      OnAction=VAR
                                 EMailMgt@1000000001 : Codeunit 14000903;
                               BEGIN
                                 TESTFIELD("E-Mail Notification Handled",FALSE);

                                 EMailMgt.SendBillOfLadingNotification(Rec,TRUE,FALSE);
                               END;
                                }
      { 1100    ;2   ;ActionGroup;
                      CaptionML=ENU=EDI;
                      Image=ElectronicDoc }
      { 1098    ;3   ;Action    ;
                      CaptionML=ENU=Send ASN;
                      OnAction=BEGIN
                                 TESTFIELD("EDI ASN",TRUE);
                                 TESTFIELD("EDI BSN",FALSE);
                                 TESTFIELD("Summary Released");
                                 TESTFIELD(Released,TRUE);
                                 IF "EDI ASN Generated" THEN
                                   IF NOT CONFIRM(Text002,FALSE,"EDI ASN Gen. Date") THEN
                                     EXIT;
                                 EDIIntegration.SendASN(Rec);
                               END;
                                }
      { 1099    ;3   ;Action    ;
                      CaptionML=ENU=Send BSN;
                      OnAction=BEGIN
                                 TESTFIELD("EDI ASN",TRUE);
                                 TESTFIELD("EDI BSN",TRUE);
                                 TESTFIELD("Summary Released");
                                 TESTFIELD(Released,TRUE);
                                 IF "EDI BSN Generated" THEN
                                   IF NOT CONFIRM(Text003,FALSE,"EDI BSN Gen. Date") THEN
                                     EXIT;
                                 EDIIntegration.SendBSN(Rec);
                               END;
                                }
      { 1101    ;3   ;Action    ;
                      CaptionML=ENU=Send Electronic BOL;
                      OnAction=BEGIN
                                 TESTFIELD("EDI Electronic BOL",TRUE);

                                 IF NOT Released THEN
                                   IF NOT CONFIRM(Text001) THEN
                                     EXIT
                                   ELSE
                                     BOLMgt.CloseBillOfLading(Rec,0);

                                 IF "EDI Electronic BOL Generated" THEN
                                   IF NOT CONFIRM(Text004,FALSE,"EDI Electronic BOL Gen. Date") THEN
                                     EXIT;

                                 EDIIntegration.SendElectronicBOL(Rec);
                               END;
                                }
      { 14000351;3   ;Action    ;
                      CaptionML=ENU=Trace;
                      ToolTipML=ENU=Select to review all records with the same 'EDI Internal Doc No.';
                      Promoted=Yes;
                      Image=Trace;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 EDITrace@14000351 : Page 14002386;
                               BEGIN
                                 CLEAR(EDITrace);
                                 EDITrace.SetDoc("EDI Internal Doc. No.");
                                 EDITrace.RUNMODAL;
                               END;
                                }
      { 1240030001;2 ;Action    ;
                      CaptionML=ENU=Track Shipment;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Track;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 StartTrackingBOL;
                               END;
                                }
      { 1240020000;2 ;Action    ;
                      Name=Combine Shipments;
                      CaptionML=ENU=Combine Shipments;
                      OnAction=VAR
                                 PackingRule@1240020000 : Record 14000715;
                               BEGIN
                                 PackingRule.GetPackingRule("Ship-to Type","Ship-to No.","Ship-to Code");
                                 PackingRule.TESTFIELD("Shipment Invoicing Required",FALSE);

                                 CombineShipments;
                               END;
                                }
      { 1086    ;2   ;Action    ;
                      CaptionML=ENU=Post Shipment Invoices;
                      ToolTipML=ENU=When run, a one-to-one relationship is established between the Posted Sales Shipment and the Posted Sales Invoice as this may be driven by an EDI Trade Partner.;
                      Image=Post;
                      OnAction=VAR
                                 SalesShipmentHeader@1240030001 : Record 110;
                                 PostShipmentInvoices@1240030002 : Report 14000720;
                               BEGIN
                                 SalesShipmentHeader.RESET;
                                 SalesShipmentHeader.SETCURRENTKEY("Bill of Lading No.");
                                 SalesShipmentHeader.SETRANGE("Bill of Lading No.","No.");

                                 CLEAR(PostShipmentInvoices);
                                 PostShipmentInvoices.SETTABLEVIEW(SalesShipmentHeader);
                                 PostShipmentInvoices.RUNMODAL;
                               END;
                                }
      { 1018    ;1   ;ActionGroup;
                      CaptionML=ENU=&Print }
      { 1090    ;2   ;Action    ;
                      CaptionML=ENU=Bill of Lading;
                      Image=PrintDocument;
                      OnAction=BEGIN
                                 BillOfLading := Rec;
                                 BillOfLading.SETRECFILTER;
                                 REPORT.RUNMODAL(REPORT::"Bill of Lading",TRUE,TRUE,BillOfLading);
                               END;
                                }
      { 1112    ;2   ;Action    ;
                      CaptionML=ENU=Bill of Lading Advanced;
                      Image=PrintDocument;
                      OnAction=BEGIN
                                 BillOfLading := Rec;
                                 BillOfLading.SETRECFILTER;
                                 REPORT.RUNMODAL(REPORT::"Bill of Lading Advanced",TRUE,TRUE,BillOfLading);
                               END;
                                }
      { 1034    ;2   ;Action    ;
                      CaptionML=ENU=Bill of Lading Info. Lines Advanced;
                      Promoted=Yes;
                      Image=PrintDocument;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 BillOfLading := Rec;
                                 BillOfLading.SETRECFILTER;
                                 REPORT.RUNMODAL(REPORT::"Bill of Lading Info. Lines Adv",TRUE,TRUE,BillOfLading);
                               END;
                                }
      { 1110    ;2   ;Action    ;
                      CaptionML=ENU=Bill of Lading Summary;
                      Image=PrintDocument;
                      OnAction=BEGIN
                                 BillOfLading := Rec;
                                 BillOfLading.SETRECFILTER;
                                 REPORT.RUNMODAL(REPORT::"Bill of Lading Summary",TRUE,TRUE,BillOfLading);
                               END;
                                }
      { 1111    ;2   ;Action    ;
                      CaptionML=ENU=Bill of Lading Summary ASN;
                      Image=PrintDocument;
                      OnAction=BEGIN
                                 BillOfLading := Rec;
                                 BillOfLading.SETRECFILTER;
                                 REPORT.RUNMODAL(REPORT::"Bill of Lading Summary ASN",TRUE,TRUE,BillOfLading);
                               END;
                                }
      { 1240030000;2 ;Action    ;
                      CaptionML=ENU=Bill of Lading &Label;
                      Image=PrintDocument;
                      OnAction=BEGIN
                                 PrintLabel;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 2   ;2   ;Field     ;
                SourceExpr="No." }

    { 29  ;2   ;Field     ;
                SourceExpr="Shipping Agent Code" }

    { 1000000000;2;Field  ;
                SourceExpr="EDI Internal Doc. No." }

    { 31  ;2   ;Field     ;
                SourceExpr="Shipping Agent Service" }

    { 27  ;2   ;Field     ;
                SourceExpr="Ship-to Type" }

    { 13  ;2   ;Field     ;
                SourceExpr="Ship-to No." }

    { 15  ;2   ;Field     ;
                SourceExpr="Ship-to Code" }

    { 4   ;2   ;Field     ;
                SourceExpr=Description }

    { 21  ;2   ;Field     ;
                SourceExpr="Packing Date";
                Visible=FALSE }

    { 19  ;2   ;Field     ;
                SourceExpr="External Tracking No.";
                Visible=FALSE }

    { 6   ;2   ;Field     ;
                SourceExpr=Released }

  }
  CODE
  {
    VAR
      Text001@1240030001 : TextConst 'ENU=Are you sure you will reopen the Bill of Lading %1?';
      Text002@1240030000 : TextConst 'ENU=ASN was generated on %1.  Do you want to send it again?';
      BillOfLading@1240030005 : Record 14000822;
      BOLMgt@1240030004 : Codeunit 14000821;
      EDIIntegration@1240030003 : Codeunit 14000363;
      Shipping@1240030002 : Codeunit 14000701;
      Text003@1240030009 : TextConst 'ENU=BSN was generated on %1.  Do you want to send it again?';
      Text004@1240020000 : TextConst 'ENU=EDI Electonic BOL was generated on %1. Do you want to re-create Electronic BOL?';

    BEGIN
    END.
  }
}

