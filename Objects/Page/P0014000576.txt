OBJECT Page 14000576 Suggested Order Subform
{
  OBJECT-PROPERTIES
  {
    Date=03/09/21;
    Time=[ 5:01:33 PM];
    Modified=Yes;
    Version List=UBP3.03.01,TPZ,TPZ2;
  }
  PROPERTIES
  {
    CaptionML=ENU=Suggested Order Subform;
    MultipleNewLines=Yes;
    LinksAllowed=No;
    SourceTable=Table14000566;
    DelayedInsert=Yes;
    PageType=ListPart;
    AutoSplitKey=Yes;
    OnOpenPage=BEGIN
                 InvMgtSetup.GET;
                 SummaryVisible := (InvMgtSetup."Summarize Variant Detail" <> InvMgtSetup."Summarize Variant Detail"::Never);
               END;

    OnAfterGetRecord=BEGIN
                       //>>TPZ2858
                       CLEAR(Item);
                       IF Item.GET("No.") THEN;
                       SetStyleABC;
                       DefaultDimension.RESET;
                       IF DefaultDimension.GET(27,"No.",'PRODLIFECYCLE')THEN BEGIN
                         IF DefaultDimension."Dimension Value Code" = 'INTRO' THEN
                           StyleTextABC := 'favorable'
                       END;
                       //Page14000576EventPublisher.PG14000576_OnAfterGetRecord(Rec,StyleTxt,Item);
                       //<<TPZ2858
                     END;

    OnNewRecord=BEGIN
                  IF "Document No." <> '' THEN BEGIN
                    "User Created Entry" := TRUE;
                    "Purchase Reason" := "Purchase Reason"::Manual;
                    Type := xRec.Type;
                    "Location Code" := xRec."Location Code";
                  END;
                END;

    OnInsertRecord=BEGIN
                     "User Created Entry" := TRUE;
                     "Purchase Reason" := "Purchase Reason"::Manual;
                   END;

    OnAfterGetCurrRecord=BEGIN
                           UserEditable := "User Created Entry";
                         END;

    ActionList=ACTIONS
    {
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1907935204;1 ;ActionGroup;
                      CaptionML=ENU=&Line }
      { 1902759604;2 ;Action    ;
                      CaptionML=ENU=&Calculation Lines;
                      ToolTipML=ENU=Detail of replenishment calculation;
                      Image=CalculateInvoiceDiscount;
                      OnAction=BEGIN
                                 ShowCalculationLines;
                               END;
                                }
      { 1903306604;2 ;Action    ;
                      CaptionML=ENU=&Location Inventory Roll Up;
                      Image=BOMVersions;
                      OnAction=BEGIN
                                 ShowLocInvRollUp;
                               END;
                                }
      { 1900495004;2 ;Action    ;
                      ShortCutKey=Shift+F11;
                      CaptionML=ENU=View &Forecast;
                      ToolTipML=ENU=Demand and supply plan;
                      Image=CalculateRegenerativePlan;
                      OnAction=BEGIN
                                 ShowForecast;
                               END;
                                }
      { 1901512604;2 ;Action    ;
                      CaptionML=ENU=Item;
                      Image=NewItem;
                      OnAction=BEGIN
                                 ShowItem;
                               END;
                                }
      { 1240020011;2 ;Action    ;
                      Name=PUCSummaryCard;
                      ShortCutKey=Shift+F7;
                      CaptionML=ENU=Summary Card;
                      Promoted=No;
                      Visible=SummaryVisible;
                      PromotedIsBig=No;
                      Image=TeamSales;
                      OnAction=VAR
                                 SumVarMsg@1240020000 : TextConst 'ENU=No summary procurement unit exists for Location %1 Item %2.';
                                 ProcUnit2@1240020001 : Record 14000555;
                               BEGIN
                                 TESTFIELD(Type, Type::Item);
                                 IF ProcUnit2.GET("Location Code", "No.", '') THEN
                                   PAGE.RUN(PAGE::"Procurement Unit Card Sum.",ProcUnit2)
                                 ELSE
                                   MESSAGE(STRSUBSTNO(SumVarMsg, "Location Code", "No."));
                               END;
                                }
      { 1901652404;2 ;Action    ;
                      ShortCutKey=Shift+F7;
                      CaptionML=ENU=&Procurement Unit;
                      ToolTipML=ENU=Procurement unit card;
                      Image=BankAccountRec;
                      OnAction=BEGIN
                                 ShowProcurementUnit;
                               END;
                                }
      { 1901941404;2 ;Action    ;
                      CaptionML=ENU=&Item Usage;
                      Image=ItemTrackingLedger;
                      OnAction=BEGIN
                                 ShowItemUsage;
                               END;
                                }
      { 1901313104;2 ;Action    ;
                      CaptionML=ENU=&Open Purchase Lines;
                      ToolTipML=ENU=Open purchase order quantities and dates;
                      Image=Purchase;
                      OnAction=BEGIN
                                 ShowPurchLines;
                               END;
                                }
      { 1901602204;2 ;Action    ;
                      CaptionML=ENU=&Replenishment Path;
                      Image=RoutingVersions;
                      OnAction=BEGIN
                                 ShowReplPath;
                               END;
                                }
      { 1903727004;2 ;Action    ;
                      CaptionML=ENU=Surplus;
                      ToolTipML=ENU=Detail of surplus available if any;
                      Image=ResourceCosts;
                      OnAction=BEGIN
                                 ShowSurplusAvailable;
                               END;
                                }
      { 1903387804;2 ;Action    ;
                      CaptionML=ENU=Alerts;
                      ToolTipML=ENU=Alert detail. Expected stockout, late PO, PO with surplus, Auto forecast adjust, Late production order.;
                      Image=Approve;
                      OnAction=BEGIN
                                 ShowAlert;
                               END;
                                }
      { 1903048604;2 ;Action    ;
                      CaptionML=ENU=Container;
                      Image=ResourcePlanning;
                      OnAction=BEGIN
                                 ShowContainer;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 2   ;2   ;Field     ;
                SourceExpr="No.";
                Editable=UserEditable }

    { 1000000001;2;Field  ;
                CaptionML=ENU=ABC Code;
                SourceExpr=Item."ABC Code";
                Editable=FALSE;
                StyleExpr=StyleTextABC }

    { 5   ;2   ;Field     ;
                SourceExpr=Type;
                Visible=FALSE }

    { 4   ;2   ;Field     ;
                ToolTipML=ENU=Specifies a location code for the warehouse or distribution center where your items are handled and stored before being sold.;
                SourceExpr="Location Code";
                Visible=FALSE;
                Editable=UserEditable }

    { 20  ;2   ;Field     ;
                SourceExpr="Purchase Reason" }

    { 1000000005;2;Field  ;
                SourceExpr="Usage Formula Status";
                Editable=FALSE }

    { 1000000000;2;Field  ;
                SourceExpr="Seasonal Purchase";
                Visible=FALSE }

    { 1240030000;2;Field  ;
                SourceExpr="Variant Code";
                Visible=FALSE }

    { 1240030014;2;Field  ;
                SourceExpr="Summarize Variant Detail";
                Visible=FALSE }

    { 6   ;2   ;Field     ;
                SourceExpr=Description;
                Editable=UserEditable }

    { 1240020003;2;Field  ;
                SourceExpr="Description 2";
                Visible=FALSE;
                Editable=UserEditable }

    { 1240020016;2;Field  ;
                SourceExpr="Vendor Item No.";
                Visible=FALSE }

    { 1000000003;2;Field  ;
                SourceExpr="Vendor Priority" }

    { 1240030002;2;Field  ;
                SourceExpr="Qty. Due In";
                Visible=FALSE }

    { 8   ;2   ;Field     ;
                Width=2;
                ToolTipML=ENU=Purchasing unit of measure;
                SourceExpr="Unit of Measure Code" }

    { 1240030004;2;Field  ;
                SourceExpr="Override Vendor No.";
                Visible=FALSE }

    { 1240020014;2;Field  ;
                SourceExpr="Auto-Forc. Adj. Warning";
                Visible=FALSE }

    { 1240020008;2;Field  ;
                SourceExpr="Critical Need" }

    { 1240020010;2;Field  ;
                SourceExpr="Critical Location";
                Visible=FALSE }

    { 3   ;2   ;Field     ;
                SourceExpr="Base Unit of Measure Code";
                Visible=FALSE;
                Editable=FALSE }

    { 10  ;2   ;Field     ;
                BlankZero=Yes;
                SourceExpr=Quantity;
                OnValidate=BEGIN
                             "Line Reviewed" := TRUE;
                           END;
                            }

    { 1240030022;2;Field  ;
                SourceExpr="Minimum Order Qty.";
                Visible=FALSE }

    { 1240030024;2;Field  ;
                SourceExpr="Maximum Order Qty.";
                Visible=FALSE }

    { 1240020004;2;Field  ;
                SourceExpr="EOQ Quantity";
                Visible=FALSE }

    { 1240020012;2;Field  ;
                SourceExpr="Quantity Less Transfer";
                Visible=FALSE }

    { 1240020013;2;Field  ;
                SourceExpr="Qty. (Base) from Redirects";
                Visible=FALSE }

    { 1240020001;2;Field  ;
                SourceExpr="Qty. (Base) Expiring Inv.";
                Visible=FALSE }

    { 1240020015;2;Field  ;
                SourceExpr="Horizon Date";
                Visible=FALSE }

    { 1240030036;2;Field  ;
                SourceExpr="Item Category Code";
                Visible=FALSE }

    { 1240030038;2;Field  ;
                SourceExpr="Review Code";
                Visible=FALSE }

    { 1240030040;2;Field  ;
                SourceExpr="Line Reviewed";
                Visible=FALSE }

    { 1240030028;2;Field  ;
                ToolTipML=ENU=Order multiple for suggested orders;
                SourceExpr="Order Multiple";
                Visible=FALSE }

    { 1240030030;2;Field  ;
                ToolTipML=ENU=Minimum order quantity;
                SourceExpr="Order Minimum";
                Visible=FALSE }

    { 1000000004;2;Field  ;
                BlankZero=Yes;
                SourceExpr="Qty. to Transfer (Base)";
                Visible=FALSE;
                OnDrillDown=BEGIN
                              ShowSurplusAvailable;
                            END;
                             }

    { 1000000006;2;Field  ;
                BlankZero=Yes;
                SourceExpr="Qty. Transferred (Base)";
                Visible=FALSE }

    { 1240020006;2;Field  ;
                SourceExpr="Replenishment Hierarchy";
                Visible=FALSE;
                Editable=FALSE }

    { 1240030026;2;Field  ;
                ToolTipML=ENU=Alert detail. Expected stockout, late PO, PO with surplus, Auto forecast adjust, Late production order.;
                SourceExpr=Alert;
                Visible=FALSE }

    { 1000000002;2;Field  ;
                ToolTipML=ENU=Detail of surplus available if any;
                SourceExpr="Surplus Available";
                Visible=FALSE;
                OnDrillDown=BEGIN
                              SurplusInventoryAvailablOnPush;
                            END;
                             }

    { 24  ;2   ;Field     ;
                SourceExpr="Purchase Line Exists";
                Visible=FALSE;
                Editable=FALSE }

    { 1240020002;2;Field  ;
                SourceExpr="Forecast Trend";
                Visible=FALSE;
                Editable=FALSE }

    { 12  ;2   ;Field     ;
                SourceExpr="Direct Unit Cost";
                Visible=FALSE;
                Editable=FALSE }

    { 14  ;2   ;Field     ;
                SourceExpr="Line Amount";
                Editable=FALSE }

    { 1240030010;2;Field  ;
                SourceExpr="Expected Receipt Date" }

    { 1240030012;2;Field  ;
                ToolTipML=ENU=Calculated average lead time based on purchase order receipts;
                SourceExpr="Average Lead Time (Days)";
                Visible=FALSE }

    { 16  ;2   ;Field     ;
                SourceExpr="Original Quantity";
                Visible=FALSE;
                Editable=FALSE }

    { 1240030008;2;Field  ;
                SourceExpr="Suggested Ave. Days Supply";
                Visible=FALSE;
                Editable=FALSE }

    { 22  ;2   ;Field     ;
                ToolTipML=ENU=Item class based on COGS or percentage of items;
                SourceExpr="Item Class Description";
                Visible=FALSE;
                Editable=FALSE }

    { 1240030006;2;Field  ;
                ToolTipML=ENU=Ranking code based on sales order 'hits';
                SourceExpr="Ranking Code";
                Visible=FALSE }

    { 1240020000;2;Field  ;
                SourceExpr="Periods With Sales";
                Visible=FALSE }

    { 18  ;2   ;Field     ;
                SourceExpr="Original Unit of Measure Code";
                Visible=FALSE;
                Editable=FALSE }

    { 1240030016;2;Field  ;
                SourceExpr="Line Net Weight";
                Visible=FALSE }

    { 1240030018;2;Field  ;
                SourceExpr="Line Gross Weight";
                Visible=FALSE }

    { 1240030020;2;Field  ;
                ToolTipML=ENU=Calcuated volume for this line;
                SourceExpr="Line Volume";
                Visible=FALSE }

    { 1240030032;2;Field  ;
                SourceExpr="Container Plan No.";
                Visible=FALSE }

    { 1240030034;2;Field  ;
                SourceExpr="Container No.";
                Visible=FALSE }

  }
  CODE
  {
    VAR
      InvMgtSetup@1240030000 : Record 14000551;
      UserEditable@1000 : Boolean;
      SummaryVisible@1240020000 : Boolean;
      Item@1000000002 : Record 27;
      Page14000576EventPublisher@1000000001 : Codeunit 51827;
      StyleTxt@1000000000 : Text;
      StyleTextABC@1000000003 : Text;
      DefaultDimension@1000000004 : Record 352;

    LOCAL PROCEDURE SurplusInventoryAvailablOnPush@19055338();
    BEGIN
      ShowSurplusAvailable;
    END;

    LOCAL PROCEDURE SetStyleABC@1000000019();
    VAR
      ItemABC@1000000000 : Record 27;
    BEGIN
      //>>RSAH
      StyleTextABC := '';
      ItemABC.RESET;
      IF ItemABC.GET("No.") THEN
        CASE ItemABC."ABC Code" OF
          'LS' : StyleTextABC := 'favorable';
          'N'  : StyleTextABC := 'Standard';
          'A'  : StyleTextABC := 'Standard';
          'B'  : StyleTextABC := 'Standard';
          'C'  : StyleTextABC := 'Standard';
          'MD' : StyleTextABC := 'Standard';
          'SO' : StyleTextABC := 'Standard';
          'CL' : StyleTextABC := 'Attention';
          'DI' : StyleTextABC := 'Ambiguous';
          'OB' : StyleTextABC := 'Strongaccent';
        END;
      //<<RSAH
    END;

    BEGIN
    {
      // LA
      // Added Quantity Base to Page
      2018-117-05 TPZ2323 DKUMAR
        Field Added Vendor Priority.
      TPZ2858 06022020 RSAH - Using ABC before the item is actually blocked - Added Factbox
    }
    END.
  }
}

