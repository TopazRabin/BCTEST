OBJECT Page 14099042 Assisted OWR Filter Setup Wiz.
{
  OBJECT-PROPERTIES
  {
    Date=08/21/18;
    Time=12:00:00 PM;
    Version List=RF1.50.13;
  }
  PROPERTIES
  {
    CaptionML=ENU=OWR Filter Code Setup;
    SourceTable=Table14002863;
    PageType=NavigatePage;
    SourceTableTemporary=Yes;
    OnInit=BEGIN
             LoadTopBanners;
           END;

    OnOpenPage=VAR
                 SMTPMailSetup@1000 : Record 409;
                 CompanyInformation@1001 : Record 79;
                 SMTPMail@1002 : Codeunit 400;
               BEGIN
                 INIT;

                 Step := Step::Start;
                 EnableControls;
               END;

    OnQueryClosePage=BEGIN
                       IF CloseAction = ACTION::OK THEN
                         IF OWRAssistedSetup.GetStatus(PAGE::"Assisted OWR Filter Setup Wiz.") = OWRAssistedSetup.Status::"Not Completed" THEN
                           IF NOT CONFIRM(NAVNotSetUpQst,FALSE) THEN
                             ERROR('');
                     END;

    ActionList=ACTIONS
    {
      { 10      ;    ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 15      ;1   ;Action    ;
                      Name=ActionBack;
                      CaptionML=ENU=Back;
                      ApplicationArea=#Basic,#Suite,#All;
                      Enabled=BackActionEnabled;
                      InFooterBar=Yes;
                      Image=PreviousRecord;
                      OnAction=BEGIN
                                 NextStep(TRUE);
                               END;
                                }
      { 14      ;1   ;Action    ;
                      Name=ActionNext;
                      CaptionML=ENU=Next;
                      ApplicationArea=#Basic,#Suite,#All;
                      Enabled=NextActionEnabled;
                      InFooterBar=Yes;
                      Image=NextRecord;
                      OnAction=BEGIN
                                 NextAction;

                                 NextStep(FALSE);
                               END;
                                }
      { 11      ;1   ;Action    ;
                      Name=ActionFinish;
                      CaptionML=ENU=Finish;
                      ApplicationArea=#Basic,#Suite,#All;
                      Enabled=FinishActionEnabled;
                      InFooterBar=Yes;
                      Image=Approve;
                      OnAction=BEGIN
                                 FinishAction;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1   ;0   ;Container ;
                ContainerType=ContentArea }

    { 96  ;1   ;Group     ;
                Name=UnfinishedBanner;
                Visible=TopBannerVisible AND NOT FinalStepVisible;
                Editable=FALSE;
                GroupType=Group }

    { 97  ;2   ;Field     ;
                Name=StandardMediaReference;
                ApplicationArea=#Basic,#Suite,#All;
                SourceExpr=MediaResourcesStandard."Media Reference";
                Editable=FALSE;
                ShowCaption=No }

    { 98  ;1   ;Group     ;
                Name=FinishedBanner;
                Visible=TopBannerVisible AND FinalStepVisible;
                Editable=FALSE;
                GroupType=Group }

    { 99  ;2   ;Field     ;
                Name=DoneMediaReference;
                ApplicationArea=#Basic,#Suite,#All;
                SourceExpr=MediaResourcesDone."Media Reference";
                Editable=FALSE;
                ShowCaption=No }

    { 20  ;1   ;Group     ;
                Name=FirstStep1;
                Visible=FirstStepVisible;
                GroupType=Group }

    { 13  ;2   ;Group     ;
                Name=Welcome;
                CaptionML=ENU=Welcome to the OWR Filter Code Setup;
                Visible=FirstStepVisible;
                GroupType=Group }

    { 18  ;3   ;Group     ;
                GroupType=Group;
                InstructionalTextML=ENU=This setup wizard will walk through the creation of Outbound Warehouse Request Filter Codes. OWR Filter Codes are used to quickly apply common filters and screen options to the Outbound Warehouse Request screen. }

    { 33  ;2   ;Group     ;
                GroupType=Group }

    { 27  ;3   ;Group     ;
                GroupType=Group;
                InstructionalTextML=ENU=" " }

    { 21  ;2   ;Group     ;
                GroupType=Group }

    { 22  ;3   ;Group     ;
                GroupType=Group;
                InstructionalTextML=ENU=Choose Next to begin the setup. }

    { 2   ;1   ;Group     ;
                Name=CreateOWRFilterCode;
                Visible=EnableStepVisible;
                GroupType=Group;
                InstructionalTextML=ENU=Create the OWR Employee Setup Code. }

    { 3   ;2   ;Field     ;
                Name=OWR Filter Code;
                CaptionML=ENU=OWR Filter Code;
                ToolTipML=ENU=This code should represent the preset Outbound Warehouse Request filter options being applied.;
                ApplicationArea=#All;
                SourceExpr=OWRFilterCode;
                OnValidate=VAR
                             OWRFilter@1000 : Record 14002863;
                           BEGIN
                             IF OWRFilter.GET(OWRFilterCode) THEN
                               IF CONFIRM(ConfirmOWRFilterDelete,FALSE) THEN
                                 OWRFilter.DELETE(TRUE)
                               ELSE
                                 ERROR(ErrorOWRFilterCodeExists);

                             INIT;
                             Code := OWRFilterCode;
                             IF NOT INSERT THEN MODIFY;
                           END;
                            }

    { 34  ;2   ;Field     ;
                Name=OWR Filter Code Description;
                CaptionML=ENU=OWR Filter Code Description;
                ToolTipML=ENU=This is the long description for the Outbound Warehouse Request Filter Code.;
                ApplicationArea=#All;
                SourceExpr=OWRFilterDescription;
                OnValidate=BEGIN
                             Description := OWRFilterDescription;
                             MODIFY;
                           END;
                            }

    { 12  ;1   ;Group     ;
                Name=GeneralStep;
                Visible=GeneralStepVisible;
                GroupType=Group;
                InstructionalTextML=ENU=General Tab setup. }

    { 28  ;2   ;Field     ;
                Name=Shipping Advice Handling;
                CaptionML=ENU=Shipping Advice Handling;
                ToolTipML=ENU=This will set the option on the Options Fast Tab on the Outbound Warehouse Request screen. This defines how the Shipping Advice from the order will be handled when using Create Pick. The options are: Blank - Shipping Advice is not considered, "Use Shipping Advice" - the Shipping Advice on the order is considered, "All Available" - requires all items to be available regardless of the Shipping Advice, and "Partial On Complete" - allows picks to be generated for orders with Shipping Advice set to Complete with the expectation that the rest of the inventory will picked before posting.;
                ApplicationArea=#All;
                SourceExpr="Shipping Advice Handling" }

    { 30  ;2   ;Field     ;
                Name=Sorting Method for Act. Lines;
                CaptionML=ENU=Sorting Method for Act. Lines;
                ToolTipML=ENU=This will set the option on the Pick Fast Tab on the Outbound Warehouse Request screen. Specifies the Sorting Method to be applied to the Warehouse Activity Lines. This only impacts pick documents printed from the NAV Client.;
                ApplicationArea=#All;
                SourceExpr="Sorting Method for Act. Lines" }

    { 31  ;2   ;Field     ;
                Name=Set Breakbulk Filter;
                CaptionML=ENU=Set Breakbulk Filter;
                ToolTipML=ENU=This will set the option on the Pick Fast Tab on the Outbound Warehouse Request screen. This sets the standard NAV "Breakbulk Filter" boolean on the Warehouse Activity, and executes the standard NAV process associated with this setting. This will prevent the intermediate Take and Place Breakbulk lines from appearing on the Warehouse Pick. However, this setting only works when the larger unit of measure being broken on the Take line is fully handled. Otherwise, the intermediate Breakbulk lines will still appear.;
                ApplicationArea=#All;
                SourceExpr="Set Breakbulk Filter" }

    { 32  ;2   ;Field     ;
                Name=Print Document;
                CaptionML=ENU=Print Document;
                ToolTipML=ENU=This will set the option on the Pick Fast Tab on the Outbound Warehouse Request screen. Specifies that the Pick Document is to be printed when selecting Create Pick.;
                ApplicationArea=#All;
                SourceExpr="Print Document" }

    { 35  ;2   ;Field     ;
                Name=Do Not Fill Qty. to Handle;
                CaptionML=ENU=Do Not Fill Qty. to Handle;
                ToolTipML=ENU=This will set the option on the Pick Fast Tab on the Outbound Warehouse Request screen. Specifies that the "Qty. to Handle" fields on the Take and Place lines of the pick document will get set to zero, which requires them to be manually filled in before registering the pick. This is a standard NAV setting that only applies to users interacting with Warehouse Picks directly from the NAV client.;
                ApplicationArea=#All;
                SourceExpr="Do Not Fill Qty. to Handle" }

    { 36  ;2   ;Field     ;
                Name=Per Zone;
                CaptionML=ENU=Per Zone;
                ToolTipML=ENU=This will set the option on the Pick Fast Tab on the Outbound Warehouse Request screen. When using Create Pick, this specifies that a separate pick will get generated for each Zone where inventory is allocated for the shipment.;
                ApplicationArea=#All;
                SourceExpr="Per Zone";
                Visible=FALSE }

    { 37  ;2   ;Field     ;
                Name=Only Pick from Wave Pick Bin;
                CaptionML=ENU=Only Pick from Wave Pick Bin;
                ToolTipML=ENU=This will set the option on the Pick Fast Tab on the Outbound Warehouse Request screen. This option only applies to Wave Picks and has no influence over any other type of pick. This automatically sets the Pick-From Bin Filter to the Wave Pick Bin when creating the Wave Pick.;
                ApplicationArea=#All;
                SourceExpr="Only Pick from Wave Pick Bin";
                Visible=FALSE }

    { 38  ;2   ;Field     ;
                Name=Wave Pick Check Cust Blocked;
                CaptionML=ENU=Wave Pick Check Cust Blocked;
                ToolTipML=ENU=This will set the option on the Pick Fast Tab on the Outbound Warehouse Request screen. This will cause a check to be performed when the initial Internal Wave Pick is initiated. If the customer is blocked, then the initial Wave Pick will fail to generate and an error will get displayed.;
                ApplicationArea=#All;
                SourceExpr="Wave Pick Check Cust Blocked";
                Visible=FALSE }

    { 4   ;1   ;Group     ;
                Name=TableFilterStep;
                Visible=TableFilterStepVisible;
                GroupType=Group }

    { 39  ;2   ;Field     ;
                Name=Location Code;
                CaptionML=ENU=Location Code;
                ToolTipML=ENU=This will filter the Warehouse Request table results based on the Location Code.;
                ApplicationArea=#All;
                SourceExpr="Location Code" }

    { 40  ;2   ;Field     ;
                Name=Order Source Type Filter;
                CaptionML=ENU=Order Source Type Filter;
                ToolTipML=ENU=This will filter the Warehouse Request table results based on the Source Type. Leaving this value set to All types will not apply a Source Type filter.;
                ApplicationArea=#All;
                SourceExpr=OrderSourceType;
                OnValidate=BEGIN
                             CASE OrderSourceType OF
                               OrderSourceType::"All Types":
                                 VALIDATE("Source Type Filter",0);
                               OrderSourceType::"Sales Order":
                                 VALIDATE("Source Type Filter",37);
                               OrderSourceType::"Purchase Return Order":
                                 VALIDATE("Source Type Filter",39);
                               OrderSourceType::"Transfer Order":
                                 VALIDATE("Source Type Filter",5741);
                             END;
                           END;
                            }

    { 41  ;2   ;Field     ;
                Name=Document Status Filter;
                CaptionML=ENU=Document Status Filter;
                ToolTipML=ENU=This will filter the Warehouse Request table results based on the Document Status. Leaving this value set to All will not apply a Document Status filter.;
                ApplicationArea=#All;
                SourceExpr="Document Status Filter" }

    { 44  ;2   ;Field     ;
                Name=Shipping Advice Filter;
                CaptionML=ENU=Shipping Advice Filter;
                ToolTipML=ENU=This will filter the Warehouse Request table results based on the Shipping Advice. Leaving this value set to All will not apply a Shipping Advice filter.;
                ApplicationArea=#All;
                SourceExpr="Shipping Advice Filter" }

    { 52  ;2   ;Field     ;
                Name=EDI Order Filter;
                CaptionML=ENU=EDI Order Filter;
                ToolTipML=ENU=This will filter the Warehouse Request table results based on the EDI Order. Leaving this value set to All will not apply an EDI Order filter.;
                ApplicationArea=#All;
                SourceExpr="EDI Order Filter";
                Visible=FALSE }

    { 51  ;2   ;Field     ;
                Name=ATO Pick Required Filter;
                CaptionML=ENU=ATO Pick Required Filter;
                ToolTipML=ENU=This will filter the Warehouse Request table results based on the Assemble-to-Order (ATO) Pick Required. Leaving this value set to All will not apply an ATO Pick Required filter.;
                ApplicationArea=#All;
                SourceExpr="ATO Pick Required Filter" }

    { 45  ;2   ;Field     ;
                Name=Destination No. Filter;
                CaptionML=ENU=Destination No. Filter;
                ToolTipML=ENU=This will filter the Warehouse Request table results based on the Destination No. The Destination No. will be the Customer No. for Sales Orders.;
                ApplicationArea=#All;
                SourceExpr="Destination No. Filter" }

    { 42  ;2   ;Field     ;
                Name=Shipment Method Code Filter;
                CaptionML=ENU=Shipment Method Code Filter;
                ToolTipML=ENU=This will filter the Warehouse Request table results based on the Shipment Method Code.;
                ApplicationArea=#All;
                SourceExpr="Shipment Method Code Filter" }

    { 43  ;2   ;Field     ;
                Name=Shipping Agent Code Filter;
                CaptionML=ENU=Shipping Agent Code Filter;
                ToolTipML=ENU=This will filter the Warehouse Request table results based on the Shipping Agent Code.;
                ApplicationArea=#All;
                SourceExpr="Shipping Agent Code Filter" }

    { 53  ;2   ;Field     ;
                Name=E-Ship Agent Service Filter;
                CaptionML=ENU=E-Ship Agent Service Filter;
                ToolTipML=ENU=This will filter the Warehouse Request table results based on the E-Ship Service Agent. This requires that the E-Ship Service Agent field is getting populated in Warehouse Request, which is set by checking the Copy EShip fields to OWR in RF/OWR Setup.;
                ApplicationArea=#All;
                SourceExpr="E-Ship Agent Service Filter";
                Visible=FALSE }

    { 46  ;2   ;Field     ;
                Name=Action Code Filter;
                CaptionML=ENU=Action Code Filter;
                ToolTipML=ENU=This will filter the Warehouse Request table results based on the Action Code.;
                ApplicationArea=#All;
                SourceExpr="Action Code Filter" }

    { 47  ;2   ;Field     ;
                Name=Action Responsible Filter;
                CaptionML=ENU=Action Responsible Filter;
                ToolTipML=ENU=This will filter the Warehouse Request table results based on the Action Responsible.;
                ApplicationArea=#All;
                SourceExpr="Action Responsible Filter" }

    { 49  ;2   ;Field     ;
                Name=From Shipment Date Filter;
                CaptionML=ENU=From Shipment Date Filter;
                ToolTipML=ENU=This is the From Date Shipment Date Filter (i.e. 4D, 2W, 1M). Leave this blank for no From Date date filter.;
                ApplicationArea=#All;
                SourceExpr="From Shipment Date Filter" }

    { 50  ;2   ;Field     ;
                Name=To Shipment Date Filter;
                CaptionML=ENU=To Shipment Date Filter;
                ToolTipML=ENU=This is the To Date Shipment Date Filter (i.e. 4D, 2W, 1M). Leave this blank for no To Date date filter.;
                ApplicationArea=#All;
                SourceExpr="To Shipment Date Filter" }

    { 48  ;2   ;Field     ;
                Name=Shipment Date Filter;
                CaptionML=ENU=Shipment Date Filter;
                ToolTipML=ENU=This is the date filter range that will get set based on the Shipment Date From Filter and the Shipment Date To Filter fields. This will set the Shipment Date table filter on the Outbound Warehouse Request screen.;
                ApplicationArea=#All;
                SourceExpr="Shipment Date Filter";
                Editable=FALSE }

    { 16  ;1   ;Group     ;
                Name=PickFilterStep;
                Visible=PickFilterStepVisible;
                GroupType=Group }

    { 54  ;2   ;Field     ;
                Name=Pick-from Zone Filter;
                CaptionML=ENU=Pick-from Zone Filter;
                ToolTipML=ENU=This will set the option on the Filters Fast Tab on the Outbound Warehouse Request screen. The Zone filter entered in this field restricts the pick generation to this zone (or zones) to this filter only. This filter can also be used to exclude zones.;
                ApplicationArea=#All;
                SourceExpr="Pick-from Zone Filter";
                Visible=FALSE }

    { 55  ;2   ;Field     ;
                Name=Pick-from Bin Filter;
                CaptionML=ENU=Pick-from Bin Filter;
                ToolTipML=ENU=This will set the option on the Filters Fast Tab on the Outbound Warehouse Request screen. The Bin filter entered in this field restricts the pick generation to this bin (or bins) to this filter only. This filter can also be used to exclude bins.;
                ApplicationArea=#All;
                SourceExpr="Pick-from Bin Filter";
                Visible=FALSE }

    { 56  ;2   ;Field     ;
                Name=Line Date From Filter;
                CaptionML=ENU=Line Date From Filter;
                ToolTipML=ENU=This is the From Date Line Date Filter (i.e. 4D, 2W, 1M). Leave this blank for no From Date date filter.;
                ApplicationArea=#All;
                SourceExpr="Line Date From Filter" }

    { 57  ;2   ;Field     ;
                Name=Line Date To Filter;
                CaptionML=ENU=Line Date To Filter;
                ToolTipML=ENU=This is the To Date Line Date Filter (i.e. 4D, 2W, 1M). Leave this blank for no To Date date filter.;
                ApplicationArea=#All;
                SourceExpr="Line Date To Filter" }

    { 58  ;2   ;Field     ;
                Name=Line Date Filter;
                CaptionML=ENU=Line Date Filter;
                ToolTipML=ENU=This is the date filter range that will get set based on the Line Date From Filter and the Line Date To Filter fields. This will set the Line Date Filter on the Filters Fast Tab on the Outbound Warehouse Request screen.;
                ApplicationArea=#All;
                SourceExpr="Line Date Filter" }

    { 19  ;1   ;Group     ;
                Name=WhseActGroupStep;
                Visible=WhseActGroupStepVisible;
                GroupType=Group }

    { 62  ;2   ;Field     ;
                Name=No. of Picks to create;
                CaptionML=ENU=No. of Picks to create;
                ToolTipML=ENU=This will set the option on the Whse. Activity Group Fast Tab on the Outbound Warehouse Request screen. The number in this field represents the number of picks that should be created in the opposite order of the priority value. Picks are created for orders with the highest priority first. This number only works when using Create Next Prioritized Pick.;
                ApplicationArea=#All;
                SourceExpr="No. of Picks to create" }

    { 59  ;2   ;Field     ;
                Name=Warehouse Activity Group Size;
                CaptionML=ENU=Warehouse Activity Group Size;
                ToolTipML=ENU=This will set the option on the Whse. Activity Group Fast Tab on the Outbound Warehouse Request screen. The number in this field represents the number of orders to be included in a Warehouse Batch. A Warehouse Batch can be created to group Picks or Shipments. If this numbers is zero, then all orders will be grouped into one Warehouse Batch. This number only works when using Create Pick.;
                ApplicationArea=#All;
                SourceExpr="Warehouse Activity Group Size" }

    { 60  ;2   ;Field     ;
                Name=Combine Picks Whse. Act. Group;
                CaptionML=ENU=Combine Picks Whse. Act. Group;
                ToolTipML=ENU=This will set the option on the Whse. Activity Group Fast Tab on the Outbound Warehouse Request screen. A checkmark in this field allows for multiple orders to be included in one pick.;
                ApplicationArea=#All;
                SourceExpr="Combine Picks Whse. Act. Group" }

    { 61  ;2   ;Field     ;
                Name=Combine Shipments WhseActGroup;
                CaptionML=ENU=Combine Shipments WhseActGroup;
                ToolTipML=ENU=This will set the option on the Whse. Activity Group Fast Tab on the Outbound Warehouse Request screen. A checkmark in this field allows for multiple orders to be included in one shipment.;
                ApplicationArea=#All;
                SourceExpr="Combine Shipments WhseActGroup" }

    { 23  ;1   ;Group     ;
                Name=LimitStep;
                Visible=LimitStepVisible;
                GroupType=Group }

    { 63  ;2   ;Field     ;
                Name=Minimum Avail. Amount;
                CaptionML=ENU=Minimum Avail. Amount;
                ToolTipML=ENU=Specifies the minimum amount limit.;
                ApplicationArea=#All;
                SourceExpr="Minimum Avail. Amount" }

    { 64  ;2   ;Field     ;
                Name=Maximum Avail. Amount;
                CaptionML=ENU=Maximum Avail. Amount;
                ToolTipML=ENU=Specifies the maximum available amount limit.;
                ApplicationArea=#All;
                SourceExpr="Maximum Avail. Amount" }

    { 71  ;2   ;Field     ;
                Name=Minimum Outst. No. of Lines;
                CaptionML=ENU=Minimum Outst. No. of Lines;
                ToolTipML=ENU=Specifies the minimum outstanding number of lines limit.;
                ApplicationArea=#All;
                SourceExpr="Minimum Outst. No. of Lines" }

    { 72  ;2   ;Field     ;
                Name=Maximum Outst. No. of Lines;
                CaptionML=ENU=Maximum Outst. No. of Lines;
                ToolTipML=ENU=Specifies the maximum outstanding number of lines limit.;
                ApplicationArea=#All;
                SourceExpr="Maximum Outst. No. of Lines" }

    { 73  ;2   ;Field     ;
                Name=Minimum Avail. Qty. (Base);
                CaptionML=ENU=Minimum Avail. Qty. (Base);
                ToolTipML=ENU=Specifies the minimum available quantity base limit.;
                ApplicationArea=#All;
                SourceExpr="Minimum Avail. Qty. (Base)" }

    { 74  ;2   ;Field     ;
                Name=Maximum Avail. Qty. (Base);
                CaptionML=ENU=Maximum Avail. Qty. (Base);
                ToolTipML=ENU=Specifies the maximum available quantity base limit.;
                ApplicationArea=#All;
                SourceExpr="Maximum Avail. Qty. (Base)" }

    { 65  ;2   ;Field     ;
                Name=Minimum Avail. Net Weight;
                CaptionML=ENU=Minimum Avail. Net Weight;
                ToolTipML=ENU=Specifies the minimum available net weight of lines limit.;
                ApplicationArea=#All;
                SourceExpr="Minimum Avail. Net Weight" }

    { 66  ;2   ;Field     ;
                Name=Maximum Avail. Net Weight;
                CaptionML=ENU=Maximum Avail. Net Weight;
                ToolTipML=ENU=Specifies the maximum available net weight of lines limit.;
                ApplicationArea=#All;
                SourceExpr="Maximum Avail. Net Weight" }

    { 67  ;2   ;Field     ;
                Name=Minimum Avail. Gross Weight;
                CaptionML=ENU=Minimum Avail. Gross Weight;
                ToolTipML=ENU=Specifies the minimum available net weight of lines limit.;
                ApplicationArea=#All;
                SourceExpr="Minimum Avail. Gross Weight" }

    { 68  ;2   ;Field     ;
                Name=Maximum Avail. Gross Weight;
                CaptionML=ENU=Maximum Avail. Gross Weight;
                ToolTipML=ENU=Specifies the maximum available net weight of lines limit.;
                ApplicationArea=#All;
                SourceExpr="Maximum Avail. Gross Weight" }

    { 69  ;2   ;Field     ;
                Name=Minimum Avail. Volume;
                CaptionML=ENU=Minimum Avail. Volume;
                ToolTipML=ENU=Specifies the minimum available volume limit.;
                ApplicationArea=#All;
                SourceExpr="Minimum Avail. Volume" }

    { 70  ;2   ;Field     ;
                Name=Maximum Avail. Volume;
                CaptionML=ENU=Maximum Avail. Volume;
                ToolTipML=ENU=Specifies the maximum available volume limit.;
                ApplicationArea=#All;
                SourceExpr="Maximum Avail. Volume" }

    { 29  ;1   ;Group     ;
                Name=ConfirmStep;
                Visible=ConfirmStepVisible;
                GroupType=Group }

    { 26  ;2   ;Group     ;
                Name=ConfirmOWRFilterCode;
                CaptionML=ENU=Confirm;
                Visible=ConfirmStepVisible;
                GroupType=Group;
                InstructionalTextML=ENU=Confirm the creation of this Outbound Warehouse Request Filter Code. }

    { 5   ;3   ;Field     ;
                Name=Confirm OWR Filter Code;
                CaptionML=ENU=Confirm OWR Filter Code;
                ToolTipML=ENU=Confirm OWR Employee Code creation.;
                ApplicationArea=#All;
                SourceExpr=ConfirmCodeCreation;
                OnValidate=VAR
                             OWRFilter@1000 : Record 14002863;
                           BEGIN
                             IF ConfirmCodeCreation THEN BEGIN
                               CLEAR(OWRFilter);
                               OWRFilter.INIT;
                               OWRFilter := Rec;
                               IF NOT OWRFilter.INSERT(TRUE) THEN
                                 OWRFilter.MODIFY(TRUE);

                               MESSAGE(STRSUBSTNO(MessageOWRFilterCodeCreated,OWRFilterCode));
                             END;
                           END;
                            }

    { 8   ;1   ;Group     ;
                Name=AdditionalStep;
                Visible=AdditionalStepVisible;
                GroupType=Group }

    { 7   ;2   ;Group     ;
                Name=AdditionalOWRFilterCode;
                CaptionML=ENU=Additional OWR Filter Codes;
                Visible=AdditionalStepVisible;
                GroupType=Group;
                InstructionalTextML=ENU=Do you wish to create an additional OWR Filter Code? }

    { 6   ;3   ;Field     ;
                Name=YesCode;
                CaptionML=ENU=Yes;
                ToolTipML=ENU=Choose Yes to create another OWR Filter Code.;
                ApplicationArea=#All;
                SourceExpr=YesCode;
                OnValidate=VAR
                             RFEmployeeSetup@1000 : Record 14002802;
                             RFSetup@1001 : Record 14002801;
                             WhseEmployee@1002 : Record 7301;
                           BEGIN
                             NoCode := FALSE;
                             YesCode := TRUE;
                           END;
                            }

    { 9   ;3   ;Field     ;
                Name=NoCode;
                CaptionML=ENU=No;
                ToolTipML=ENU=Choose No to move onto the next step.;
                ApplicationArea=#All;
                SourceExpr=NoCode;
                OnValidate=BEGIN
                             YesCode := FALSE;
                             NoCode := TRUE;
                           END;
                            }

    { 17  ;1   ;Group     ;
                Name=FinalStep;
                Visible=FinalStepVisible;
                GroupType=Group }

    { 24  ;2   ;Group     ;
                Name=EndSetup;
                CaptionML=ENU=That's it!;
                GroupType=Group }

    { 25  ;3   ;Group     ;
                Name=ChooseFinish;
                GroupType=Group;
                InstructionalTextML=ENU=To finalize this Outbound Warehouse Request configuration, choose Finish. }

  }
  CODE
  {
    VAR
      OWRAssistedSetup@1005 : Record 14099040;
      MediaRepositoryStandard@1040 : Record 9400;
      MediaRepositoryDone@1041 : Record 9400;
      MediaResourcesStandard@1018 : Record 2000000182;
      MediaResourcesDone@1016 : Record 2000000182;
      ClientTypeManagement@1019 : Codeunit 4;
      Step@1012 : 'Start,Enable,General,TableFilter,PickFilter,WhseActGroup,Limits,Confirm,Additional,Finish';
      OrderSourceType@1035 : 'All Types,Sales Order,Purchase Return Order,Transfer Order';
      TopBannerVisible@1042 : Boolean;
      FirstStepVisible@1000 : Boolean;
      EnableStepVisible@1010 : Boolean;
      GeneralStepVisible@1011 : Boolean;
      TableFilterStepVisible@1020 : Boolean;
      PickFilterStepVisible@1022 : Boolean;
      WhseActGroupStepVisible@1023 : Boolean;
      LimitStepVisible@1024 : Boolean;
      ConfirmStepVisible@1033 : Boolean;
      AdditionalStepVisible@1026 : Boolean;
      AdvancedSettingsVisible@1003 : Boolean;
      FinalStepVisible@1015 : Boolean;
      FinishActionEnabled@1009 : Boolean;
      BackActionEnabled@1013 : Boolean;
      NextActionEnabled@1014 : Boolean;
      NAVNotSetUpQst@1004 : TextConst 'ENU=Outbound Warehouse Request has not been set up.\\Are you sure you want to exit?';
      EnableDefaultSettings@1001 : Boolean;
      NumberSettingsVisible@1006 : Boolean;
      DefaultSetupStepVisible@1007 : Boolean;
      OWRNotEnabled@1021 : TextConst 'ENU=Outbound Warehouse Request must first be enabled.';
      ConfirmCodeCreation@1017 : Boolean;
      YesCode@1027 : Boolean;
      NoCode@1028 : Boolean;
      OWRFilterCode@1002 : Code[10];
      ErrorOWRFilterCodeExists@1008 : TextConst 'ENU=The OWR Filter Code already exists.';
      ErrorConfirmOWRCode@1030 : TextConst 'ENU=The Confirm OWR Filter Code field must be checked.';
      ErrorYesNoChecked@1031 : TextConst 'ENU=Either Yes or No must be checked.';
      ErrorNullOWRCode@1032 : TextConst 'ENU=The OWR Filter Code must not be empty.';
      ConfirmOWRFilterDelete@1029 : TextConst 'ENU=This OWR Filter Code already exists. Would you like to delete it?';
      ConfirmCreateAdditionalCode@1025 : TextConst 'ENU=Do you wish to create another OWR Filter Code?';
      OWRFilterDescription@1034 : Text[30];
      MessageOWRFilterCodeCreated@1036 : TextConst 'ENU=The OWR Filter Code %1 has been created.';

    LOCAL PROCEDURE EnableControls@2();
    BEGIN
      ResetControls;

      CASE Step OF
        Step::Start:
          ShowStartStep;
        Step::Enable:
          ShowEnableStep;
        Step::General:
          ShowGeneralStep;
        Step::TableFilter:
          ShowTableFilterStep;
        Step::PickFilter:
          ShowPickFilterStep;
        Step::WhseActGroup:
          ShowWhseActGroupStep;
        Step::Limits:
          ShowLimitStep;
        Step::Confirm:
          ShowConfirmStep;
        Step::Additional:
          ShowAdditionalStep;
        Step::Finish:
          ShowFinishStep;
      END;
    END;

    LOCAL PROCEDURE NextAction@5();
    BEGIN
      CASE Step OF
        Step::Enable:
          IF OWRFilterCode = '' THEN
            ERROR(ErrorNullOWRCode);
        Step::Confirm:
          IF NOT ConfirmCodeCreation THEN
            ERROR(ErrorConfirmOWRCode);
        Step::Additional:
          IF (NOT YesCode) AND (NOT NoCode) THEN
            ERROR(ErrorYesNoChecked);
      END;
    END;

    LOCAL PROCEDURE FinishAction@12();
    BEGIN
      OWRAssistedSetup.SetStatus(PAGE::"Assisted OWR Filter Setup Wiz.",OWRAssistedSetup.Status::Completed);
      CurrPage.CLOSE;
    END;

    LOCAL PROCEDURE NextStep@41(Backwards@1000 : Boolean);
    BEGIN
      IF Backwards THEN
        Step := Step - 1
      ELSE BEGIN
        IF YesCode AND (Step = Step::Additional) THEN
          Step := 1
        ELSE
          Step := Step + 1;
      END;

      EnableControls;
    END;

    LOCAL PROCEDURE ShowStartStep@24();
    BEGIN
      FirstStepVisible := TRUE;
      FinishActionEnabled := FALSE;
      BackActionEnabled := FALSE;
    END;

    LOCAL PROCEDURE ShowEnableStep@33();
    BEGIN
      FirstStepVisible := FALSE;
      EnableStepVisible := TRUE;
      GeneralStepVisible := FALSE;
      TableFilterStepVisible := FALSE;
      PickFilterStepVisible := FALSE;
      WhseActGroupStepVisible := FALSE;
      LimitStepVisible := FALSE;
      ConfirmStepVisible := FALSE;
      AdditionalStepVisible := FALSE;
      FinalStepVisible := FALSE;

      ConfirmCodeCreation := FALSE;
      YesCode := FALSE;
      CLEAR(OWRFilterCode);
      CLEAR(OWRFilterDescription);
      CLEAR(OrderSourceType);
    END;

    LOCAL PROCEDURE ShowGeneralStep@34();
    BEGIN
      FirstStepVisible := FALSE;
      EnableStepVisible := FALSE;
      GeneralStepVisible := TRUE;
      TableFilterStepVisible := FALSE;
      PickFilterStepVisible := FALSE;
      WhseActGroupStepVisible := FALSE;
      LimitStepVisible := FALSE;
      ConfirmStepVisible := FALSE;
      AdditionalStepVisible := FALSE;
      FinalStepVisible := FALSE;

      NextActionEnabled := TRUE;
    END;

    LOCAL PROCEDURE ShowTableFilterStep@6();
    BEGIN
      FirstStepVisible := FALSE;
      EnableStepVisible := FALSE;
      GeneralStepVisible := FALSE;
      TableFilterStepVisible := TRUE;
      PickFilterStepVisible := FALSE;
      WhseActGroupStepVisible := FALSE;
      LimitStepVisible := FALSE;
      ConfirmStepVisible := FALSE;
      AdditionalStepVisible := FALSE;
      FinalStepVisible := FALSE;

      NextActionEnabled := TRUE;
    END;

    LOCAL PROCEDURE ShowPickFilterStep@7();
    BEGIN
      FirstStepVisible := FALSE;
      EnableStepVisible := FALSE;
      GeneralStepVisible := FALSE;
      TableFilterStepVisible := FALSE;
      PickFilterStepVisible := TRUE;
      WhseActGroupStepVisible := FALSE;
      LimitStepVisible := FALSE;
      ConfirmStepVisible := FALSE;
      AdditionalStepVisible := FALSE;
      FinalStepVisible := FALSE;

      NextActionEnabled := TRUE;
    END;

    LOCAL PROCEDURE ShowWhseActGroupStep@8();
    BEGIN
      FirstStepVisible := FALSE;
      EnableStepVisible := FALSE;
      GeneralStepVisible := FALSE;
      TableFilterStepVisible := FALSE;
      PickFilterStepVisible := FALSE;
      WhseActGroupStepVisible := TRUE;
      LimitStepVisible := FALSE;
      ConfirmStepVisible := FALSE;
      AdditionalStepVisible := FALSE;
      FinalStepVisible := FALSE;

      NextActionEnabled := TRUE;
    END;

    LOCAL PROCEDURE ShowLimitStep@9();
    BEGIN
      FirstStepVisible := FALSE;
      EnableStepVisible := FALSE;
      GeneralStepVisible := FALSE;
      TableFilterStepVisible := FALSE;
      PickFilterStepVisible := FALSE;
      WhseActGroupStepVisible := FALSE;
      LimitStepVisible := TRUE;
      ConfirmStepVisible := FALSE;
      AdditionalStepVisible := FALSE;
      FinalStepVisible := FALSE;

      NextActionEnabled := TRUE;
    END;

    LOCAL PROCEDURE ShowConfirmStep@3();
    BEGIN
      FirstStepVisible := FALSE;
      EnableStepVisible := FALSE;
      GeneralStepVisible := FALSE;
      TableFilterStepVisible := FALSE;
      PickFilterStepVisible := FALSE;
      WhseActGroupStepVisible := FALSE;
      LimitStepVisible := FALSE;
      ConfirmStepVisible := TRUE;
      AdditionalStepVisible := FALSE;
      FinalStepVisible := FALSE;

      NextActionEnabled := TRUE;
    END;

    LOCAL PROCEDURE ShowAdditionalStep@11();
    BEGIN
      FirstStepVisible := FALSE;
      EnableStepVisible := FALSE;
      GeneralStepVisible := FALSE;
      TableFilterStepVisible := FALSE;
      PickFilterStepVisible := FALSE;
      WhseActGroupStepVisible := FALSE;
      LimitStepVisible := FALSE;
      ConfirmStepVisible := FALSE;
      AdditionalStepVisible := TRUE;
      FinalStepVisible := FALSE;

      NextActionEnabled := TRUE;
    END;

    LOCAL PROCEDURE ShowFinishStep@35();
    BEGIN
      FirstStepVisible := FALSE;
      EnableStepVisible := FALSE;
      GeneralStepVisible := FALSE;
      TableFilterStepVisible := FALSE;
      PickFilterStepVisible := FALSE;
      WhseActGroupStepVisible := FALSE;
      LimitStepVisible := FALSE;
      ConfirmStepVisible := FALSE;
      AdditionalStepVisible := FALSE;
      FinalStepVisible := TRUE;

      NextActionEnabled := FALSE;
      FinishActionEnabled := TRUE;
    END;

    LOCAL PROCEDURE ResetControls@1();
    BEGIN
      FinishActionEnabled := FALSE;
      BackActionEnabled := TRUE;
      NextActionEnabled := TRUE;

      FirstStepVisible := FALSE;
      EnableStepVisible := FALSE;
      GeneralStepVisible := FALSE;
      TableFilterStepVisible := FALSE;
      PickFilterStepVisible := FALSE;
      WhseActGroupStepVisible := FALSE;
      LimitStepVisible := FALSE;
      FinalStepVisible := FALSE;
    END;

    LOCAL PROCEDURE LoadTopBanners@40();
    BEGIN
      IF MediaRepositoryStandard.GET('AssistedSetup-NoText-400px.png',FORMAT(ClientTypeManagement.GetCurrentClientType)) AND
         MediaRepositoryDone.GET('AssistedSetupDone-NoText-400px.png',FORMAT(ClientTypeManagement.GetCurrentClientType))
      THEN
        IF MediaResourcesStandard.GET(MediaRepositoryStandard."Media Resources Ref") AND
           MediaResourcesDone.GET(MediaRepositoryDone."Media Resources Ref")
        THEN
          TopBannerVisible := MediaResourcesDone."Media Reference".HASVALUE;
    END;

    BEGIN
    END.
  }
}

