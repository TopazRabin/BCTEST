OBJECT Page 14000566 Item Usage Adjustment
{
  OBJECT-PROPERTIES
  {
    Date=03/27/19;
    Time=12:00:00 PM;
    Version List=UBP3.00;
  }
  PROPERTIES
  {
    CaptionML=ENU=Item Usage Adjustment;
    SourceTable=Table14000558;
    DelayedInsert=Yes;
    PageType=List;
    AutoSplitKey=Yes;
    ActionList=ACTIONS
    {
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 9       ;1   ;Action    ;
                      CaptionML=ENU=&Get Ledger Entries;
                      Promoted=No;
                      Image=GetLines;
                      OnAction=BEGIN
                                 UsageLedgEntry.SETCURRENTKEY(
                                   "Location Code","Item No.","Variant Code","Entry Type","Exclude from Usage",
                                   "Drop Shipment",Nonstock,"Usage Date");
                                 UsageLedgEntry.SETRANGE("Location Code","Location Code");
                                 UsageLedgEntry.SETRANGE("Item No.","Item No.");
                                 UsageLedgEntry.SETRANGE("Variant Code","Variant Code");
                                 UsageLedgEntry.SETRANGE("Usage Date","Starting Date","Ending Date");
                                 IF PAGE.RUNMODAL(PAGE::"Usage Ledger Entries",UsageLedgEntry) = ACTION::LookupOK THEN BEGIN
                                   ItemUsageAdj.SETRANGE("Location Code","Location Code");
                                   ItemUsageAdj.SETRANGE("Item No.","Item No.");
                                   ItemUsageAdj.SETRANGE("Variant Code","Variant Code");
                                   ItemUsageAdj.SETRANGE("Starting Date","Starting Date");
                                   ItemUsageAdj.SETRANGE("Ending Date","Ending Date");
                                   IF ItemUsageAdj.FIND('+') THEN
                                     LineNo := ItemUsageAdj."Line No." + 10000
                                   ELSE
                                     LineNo := 10000;
                                   ItemUsageAdj.INIT;
                                   ItemUsageAdj."Location Code" := UsageLedgEntry."Location Code";
                                   ItemUsageAdj."Item No." := UsageLedgEntry."Item No.";
                                   ItemUsageAdj."Variant Code" := UsageLedgEntry."Variant Code";
                                   ItemUsageAdj."Starting Date" := "Starting Date";
                                   ItemUsageAdj."Ending Date" := "Ending Date";
                                   ItemUsageAdj."Line No." := LineNo;
                                   ItemUsageAdj."Original Quantity" := - UsageLedgEntry.Quantity;
                                   ItemUsageAdj.INSERT;
                                 END;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 2   ;2   ;Field     ;
                ToolTipML=ENU=Specifies a location code for the warehouse or distribution center where your items are handled and stored before being sold.;
                SourceExpr="Location Code";
                Editable=FALSE }

    { 4   ;2   ;Field     ;
                ToolTipML=ENU=Item number;
                SourceExpr="Item No.";
                Editable=FALSE }

    { 21  ;2   ;Field     ;
                SourceExpr="Variant Code";
                Editable=FALSE }

    { 6   ;2   ;Field     ;
                SourceExpr="Starting Date";
                Editable=FALSE }

    { 17  ;2   ;Field     ;
                SourceExpr="Original Quantity";
                Editable=FALSE }

    { 10  ;2   ;Field     ;
                SourceExpr="Adjustment Quantity" }

    { 1240030000;2;Field  ;
                SourceExpr="Promotion Code" }

    { 12  ;2   ;Field     ;
                SourceExpr=Reason }

  }
  CODE
  {
    VAR
      UsageLedgEntry@14000500 : Record 14000556;
      ItemUsageAdj@14000501 : Record 14000558;
      ItemUsage@14000502 : Record 14000557;
      LineNo@14000503 : Integer;

    BEGIN
    END.
  }
}

