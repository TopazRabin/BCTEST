OBJECT Page 14000572 Vendor Buying Calendar
{
  OBJECT-PROPERTIES
  {
    Date=01/28/21;
    Time=[ 3:03:05 PM];
    Modified=Yes;
    Version List=UBP3.02;
  }
  PROPERTIES
  {
    CaptionML=ENU=Vendor Buying Calendar;
    InsertAllowed=No;
    SourceTable=Table14000563;
    SourceTableView=SORTING(Location Code,Line Buy Vendor)
                    ORDER(Ascending)
                    WHERE(Line Buy Vendor=FILTER(Yes));
    PageType=List;
    OnOpenPage=BEGIN
                 InvMgtSetup.GET;
               END;

    OnAfterGetRecord=VAR
                       DocNumber@1240020000 : Code[20];
                     BEGIN
                       IF NOT Vend.GET("Vendor No.") THEN
                         Vend.INIT;
                       SugOrderHeader.INIT;
                       TargetsMet := FALSE;

                       SugOrderHeader.RESET;
                       IF "Procurement Group Code" = '' THEN BEGIN
                         SugOrderHeader.SETRANGE("Buy-from Vendor No.","Vendor No.");
                         IF "Division Code" <> '' THEN
                           DocNumber := "Location Code" + "Division Code"
                         ELSE
                         DocNumber := "Location Code";
                         SugOrderHeader.SETRANGE("No.", DocNumber);
                         IF SugOrderHeader.FIND('-') THEN BEGIN
                           SugOrderHeader.SETFILTER("Override Vendor Filter",'=%1','');
                           TargetsMet := SugOrderHeader.PurchTargetsMet;
                         END;
                       END ELSE BEGIN
                         SugOrderHeader.SETRANGE("Buy-from Vendor No.","Vendor No.");
                         SugOrderHeader.SETRANGE("No.","Procurement Group Code");
                         IF SugOrderHeader.FIND('-') THEN BEGIN
                           SugOrderHeader.SETFILTER("Override Vendor Filter",'=%1','');
                           TargetsMet := SugOrderHeader.PurchTargetsMet;
                         END;
                       END;
                     END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 50      ;1   ;Action    ;
                      CaptionML=ENU=&Suggested Order;
                      ToolTipML=ENU=Suggested orders for this vendor;
                      Image=BlanketOrder;
                      OnAction=VAR
                                 DocNumber@1240020000 : Code[20];
                               BEGIN
                                 SugOrderHeader.RESET;
                                 SugOrderHeader.SETRANGE("Buy-from Vendor No.","Vendor No.");
                                 IF "Procurement Group Code" = '' THEN BEGIN
                                   IF "Division Code" <> '' THEN
                                     DocNumber := "Location Code" + "Division Code"
                                 ELSE
                                     DocNumber := "Location Code";
                                   SugOrderHeader.SETRANGE("No.","Location Code");
                                 END ELSE
                                   DocNumber := "Procurement Group Code";
                                 SugOrderHeader.SETRANGE("No.",DocNumber);
                                 PAGE.RUN(PAGE::"Suggested Order",SugOrderHeader);
                                 CurrPage.UPDATE(FALSE);
                               END;
                                }
      { 3       ;1   ;Action    ;
                      Name=PageSuggOrdderLineReview;
                      CaptionML=ENU=Suggested Order Line Review;
                      Image=ReviewWorksheet;
                      OnAction=BEGIN
                                 ShowSuggestedOrderLineReview;
                                 CurrPage.UPDATE(FALSE);
                               END;
                                }
      { 1240030002;1 ;Action    ;
                      CaptionML=ENU=Procurement &Units;
                      RunObject=Page 14000559;
                      RunPageView=SORTING(Location Code,Replenishment Source Type,Replenishment Source Code)
                                  ORDER(Ascending);
                      RunPageLink=Location Code=FIELD(Location Code),
                                  Replenishment Source Type=CONST(Vendor),
                                  Replenishment Source Code=FIELD(Vendor No.),
                                  Division Code=FIELD(Division Code);
                      Image=BankAccountRec }
      { 37      ;1   ;Action    ;
                      ShortCutKey=Shift+F7;
                      CaptionML=ENU=&Vendor;
                      RunObject=Page 26;
                      RunPageView=SORTING(No.);
                      RunPageLink=No.=FIELD(Vendor No.);
                      Image=ViewPage }
      { 36      ;1   ;Action    ;
                      CaptionML=ENU=&Open Purchase Orders;
                      ToolTipML=ENU=Open purchase orders for this vendor;
                      RunObject=Page 9307;
                      RunPageView=SORTING(Document Type,Buy-from Vendor No.,No.)
                                  ORDER(Ascending)
                                  WHERE(Document Type=CONST(Order));
                      RunPageLink=Buy-from Vendor No.=FIELD(Vendor No.);
                      Image=MakeOrder }
      { 1240030003;1 ;Action    ;
                      CaptionML=ENU=&Posted Suggested Orders;
                      ToolTipML=ENU=List of previously posted suggested orders for this vendor;
                      RunObject=Page 14000582;
                      RunPageView=SORTING(Buy-from Vendor No.,No.)
                                  ORDER(Ascending);
                      RunPageLink=Buy-from Vendor No.=FIELD(Vendor No.);
                      Image=PostInventoryToGL }
      { 47      ;1   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=ENU=Vendor Item Status;
                      Image=ItemTracing;
                      OnAction=BEGIN
                                 Vend.RESET;
                                 Vend.SETRANGE("No.","Vendor No.");
                                 REPORT.RUNMODAL(REPORT::"Vendor Item Status",TRUE,TRUE,Vend);
                               END;
                                }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 49      ;1   ;Action    ;
                      CaptionML=ENU=Create &Suggested Order;
                      ToolTipML=ENU=Create suggested purchase order for this procurement unit;
                      Promoted=Yes;
                      Image=CalculateLines;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CLEAR(CreateSugOrderYesNo);
                                 VendBuyingCalendar."Push Vendor L.T. Days" := 0;
                                 CreateSugOrderYesNo.CreateSuggestedOrder(Rec,FALSE);
                               END;
                                }
      { 14      ;1   ;Action    ;
                      CaptionML=ENU=Create &Multiple Suggested Orders;
                      ToolTipML=ENU=Create suggested purchase orders for all vendors on the buying calendar;
                      Image=CalculatePlan;
                      OnAction=BEGIN
                                 REPORT.RUNMODAL(REPORT::"Create Suggested Orders",TRUE,FALSE);
                                 CurrPage.UPDATE;
                               END;
                                }
      { 1240030004;1 ;Action    ;
                      CaptionML=ENU=&Push Vendor Lead Time;
                      ToolTipML=ENU=Adds/subtracts days to lead time horizon for this suggested order;
                      Promoted=Yes;
                      Image=ExchProdBOMItem;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 PAGE.RUNMODAL(PAGE::"Push Vendor Lead Time Days",Rec);
                               END;
                                }
      { 1240030020;1 ;Action    ;
                      CaptionML=ENU=Create &Vendor Spend (All Vendors);
                      Visible=FALSE;
                      Image=CalculateSalesTax;
                      OnAction=BEGIN
                                 CLEAR(CreateVendorSpend);
                                 CreateVendorSpend.RUN;
                               END;
                                }
      { 1240030023;1 ;Action    ;
                      CaptionML=ENU=Export Vendor Spend to Excel;
                      Visible=FALSE;
                      Image=Excel;
                      OnAction=BEGIN
                                 Vendor.SETRANGE("No.","Vendor No.");
                                 REPORT.RUNMODAL(REPORT::"Export Vendor Spend to Excel",TRUE,FALSE,Vendor);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                Editable=TRUE;
                GroupType=Repeater }

    { 4   ;2   ;Field     ;
                ToolTipML=ENU=Specifies a location code for the warehouse or distribution center where your items are handled and stored before being sold.;
                SourceExpr="Location Code";
                Editable=FALSE }

    { 2   ;2   ;Field     ;
                ToolTipML=ENU=Vendor Number;
                SourceExpr="Vendor No.";
                Editable=FALSE }

    { 1240030007;2;Field  ;
                ToolTipML=ENU=Vendor name;
                SourceExpr="Vendor Name";
                Editable=FALSE }

    { 1000000000;2;Field  ;
                SourceExpr="Suggest From Purchase Prices" }

    { 1000000001;2;Field  ;
                SourceExpr="Include All Items" }

    { 1240020001;2;Field  ;
                ToolTipML=ENU=User defined code to split a location and vendor.  Link this code to the procurement units.;
                SourceExpr="Division Code";
                Visible=FALSE;
                Editable=FALSE }

    { 1240030013;2;Field  ;
                CaptionML=ENU=Error;
                SourceExpr="Order Create  Error" }

    { 1240030015;2;Field  ;
                SourceExpr="Order Create Date" }

    { 1240030000;2;Field  ;
                SourceExpr="Purchaser Code" }

    { 1240030005;2;Field  ;
                SourceExpr="Suggested Order Exists" }

    { 1240020000;2;Field  ;
                CaptionML=ENU=Lines to Review;
                SourceExpr="Lines Not Reviewed" }

    { 1240020003;2;Field  ;
                SourceExpr="Procurement Unit Count" }

    { 1240030021;2;Field  ;
                CaptionML=ENU=Targets Met;
                ToolTipML=ENU=Indicates all non-zero vendor buying control targets are met.;
                SourceExpr=TargetsMet;
                Editable=FALSE }

    { 1240020002;2;Field  ;
                SourceExpr="Critical Need" }

    { 44  ;2   ;Field     ;
                SourceExpr="Procurement Group Code";
                Visible=FALSE }

    { 16  ;2   ;Field     ;
                SourceExpr="Last Review Date";
                Visible=FALSE }

    { 30  ;2   ;Field     ;
                SourceExpr="Next Review Date" }

    { 12  ;2   ;Field     ;
                SourceExpr="Amount Target";
                Visible=FALSE }

    { 10  ;2   ;Field     ;
                SourceExpr="Net Weight Target";
                Visible=FALSE }

    { 8   ;2   ;Field     ;
                SourceExpr="Gross Weight Target";
                Visible=FALSE }

    { 6   ;2   ;Field     ;
                ToolTipML=ENU=Volume target for this vendor;
                SourceExpr="Volume Target";
                Visible=FALSE }

    { 40  ;2   ;Field     ;
                SourceExpr="Proj. Annual Purchases";
                Visible=FALSE }

    { 1240030009;2;Field  ;
                SourceExpr="Default Lead Time (Days)";
                Visible=FALSE }

    { 1240030011;2;Field  ;
                SourceExpr="Default Container Def. Code";
                Visible=FALSE }

    { 1240030026;2;Field  ;
                SourceExpr="Frozen Lead Time (Days)" }

    { 38  ;2   ;Field     ;
                SourceExpr="Frozen Review Cycle (Days)" }

    { 11  ;0   ;Container ;
                ContainerType=FactBoxArea }

    { 13  ;1   ;Part      ;
                CaptionML=ENU=Vendor Targets;
                SubPageView=SORTING(Buy-from Vendor No.,No.);
                SubPageLink=Buy-from Vendor No.=FIELD(Vendor No.),
                            Procurement Group Code=FIELD(Procurement Group Code),
                            Location Code=FIELD(Location Code),
                            Override Vendor Filter=FIELD(Division Code);
                PagePartID=Page14097478;
                PartType=Page;
                ShowFilter=No }

  }
  CODE
  {
    VAR
      Vend@14000500 : Record 23;
      Location@14000501 : Record 14;
      Vendor@1240030002 : Record 23;
      VendBuyingCalendar@14000503 : Record 14000563;
      SugOrderHeader@14000506 : Record 14000565;
      VendorBuyingCalendar@1240030001 : Record 14000563;
      InvMgtSetup@1240030003 : Record 14000551;
      CreateSugOrderYesNo@14000507 : Codeunit 14000558;
      CreateVendorSpend@1240030000 : Codeunit 14002703;
      TargetsMet@14000511 : Boolean;
      Text001@1240030004 : TextConst 'ENU=%1 Lines have not been reviewed.  Do you wish to continue?';

    LOCAL PROCEDURE CalcLinesNotReviewed@1240020005() : Integer;
    VAR
      VendBuyingCalendar@1240020000 : Record 14000563;
    BEGIN
      VendBuyingCalendar.COPY(Rec);
      IF "Procurement Group Code" = '' THEN BEGIN
        VendBuyingCalendar.SETFILTER("Doc. No. Filter","Location Code");
      END ELSE BEGIN
        VendBuyingCalendar.SETFILTER("Doc. No. Filter","Procurement Group Code");
      END;
      VendBuyingCalendar.CALCFIELDS("Lines Not Reviewed");
      EXIT(VendBuyingCalendar."Lines Not Reviewed");
    END;

    LOCAL PROCEDURE ShowSuggestedOrderLineReview@1();
    VAR
      SugOrderLine@1000 : Record 14000566;
      PageSuggOrderLineReview@1001 : Page 14097503;
    BEGIN
      SugOrderLine.SETRANGE("Buy-from Vendor No.","Vendor No.");
      IF "Procurement Group Code" = '' THEN
        SugOrderLine.SETRANGE("Document No.","Location Code")
      ELSE
        SugOrderLine.SETRANGE("Document No.","Procurement Group Code");
      CLEAR(PageSuggOrderLineReview);
      PageSuggOrderLineReview.SETTABLEVIEW(SugOrderLine);
      PageSuggOrderLineReview.RUNMODAL();
    END;

    BEGIN
    END.
  }
}

