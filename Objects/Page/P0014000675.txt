OBJECT Page 14000675 Shipping Charge Markups
{
  OBJECT-PROPERTIES
  {
    Date=06/28/17;
    Time=12:00:00 PM;
    Version List=SE0.54.10;
  }
  PROPERTIES
  {
    CaptionML=ENU=Shipping Charge Markups;
    SourceTable=Table14000723;
    PageType=List;
    ActionList=ACTIONS
    {
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 23      ;1   ;ActionGroup;
                      CaptionML=ENU=F&unctions }
      { 24      ;2   ;Action    ;
                      CaptionML=ENU=Set Markup;
                      OnAction=VAR
                                 ShippingChargeMarkup@1240030001 : Record 14000723;
                                 ShippingChargeMarkup2@1240030002 : Record 14000723;
                                 EShipInput@1240030006 : Record 14000728;
                                 EShipEnterAdditionalMarkup@1240030007 : Page 14050114;
                                 MarkupType@1240030003 : Integer;
                                 AdditionalMarkup@1240030004 : Integer;
                               BEGIN
                                 MarkupType := STRMENU(Text001);
                                 IF MarkupType = 0 THEN
                                   EXIT;

                                 IF MarkupType <> 0 THEN BEGIN
                                   CLEAR(EShipEnterAdditionalMarkup);
                                   EShipEnterAdditionalMarkup.LOOKUPMODE(TRUE);
                                   IF EShipEnterAdditionalMarkup.RUNMODAL = ACTION::LookupOK THEN BEGIN
                                     EShipEnterAdditionalMarkup.GetEShipInput(EShipInput);
                                     AdditionalMarkup := EShipInput."Additional Markup";
                                   END ELSE
                                     EXIT;
                                 END;

                                 CurrPage.SETSELECTIONFILTER(ShippingChargeMarkup);
                                 IF ShippingChargeMarkup.FIND('-') THEN
                                   REPEAT
                                     ShippingChargeMarkup2 := ShippingChargeMarkup;
                                     ShippingChargeMarkup2."Markup Type" := MarkupType;
                                     ShippingChargeMarkup2."Additional Markup" := AdditionalMarkup;
                                     ShippingChargeMarkup2.MODIFY(TRUE);
                                   UNTIL ShippingChargeMarkup.NEXT = 0;
                               END;
                                }
      { 26      ;2   ;Action    ;
                      CaptionML=ENU=Copy Services for Shipping Agent;
                      OnAction=VAR
                                 ShippingAgent@1240030001 : Record 291;
                                 EShipAgentService@1240030002 : Record 14000708;
                                 ShippingChargeMarkup@1240030003 : Record 14000723;
                                 ShipToType@1240030004 : Integer;
                               BEGIN
                                 IF (GETFILTER("Ship-to Type") = '') OR
                                    (GETFILTER("Ship-to No.") = '') OR
                                    (GETFILTER("Ship-to Code") = '')
                                 THEN
                                   ERROR(Text003);


                                 IF NOT EVALUATE(ShipToType,GETFILTER("Ship-to Type")) THEN
                                   ShipToType := 0;
                                 ShippingChargeMarkup.VALIDATE("Ship-to Type",ShipToType);
                                 ShippingChargeMarkup.VALIDATE("Ship-to No.",GETFILTER("Ship-to No."));
                                 ShippingChargeMarkup.VALIDATE("Ship-to Code",GETFILTER("Ship-to Code"));

                                 IF PAGE.RUNMODAL(0,ShippingAgent) = ACTION::LookupOK THEN BEGIN
                                   EShipAgentService.SETRANGE("Shipping Agent Code",ShippingAgent.Code);
                                   IF EShipAgentService.FIND('-') THEN BEGIN
                                     ShippingChargeMarkup."Shipping Agent Code" := EShipAgentService."Shipping Agent Code";
                                     ShippingChargeMarkup."E-Ship Agent Service Code" := EShipAgentService.Code;
                                     ShippingChargeMarkup."World Wide Service" := EShipAgentService."World Wide Service";
                                     ShippingChargeMarkup."Markup Type" := EShipAgentService."Markup Type";
                                     ShippingChargeMarkup."Additional Markup" := EShipAgentService."Additional Markup";
                                     ShippingChargeMarkup."Use for Ship-to/Order Address" := FALSE;
                                     IF NOT EShipAgentService.INSERT(TRUE) THEN
                                       ;
                                   END;
                                 END;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 2   ;2   ;Field     ;
                SourceExpr="Ship-to Type";
                Visible=FALSE }

    { 4   ;2   ;Field     ;
                SourceExpr="Ship-to No.";
                Visible=FALSE }

    { 6   ;2   ;Field     ;
                SourceExpr="Ship-to Code";
                Visible=FALSE }

    { 8   ;2   ;Field     ;
                SourceExpr="Shipping Agent Code" }

    { 10  ;2   ;Field     ;
                SourceExpr="E-Ship Agent Service Code" }

    { 12  ;2   ;Field     ;
                SourceExpr="World Wide Service" }

    { 18  ;2   ;Field     ;
                SourceExpr="Use for Ship-to/Order Address" }

    { 14  ;2   ;Field     ;
                SourceExpr="Markup Type" }

    { 16  ;2   ;Field     ;
                SourceExpr="Additional Markup" }

    { 25  ;2   ;Field     ;
                SourceExpr=Description }

  }
  CODE
  {
    VAR
      Text001@1001 : TextConst 'ENU=" ,Percent,Amount"';
      Text003@1003 : TextConst 'ENU=Filter on Ship-to fields required.';

    BEGIN
    END.
  }
}

