OBJECT Page 23044527 WHI Warehouse Requests
{
  OBJECT-PROPERTIES
  {
    Date=04/29/19;
    Time=11:53:24 AM;
    Version List=WHI2.4.7684.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Warehouse Requests;
               ESM=Solicitudes de almac‚n;
               FRC=Requˆtes d'entrep“t;
               ENC=Warehouse Requests];
    InsertAllowed=No;
    DeleteAllowed=No;
    ModifyAllowed=No;
    SourceTable=Table5765;
    PageType=List;
    ActionList=ACTIONS
    {
      { 1000000002;  ;ActionContainer;
                      CaptionML=[ENU=New;
                                 ESM=Nuevo;
                                 FRC=Nouveau;
                                 ENC=New];
                      ActionContainerType=NewDocumentItems }
      { 1000000003;1 ;Action    ;
                      CaptionML=[ENU=Warehouse Shipment;
                                 ESM=El env¡o de almac‚n;
                                 FRC=Envoi Entrep“t;
                                 ENC=Warehouse Shipment];
                      ToolTipML=[ENU=Create a shipment from the request;
                                 ESM=Crear un env¡o a partir de la solicitud.;
                                 FRC=Cr‚er un envoi … partir de la demande;
                                 ENC=Create a shipment from the request];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=ShipmentLines;
                      OnAction=BEGIN
                                 createShipment;
                               END;
                                }
      { 1000000019;1 ;Action    ;
                      CaptionML=[ENU=Warehouse Receipt;
                                 ESM=Recibo de Almac‚n;
                                 FRC=R‚c‚piss‚ d'entrep“t;
                                 ENC=Warehouse Receipt];
                      ToolTipML=[ENU=Create a receipt from the request;
                                 ESM=Crear un recibo de la solicitud;
                                 FRC=Cr‚er un re‡u … partir de la demande;
                                 ENC=Create a receipt from the request];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=ReceiptLines;
                      OnAction=BEGIN
                                 createReceipt
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1000000000;0;Container;
                ContainerType=ContentArea }

    { 1000000001;1;Group  ;
                Name=Group;
                GroupType=Repeater }

    { 1000000005;2;Field  ;
                ToolTipML=[ENU=Specifies the type of document, such as sales order, sales return order, purchase order, purchase return order, inbound transfer, or outbound transfer, to which the request relates.;
                           ESM=Especifica el tipo de documento, como el pedido de cliente, el pedido de devoluci¢n, el pedido de compra, el pedido de devoluci¢n, la transferencia entrante o la transferencia saliente a la que se refiere la solicitud.;
                           FRC=Sp‚cifie le type de document, tel que la commande client, le bon de commande, le bon de commande, le transfert entrant ou le transfert sortant, concern‚ par la demande.;
                           ENC=Specifies the type of document, such as sales order, sales return order, purchase order, purchase return order, inbound transfer, or outbound transfer, to which the request relates.];
                SourceExpr="Source Document" }

    { 1000000004;2;Field  ;
                ToolTipML=[ENU=Specifies the number of the document.;
                           ESM=Especifica el n£mero del documento.;
                           FRC=Sp‚cifie le num‚ro du document.;
                           ENC=Specifies the number of the document.];
                SourceExpr="Source No." }

    { 1000000006;2;Field  ;
                ToolTipML=[ENU=Specifies the status of the source document from which the warehouse request was created.;
                           ESM=Especifica el estado del documento de origen a partir del cual se cre¢ la solicitud de almac‚n.;
                           FRC=Sp‚cifie le statut du document source … partir duquel la demande d'entrep“t a ‚t‚ cr‚‚e.;
                           ENC=Specifies the status of the source document from which the warehouse request was created.];
                SourceExpr="Document Status" }

    { 1000000007;2;Field  ;
                ToolTipML=[ENU=Specifies the code of the location to which the request line is linked.;
                           ESM=Especifica el c¢digo de la ubicaci¢n a la que est  vinculada la l¡nea de solicitud.;
                           FRC=Sp‚cifie le code de l'emplacement auquel la ligne de demande est li‚e.;
                           ENC=Specifies the code of the location to which the request line is linked.];
                SourceExpr="Location Code" }

    { 1000000008;2;Field  ;
                ToolTipML=[ENU=Specifies the shipment method code for the shipment.;
                           ESM=Especifica el c¢digo de m‚todo de env¡o para el env¡o.;
                           FRC=Sp‚cifie le code de la m‚thode d'exp‚dition pour l'envoi.;
                           ENC=Specifies the shipment method code for the shipment.];
                SourceExpr="Shipment Method Code" }

    { 1000000009;2;Field  ;
                ToolTipML=[ENU=Specifies the code of the shipping agent that delivers the shipment.;
                           ESM=Especifica el c¢digo del agente de env¡o que entrega el env¡o.;
                           FRC=Sp‚cifie le code de l'agent d'exp‚dition qui livre l'envoi.;
                           ENC=Specifies the code of the shipping agent that delivers the shipment.];
                SourceExpr="Shipping Agent Code" }

    { 1000000010;2;Field  ;
                ToolTipML=[ENU=Specifies the shipping advice that is copied from the source document header. The shipping advice informs the warehouse whether partial deliveries are acceptable.;
                           ESM=Especifica el aviso de env¡o que se copia desde el encabezado del documento de origen. El aviso de env¡o informa al almac‚n si las entregas parciales son aceptables.;
                           FRC=Sp‚cifie l'avis de livraison copi‚ … partir de l'en-tˆte du document source. L'avis d'exp‚dition indique … l'entrep“t si des livraisons partielles sont acceptables.;
                           ENC=Specifies the shipping advice that is copied from the source document header. The shipping advice informs the warehouse whether partial deliveries are acceptable.];
                SourceExpr="Shipping Advice" }

    { 1000000011;2;Field  ;
                ToolTipML=[ENU=Specifies information about the type of destination that is associated with the warehouse request. The entity type can be a customer or a vendor.;
                           ESM=Especifica informaci¢n sobre el tipo de destino que est  asociado con la solicitud de almac‚n. El tipo de entidad puede ser un cliente o un proveedor.;
                           FRC=Sp‚cifie des informations sur le type de destination associ‚ … la demande d'entrep“t. Le type d'entit‚ peut ˆtre un client ou un fournisseur.;
                           ENC=Specifies information about the type of destination that is associated with the warehouse request. The entity type can be a customer or a vendor.];
                SourceExpr="Destination Type" }

    { 1000000012;2;Field  ;
                ToolTipML=[ENU=Specifies the number or code of the customer or vendor that the warehouse request is related to.;
                           ESM=Especifica el n£mero o c¢digo del cliente o proveedor con el que est  relacionada la solicitud de almac‚n.;
                           FRC=Sp‚cifie le num‚ro ou le code du client ou du fournisseur auquel la demande d'entrep“t est li‚e.;
                           ENC=Specifies the number or code of the customer or vendor that the warehouse request is related to.];
                SourceExpr="Destination No." }

    { 1000000013;2;Field  ;
                ToolTipML=[ENU=Specifies the external document number from the source document that the warehouse request is related to.;
                           ESM=Especifica el n£mero de documento externo del documento de origen con el que est  relacionada la solicitud de almac‚n.;
                           FRC=Sp‚cifie le num‚ro de document externe du document source auquel la demande d'entrep“t est li‚e.;
                           ENC=Specifies the external document number from the source document that the warehouse request is related to.];
                SourceExpr="External Document No." }

    { 1000000014;2;Field  ;
                ToolTipML=[ENU=Specifies the date on which the receipt of the items are expected. The value for this field comes from the source document that the warehouse request is related to.;
                           ESM=Especifica la fecha en la que se espera la recepci¢n de los art¡culos. El valor para este campo proviene del documento de origen con el que est  relacionada la solicitud de almac‚n.;
                           FRC=Sp‚cifie la date … laquelle la r‚ception des ‚l‚ments est attendue. La valeur de ce champ provient du document source auquel la demande d'entrep“t est li‚e.;
                           ENC=Specifies the date on which the receipt of the items are expected. The value for this field comes from the source document that the warehouse request is related to.];
                SourceExpr="Expected Receipt Date" }

    { 1000000015;2;Field  ;
                ToolTipML=[ENU=Specifies the date on which the items are expected to be shipped. The value for this field comes from the source document to which the warehouse request is related.;
                           ESM=Especifica la fecha en la que se espera que se env¡en los art¡culos. El valor para este campo proviene del documento de origen con el que est  relacionada la solicitud de almac‚n.;
                           FRC=Sp‚cifie la date … laquelle les articles doivent ˆtre exp‚di‚s. La valeur de ce champ provient du document source auquel la demande magasin est li‚e.;
                           ENC=Specifies the date on which the items are expected to be shipped. The value for this field comes from the source document to which the warehouse request is related.];
                SourceExpr="Shipment Date" }

    { 1000000016;2;Field  ;
                ToolTipML=[ENU=Specifies whether the source document, such as a sales order, a purchase order, or a transfer order, creates an outbound shipment or an inbound receipt.;
                           ESM=Especifica si el documento de origen, como un pedido de venta, un pedido de compra o un pedido de transferencia, crea un env¡o saliente o un recibo entrante.;
                           FRC=Indique si le document source, tel qu'une commande client, une commande d'achat ou un ordre de transfert, cr‚e un envoi sortant ou un re‡u.;
                           ENC=Specifies whether the source document, such as a sales order, a purchase order, or a transfer order, creates an outbound shipment or an inbound receipt.];
                SourceExpr=Type }

    { 1000000017;2;Field  ;
                ToolTipML=[ENU=Specifies the number of the inventory put-away or pick that was created from this warehouse request.;
                           ESM=Especifica el n£mero de inventario reservado o selecci¢n que se cre¢ a partir de esta solicitud de almac‚n.;
                           FRC=Sp‚cifie le num‚ro de stock ou de s‚lection d'inventaire cr‚‚ … partir de cette demande d'entrep“t.;
                           ENC=Specifies the number of the inventory put-away or pick that was created from this warehouse request.];
                SourceExpr="Put-away / Pick No." }

    { 1000000018;2;Field  ;
                ToolTipML=[ENU=Specifies if the full quantity of the warehouse request has been handled.;
                           ESM=Especifica si se ha gestionado la cantidad total de la solicitud de almac‚n.;
                           FRC=Indique si la quantit‚ complŠte de la demande magasin a ‚t‚ trait‚e.;
                           ENC=Specifies if the full quantity of the warehouse request has been handled.];
                SourceExpr="Completely Handled" }

  }
  CODE
  {
    VAR
      recWhseRequest@1000000001 : Record 5765;
      codCurLocation@1000000000 : Code[20];
      cuGetSourceDocuments@1000000002 : Report 5753;

    PROCEDURE createShipment@1000000000();
    VAR
      WhseShptHeader@1000000001 : Record 7320;
    BEGIN
      // Creates a shipment based on selected requests

      prepCreateAction;

      WhseShptHeader.INIT;
      WhseShptHeader.INSERT(TRUE);
      WhseShptHeader.VALIDATE("Location Code", codCurLocation);
      WhseShptHeader.MODIFY;

      cuGetSourceDocuments.SetOneCreatedShptHeader(WhseShptHeader);
      performCreateAction;

      PAGE.RUN(PAGE::"Warehouse Shipment", WhseShptHeader);
    END;

    PROCEDURE createReceipt@1000000008();
    VAR
      WhseRcptHeader@1000000001 : Record 7316;
    BEGIN
      // Creates a receipt based on selected requests

      prepCreateAction;

      WhseRcptHeader.INIT;
      WhseRcptHeader.INSERT(TRUE);
      WhseRcptHeader.VALIDATE("Location Code", codCurLocation);
      WhseRcptHeader.MODIFY;

      cuGetSourceDocuments.SetOneCreatedReceiptHeader(WhseRcptHeader);
      performCreateAction;
      PAGE.RUN(PAGE::"Warehouse Receipt", WhseRcptHeader);
    END;

    PROCEDURE prepCreateAction@1000000016();
    VAR
      ltcErrMultipleLocations@1000000000 : TextConst 'ENC=You can only select requests for one location at a time.';
    BEGIN
      // Sets up vars for creating document

      CurrPage.SETSELECTIONFILTER(recWhseRequest);

      // check for multiple locations - can only have 1
      IF recWhseRequest.FINDSET THEN BEGIN
        codCurLocation := recWhseRequest."Location Code";
        REPEAT
          IF recWhseRequest."Location Code" <> codCurLocation THEN
            ERROR(ltcErrMultipleLocations);
        UNTIL recWhseRequest.NEXT = 0;
      END;//if got request
    END;

    PROCEDURE performCreateAction@1000000018();
    BEGIN
      // Executes codeunit to create document lines

      cuGetSourceDocuments.SetSkipBlocked(TRUE);
      cuGetSourceDocuments.USEREQUESTPAGE(FALSE);
      cuGetSourceDocuments.SETTABLEVIEW(recWhseRequest);
      cuGetSourceDocuments.RUNMODAL;
    END;

    BEGIN
    {
      ************************
      Copyright Notice
      This objects content is copyright of Insight Works 2011.  All rights reserved.
      Any redistribution or reproduction of part or all of the contents in any form is prohibited.
      ************************

      Page for Warehouse Requests table - allows users to create whse receipts/shipments
    }
    END.
  }
}

