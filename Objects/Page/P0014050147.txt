OBJECT Page 14050147 Export Source Docs FactBox
{
  OBJECT-PROPERTIES
  {
    Date=06/28/17;
    Time=12:00:00 PM;
    Version List=SE0.54.18;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=ENU=Export Source Documents;
    InsertAllowed=No;
    ModifyAllowed=No;
    SourceTable=Table14000982;
    PageType=ListPart;
    ActionList=ACTIONS
    {
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1240030017;1 ;Action    ;
                      ShortCutKey=Return;
                      CaptionML=ENU=Open;
                      Promoted=Yes;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 ViewDocument;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 1240030000;2;Field  ;
                SourceExpr="Export Document No.";
                Editable=FALSE }

    { 1240030002;2;Field  ;
                SourceExpr="Source Type" }

    { 1240030004;2;Field  ;
                SourceExpr="Source Subtype" }

    { 1240030006;2;Field  ;
                SourceExpr="Source ID" }

    { 1240030015;2;Field  ;
                SourceExpr="Location Code" }

  }
  CODE
  {
    VAR
      Text001@1240030000 : TextConst 'ENU=%1 %2 does not exist.';
      Text002@1240030001 : TextConst 'ENU=Select Show Document to see %1.';

    PROCEDURE ViewDocument@3();
    VAR
      PackingControl@1240030000 : Record 14000717;
      Package@1240030001 : Record 14000701;
      PostedPackage@1240030002 : Record 14000704;
    BEGIN
      IF "Source Type" IN [DATABASE::Package,DATABASE::"Posted Package"] THEN BEGIN
        IF Package.GET("Source ID") THEN
          PAGE.RUNMODAL(PAGE::Package,Package)
        ELSE
          IF PostedPackage.GET("Source ID") THEN
            PAGE.RUNMODAL(PAGE::"Posted Package",PostedPackage)
          ELSE
            ERROR(Text001,Package.TABLECAPTION,"Source ID");
      END ELSE
        PackingControl.ViewSourceDocument(FALSE,'',"Source Type","Source Subtype","Source ID");
    END;

    PROCEDURE ViewPackages@1();
    VAR
      Package@1240030000 : Record 14000701;
    BEGIN
      IF "Source Type" IN [DATABASE::Package,DATABASE::"Posted Package"] THEN
        ERROR(Text002,Package.TABLECAPTION);

      Package.RESET;
      Package.SETCURRENTKEY("Source Type","Source Subtype","Source ID");
      Package.SETRANGE("Source Type","Source Type");
      Package.SETRANGE("Source Subtype","Source Subtype");
      Package.SETRANGE("Source ID","Source ID");
      Package.SETRANGE("Export Document No.","Export Document No.");
      PAGE.RUNMODAL(0,Package);
    END;

    PROCEDURE ViewPostedPackages@2();
    VAR
      PostedPackage@1240030000 : Record 14000704;
    BEGIN
      IF "Source Type" IN [DATABASE::Package,DATABASE::"Posted Package"] THEN
        ERROR(Text002,PostedPackage.TABLECAPTION);

      PostedPackage.RESET;
      PostedPackage.SETCURRENTKEY("Source Type","Source Subtype","Source ID");
      PostedPackage.SETRANGE("Source Type","Source Type");
      PostedPackage.SETRANGE("Source Subtype","Source Subtype");
      PostedPackage.SETRANGE("Source ID","Source ID");
      PostedPackage.SETRANGE("Export Document No.","Export Document No.");
      PAGE.RUNMODAL(0,PostedPackage);
    END;

    BEGIN
    END.
  }
}

