OBJECT Page 14097507 Assy. Forecast Lines
{
  OBJECT-PROPERTIES
  {
    Date=03/27/19;
    Time=12:00:00 PM;
    Version List=UBP3.00;
  }
  PROPERTIES
  {
    CaptionML=ENU=Assy. Forecast Lines;
    InsertAllowed=No;
    DeleteAllowed=Yes;
    ModifyAllowed=No;
    SourceTable=Table14002667;
    PageType=List;
    ActionList=ACTIONS
    {
      { 1240020005;  ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 1240020006;1 ;Action    ;
                      Name=Assy. Comp. Forecast Lines;
                      RunObject=Page 14097510;
                      RunPageView=SORTING(Assy. Parent Location Code,Assy. Parent Item No.,Assy. Parent Variant Code);
                      RunPageLink=Assy. Parent Location Code=FIELD(Assy. Location Code),
                                  Assy. Parent Item No.=FIELD(Assy. Item No.),
                                  Assy. Parent Variant Code=FIELD(Assy. Variant Code),
                                  Required Date=FIELD(Required Date),
                                  Level=FIELD(Level);
                      Image=Components;
                      PromotedCategory=Process }
      { 1240020000;  ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1240020002;1 ;Action    ;
                      Name=Create Assembly Order;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=CalculateLines;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CreateAsmOrderFromForecast;
                                 CurrPage.UPDATE(FALSE);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1   ;0   ;Container ;
                ContainerType=ContentArea }

    { 2   ;1   ;Group     ;
                Name=Group;
                CaptionML=ENU=Group;
                GroupType=Repeater }

    { 3   ;2   ;Field     ;
                SourceExpr="Assy. Location Code" }

    { 4   ;2   ;Field     ;
                SourceExpr="Assy. Item No." }

    { 1240020001;2;Field  ;
                SourceExpr="Assy. Variant Code" }

    { 6   ;2   ;Field     ;
                SourceExpr="Quantity (Base)" }

    { 1240020008;2;Field  ;
                SourceExpr="Created DateTime";
                Visible=FALSE }

    { 5   ;2   ;Field     ;
                SourceExpr="Required Date" }

    { 1240020007;2;Field  ;
                SourceExpr="Horizon Date" }

    { 1240020004;0;Container;
                ContainerType=FactBoxArea }

    { 1240020003;1;Part   ;
                SubPageLink=Location Code=FIELD(Assy. Location Code),
                            Item No.=FIELD(Assy. Item No.),
                            Variant Code=FIELD(Assy. Variant Code);
                PagePartID=Page14097479;
                PartType=Page }

  }
  CODE
  {
    VAR
      ProdPlan@1240020000 : Codeunit 14002675;

    LOCAL PROCEDURE CreateAsmOrderFromForecast@1240020000();
    VAR
      AssyFCLine@1240020000 : Record 14002667;
      OrderCount@1240020001 : Integer;
      DisplayText@1240020002 : Text[250];
      ConfirmMultiOrderTxt@1240020005 : TextConst 'ENU=%1 lines have been selected.  Combine orders to the first required date?';
      ConfirmSingleOrderTxt@1240020004 : TextConst 'ENU=One line is selected.  Generate the order?';
      ConfirmationOrderCount@1240020003 : TextConst 'ENU="%1 Assembly Order(s) created.  "';
    BEGIN
      CurrPage.SETSELECTIONFILTER(AssyFCLine);
      IF AssyFCLine.FINDSET THEN BEGIN
        IF (AssyFCLine.COUNT = 1) THEN
          DisplayText := ConfirmSingleOrderTxt
        ELSE
          DisplayText := STRSUBSTNO(ConfirmMultiOrderTxt, AssyFCLine.COUNT);
        IF CONFIRM(DisplayText) THEN BEGIN
          CLEAR(ProdPlan);
          OrderCount := ProdPlan.InsertAsmOrderFromForecast(AssyFCLine);
          MESSAGE(STRSUBSTNO(ConfirmationOrderCount, OrderCount));
        END;
      END;
    END;

    BEGIN
    END.
  }
}

