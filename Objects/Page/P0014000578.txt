OBJECT Page 14000578 Suggested Order Statistics
{
  OBJECT-PROPERTIES
  {
    Date=03/01/20;
    Time=12:00:00 PM;
    Version List=UBP3.02;
  }
  PROPERTIES
  {
    CaptionML=ENU=Suggested Order Statistics;
    SourceTable=Table14000565;
    PageType=Card;
    OnOpenPage=BEGIN
                 SETRANGE("Override Vendor Filter",'');
               END;

    OnAfterGetRecord=BEGIN
                       AmountTarget := 0;
                       GrossWeightTarget := 0;
                       NetWeightTarget := 0;
                       VolumeTarget := 0;
                       IF "Procurement Group Code" <> '' THEN BEGIN
                         IF ProcGroup.GET("Buy-from Vendor No.","No.") THEN BEGIN
                           GrossWeightTarget := ProcGroup."Gross Weight Target";
                           NetWeightTarget := ProcGroup."Net Weight Target";
                           VolumeTarget := ProcGroup."Volume Target";
                           AmountTarget := ProcGroup."Amount Target";
                         END;
                       END ELSE BEGIN
                         IF UBP.GetVendBuyingCalendarFromSuggOrdHeader(Rec, VendBuyingCalendar) THEN BEGIN
                           GrossWeightTarget := VendBuyingCalendar."Gross Weight Target";
                           NetWeightTarget := VendBuyingCalendar."Net Weight Target";
                           VolumeTarget := VendBuyingCalendar."Volume Target";
                           AmountTarget := VendBuyingCalendar."Amount Target";
                         END;
                       END;
                     END;

  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                CaptionML=ENU=General }

    { 1240030000;2;Field  ;
                Lookup=Yes;
                CaptionML=ENU=Vendor Override Filter;
                SourceExpr=OverrideVendor;
                OnValidate=BEGIN
                             SETRANGE("Override Vendor Filter",OverrideVendor);
                             CalculateFields;
                           END;

                OnLookup=BEGIN
                           SuggestedOrderLine.RESET;
                           SuggestedOrderLine.SETRANGE("Buy-from Vendor No.","Buy-from Vendor No.");
                           SuggestedOrderLine.SETRANGE("Document No.","No.");
                           SuggestedOrderLine.SETFILTER("Override Vendor No.",'<>%1','');
                           IF PAGE.RUNMODAL(PAGE::"Order Vend. Override",SuggestedOrderLine) = ACTION::LookupOK THEN BEGIN
                             OverrideVendor := SuggestedOrderLine."Override Vendor No.";
                             SETRANGE("Override Vendor Filter",OverrideVendor);
                             CalculateFields;
                           END;
                         END;
                          }

    { 1240030002;2;Field  ;
                CaptionML=ENU=Target Net Weight;
                SourceExpr=NetWeightTarget;
                Editable=FALSE }

    { 1240030010;2;Field  ;
                ToolTipML=ENU=Net weight;
                SourceExpr="Net Weight";
                Editable=FALSE }

    { 1240030004;2;Field  ;
                CaptionML=ENU=Target Gross Weight;
                SourceExpr=GrossWeightTarget;
                Editable=FALSE }

    { 1240030012;2;Field  ;
                ToolTipML=ENU=Gross weight;
                SourceExpr="Gross Weight";
                Editable=FALSE }

    { 1240030006;2;Field  ;
                CaptionML=ENU=Target Volume;
                ToolTipML=ENU=Calculated volume for this suggested order;
                SourceExpr=VolumeTarget;
                Editable=FALSE }

    { 1240030014;2;Field  ;
                ToolTipML=ENU=Calculated volume for this suggested order;
                SourceExpr=Volume;
                Editable=FALSE }

    { 1240030008;2;Field  ;
                CaptionML=ENU=Target Amount;
                SourceExpr=AmountTarget;
                Editable=FALSE }

    { 1240030016;2;Field  ;
                SourceExpr=Amount;
                Editable=FALSE }

    { 1240030018;2;Field  ;
                CaptionML=ENU=Targets Met;
                SourceExpr=PurchTargetsMet;
                Editable=FALSE }

  }
  CODE
  {
    VAR
      ProcGroup@14000500 : Record 14000564;
      SuggestedOrderLine@1240030001 : Record 14000566;
      VendBuyingCalendar@14000501 : Record 14000563;
      AmountTarget@14000502 : Decimal;
      GrossWeightTarget@14000503 : Decimal;
      NetWeightTarget@14000504 : Decimal;
      VolumeTarget@14000505 : Decimal;
      OverrideVendor@1240030000 : Code[20];
      UBP@1240020000 : Codeunit 14000564;

    PROCEDURE CalculateFields@1240030003();
    BEGIN
      CALCFIELDS(Amount,"Net Weight","Gross Weight",Volume);
    END;

    BEGIN
    END.
  }
}

