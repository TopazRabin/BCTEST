OBJECT Page 11123304 SC - Setup
{
  OBJECT-PROPERTIES
  {
    Date=04/18/17;
    Time=[ 1:00:00 PM];
    Version List=SCW19.2.0;
  }
  PROPERTIES
  {
    CaptionML=ENU=Sana Commerce Setup;
    InsertAllowed=No;
    DeleteAllowed=No;
    ModifyAllowed=Yes;
    SourceTable=Table11123305;
    PageType=Card;
    RefreshOnActivate=Yes;
    OnInit=BEGIN
             uxNasSetupEnable := TRUE;
             "Logging Output DirectoryEnable" := TRUE;
             IsVisibleRolesPermissionsAdd;
           END;

    OnOpenPage=BEGIN
                 IF NOT GET THEN BEGIN
                   INIT;
                   INSERT;
                 END;
                 ChangeLoggingCtrlState;
                 CheckNasSetupAvailable;
               END;

    OnQueryClosePage=BEGIN
                       CheckLoggingFields;
                     END;

    ActionList=ACTIONS
    {
      { 11123319;0   ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 11123313;1   ;ActionGroup;
                      CaptionML=ENU=&Setup }
      { 11123312;2   ;Action    ;
                      CaptionML=ENU=&Operations;
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 11123302;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=CalculateLines;
                      PromotedCategory=Process }
      { 11123311;2   ;Separator  }
      { 11123310;2   ;Action    ;
                      CaptionML=ENU=Currency &ISO Codes;
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 11123329;
                      Promoted=Yes;
                      Image=CurrencyExchangeRates;
                      PromotedCategory=Process }
      { 11123309;2   ;Separator  }
      { 11123308;2   ;Action    ;
                      CaptionML=ENU=&Clear Cache;
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Image=Delete;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 CacheMgt@11123302 : Codeunit 11123323;
                               BEGIN
                                 CacheMgt.ClearCache;
                                 MESSAGE(Text11123303);
                               END;
                                }
      { 11123307;2   ;Separator  }
      { 11123306;2   ;ActionGroup;
                      CaptionML=ENU=&Roles and Permissions;
                      Image=TeamSales }
      { 11123305;3   ;Action    ;
                      CaptionML=ENU=&Add Sana Role;
                      OnAction=VAR
                                 SettingsFunctions@11123302 : Codeunit 11123311;
                               BEGIN
                                 SettingsFunctions.SetSanaRolePermissions;
                                 MESSAGE(Text11123304);
                               END;
                                }
      { 11123304;3   ;Action    ;
                      CaptionML=ENU=Add &Enhanced Roles (CfMD);
                      OnAction=VAR
                                 SettingsFunctions@11123302 : Codeunit 11123311;
                               BEGIN
                                 SettingsFunctions.SetRolesPermissions;
                                 MESSAGE(Text11123304);
                               END;
                                }
      { 11123302;0   ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 11123303;1   ;Action    ;
                      Name=uxNasSetup;
                      CaptionML=ENU=&NAS Setup;
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Enabled=uxNasSetupEnable;
                      PromotedIsBig=Yes;
                      Image=Setup;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CurrPage.SAVERECORD;
                                 PAGE.RUNMODAL(11123308,Rec);
                                 CurrPage.UPDATE(FALSE);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 11123330;0;Container;
                ContainerType=ContentArea }

    { 11123329;1;Group    ;
                CaptionML=ENU=General }

    { 11123328;2;Field    ;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Enable Sana Commerce";
                OnValidate=VAR
                             ProductInfo@11123305 : Record 11123317;
                             DataValidLine@11123304 : Record 11123321;
                             FuncToCallRec@11123303 : Record 11123302;
                             Validation@11123302 : Codeunit 11123310;
                           BEGIN
                             IF "Enable Sana Commerce" <> xRec."Enable Sana Commerce" THEN BEGIN
                               MODIFY;
                               IF NOT "Enable Sana Commerce" THEN BEGIN
                                 IF CONFIRM(Text11123302,FALSE) THEN
                                   ProductInfo.DELETEALL(TRUE)
                                 ELSE BEGIN
                                   "Enable Sana Commerce" := xRec."Enable Sana Commerce";
                                   MODIFY;
                                 END;
                               END ELSE BEGIN
                                 IF DataValidLine.ISEMPTY THEN BEGIN
                                   COMMIT;
                                   Validation.SetDefaults(0,Rec);
                                 END;
                                 IF FuncToCallRec.ISEMPTY THEN
                                   FuncToCallRec.SetDefaults;
                               END;
                             END;
                               EnableSanaCommerceOnAfterValid;
                           END;
                            }

    { 11123327;2;Group    ;
                CaptionML=ENU=Logging }

    { 11123326;3;Field    ;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Enable Logging";
                OnValidate=BEGIN
                             EnableLoggingOnAfterValidate;
                           END;
                            }

    { 11123325;3;Field    ;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Logging Output Directory";
                Enabled="Logging Output DirectoryEnable" }

    { 11123324;1;Group    ;
                CaptionML=ENU=Specific Links;
                GroupType=Group }

    { 11123323;2;Field    ;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Backoffice Link" }

    { 11123322;2;Field    ;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Webshop Link" }

    { 11123321;2;Field    ;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="User Guide Link" }

    { 11123320;2;Field    ;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Youtube Link" }

    { 11123318;1;Group    ;
                CaptionML=ENU=Options;
                GroupType=Group }

    { 11123316;2;Group    ;
                CaptionML=ENU=Modification;
                Visible=FALSE;
                GroupType=Group }

    { 11123317;3;Field    ;
                SourceExpr="Obsolete Field 100";
                Visible=FALSE }

    { 11123315;2;Group    ;
                CaptionML=ENU=Cache;
                GroupType=Group }

    { 11123314;3;Field    ;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="No. of Cached Records" }

  }
  CODE
  {
    VAR
      GlobalContext@11123307 : Codeunit 11123305;
      IsNasSetupAvailable@11123302 : Boolean;
      Text11123302@11123303 : TextConst 'ENU=Are you sure you want to disable Sana Commerce functionality for current company?';
      Text11123303@11123304 : TextConst 'ENU=Cache has been successfully cleared.';
      Text11123304@11123305 : TextConst 'ENU=Roles and permissions have been successfully added.';
      "Logging Output DirectoryEnable"@19012742 : Boolean INDATASET;
      uxNasSetupEnable@19044468 : Boolean INDATASET;
      GlobalVisibleRolesPermissionsAdd@11123306 : Boolean;

    LOCAL PROCEDURE ChangeLoggingCtrlState@11123302();
    BEGIN
      "Logging Output DirectoryEnable" := "Enable Logging";
    END;

    PROCEDURE CheckNasSetupAvailable@11123306();
    VAR
      Object@11123302 : Record 2000000001;
      IsAvailable@11123303 : Boolean;
    BEGIN
      IsAvailable := Object.GET(Object.Type::Page,'',11123308);
      uxNasSetupEnable := IsAvailable;
    END;

    LOCAL PROCEDURE EnableLoggingOnAfterValidate@19017831();
    BEGIN
      ChangeLoggingCtrlState;
    END;

    LOCAL PROCEDURE EnableSanaCommerceOnAfterValid@19034945();
    BEGIN
      CurrPage.UPDATE(FALSE);
    END;

    LOCAL PROCEDURE IsVisibleRolesPermissionsAdd@11123303();
    BEGIN
      GlobalVisibleRolesPermissionsAdd := NOT GlobalContext.SanaExtansionIsUsed;
    END;

    BEGIN
    END.
  }
}

