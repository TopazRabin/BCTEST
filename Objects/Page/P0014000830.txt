OBJECT Page 14000830 Sales Documents (BOL)
{
  OBJECT-PROPERTIES
  {
    Date=10/22/20;
    Time=[ 4:57:39 AM];
    Version List=SE0.61;
  }
  PROPERTIES
  {
    Permissions=TableData 36=rm;
    Editable=No;
    CaptionML=ENU=Sales Documents (BOL);
    SourceTable=Table36;
    PageType=List;
    OnOpenPage=BEGIN
                 ShippingSetup.GET;
                 PackingStation.GetPackingStation;
                 ;ESACC_EasySecurity(TRUE);
               END;

    OnAfterGetRecord=BEGIN
                       //<TPZ2301>
                       "EDI ASN" := FALSE;
                       CheckEDITradePartner;
                       //</TPZ2301>
                     END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 19      ;1   ;ActionGroup;
                      CaptionML=ENU=&Document }
      { 20      ;2   ;Action    ;
                      ShortCutKey=Shift+F7;
                      CaptionML=ENU=Card;
                      Visible=ESACC_C20_Visible;
                      Enabled=ESACC_C20_Enabled;
                      Image=EditLines;
                      OnAction=BEGIN
                                 CASE "Document Type" OF
                                   "Document Type"::Order:
                                     PAGE.RUNMODAL(PAGE::"Sales Order",Rec);
                                   "Document Type"::Invoice:
                                     PAGE.RUNMODAL(PAGE::"Sales Invoice",Rec);
                                 END;
                               END;
                                }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 22      ;1   ;ActionGroup;
                      CaptionML=ENU=F&unctions }
      { 23      ;2   ;Action    ;
                      ShortCutKey=F7;
                      CaptionML=ENU=Add to Bill of Lading;
                      Promoted=Yes;
                      Visible=ESACC_C23_Visible;
                      Enabled=ESACC_C23_Enabled;
                      Image=NewDocument;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 IF BillOfLadingNo = '' THEN
                                   ERROR(Text001);

                                 BillOfLading.GET(BillOfLadingNo);

                                 CurrPage.SETSELECTIONFILTER(SalesHeader);
                                 IF SalesHeader.FIND('-') THEN
                                   REPEAT
                                     BillOfLadingWorksheetMgt.AddSalesHeader(
                                       BillOfLading,SalesHeader,PackingStation,ShippingSetup,
                                       PackingStation."Show Document BOL Warnings");
                                   UNTIL SalesHeader.NEXT = 0;
                               END;
                                }
      { 24      ;2   ;Action    ;
                      CaptionML=ENU=Clear &Bill of Lading No.;
                      Visible=ESACC_C24_Visible;
                      Enabled=ESACC_C24_Enabled;
                      OnAction=VAR
                                 BillOfLadingLine@1240030001 : Record 14000823;
                               BEGIN
                                 SalesHeader.RESET;
                                 CurrPage.SETSELECTIONFILTER(SalesHeader);
                                 IF SalesHeader.FIND('-') THEN
                                   IF CONFIRM(Text002,FALSE,SalesHeader.COUNT) THEN
                                     REPEAT
                                       BillOfLadingLine.RESET;
                                       BillOfLadingLine.SETCURRENTKEY(Type,"No.",Closed,"Location Code");
                                       BillOfLadingLine.SETRANGE(Type,BillOfLadingLine.Type::Order);
                                       BillOfLadingLine.SETRANGE("No.",SalesHeader."No.");
                                       BillOfLadingLine.SETRANGE(Closed,FALSE);
                                       IF ShippingSetup."Location Packing" THEN
                                         BillOfLadingLine.SETRANGE("Location Code",PackingStation."Location Code");
                                       IF BillOfLadingLine.FIND('-') THEN
                                         BillOfLadingLine.DELETE(TRUE);
                                     UNTIL SalesHeader.NEXT = 0;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 1000000001;2;Field  ;
                Name=EDI ASN;
                SourceExpr="EDI ASN" }

    { 2   ;2   ;Field     ;
                SourceExpr="No.";
                Visible=ESACC_F3_Visible;
                Editable=ESACC_F3_Editable;
                HideValue=ESACC_F3_HideValue }

    { 4   ;2   ;Field     ;
                SourceExpr="Sell-to Customer No.";
                Visible=ESACC_F2_Visible;
                Editable=ESACC_F2_Editable;
                HideValue=ESACC_F2_HideValue }

    { 6   ;2   ;Field     ;
                SourceExpr="Ship-to Code";
                Visible=ESACC_F12_Visible;
                Editable=ESACC_F12_Editable;
                HideValue=ESACC_F12_HideValue }

    { 10  ;2   ;Field     ;
                SourceExpr="E-Ship Outst. Lines Exists";
                Visible=FALSE;
                HideValue=ESACC_F14000722_HideValue }

    { 21  ;2   ;Field     ;
                SourceExpr="Exists on Bill of Lading";
                Visible=FALSE;
                HideValue=ESACC_F14000723_HideValue }

    { 26  ;2   ;Field     ;
                CaptionML=ENU=Packing Status;
                SourceExpr=EShipValidation."SalesHeader-PackingStatus"(Rec);
                Editable=FALSE }

    { 8   ;2   ;Field     ;
                SourceExpr="Ship-to Name";
                Visible=ESACC_F13_Visible;
                Editable=ESACC_F13_Editable;
                HideValue=ESACC_F13_HideValue }

    { 28  ;2   ;Field     ;
                SourceExpr="Ship-to Address";
                Visible=FALSE;
                Editable=ESACC_F15_Editable;
                HideValue=ESACC_F15_HideValue }

    { 30  ;2   ;Field     ;
                SourceExpr="Ship-to Address 2";
                Visible=FALSE;
                Editable=ESACC_F16_Editable;
                HideValue=ESACC_F16_HideValue }

    { 34  ;2   ;Field     ;
                SourceExpr="Ship-to Post Code";
                Visible=FALSE;
                Enabled=ESACC_F91_Editable;
                Editable=ESACC_F91_Editable;
                HideValue=ESACC_F91_HideValue }

    { 32  ;2   ;Field     ;
                SourceExpr="Ship-to City";
                Visible=FALSE;
                Enabled=ESACC_F17_Editable;
                Editable=ESACC_F17_Editable;
                HideValue=ESACC_F17_HideValue }

    { 36  ;2   ;Field     ;
                SourceExpr="Ship-to County";
                Visible=FALSE;
                Editable=ESACC_F92_Editable;
                HideValue=ESACC_F92_HideValue }

    { 12  ;2   ;Field     ;
                SourceExpr="External Document No.";
                Visible=ESACC_F100_Visible;
                Editable=ESACC_F100_Editable;
                HideValue=ESACC_F100_HideValue }

    { 14  ;2   ;Field     ;
                SourceExpr="Shipping Agent Code";
                Visible=ESACC_F105_Visible;
                Editable=ESACC_F105_Editable;
                HideValue=ESACC_F105_HideValue }

    { 38  ;2   ;Field     ;
                ToolTipML=ENU=Specifies the E-Ship Agent Service used to ship the packages.;
                SourceExpr="E-Ship Agent Service";
                Visible=ESACC_F14000701_Visible;
                Editable=ESACC_F14000701_Editable;
                HideValue=ESACC_F14000701_HideValue }

  }
  CODE
  {
    VAR
      ESACC_ESFLADSMgt@14123801 : Codeunit 14123801;
      ESACC_C20_Visible@905000200 : Boolean INDATASET;
      ESACC_C20_Enabled@905000203 : Boolean INDATASET;
      ESACC_C23_Visible@905000230 : Boolean INDATASET;
      ESACC_C23_Enabled@905000233 : Boolean INDATASET;
      ESACC_C24_Visible@905000240 : Boolean INDATASET;
      ESACC_C24_Enabled@905000243 : Boolean INDATASET;
      ESACC_F2_Visible@900000020 : Boolean INDATASET;
      ESACC_F2_Editable@900000021 : Boolean INDATASET;
      ESACC_F2_HideValue@900000022 : Boolean INDATASET;
      ESACC_F3_Visible@900000030 : Boolean INDATASET;
      ESACC_F3_Editable@900000031 : Boolean INDATASET;
      ESACC_F3_HideValue@900000032 : Boolean INDATASET;
      ESACC_F12_Visible@900000120 : Boolean INDATASET;
      ESACC_F12_Editable@900000121 : Boolean INDATASET;
      ESACC_F12_HideValue@900000122 : Boolean INDATASET;
      ESACC_F13_Visible@900000130 : Boolean INDATASET;
      ESACC_F13_Editable@900000131 : Boolean INDATASET;
      ESACC_F13_HideValue@900000132 : Boolean INDATASET;
      ESACC_F15_Visible@900000150 : Boolean INDATASET;
      ESACC_F15_Editable@900000151 : Boolean INDATASET;
      ESACC_F15_HideValue@900000152 : Boolean INDATASET;
      ESACC_F16_Visible@900000160 : Boolean INDATASET;
      ESACC_F16_Editable@900000161 : Boolean INDATASET;
      ESACC_F16_HideValue@900000162 : Boolean INDATASET;
      ESACC_F17_Visible@900000170 : Boolean INDATASET;
      ESACC_F17_Editable@900000171 : Boolean INDATASET;
      ESACC_F17_HideValue@900000172 : Boolean INDATASET;
      ESACC_F91_Visible@900000910 : Boolean INDATASET;
      ESACC_F91_Editable@900000911 : Boolean INDATASET;
      ESACC_F91_HideValue@900000912 : Boolean INDATASET;
      ESACC_F92_Visible@900000920 : Boolean INDATASET;
      ESACC_F92_Editable@900000921 : Boolean INDATASET;
      ESACC_F92_HideValue@900000922 : Boolean INDATASET;
      ESACC_F100_Visible@900001000 : Boolean INDATASET;
      ESACC_F100_Editable@900001001 : Boolean INDATASET;
      ESACC_F100_HideValue@900001002 : Boolean INDATASET;
      ESACC_F105_Visible@900001050 : Boolean INDATASET;
      ESACC_F105_Editable@900001051 : Boolean INDATASET;
      ESACC_F105_HideValue@900001052 : Boolean INDATASET;
      ESACC_F14000701_Visible@950007010 : Boolean INDATASET;
      ESACC_F14000701_Editable@950007011 : Boolean INDATASET;
      ESACC_F14000701_HideValue@950007012 : Boolean INDATASET;
      ESACC_F14000722_Visible@950007220 : Boolean INDATASET;
      ESACC_F14000722_HideValue@950007222 : Boolean INDATASET;
      ESACC_F14000723_Visible@950007230 : Boolean INDATASET;
      ESACC_F14000723_HideValue@950007232 : Boolean INDATASET;
      SalesHeader@1000000000 : Record 36;
      BillOfLading@1000000002 : Record 14000822;
      PackingStation@1240030000 : Record 14000709;
      ShippingSetup@1240030002 : Record 14000707;
      BillOfLadingWorksheetMgt@1240030001 : Codeunit 14000822;
      BillOfLadingNo@1000000003 : Code[20];
      Text001@1001 : TextConst 'ENU=Current Bill of Lading No. is not set.';
      Text002@1002 : TextConst 'ENU=Remove %1 from Bill of Lading?';
      EShipValidation@1240020000 : Codeunit 14000240;
      "EDI ASN"@1000000001 : Boolean;

    LOCAL PROCEDURE ESACC_EasySecurity@14123801(OpenObject@14123801 : Boolean);
    VAR
      SetFilters@14123802 : Codeunit 14123812;
      TempBoolean@14123803 : Boolean;
    BEGIN
      IF OpenObject THEN BEGIN
        SetFilters.Filter36(Rec,8,14000830);

        TempBoolean := CurrPage.EDITABLE;
        IF ESACC_ESFLADSMgt.PageGeneral(36,14000830,TempBoolean) THEN
          CurrPage.EDITABLE := TempBoolean;
      END;

      ESACC_ESFLADSMgt.PageControl(
        36,14000830,1,20,
        ESACC_C20_Visible,ESACC_C20_Enabled,TempBoolean);

      ESACC_ESFLADSMgt.PageControl(
        36,14000830,1,23,
        ESACC_C23_Visible,ESACC_C23_Enabled,TempBoolean);

      ESACC_ESFLADSMgt.PageControl(
        36,14000830,1,24,
        ESACC_C24_Visible,ESACC_C24_Enabled,TempBoolean);

      ESACC_ESFLADSMgt.PageControl(
        36,14000830,0,2,
        ESACC_F2_Visible,ESACC_F2_Editable,ESACC_F2_HideValue);

      ESACC_ESFLADSMgt.PageControl(
        36,14000830,0,3,
        ESACC_F3_Visible,ESACC_F3_Editable,ESACC_F3_HideValue);

      ESACC_ESFLADSMgt.PageControl(
        36,14000830,0,12,
        ESACC_F12_Visible,ESACC_F12_Editable,ESACC_F12_HideValue);

      ESACC_ESFLADSMgt.PageControl(
        36,14000830,0,13,
        ESACC_F13_Visible,ESACC_F13_Editable,ESACC_F13_HideValue);

      ESACC_ESFLADSMgt.PageControl(
        36,14000830,0,15,
        ESACC_F15_Visible,ESACC_F15_Editable,ESACC_F15_HideValue);

      ESACC_ESFLADSMgt.PageControl(
        36,14000830,0,16,
        ESACC_F16_Visible,ESACC_F16_Editable,ESACC_F16_HideValue);

      ESACC_ESFLADSMgt.PageControl(
        36,14000830,0,17,
        ESACC_F17_Visible,ESACC_F17_Editable,ESACC_F17_HideValue);

      ESACC_ESFLADSMgt.PageControl(
        36,14000830,0,91,
        ESACC_F91_Visible,ESACC_F91_Editable,ESACC_F91_HideValue);

      ESACC_ESFLADSMgt.PageControl(
        36,14000830,0,92,
        ESACC_F92_Visible,ESACC_F92_Editable,ESACC_F92_HideValue);

      ESACC_ESFLADSMgt.PageControl(
        36,14000830,0,100,
        ESACC_F100_Visible,ESACC_F100_Editable,ESACC_F100_HideValue);

      ESACC_ESFLADSMgt.PageControl(
        36,14000830,0,105,
        ESACC_F105_Visible,ESACC_F105_Editable,ESACC_F105_HideValue);

      ESACC_ESFLADSMgt.PageControl(
        36,14000830,0,14000701,
        ESACC_F14000701_Visible,ESACC_F14000701_Editable,ESACC_F14000701_HideValue);

      ESACC_ESFLADSMgt.PageControl(
        36,14000830,0,14000722,
        ESACC_F14000722_Visible,TempBoolean,ESACC_F14000722_HideValue);

      ESACC_ESFLADSMgt.PageControl(
        36,14000830,0,14000723,
        ESACC_F14000723_Visible,TempBoolean,ESACC_F14000723_HideValue);

      ESACC_EasySecurityManual(OpenObject);
    END;

    LOCAL PROCEDURE ESACC_EasySecurityManual@14123811(OpenObject@14123811 : Boolean);
    BEGIN
    END;

    PROCEDURE SetBillOfLadingCode@1(NewBillOfLadingNo@1000000000 : Code[20]);
    BEGIN
      BillOfLadingNo := NewBillOfLadingNo;
    END;

    LOCAL PROCEDURE CheckEDITradePartner@1000000000();
    VAR
      EDIDocument@1000000000 : Record 14002353;
    BEGIN
      //<TPZ2301>
      EDIDocument.RESET;
      EDIDocument.SETRANGE("Trade Partner No.","EDI Trade Partner");
      EDIDocument.SETRANGE("EDI Document No.",'856');
      EDIDocument.SETRANGE(Type,EDIDocument.Type::Export);
      EDIDocument.SETRANGE(Status,EDIDocument.Status::Production);
      IF EDIDocument.FINDFIRST THEN BEGIN
        "EDI ASN" := "EDI Order";
      END;
      //</TPZ2301>
    END;

    BEGIN
    {
      06-19-2018 TPZ2301 DKUMAR
       Added EDI Order Field.
    }
    END.
  }
}

