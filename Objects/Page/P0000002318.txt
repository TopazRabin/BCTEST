OBJECT Page 2318 BC O365 Sales Customer Card
{
  OBJECT-PROPERTIES
  {
    Date=10/22/20;
    Time=[ 4:57:39 AM];
    Version List=NAVW111.00.00.21836,NAVNA11.00.00.21836;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Contact;
               ESM=Contacto;
               FRC=Contact;
               ENC=Contact];
    SourceTable=Table18;
    DataCaptionExpr=Name;
    PageType=Card;
    OnInit=VAR
             O365SalesInitialSetup@1000 : Record 2110;
           BEGIN
             IF O365SalesInitialSetup.GET THEN
               IsUsingVAT := O365SalesInitialSetup.IsUsingVAT;
           END;

    OnOpenPage=BEGIN
                 SETRANGE("Date Filter",0D,WORKDATE);
                 ;ESACC_EasySecurity(TRUE);
               END;

    OnNewRecord=BEGIN
                  OnNewRec;
                END;

    OnInsertRecord=BEGIN
                     IF Name = '' THEN
                       CustomerCardState := CustomerCardState::Prompt
                     ELSE
                       CustomerCardState := CustomerCardState::Keep;

                     EXIT(TRUE);
                   END;

    OnModifyRecord=BEGIN
                     IF Name = '' THEN
                       CustomerCardState := CustomerCardState::Prompt
                     ELSE
                       CustomerCardState := CustomerCardState::Keep;

                     EXIT(TRUE);
                   END;

    OnDeleteRecord=BEGIN
                     O365SalesManagement.BlockCustomerAndDeleteContact(Rec);
                   END;

    OnQueryClosePage=BEGIN
                       EXIT(CanExitAfterProcessingCustomer);
                     END;

    OnAfterGetCurrRecord=VAR
                           TaxArea@1001 : Record 318;
                         BEGIN
                           CreateCustomerFromTemplate;

                           OverdueAmount := CalcOverdueBalance;

                           IF TaxArea.GET("Tax Area Code") THEN
                             TaxAreaDescription := TaxArea.GetDescriptionInCurrentLanguage;

                           // Supergroup is visible only if one of the two subgroups is visible
                           SalesAndPaymentsVisible := (NOT TotalsHidden) OR
                             (("Contact Type" = "Contact Type"::Company) AND IsUsingVAT);
                         END;

    ActionList=ACTIONS
    {
      { 11      ;0   ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 9       ;1   ;Action    ;
                      Name=NewSalesInvoice;
                      CaptionML=[ENU=New Invoice;
                                 ESM=Nueva factura;
                                 FRC=Nouvelle facture;
                                 ENC=New Invoice];
                      ToolTipML=[ENU=Create a new invoice for the customer.;
                                 ESM=Crea una nueva factura de venta para el cliente.;
                                 FRC=Cr‚ez une nouvelle facture pour le client.;
                                 ENC=Create a new invoice for the customer.];
                      ApplicationArea=#Basic,#Suite,#Invoicing;
                      Promoted=Yes;
                      Visible=ESACC_C9_Visible AND (NewDocumentActionVisible);
                      Enabled=ESACC_C9_Enabled AND (Name <> '');
                      PromotedIsBig=Yes;
                      Image=Invoicing-MDL-Invoice;
                      Scope=Repeater;
                      OnAction=BEGIN
                                 O365SalesManagement.OpenNewInvoiceForCustomer(Rec);
                               END;
                                }
      { 10      ;1   ;Action    ;
                      Name=NewSalesQuote;
                      CaptionML=[ENU=New Estimate;
                                 ESM=Nueva estimaci¢n;
                                 FRC=Nouvelle estimation;
                                 ENC=New Estimate];
                      ToolTipML=[ENU=Create an estimate for the customer.;
                                 ESM=Crear una estimaci¢n para el cliente.;
                                 FRC=Cr‚ez une estimation pour le client.;
                                 ENC=Create an estimate for the customer.];
                      ApplicationArea=#Basic,#Suite,#Invoicing;
                      Promoted=Yes;
                      Visible=ESACC_C10_Visible AND (NewDocumentActionVisible);
                      Enabled=ESACC_C10_Enabled AND (Name <> '');
                      PromotedIsBig=Yes;
                      Image=Invoicing-MDL-Quote;
                      Scope=Repeater;
                      OnAction=BEGIN
                                 O365SalesManagement.OpenNewQuoteForCustomer(Rec);
                               END;
                                }
      { 24      ;1   ;Action    ;
                      Name=Delete;
                      CaptionML=[ENU=Delete;
                                 ESM=Eliminar;
                                 FRC=Supprimer;
                                 ENC=Delete];
                      ToolTipML=[ENU=Delete the record.;
                                 ESM=Eliminar el registro.;
                                 FRC=Supprimer l'enregistrement.;
                                 ENC=Delete the record.];
                      ApplicationArea=#Basic,#Suite,#Invoicing;
                      Promoted=Yes;
                      Visible=ESACC_C24_Visible;
                      Enabled=ESACC_C24_Enabled;
                      PromotedIsBig=Yes;
                      Image=Invoicing-MDL-Delete;
                      OnAction=BEGIN
                                 IF NOT CONFIRM(DeleteQst,FALSE) THEN
                                   EXIT;
                                 O365SalesManagement.BlockCustomerAndDeleteContact(Rec);
                                 CurrPage.CLOSE;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1   ;0   ;Container ;
                ContainerType=ContentArea }

    { 2   ;1   ;Group     ;
                Name=General;
                CaptionML=[ENU=Basic Profile;
                           ESM=Perfil b sico;
                           FRC=Profil de base;
                           ENC=Basic Profile];
                GroupType=Group }

    { 3   ;2   ;Field     ;
                CaptionML=[ENU=Contact Name;
                           ESM=Nombre de contacto;
                           FRC=Nom du contact;
                           ENC=Contact Name];
                ToolTipML=[ENU=Specifies the customer's name.;
                           ESM=Especifica el nombre del cliente.;
                           FRC=Sp‚cifie le nom du client.;
                           ENC=Specifies the customer's name.];
                ApplicationArea=#Basic,#Suite,#Invoicing;
                SourceExpr=Name;
                Importance=Promoted;
                Visible=ESACC_F2_Visible;
                Editable=ESACC_F2_Editable;
                HideValue=ESACC_F2_HideValue }

    { 25  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies if the contact is a company or a person.;
                           ESM=Especifica si el contacto es una empresa o una persona.;
                           FRC=Sp‚cifie si le contact est une compagnie ou une personne.;
                           ENC=Specifies if the contact is a company or a person.];
                OptionCaptionML=[ENU=Company contact,Person;
                                 ESM=Contacto de empresa,Persona;
                                 FRC=Contact compagnie,Personne;
                                 ENC=Company contact,Person];
                ApplicationArea=#Basic,#Suite,#Invoicing;
                SourceExpr="Contact Type";
                Visible=ESACC_F5050_Visible;
                Editable=ESACC_F5050_Editable;
                HideValue=ESACC_F5050_HideValue }

    { 26  ;1   ;Group     ;
                CaptionML=[ENU=Contact Info;
                           ESM=Informaci¢n de contacto;
                           FRC=Informations du contact;
                           ENC=Contact Info];
                GroupType=Group }

    { 4   ;2   ;Field     ;
                ExtendedDatatype=E-Mail;
                CaptionML=[ENU=Email Address;
                           ESM=Direcci¢n de correo elect.;
                           FRC=Adresse de courriel;
                           ENC=Email Address];
                ToolTipML=[ENU=Specifies the customer's email address.;
                           ESM=Especifica la direcci¢n de correo electr¢nico del cliente.;
                           FRC=Sp‚cifie l'adresse de courriel du client.;
                           ENC=Specifies the customer's email address.];
                ApplicationArea=#Basic,#Suite,#Invoicing;
                SourceExpr="E-Mail";
                Importance=Promoted;
                Visible=ESACC_F102_Visible;
                Editable=ESACC_F102_Editable;
                HideValue=ESACC_F102_HideValue;
                OnValidate=VAR
                             MailManagement@1000 : Codeunit 9520;
                           BEGIN
                             IF "E-Mail" <> '' THEN
                               MailManagement.CheckValidEmailAddress("E-Mail");
                           END;
                            }

    { 7   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the customer's telephone number.;
                           ESM=Especifica el n£mero de tel‚fono del cliente.;
                           FRC=Sp‚cifie le num‚ro de t‚l‚phone du client.;
                           ENC=Specifies the customer's telephone number.];
                ApplicationArea=#Basic,#Suite,#Invoicing;
                SourceExpr="Phone No.";
                Importance=Promoted;
                Visible=ESACC_F9_Visible;
                Editable=ESACC_F9_Editable;
                HideValue=ESACC_F9_HideValue }

    { 27  ;1   ;Group     ;
                CaptionML=[ENU=Business Address;
                           ESM=Direcci¢n de la empresa;
                           FRC=Adresse professionnelle;
                           ENC=Business Address];
                GroupType=Group }

    { 15  ;2   ;Field     ;
                ApplicationArea=#Basic,#Suite,#Invoicing;
                SourceExpr=Address;
                Visible=ESACC_F5_Visible;
                Editable=ESACC_F5_Editable;
                HideValue=ESACC_F5_HideValue }

    { 17  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies additional address information.;
                           ESM=Especifica informaci¢n adicional de la direcci¢n.;
                           FRC=Sp‚cifie des informations d'adresse suppl‚mentaires.;
                           ENC=Specifies additional address information.];
                ApplicationArea=#Basic,#Suite,#Invoicing;
                SourceExpr="Address 2";
                Visible=ESACC_F6_Visible;
                Editable=ESACC_F6_Editable;
                HideValue=ESACC_F6_HideValue }

    { 18  ;2   ;Field     ;
                Lookup=No;
                ApplicationArea=#Basic,#Suite,#Invoicing;
                SourceExpr="Post Code";
                Visible=ESACC_F91_Visible;
                Enabled=ESACC_F91_Editable;
                Editable=ESACC_F91_Editable;
                HideValue=ESACC_F91_HideValue }

    { 22  ;2   ;Field     ;
                Lookup=No;
                ApplicationArea=#Basic,#Suite,#Invoicing;
                SourceExpr=City;
                Visible=ESACC_F7_Visible;
                Enabled=ESACC_F7_Editable;
                Editable=ESACC_F7_Editable;
                HideValue=ESACC_F7_HideValue }

    { 20  ;2   ;Field     ;
                ApplicationArea=#Basic,#Suite,#Invoicing;
                SourceExpr=County;
                Visible=ESACC_F92_Visible;
                Editable=ESACC_F92_Editable;
                HideValue=ESACC_F92_HideValue }

    { 23  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the country/region of the address.;
                           ESM=Especifica el pa¡s o la regi¢n de la direcci¢n.;
                           FRC=Sp‚cifie le pays/la r‚gion de l'adresse.;
                           ENC=Specifies the country/region of the address.];
                ApplicationArea=#Basic,#Suite,#Invoicing;
                SourceExpr="Country/Region Code";
                Visible=ESACC_F35_Visible;
                Editable=ESACC_F35_Editable;
                LookupPageID=BC O365 Country/Region List;
                HideValue=ESACC_F35_HideValue }

    { 28  ;1   ;Group     ;
                CaptionML=[ENU=Sales and Payments;
                           ESM=Ventas y pagos;
                           FRC=Ventes et paiements;
                           ENC=Sales and Payments];
                Visible=SalesAndPaymentsVisible;
                GroupType=Group }

    { 16  ;2   ;Group     ;
                Visible=NOT TotalsHidden;
                GroupType=Group }

    { 5   ;3   ;Field     ;
                Lookup=No;
                DrillDown=No;
                CaptionML=[ENU=Outstanding;
                           ESM=Pendientes;
                           FRC=En suspens;
                           ENC=Outstanding];
                ToolTipML=[ENU=Specifies the customer's balance.;
                           ESM=Especifica el saldo del cliente.;
                           FRC=Sp‚cifie le solde du client.;
                           ENC=Specifies the customer's balance.];
                ApplicationArea=#Basic,#Suite,#Invoicing;
                SourceExpr="Balance (LCY)";
                AutoFormatType=10;
                AutoFormatExpr='1';
                Visible=ESACC_F59_Visible;
                HideValue=ESACC_F59_HideValue }

    { 6   ;3   ;Field     ;
                Lookup=No;
                DrillDown=No;
                CaptionML=[ENU=Overdue;
                           ESM=Vencidos;
                           FRC=chu;
                           ENC=Overdue];
                ToolTipML=[ENU=Specifies payments from the customer that are overdue per today's date.;
                           ESM=Especifica los pagos del cliente que est n vencidos en la fecha actual.;
                           FRC=Sp‚cifie les paiements effectu‚s par le client qui sont ‚chus … la date du jour.;
                           ENC=Specifies payments from the customer that are overdue per today's date.];
                ApplicationArea=#Basic,#Suite,#Invoicing;
                SourceExpr=OverdueAmount;
                AutoFormatType=10;
                AutoFormatExpr='1';
                Editable=FALSE;
                Style=Unfavorable;
                StyleExpr=OverdueAmount > 0 }

    { 8   ;3   ;Field     ;
                Lookup=No;
                DrillDown=No;
                CaptionML=[ENU=Total Sales (Excl. Tax);
                           ESM=Ventas totales (IVA excl.);
                           FRC=Total des ventes (HT);
                           ENC=Total Sales (Excl. Tax)];
                ToolTipML=[ENU=Specifies the total net amount of sales to the customer in $.;
                           ESM=Especifica el importe neto total de las ventas efectuadas al cliente en la divisa local.;
                           FRC=Sp‚cifie le montant net total des ventes … ce client en $.;
                           ENC=Specifies the total net amount of sales to the customer in $.];
                ApplicationArea=#Basic,#Suite,#Invoicing;
                SourceExpr="Sales (LCY)";
                AutoFormatType=10;
                AutoFormatExpr='1';
                Visible=ESACC_F62_Visible;
                HideValue=ESACC_F62_HideValue }

    { 13  ;2   ;Group     ;
                Visible=("Contact Type" = "Contact Type"::Company) AND IsUsingVAT;
                GroupType=Group }

    { 21  ;3   ;Field     ;
                ApplicationArea=#Basic,#Suite,#Invoicing;
                SourceExpr="VAT Registration No.";
                Visible=ESACC_F86_Visible;
                Editable=ESACC_F86_Editable;
                HideValue=ESACC_F86_HideValue }

    { 12  ;1   ;Group     ;
                Name=Tax Information;
                CaptionML=[ENU=Tax;
                           ESM=Impuesto;
                           FRC=Taxe;
                           ENC=Tax];
                Visible=NOT IsUsingVAT;
                GroupType=Group }

    { 14  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies if the sales invoice contains sales tax.;
                           ESM=Especifica si la factura de venta contiene el impuesto sobre las ventas.;
                           FRC=Sp‚cifie si la facture vente contient la taxe de vente.;
                           ENC=Specifies if the sales invoice contains sales tax.];
                ApplicationArea=#Basic,#Suite,#Invoicing;
                SourceExpr="Tax Liable";
                Visible=ESACC_F109_Visible;
                Editable=ESACC_F109_Editable;
                HideValue=ESACC_F109_HideValue }

    { 19  ;2   ;Field     ;
                CaptionML=[ENU=Tax Rate;
                           ESM=Tasa de impuesto;
                           FRC=Taux de taxe;
                           ENC=Tax Rate];
                ToolTipML=[ENU=Specifies the customer's tax area.;
                           ESM=Especifica el  rea de impuesto del cliente.;
                           FRC=Sp‚cifie la r‚gion fiscale du client.;
                           ENC=Specifies the customer's tax area.];
                ApplicationArea=#Basic,#Suite,#Invoicing;
                NotBlank=Yes;
                SourceExpr=TaxAreaDescription;
                Importance=Promoted;
                OnLookup=VAR
                           TaxArea@1001 : Record 318;
                         BEGIN
                           IF PAGE.RUNMODAL(PAGE::"O365 Tax Area List",TaxArea) = ACTION::LookupOK THEN BEGIN
                             VALIDATE("Tax Area Code",TaxArea.Code);
                             TaxAreaDescription := TaxArea.GetDescriptionInCurrentLanguage;
                           END;
                         END;

                QuickEntry=FALSE }

  }
  CODE
  {
    VAR
      ESACC_ESFLADSMgt@14123801 : Codeunit 14123801;
      ESACC_C9_Visible@905000090 : Boolean INDATASET;
      ESACC_C9_Enabled@905000093 : Boolean INDATASET;
      ESACC_C10_Visible@905000100 : Boolean INDATASET;
      ESACC_C10_Enabled@905000103 : Boolean INDATASET;
      ESACC_C24_Visible@905000240 : Boolean INDATASET;
      ESACC_C24_Enabled@905000243 : Boolean INDATASET;
      ESACC_F2_Visible@900000020 : Boolean INDATASET;
      ESACC_F2_Editable@900000021 : Boolean INDATASET;
      ESACC_F2_HideValue@900000022 : Boolean INDATASET;
      ESACC_F5_Visible@900000050 : Boolean INDATASET;
      ESACC_F5_Editable@900000051 : Boolean INDATASET;
      ESACC_F5_HideValue@900000052 : Boolean INDATASET;
      ESACC_F6_Visible@900000060 : Boolean INDATASET;
      ESACC_F6_Editable@900000061 : Boolean INDATASET;
      ESACC_F6_HideValue@900000062 : Boolean INDATASET;
      ESACC_F7_Visible@900000070 : Boolean INDATASET;
      ESACC_F7_Editable@900000071 : Boolean INDATASET;
      ESACC_F7_HideValue@900000072 : Boolean INDATASET;
      ESACC_F9_Visible@900000090 : Boolean INDATASET;
      ESACC_F9_Editable@900000091 : Boolean INDATASET;
      ESACC_F9_HideValue@900000092 : Boolean INDATASET;
      ESACC_F35_Visible@900000350 : Boolean INDATASET;
      ESACC_F35_Editable@900000351 : Boolean INDATASET;
      ESACC_F35_HideValue@900000352 : Boolean INDATASET;
      ESACC_F59_Visible@900000590 : Boolean INDATASET;
      ESACC_F59_HideValue@900000592 : Boolean INDATASET;
      ESACC_F62_Visible@900000620 : Boolean INDATASET;
      ESACC_F62_HideValue@900000622 : Boolean INDATASET;
      ESACC_F86_Visible@900000860 : Boolean INDATASET;
      ESACC_F86_Editable@900000861 : Boolean INDATASET;
      ESACC_F86_HideValue@900000862 : Boolean INDATASET;
      ESACC_F91_Visible@900000910 : Boolean INDATASET;
      ESACC_F91_Editable@900000911 : Boolean INDATASET;
      ESACC_F91_HideValue@900000912 : Boolean INDATASET;
      ESACC_F92_Visible@900000920 : Boolean INDATASET;
      ESACC_F92_Editable@900000921 : Boolean INDATASET;
      ESACC_F92_HideValue@900000922 : Boolean INDATASET;
      ESACC_F102_Visible@900001020 : Boolean INDATASET;
      ESACC_F102_Editable@900001021 : Boolean INDATASET;
      ESACC_F102_HideValue@900001022 : Boolean INDATASET;
      ESACC_F109_Visible@900001090 : Boolean INDATASET;
      ESACC_F109_Editable@900001091 : Boolean INDATASET;
      ESACC_F109_HideValue@900001092 : Boolean INDATASET;
      ESACC_F5050_Visible@900050500 : Boolean INDATASET;
      ESACC_F5050_Editable@900050501 : Boolean INDATASET;
      ESACC_F5050_HideValue@900050502 : Boolean INDATASET;
      CustContUpdate@1006 : Codeunit 5056;
      O365SalesManagement@1013 : Codeunit 2107;
      ProcessNewCustomerOptionQst@1001 : TextConst 'ENU=Keep editing,Discard;ESM=Conservar edici¢n,Descartar;FRC=Continuer modification,Ignorer;ENC=Keep editing,Discard';
      ProcessNewCustomerInstructionTxt@1003 : TextConst 'ENU=Name is missing. Keep the customer?;ESM=Falta el nombre. ¨Conservar el cliente?;FRC=Nom manquant. Conserver le clientÿ?;ENC=Name is missing. Keep the customer?';
      CustomerCardState@1000 : 'Keep,Delete,Prompt';
      NewMode@1007 : Boolean;
      IsUsingVAT@1005 : Boolean;
      NewDocumentActionVisible@1010 : Boolean;
      OverdueAmount@1008 : Decimal;
      TaxAreaDescription@1004 : Text[50];
      DeleteQst@1002 : TextConst 'ENU=Are you sure?;ESM=¨Est  seguro?;FRC=Òtes-vous certainÿ?;ENC=Are you sure?';
      TotalsHidden@1009 : Boolean;
      SalesAndPaymentsVisible@1011 : Boolean;

    LOCAL PROCEDURE ESACC_EasySecurity@14123801(OpenObject@14123801 : Boolean);
    VAR
      SetFilters@14123802 : Codeunit 14123812;
      TempBoolean@14123803 : Boolean;
    BEGIN
      IF OpenObject THEN BEGIN
        SetFilters.Filter18(Rec,8,2318);

        TempBoolean := CurrPage.EDITABLE;
        IF ESACC_ESFLADSMgt.PageGeneral(18,2318,TempBoolean) THEN
          CurrPage.EDITABLE := TempBoolean;
      END;

      ESACC_ESFLADSMgt.PageControl(
        18,2318,1,9,
        ESACC_C9_Visible,ESACC_C9_Enabled,TempBoolean);

      ESACC_ESFLADSMgt.PageControl(
        18,2318,1,10,
        ESACC_C10_Visible,ESACC_C10_Enabled,TempBoolean);

      ESACC_ESFLADSMgt.PageControl(
        18,2318,1,24,
        ESACC_C24_Visible,ESACC_C24_Enabled,TempBoolean);

      ESACC_ESFLADSMgt.PageControl(
        18,2318,0,2,
        ESACC_F2_Visible,ESACC_F2_Editable,ESACC_F2_HideValue);

      ESACC_ESFLADSMgt.PageControl(
        18,2318,0,5,
        ESACC_F5_Visible,ESACC_F5_Editable,ESACC_F5_HideValue);

      ESACC_ESFLADSMgt.PageControl(
        18,2318,0,6,
        ESACC_F6_Visible,ESACC_F6_Editable,ESACC_F6_HideValue);

      ESACC_ESFLADSMgt.PageControl(
        18,2318,0,7,
        ESACC_F7_Visible,ESACC_F7_Editable,ESACC_F7_HideValue);

      ESACC_ESFLADSMgt.PageControl(
        18,2318,0,9,
        ESACC_F9_Visible,ESACC_F9_Editable,ESACC_F9_HideValue);

      ESACC_ESFLADSMgt.PageControl(
        18,2318,0,35,
        ESACC_F35_Visible,ESACC_F35_Editable,ESACC_F35_HideValue);

      ESACC_ESFLADSMgt.PageControl(
        18,2318,0,59,
        ESACC_F59_Visible,TempBoolean,ESACC_F59_HideValue);

      ESACC_ESFLADSMgt.PageControl(
        18,2318,0,62,
        ESACC_F62_Visible,TempBoolean,ESACC_F62_HideValue);

      ESACC_ESFLADSMgt.PageControl(
        18,2318,0,86,
        ESACC_F86_Visible,ESACC_F86_Editable,ESACC_F86_HideValue);

      ESACC_ESFLADSMgt.PageControl(
        18,2318,0,91,
        ESACC_F91_Visible,ESACC_F91_Editable,ESACC_F91_HideValue);

      ESACC_ESFLADSMgt.PageControl(
        18,2318,0,92,
        ESACC_F92_Visible,ESACC_F92_Editable,ESACC_F92_HideValue);

      ESACC_ESFLADSMgt.PageControl(
        18,2318,0,102,
        ESACC_F102_Visible,ESACC_F102_Editable,ESACC_F102_HideValue);

      ESACC_ESFLADSMgt.PageControl(
        18,2318,0,109,
        ESACC_F109_Visible,ESACC_F109_Editable,ESACC_F109_HideValue);

      ESACC_ESFLADSMgt.PageControl(
        18,2318,0,5050,
        ESACC_F5050_Visible,ESACC_F5050_Editable,ESACC_F5050_HideValue);

      ESACC_EasySecurityManual(OpenObject);
    END;

    LOCAL PROCEDURE ESACC_EasySecurityManual@14123811(OpenObject@14123811 : Boolean);
    BEGIN
    END;

    LOCAL PROCEDURE CanExitAfterProcessingCustomer@2() : Boolean;
    VAR
      Response@1001 : ',KeepEditing,Discard';
    BEGIN
      IF "No." = '' THEN
        EXIT(TRUE);

      IF CustomerCardState = CustomerCardState::Delete THEN
        EXIT(DeleteCustomerRelatedData);

      IF GUIALLOWED AND (CustomerCardState = CustomerCardState::Prompt)
         AND (Blocked = Blocked::" ") AND NOT "Privacy Blocked"
      THEN
        CASE STRMENU(ProcessNewCustomerOptionQst,Response::KeepEditing,ProcessNewCustomerInstructionTxt) OF
          Response::Discard:
            EXIT(DeleteCustomerRelatedData);
          ELSE
            EXIT(FALSE);
        END;

      EXIT(TRUE);
    END;

    LOCAL PROCEDURE DeleteCustomerRelatedData@4() : Boolean;
    BEGIN
      CustContUpdate.DeleteCustomerContacts(Rec);

      // workaround for bug: delete for new empty record returns false
      IF DELETE(TRUE) THEN;
      EXIT(TRUE);
    END;

    LOCAL PROCEDURE OnNewRec@1();
    VAR
      DocumentNoVisibility@1000 : Codeunit 1400;
    BEGIN
      IF GUIALLOWED AND DocumentNoVisibility.CustomerNoSeriesIsDefault THEN
        NewMode := TRUE;
    END;

    LOCAL PROCEDURE CreateCustomerFromTemplate@3();
    VAR
      MiniCustomerTemplate@1001 : Record 1300;
      Customer@1000 : Record 18;
    BEGIN
      IF NewMode THEN BEGIN
        IF MiniCustomerTemplate.NewCustomerFromTemplate(Customer) THEN
          COPY(Customer);

        TotalsHidden := TRUE;

        CustomerCardState := CustomerCardState::Delete;
        NewMode := FALSE;
        CurrPage.UPDATE;
      END;
    END;

    PROCEDURE SetNewDocumentActionsVisible@5();
    BEGIN
      NewDocumentActionVisible := TRUE;
    END;

    BEGIN
    END.
  }
}

