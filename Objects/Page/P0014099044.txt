OBJECT Page 14099044 Assisted OWR Setup Toolbox
{
  OBJECT-PROPERTIES
  {
    Date=08/21/18;
    Time=12:00:00 PM;
    Version List=RF1.50.13;
  }
  PROPERTIES
  {
    OnQueryClosePage=VAR
                       RFSetup@1240020000 : Record 14002801;
                     BEGIN
                       IF CloseAction = ACTION::OK THEN BEGIN
                         IF NOT RFSetup.GET('') THEN
                           OWRAssistedSetup.SetStatus(PAGE::"Assisted OWR Setup Toolbox",OWRAssistedSetup.Status::"Not Completed");

                         IF OWRAssistedSetup.GetStatus(PAGE::"Assisted OWR Setup Toolbox") = OWRAssistedSetup.Status::"Not Completed" THEN
                           IF Progress[1] AND Progress[2] AND Progress [3] THEN
                             OWRAssistedSetup.SetStatus(PAGE::"Assisted OWR Setup Toolbox",OWRAssistedSetup.Status::Completed);
                       END;
                     END;

    ActionList=ACTIONS
    {
      { 1240020001;  ;ActionContainer;
                      Name=OWR Setup Toolbox;
                      CaptionML=ENU=OWR Setup Toolbox;
                      ActionContainerType=ActionItems }
      { 1240020005;1 ;ActionGroup;
                      Name=Setup Toolbox;
                      CaptionML=ENU=Setup Toolbox }
      { 1240020008;2 ;Action    ;
                      Name=Create the Default OWR Setup;
                      CaptionML=ENU=Create the Default OWR Setup;
                      ToolTipML=ENU=This option creates the default setup necessary for OWR to function. This creates the default RF Setup record, the default RF Employee Setup Code for OWR, and the default Outbound Warehouse Request Actions.;
                      ApplicationArea=#All;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Setup;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 OWRSetupCodeunit.InitiateOWRSetup;
                                 Progress[1] := TRUE;
                               END;
                                }
      { 1240020007;2 ;Action    ;
                      Name=Update Warehouse Request Records;
                      CaptionML=ENU=Update Warehouse Request Records;
                      ToolTipML=ENU=This option updates the Whse. Completely Handled and ATO Pick Required Booleans on the Warehouse Request table for orders that existed prior to implementing OWR.;
                      ApplicationArea=#All;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Setup;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 WhseRqst@1240020000 : Record 5765;
                                 WhseRqst2@1240020001 : Record 5765;
                                 TransferHeader@1240020002 : Record 5740;
                                 RFSetup@1240020003 : Record 14002801;
                                 OutboundWhseRequestMgt@1000 : Codeunit 14002863;
                                 AssemblyOrderNo@1240020004 : Code[20];
                               BEGIN
                                 WhseRqst.RESET;
                                 WhseRqst.SETRANGE(Type,WhseRqst.Type::Outbound);
                                 IF WhseRqst.FIND('-') THEN
                                   REPEAT
                                     WhseRqst2 := WhseRqst;
                                     OutboundWhseRequestMgt.UpdateWarehouseRequest(WhseRqst2);
                                     IF WhseRqst."Source Type" = 5741 THEN
                                       IF TransferHeader.GET(WhseRqst2."Source No.") THEN
                                         WhseRqst2."Shipment Date" := TransferHeader."Shipment Date";

                                     RFSetup.GetRFSetup;
                                     IF RFSetup.GetFirstAssemblyOrderNo(WhseRqst2,AssemblyOrderNo) THEN BEGIN
                                       WhseRqst2."First Assembly Order No." := AssemblyOrderNo;
                                       WhseRqst2."ATO Pick Required" := TRUE;
                                     END;

                                     WhseRqst2.MODIFY;
                                   UNTIL WhseRqst.NEXT = 0;
                                 Progress[2] := TRUE;
                               END;
                                }
      { 1       ;2   ;Action    ;
                      Name=Update User Roles;
                      CaptionML=ENU=Update User Roles;
                      ToolTipML=ENU=This creates the default OWR Permission Sets and User Roles. The OWR-ALL role should be assigned to all users. The OWR-SUPER role should be assigned to any user that will be managing the setup and configuration of OWR. The OWR-WORK role can be assigned to users that are working with OWR.;
                      ApplicationArea=#All;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Setup;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 OWRSetupCodeunit.CreateOWRRoles(FALSE);
                                 Progress[3] := TRUE;
                               END;
                                }
      { 1240020002;2 ;Action    ;
                      Name=Reset All;
                      CaptionML=ENU=Reset All;
                      ToolTipML=ENU=This option resets the Toolbox so options can be run again.;
                      ApplicationArea=#All;
                      Promoted=Yes;
                      Image=ResetStatus;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 i@1240020000 : Integer;
                               BEGIN
                                 FOR i := 1 TO 9 DO BEGIN
                                   Progress[i] := FALSE;
                                 END;
                               END;
                                }
      { 1240020004;1 ;ActionGroup;
                      Name=Delete Utilities;
                      CaptionML=ENU=Delete Utilities;
                      Visible=FALSE }
      { 1240020003;2 ;Action    ;
                      Name=Delete OWR Setup;
                      CaptionML=ENU=Delete OWR Setup;
                      ToolTipML=ENU=This option deletes the OWR specific setup tables.;
                      ApplicationArea=#All;
                      Image=Delete;
                      OnAction=VAR
                                 i@1240020000 : Integer;
                               BEGIN
                                 IF CONFIRM(ConfirmDeleteSetup,FALSE) THEN BEGIN
                                   OWRSetupCodeunit.ResetOWRSetup(TRUE);
                                   FOR i := 1 TO 9 DO BEGIN
                                     Progress[i] := FALSE;
                                   END;
                                 END;
                               END;
                                }
      { 1240020012;2 ;Action    ;
                      Name=Delete OWR Base Setup;
                      CaptionML=ENU=Delete OWR Base Setup;
                      ToolTipML=ENU=This option deletes the OWR specific setup on base host tables. This includes removing OWR setup on Warehouse Worksheets, Warehouse Employees, Zones, Bins, Bin Contents, the associated OWR No. Series, and the OWR information on the Warehouse Request table.;
                      ApplicationArea=#All;
                      Image=Delete;
                      OnAction=VAR
                                 i@1240020000 : Integer;
                               BEGIN
                                 IF CONFIRM(ConfirmDeleteOWRBaseSetup,FALSE) THEN BEGIN
                                   OWRSetupCodeunit.ResetOWRBaseRelatedSetup(TRUE);
                                   FOR i := 1 TO 9 DO BEGIN
                                     Progress[i] := FALSE;
                                   END;
                                 END;
                               END;
                                }
      { 1240020014;2 ;Action    ;
                      Name=Delete OWR App Data;
                      CaptionML=ENU=Delete OWR App Data;
                      ToolTipML=ENU=This option deletes the OWR specific application data. This deletes the registered, archived, and pending data in the Warehouse Activity Group tables, Action Entries tables, Wave Pick Warehouse Request tables, Pick Request tables, and the buffer tables for building OWR statistics and replenishments.;
                      ApplicationArea=#All;
                      Image=Delete;
                      OnAction=VAR
                                 i@1240020000 : Integer;
                               BEGIN
                                 IF CONFIRM(ConfirmDeleteOWRAppData,FALSE) THEN BEGIN
                                   OWRSetupCodeunit.ResetOWRApplicationData(TRUE);
                                   FOR i := 1 TO 9 DO BEGIN
                                     Progress[i] := FALSE;
                                   END;
                                 END;
                               END;
                                }
      { 1240020018;2 ;Action    ;
                      Name=Delete OWR Permissions;
                      CaptionML=ENU=Delete OWR Permissions;
                      ToolTipML=ENU=This option deletes the OWR permissions and permission sets. This also removes these permissions from the users.;
                      ApplicationArea=#All;
                      Image=Delete;
                      OnAction=VAR
                                 i@1240020000 : Integer;
                               BEGIN
                                 IF CONFIRM(ConfirmDeleteOWRPerm,FALSE) THEN BEGIN
                                   OWRSetupCodeunit.ResetOWRPermissions(TRUE);
                                   FOR i := 1 TO 9 DO BEGIN
                                     Progress[i] := FALSE;
                                   END;
                                 END;
                               END;
                                }
      { 1240020019;2 ;Action    ;
                      Name=Delete OWR All;
                      CaptionML=ENU=Delete OWR All;
                      ToolTipML=ENU=This option deletes all setup, permissions, and the OWR specific application data. This deletes the registered, archived, and pending data in the Warehouse Activity Group tables, Action Entries tables, Wave Pick Warehouse Request tables, Pick Request tables, and the buffer tables for building OWR statistics and replenishments.;
                      ApplicationArea=#All;
                      Image=Delete;
                      OnAction=VAR
                                 i@1240020000 : Integer;
                               BEGIN
                                 IF CONFIRM(ConfirmDeleteAllSetup,FALSE) THEN BEGIN
                                   OWRSetupCodeunit.ResetAllOWRSetup(TRUE);
                                   FOR i := 1 TO 9 DO BEGIN
                                     Progress[i] := FALSE;
                                   END;
                                 END;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1240020000;;Container;
                Name=OWR Toolbox;
                CaptionML=ENU=OWR Toolbox;
                ContainerType=ContentArea }

    { 1240020013;1;Field  ;
                Name=Create Default OWR Setup;
                CaptionML=ENU=Create Default OWR Setup;
                ToolTipML=ENU=This option creates the default setup necessary for OWR to function. This creates the default RF Setup record, the default RF Employee Setup Code for OWR, and the default Outbound Warehouse Request Actions.;
                ApplicationArea=#All;
                SourceExpr=Progress[1];
                Editable=FALSE }

    { 1240020015;1;Field  ;
                Name=Update Warehouse Request Records;
                CaptionML=ENU=Update Warehouse Request Records;
                ToolTipML=ENU=This option updates the Whse. Completely Handled and ATO Pick Required Booleans on the Warehouse Request table for orders that existed prior to implementing OWR.;
                ApplicationArea=#All;
                SourceExpr=Progress[2];
                Editable=FALSE }

    { 1240020017;1;Field  ;
                Name=Update User Roles;
                CaptionML=ENU=Update User Roles;
                ToolTipML=ENU=This creates the default OWR Permission Sets and User Roles. The OWR-ALL role should be assigned to all users. The OWR-SUPER role should be assigned to any user that will be managing the setup and configuration of OWR. The OWR-WORK role can be assigned to users that are working with OWR.;
                ApplicationArea=#All;
                SourceExpr=Progress[3];
                Editable=FALSE }

    { 1240020016;1;Field  ;
                Name=Reset Setup Progress;
                CaptionML=ENU=Reset Setup Progress;
                ToolTipML=ENU=This option resets the Toolbox so options can be run again.;
                ApplicationArea=#All;
                SourceExpr=Progress[4];
                Editable=FALSE;
                OnValidate=VAR
                             i@1240020000 : Integer;
                           BEGIN
                             FOR i := 1 TO 9 DO BEGIN
                               Progress[i] := FALSE;
                             END;
                           END;
                            }

  }
  CODE
  {
    VAR
      OWRAssistedSetup@1240020007 : Record 14099040;
      OWRSetupCodeunit@1240020001 : Codeunit 14099043;
      Progress@1240020000 : ARRAY [10] OF Boolean;
      ConfirmDeleteSetup@1240020002 : TextConst 'ENU=Are you sure you want to delete all OWR setup?';
      ConfirmDeleteAllSetup@1240020003 : TextConst 'ENU=Are you sure you want to delete all OWR application data, setup, and permissions? This includes all pending activity, OWR specific registered documents, OWR specific archived documents, OWR related setup, and OWR specific permissions.';
      ConfirmDeleteOWRBaseSetup@1240020004 : TextConst 'ENU=Are you sure you want to delete all OWR setup on base NAV tables?';
      ConfirmDeleteOWRAppData@1240020005 : TextConst 'ENU=Are you sure you want to delete all OWR application data? This includes all pending activity, OWR specific registered documents, and OWR specific archived documents.';
      ConfirmDeleteOWRPerm@1240020006 : TextConst 'ENU=Are you sure you want to delete all OWR permissions?';

    BEGIN
    END.
  }
}

