OBJECT Page 11123321 SC - Data Valid. Rule Subform
{
  OBJECT-PROPERTIES
  {
    Date=04/18/17;
    Time=[ 1:00:00 PM];
    Version List=SCW19.2.0;
  }
  PROPERTIES
  {
    CaptionML=ENU=Lines;
    SourceTable=Table11123321;
    DelayedInsert=Yes;
    PageType=ListPart;
    OnAfterGetRecord=VAR
                       Validation@11123302 : Codeunit 11123310;
                     BEGIN
                       GetEmptyDefaultValue;
                       OnAfterGetCurrRecord;
                     END;

    OnNewRecord=BEGIN
                  Priority := GetNextSortNo;
                  OnAfterGetCurrRecord;
                END;

    OnQueryClosePage=BEGIN
                       DeleteAllValidLinesFromCache;
                     END;

  }
  CONTROLS
  {
    { 11123309;0;Container;
                ContainerType=ContentArea }

    { 11123308;1;Group    ;
                GroupType=Repeater }

    { 11123307;2;Field    ;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Field Name";
                OnAssistEdit=BEGIN
                               GetFieldNo;
                             END;
                              }

    { 11123305;2;Field    ;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Field Caption";
                Visible=FALSE;
                OnAssistEdit=BEGIN
                               GetFieldNo;
                             END;
                              }

    { 11123306;2;Field    ;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=Method;
                OnValidate=BEGIN
                             MethodOnAfterValidate;
                           END;
                            }

    { 11123304;2;Field    ;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=Value }

    { 11123303;2;Field    ;
                ToolTipML=ENU=The error text will be used in case of negative result of current expression.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Error Text" }

    { 11123302;2;Field    ;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=Priority;
                OnValidate=BEGIN
                             PriorityOnAfterValidate;
                           END;
                            }

  }
  CODE
  {

    LOCAL PROCEDURE RefreshViewAfterChanges@11123302();
    BEGIN
      IF (Priority <> xRec.Priority) OR (Method <> xRec.Method) THEN
        CurrPage.UPDATE(TRUE);
    END;

    LOCAL PROCEDURE DeleteAllValidLinesFromCache@11123308();
    VAR
      CacheMgt@11123302 : Codeunit 11123323;
      RecRef@11123303 : RecordRef;
    BEGIN
      RecRef.GETTABLE(Rec);
      CacheMgt.RemoveAll(RecRef);
    END;

    LOCAL PROCEDURE MethodOnAfterValidate@19003029();
    BEGIN
      RefreshViewAfterChanges;
    END;

    LOCAL PROCEDURE PriorityOnAfterValidate@19076862();
    BEGIN
      RefreshViewAfterChanges;
    END;

    LOCAL PROCEDURE OnAfterGetCurrRecord@19077479();
    BEGIN
      xRec := Rec;
      GetEmptyDefaultValue;
    END;

    BEGIN
    END.
  }
}

