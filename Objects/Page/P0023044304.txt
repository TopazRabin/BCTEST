OBJECT Page 23044304 IWX Inventory Count Card
{
  OBJECT-PROPERTIES
  {
    Date=04/25/19;
    Time=[ 1:42:59 PM];
    Version List=IWX2.4.7684.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Inventory Count Card;
               ESM=Tarjeta de recuento de inventario;
               FRC=Carte de l'inventaire;
               ENC=Inventory Count Card];
    SourceTable=Table23044304;
    PageType=Document;
    OnAfterGetRecord=BEGIN
                       recCurCountLine.SETRANGE("Count No.", "No.");
                       IF "Inventory As of Date"<>0D THEN
                         recCurCountLine.SETRANGE("Date Filter", 0D,"Inventory As of Date")
                       ELSE
                         recCurCountLine.SETRANGE("Date Filter");

                       setDfltDimEditState; //<IW author="MH" date="1/7/2015" issue="TFS369" />
                     END;

    ActionList=ACTIONS
    {
      { 1000000044;  ;ActionContainer;
                      Name=<Action1000000044>;
                      ActionContainerType=RelatedInformation }
      { 1000000045;1 ;ActionGroup;
                      Name=agCount;
                      CaptionML=[ENU=&Count;
                                 ESM=&Contar;
                                 FRC=&Comptage;
                                 ENC=&Count] }
      { 1000000049;2 ;Action    ;
                      Name=acEditCountLines;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Edit &Count Lines;
                                 ESM=Edici¢n L¡neas del &Contar;
                                 FRC=Modifier Lignes de &comptage;
                                 ENC=Edit &Count Lines];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Edit;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 viewCountLines();
                               END;
                                }
      { 1000000051;2 ;Action    ;
                      Name=acPhysLedgEntry;
                      ShortCutKey=Ctrl+F7;
                      CaptionML=[ENU=Phys. Inventory Ledger Entries;
                                 ESM=Phys. Inventario de Las entradas del libro mayor;
                                 FRC=Inventaire Phys. des Entr‚es  du livre des comptes;
                                 ENC=Phys. Inventory Ledger Entries];
                      RunObject=Page 390;
                      RunPageLink=Document No.=FIELD(No.);
                      Promoted=Yes;
                      Image=PhysicalInventoryLedger;
                      PromotedCategory=Process }
      { 1000000048;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1000000046;1 ;ActionGroup;
                      CaptionML=[ENU=F&unctions;
                                 ESM=F&unciones;
                                 FRC=F&onctions;
                                 ENC=F&unctions] }
      { 1000000052;2 ;Action    ;
                      Name=acGenerateSheets;
                      CaptionML=[ENU=&Generate Count Sheets;
                                 ESM=&Generar hojas de recuento;
                                 FRC=&Generer les feuilles de d‚compte;
                                 ENC=&Generate Count Sheets];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=CreateInventoryPickup;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 generateCountSheets();
                               END;
                                }
      { 1000000053;2 ;Separator  }
      { 1000000057;2 ;Action    ;
                      Name=acGenerateRecount;
                      CaptionML=[ENU=Generate &Recount Sheets;
                                 ESM=Generar hojas de &recuento;
                                 FRC=G‚n‚rer Feuilles de &Recomptage;
                                 ENC=Generate &Recount Sheets];
                      Promoted=Yes;
                      Image=CopyToTask;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 generateRecountSheets();
                               END;
                                }
      { 1000000054;2 ;Action    ;
                      Name=acCopyCountToJnl;
                      CaptionML=[ENU=&Copy Count to Journals;
                                 ESM=&Copias Cuento para revistas;
                                 FRC=&Copier Comptage vers les Journaux;
                                 ENC=&Copy Count to Journals];
                      Promoted=Yes;
                      Image=PhysicalInventory;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 copyToJournals;
                               END;
                                }
      { 1000000055;2 ;Action    ;
                      Name=acUpdateNextCountPeriod;
                      CaptionML=[ENU=U&pdate Next Count Period;
                                 ESM=Act&ualizaci¢n pr¢ximo per¡odo Conde;
                                 FRC=Mise … jour P‚riode de comptage suivante;
                                 ENC=U&pdate Next Count Period];
                      Promoted=Yes;
                      Image=Period;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 REPORT.RUN(REPORT::"IWX Update Next Count Period", TRUE, TRUE, recCurCountLine);
                               END;
                                }
      { 1000000061;2 ;Action    ;
                      Name=acDuplicateCount;
                      CaptionML=[ENU=&Duplicate Count Config.;
                                 ESM=&Duplicado Config. del Cuento;
                                 FRC=&Dupliquer Config. du Comptage;
                                 ENC=&Duplicate Count Config.];
                      ToolTipML=[ENU=Create a new count based on this one;
                                 ENC=Create a new count based on this one];
                      Description=Create a new count based on this one;
                      Promoted=Yes;
                      Image=Copy;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 duplicateCount;
                               END;
                                }
      { 1000000058;2 ;Action    ;
                      Name=acRecalcDifferences;
                      CaptionML=[ENU=Recalc&ulate All Differences;
                                 ESM=volver a calc&ular todas las diferencias;
                                 FRC=Recalc&uler Toutes les diff‚rences;
                                 ENC=Recalc&ulate All Differences];
                      Image=Reconcile;
                      OnAction=BEGIN
                                 recalcDifferences;
                               END;
                                }
      { 1000000020;2 ;ActionGroup;
                      CaptionML=[ENU=Bins;
                                 ESM=Bins;
                                 FRC=Bins;
                                 ENC=Bins];
                      Image=Bin }
      { 1000000019;3 ;Action    ;
                      CaptionML=[ENU=Block Bins;
                                 ESM=bloquear Bins;
                                 FRC=Bloquer Bins;
                                 ENC=Block Bins];
                      Image=CreateBins;
                      OnAction=BEGIN
                                 cuBlockBin.blockCountBins("No."); //<IW author="MH" date="3/9/2016" issue="TFS838" />
                               END;
                                }
      { 1000000018;3 ;Action    ;
                      CaptionML=[ENU=Reset Bins;
                                 ESM=restablecer contenedores;
                                 FRC=r‚initialiser les bacs;
                                 ENC=Reset Bins];
                      Image=SuggestBin;
                      OnAction=BEGIN
                                 cuBlockBin.resetCountBins("No."); //<IW author="MH" date="3/9/2016" issue="TFS838" />
                               END;
                                }
      { 1000000047;1 ;ActionGroup;
                      CaptionML=[ENU=Reports;
                                 ESM=Impresi¢n;
                                 FRC=Imprimer;
                                 ENC=Reports] }
      { 1000000066;2 ;Action    ;
                      Name=acCountDiff;
                      CaptionML=[ENU=Count &Difference Analysis;
                                 ESM=Contar y An lisis &Diferencial;
                                 FRC=Comptage & analyse &diff‚rentielle;
                                 ENC=Count Difference Analysis];
                      RunPageOnRec=Yes;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Report;
                      PromotedCategory=Report;
                      OnAction=BEGIN
                                 CurrPage.UPDATE(TRUE);
                                 REPORT.RUN(REPORT::"IWX Count Difference Analysis", TRUE, TRUE, recCurCountLine);
                               END;
                                }
      { 1000000021;2 ;Action    ;
                      Name=acCountSummary;
                      CaptionML=[ENU=Count Difference Summary;
                                 ESM=Count Difference Summary;
                                 FRC=Count Difference Summary;
                                 ENC=Count Difference Summary];
                      Promoted=Yes;
                      Image=Table;
                      PromotedCategory=Report;
                      OnAction=VAR
                                 ltrecCountLine@1000000000 : TEMPORARY Record 23044301;
                               BEGIN
                                 CurrPage.UPDATE(TRUE);
                                 ltrecCountLine.SETRANGE("Count No.", "No.");
                                 PAGE.RUN(PAGE::"IWX Count Difference Summary", ltrecCountLine);
                               END;
                                }
      { 1000000022;2 ;Action    ;
                      Name=acInventoryCountSheets;
                      CaptionML=[ENU=Inventory &Count Sheets;
                                 ESM=Hojas de re&cuento de inventario;
                                 FRC=Feuilles de &comptage d'inventaire;
                                 ENC=Inventory Count Sheets];
                      Promoted=Yes;
                      Image=Report;
                      PromotedCategory=Report;
                      OnAction=VAR
                                 lrecCountCfg@1000000000 : Record 23044300;
                               BEGIN
                                 recInvCountSetup.GET;
                                 recInvCountSetup.TESTFIELD("Count Sheet Report ID");
                                 lrecCountCfg.SETRANGE("Count No.","No.");
                                 IF ( recInvCountSetup."Count Sheet Report ID" = 0 ) THEN BEGIN
                                   // upgraded object install scenario.
                                   REPORT.RUNMODAL(REPORT::"Inventory Count Sheets - Long", TRUE, TRUE, lrecCountCfg);
                                 END ELSE BEGIN
                                   // configured or new install scenario
                                   REPORT.RUNMODAL(recInvCountSetup."Count Sheet Report ID", TRUE, TRUE, lrecCountCfg);
                                 END;
                               END;
                                }
      { 1000000067;2 ;Action    ;
                      Name=acUncountedParts;
                      CaptionML=[ENU=&Uncounted Parts;
                                 ESM=Piezas incontables;
                                 FRC=Parties non compt‚es;
                                 ENC=Uncounted Parts];
                      Image=Report;
                      PromotedCategory=Report;
                      OnAction=BEGIN
                                 CurrPage.UPDATE(TRUE);
                                 REPORT.RUN(REPORT::"IWX Items Not Counted", TRUE, TRUE, recCurCountLine);
                               END;
                                }
      { 1000000063;2 ;Action    ;
                      Name=acWipByProdOrder;
                      CaptionML=[ENU=WIP Sheets by Production &Order;
                                 ESM=Hojas WIP por orden de fabricaci¢n;
                                 FRC=Fiches WIP par ordre de fabrication;
                                 ENC=WIP Sheets by Production &Order];
                      RunObject=Report 23044305;
                      Image=Report }
      { 1000000064;2 ;Action    ;
                      Name=acWipByWorkCenter;
                      CaptionML=[ENU=WIP Sheets by &Work Center;
                                 ESM=Hojas WIP por centro de trabajo;
                                 FRC=Feuilles WIP par Centre de travail;
                                 ENC=WIP Sheets by &Work Center];
                      RunObject=Report 23044304;
                      Image=Report }
      { 1000000068;2 ;Action    ;
                      Name=acPartsWithModShelf;
                      CaptionML=[ENU=&Parts with Modified Shelf No's;
                                 ESM=&Piezas modificadas con estanter¡aNo's;
                                 FRC=&PiŠces avec Nos. ‚tagŠre Modifi‚;
                                 ENC=&Parts with Modified Shelf No's];
                      Image=Report;
                      OnAction=BEGIN
                                 REPORT.RUN(REPORT::"IWX Shelf No. Changes", TRUE, TRUE, recCurCountLine);
                               END;
                                }
      { 1000000069;2 ;Action    ;
                      Name=acMissingSN;
                      CaptionML=[ENU=&Missing Serial No. Details;
                                 ESM=Detalles No. de serie que falta;
                                 FRC=D‚tails du Nø de s‚rie &Manquant;
                                 ENC=&Missing Serial No. Details];
                      Image=Report;
                      OnAction=BEGIN
                                 CurrPage.UPDATE(TRUE);
                                 recCurCountLine.SETFILTER("Location Code", "Location Code");
                                 REPORT.RUN(REPORT::"IWX Missing Serial No. Details", TRUE, TRUE, recCurCountLine);
                                 recCurCountLine.SETRANGE("Location Code");
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1000000000;;Container;
                ContainerType=ContentArea }

    { 1000000001;1;Group  ;
                CaptionML=[ENU=General;
                           ESM=General;
                           FRC=G‚n‚ral;
                           ENC=General];
                GroupType=Group }

    { 1000000007;2;Field  ;
                ToolTipML=ENU=Holds the No. for the current Inventory Count Header.;
                SourceExpr="No.";
                OnAssistEdit=BEGIN
                               IF AssistEdit(xRec) THEN
                                 CurrPage.UPDATE;
                             END;
                              }

    { 1000000008;2;Field  ;
                ToolTipML=ENU=Use this field to specify an informational description of the inventory count.;
                SourceExpr=Description }

    { 1000000010;2;Field  ;
                ToolTipML=ENU=Specifies the default Location Code for the current Inventory Count.;
                SourceExpr="Location Code";
                OnValidate=BEGIN
                             OnLocAfterValidate;
                           END;
                            }

    { 1000000009;2;Field  ;
                ToolTipML=ENU=Identifies whether this Inventory Count Header is Active.;
                SourceExpr=Active }

    { 1000000011;2;Field  ;
                ToolTipML=ENU=The default date for which inventory differences will be calculated.  Leave blank to always use the current date for calculating differences.;
                SourceExpr="Inventory As of Date" }

    { 1000000012;2;Field  ;
                ToolTipML=ENU=Date the inventory count record was created.;
                SourceExpr="Created On";
                Editable=FALSE }

    { 1000000013;2;Field  ;
                ToolTipML=ENU=The user ID of the user that created this inventory count.;
                SourceExpr="Created By";
                Editable=FALSE }

    { 1000000014;2;Field  ;
                DrillDown=No;
                ToolTipML=ENU=The total number of count sheet configurations defined for this count.;
                SourceExpr="Count Sheets" }

    { 1000000015;2;Field  ;
                ToolTipML=ENU=The total number of count sheet lines on this count.;
                SourceExpr="Count Sheet Lines" }

    { 1000000016;2;Field  ;
                ToolTipML=ENU=The total number of counted sheet lines on this count.;
                SourceExpr="Counted Lines" }

    { 1000000017;2;Field  ;
                ToolTipML=ENU=The total number of uncounted sheet lines on this count.;
                SourceExpr="Uncounted Lines" }

    { 1000000042;1;Part   ;
                Name=sfSheets;
                CaptionML=[ENU=Sheets;
                           ENC=Sheets];
                SubPageLink=Sheet Name=FIELD(Count Sheet Filter),
                            Count No.=FIELD(No.);
                PagePartID=Page23044305 }

    { 1000000003;1;Group  ;
                CaptionML=[ENU=Posting;
                           ESM=Destino;
                           FRC=Publication;
                           ENC=Posting];
                GroupType=Group }

    { 1000000032;2;Field  ;
                ToolTipML=ENU=When set to true, the item tracking lines (serial numbers and/or lot numbers) are set on the items being copied to the physical inventory journal.;
                SourceExpr="Set Item Tracking Lines" }

    { 1000000033;2;Field  ;
                ToolTipML=ENU=If the journal batch template includes a number series for document numbers and this flag is true, the document numbers will be set to the number series specified for the batch. If no number series exists, a custom document number will be created for each journal line.;
                SourceExpr="Use Batch Document Nos.";
                OnValidate=VAR
                             ltcUseBatchDocNos@1000000000 : TextConst 'ENU=If you enable this field, the Inventory Count No. (%1) will not be the ledger entry Document Number.\This will prevent you from viewing the Phys. Inventory Ledger Entries by Count No.\\Continue?;ENC=If you enable this field, the Inventory Count No. (%1) will not be the ledger entry Document Number.\This will prevent you from viewing the Phys. Inventory Ledger Entries by Count No.\\Continue?';
                           BEGIN
                             IF "Use Batch Document Nos." THEN
                               IF NOT CONFIRM(ltcUseBatchDocNos, FALSE, "No.") THEN
                                 ERROR('');
                           END;
                            }

    { 1000000034;2;Field  ;
                ToolTipML=ENU=If true, even lines with no count differences will be copied to the journals. This will create a physical inventory ledger entry for the item to indicate it had been counted.;
                SourceExpr="Post Zero Differences" }

    { 1000000035;2;Field  ;
                ToolTipML=ENU=When set, the Next Counting Period on the Item or SKU is updated to reflect that this item has just been counted.  This action occurs when the count is copied to the journals.;
                SourceExpr="Update Next Count Period" }

    { 1000000002;2;Field  ;
                ToolTipML=ENU=When enabled, causes the system to use the default dimensions specified on the item card for the journal dimensions in addition to the dimensions specified on the count.;
                SourceExpr="Use Default Dimensions";
                Enabled=bEnableDefaultDims }

    { 1000000036;2;Field  ;
                ToolTipML=ENU=Used internally by the system - not currently available for users.;
                SourceExpr="Post Reason Codes";
                Visible=FALSE;
                Enabled=false }

    { 1000000037;2;Field  ;
                ToolTipML=ENU=Specify the Consumption Journal Batch to use here.;
                SourceExpr="Consumption Journal Batch" }

    { 1000000038;2;Field  ;
                ToolTipML=ENU=Specify the Phys. Inv. Journal Batch to use here.;
                SourceExpr="Phys. Inv. Journal Batch" }

    { 1000000039;2;Field  ;
                ToolTipML=ENU=Specify the Whse. Phys. Inv. Jnl. Batch to use here.;
                SourceExpr="Whse. Phys. Inv. Jnl. Batch" }

    { 1000000040;2;Field  ;
                ToolTipML=ENU=Specify the Reclass. Journal Batch to use here.;
                SourceExpr="Reclass. Journal Batch" }

    { 1000000041;2;Field  ;
                Name=fldItemJournalDims;
                AssistEdit=Yes;
                CaptionML=[ENU=Item Journal Dimensions;
                           ESM=Diario Dimensiones de art¡culo;
                           FRC=Dimensions du Journal d'Article;
                           ENC=Item Journal Dimensions];
                ToolTipML=ENU=Set the dimensions here;
                SourceExpr=getDimList;
                OnAssistEdit=VAR
                               liNotUsedAutoScriptsOnly@1000000000 : Integer;
                             BEGIN
                               {// 2009::varbegin
                               lrecDocDim@1000000001 : Record 357;
                               }// 2009::varend

                               // 2013::begin
                               "Dimension Set ID" := cuDimMgmt.EditDimensionSet("Dimension Set ID", "No.");
                               setDfltDimEditState; //<IW author="MH" date="1/7/2015" issue="TFS369" />
                               // 2013::end

                               {{// 2009::begin
                               lrecDocDim.SETRANGE("Table ID", DATABASE::"Inventory Count Header");
                               lrecDocDim.SETRANGE("Document No.", "No.");

                               FORM.RUN(FORM::"Document Dimensions", lrecDocDim);
                               }}// 2009::end
                             END;
                              }

    { 1000000004;0;Container;
                ContainerType=FactBoxArea }

    { 1000000070;1;Part   ;
                SubPageLink=No.=FIELD(No.);
                PagePartID=Page23044308;
                PartType=Page }

    { 1000000006;1;Part   ;
                PartType=System;
                SystemPartID=Notes }

    { 1000000005;1;Part   ;
                PartType=System;
                SystemPartID=RecordLinks }

  }
  CODE
  {
    VAR
      recCurCountLine@1000000000 : Record 23044301;
      cuDimMgmt@1000000001 : Codeunit 408;
      bEnableDefaultDims@1000000002 : Boolean INDATASET;
      recInvCountSetup@1000000003 : Record 23044305;
      cuBlockBin@1000000004 : Codeunit 23044301;

    PROCEDURE generateCountSheets@1000000003();
    VAR
      lrecCountConfig@1000000001 : Record 23044300;
    BEGIN
      //////////////////////////////////////////////
      //<Summary>
      // Creates the Count Sheet Lines for the grouping.
      //</Summary>
      //<Author>R.Trudeau</Author>
      //<Date>2/7/2012</Date>
      //<Issue>296</Issue>
      //<Version>IW2.9</Version>
      //////////////////////////////////////////////

      CurrPage.UPDATE(TRUE);
      lrecCountConfig.SETRANGE("Count No.", "No.");
      REPORT.RUNMODAL(REPORT::"IWX Create Count Sheets", TRUE, TRUE, lrecCountConfig);
    END;

    PROCEDURE generateRecountSheets@1000000001();
    VAR
      lrepGenRecount@1000000001 : Report 23044307;
    BEGIN
      //////////////////////////////////////////////
      //<Summary>
      // Launches the generate recount sheets report filtered by the count.
      //</Summary>
      //<Author>R.Trudeau</Author>
      //<Date>2/7/2012</Date>
      //<Issue>296</Issue>
      //<Version>IW2.9</Version>
      //////////////////////////////////////////////

      CurrPage.UPDATE(TRUE);
      lrepGenRecount.setCountNo("No.");
      lrepGenRecount.SETTABLEVIEW(recCurCountLine);
      lrepGenRecount.RUNMODAL;
    END;

    PROCEDURE viewCountLines@1000000002();
    BEGIN
      //////////////////////////////////////////////
      //<Summary>
      // Launches the count sheet lines for the count.
      //</Summary>
      //<Author>R.Trudeau</Author>
      //<Date>2/7/2012</Date>
      //<Issue>296</Issue>
      //<Version>IW2.9</Version>
      //////////////////////////////////////////////

      CurrPage.UPDATE(TRUE);
      PAGE.RUN(PAGE::"IWX Count Sheet Lines",recCurCountLine);
    END;

    PROCEDURE recalcDifferences@1000000004();
    BEGIN
      // Calcs differences for all lines in this count
      recCurCountLine.recalcAllDifferences;
    END;

    PROCEDURE copyToJournals@1000000005();
    VAR
      lrepCopyToJournal@1000000000 : Report 23044309;
      ltcDeactivateCount@1000000001 : TextConst 'ENC=The count has been copied to NAV journals.\Deactivate this count now?';
    BEGIN
      CurrPage.UPDATE(TRUE);
      CLEAR(lrepCopyToJournal);
      lrepCopyToJournal.setCurCountNo("No.");
      lrepCopyToJournal.RUNMODAL;

      IF lrepCopyToJournal.getCopyFinished THEN
        IF CONFIRM(ltcDeactivateCount) THEN BEGIN
          COMMIT;
          GET("No.");
          Active := FALSE;
          MODIFY;
        END;
    END;

    PROCEDURE getDimList@1000000006() rtxtList : Text[200];
    VAR
      ltrecDimSet@1000000000 : TEMPORARY Record 480;
    BEGIN
      {// 2009::varbegin
      lrecDocDim@1000000001 : Record 357;
      }// 2009::varend

      // Generates a list of dims for display

      // 2013::begin
      cuDimMgmt.GetDimensionSet(ltrecDimSet, "Dimension Set ID");
      IF ltrecDimSet.FINDSET THEN
        REPEAT
          rtxtList += ltrecDimSet."Dimension Value Code" + ' ';
        UNTIL (ltrecDimSet.NEXT = 0) OR (STRLEN(rtxtList)>180);

      // 2013::end

      {{// 2009::begin
      lrecDocDim.SETRANGE("Table ID", DATABASE::"Inventory Count Header");
      lrecDocDim.SETRANGE("Document No.", "No.");
      IF lrecDocDim.FINDSET THEN
        REPEAT
          rtxtList += lrecDocDim."Dimension Value Code" + ' ';
        UNTIL (lrecDocDim.NEXT = 0) OR (STRLEN(rtxtList)>180);
      }}// 2009::end
    END;

    PROCEDURE OnLocAfterValidate@1000000008();
    BEGIN
      CurrPage.UPDATE;
    END;

    PROCEDURE setDfltDimEditState@1000000000();
    BEGIN
      // Set control state for "Use Default Dims"
      IF "Dimension Set ID"<>0 THEN
        bEnableDefaultDims := TRUE
      ELSE BEGIN
        bEnableDefaultDims := FALSE;
        "Use Default Dimensions" := TRUE;
      END;//if
    END;

    BEGIN
    END.
  }
}

