OBJECT Page 50003 Division Code Selection
{
  OBJECT-PROPERTIES
  {
    Date=07/01/20;
    Time=12:00:00 AM;
    Modified=Yes;
    Version List=TOP010,020;
  }
  PROPERTIES
  {
    PageType=ConfirmationDialog;
    OnOpenPage=BEGIN
                 UserSetup.GET(USERID);
                 IF UserSetup."Shortcut Dimension 5 Code" <> '' THEN
                   CurrentDivisionCodeFilter := UserSetup."Shortcut Dimension 5 Code";
               END;

  }
  CONTROLS
  {
    { 1000000000;;Container;
                ContainerType=ContentArea }

    { 1000000001;1;Field  ;
                Name=Division Code;
                SourceExpr=CurrentDivisionCodeFilter;
                TableRelation="Dimension Value".Code WHERE (Dimension Code=CONST(DIVISION));
                OnValidate=BEGIN
                             //TOP020 KT ABCSI Sales Orders by Division 02052015
                             IF (CurrentDivisionCodeFilter <> '') THEN BEGIN
                               GLSetup.GET;
                               IF GLSetup."Shortcut Dimension 5 Code" <> '' THEN BEGIN
                                 IF NOT DimVal.GET(GLSetup."Shortcut Dimension 5 Code",CurrentDivisionCodeFilter) THEN
                                   ERROR(
                                     STRSUBSTNO(ab003,
                                       CurrentDivisionCodeFilter,GLSetup."Shortcut Dimension 5 Code"));
                               END ELSE
                                 ERROR(ab002,GLSetup.TABLECAPTION);
                             END;
                             //TOP020 KT ABCSI Sales Orders by Division 02052015
                           END;
                            }

  }
  CODE
  {
    VAR
      CurrentDivisionCodeFilter@1000000000 : Code[20];
      DimMgt@1000000001 : Codeunit 408;
      UserSetup@1000000002 : Record 91;
      GLSetup@1000000004 : Record 98;
      DimVal@1000000003 : Record 349;
      ab002@1000000006 : TextConst 'ENU=This Shortcut Dimension is not defined in the %1.;ESM=Este Shortcut de dimensi¢n no est  def. en el %1.;FRC=La dimension de ce raccourci n''est pas d‚finie dans le %1.;ENC=This Shortcut Dimension is not defined in the %1.';
      ab003@1000000005 : TextConst 'ENU=%1 is not an available %2 for that dimension.;ESM=%1 no est  disponible %2 para esa dimensi¢n.;FRC=%1 n''est pas un %2 disponible pour cette dimension.;ENC=%1 is not an available %2 for that dimension.';

    PROCEDURE GetDivisionCodeValue@1000000000() : Code[20];
    BEGIN
      EXIT(CurrentDivisionCodeFilter);
    END;

    PROCEDURE GetErrorMsg@1000000001();
    BEGIN
      IF CurrentDivisionCodeFilter = '' THEN
        ERROR('Please Select value for Division Code');
    END;

    PROCEDURE LookupShortcutDimCode@28(FieldNumber@1000 : Integer;VAR ShortcutDimCode@1001 : Code[20]);
    BEGIN

      DimMgt.LookupDimValueCode(FieldNumber,ShortcutDimCode);
      //TOP020 KT ABCSI Sales Orders by Division 02052015
      IF (ShortcutDimCode <> '') THEN BEGIN
        GLSetup.GET;
        IF GLSetup."Shortcut Dimension 5 Code" <> '' THEN BEGIN
          IF NOT DimVal.GET(GLSetup."Shortcut Dimension 5 Code",ShortcutDimCode) THEN
            ERROR(
              STRSUBSTNO(ab003,
                ShortcutDimCode,GLSetup."Shortcut Dimension 5 Code"));
        END ELSE
          ERROR(ab002,GLSetup.TABLECAPTION);
      END;
      //TOP020 KT ABCSI Sales Orders by Division 02052015
    END;

    BEGIN
    {
      TOP010 KT ABCSI Stock Status Quick Quote Screen 12082014
        - This page is for Division selection when opening Stock Status Quick Quote screen
    }
    END.
  }
}

