OBJECT Page 23044548 WHI User Activities
{
  OBJECT-PROPERTIES
  {
    Date=05/06/19;
    Time=[ 9:42:52 AM];
    Version List=WHI2.4.7684.0;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[ENU=User Activities;
               ESM=Actividades del Usuario;
               FRC=Activit‚s de l'Utilisateur;
               ENC=User Activities];
    SourceTable=Table23044515;
    PageType=ListPart;
    SourceTableTemporary=Yes;
    RefreshOnActivate=Yes;
    ShowFilter=Yes;
    OnOpenPage=BEGIN
                 codLocation := cuEmpMgmt.getLastLocation();
                 cuEmpMgmt.generateActivitySummary(Rec,codLocation);
               END;

    OnAfterGetRecord=VAR
                       ldHours@1000000000 : Decimal;
                       ldMinutes@1000000001 : Decimal;
                       ldSeconds@1000000002 : Decimal;
                       ltxtMinString@1000000003 : TextConst 'ENU=%1 m %2 s';
                       ltxtHourString@1000000004 : TextConst 'ENU=%1 h %2 m';
                     BEGIN
                       txtTotalDocTime := cuEmpMgmt.GetTimeString("Total Document Time",ltxtHourString);
                       txtTotalDownTime := cuEmpMgmt.GetTimeString("Total Down Time",ltxtHourString);
                       txtAvgCount := cuEmpMgmt.GetTimeString("Avg Count Time - Today",ltxtHourString);
                       txtAvgProd := cuEmpMgmt.GetTimeString("Avg Production Time - Today",ltxtHourString);
                       txtAvgReclass := cuEmpMgmt.GetTimeString("Avg Reclass Time - Today",ltxtHourString);
                       txtAvgLP := cuEmpMgmt.GetTimeString("Avg License Plate Time - Today",ltxtHourString);
                       txtAvgRec := cuEmpMgmt.GetTimeString("Avg Receiving Time - Today",ltxtHourString);
                       txtAvgShip := cuEmpMgmt.GetTimeString("Avg Shipping Time - Today",ltxtHourString);
                       txtAvgActivity := cuEmpMgmt.GetTimeString("Avg Activity Time - Today",ltxtHourString);
                     END;

    ActionList=ACTIONS
    {
      { 1000000022;  ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1000000025;1 ;Action    ;
                      Name=Set Location;
                      CaptionML=[ENU=Set Location;
                                 ESM=Escoger localizaci¢n;
                                 FRC=D‚finir l'emplacement;
                                 ENC=Set Location];
                      ToolTipML=[ENU=Change the location filter;
                                 ESM=Cambiar el filtro de ubicaci¢n.;
                                 FRC=Changer le filtre d'emplacement;
                                 ENC=Change the location filter];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Warehouse;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 lpgLocation@1000000000 : Integer;
                               BEGIN
                                 setLocation;
                               END;
                                }
      { 1000000023;1 ;Action    ;
                      Name=Clear Location;
                      CaptionML=[ENU=Clear Location;
                                 ESM=Borrar ubicaci¢n;
                                 FRC=Effacer l'emplacement;
                                 ENC=Clear Location];
                      ToolTipML=[ENU=Clear the location filter;
                                 ESM=Borrar el filtro de ubicaci¢n;
                                 FRC=Effacer le filtre d'emplacement;
                                 ENC=Clear the location filter];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=ClearFilter;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 clearLocation;
                               END;
                                }
      { 1000000024;1 ;Action    ;
                      Name=Refresh;
                      CaptionML=ENU=Refresh;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Refresh;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 cuEmpMgmt.generateActivitySummary(Rec,codLocation);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1000000000;0;Container;
                ContainerType=ContentArea }

    { 1000000026;1;Group  ;
                GroupType=Group }

    { 1000000002;2;Field  ;
                CaptionML=[ENU=Location;
                           ESM=Ubicaci¢n;
                           FRC=Emplacement;
                           ENC=Location];
                ToolTipML=[ENU=The location to filter for;
                           ESM=La ubicaci¢n para filtrar;
                           FRC=L'emplacement … filtrer;
                           ENC=The location to filter for];
                SourceExpr=codLocation }

    { 1000000001;1;Group  ;
                Name=Group;
                GroupType=Repeater }

    { 1000000020;2;Field  ;
                ToolTipML=[ENU=The user;
                           ESM=El usuario;
                           FRC=L'utilisateur;
                           ENC=The user];
                SourceExpr="User ID";
                Editable=false }

    { 1000000021;2;Field  ;
                ToolTipML=[ENU=The user full name;
                           ESM=El nombre completo del usuario.;
                           FRC=Le nom complet de l'utilisateur;
                           ENC=The user full name];
                SourceExpr="Full Name";
                Visible=FALSE;
                Editable=false }

    { 1000000018;2;Field  ;
                ToolTipML=[ENU=The location code;
                           ESM=El codigo de ubicacion;
                           FRC=Le code de localisation;
                           ENC=The location code];
                SourceExpr="Location Code";
                Visible=FALSE;
                Editable=false }

    { 1000000019;2;Field  ;
                ToolTipML=[ENU=The user login time;
                           ESM=El tiempo de inicio de sesi¢n del usuario.;
                           FRC=Le temps de connexion de l'utilisateur;
                           ENC=The user login time];
                SourceExpr="Login Time";
                Editable=false }

    { 1000000017;2;Field  ;
                Name=Total Document Time;
                CaptionML=[ENU=Total Document Time;
                           ESM=Tiempo Total del Documento;
                           FRC=Temps Total du Document;
                           ENC=Total Document Time];
                ToolTipML=[ENU=Total time spent on documents in hours;
                           ESM=Tiempo total empleado en documentos en horas;
                           FRC=Temps total consacr‚ aux documents en heures;
                           ENC=Total time spent on documents in hours];
                Description=teast;
                SourceExpr=txtTotalDocTime;
                Editable=false }

    { 1000000016;2;Field  ;
                Name=Total Down Time;
                CaptionML=[ENU=Total Down Time;
                           ESM=Tiempo Total de Inactividad;
                           FRC=Temps Total d'Arrˆt;
                           ENC=Total Down Time];
                ToolTipML=[ENU=Total time not on a document in hours;
                           ESM=Tiempo total no en un documento en horas;
                           FRC=Temps total non sur un document en heures;
                           ENC=Total time not on a document in hours];
                SourceExpr=txtTotalDownTime;
                Editable=false }

    { 1000000015;2;Field  ;
                ToolTipML=[ENU=The current document start time;
                           ESM=La hora de inicio del documento actual.;
                           FRC=L'heure de d‚but du document en cours;
                           ENC=The current document start time];
                SourceExpr="Current Document Start";
                Visible=FALSE;
                Editable=false }

    { 1000000014;2;Field  ;
                ToolTipML=[ENU=The current document number;
                           ESM=El n£mero de documento actual.;
                           FRC=Le num‚ro du document actuel;
                           ENC=The current document number];
                SourceExpr="Current Document No.";
                Editable=false }

    { 1000000012;2;Field  ;
                ToolTipML=[ENU=The current document type;
                           ESM=El tipo de documento actual;
                           FRC=Le type de document actuel;
                           ENC=The current document type];
                SourceExpr="Current Document Type";
                Visible=FALSE;
                Editable=false }

    { 1000000013;2;Field  ;
                DrillDown=Yes;
                ToolTipML=[ENU=The total documents worked on;
                           ESM=El total de documentos trabajados en;
                           FRC=Le total des documents travaill‚s sur;
                           ENC=The total documents worked on];
                SourceExpr="Total Documents Today";
                Editable=false;
                OnDrillDown=VAR
                              lpWHIActivities@1000000000 : Page 23044536;
                              lrecWHIActivity@1000000001 : Record 23044532;
                              lcuWHIEmpMgmt@1000000002 : Codeunit 23044536;
                            BEGIN
                              lrecWHIActivity.SETRANGE("Summary Type",lrecWHIActivity."Summary Type"::"Open Document");
                              lrecWHIActivity.SETRANGE("User ID",Rec."User ID");
                              IF codLocation <> '' THEN
                                lrecWHIActivity.SETRANGE("Location Code",codLocation);

                              lrecWHIActivity.SETFILTER("Event Time",'>=%1', CREATEDATETIME(TODAY,0T));
                              lpWHIActivities.SETTABLEVIEW(lrecWHIActivity);
                              lpWHIActivities.RUN;
                            END;
                             }

    { 1000000011;2;Field  ;
                ToolTipML=[ENU=The device configuration code;
                           ESM=El c¢digo de configuraci¢n del dispositivo.;
                           FRC=Le code de configuration de l'appareil;
                           ENC=The device configuration code];
                SourceExpr="Config ID";
                Visible=false }

    { 1000000010;2;Field  ;
                ToolTipML=[ENU=The handheld device name;
                           ESM=El nombre del dispositivo de mano;
                           FRC=Le nom de l'appareil de poche;
                           ENC=The handheld device name];
                SourceExpr="Device Host Name";
                Visible=false }

    { 1000000009;2;Field  ;
                Name=Avg Count Time - Today;
                CaptionML=[ENU=Avg Count Time - Today;
                           ESM=Tiempo Promedio de Conteo - Hoy;
                           FRC=Temps Moyen de Compte - Aujourd'hui;
                           ENC=Avg Count Time - Today];
                ToolTipML=[ENU=The average time spent on a count;
                           ESM=El tiempo promedio empleado en un conteo.;
                           FRC=Le temps moyen pass‚ sur un compte;
                           ENC=The average time spent on a count];
                SourceExpr=txtAvgCount;
                Visible=false }

    { 1000000008;2;Field  ;
                Name=Avg Production Time - Today;
                CaptionML=[ENU=Avg Production Time - Today;
                           ESM=Tiempo Medio de Producci¢n;
                           FRC=Temps de Production Moyen;
                           ENC=Avg Production Time - Today];
                ToolTipML=[ENU=The average time spent on a production order;
                           ESM=El tiempo promedio empleado en una orden de producci¢n.;
                           FRC=Le temps moyen pass‚ sur un ordre de production;
                           ENC=The average time spent on a production order];
                SourceExpr=txtAvgProd;
                Visible=false }

    { 1000000007;2;Field  ;
                Name=Avg Reclass Time - Today;
                CaptionML=[ENU=Avg Reclass Time - Today;
                           ESM=Tiempo Medio de Reclaso;
                           FRC=Temps de Repos Moyen;
                           ENC=Avg Reclass Time - Today];
                ToolTipML=[ENU=The average time spent on a reclass document;
                           ESM=El tiempo promedio empleado en un documento de reclasificaci¢n.;
                           FRC=Le temps moyen pass‚ sur un document de reclassement;
                           ENC=The average time spent on a reclass document];
                SourceExpr=txtAvgReclass;
                Visible=false }

    { 1000000006;2;Field  ;
                Name=Avg Licence Plate Time - Today;
                CaptionML=[ENU=Avg Licence Plate Time - Today;
                           ESM=Tiempo Promedio de Matr¡cula;
                           FRC=Temps Moyen de la Plaque d'Immatriculation;
                           ENC=Avg Licence Plate Time - Today];
                ToolTipML=[ENU=The average time spent on a license plate;
                           ESM=El tiempo promedio empleado en una placa.;
                           FRC=Le temps moyen pass‚ sur une plaque d'immatriculation;
                           ENC=The average time spent on a license plate];
                SourceExpr=txtAvgLP;
                Visible=false }

    { 1000000005;2;Field  ;
                Name=Avg Receiving Time - Today;
                CaptionML=[ENU=Avg Receiving Time - Today;
                           ESM=Promedio de Tiempo de Recepci¢n;
                           FRC=Temps Moyen de R‚ception;
                           ENC=Avg Receiving Time - Today];
                ToolTipML=[ENU=The average time spent on a receiving document;
                           ESM=El tiempo promedio empleado en un documento de recepci¢n;
                           FRC=Le temps moyen pass‚ sur un document de r‚ception;
                           ENC=The average time spent on a receiving document];
                SourceExpr=txtAvgRec;
                Visible=false }

    { 1000000004;2;Field  ;
                Name=Avg Shipping Time - Today;
                CaptionML=[ENU=Avg Shipping Time - Today;
                           ESM=Tiempo Medio de Env­o;
                           FRC=Temps de Livraison Moyen;
                           ENC=Avg Shipping Time - Today];
                ToolTipML=[ENU=The average time spent on a shipping document;
                           ESM=El tiempo promedio empleado en un documento de env¡o;
                           FRC=Le temps moyen pass‚ sur un document d'exp‚dition;
                           ENC=The average time spent on a shipping document];
                SourceExpr=txtAvgShip;
                Visible=false }

    { 1000000003;2;Field  ;
                Name=Average Activity Time - Today;
                CaptionML=[ENU=Average Activity Time - Today;
                           ESM=Tiempo Medio de la Actividad;
                           FRC=Temps Moyen d'Activit;
                           ENC=Average Activity Time - Today];
                ToolTipML=[ENU=The average time spent on a warehouse activity document;
                           ESM=El tiempo promedio empleado en un documento de actividad de almac‚n.;
                           FRC=Temps moyen pass‚ sur un document d'activit‚ d'entrep“t;
                           ENC=The average time spent on a warehouse activity document];
                SourceExpr=txtAvgActivity;
                Visible=false }

  }
  CODE
  {
    VAR
      txtTotalDocTime@1000000010 : Text;
      txtTotalDownTime@1000000009 : Text;
      txtAvgCount@1000000008 : Text;
      txtAvgProd@1000000007 : Text;
      txtAvgReclass@1000000006 : Text;
      txtAvgLP@1000000005 : Text;
      txtAvgRec@1000000004 : Text;
      txtAvgShip@1000000003 : Text;
      txtAvgActivity@1000000002 : Text;
      cuEmpMgmt@1000000001 : Codeunit 23044536;
      codLocation@1000000000 : Code[10];

    LOCAL PROCEDURE setLocation@1000000001();
    VAR
      lrecLocation@1000000001 : Record 14;
    BEGIN
      IF PAGE.RUNMODAL(PAGE::"Location List", lrecLocation) = ACTION::LookupOK THEN BEGIN
        codLocation := lrecLocation.Code;
        cuEmpMgmt.setLastLocation(codLocation);
        cuEmpMgmt.generateActivitySummary(Rec,codLocation);
      END;
    END;

    LOCAL PROCEDURE clearLocation@1000000010();
    BEGIN
      codLocation := '';
      cuEmpMgmt.setLastLocation(codLocation);
      cuEmpMgmt.generateActivitySummary(Rec,codLocation);
    END;

    BEGIN
    {
      ************************
      Copyright Notice
      This objects content is copyright of Insight Works 2011.  All rights reserved.
      Any redistribution or reproduction of part or all of the contents in any form is prohibited.
      ************************
    }
    END.
  }
}

