OBJECT Page 50075 Item Substition FactBox 2
{
  OBJECT-PROPERTIES
  {
    Date=07/01/20;
    Time=12:00:00 AM;
    Modified=Yes;
    Version List=TPZ000.00.00;
  }
  PROPERTIES
  {
    CaptionML=ENU=Item Substition;
    InsertAllowed=No;
    DeleteAllowed=No;
    ModifyAllowed=No;
    SourceTable=Table14000566;
    PageType=ListPart;
    OnAfterGetRecord=BEGIN
                       //>>TPZ2840
                       IF Item.GET("No.") THEN;
                       //Reset Variables
                       CLEAR(PriorGenItem);
                       CLEAR(NextGenItem);
                       QtyOnHand := 0;
                       QtyOnHand2 := 0;
                       EnterpriceInventory := 0;
                       EnterpriceInventory2 := 0;
                       MonthsOfStock := 0;
                       MonthsOfStock2 := 0;
                       //
                       PriorGenItem := Item."Prior Generation";
                       NextGenItem := Item."Next Generation";
                       //
                       PriorItem.RESET;
                       PriorItem.SETRANGE("No.",Item."Prior Generation");
                       PriorItem.SETFILTER("Location Filter","Location Code");
                       IF PriorItem.FINDFIRST THEN BEGIN
                         PriorItem.CALCFIELDS(Inventory);
                         QtyOnHand := PriorItem.Inventory;
                       END;
                       NextItem.RESET;
                       NextItem.SETRANGE("No.",Item."Next Generation");
                       NextItem.SETFILTER("Location Filter","Location Code");
                       IF NextItem.FINDFIRST THEN BEGIN
                         NextItem.CALCFIELDS(Inventory);
                         QtyOnHand2 := NextItem.Inventory;
                       END;
                       //
                       EnterpriceInventory := ItemManagement.CalcItemSubsEnterPriseInventory(Item."Prior Generation");
                       EnterpriceInventory2 := ItemManagement.CalcItemSubsEnterPriseInventory(Item."Next Generation");
                       MonthsOfStock := ItemManagement.CalctemSubsMonthOfStock(Item."Prior Generation");
                       MonthsOfStock2 := ItemManagement.CalctemSubsMonthOfStock(Item."Next Generation");
                       //<<TPZ2840
                     END;

  }
  CONTROLS
  {
    { 1000000005;0;Container;
                ContainerType=ContentArea }

    { 1000000010;1;Group  ;
                CaptionML=[ESM=Par�metros de punto de pedido;
                           FRC=Param�tres Point de commande;
                           ENC=Reorder-Point Parameters];
                GroupType=Group }

    { 1000000000;2;Field  ;
                Name=Prior;
                BlankZero=Yes;
                SourceExpr=PriorGenItem;
                TableRelation=Item.No.;
                OnLookup=VAR
                           Item@1000000000 : Record 27;
                         BEGIN
                           //>>TPZ2840
                           Item.RESET;
                           Item.SETRANGE("No.",PriorGenItem);
                           IF PAGE.RUNMODAL(0,Item) = ACTION::LookupOK THEN;
                           //<<TPZ2840
                         END;
                          }

    { 1000000002;2;Field  ;
                Name=QAP;
                SourceExpr=QtyOnHand;
                OnLookup=VAR
                           ItemLedgerEntry@1000000000 : Record 32;
                         BEGIN
                           //>>TPZ2840
                           ItemLedgerEntry.RESET;
                           ItemLedgerEntry.SETRANGE("Item No.",PriorGenItem);
                           ItemLedgerEntry.SETRANGE("Location Code","Location Code");
                           IF PAGE.RUNMODAL(0,ItemLedgerEntry) = ACTION::LookupOK THEN;
                           //<<TPZ2840
                         END;
                          }

    { 1000000003;2;Field  ;
                Name=Ent. Inv.;
                SourceExpr=EnterpriceInventory }

    { 1000000007;2;Field  ;
                Name=MOS;
                DecimalPlaces=1:1;
                SourceExpr=MonthsOfStock }

    { 1000000016;1;Group  ;
                CaptionML=[ESM=Modificadores de pedido;
                           FRC=Modificateur ordre;
                           ENC=Order Modifiers];
                GroupType=Group }

    { 1000000001;2;Field  ;
                Name=Next;
                BlankZero=Yes;
                SourceExpr=NextGenItem;
                TableRelation=Item.No.;
                Editable=false;
                OnLookup=VAR
                           Item@1000000000 : Record 27;
                         BEGIN
                           //>>TPZ2840
                           Item.RESET;
                           Item.SETRANGE("No.",NextGenItem);
                           IF PAGE.RUNMODAL(0,Item) = ACTION::LookupOK THEN;
                           //<<TPZ2840
                         END;
                          }

    { 1000000004;2;Field  ;
                Name=QAP.;
                SourceExpr=QtyOnHand2;
                Editable=false;
                OnLookup=VAR
                           ItemLedgerEntry@1000000000 : Record 32;
                         BEGIN
                           //>>TPZ2840
                           ItemLedgerEntry.RESET;
                           ItemLedgerEntry.SETRANGE("Item No.",NextGenItem);
                           ItemLedgerEntry.SETRANGE("Location Code","Location Code");
                           IF PAGE.RUNMODAL(0,ItemLedgerEntry) = ACTION::LookupOK THEN;
                           //<<TPZ2840
                         END;
                          }

    { 1000000006;2;Field  ;
                Name=Ent. Inv..;
                SourceExpr=EnterpriceInventory2;
                Editable=false }

    { 1000000008;2;Field  ;
                Name=MOS.;
                DecimalPlaces=1:1;
                SourceExpr=MonthsOfStock2 }

  }
  CODE
  {
    VAR
      ItemManagement@1000000000 : Codeunit 50020;
      Item@1000000001 : Record 27;
      AltItem@1000000002 : Record 27;
      PriorGenItem@1000000003 : Code[20];
      NextGenItem@1000000010 : Code[20];
      ItemSubstitution@1000000004 : TEMPORARY Record 5715;
      ItemSubstitution2@1000000005 : Record 5715;
      Item1@1000000006 : Record 27;
      counter@1000000007 : Integer;
      TemporaryVar@1000000008 : Integer;
      RecRef@1000000009 : RecordRef;
      QtyOnHand@1000000011 : Integer;
      QtyOnHand2@1000000012 : Integer;
      EnterpriceInventory@1000000013 : Integer;
      EnterpriceInventory2@1000000014 : Integer;
      MonthsOfStock@1000000015 : Decimal;
      MonthsOfStock2@1000000016 : Decimal;
      PriorItem@1000000017 : Record 27;
      NextItem@1000000018 : Record 27;

    BEGIN
    {
      2020-04-28 TPZ2840 RSAH
        Add Prior and Next Generation fields to the Suggested Order page - This is a New page
    }
    END.
  }
}

