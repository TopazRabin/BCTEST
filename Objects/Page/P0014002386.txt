OBJECT Page 14002386 E.D.I. Trace
{
  OBJECT-PROPERTIES
  {
    Date=10/04/09;
    Time=12:00:00 PM;
    Version List=SE0.54.10;
  }
  PROPERTIES
  {
    CaptionML=ENU=E.D.I. Trace;
    SaveValues=Yes;
    SourceTable=Table14002374;
    PageType=NavigatePage;
    OnInit=BEGIN
             ShowEnable := TRUE;
           END;

    OnOpenPage=BEGIN
                 IF (NewDocNo = '') THEN BEGIN
                   DocEntryTmp.DELETEALL;
                   ShowEnable := FALSE;
                 END ELSE BEGIN
                   DocEntryTmp.SETRANGE("Document No.",NewDocNo);
                   DocNoFilter := DocEntryTmp.GETFILTER("Document No.");
                   ExtDocNo := '';
                   FindRecords;
                 END;
               END;

    OnFindRecord=BEGIN
                   DocEntryTmp := Rec;
                   IF NOT DocEntryTmp.FIND(Which) THEN
                     EXIT(FALSE);
                   Rec := DocEntryTmp;
                   EXIT(TRUE);
                 END;

    OnNextRecord=VAR
                   CurrentSteps@1240030001 : Integer;
                 BEGIN
                   DocEntryTmp := Rec;
                   CurrentSteps := DocEntryTmp.NEXT(Steps);
                   IF CurrentSteps <> 0 THEN
                     Rec := DocEntryTmp;
                   EXIT(CurrentSteps);
                 END;

    ActionList=ACTIONS
    {
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 21      ;1   ;Action    ;
                      Name=Show;
                      CaptionML=ENU=&Show;
                      Promoted=Yes;
                      Enabled=ShowEnable;
                      Image=View;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 EDIManagement.TraceShowRecords(Rec);
                               END;
                                }
      { 2       ;1   ;Action    ;
                      CaptionML=ENU=Fi&nd;
                      Promoted=Yes;
                      Image=Find;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 FindPush;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 27  ;1   ;Group     ;
                CaptionML=ENU=General }

    { 3   ;2   ;Field     ;
                CaptionML=ENU=E.D.I. Internal Doc. No.;
                SourceExpr=DocNoFilter;
                OnValidate=BEGIN
                             SetDocNo(DocNoFilter);
                             ExtDocNo := '';
                               DocNoFilterOnAfterValidate;
                           END;
                            }

    { 16  ;1   ;Group     ;
                Editable=FALSE;
                GroupType=Repeater }

    { 24  ;2   ;Field     ;
                SourceExpr="Entry No.";
                Visible=FALSE }

    { 22  ;2   ;Field     ;
                SourceExpr="Table ID";
                Visible=FALSE }

    { 1240030000;2;Field  ;
                SourceExpr=Type }

    { 17  ;2   ;Field     ;
                SourceExpr="Table Name" }

    { 19  ;2   ;Field     ;
                DrillDown=Yes;
                SourceExpr="No. of Records";
                OnDrillDown=BEGIN
                              EDIManagement.TraceShowRecords(Rec);
                            END;
                             }

  }
  CODE
  {
    VAR
      DocEntryTmp@1240030001 : TEMPORARY Record 14002374;
      EDIManagement@1240030000 : Codeunit 14002379;
      Window@1240030012 : Dialog;
      DocNoFilter@1240030013 : Code[250];
      NewDocNo@1240030014 : Code[20];
      ExtDocNo@1240030016 : Code[250];
      DocExists@1240030023 : Boolean;
      Text001@1001 : TextConst 'ENU=Counting records...';
      ShowEnable@19017131 : Boolean INDATASET;

    PROCEDURE SetDoc@1(DocNo@1240030000 : Code[20]);
    BEGIN
      NewDocNo := DocNo;
    END;

    LOCAL PROCEDURE FindRecords@2();
    BEGIN
      WITH DocEntryTmp DO BEGIN
        Window.OPEN(Text001);
        DELETEALL;
        "Entry No." := 0;

        CLEAR(EDIManagement);
        EDIManagement.TraceUpdateEDIDocEntryLines(DocEntryTmp,DocNoFilter);

        DocExists := FIND('-');
        Rec := DocEntryTmp;

        ShowEnable := DocExists;
        CurrPage.UPDATE(FALSE);
        DocExists := FIND('-');
        IF DocExists THEN;
        Window.CLOSE;
      END;
    END;

    LOCAL PROCEDURE SetDocNo@10(DocNo@1240030000 : Text[250]);
    BEGIN
      DocEntryTmp.SETFILTER("Document No.",DocNo);
      DocNoFilter := DocEntryTmp.GETFILTER("Document No.");
    END;

    LOCAL PROCEDURE ClearSourceInfo@7();
    BEGIN
      IF DocExists THEN BEGIN
        DocExists := FALSE;
        DocEntryTmp.DELETEALL;
        ShowEnable := FALSE;
        CurrPage.UPDATE(FALSE);
      END;
    END;

    LOCAL PROCEDURE FindPush@13();
    BEGIN
      FindRecords;
    END;

    LOCAL PROCEDURE DocNoFilterOnAfterValidate@19079756();
    BEGIN
      ClearSourceInfo;
    END;

    BEGIN
    END.
  }
}

