OBJECT Page 23044633 DSHIP Shipment Manifest Card
{
  OBJECT-PROPERTIES
  {
    Date=02/22/19;
    Time=[ 2:12:09 PM];
    Version List=DSHIP2.2.2;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Dynamic Ship Shipment Manifest Card;
               ENC=Dynamic Ship Shipment Manifest Card];
    SourceTable=Table23044618;
    PageType=Card;
    OnFindRecord=BEGIN
                   EXIT(Rec.LocationAllowedOnFindRecord(Which));
                 END;

    OnNextRecord=BEGIN
                   EXIT(Rec.LocationAllowedOnNextRecord(Steps));
                 END;

    OnAfterGetRecord=VAR
                       lrecManifestLine@1000000000 : Record 23044619;
                     BEGIN
                       bOpenStatus := Status = Status::Open;
                       lrecManifestLine.SETRANGE("Manifest No.", Rec."No.");
                       bHasShipments := lrecManifestLine.FINDFIRST;
                     END;

    OnNewRecord=BEGIN
                  bOpenStatus := Status = Status::Open;
                END;

    ActionList=ACTIONS
    {
      { 1000000010;  ;ActionContainer;
                      ActionContainerType=Reports }
      { 1000000011;1 ;Action    ;
                      Name=acManifest;
                      CaptionML=ENU=Print Manifest Report;
                      Promoted=Yes;
                      Enabled=bHasShipments;
                      Image=Print;
                      PromotedCategory=Report;
                      OnAction=BEGIN
                                 runManifestReport;
                               END;
                                }
      { 1000000014;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1000000015;1 ;ActionGroup;
                      CaptionML=ENU=F&unctions }
      { 1000000016;2 ;Action    ;
                      Name=acGetShipments;
                      CaptionML=ENU=Get Shipment Documents;
                      Promoted=Yes;
                      Enabled=bOpenStatus;
                      Image=GetSourceDoc;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 getShipments;
                               END;
                                }
      { 1000000017;2 ;Action    ;
                      Name=acRelease;
                      CaptionML=ENU=Re&lease;
                      Promoted=Yes;
                      Enabled=bOpenStatus;
                      Image=ReleaseDoc;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 releaseManifest;
                               END;
                                }
      { 1000000018;2 ;Action    ;
                      Name=acReopen;
                      CaptionML=ENU=Re&open;
                      Promoted=Yes;
                      Enabled=NOT bOpenStatus;
                      Image=ReOpen;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 reopenManifest;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1000000000;0;Container;
                ContainerType=ContentArea }

    { 1000000001;1;Group  ;
                Name=General;
                GroupType=Group }

    { 1000000002;2;Field  ;
                SourceExpr="No.";
                Editable=bOpenStatus }

    { 1000000003;2;Field  ;
                SourceExpr="Location Code";
                Editable=bOpenStatus }

    { 1000000012;2;Field  ;
                SourceExpr="Shipping Agent Code";
                Editable=bOpenStatus }

    { 1000000004;2;Field  ;
                SourceExpr="Created On";
                Enabled=FALSE;
                Editable=FALSE }

    { 1000000005;2;Field  ;
                Lookup=No;
                DrillDown=No;
                AssistEdit=No;
                SourceExpr="Created By";
                Enabled=FALSE;
                Editable=FALSE }

    { 1000000006;2;Field  ;
                SourceExpr="Total Weight";
                Enabled=FALSE;
                Editable=FALSE }

    { 1000000007;2;Field  ;
                SourceExpr="Weight Unit of Measure";
                Editable=bOpenStatus }

    { 1000000008;2;Field  ;
                DrillDown=No;
                SourceExpr="Total Value";
                Enabled=FALSE;
                Editable=FALSE }

    { 1000000013;2;Field  ;
                Lookup=No;
                DrillDown=No;
                AssistEdit=No;
                SourceExpr="Total Freight Cost";
                Enabled=FALSE;
                Editable=FALSE }

    { 1000000019;2;Field  ;
                SourceExpr="ScanForm ID";
                Visible=FALSE;
                Editable=FALSE }

    { 1000000020;2;Field  ;
                SourceExpr="Carrier Manifest URL";
                Visible=FALSE;
                Editable=FALSE }

    { 1000000009;1;Part   ;
                Name=pgManifestLines;
                SubPageLink=Manifest No.=FIELD(No.);
                PagePartID=Page23044635;
                PartType=Page }

  }
  CODE
  {
    VAR
      recDShipSetup@1000000002 : Record 23044600;
      cuShipManifestMgmt@1000000000 : Codeunit 23044607;
      bOpenStatus@1000000001 : Boolean;
      bHasShipments@1000000003 : Boolean;

    LOCAL PROCEDURE runManifestReport@1000000000();
    BEGIN
      //<FUNC>
      //  Description: Function for acManifest event
      //  Called From: This page (P23044633)
      //  Side Effect: Releases the manifest (with user prompt)
      //</FUNC>

      cuShipManifestMgmt.runManifestReport(Rec);
    END;

    LOCAL PROCEDURE getShipments@1000000008();
    VAR
      ltrecManifestBuffer@1000000001 : TEMPORARY Record 23044620;
      lpgShipmentManifestWorksheet@1000000000 : Page 23044636;
    BEGIN
      //<FUNC>
      //  Description: Allows user to grab relevant shipment documents
      //  Called From: This page (P23044633)
      //  Side Effect: None
      //</FUNC>

      // must set location
      TESTFIELD("Location Code");

      cuShipManifestMgmt.getShipments(Rec);
    END;

    LOCAL PROCEDURE releaseManifest@1000000009();
    VAR
      lrecManifestLine@1000000000 : Record 23044619;
    BEGIN
      //<FUNC>
      //  Description: Releases the manifest
      //  Called From: This page (P23044633)
      //  Side Effect: Marks related LPs as "Manifested"
      //</FUNC>

      cuShipManifestMgmt.changeStatus(Rec, Rec.Status::Released);
    END;

    LOCAL PROCEDURE reopenManifest@1000000010();
    VAR
      lrecManifestLine@1000000000 : Record 23044619;
    BEGIN
      //<FUNC>
      //  Description: Reopens the manifest
      //  Called From: This page (P23044633)
      //  Side Effect: Marks related LPs as "Shipped"
      //</FUNC>

      cuShipManifestMgmt.changeStatus(Rec, Rec.Status::Open);
    END;

    BEGIN
    {
      ************************
      Copyright Notice
      This objects content is copyright of Insight Works 2011.  All rights reserved.
      Any redistribution or reproduction of part or all of the contents in any form is prohibited.
      ************************
    }
    END.
  }
}

