OBJECT Page 14002390 E.D.I. Files
{
  OBJECT-PROPERTIES
  {
    Date=12/28/17;
    Time=12:00:00 PM;
    Version List=SE0.60.18;
  }
  PROPERTIES
  {
    CaptionML=ENU=E.D.I. Files;
    SaveValues=Yes;
    InsertAllowed=No;
    DeleteAllowed=No;
    ModifyAllowed=No;
    SourceTable=Table14002368;
    DelayedInsert=Yes;
    PageType=Worksheet;
    AutoSplitKey=Yes;
    OnOpenPage=VAR
                 TemplateSelected@1000 : Boolean;
               BEGIN
                 FilePath := '';

                 CLEAR(EDIManagement);
                 EDIManagement.SetTemplate(EDITemplate,CurrentEDITemplateName);
                 UpdateEDIFiles;
               END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 1240030001;1 ;ActionGroup;
                      CaptionML=ENU=&Line }
      { 1240030004;2 ;Action    ;
                      CaptionML=ENU=View &Text File;
                      Image=View;
                      OnAction=BEGIN
                                 EDIManagement.ViewFile(Path,Name);
                               END;
                                }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1240030003;1 ;ActionGroup;
                      CaptionML=ENU=F&unctions }
      { 1000000000;2 ;Action    ;
                      CaptionML=ENU=Refresh &File List;
                      Image=Refresh;
                      OnAction=BEGIN
                                 UpdateEDIFiles;
                               END;
                                }
      { 1240030006;2 ;ActionGroup;
                      CaptionML=ENU=View;
                      Image=View }
      { 1240030008;3 ;Action    ;
                      CaptionML=ENU=View Inbox &Docs;
                      Promoted=Yes;
                      Image=View;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 FileSource := FileSource::Inbox;
                                 UpdateEDIFiles;
                                 CurrPage.UPDATE(FALSE);
                               END;
                                }
      { 1240030009;3 ;Action    ;
                      CaptionML=ENU=View Inbox &Archived Docs;
                      OnAction=BEGIN
                                 FileSource := FileSource::"Inbox Archive";
                                 UpdateEDIFiles;
                                 CurrPage.UPDATE(FALSE);
                               END;
                                }
      { 1240030011;3 ;Action    ;
                      CaptionML=ENU=View Outbox &Docs;
                      Promoted=Yes;
                      Image=View;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 FileSource := FileSource::Outbox;
                                 UpdateEDIFiles;
                                 CurrPage.UPDATE(FALSE);
                               END;
                                }
      { 1240030012;3 ;Action    ;
                      CaptionML=ENU=View Outbox &Archived Docs;
                      OnAction=BEGIN
                                 FileSource := FileSource::"Outbox Archive";
                                 UpdateEDIFiles;
                                 CurrPage.UPDATE(FALSE);
                               END;
                                }
      { 1240030022;3 ;Action    ;
                      CaptionML=ENU=View Common Rec. &Files;
                      Promoted=Yes;
                      Image=View;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 FileSource := FileSource::"Common Rec. Dir.";
                                 UpdateEDIFiles;
                                 CurrPage.UPDATE(FALSE);
                               END;
                                }
      { 1240030023;3 ;Action    ;
                      CaptionML=ENU=View Common Rec. &Archived Files;
                      OnAction=BEGIN
                                 FileSource := FileSource::"Common Rec. Dir. Archive";
                                 UpdateEDIFiles;
                                 CurrPage.UPDATE(FALSE);
                               END;
                                }
      { 1240030024;2 ;ActionGroup;
                      CaptionML=ENU=&Process;
                      Image=Import }
      { 1240030025;3 ;Action    ;
                      CaptionML=ENU=Process All &Common Rec. Files;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Import;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 IF FileSource <> FileSource::"Common Rec. Dir." THEN BEGIN
                                   MESSAGE(Text001);
                                   EXIT;
                                 END;
                                 IF CONFIRM(Text002,TRUE) THEN
                                   EDIManagement.ImportComRecFiles(EDIFileTmp);

                                 CurrPage.UPDATE(FALSE);
                               END;
                                }
      { 1240030026;3 ;Action    ;
                      CaptionML=ENU=Process All &Inbox files;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Import;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 IF FileSource <> FileSource::Inbox THEN BEGIN
                                   MESSAGE(Text003);
                                   EXIT;
                                 END;

                                 IF CONFIRM(Text004,TRUE) THEN
                                   EDIManagement.ImportAllFiles(EDIFileTmp);

                                 CurrPage.UPDATE(FALSE);
                               END;
                                }
      { 1240030027;3 ;Action    ;
                      CaptionML=ENU=Process &Single Inbox File;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Import;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 IF FileSource = FileSource::Inbox THEN
                                   EDIManagement.ImportFile(Rec)
                                 ELSE
                                   MESSAGE(Text005);

                                 CurrPage.UPDATE(FALSE);
                               END;
                                }
      { 1240030028;2 ;Action    ;
                      CaptionML=ENU=&Archive Single File;
                      Image=History;
                      OnAction=BEGIN
                                 IF (FileSource = FileSource::"Inbox Archive") OR
                                    (FileSource = FileSource::"Outbox Archive") OR
                                    (FileSource = FileSource::"Common Rec. Dir. Archive")
                                 THEN BEGIN
                                   MESSAGE(Text006);
                                   EXIT;
                                 END;

                                 EDIManagement.ArchiveFile(Rec);
                                 CurrPage.UPDATE(FALSE);
                               END;
                                }
      { 1240030029;2 ;Action    ;
                      CaptionML=ENU=&Restore Single File;
                      Image=History;
                      OnAction=BEGIN
                                 IF (FileSource <> FileSource::"Inbox Archive") AND
                                    (FileSource <> FileSource::"Outbox Archive")
                                 THEN BEGIN
                                   MESSAGE(Text007);
                                   EXIT;
                                 END;

                                 EDIManagement.RestoreFile(Rec);
                                 CurrPage.UPDATE(FALSE);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 39  ;1   ;Field     ;
                Lookup=Yes;
                CaptionML=ENU=EDI Template Name;
                ToolTipML=ENU=Temporary table/fields used for internal processing.;
                SourceExpr=CurrentEDITemplateName;
                OnValidate=BEGIN
                             EDIManagement.CheckTemplate(EDITemplate,CurrentEDITemplateName);
                           END;

                OnLookup=BEGIN
                           CurrPage.SAVERECORD;
                           EDIManagement.LookUpTemplate(EDITemplate,EDIFileTmp,CurrentEDITemplateName,FilePath,FileSource,FileInterface);
                           CurrPage.UPDATE(FALSE);
                         END;
                          }

    { 1240030000;1;Group  ;
                GroupType=Repeater }

    { 1240030013;2;Field  ;
                ToolTipML=ENU=Temporary table/fields used for internal processing.;
                SourceExpr=Name }

    { 1240030015;2;Field  ;
                ToolTipML=ENU=Temporary table/fields used for internal processing.;
                SourceExpr=Size }

    { 1240030017;2;Field  ;
                ToolTipML=ENU=Temporary table/fields used for internal processing.;
                SourceExpr=Date }

    { 1240030019;2;Field  ;
                ToolTipML=ENU=Temporary table/fields used for internal processing.;
                SourceExpr=Time }

    { 30  ;1   ;Group      }

    { 31  ;2   ;Field     ;
                Name=Balance;
                CaptionML=ENU=Source;
                ToolTipML=ENU=Temporary table/fields used for internal processing.;
                SourceExpr=FileSource;
                AutoFormatType=1;
                Editable=FALSE }

    { 1240030105;2;Field  ;
                CaptionML=ENU=Path;
                ToolTipML=ENU=Temporary table/fields used for internal processing.;
                SourceExpr=FilePath;
                Editable=FALSE }

    { 37  ;2   ;Field     ;
                CaptionML=ENU=Interface File Type;
                ToolTipML=ENU=Temporary table/fields used for internal processing.;
                SourceExpr=FileInterface;
                Editable=FALSE }

  }
  CODE
  {
    VAR
      EDITemplate@1000000000 : Record 14002350;
      EDIFileTmp@1000000001 : Record 14002368;
      EDIManagement@1000000002 : Codeunit 14002379;
      FileInterface@1000000004 : 'None,Harbinger,Sterling,GE PC EDI,Qual EDI,Supply Tech,X12 Delimited,EDIFACT Delimited';
      FileSource@1000000003 : 'Inbox,Inbox Archive,Outbox,Outbox Archive,Common Rec. Dir.,Common Rec. Dir. Archive';
      FilePath@1000000006 : Text[100];
      Directory@1000000005 : Text[150];
      CurrentEDITemplateName@1004 : Code[10];
      Text001@1240030012 : TextConst 'ENU=You must view the Common Receive Directory before processing the files.';
      Text002@1240030011 : TextConst 'ENU=Process Common Receive File?';
      Text003@1240030010 : TextConst 'ENU=You must view the Inbox before processing the files.';
      Text004@1240030009 : TextConst 'ENU=Process all files in Inbox?';
      Text005@1240030008 : TextConst 'ENU=You must view the Inbox before selecting a file to process.';
      Text006@1240030007 : TextConst 'ENU=The file you have selected is already in an archive directory.';
      Text007@1240030006 : TextConst 'ENU=A file can only be restored from the Inbox Archive or Outbox Archive.';

    LOCAL PROCEDURE UpdateEDIFiles@1();
    BEGIN
      IF CurrentEDITemplateName = '' THEN
        EDIManagement.DeleteFileLines(EDITemplate,EDIFileTmp,FilePath,FileSource,FileInterface)
      ELSE
        EDIManagement.GetFileLines(EDITemplate,EDIFileTmp,FilePath,FileSource,FileInterface);
    END;

    BEGIN
    END.
  }
}

