OBJECT Page 11123315 SC - Process Requests Setup
{
  OBJECT-PROPERTIES
  {
    Date=04/18/17;
    Time=[ 1:00:00 PM];
    Version List=SCW19.2.0;
  }
  PROPERTIES
  {
    CaptionML=ENU=Process Requests Setup;
    InsertAllowed=No;
    DeleteAllowed=No;
    SourceTable=Table11123316;
    PageType=Card;
    OnOpenPage=BEGIN
                 IF NOT GET(USERID) THEN
                   IF CONFIRM(Text11123302,FALSE,USERID) THEN BEGIN
                     INIT;
                     "User ID" := USERID;
                     "Request Ext. Tool" := '%windir%\system32\notepad.exe';
                     "Response Ext. Tool" := 'C:\Program Files\Internet Explorer\iexplore.exe';
                     IF CURRENTCLIENTTYPE = CLIENTTYPE::Windows THEN
                       "Response Output Directory" := GetFolderPath('Local AppData') + '\Temp\'
                     ELSE
                       "Response Output Directory" := TEMPORARYPATH;
                     INSERT;
                   END;
               END;

  }
  CONTROLS
  {
    { 11123306;0;Container;
                ContainerType=ContentArea }

    { 11123305;1;Group    ;
                CaptionML=ENU=General }

    { 11123304;2;Field    ;
                SourceExpr="Request Ext. Tool";
                OnAssistEdit=VAR
                               Path@11123303 : Text[200];
                             BEGIN
                               Path := OpenFile;
                               IF Path <> '' THEN
                                 "Request Ext. Tool" := Path;
                             END;
                              }

    { 11123303;2;Field    ;
                SourceExpr="Response Ext. Tool";
                OnAssistEdit=VAR
                               Path@11123303 : Text[200];
                             BEGIN
                               Path := OpenFile;
                               IF Path <> '' THEN
                                 "Response Ext. Tool" := Path;
                             END;
                              }

    { 11123302;2;Field    ;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Response Output Directory" }

  }
  CODE
  {
    VAR
      Text11123302@11123302 : TextConst 'ENU=Setup record does not exist for user %1. Do you want it to be created automatically?';
      Text11123303@11123303 : TextConst 'ENU=Select File';
      Text11123304@11123304 : TextConst 'ENU=Executable files (*.exe)|*.exe|All files (*.*)|*.*';

    PROCEDURE OpenFile@11123302() Path : Text[50];
    VAR
      DialogMgt@11123303 : Codeunit 419;
    BEGIN
      Path := DialogMgt.OpenFileDialog(Text11123303,'',Text11123304);
    END;

    LOCAL PROCEDURE GetFolderPath@11123304(Which@11123302 : Text[1024]) : Text[1024];
    VAR
      WSHShell@11123303 : Automation "{F935DC20-1CF0-11D0-ADB9-00C04FD58A0B} 1.0:{72C24DD5-D70A-438B-8A42-98424B88AFB8}:'Windows Script Host Object Model'.WshShell";
      Registry@11123301 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.Microsoft.Win32.Registry";
    BEGIN
      CREATE(WSHShell,TRUE,TRUE);
      EXIT(
        FORMAT(
          WSHShell.RegRead(
          'HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders\' + Which)));
      CLEAR(WSHShell);
    END;

    BEGIN
    END.
  }
}

