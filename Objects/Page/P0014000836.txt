OBJECT Page 14000836 Posted Bill of Lading
{
  OBJECT-PROPERTIES
  {
    Date=02/25/19;
    Time=12:00:00 PM;
    Version List=SE0.61;
  }
  PROPERTIES
  {
    CaptionML=ENU=Posted Bill of Lading;
    InsertAllowed=No;
    DeleteAllowed=No;
    SourceTable=Table14000822;
    SourceTableView=WHERE(Posted=CONST(Yes));
    PageType=Card;
    OnModifyRecord=BEGIN
                     BOLMgt.ModifyPostedBillOfLading(Rec);

                     EXIT(FALSE);
                   END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 22      ;1   ;ActionGroup;
                      CaptionML=ENU=&Bill of Lading }
      { 32      ;2   ;Action    ;
                      ShortCutKey=Ctrl+F7;
                      CaptionML=ENU=Information Lines;
                      RunObject=Page 14000838;
                      RunPageLink=Bill of Lading No.=FIELD(No.);
                      Image=EditList }
      { 28      ;2   ;Action    ;
                      CaptionML=ENU=Summary;
                      RunObject=Page 14000826;
                      RunPageLink=Bill of Lading No.=FIELD(No.),
                                  Bill of Lading Type=CONST(Standard);
                      Promoted=Yes;
                      Image=BOMVersions;
                      PromotedCategory=Process }
      { 21      ;2   ;Action    ;
                      CaptionML=ENU=ASN Summary;
                      RunObject=Page 14000832;
                      RunPageLink=Bill of Lading No.=FIELD(No.),
                                  Bill of Lading Type=CONST("ASN (EDI)");
                      Image=BOMVersions }
      { 33      ;2   ;Action    ;
                      CaptionML=ENU=Shipping Agent Options;
                      Image=CalculateCrossDock;
                      OnAction=BEGIN
                                 Shipping.ShowOptPageShipBillOfLading(Rec);
                               END;
                                }
      { 26      ;2   ;Action    ;
                      CaptionML=ENU=E-&Mail List;
                      ToolTipML=ENU=Specifies a list of E-Mail Addresses associated to this record.;
                      Image=SendTo;
                      OnAction=VAR
                                 EMailListEntry@1240030001 : Record 14000908;
                               BEGIN
                                 EMailListEntry.RESET;
                                 EMailListEntry.SETRANGE("Table ID",DATABASE::"Bill of Lading");
                                 EMailListEntry.SETRANGE(Code,"No.");
                                 CASE "Ship-to Type" OF
                                   "Ship-to Type"::Customer:
                                     PAGE.RUNMODAL(PAGE::"E-Mail List Entries",EMailListEntry);
                                   "Ship-to Type"::Vendor:
                                     PAGE.RUNMODAL(PAGE::"E-Mail List Entries (Edit)",EMailListEntry);
                                 END;
                               END;
                                }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 31      ;1   ;ActionGroup;
                      CaptionML=ENU=F&unctions }
      { 24      ;2   ;Action    ;
                      CaptionML=ENU=Reopen Bill of Lading;
                      Image=ReOpen;
                      OnAction=BEGIN
                                 IF CONFIRM(Text001,FALSE,"No.") THEN
                                   BOLMgt.UnPostBillOfLading(Rec);
                               END;
                                }
      { 102     ;2   ;Action    ;
                      CaptionML=ENU=Send E-Mail Notification;
                      Image=Email;
                      OnAction=VAR
                                 EMailMgt@1000000001 : Codeunit 14000903;
                               BEGIN
                                 TESTFIELD("E-Mail Notification Handled",FALSE);

                                 EMailMgt.SendBillOfLadingNotification(Rec,TRUE,FALSE);
                               END;
                                }
      { 117     ;2   ;ActionGroup;
                      CaptionML=ENU=EDI;
                      Image=ElectronicDoc }
      { 98      ;3   ;Action    ;
                      CaptionML=ENU=Send ASN;
                      Image=ElectronicDoc;
                      OnAction=BEGIN
                                 TESTFIELD("EDI ASN",TRUE);
                                 TESTFIELD("EDI BSN",FALSE);
                                 TESTFIELD("Summary Released");
                                 TESTFIELD(Released,TRUE);
                                 IF "EDI ASN Generated" THEN
                                   IF NOT CONFIRM(Text002,FALSE,"EDI ASN Gen. Date") THEN
                                     EXIT;
                                 EDIIntegration.SendASN(Rec);
                               END;
                                }
      { 99      ;3   ;Action    ;
                      CaptionML=ENU=Send BSN;
                      Image=ElectronicDoc;
                      OnAction=BEGIN
                                 TESTFIELD("EDI ASN",TRUE);
                                 TESTFIELD("EDI BSN",TRUE);
                                 TESTFIELD("Summary Released");
                                 TESTFIELD(Released,TRUE);
                                 IF "EDI BSN Generated" THEN
                                   IF NOT CONFIRM(Text003,FALSE,"EDI BSN Gen. Date") THEN
                                     EXIT;
                                 EDIIntegration.SendBSN(Rec);
                               END;
                                }
      { 118     ;3   ;Action    ;
                      CaptionML=ENU=Send Electronic BOL;
                      Image=ElectronicDoc;
                      OnAction=BEGIN
                                 TESTFIELD("EDI Electronic BOL",TRUE);

                                 IF NOT Released THEN
                                   IF NOT CONFIRM(Text001) THEN
                                     EXIT
                                   ELSE
                                     BOLMgt.CloseBillOfLading(Rec,0);

                                 IF "EDI Electronic BOL Generated" THEN
                                   IF NOT CONFIRM(Text004,FALSE,"EDI Electronic BOL Gen. Date") THEN
                                     EXIT;

                                 EDIIntegration.SendElectronicBOL(Rec);
                               END;
                                }
      { 1240020006;3 ;Action    ;
                      CaptionML=ENU=Trace;
                      ToolTipML=ENU=Select to review all records with the same 'EDI Internal Doc No.';
                      Image=Trace;
                      OnAction=VAR
                                 EDITrace@1240020000 : Page 14002386;
                               BEGIN
                                 CLEAR(EDITrace);
                                 EDITrace.SetDoc("EDI Internal Doc. No.");
                                 EDITrace.RUNMODAL;
                               END;
                                }
      { 1240030001;2 ;Action    ;
                      CaptionML=ENU=Track Shipment;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Track;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 StartTrackingBOL;
                               END;
                                }
      { 1240020011;2 ;Action    ;
                      Name=Combine Shipments;
                      CaptionML=ENU=Combine Shipments;
                      OnAction=VAR
                                 PackingRule@1240020001 : Record 14000715;
                               BEGIN
                                 PackingRule.GetPackingRule("Ship-to Type","Ship-to No.","Ship-to Code");
                                 PackingRule.TESTFIELD("Shipment Invoicing Required",FALSE);

                                 CombineShipments;
                               END;
                                }
      { 86      ;2   ;Action    ;
                      CaptionML=ENU=Post Shipment Invoices;
                      ToolTipML=ENU=When run, a one-to-one relationship is established between the Posted Sales Shipment and the Posted Sales Invoice as this may be driven by an EDI Trade Partner.;
                      Image=PostDocument;
                      OnAction=VAR
                                 SalesShipmentHeader@1240030001 : Record 110;
                                 PostShipmentInvoices@1240030002 : Report 14000720;
                               BEGIN
                                 SalesShipmentHeader.RESET;
                                 SalesShipmentHeader.SETCURRENTKEY("Bill of Lading No.");
                                 SalesShipmentHeader.SETRANGE("Bill of Lading No.","No.");

                                 CLEAR(PostShipmentInvoices);
                                 PostShipmentInvoices.SETTABLEVIEW(SalesShipmentHeader);
                                 PostShipmentInvoices.RUNMODAL;
                               END;
                                }
      { 18      ;1   ;ActionGroup;
                      CaptionML=ENU=&Print }
      { 90      ;2   ;Action    ;
                      CaptionML=ENU=Bill of Lading;
                      Image=PrintDocument;
                      OnAction=BEGIN
                                 BillOfLading := Rec;
                                 BillOfLading.SETRECFILTER;
                                 REPORT.RUNMODAL(REPORT::"Bill of Lading",TRUE,TRUE,BillOfLading);
                               END;
                                }
      { 112     ;2   ;Action    ;
                      CaptionML=ENU=Bill of Lading Advanced;
                      Image=PrintDocument;
                      OnAction=BEGIN
                                 BillOfLading := Rec;
                                 BillOfLading.SETRECFILTER;
                                 REPORT.RUNMODAL(REPORT::"Bill of Lading Advanced",TRUE,TRUE,BillOfLading);
                               END;
                                }
      { 34      ;2   ;Action    ;
                      CaptionML=ENU=Bill of Lading Info. Lines Advanced;
                      Promoted=Yes;
                      Image=PrintDocument;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 BillOfLading := Rec;
                                 BillOfLading.SETRECFILTER;
                                 REPORT.RUNMODAL(REPORT::"Bill of Lading Info. Lines Adv",TRUE,TRUE,BillOfLading);
                               END;
                                }
      { 110     ;2   ;Action    ;
                      CaptionML=ENU=Bill of Lading Summary;
                      Image=PrintDocument;
                      OnAction=BEGIN
                                 BillOfLading := Rec;
                                 BillOfLading.SETRECFILTER;
                                 REPORT.RUNMODAL(REPORT::"Bill of Lading Summary",TRUE,TRUE,BillOfLading);
                               END;
                                }
      { 111     ;2   ;Action    ;
                      CaptionML=ENU=Bill of Lading Summary ASN;
                      Image=PrintDocument;
                      OnAction=BEGIN
                                 BillOfLading := Rec;
                                 BillOfLading.SETRECFILTER;
                                 REPORT.RUNMODAL(REPORT::"Bill of Lading Summary ASN",TRUE,TRUE,BillOfLading);
                               END;
                                }
      { 1240030000;2 ;Action    ;
                      CaptionML=ENU=Bill of Lading &Label;
                      Image=PrintDocument;
                      OnAction=BEGIN
                                 PrintLabel;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                CaptionML=ENU=General }

    { 2   ;2   ;Field     ;
                SourceExpr="No.";
                Editable=FALSE }

    { 4   ;2   ;Field     ;
                SourceExpr=Description;
                Editable=FALSE }

    { 68  ;2   ;Field     ;
                SourceExpr="External Tracking No.";
                Editable=FALSE }

    { 47  ;2   ;Field     ;
                SourceExpr="Ship-to Type";
                Editable=FALSE }

    { 30  ;2   ;Field     ;
                SourceExpr="Ship-to No.";
                Importance=Promoted;
                Editable=FALSE }

    { 36  ;2   ;Field     ;
                SourceExpr="Ship-to Code";
                Importance=Promoted;
                Editable=FALSE }

    { 104 ;2   ;Field     ;
                SourceExpr="Documents Exists";
                Editable=FALSE }

    { 64  ;2   ;Field     ;
                SourceExpr="Shipping Agent Code";
                Importance=Promoted;
                Editable=FALSE }

    { 66  ;2   ;Field     ;
                SourceExpr="Shipping Agent Service";
                Importance=Promoted;
                Editable=FALSE }

    { 70  ;2   ;Field     ;
                SourceExpr="Shipping Agent Account No.";
                Importance=Promoted;
                Editable=FALSE }

    { 84  ;2   ;Field     ;
                SourceExpr="Calculation Weight";
                Editable=FALSE }

    { 6   ;2   ;Field     ;
                SourceExpr=Released;
                Editable=FALSE }

    { 16  ;2   ;Field     ;
                SourceExpr="Summary Released";
                Editable=FALSE }

    { 82  ;2   ;Field     ;
                SourceExpr="Shipping Bill Verified";
                Editable=FALSE }

    { 100 ;2   ;Field     ;
                SourceExpr="E-Mail Notification Handled" }

    { 9   ;1   ;Part      ;
                Name=Lines;
                SubPageLink=Bill of Lading No.=FIELD(No.);
                PagePartID=Page14000825;
                Editable=FALSE }

    { 1905314101;1;Group  ;
                CaptionML=ENU=Ship-to Address }

    { 20  ;2   ;Field     ;
                SourceExpr="Ship-to Name";
                Importance=Promoted;
                Editable=FALSE }

    { 38  ;2   ;Field     ;
                SourceExpr="Ship-to Address";
                Importance=Promoted;
                Editable=FALSE }

    { 40  ;2   ;Field     ;
                SourceExpr="Ship-to Address 2";
                Editable=FALSE }

    { 42  ;2   ;Field     ;
                SourceExpr="Ship-to City";
                Editable=FALSE }

    { 44  ;2   ;Field     ;
                SourceExpr="Ship-to State";
                Editable=FALSE }

    { 46  ;2   ;Field     ;
                SourceExpr="Ship-to ZIP Code";
                Editable=FALSE }

    { 48  ;2   ;Field     ;
                SourceExpr="Ship-to Contact";
                Editable=FALSE }

    { 1907308001;1;Group  ;
                CaptionML=ENU=Ship-from Address }

    { 50  ;2   ;Field     ;
                SourceExpr="Ship-from Name";
                Importance=Promoted;
                Editable=FALSE }

    { 52  ;2   ;Field     ;
                SourceExpr="Ship-from Address";
                Importance=Promoted;
                Editable=FALSE }

    { 54  ;2   ;Field     ;
                SourceExpr="Ship-from Address 2";
                Editable=FALSE }

    { 56  ;2   ;Field     ;
                SourceExpr="Ship-from City";
                Editable=FALSE }

    { 58  ;2   ;Field     ;
                SourceExpr="Ship-from State";
                Editable=FALSE }

    { 60  ;2   ;Field     ;
                SourceExpr="Ship-from ZIP Code";
                Editable=FALSE }

    { 62  ;2   ;Field     ;
                SourceExpr="Ship-from Contact";
                Editable=FALSE }

    { 1901202501;1;Group  ;
                CaptionML=ENU=Value }

    { 72  ;2   ;Field     ;
                SourceExpr="Override Weight";
                Editable=FALSE }

    { 74  ;2   ;Field     ;
                SourceExpr="Override Volume";
                Editable=FALSE }

    { 76  ;2   ;Field     ;
                SourceExpr="Override Value";
                Editable=FALSE }

    { 78  ;2   ;Field     ;
                SourceExpr="Shipping Charge";
                Editable=FALSE }

    { 80  ;2   ;Field     ;
                SourceExpr="Shipping Cost";
                Editable=FALSE }

    { 113 ;2   ;Field     ;
                SourceExpr="Cost On Documents";
                Editable=FALSE }

    { 10  ;2   ;Field     ;
                SourceExpr="Posted Weight";
                Editable=FALSE }

    { 12  ;2   ;Field     ;
                SourceExpr="Posted Volume";
                Editable=FALSE }

    { 14  ;2   ;Field     ;
                SourceExpr="Posted Value";
                Editable=FALSE }

    { 1240030002;2;Field  ;
                SourceExpr="Used on Bill of Lading No." }

    { 1905396001;1;Group  ;
                CaptionML=ENU=EDI }

    { 92  ;2   ;Field     ;
                ToolTipML=ENU=Specifies if an EDI advanced shipment notice (ex. 856) is required to be sent. The field is enabled by the customer/ship-to's Packing Rule "ASN Summary Type" populated with a value.;
                SourceExpr="EDI ASN";
                Editable=FALSE }

    { 94  ;2   ;Field     ;
                ToolTipML=ENU=Specifies if an EDI advanced shipment notice (ex. 856) was generated for the bill of lading.;
                SourceExpr="EDI ASN Generated";
                Editable=FALSE }

    { 96  ;2   ;Field     ;
                ToolTipML=ENU=Specifies the date the EDI advanced shipment notice (ex. 856) was sent for the bill of lading.;
                SourceExpr="EDI ASN Gen. Date";
                Importance=Promoted;
                Editable=FALSE }

    { 1240020007;2;Field  ;
                SourceExpr="VICS Bill of Lading No." }

    { 1240030008;2;Field  ;
                ToolTipML=ENU=Specifies if an EDI billing and shipment notice (ex. 857) is required to be sent. The field is enabled by the customer/ship-to's Packing Rule "ASN Summary Type" populated with a value and "Ship Notice Type"-ASN (Billing).;
                SourceExpr="EDI BSN";
                Editable=FALSE }

    { 1240030004;2;Field  ;
                ToolTipML=ENU=Specifies if an EDI billing and shipment notice (ex. 857) was generated for the bill of lading.;
                SourceExpr="EDI BSN Generated";
                Editable=FALSE }

    { 1240030006;2;Field  ;
                ToolTipML=ENU=Specifies the date the EDI billing and shipment notice (ex. 857) was sent for the bill of lading.;
                SourceExpr="EDI BSN Gen. Date";
                Editable=FALSE }

    { 1240020009;2;Field  ;
                SourceExpr="EDI Routing Request No." }

    { 106 ;2   ;Field     ;
                SourceExpr="Packing Date";
                Editable=FALSE }

    { 115 ;2   ;Field     ;
                SourceExpr="Pickup Date";
                Importance=Promoted;
                Editable=FALSE }

    { 108 ;2   ;Field     ;
                SourceExpr="Expected Delivery Date";
                Editable=FALSE }

    { 1240020000;2;Field  ;
                ToolTipML=ENU=Specifies if an EDI electronic bill of lading (ex. 211) is required to be sent. The field is enabled by the Trade Partner's 'Indirect Electronic BOL Req' - TRUE and the EDI Electronic BOL Carriers 'InDirect BOL' - TRUE.;
                SourceExpr="EDI Electronic BOL";
                Editable=FALSE }

    { 1240020002;2;Field  ;
                ToolTipML=ENU=Specifies if an EDI electronic bill of lading (ex. 211) was generated for the bill of lading.;
                SourceExpr="EDI Electronic BOL Generated" }

    { 1240020004;2;Field  ;
                ToolTipML=ENU=Specifies the date the EDI electronic bill of lading (ex. 211) was sent for the bill of lading.;
                SourceExpr="EDI Electronic BOL Gen. Date" }

    { 1240020001;1;Group  ;
                CaptionML=ENU=Custom Values;
                GroupType=Group }

    { 1240020003;2;Field  ;
                ToolTipML=ENU=Field which may be used to enter custom data that the system table does not have a place to store. The value may be used in E-Ship label printing or EDI advanced shipment notice (ASN/856) mapping.;
                SourceExpr="Custom Value 1";
                Editable=FALSE }

    { 1240020005;2;Field  ;
                ToolTipML=ENU=Field which may be used to enter custom data that the system table does not have a place to store. The value may be used in E-Ship label printing or EDI advanced shipment notice (ASN/856) mapping.;
                SourceExpr="Custom Value 2";
                Editable=FALSE }

    { 1240020008;2;Field  ;
                ToolTipML=ENU=Field which may be used to enter custom data that the system table does not have a place to store. The value may be used in E-Ship label printing or EDI advanced shipment notice (ASN/856) mapping.;
                SourceExpr="Custom Value 3";
                Editable=FALSE }

    { 1240020010;2;Field  ;
                ToolTipML=ENU=Field which may be used to enter custom data that the system table does not have a place to store. The value may be used in E-Ship label printing or EDI advanced shipment notice (ASN/856) mapping.;
                SourceExpr="Custom Value 4";
                Editable=FALSE }

    { 1240020012;2;Field  ;
                ToolTipML=ENU=Field which may be used to enter custom data that the system table does not have a place to store. The value may be used in E-Ship label printing or EDI advanced shipment notice (ASN/856) mapping.;
                SourceExpr="Custom Value 5";
                Editable=FALSE }

    { 1240020013;2;Field  ;
                SourceExpr="Seal No.";
                Editable=FALSE }

    { 1240020014;2;Field  ;
                SourceExpr="Equipment No.";
                Editable=FALSE }

    { 1240020015;2;Field  ;
                SourceExpr="Equipment Initial";
                Editable=FALSE }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 1907745807;1;Part   ;
                SubPageLink=Used on Bill of Lading No.=FIELD(No.);
                PagePartID=Page14050137;
                Visible=TRUE;
                PartType=Page }

  }
  CODE
  {
    VAR
      BillOfLading@1000000001 : Record 14000822;
      BOLMgt@1000000002 : Codeunit 14000821;
      EDIIntegration@1240030000 : Codeunit 14000363;
      Shipping@1000000004 : Codeunit 14000701;
      Text001@1001 : TextConst 'ENU=Are you sure you will reopen the Bill of Lading %1?';
      Text002@1002 : TextConst 'ENU=ASN was generated on %1.  Do you want to send it again?';
      Text003@1240030001 : TextConst 'ENU=BSN was generated on %1.  Do you want to send it again?';
      Text004@1240020000 : TextConst 'ENU=EDI Electonic BOL was generated on %1. Do you want to re-create Electronic BOL?';

    BEGIN
    {
      2015-03-24 TPZ535 VCHERNYA
        Ship-to State / ZIP Code caption for Ship-to State field has been removed
        Ship-from State / ZIP Code caption for Ship-from State field has been removed
    }
    END.
  }
}

