OBJECT Page 14099211 Posted Inbound ASN Statistics
{
  OBJECT-PROPERTIES
  {
    Date=01/20/17;
    Time=12:00:00 PM;
    Version List=IBA1.11;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=ENU=Inbound ASN Statistics;
    SourceTable=Table14099203;
    PageType=Card;
    OnOpenPage=BEGIN
                 IF PostedInboundASNHeader.GET("ASN No.") THEN
                   CalcPostedInboundASNStats;
               END;

  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 2   ;1   ;Group     ;
                CaptionML=ENU=General }

    { 3   ;2   ;Field     ;
                CaptionML=ENU=Quantity;
                DecimalPlaces=0:5;
                SourceExpr=LineQty }

    { 7   ;2   ;Field     ;
                CaptionML=ENU=Net Weight;
                DecimalPlaces=0:5;
                SourceExpr=TotalNetWeight }

    { 10  ;2   ;Field     ;
                CaptionML=ENU=Gross Weight;
                DecimalPlaces=0:5;
                SourceExpr=TotalGrossWeight }

    { 17  ;2   ;Field     ;
                CaptionML=ENU=Volume;
                DecimalPlaces=0:5;
                SourceExpr=TotalVolume }

    { 1240020000;2;Field  ;
                Name=TotalUnitCost;
                CaptionML=ENU=Total Cost;
                DecimalPlaces=0:5;
                SourceExpr=TotalCost }

    { 1240020002;2;Field  ;
                Name=TotalImportedUnitCost;
                CaptionML=ENU=Total Imported Cost;
                DecimalPlaces=0:5;
                SourceExpr=TotalImportedCost }

  }
  CODE
  {
    VAR
      LineQty@1000 : Decimal;
      TotalNetWeight@1001 : Decimal;
      TotalGrossWeight@1002 : Decimal;
      TotalVolume@1003 : Decimal;
      PostedInboundASNHeader@1240020000 : Record 14099203;
      TotalCost@1240020001 : Decimal;
      TotalImportedCost@1240020002 : Decimal;

    PROCEDURE CalcPostedInboundASNStats@1240020002();
    VAR
      PostedInboundASNLine@1240020000 : Record 14099204;
    BEGIN
      PostedInboundASNLine.SETRANGE("ASN No.",PostedInboundASNHeader."ASN No.");
      IF PostedInboundASNLine.FIND('-') THEN
        REPEAT
          LineQty := LineQty + PostedInboundASNLine."Ship Qty.";
          TotalCost := TotalCost + (PostedInboundASNLine."Ship Qty." * PostedInboundASNLine."Purchase Line Direct Unit Cost");
          TotalImportedCost := TotalImportedCost + (PostedInboundASNLine."Ship Qty." * PostedInboundASNLine."Imported Unit Cost");
          TotalNetWeight := TotalNetWeight + (PostedInboundASNLine."Ship Qty." * PostedInboundASNLine."Net Weight");
          TotalGrossWeight := TotalGrossWeight + (PostedInboundASNLine."Ship Qty." * PostedInboundASNLine."Gross Weight");
          TotalVolume := TotalVolume + (PostedInboundASNLine."Ship Qty." * PostedInboundASNLine."Unit Volume");
        UNTIL PostedInboundASNLine.NEXT = 0;
    END;

    BEGIN
    END.
  }
}

