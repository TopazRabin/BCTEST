OBJECT Page 14000614 Receive External Tracking No.
{
  OBJECT-PROPERTIES
  {
    Date=06/28/17;
    Time=12:00:00 PM;
    Version List=SE0.60.09.01;
  }
  PROPERTIES
  {
    CaptionML=ENU=Receive External Tracking No.;
    PageType=Card;
    OnOpenPage=BEGIN
                 IF Receive."No." = '' THEN
                   ERROR(Text001);
               END;

    OnQueryClosePage=BEGIN
                       IF CloseAction IN [ACTION::OK,ACTION::LookupOK] THEN
                           OKOnPush;
                     END;

  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Field     ;
                CaptionML=ENU=Shipping Agent Code;
                SourceExpr=Receive."Shipping Agent Code";
                TableRelation="Shipping Agent" }

    { 2   ;1   ;Field     ;
                CaptionML=ENU=Shipping Agent Service;
                SourceExpr=Receive."Shipping Agent Service";
                OnLookup=BEGIN
                           Receive.TESTFIELD("Shipping Agent Code");
                           ShippingAgent.GET(Receive."Shipping Agent Code");
                           EShipAgentService.RESET;
                           EShipAgentService.SETRANGE("Shipping Agent Code",ShippingAgent.Code);
                           EShipAgentService.SETRANGE(
                             "World Wide Service",
                             EShipAgentService.InternationalShipment(ShippingAgent,Receive."Ship-from Country Code"));
                           IF EShipAgentService.UPSCanadianShipment(ShippingAgent,Receive."Ship-from Country Code") THEN
                             EShipAgentService.SETRANGE("UPS Canadian Service",TRUE);
                           IF EShipAgentService.UPSPuertoRicoShipment(ShippingAgent,Receive."Ship-from Country Code") THEN
                             EShipAgentService.SETRANGE("UPS Puerto Rico Service",TRUE);
                           IF PAGE.RUNMODAL(0,EShipAgentService) = ACTION::LookupOK THEN
                             Receive.VALIDATE("Shipping Agent Service",EShipAgentService.Code);
                         END;
                          }

    { 7   ;1   ;Field     ;
                CaptionML=ENU=External Tracking No.;
                SourceExpr=Receive."External Tracking No.";
                OnValidate=BEGIN
                             CurrPage.CLOSE;
                           END;
                            }

    { 20  ;1   ;Field     ;
                CaptionML=ENU=No.;
                SourceExpr=Receive."No.";
                Editable=FALSE }

    { 3   ;1   ;Field     ;
                CaptionML=ENU=Ship-from Name;
                SourceExpr=Receive."Ship-from Name";
                Editable=FALSE }

    { 6   ;1   ;Field     ;
                CaptionML=ENU=Ship-from Address;
                SourceExpr=Receive."Ship-from Address";
                Editable=FALSE }

    { 9   ;1   ;Field     ;
                CaptionML=ENU=Ship-from Address 2;
                SourceExpr=Receive."Ship-from Address 2";
                Editable=FALSE }

    { 15  ;1   ;Field     ;
                CaptionML=ENU=Ship-from City;
                SourceExpr=Receive."Ship-from City";
                Editable=FALSE }

    { 18  ;1   ;Field     ;
                CaptionML=ENU=Ship-from State / ZIP Code;
                SourceExpr=Receive."Ship-from State";
                Editable=FALSE }

    { 17  ;1   ;Field     ;
                SourceExpr=Receive."Ship-from ZIP Code";
                Editable=FALSE }

  }
  CODE
  {
    VAR
      Receive@1240030000 : Record 14000601;
      ShippingAgent@1240030001 : Record 291;
      EShipAgentService@1240030002 : Record 14000708;
      Text001@1001 : TextConst 'ENU=Receive has not been set.';

    PROCEDURE SetReceive@2(CurrentReceive@1240030000 : Record 14000601);
    BEGIN
      Receive := CurrentReceive;
    END;

    PROCEDURE GetReceive@3(VAR CurrentReceive@1240030000 : Record 14000601);
    BEGIN
      CurrentReceive := Receive;
    END;

    LOCAL PROCEDURE OKOnPush@19066895();
    BEGIN
      CurrPage.CLOSE;
    END;

    BEGIN
    END.
  }
}

