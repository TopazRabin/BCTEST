OBJECT Page 14000560 Vendor Performance Lines
{
  OBJECT-PROPERTIES
  {
    Date=03/27/19;
    Time=12:00:00 PM;
    Version List=UBP3.00;
  }
  PROPERTIES
  {
    CaptionML=ENU=Vendor Performance Lines;
    InsertAllowed=No;
    DeleteAllowed=No;
    ModifyAllowed=Yes;
    SourceTable=Table14000561;
    SourceTableView=SORTING(Location Code,Vendor,Document No.,Document Line No.,Item No.,Variant Code)
                    ORDER(Ascending);
    PageType=Worksheet;
    OnOpenPage=BEGIN
                 UBP.VPLGetFilter(LocationCode,Rec);
                 SETRANGE(Review);
               END;

    OnAfterGetRecord=BEGIN
                       GetVendorName(VendorName);
                     END;

    ActionList=ACTIONS
    {
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 43      ;1   ;ActionGroup;
                      CaptionML=ENU=Filter }
      { 46      ;2   ;Action    ;
                      CaptionML=ENU=All Lines;
                      Promoted=No;
                      Image=GetLines;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 SETRANGE(Review);
                                 CurrPage.UPDATE(FALSE);
                               END;
                                }
      { 47      ;2   ;Action    ;
                      CaptionML=ENU=Review Lines;
                      Promoted=No;
                      Image=FilterLines;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 SETRANGE(Review,TRUE);
                                 CurrPage.UPDATE(FALSE);
                               END;
                                }
      { 58      ;1   ;ActionGroup;
                      CaptionML=ENU=P&osting }
      { 59      ;2   ;Action    ;
                      ShortCutKey=F9;
                      CaptionML=ENU=Post;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Post;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 IF CONFIRM(
                                   Text001,TRUE,LocationCode) THEN BEGIN
                                   Location.GET(LocationCode);
                                   VendPerfCalc.PostVendPerf(Location);
                                   CurrPage.UPDATE(FALSE);
                                 END;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 38  ;1   ;Field     ;
                Lookup=Yes;
                CaptionML=ENU=Location;
                SourceExpr=LocationCode;
                OnValidate=BEGIN
                             UBP.VPLLocationVerify(LocationCode,Rec);
                               LocationCodeOnAfterValidate;
                           END;

                OnLookup=BEGIN
                           CurrPage.SAVERECORD;
                           UBP.VPLLocationLookup(LocationCode,Rec);
                           CurrPage.UPDATE(FALSE);
                         END;
                          }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 2   ;2   ;Field     ;
                ToolTipML=ENU=Specifies a location code for the warehouse or distribution center where your items are handled and stored before being sold.;
                SourceExpr="Location Code" }

    { 4   ;2   ;Field     ;
                SourceExpr=Vendor }

    { 6   ;2   ;Field     ;
                SourceExpr="Document No." }

    { 8   ;2   ;Field     ;
                SourceExpr="Document Line No.";
                Visible=FALSE;
                Editable=FALSE }

    { 10  ;2   ;Field     ;
                ToolTipML=ENU=Item number;
                SourceExpr="Item No." }

    { 12  ;2   ;Field     ;
                SourceExpr="Variant Code";
                Visible=FALSE }

    { 16  ;2   ;Field     ;
                SourceExpr="Order Date";
                Visible=FALSE }

    { 14  ;2   ;Field     ;
                SourceExpr="Date Received";
                Visible=FALSE }

    { 18  ;2   ;Field     ;
                SourceExpr="No. of Delivery Days" }

    { 44  ;2   ;Field     ;
                SourceExpr=Review }

    { 22  ;2   ;Field     ;
                SourceExpr="Exclude From Performance" }

    { 50  ;2   ;Field     ;
                SourceExpr="Lead Time Review %" }

    { 52  ;2   ;Field     ;
                SourceExpr="Min. Lead Time Days" }

    { 20  ;2   ;Field     ;
                SourceExpr="First Receipt" }

    { 24  ;2   ;Field     ;
                SourceExpr="Date Promised" }

    { 26  ;2   ;Field     ;
                SourceExpr="No. of Days Overdue" }

    { 28  ;2   ;Field     ;
                ToolTipML=ENU=Purchasing unit of measure;
                SourceExpr="Unit of Measure Code" }

    { 30  ;2   ;Field     ;
                SourceExpr="Order Qty." }

    { 32  ;2   ;Field     ;
                SourceExpr="Received Qty." }

    { 37  ;1   ;Group      }

    { 40  ;2   ;Field     ;
                CaptionML=ENU=Vendor Name;
                SourceExpr=VendorName;
                Editable=FALSE }

    { 48  ;2   ;Field     ;
                SourceExpr="Ave. Lead Time (Days)" }

  }
  CODE
  {
    VAR
      Location@14000500 : Record 14;
      UBP@14000501 : Codeunit 14000564;
      VendPerfCalc@14000502 : Codeunit 14000551;
      LocationCode@14000503 : Code[20];
      VendorName@14000504 : Text[50];
      Text001@1001 : TextConst 'ENU=Do you wish to post Vendor Performance Lines for location %1?';

    LOCAL PROCEDURE LocationCodeOnAfterValidate@19034787();
    BEGIN
      CurrPage.SAVERECORD;
      UBP.VPLLocationVerify(LocationCode,Rec);
      CurrPage.UPDATE(FALSE);
    END;

    BEGIN
    END.
  }
}

