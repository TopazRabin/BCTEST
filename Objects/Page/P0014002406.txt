OBJECT Page 14002406 E.D.I. Forecast
{
  OBJECT-PROPERTIES
  {
    Date=10/22/20;
    Time=[ 4:57:39 AM];
    Version List=SE0.61;
  }
  PROPERTIES
  {
    CaptionML=ENU=E.D.I. Forecast;
    InsertAllowed=No;
    DeleteAllowed=No;
    ModifyAllowed=No;
    SourceTable=Table37;
    DelayedInsert=No;
    SourceTableView=SORTING(Document Type,Type,No.,Variant Code,Drop Shipment,Location Code,Shipment Date)
                    ORDER(Ascending)
                    WHERE(Document Type=CONST(Blanket Order),
                          EDI Forecast Begin Date=FILTER(<>''));
    PageType=Worksheet;
    OnOpenPage=BEGIN
                 SellToCustomerFilter := GETFILTER("Sell-to Customer No.");
                 ;ESACC_EasySecurity(TRUE);
               END;

    OnAfterGetRecord=BEGIN
                       NetQuantity := 0;
                       OutstandingQty := 0;
                       CreditTotal := 0;
                       ReturnTotal := 0;
                       ShippedTotal := 0;
                       OrderQty := 0;

                       SalesLine.RESET;
                       SalesLine.SETCURRENTKEY(
                         "Document Type","Blanket Order No.","Blanket Order Line No.");
                       SalesLine.SETRANGE("Document Type","Document Type"::Order);
                       SalesLine.SETRANGE("Blanket Order No.","Document No.");
                       SalesLine.SETRANGE("Blanket Order Line No.","Line No.");
                       IF SalesLine.FIND('-') THEN
                         REPEAT
                           OrderQty := OrderQty + SalesLine.Quantity;
                         UNTIL SalesLine.NEXT = 0;

                       SalesLine.RESET;
                       SalesLine.SETCURRENTKEY(
                         "Document Type","Blanket Order No.","Blanket Order Line No.");
                       SalesLine.SETRANGE("Document Type","Document Type"::Order);
                       SalesLine.SETRANGE("Blanket Order No.","Document No.");
                       SalesLine.SETRANGE("Blanket Order Line No.","Line No.");
                       SalesLine.SETFILTER("Outstanding Quantity",'<>0');
                       IF SalesLine.FIND('-') THEN
                         REPEAT
                           OutstandingQty := OutstandingQty + SalesLine."Outstanding Quantity";
                         UNTIL SalesLine.NEXT = 0;

                       SalesShipmentLine.RESET;
                       SalesShipmentLine.SETCURRENTKEY("Blanket Order No.","Blanket Order Line No.");
                       SalesShipmentLine.SETRANGE("Blanket Order No.","Document No.");
                       SalesShipmentLine.SETRANGE("Blanket Order Line No.","Line No.");
                       IF SalesShipmentLine.FIND('-') THEN
                         REPEAT
                           ShippedTotal := ShippedTotal + SalesShipmentLine.Quantity;
                         UNTIL SalesShipmentLine.NEXT = 0;
                       NetQuantity := Quantity - (OutstandingQty + ShippedTotal);

                       IF BlanketHeader.GET("Document Type","Document No.") THEN BEGIN
                         BegCumulativeTotal.RESET;
                         BegCumulativeTotal.SETRANGE("Trade Partner Code",BlanketHeader."EDI Trade Partner");
                         BegCumulativeTotal.SETRANGE("Blanket Order No.","Document No.");
                         BegCumulativeTotal.SETRANGE("Item No.","No.");
                         BegCumulativeTotal.SETRANGE(Variant,"Variant Code");
                         IF NOT BegCumulativeTotal.FIND('-') THEN
                           BegCumulativeTotal.INIT;

                         CumulativeTotal := BegCumulativeTotal.Quantity;
                         SalesShipmentLine2.RESET;
                         SalesShipmentLine2.SETCURRENTKEY("Blanket Order No.","Blanket Order Line No.");
                         SalesShipmentLine2.SETRANGE("Blanket Order No.","Document No.");
                         SalesShipmentLine2.SETRANGE("No.","No.");
                         SalesShipmentLine2.SETRANGE("Variant Code","Variant Code");
                         IF SalesShipmentLine2.FIND('-') THEN
                           REPEAT
                             CumulativeTotal := CumulativeTotal + SalesShipmentLine2.Quantity;
                           UNTIL SalesShipmentLine2.NEXT = 0;

                         SalesCrMemoLine.RESET;
                         SalesCrMemoLine.SETCURRENTKEY("Blanket Order No.","Blanket Order Line No.");
                         SalesCrMemoLine.SETRANGE("Blanket Order No.","Document No.");
                         SalesCrMemoLine.SETRANGE("No.","No.");
                         SalesCrMemoLine.SETRANGE("Variant Code","Variant Code");
                         IF SalesCrMemoLine.FIND('-') THEN
                           REPEAT
                             CumulativeTotal := CumulativeTotal - SalesCrMemoLine.Quantity;
                           UNTIL SalesCrMemoLine.NEXT = 0;

                         SalesCrMemoLine.RESET;
                         SalesCrMemoLine.SETCURRENTKEY("Blanket Order No.","Blanket Order Line No.");
                         SalesCrMemoLine.SETRANGE("Blanket Order No.","Document No.");
                         SalesCrMemoLine.SETRANGE("Blanket Order Line No.","Line No.");
                         SalesCrMemoLine.SETRANGE("No.","No.");
                         SalesCrMemoLine.SETRANGE("Variant Code","Variant Code");
                         IF SalesCrMemoLine.FIND('-') THEN
                           REPEAT
                             CreditTotal := CreditTotal + SalesCrMemoLine.Quantity;
                           UNTIL SalesCrMemoLine.NEXT = 0;

                         ReturnRcptLine.RESET;
                         ReturnRcptLine.SETCURRENTKEY("Blanket Order No.","Blanket Order Line No.");
                         ReturnRcptLine.SETRANGE("Blanket Order No.","Document No.");
                         ReturnRcptLine.SETRANGE("No.",SalesShipmentLine."No.");
                         IF ReturnRcptLine.FIND('-') THEN
                           REPEAT
                             CumulativeTotal := CumulativeTotal - ReturnRcptLine.Quantity;
                           UNTIL ReturnRcptLine.NEXT = 0;

                         ReturnRcptLine.RESET;
                         ReturnRcptLine.SETCURRENTKEY("Blanket Order No.","Blanket Order Line No.");
                         ReturnRcptLine.SETRANGE("Blanket Order No.","Document No.");
                         ReturnRcptLine.SETRANGE("Blanket Order Line No.","Line No.");
                         ReturnRcptLine.SETRANGE("No.",SalesShipmentLine."No.");
                         IF ReturnRcptLine.FIND('-') THEN
                           REPEAT
                             ReturnTotal := ReturnTotal + ReturnRcptLine.Quantity;
                           UNTIL ReturnRcptLine.NEXT = 0;

                       END;
                       OnAfterGetCurrRecord;
                     END;

    OnNewRecord=BEGIN
                  OnAfterGetCurrRecord;
                END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 1240030027;1 ;ActionGroup;
                      CaptionML=ENU=Fo&recast }
      { 1240030036;2 ;Action    ;
                      ShortCutKey=Shift+F7;
                      CaptionML=ENU=&Card;
                      RunObject=Page 507;
                      RunPageLink=Document Type=CONST(Blanket Order),
                                  No.=FIELD(Document No.);
                      Visible=ESACC_C1240030036_Visible;
                      Enabled=ESACC_C1240030036_Enabled;
                      Image=EditLines }
      { 1240030028;2 ;Action    ;
                      CaptionML=ENU=&Orders;
                      RunObject=Page 516;
                      RunPageView=SORTING(Document Type,Blanket Order No.,Blanket Order Line No.)
                                  ORDER(Ascending);
                      RunPageLink=Document Type=CONST(Order),
                                  Blanket Order No.=FIELD(Document No.),
                                  Blanket Order Line No.=FIELD(Line No.);
                      Promoted=Yes;
                      Visible=ESACC_C1240030028_Visible;
                      Enabled=ESACC_C1240030028_Enabled;
                      PromotedIsBig=Yes;
                      Image=Document;
                      PromotedCategory=Process }
      { 1240030035;2 ;Action    ;
                      CaptionML=ENU=&Shipments;
                      Promoted=Yes;
                      Visible=ESACC_C1240030035_Visible;
                      Enabled=ESACC_C1240030035_Enabled;
                      PromotedIsBig=Yes;
                      Image=View;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 SaleShptLine@1240020000 : Record 111;
                               BEGIN
                                 SaleShptLine.RESET;
                                 SaleShptLine.SETCURRENTKEY("Blanket Order No.","Blanket Order Line No.");
                                 SaleShptLine.SETRANGE("Blanket Order No.","Document No.");
                                 SaleShptLine.SETRANGE("Blanket Order Line No.","Line No.");
                                 PAGE.RUNMODAL(PAGE::"Posted Sales Shipment Lines",SaleShptLine);
                               END;
                                }
      { 1240020011;2 ;Action    ;
                      CaptionML=ENU=Posted Credit Memos;
                      Visible=ESACC_C1240020011_Visible;
                      Enabled=ESACC_C1240020011_Enabled;
                      OnAction=VAR
                                 SalesCrMemoLine@1240020000 : Record 115;
                               BEGIN
                                 SalesCrMemoLine.RESET;
                                 SalesCrMemoLine.SETCURRENTKEY("Blanket Order No.","Blanket Order Line No.");
                                 SalesCrMemoLine.SETRANGE("Blanket Order No.","Document No.");
                                 SalesCrMemoLine.SETRANGE("Blanket Order Line No.","Line No.");
                                 PAGE.RUNMODAL(PAGE::"Posted Sales Credit Memo Lines",SalesCrMemoLine);
                               END;
                                }
      { 1240020010;2 ;Action    ;
                      CaptionML=ENU=Return Receipts;
                      Visible=ESACC_C1240020010_Visible;
                      Enabled=ESACC_C1240020010_Enabled;
                      OnAction=VAR
                                 ReturnRcptLine@1240020000 : Record 6661;
                               BEGIN
                                 ReturnRcptLine.RESET;
                                 ReturnRcptLine.SETCURRENTKEY("Blanket Order No.","Blanket Order Line No.");
                                 ReturnRcptLine.SETRANGE("Blanket Order No.","Document No.");
                                 ReturnRcptLine.SETRANGE("Blanket Order Line No.","Line No.");
                                 PAGE.RUNMODAL(PAGE::"Posted Return Receipt Lines",ReturnRcptLine);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1240030022;1;Field  ;
                Lookup=Yes;
                CaptionML=ENU=Sell-To Customer;
                SourceExpr=SellToCustomerFilter;
                OnValidate=BEGIN
                             SellToCustomerFilterOnAfterVal;
                           END;

                OnLookup=BEGIN
                           Customer.RESET;
                           IF PAGE.RUNMODAL(PAGE::"Customer List",Customer) = ACTION::LookupOK THEN BEGIN
                             SellToCustomerFilter := Customer."No.";
                             SETRANGE("Sell-to Customer No.",SellToCustomerFilter);
                             CurrPage.UPDATE(FALSE);
                           END;
                         END;
                          }

    { 1240030000;1;Group  ;
                GroupType=Repeater }

    { 1240030001;2;Field  ;
                SourceExpr="Document No.";
                Visible=ESACC_F3_Visible;
                Editable=FALSE;
                HideValue=ESACC_F3_HideValue }

    { 1240030003;2;Field  ;
                SourceExpr=Type;
                Visible=FALSE;
                Editable=FALSE;
                HideValue=ESACC_F5_HideValue }

    { 1240030005;2;Field  ;
                SourceExpr="No.";
                Visible=ESACC_F6_Visible;
                Enabled=ESACC_F6_Editable;
                Editable=FALSE;
                HideValue=ESACC_F6_HideValue }

    { 1240030007;2;Field  ;
                SourceExpr="Location Code";
                Visible=FALSE;
                Editable=FALSE;
                HideValue=ESACC_F7_HideValue }

    { 1240030009;2;Field  ;
                SourceExpr=Description;
                Visible=FALSE;
                Editable=FALSE;
                HideValue=ESACC_F11_HideValue }

    { 1240030011;2;Field  ;
                CaptionML=ENU=Forecast;
                SourceExpr=Quantity;
                Visible=ESACC_F15_Visible;
                Editable=FALSE;
                HideValue=ESACC_F15_HideValue }

    { 1240030029;2;Field  ;
                CaptionML=ENU=Orders;
                DecimalPlaces=0:5;
                SourceExpr=OutstandingQty;
                Editable=FALSE }

    { 1240030031;2;Field  ;
                CaptionML=ENU=Shipments;
                DecimalPlaces=0:5;
                SourceExpr=ShippedTotal;
                Editable=FALSE }

    { 1240020002;2;Field  ;
                CaptionML=ENU="Return Orders ";
                DecimalPlaces=0:5;
                SourceExpr=ReturnTotal;
                Editable=FALSE }

    { 1240020004;2;Field  ;
                CaptionML=ENU=Credit Memos;
                DecimalPlaces=0:5;
                SourceExpr=CreditTotal;
                Editable=FALSE }

    { 1240030033;2;Field  ;
                CaptionML=ENU=Net Quantity;
                DecimalPlaces=0:5;
                SourceExpr=NetQuantity;
                Editable=FALSE }

    { 1240020000;2;Field  ;
                CaptionML=ENU=Cumulative Total;
                DecimalPlaces=0:0;
                SourceExpr=CumulativeTotal }

    { 1240030013;2;Field  ;
                ToolTipML=ENU=Specifies the mapped beginning forecast date sent in the Automtive EDI forecast or release document.;
                SourceExpr="EDI Forecast Begin Date";
                Visible=ESACC_F14000364_Visible;
                Editable=FALSE;
                HideValue=ESACC_F14000364_HideValue }

    { 1240030015;2;Field  ;
                ToolTipML=ENU=Specifies the forecast end date for Automtive EDI forecast or release document. The date is calculated based on the Forecast Period specified on the EDI Document page or by the Date Formula assigned in the EDI map for the field.;
                SourceExpr="EDI Forecast End Date";
                Visible=ESACC_F14000365_Visible;
                Editable=FALSE;
                HideValue=ESACC_F14000365_HideValue }

    { 1240030017;2;Field  ;
                ToolTipML=ENU=Specifies the mapped purchase order number sent in the Automtive EDI forecast or release document.;
                SourceExpr="EDI Code";
                Visible=ESACC_F14000366_Visible;
                Editable=FALSE;
                HideValue=ESACC_F14000366_HideValue }

    { 1240030024;1;Group   }

    { 1240030025;2;Field  ;
                Name=<Description2>;
                SourceExpr=Description;
                Visible=ESACC_F11_Visible;
                Editable=FALSE;
                HideValue=ESACC_F11_HideValue }

  }
  CODE
  {
    VAR
      ESACC_ESFLADSMgt@14123801 : Codeunit 14123801;
      ESACC_C1240020010_Visible@975200100 : Boolean INDATASET;
      ESACC_C1240020010_Enabled@975200103 : Boolean INDATASET;
      ESACC_C1240020011_Visible@975200110 : Boolean INDATASET;
      ESACC_C1240020011_Enabled@975200113 : Boolean INDATASET;
      ESACC_C1240030028_Visible@975300280 : Boolean INDATASET;
      ESACC_C1240030028_Enabled@975300283 : Boolean INDATASET;
      ESACC_C1240030035_Visible@975300350 : Boolean INDATASET;
      ESACC_C1240030035_Enabled@975300353 : Boolean INDATASET;
      ESACC_C1240030036_Visible@975300360 : Boolean INDATASET;
      ESACC_C1240030036_Enabled@975300363 : Boolean INDATASET;
      ESACC_F3_Visible@900000030 : Boolean INDATASET;
      ESACC_F3_Editable@900000031 : Boolean INDATASET;
      ESACC_F3_HideValue@900000032 : Boolean INDATASET;
      ESACC_F5_Visible@900000050 : Boolean INDATASET;
      ESACC_F5_Editable@900000051 : Boolean INDATASET;
      ESACC_F5_HideValue@900000052 : Boolean INDATASET;
      ESACC_F6_Visible@900000060 : Boolean INDATASET;
      ESACC_F6_Editable@900000061 : Boolean INDATASET;
      ESACC_F6_HideValue@900000062 : Boolean INDATASET;
      ESACC_F7_Visible@900000070 : Boolean INDATASET;
      ESACC_F7_Editable@900000071 : Boolean INDATASET;
      ESACC_F7_HideValue@900000072 : Boolean INDATASET;
      ESACC_F11_Visible@900000110 : Boolean INDATASET;
      ESACC_F11_Editable@900000111 : Boolean INDATASET;
      ESACC_F11_HideValue@900000112 : Boolean INDATASET;
      ESACC_F15_Visible@900000150 : Boolean INDATASET;
      ESACC_F15_Editable@900000151 : Boolean INDATASET;
      ESACC_F15_HideValue@900000152 : Boolean INDATASET;
      ESACC_F14000364_Visible@950003640 : Boolean INDATASET;
      ESACC_F14000364_Editable@950003641 : Boolean INDATASET;
      ESACC_F14000364_HideValue@950003642 : Boolean INDATASET;
      ESACC_F14000365_Visible@950003650 : Boolean INDATASET;
      ESACC_F14000365_Editable@950003651 : Boolean INDATASET;
      ESACC_F14000365_HideValue@950003652 : Boolean INDATASET;
      ESACC_F14000366_Visible@950003660 : Boolean INDATASET;
      ESACC_F14000366_Editable@950003661 : Boolean INDATASET;
      ESACC_F14000366_HideValue@950003662 : Boolean INDATASET;
      Customer@1240030004 : Record 18;
      SalesLine@1240030000 : Record 37;
      SalesShipmentLine@1240030001 : Record 111;
      SalesShipmentLine2@1240020004 : Record 111;
      BlanketHeader@1240020003 : Record 36;
      BegCumulativeTotal@1240020001 : Record 14002405;
      SalesCrMemoLine@1240020005 : Record 115;
      ReturnRcptLine@1240020006 : Record 6661;
      NetQuantity@1240030002 : Decimal;
      OutstandingQty@1240020000 : Decimal;
      CumulativeTotal@1240020002 : Decimal;
      SellToCustomerFilter@1240030003 : Code[29];
      ReturnTotal@1240020007 : Decimal;
      CreditTotal@1240020008 : Decimal;
      ShippedTotal@1240020009 : Decimal;
      OrderQty@1240020010 : Decimal;

    LOCAL PROCEDURE ESACC_EasySecurity@14123801(OpenObject@14123801 : Boolean);
    VAR
      SetFilters@14123802 : Codeunit 14123812;
      TempBoolean@14123803 : Boolean;
    BEGIN
      IF OpenObject THEN BEGIN
        SetFilters.Filter37(Rec,8,14002406);

        TempBoolean := CurrPage.EDITABLE;
        IF ESACC_ESFLADSMgt.PageGeneral(37,14002406,TempBoolean) THEN
          CurrPage.EDITABLE := TempBoolean;
      END;

      ESACC_ESFLADSMgt.PageControl(
        37,14002406,1,1240020010,
        ESACC_C1240020010_Visible,ESACC_C1240020010_Enabled,TempBoolean);

      ESACC_ESFLADSMgt.PageControl(
        37,14002406,1,1240020011,
        ESACC_C1240020011_Visible,ESACC_C1240020011_Enabled,TempBoolean);

      ESACC_ESFLADSMgt.PageControl(
        37,14002406,1,1240030028,
        ESACC_C1240030028_Visible,ESACC_C1240030028_Enabled,TempBoolean);

      ESACC_ESFLADSMgt.PageControl(
        37,14002406,1,1240030035,
        ESACC_C1240030035_Visible,ESACC_C1240030035_Enabled,TempBoolean);

      ESACC_ESFLADSMgt.PageControl(
        37,14002406,1,1240030036,
        ESACC_C1240030036_Visible,ESACC_C1240030036_Enabled,TempBoolean);

      ESACC_ESFLADSMgt.PageControl(
        37,14002406,0,3,
        ESACC_F3_Visible,ESACC_F3_Editable,ESACC_F3_HideValue);

      ESACC_ESFLADSMgt.PageControl(
        37,14002406,0,5,
        ESACC_F5_Visible,ESACC_F5_Editable,ESACC_F5_HideValue);

      ESACC_ESFLADSMgt.PageControl(
        37,14002406,0,6,
        ESACC_F6_Visible,ESACC_F6_Editable,ESACC_F6_HideValue);

      ESACC_ESFLADSMgt.PageControl(
        37,14002406,0,7,
        ESACC_F7_Visible,ESACC_F7_Editable,ESACC_F7_HideValue);

      ESACC_ESFLADSMgt.PageControl(
        37,14002406,0,11,
        ESACC_F11_Visible,ESACC_F11_Editable,ESACC_F11_HideValue);

      ESACC_ESFLADSMgt.PageControl(
        37,14002406,0,11,
        ESACC_F11_Visible,ESACC_F11_Editable,ESACC_F11_HideValue);

      ESACC_ESFLADSMgt.PageControl(
        37,14002406,0,15,
        ESACC_F15_Visible,ESACC_F15_Editable,ESACC_F15_HideValue);

      ESACC_ESFLADSMgt.PageControl(
        37,14002406,0,14000364,
        ESACC_F14000364_Visible,ESACC_F14000364_Editable,ESACC_F14000364_HideValue);

      ESACC_ESFLADSMgt.PageControl(
        37,14002406,0,14000365,
        ESACC_F14000365_Visible,ESACC_F14000365_Editable,ESACC_F14000365_HideValue);

      ESACC_ESFLADSMgt.PageControl(
        37,14002406,0,14000366,
        ESACC_F14000366_Visible,ESACC_F14000366_Editable,ESACC_F14000366_HideValue);

      ESACC_EasySecurityManual(OpenObject);
    END;

    LOCAL PROCEDURE ESACC_EasySecurityManual@14123811(OpenObject@14123811 : Boolean);
    BEGIN
    END;

    LOCAL PROCEDURE SellToCustomerFilterOnAfterVal@19015810();
    BEGIN
      IF SellToCustomerFilter = '' THEN
        SETRANGE("Sell-to Customer No.")
      ELSE
        SETRANGE("Sell-to Customer No.",SellToCustomerFilter);
      CurrPage.UPDATE(FALSE);
    END;

    LOCAL PROCEDURE OnAfterGetCurrRecord@19077479();
    BEGIN
      xRec := Rec;
      SellToCustomerFilter := GETFILTER("Sell-to Customer No.");
    END;

    BEGIN
    END.
  }
}

