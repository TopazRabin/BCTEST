OBJECT Page 14097511 Replenishment Path Alerts
{
  OBJECT-PROPERTIES
  {
    Date=09/24/20;
    Time=[ 9:15:36 AM];
    Modified=Yes;
    Version List=UBP3.00;
  }
  PROPERTIES
  {
    CaptionML=ENU=Replenishment Configuration Alerts;
    InsertAllowed=No;
    ModifyAllowed=No;
    SourceTable=Table14097464;
    PageType=List;
    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 1240020017;1 ;ActionGroup;
                      CaptionML=ENU=&Alert }
      { 1240020018;2 ;Action    ;
                      CaptionML=ENU=&Item;
                      RunObject=Page 31;
                      RunPageLink=No.=FIELD(Item No.);
                      Promoted=Yes;
                      Image=NewItem;
                      PromotedCategory=Process }
      { 1240020004;2 ;Action    ;
                      ShortCutKey=Shift+F7;
                      CaptionML=ENU=&Procurement Unit;
                      RunObject=Page 14000558;
                      RunPageView=SORTING(Location Code,Item No.,Variant Code)
                                  ORDER(Ascending);
                      RunPageLink=Location Code=FIELD(Location Code),
                                  Item No.=FIELD(Item No.),
                                  Variant Code=FIELD(Variant Code);
                      Promoted=Yes;
                      Image=BankAccountRec;
                      PromotedCategory=Process }
      { 1240020019;2 ;Action    ;
                      CaptionML=ENU=&Proc. Units for This Item;
                      RunObject=Page 14000545;
                      RunPageView=SORTING(Item No.,Variant Code,Location Code)
                                  ORDER(Ascending);
                      RunPageLink=Item No.=FIELD(Item No.);
                      Image=BankAccountRec }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1240020016;1 ;ActionGroup;
                      CaptionML=ENU=F&unctions }
      { 1240020006;2 ;Action    ;
                      CaptionML=ENU=Check Repl. Paths (Select Units);
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=DocumentsMaturity;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 LocProcUnit@1240020000 : Record 14000555;
                                 ReplPathAlert@1240020001 : Record 14097464;
                               BEGIN
                                 GetProcurementUnitFilters(LocProcUnit);
                                 IF (LocProcUnit.GETFILTERS <> '') THEN BEGIN
                                   IF NOT ReplPathAlert.ISEMPTY THEN BEGIN
                                     IF CONFIRM(Text004) THEN BEGIN
                                       ReplPathAlert.DELETEALL(TRUE);
                                       COMMIT;
                                     END;
                                   END;
                                   CLEAR(CheckReplPath);
                                   CheckReplPath.ByFilter(LocProcUnit);
                                   CurrPage.UPDATE(FALSE);
                                 END ELSE BEGIN
                                 END;
                               END;
                                }
      { 1240020025;2 ;Action    ;
                      CaptionML=ENU=Check all Repl. Paths;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=ExchProdBOMItem;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 IF CONFIRM(Text001) THEN BEGIN
                                   CLEAR(CheckReplPath);
                                   CheckReplPath.AllProcUnits(FALSE);
                                   CurrPage.UPDATE(FALSE);
                                 END;
                               END;
                                }
      { 1240020024;2 ;Action    ;
                      CaptionML=ENU=Re-Check This Path;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=ExplodeBOM;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CheckThisPath;
                                 CurrPage.UPDATE(FALSE);
                               END;
                                }
      { 1240020026;2 ;Separator  }
      { 1240020027;2 ;Action    ;
                      CaptionML=ENU=Repair all Repl. Paths;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=CreateInteraction;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 IF CONFIRM(Text002) THEN BEGIN
                                   CheckReplPath.AllProcUnits(TRUE);
                                   CurrPage.UPDATE(FALSE);
                                 END;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1240020000;1;Group  ;
                GroupType=Repeater }

    { 1240020001;2;Field  ;
                SourceExpr="Location Code" }

    { 1240020003;2;Field  ;
                SourceExpr="Item No." }

    { 1240020005;2;Field  ;
                SourceExpr="Variant Code";
                Visible=FALSE }

    { 1240020007;2;Field  ;
                SourceExpr="Item Description" }

    { 1240020002;2;Field  ;
                SourceExpr="Alert Type" }

    { 1240020009;2;Field  ;
                SourceExpr="Alert Description" }

    { 1240020011;2;Field  ;
                SourceExpr="Alert Date" }

    { 1240020020;2;Field  ;
                SourceExpr="Changed Date";
                Visible=FALSE }

    { 1240020022;2;Field  ;
                SourceExpr="Changed By";
                Visible=FALSE }

  }
  CODE
  {
    VAR
      ProcUnit@1240020002 : Record 14000555;
      ReplPathAlert@1240020001 : Record 14097464;
      CheckReplPath@1240020000 : Codeunit 14000597;
      AlertMessage@1240020003 : Text[150];
      Text001@1240020004 : TextConst 'ENU=Check all Replenishment Paths and create Alerts?';
      Text002@1240020005 : TextConst 'ENU="This process will set all Proc. Units with alerts to Repl. Path =VENDOR.  Continue?"';
      Text003@1240020006 : TextConst 'ENU=Path still has an error.';
      Text004@1240020007 : TextConst 'ENU=Alert lines already exist.  Would you like to remove all lines?';

    PROCEDURE CheckThisPath@1240020000();
    VAR
      ProcUnit@1240020003 : Record 14000555;
      AlertType@1240020002 : Code[20];
      AlertMessage@1240020001 : Text[150];
      CheckReplPath@1240020000 : Codeunit 14000597;
    BEGIN
      IF ("Location Code" = '') AND ("Item No." = '') THEN BEGIN
        FILTERGROUP(4);
        ProcUnit.GET(GETFILTER("Location Code"),GETFILTER("Item No."),GETFILTER("Variant Code"));
        FILTERGROUP(0);
      END ELSE
        ProcUnit.GET("Location Code","Item No.","Variant Code");
      CLEAR(CheckReplPath);
      DELETE;
      CheckReplPath.CheckSourceAlerts(ProcUnit);
    END;

    LOCAL PROCEDURE GetProcurementUnitFilters@1240020012(VAR ProcUnit@1240020002 : Record 14000555);
    VAR
      SelectProcUnitReport@1240020000 : Report 14000563;
      LocProcUnit@1240020001 : Record 14000555;
    BEGIN
      IF NOT GUIALLOWED THEN
        EXIT;

      CLEAR(SelectProcUnitReport);
      SelectProcUnitReport.USEREQUESTPAGE(TRUE);
      SelectProcUnitReport.RUNMODAL();
      SelectProcUnitReport.GetFilters(ProcUnit);
    END;

    BEGIN
    END.
  }
}

