OBJECT Page 1306 O365 Tour Complete
{
  OBJECT-PROPERTIES
  {
    Date=11/22/17;
    Time=12:00:00 PM;
    Version List=NAVW111.00;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Tour Complete;
               ESM=Paseo completado;
               FRC=Visite termin‚e;
               ENC=Tour Complete];
    SourceTable=Table1309;
    PageType=NavigatePage;
    OnInit=BEGIN
             SETRANGE("User ID",USERID);
           END;

    OnOpenPage=BEGIN
                 CurrentPage := 1;
                 IF UserTours.IsAvailable AND O365GettingStartedMgt.AreUserToursEnabled THEN BEGIN
                   UserTours := UserTours.Create;
                   UserTours.StopUserTour;
                 END;
               END;

    OnQueryClosePage=BEGIN
                       IF ShowToursWizard THEN
                         EXIT(TRUE);

                       IF "Tour Completed" THEN BEGIN
                         "Tour in Progress" := FALSE;
                         MODIFY;
                         EXIT(TRUE);
                       END;

                       EXIT(ConfirmClosingOfTheWizard);
                     END;

    OnAfterGetCurrRecord=BEGIN
                           UpdateImageAndBodyText;
                         END;

    ActionList=ACTIONS
    {
      { 19      ;    ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 14      ;1   ;Action    ;
                      Name=ReturnToGettingStarted;
                      CaptionML=[ENU=Return to Getting Started;
                                 ESM=Volver a la introducci¢n;
                                 FRC=Revenir … la mise en route;
                                 ENC=Return to Getting Started];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      InFooterBar=Yes;
                      Image=NextRecord;
                      OnAction=VAR
                                 DummyO365GettingStarted@1000 : Page 1309;
                               BEGIN
                                 ShowToursWizard := TRUE;
                                 CurrPage.CLOSE;
                                 "Current Page" := DummyO365GettingStarted.GetNextPageID(1,"Current Page");
                                 MODIFY;

                                 PAGE.RUN(PAGE::"O365 Getting Started");
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1   ;0   ;Container ;
                ContainerType=ContentArea }

    { 2   ;1   ;Group     ;
                Visible=CurrentPage = 1;
                Editable=FALSE;
                GroupType=Group }

    { 35  ;2   ;Field     ;
                Name=Image1;
                CaptionML=[ENU=Image1;
                           ESM=Imagen 1;
                           FRC=Image1;
                           ENC=Image1];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=ImagePageDataMediaResources."Media Reference";
                Editable=FALSE;
                ShowCaption=No }

    { 5   ;2   ;Group     ;
                Name=Page1Group;
                CaptionML=[ENU=That's it;
                           ESM=Eso es todo;
                           FRC=Voil…;
                           ENC=That's it];
                GroupType=Group }

    { 16  ;3   ;Field     ;
                Name=BodyText1;
                CaptionML=[ENU=BodyText1;
                           ESM=TextoCuerpo1;
                           FRC=CorpsTexte1;
                           ENC=BodyText1];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=BodyText;
                Editable=FALSE;
                MultiLine=Yes;
                ShowCaption=No }

  }
  CODE
  {
    VAR
      ImageO365GettingStartedPageData@1000 : Record 1308;
      ImagePageDataMediaResources@1006 : Record 2000000182;
      O365GettingStartedMgt@1004 : Codeunit 1309;
      UserTours@1019 : DotNet "'Microsoft.Dynamics.Nav.ClientExtensions, Version=11.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35'.Microsoft.Dynamics.Nav.Client.Capabilities.UserTours" WITHEVENTS RUNONCLIENT;
      BodyText@1005 : BigText;
      ExitWizardQst@1002 : TextConst 'ENU=Are you sure that you want to exit the Getting Started tour?;ESM=¨Est  seguro de que quiere salir del paseo de introducci¢n?;FRC=Òtes-vous s–r de vouloir quitter la visite de mise en routeÿ?;ENC=Are you sure that you want to exit the Getting Started tour?';
      ExitWizardInstructionTxt@1016 : TextConst 'ENU=\\You can always resume the Getting Started tour later from the Home page.;ESM=\\Siempre puede reanudar el paseo de introducci¢n m s tarde desde la p gina Inicio.;FRC=\\Vous pourrez reprendre la visite de mise en route ult‚rieurement … partir de la page d''accueil.;ENC=\\You can always resume the Getting Started tour later from the Home page.';
      ShowToursWizard@1001 : Boolean;
      CurrentPage@1003 : Integer;

    LOCAL PROCEDURE MarkWizardAsDone@7();
    BEGIN
      "Tour in Progress" := FALSE;
      "Tour Completed" := TRUE;
      MODIFY;

      IF UserTours.IsAvailable AND O365GettingStartedMgt.AreUserToursEnabled THEN BEGIN
        UserTours := UserTours.Create;
        UserTours.StopNotifyShowTourWizard;
      END;
    END;

    LOCAL PROCEDURE ConfirmClosingOfTheWizard@38() : Boolean;
    VAR
      ConfirmQst@1000 : Text;
    BEGIN
      ConfirmQst := ExitWizardQst + ExitWizardInstructionTxt;
      IF NOT CONFIRM(ConfirmQst) THEN
        EXIT(FALSE);

      MarkWizardAsDone;
      EXIT(TRUE);
    END;

    LOCAL PROCEDURE UpdateImageAndBodyText@25();
    VAR
      BodyTextO365GettingStartedPageData@1000 : Record 1308;
      MediaResourcesMgt@1001 : Codeunit 9755;
      TempBodyText@1002 : Text;
    BEGIN
      ImageO365GettingStartedPageData.GetPageImage(
        ImageO365GettingStartedPageData,CurrentPage,PAGE::"O365 Tour Complete");
      IF ImagePageDataMediaResources.GET(ImageO365GettingStartedPageData."Media Resources Ref") THEN;

      IF BodyTextO365GettingStartedPageData.GetPageBodyText(BodyTextO365GettingStartedPageData,CurrentPage,PAGE::"O365 Tour Complete") THEN BEGIN
        TempBodyText := MediaResourcesMgt.ReadTextFromMediaResource(BodyTextO365GettingStartedPageData."Media Resources Ref");
        IF TempBodyText = '' THEN
          EXIT;
        CLEAR(BodyText);
        BodyText.ADDTEXT(STRSUBSTNO(TempBodyText,PRODUCTNAME.MARKETING));
      END;
    END;

    BEGIN
    END.
  }
}

