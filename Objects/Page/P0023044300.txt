OBJECT Page 23044300 IWX Count Sheet Configuration
{
  OBJECT-PROPERTIES
  {
    Date=04/26/19;
    Time=[ 9:19:21 AM];
    Version List=IWX2.4.7684.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Count Sheet Configuration;
               ESM=Configuraci¢n de la hoja de conteo;
               FRC=Configuration de la feuille de d‚compte;
               ENC=Count Sheet Configuration];
    SourceTable=Table23044300;
    PageType=List;
    OnInit=BEGIN
             btnFuncsEnable := TRUE;
           END;

    OnOpenPage=BEGIN
                 IF CurrPage.LOOKUPMODE THEN BEGIN
                   CurrPage.EDITABLE := FALSE;
                   btnFuncsEnable := FALSE;
                 END;
               END;

    ActionList=ACTIONS
    {
      { 1900000003;  ;ActionContainer;
                      Name=<Action1900000003>;
                      ActionContainerType=ActionItems }
      { 1000000011;1 ;ActionGroup;
                      Name=Functions;
                      CaptionML=[ENU=F&unctions;
                                 ESM=F&unciones;
                                 FRC=F&onctions;
                                 ENC=F&unctions] }
      { 1000000012;2 ;Action    ;
                      CaptionML=[ENU=&Generate Count Sheets;
                                 ESM=&Generar hojas de recuento;
                                 FRC=&Generer les feuilles de d‚compte;
                                 ENC=&Generate Count Sheets];
                      RunPageOnRec=Yes;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=CreateInventoryPickup;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 lrptCreateSheets@1000000001 : Report 23044300;
                               BEGIN
                                 lrptCreateSheets.SETTABLEVIEW(Rec);
                                 lrptCreateSheets.RUNMODAL;
                               END;
                                }
      { 1000000020;2 ;Action    ;
                      CaptionML=[ENU=&View All Count Sheets;
                                 ESM=&Ver Todas hojas de recuento;
                                 FRC=&Voir toutes les feuilles de d‚compte;
                                 ENC=&View All Count Sheets];
                      Promoted=Yes;
                      Image=View;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 showCountSheet("Count No.",' +++ ');
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1000000000;1;Group  ;
                GroupType=Repeater }

    { 1000000001;2;Field  ;
                ToolTipML=ENU=Specifies the Count No. for the current Count Sheet Configuration;
                SourceExpr="Count No." }

    { 1000000014;2;Field  ;
                ToolTipML=ENU=Name of the count sheet.  This is used to organize items into groups and appears on the printed reports.;
                SourceExpr="Sheet Name" }

    { 1000000033;2;Field  ;
                DrillDown=Yes;
                ToolTipML=ENU=Displays the number of lines that were generated for each count sheet.;
                SourceExpr="Count Sheet Lines";
                OnDrillDown=BEGIN
                              showCountSheet("Count No.","Sheet Name");
                            END;
                             }

    { 1000000002;2;Field  ;
                ToolTipML=ENU=Lookup field to the Active flag on the Inventory Count Header;
                SourceExpr=Active;
                Visible=FALSE }

    { 1000000031;2;Field  ;
                ToolTipML=ENU=Use this field to enter a brief description of the count sheet.;
                SourceExpr=Description }

    { 1000000021;2;Field  ;
                ToolTipML=ENU=This field controls how many blank sheets are printed.  Blank sheets are used for write-in item numbers and are printed after each count sheet.;
                SourceExpr="Blank Sheet Qty." }

    { 1000000018;2;Field  ;
                ToolTipML=ENU=Identifies whether this Count Sheet Configuration is WIP Only.;
                SourceExpr="WIP Only" }

    { 1000000025;2;Field  ;
                ToolTipML=ENU=Allows the count sheet to be restricted to items found in the specified locations.  If a single location code is entered here, it becomes the default location used when manually adding items to the sheet.;
                SourceExpr="Location Code" }

    { 1000000027;2;Field  ;
                ToolTipML=ENU=Allows the count sheet to be restricted to items found in specific bins.  This filter works for both mandatory and non-mandatory bin locations.;
                SourceExpr="Bin Code" }

    { 1000000005;2;Field  ;
                ToolTipML=ENU=Filters can be specified for the Item No field on an item.  All items with an Item No matching this filter are included on the sheet.;
                SourceExpr="No." }

    { 1000000003;2;Field  ;
                ToolTipML=ENU=Filters can be specified for the Shelf No field in the item table.  All items matching this filter are included on the sheet.  This is a good way to group items that reside in neighbouring physical locations, if bins are not being used.;
                SourceExpr="Shelf No." }

    { 1000000029;2;Field  ;
                ToolTipML=ENU=Filters can be specified for the Gen Prod Posting Group field of your items.  All items matching this filter are included on the sheet.;
                SourceExpr="Gen. Prod. Posting Group" }

    { 1000000007;2;Field  ;
                ToolTipML=ENU=Filters can be specified for the Inventory Posting Group field of your items.  All items matching this filter are included on the sheet.;
                SourceExpr="Inventory Posting Group" }

    { 1000000009;2;Field  ;
                ToolTipML=ENU=Filters can be specified for the Item Tracking Code field of your items.  This allows you to filter on serialized versus non-serialized items.;
                SourceExpr="Item Tracking Code" }

    { 1000000023;2;Field  ;
                ToolTipML=ENU=Filters can be specified for the Physical Invt Counting Period Code field of your items.  This is useful when doing cycle counting or partial counts.;
                SourceExpr="Phys Invt Counting Period Code" }

    { 1000000016;2;Field  ;
                ToolTipML=ENU=Filters can be specified for any field in the item table not included in the standard filters in the count configuration table.;
                SourceExpr="Custom Filter" }

  }
  CODE
  {
    VAR
      btnFuncsEnable@19077634 : Boolean INDATASET;

    PROCEDURE getSheet@1000000000() : Code[20];
    BEGIN
      // returns sheet name to caller for lookups
      EXIT("Sheet Name");
    END;

    LOCAL PROCEDURE showCountSheet@1000000001(pcodCountNo@1000000002 : Code[20];pcodSheetName@1000000001 : Code[20]);
    VAR
      lrecCountSheetLine@1000000000 : Record 23044301;
    BEGIN
      // Displays count sheet based on selected sheet name

      lrecCountSheetLine.SETRANGE("Count No.",pcodCountNo);
      lrecCountSheetLine.SETRANGE("Sheet Name", pcodSheetName);
      PAGE.RUN(PAGE::"IWX Count Sheet Lines", lrecCountSheetLine);
    END;

    BEGIN
    {
      ************************
      Copyright Notice
      This objects content is copyright of Insight Works 2011.  All rights reserved.
      Any redistribution or reproduction of part or all of the contents in any form is prohibited.
      ************************
    }
    END.
  }
}

