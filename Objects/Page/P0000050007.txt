OBJECT Page 50007 Customer Divisions
{
  OBJECT-PROPERTIES
  {
    Date=10/22/20;
    Time=[ 4:57:39 AM];
    Modified=Yes;
    Version List=TOP140,100B,110,150,TOPFIX;
  }
  PROPERTIES
  {
    SourceTable=Table50007;
    DataCaptionExpr=SetDataCaptionExpr;
    DelayedInsert=Yes;
    PageType=List;
    OnOpenPage=BEGIN
                 ;ESACC_EasySecurity(TRUE);
               END;

    ActionList=ACTIONS
    {
      { 1000000018;  ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 1000000019;1 ;ActionGroup;
                      CaptionML=ENU=F&unctions }
      { 1000000020;2 ;Action    ;
                      CaptionML=ENU=Send Customer Statement E-Mail;
                      Visible=ESACC_C1000000020_Visible;
                      Enabled=ESACC_C1000000020_Enabled;
                      Image=MailAttachment;
                      OnAction=VAR
                                 Customer@1000000002 : Record 18;
                                 EmailHdlg@1000000001 : Codeunit 50011;
                                 EmailMgt@1000000000 : Codeunit 14000903;
                               BEGIN
                                 // <TPZ61>
                                 EmailHdlg.SetBatch(TRUE);
                                 EmailHdlg.SetDivisionCode("Shortcut Dimension 5 Code");
                                 Customer.RESET;
                                 Customer.SETRANGE("No.","Customer No.");
                                 Customer.FINDFIRST;
                                 EmailMgt.SendCustomerStatement(Customer,TRUE,FALSE);
                                 // </TPZ61>
                               END;
                                }
      { 1000000017;1 ;ActionGroup;
                      CaptionML=ENU=History }
      { 1000000016;2 ;Action    ;
                      CaptionML=ENU=Change Log Entries;
                      Visible=ESACC_C1000000016_Visible;
                      Enabled=ESACC_C1000000016_Enabled;
                      Image=History;
                      OnAction=VAR
                                 ChangeLogEntry@1000000000 : Record 405;
                                 ChangeLogMgt@1000000001 : Codeunit 423;
                                 CUSubscriber@1000000002 : Codeunit 51876;
                               BEGIN
                                 //<TPZ1728>
                                 CUSubscriber.CU423_OpenSSRSReport(DATABASE::"Customer Division", "Customer No.","Shortcut Dimension 5 Code",'');//<TPZ2829> Event Conversion
                                 EXIT;
                                 //</TPZ1728>


                                 // <TPZ129>
                                 ChangeLogEntry.RESET;
                                 ChangeLogEntry.SETRANGE("Table No.",DATABASE::"Customer Division");
                                 ChangeLogEntry.SETRANGE("Primary Key Field 1 Value","Customer No.");
                                 ChangeLogEntry.SETRANGE("Primary Key Field 2 Value","Shortcut Dimension 5 Code");
                                 PAGE.RUNMODAL(PAGE::"Change Log Entries",ChangeLogEntry);
                                 // </TPZ129>
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1000000000;0;Container;
                ContainerType=ContentArea }

    { 1000000001;1;Group  ;
                Name=Group;
                GroupType=Repeater }

    { 1000000003;2;Field  ;
                SourceExpr="Customer No.";
                Visible=FALSE;
                Editable=ESACC_F1_Editable;
                HideValue=ESACC_F1_HideValue }

    { 1000000002;2;Field  ;
                SourceExpr="Shortcut Dimension 5 Code";
                Visible=ESACC_F2_Visible;
                Enabled=ESACC_F2_Editable;
                Editable=ESACC_F2_Editable;
                HideValue=ESACC_F2_HideValue }

    { 1000000004;2;Field  ;
                SourceExpr="Payment Terms Code";
                Visible=ESACC_F3_Visible;
                Editable=ESACC_F3_Editable;
                HideValue=ESACC_F3_HideValue }

    { 1000000005;2;Field  ;
                SourceExpr=Multiplier;
                Visible=ESACC_F4_Visible;
                Editable=ESACC_F4_Editable;
                HideValue=ESACC_F4_HideValue }

    { 1000000009;2;Field  ;
                SourceExpr="Margin Approval %";
                Visible=ESACC_F10_Visible;
                Editable=ESACC_F10_Editable;
                HideValue=ESACC_F10_HideValue }

    { 1000000021;2;Field  ;
                DrillDown=No;
                SourceExpr="RSM Code";
                Visible=FALSE;
                HideValue=ESACC_F50035_HideValue }

    { 1000000006;2;Field  ;
                SourceExpr="Mfr. Rep. Code";
                Visible=ESACC_F50100_Visible;
                Editable=ESACC_F50100_Editable;
                HideValue=ESACC_F50100_HideValue }

    { 1000000099;2;Field  ;
                CaptionML=ENU=TSM Code;
                SourceExpr="Salesperson Code";
                Visible=ESACC_F29_Visible;
                Editable=ESACC_F29_Editable;
                HideValue=ESACC_F29_HideValue }

    { 1000000007;2;Field  ;
                SourceExpr="ISR Code";
                Visible=ESACC_F50101_Visible;
                Editable=ESACC_F50101_Editable;
                HideValue=ESACC_F50101_HideValue }

    { 1000000008;2;Field  ;
                SourceExpr="CSR Code";
                Visible=ESACC_F50102_Visible;
                Editable=ESACC_F50102_Editable;
                HideValue=ESACC_F50102_HideValue }

    { 1000000066;2;Field  ;
                SourceExpr="Location Code";
                Visible=ESACC_F51400_Visible;
                Editable=ESACC_F51400_Editable;
                HideValue=ESACC_F51400_HideValue }

    { 1000000030;2;Field  ;
                SourceExpr="LED Fixtures Scaler";
                Visible=ESACC_F50036_Visible;
                HideValue=ESACC_F50036_HideValue }

    { 1000000029;2;Field  ;
                SourceExpr="LED Lamps Scaler";
                Visible=ESACC_F50037_Visible;
                HideValue=ESACC_F50037_HideValue }

    { 1000000010;2;Field  ;
                SourceExpr="Our Account No.";
                Visible=ESACC_F14_Visible;
                Editable=ESACC_F14_Editable;
                HideValue=ESACC_F14_HideValue }

    { 1000000011;2;Field  ;
                SourceExpr="Shipping Agent Code";
                Visible=ESACC_F31_Visible;
                Editable=ESACC_F31_Editable;
                HideValue=ESACC_F31_HideValue }

    { 1000000012;2;Field  ;
                SourceExpr="E-Ship Agent Service";
                Visible=ESACC_F14000701_Visible;
                Editable=ESACC_F14000701_Editable;
                HideValue=ESACC_F14000701_HideValue }

    { 1000000013;2;Field  ;
                SourceExpr="Free Freight";
                Visible=ESACC_F14000702_Visible;
                Editable=ESACC_F14000702_Editable;
                HideValue=ESACC_F14000702_HideValue }

    { 1000000014;2;Field  ;
                SourceExpr="Shipping Payment Type";
                Visible=ESACC_F14000708_Visible;
                Editable=ESACC_F14000708_Editable;
                HideValue=ESACC_F14000708_HideValue }

    { 1000000015;2;Field  ;
                BlankZero=Yes;
                SourceExpr="Free Freight Min. Order Amount";
                Visible=ESACC_F51407_Visible;
                Editable=ESACC_F51407_Editable;
                HideValue=ESACC_F51407_HideValue }

    { 1000000022;2;Field  ;
                SourceExpr="Payment Terms Code to Print";
                Visible=ESACC_F50000_Visible;
                Editable=ESACC_F50000_Editable;
                HideValue=ESACC_F50000_HideValue }

    { 1000000023;2;Field  ;
                SourceExpr="Shipping Advice";
                Visible=ESACC_F5750_Visible;
                Editable=ESACC_F5750_Editable;
                HideValue=ESACC_F5750_HideValue }

    { 1000000028;2;Field  ;
                SourceExpr="Customer Name";
                Visible=ESACC_F51408_Visible;
                HideValue=ESACC_F51408_HideValue }

    { 1000000026;2;Field  ;
                SourceExpr=City;
                Visible=ESACC_F51409_Visible;
                HideValue=ESACC_F51409_HideValue }

    { 1000000027;2;Field  ;
                SourceExpr=District;
                Visible=ESACC_F51410_Visible;
                HideValue=ESACC_F51410_HideValue }

    { 1000000025;2;Field  ;
                SourceExpr="Post Code";
                Visible=ESACC_F51411_Visible;
                HideValue=ESACC_F51411_HideValue }

    { 1000000024;2;Field  ;
                CaptionML=ENU=State;
                SourceExpr=County;
                Visible=ESACC_F51412_Visible;
                HideValue=ESACC_F51412_HideValue }

    { 1000000033;2;Field  ;
                SourceExpr="Rebate Percentage";
                Visible=ESACC_F50040_Visible;
                Editable=ESACC_F50040_Editable;
                HideValue=ESACC_F50040_HideValue }

    { 1000000031;2;Field  ;
                SourceExpr="Buying Group Code";
                Visible=ESACC_F50041_Visible;
                HideValue=ESACC_F50041_HideValue }

    { 1000000032;2;Field  ;
                SourceExpr="Customer Group Code";
                Visible=ESACC_F50042_Visible;
                HideValue=ESACC_F50042_HideValue }

  }
  CODE
  {
    VAR
      ESACC_ESFLADSMgt@14123801 : Codeunit 14123801;
      ESACC_C1000000016_Visible@915000160 : Boolean INDATASET;
      ESACC_C1000000016_Enabled@915000163 : Boolean INDATASET;
      ESACC_C1000000020_Visible@915000200 : Boolean INDATASET;
      ESACC_C1000000020_Enabled@915000203 : Boolean INDATASET;
      ESACC_F1_Visible@900000010 : Boolean INDATASET;
      ESACC_F1_Editable@900000011 : Boolean INDATASET;
      ESACC_F1_HideValue@900000012 : Boolean INDATASET;
      ESACC_F2_Visible@900000020 : Boolean INDATASET;
      ESACC_F2_Editable@900000021 : Boolean INDATASET;
      ESACC_F2_HideValue@900000022 : Boolean INDATASET;
      ESACC_F3_Visible@900000030 : Boolean INDATASET;
      ESACC_F3_Editable@900000031 : Boolean INDATASET;
      ESACC_F3_HideValue@900000032 : Boolean INDATASET;
      ESACC_F4_Visible@900000040 : Boolean INDATASET;
      ESACC_F4_Editable@900000041 : Boolean INDATASET;
      ESACC_F4_HideValue@900000042 : Boolean INDATASET;
      ESACC_F10_Visible@900000100 : Boolean INDATASET;
      ESACC_F10_Editable@900000101 : Boolean INDATASET;
      ESACC_F10_HideValue@900000102 : Boolean INDATASET;
      ESACC_F14_Visible@900000140 : Boolean INDATASET;
      ESACC_F14_Editable@900000141 : Boolean INDATASET;
      ESACC_F14_HideValue@900000142 : Boolean INDATASET;
      ESACC_F29_Visible@900000290 : Boolean INDATASET;
      ESACC_F29_Editable@900000291 : Boolean INDATASET;
      ESACC_F29_HideValue@900000292 : Boolean INDATASET;
      ESACC_F31_Visible@900000310 : Boolean INDATASET;
      ESACC_F31_Editable@900000311 : Boolean INDATASET;
      ESACC_F31_HideValue@900000312 : Boolean INDATASET;
      ESACC_F5750_Visible@900057500 : Boolean INDATASET;
      ESACC_F5750_Editable@900057501 : Boolean INDATASET;
      ESACC_F5750_HideValue@900057502 : Boolean INDATASET;
      ESACC_F50000_Visible@900500000 : Boolean INDATASET;
      ESACC_F50000_Editable@900500001 : Boolean INDATASET;
      ESACC_F50000_HideValue@900500002 : Boolean INDATASET;
      ESACC_F50035_Visible@900500350 : Boolean INDATASET;
      ESACC_F50035_HideValue@900500352 : Boolean INDATASET;
      ESACC_F50036_Visible@900500360 : Boolean INDATASET;
      ESACC_F50036_HideValue@900500362 : Boolean INDATASET;
      ESACC_F50037_Visible@900500370 : Boolean INDATASET;
      ESACC_F50037_HideValue@900500372 : Boolean INDATASET;
      ESACC_F50040_Visible@900500400 : Boolean INDATASET;
      ESACC_F50040_Editable@900500401 : Boolean INDATASET;
      ESACC_F50040_HideValue@900500402 : Boolean INDATASET;
      ESACC_F50041_Visible@900500410 : Boolean INDATASET;
      ESACC_F50041_HideValue@900500412 : Boolean INDATASET;
      ESACC_F50042_Visible@900500420 : Boolean INDATASET;
      ESACC_F50042_HideValue@900500422 : Boolean INDATASET;
      ESACC_F50100_Visible@900501000 : Boolean INDATASET;
      ESACC_F50100_Editable@900501001 : Boolean INDATASET;
      ESACC_F50100_HideValue@900501002 : Boolean INDATASET;
      ESACC_F50101_Visible@900501010 : Boolean INDATASET;
      ESACC_F50101_Editable@900501011 : Boolean INDATASET;
      ESACC_F50101_HideValue@900501012 : Boolean INDATASET;
      ESACC_F50102_Visible@900501020 : Boolean INDATASET;
      ESACC_F50102_Editable@900501021 : Boolean INDATASET;
      ESACC_F50102_HideValue@900501022 : Boolean INDATASET;
      ESACC_F51400_Visible@900514000 : Boolean INDATASET;
      ESACC_F51400_Editable@900514001 : Boolean INDATASET;
      ESACC_F51400_HideValue@900514002 : Boolean INDATASET;
      ESACC_F51407_Visible@900514070 : Boolean INDATASET;
      ESACC_F51407_Editable@900514071 : Boolean INDATASET;
      ESACC_F51407_HideValue@900514072 : Boolean INDATASET;
      ESACC_F51408_Visible@900514080 : Boolean INDATASET;
      ESACC_F51408_HideValue@900514082 : Boolean INDATASET;
      ESACC_F51409_Visible@900514090 : Boolean INDATASET;
      ESACC_F51409_HideValue@900514092 : Boolean INDATASET;
      ESACC_F51410_Visible@900514100 : Boolean INDATASET;
      ESACC_F51410_HideValue@900514102 : Boolean INDATASET;
      ESACC_F51411_Visible@900514110 : Boolean INDATASET;
      ESACC_F51411_HideValue@900514112 : Boolean INDATASET;
      ESACC_F51412_Visible@900514120 : Boolean INDATASET;
      ESACC_F51412_HideValue@900514122 : Boolean INDATASET;
      ESACC_F14000701_Visible@950007010 : Boolean INDATASET;
      ESACC_F14000701_Editable@950007011 : Boolean INDATASET;
      ESACC_F14000701_HideValue@950007012 : Boolean INDATASET;
      ESACC_F14000702_Visible@950007020 : Boolean INDATASET;
      ESACC_F14000702_Editable@950007021 : Boolean INDATASET;
      ESACC_F14000702_HideValue@950007022 : Boolean INDATASET;
      ESACC_F14000708_Visible@950007080 : Boolean INDATASET;
      ESACC_F14000708_Editable@950007081 : Boolean INDATASET;
      ESACC_F14000708_HideValue@950007082 : Boolean INDATASET;
      Customer@1000000000 : Record 18;

    LOCAL PROCEDURE ESACC_EasySecurity@14123801(OpenObject@14123801 : Boolean);
    VAR
      SetFilters@14123802 : Codeunit 14123812;
      TempBoolean@14123803 : Boolean;
    BEGIN
      IF OpenObject THEN BEGIN
        SetFilters.Filter50007(Rec,8,50007);

        TempBoolean := CurrPage.EDITABLE;
        IF ESACC_ESFLADSMgt.PageGeneral(50007,50007,TempBoolean) THEN
          CurrPage.EDITABLE := TempBoolean;
      END;

      ESACC_ESFLADSMgt.PageControl(
        50007,50007,1,1000000016,
        ESACC_C1000000016_Visible,ESACC_C1000000016_Enabled,TempBoolean);

      ESACC_ESFLADSMgt.PageControl(
        50007,50007,1,1000000020,
        ESACC_C1000000020_Visible,ESACC_C1000000020_Enabled,TempBoolean);

      ESACC_ESFLADSMgt.PageControl(
        50007,50007,0,1,
        ESACC_F1_Visible,ESACC_F1_Editable,ESACC_F1_HideValue);

      ESACC_ESFLADSMgt.PageControl(
        50007,50007,0,2,
        ESACC_F2_Visible,ESACC_F2_Editable,ESACC_F2_HideValue);

      ESACC_ESFLADSMgt.PageControl(
        50007,50007,0,3,
        ESACC_F3_Visible,ESACC_F3_Editable,ESACC_F3_HideValue);

      ESACC_ESFLADSMgt.PageControl(
        50007,50007,0,4,
        ESACC_F4_Visible,ESACC_F4_Editable,ESACC_F4_HideValue);

      ESACC_ESFLADSMgt.PageControl(
        50007,50007,0,10,
        ESACC_F10_Visible,ESACC_F10_Editable,ESACC_F10_HideValue);

      ESACC_ESFLADSMgt.PageControl(
        50007,50007,0,14,
        ESACC_F14_Visible,ESACC_F14_Editable,ESACC_F14_HideValue);

      ESACC_ESFLADSMgt.PageControl(
        50007,50007,0,29,
        ESACC_F29_Visible,ESACC_F29_Editable,ESACC_F29_HideValue);

      ESACC_ESFLADSMgt.PageControl(
        50007,50007,0,31,
        ESACC_F31_Visible,ESACC_F31_Editable,ESACC_F31_HideValue);

      ESACC_ESFLADSMgt.PageControl(
        50007,50007,0,5750,
        ESACC_F5750_Visible,ESACC_F5750_Editable,ESACC_F5750_HideValue);

      ESACC_ESFLADSMgt.PageControl(
        50007,50007,0,50000,
        ESACC_F50000_Visible,ESACC_F50000_Editable,ESACC_F50000_HideValue);

      ESACC_ESFLADSMgt.PageControl(
        50007,50007,0,50035,
        ESACC_F50035_Visible,TempBoolean,ESACC_F50035_HideValue);

      ESACC_ESFLADSMgt.PageControl(
        50007,50007,0,50036,
        ESACC_F50036_Visible,TempBoolean,ESACC_F50036_HideValue);

      ESACC_ESFLADSMgt.PageControl(
        50007,50007,0,50037,
        ESACC_F50037_Visible,TempBoolean,ESACC_F50037_HideValue);

      ESACC_ESFLADSMgt.PageControl(
        50007,50007,0,50040,
        ESACC_F50040_Visible,ESACC_F50040_Editable,ESACC_F50040_HideValue);

      ESACC_ESFLADSMgt.PageControl(
        50007,50007,0,50041,
        ESACC_F50041_Visible,TempBoolean,ESACC_F50041_HideValue);

      ESACC_ESFLADSMgt.PageControl(
        50007,50007,0,50042,
        ESACC_F50042_Visible,TempBoolean,ESACC_F50042_HideValue);

      ESACC_ESFLADSMgt.PageControl(
        50007,50007,0,50100,
        ESACC_F50100_Visible,ESACC_F50100_Editable,ESACC_F50100_HideValue);

      ESACC_ESFLADSMgt.PageControl(
        50007,50007,0,50101,
        ESACC_F50101_Visible,ESACC_F50101_Editable,ESACC_F50101_HideValue);

      ESACC_ESFLADSMgt.PageControl(
        50007,50007,0,50102,
        ESACC_F50102_Visible,ESACC_F50102_Editable,ESACC_F50102_HideValue);

      ESACC_ESFLADSMgt.PageControl(
        50007,50007,0,51400,
        ESACC_F51400_Visible,ESACC_F51400_Editable,ESACC_F51400_HideValue);

      ESACC_ESFLADSMgt.PageControl(
        50007,50007,0,51407,
        ESACC_F51407_Visible,ESACC_F51407_Editable,ESACC_F51407_HideValue);

      ESACC_ESFLADSMgt.PageControl(
        50007,50007,0,51408,
        ESACC_F51408_Visible,TempBoolean,ESACC_F51408_HideValue);

      ESACC_ESFLADSMgt.PageControl(
        50007,50007,0,51409,
        ESACC_F51409_Visible,TempBoolean,ESACC_F51409_HideValue);

      ESACC_ESFLADSMgt.PageControl(
        50007,50007,0,51410,
        ESACC_F51410_Visible,TempBoolean,ESACC_F51410_HideValue);

      ESACC_ESFLADSMgt.PageControl(
        50007,50007,0,51411,
        ESACC_F51411_Visible,TempBoolean,ESACC_F51411_HideValue);

      ESACC_ESFLADSMgt.PageControl(
        50007,50007,0,51412,
        ESACC_F51412_Visible,TempBoolean,ESACC_F51412_HideValue);

      ESACC_ESFLADSMgt.PageControl(
        50007,50007,0,14000701,
        ESACC_F14000701_Visible,ESACC_F14000701_Editable,ESACC_F14000701_HideValue);

      ESACC_ESFLADSMgt.PageControl(
        50007,50007,0,14000702,
        ESACC_F14000702_Visible,ESACC_F14000702_Editable,ESACC_F14000702_HideValue);

      ESACC_ESFLADSMgt.PageControl(
        50007,50007,0,14000708,
        ESACC_F14000708_Visible,ESACC_F14000708_Editable,ESACC_F14000708_HideValue);

      ESACC_EasySecurityManual(OpenObject);
    END;

    LOCAL PROCEDURE ESACC_EasySecurityManual@14123811(OpenObject@14123811 : Boolean);
    BEGIN
    END;

    PROCEDURE SetDataCaptionExpr@1000000000() : Text[100];
    BEGIN
      //TOP140 KT ABCSI - Payment Terms for Multiple Divisions 06032015
      IF Customer.GET("Customer No.") THEN
        EXIT("Customer No." +' - ' + Customer.Name)
      ELSE
        EXIT(' ');
      //TOP140 KT ABCSI - Payment Terms for Multiple Divisions 06032015
    END;

    BEGIN
    {
      TOP100B KT ABCSI Item Cust. Avail. & Price 03182015
        - Added new field Multiplier

      TOP110 KT ABCSI Salesperson 03302015
        - Added new fields Mfr. Rep. Code, ISR Code, CSR Code

      TOP150 - KT ABCSI Sales Order Margin Review 04032015
        - Added field Margin Approval %

      TOP140 KT ABCSI - Payment Terms for Multiple Divisions 06032015
        - Created new function SetDataCaptionExpr and set it in the DataCaptionExpr property of the page

      2015-04-03 TPZ567 VCHERNYA
        OSR Code (Salesperson Code) and Location Code fields have been added
      2015-04-03 TPZ572 VCHERNYA
        RSM Code field has been added
      2015-04-30 TPZ161 VCHERNYA
        Our Account No., Shipping Agent Code, E-Ship Agent Service, Free Freight, Shipping Payment Type fields have been added
      2015-05-29 TPZ573 VCHERNYA
        Free Freight Min. Order Amount field has been added
      2015-06-25 TPZ129 TAKHMETO
        Action Group History, Action Change Log Entries have been added
      2015-07-29 TPZ61 TAKHMETO
        Action Group Functions, Action Send Customer Statement E-Mail have been added
      2015-11-01 TPZ1117 TAKHMETO
        Payment Terms Code to Print field has been added
      2019-10-23 TPZ2651 VAHAMAD
        Fields "LED Fixtures Scaler" and "LED Lamps Scaler" added
      2019-10-25 TPZ2696 RTIWARI
        Three new fields added viz. Rebate Percentage,Buying Group Code and Customer Group Code
      001 TPZ3009 RPS 12232020 - OSR Change Logic | TSM vs OSR G2 data pull - Changed Caption
    }
    END.
  }
}

