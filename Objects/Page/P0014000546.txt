OBJECT Page 14000546 Suggested Transfer Order
{
  OBJECT-PROPERTIES
  {
    Date=01/27/21;
    Time=[ 8:26:33 AM];
    Modified=Yes;
    Version List=UBP3.00;
  }
  PROPERTIES
  {
    CaptionML=ENU=Suggested Transfer;
    InsertAllowed=No;
    LinksAllowed=No;
    SourceTable=Table14000592;
    PageType=Document;
    OnInit=BEGIN
             "Transfer From PriorityVisible" := TRUE;
             "Transfer To PriorityVisible" := TRUE;
             TransferAvailFBVisible := TRUE;
           END;

    OnOpenPage=BEGIN
                 // 2015+ >>
                 IsNotWindowsClient := (CURRENTCLIENTTYPE <> CLIENTTYPE::Windows);
                 IsWindowsClient := (CURRENTCLIENTTYPE = CLIENTTYPE::Windows);
                 // 2015+ <<
                 CASE "Document Type" OF
                   "Document Type"::"Repl. Path":
                     BEGIN
                       CurrPage.RollUpTransferFB.PAGE.CalledFromSugTransferOrder;
                       CurrPage.SuggestedTransferLines.PAGE.SetToRollupVisible(FALSE);
                     END;
                   "Document Type"::"Inv. Balancing":
                     BEGIN
                       TransferAvailFBVisible := FALSE;
                       CurrPage.SuggestedTransferLines.PAGE.SetToRollupVisible(TRUE);
                     END;
                 END;
               END;

    OnAfterGetRecord=BEGIN
                       CASE "Document Type" OF
                         "Document Type"::"Repl. Path":
                           BEGIN
                             "Transfer To PriorityVisible" := FALSE;
                             "Transfer From PriorityVisible" := FALSE;
                           END;
                         "Document Type"::"Inv. Balancing":
                           BEGIN
                             "Transfer To PriorityVisible" := TRUE;
                             "Transfer From PriorityVisible" := TRUE;
                           END;
                       END;
                     END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 1240030005;1 ;Action    ;
                      ShortCutKey=F7;
                      CaptionML=ENU=Statistics;
                      RunObject=Page 14000549;
                      RunPageLink=No.=FIELD(No.);
                      Image=Statistics;
                      PromotedCategory=Process }
      { 10      ;1   ;Action    ;
                      CaptionML=ENU=Suggested Transfer Line Review;
                      RunObject=Page 14097458;
                      RunPageView=SORTING(Document Type,Suggested Transfer No.,Line No.);
                      RunPageLink=Suggested Transfer No.=FIELD(No.),
                                  Document Type=FIELD(Document Type) }
      { 1000000002;1 ;Action    ;
                      Name=Delete Electric Items;
                      Promoted=Yes;
                      Image=Action;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 DeleteLines('E','ELECTRIC');
                                 //</TPZ1915>
                               END;
                                }
      { 1000000001;1 ;Action    ;
                      Name=Delete Lighting Items;
                      Promoted=Yes;
                      Image=Action;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 //<TPZ1915>
                                 DeleteLines('L','LIGHTING');
                                 //</TPZ1915>
                               END;
                                }
      { 1000000000;1 ;Action    ;
                      Name=Delete International Items;
                      Promoted=Yes;
                      Image=Action;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 //<TPZ1915>
                                 DeleteLines('I','INTERNATIONAL');
                                 //</TPZ1915>
                               END;
                                }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1240030030;1 ;Action    ;
                      CaptionML=ENU=&Create Transfer Order;
                      Promoted=No;
                      Image=CalculateLines;
                      OnAction=BEGIN
                                 CLEAR(CreateTransOrderFromSTO);
                                 CreateTransOrderFromSTO.BySuggestedTransferOrder(Rec);
                                 CurrPage.UPDATE;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1240030000;1;Group  ;
                CaptionML=ENU=General;
                Visible=IsWindowsClient }

    { 1240030033;2;Field  ;
                SourceExpr="Document Type" }

    { 1240030001;2;Field  ;
                SourceExpr="No." }

    { 1240030003;2;Field  ;
                SourceExpr="Transfer-from Code" }

    { 1240030007;2;Field  ;
                SourceExpr="Transfer-to Code";
                Importance=Promoted }

    { 1240030011;2;Field  ;
                SourceExpr="In-Transit Code" }

    { 1240030015;2;Field  ;
                SourceExpr="Creation Date" }

    { 1240030017;2;Field  ;
                SourceExpr="Transfer Date" }

    { 1240030019;2;Field  ;
                SourceExpr="Shipping Advice" }

    { 1240030031;2;Field  ;
                SourceExpr="Transfer To Priority";
                Visible="Transfer To PriorityVisible" }

    { 1240030036;2;Field  ;
                SourceExpr="Transfer From Priority";
                Visible="Transfer From PriorityVisible" }

    { 3   ;2   ;Field     ;
                SourceExpr="Transfer Cost";
                Importance=Promoted }

    { 4   ;2   ;Field     ;
                SourceExpr="Net Weight";
                Visible=FALSE }

    { 5   ;2   ;Field     ;
                SourceExpr="Gross Weight";
                Visible=FALSE }

    { 6   ;2   ;Field     ;
                SourceExpr=Volume;
                Visible=FALSE }

    { 1   ;2   ;Field     ;
                SourceExpr="Piece Count";
                Importance=Promoted }

    { 9   ;2   ;Field     ;
                SourceExpr="Line Count";
                Importance=Promoted }

    { 1240030022;1;Part   ;
                Name=SuggestedTransferLines;
                SubPageLink=Suggested Transfer No.=FIELD(No.),
                            Document Type=FIELD(Document Type);
                PagePartID=Page14000547 }

    { 1240020018;1;Group  ;
                CaptionML=ENU=General;
                Visible=IsNotWindowsClient;
                GroupType=Group }

    { 1240020017;2;Field  ;
                Name=Document Type2;
                SourceExpr="Document Type" }

    { 1240020016;2;Field  ;
                Name=No.2;
                SourceExpr="No." }

    { 1240020015;2;Field  ;
                Name=Transfer-from Code2;
                SourceExpr="Transfer-from Code" }

    { 1240020014;2;Field  ;
                Name=Transfer-to Code2;
                SourceExpr="Transfer-to Code";
                Importance=Promoted }

    { 1240020013;2;Field  ;
                Name=In-Transit Code2;
                SourceExpr="In-Transit Code" }

    { 1240020012;2;Field  ;
                Name=Creation Date2;
                SourceExpr="Creation Date" }

    { 1240020011;2;Field  ;
                Name=Transfer Date2;
                SourceExpr="Transfer Date" }

    { 1240020010;2;Field  ;
                Name=Shipping Advice2;
                SourceExpr="Shipping Advice" }

    { 1240020009;2;Field  ;
                Name=Transfer To Priority2;
                SourceExpr="Transfer To Priority";
                Visible="Transfer To PriorityVisible" }

    { 1240020008;2;Field  ;
                Name=Transfer From Priority2;
                SourceExpr="Transfer From Priority";
                Visible="Transfer From PriorityVisible" }

    { 1240020007;2;Field  ;
                Name=Transfer Cost2;
                SourceExpr="Transfer Cost";
                Importance=Promoted }

    { 1240020006;2;Field  ;
                Name=Net Weight2;
                SourceExpr="Net Weight";
                Visible=FALSE }

    { 1240020005;2;Field  ;
                Name=Gross Weight2;
                SourceExpr="Gross Weight";
                Visible=FALSE }

    { 1240020004;2;Field  ;
                Name=Volume2;
                SourceExpr=Volume;
                Visible=FALSE }

    { 1240020003;2;Field  ;
                Name=Piece Count2;
                SourceExpr="Piece Count";
                Importance=Promoted }

    { 1240020002;2;Field  ;
                Name=Line Count2;
                SourceExpr="Line Count";
                Importance=Promoted }

    { 8   ;0   ;Container ;
                ContainerType=FactBoxArea }

    { 1240020000;1;Part   ;
                CaptionML=ENU=From Expected Quantity;
                SubPageLink=Location Code=FIELD(Transfer-from Code),
                            Item No.=FIELD(Item No.),
                            Variant Code=FIELD(Variant Code);
                PagePartID=Page14097479;
                ProviderID=1240030022;
                PartType=Page }

    { 11  ;1   ;Part      ;
                CaptionML=ENU=Sugg. Trans. Line;
                SubPageView=SORTING(Document Type,Suggested Transfer No.,Line No.);
                SubPageLink=Suggested Transfer No.=FIELD(Suggested Transfer No.),
                            Document Type=FIELD(Document Type),
                            Line No.=FIELD(Line No.);
                PagePartID=Page14097452;
                ProviderID=1240030022;
                PartType=Page }

    { 7   ;1   ;Part      ;
                Name=Surplus Inventory Factbox;
                CaptionML=ENU=Surplus Inventory;
                SubPageView=SORTING(Item No.,Variant Code,Surplus Available);
                SubPageLink=On Hand Qty. (Base)=FIELD("Suggested Quantity (Base)"),
                            Surplus Quantity (Base)=FIELD("Transfer Quantity (Base)"),
                            Suggested Order No.=FIELD(Suggested Transfer No.),
                            Transfer To Location Code=FIELD(Transfer-to Code),
                            Item No.=FIELD(Item No.),
                            Variant Code=FIELD(Variant Code),
                            Surplus Available=CONST(Yes),
                            Replenishment Source Type=CONST(Location);
                PagePartID=Page14000551;
                ProviderID=1240030022;
                PartType=Page }

    { 2   ;1   ;Part      ;
                CaptionML=ENU=Usage at Transfer Location;
                SubPageLink=Location Code=FIELD(Transfer-to Code),
                            Item No.=FIELD(Item No.),
                            Variant Code=FIELD(Variant Code);
                PagePartID=Page14097457;
                ProviderID=1240030022;
                Visible=FALSE;
                PartType=Page;
                ShowFilter=No }

    { 1240020001;1;Part   ;
                Name=RollUpTransferFB;
                CaptionML=ENU=Hub/Spoke Transfers;
                SubPageView=SORTING(Level)
                            ORDER(Ascending);
                SubPageLink=Item No.=FIELD(Item No.),
                            Location Code=FIELD(Transfer-from Code),
                            Variant Code=FIELD(Variant Code),
                            Horizon Date=FIELD(Date Horizon),
                            Alt. Horizon Date=FIELD(Allocated Date);
                PagePartID=Page14000530;
                ProviderID=1240030022;
                Visible=TransferAvailFBVisible;
                PartType=Page;
                ShowFilter=No }

    { 1000000003;1;Part   ;
                Name=<Item Substition FactBox>;
                CaptionML=ENU=Item Substition FactBox;
                SubPageLink=No.=FIELD(Item No.),
                            Location Filter=FIELD(Transfer-from Code);
                PagePartID=Page50074;
                ProviderID=1240030022;
                PartType=Page }

  }
  CODE
  {
    VAR
      CreateTransOrderFromSTO@1240030000 : Codeunit 14000586;
      "Transfer To PriorityVisible"@19050756 : Boolean INDATASET;
      "Transfer From PriorityVisible"@19012009 : Boolean INDATASET;
      TransferAvailFBVisible@1240020000 : Boolean;
      IsNotWindowsClient@1240020002 : Boolean;
      IsWindowsClient@1240020001 : Boolean;

    PROCEDURE DeleteLines@1000000000(DivNo@1000000000 : Code[10];divtext@1000000002 : Code[20]);
    VAR
      SuggestedTransferLine@1000000001 : Record 14000593;
    BEGIN
      //<TPZ1915>
      IF CONFIRM('Are you sure to delete all division %1 item ...?',FALSE,divtext) THEN BEGIN
        SuggestedTransferLine.SETRANGE("Document Type","Document Type");
        SuggestedTransferLine.SETRANGE("Suggested Transfer No.","No.");
        SuggestedTransferLine.SETRANGE(SuggestedTransferLine."Division Code",DivNo);
        IF SuggestedTransferLine.FINDSET THEN
          SuggestedTransferLine.DELETEALL(TRUE);
      END;
      //</TPZ1915>
    END;

    BEGIN
    END.
  }
}

