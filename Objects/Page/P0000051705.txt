OBJECT Page 51705 Commission Journal
{
  OBJECT-PROPERTIES
  {
    Date=09/17/20;
    Time=[ 9:09:39 AM];
    Modified=Yes;
    Version List=TPZ000.00.00;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Commission Journal;
               ESM=Diario general;
               FRC=Journal gÇnÇral;
               ENC=General Journal];
    SaveValues=Yes;
    SourceTable=Table51705;
    DataCaptionExpr=DataCaption;
    DelayedInsert=Yes;
    PageType=Worksheet;
    AutoSplitKey=Yes;
    PromotedActionCategoriesML=[ENU=New,Process,Report,Bank,Application,Payroll;
                                ESM=Nuevo,Proceso,Informe,Banco,Aplicaci¢n,N¢mina;
                                FRC=Nouveau,Traitement,êtat,Banque,Application,Salaires;
                                ENC=New,Process,Report,Bank,Application,Payroll];
    OnInit=BEGIN
             // <TPZ858>
             UserSetup.GET(USERID);
             UserSetup.TESTFIELD(UserSetup."Comm. / Hdlg Admin.");
             // </TPZ858>
           END;

    OnOpenPage=VAR
                 JnlSelected@1000 : Boolean;
               BEGIN
                 OpenedFromBatch := ("Journal Batch Name" <> '') AND ("Journal Template Name" = '');
                 IF OpenedFromBatch THEN BEGIN
                   CurrentJnlBatchName := "Journal Batch Name";
                   CommJnlManagement.OpenJnl(CurrentJnlBatchName,Rec);
                   EXIT;
                 END;
                 CommJnlManagement.TemplateSelection(PAGE::"Commission Journal",Rec,JnlSelected);
                 IF NOT JnlSelected THEN
                   ERROR('');
                 CommJnlManagement.OpenJnl(CurrentJnlBatchName,Rec);
               END;

    OnAfterGetRecord=BEGIN
                       IF "Base Amount" <> 0 THEN
                         CalcCommHandlRate := (Amount * 100) / "Base Amount"
                       ELSE
                         CalcCommHandlRate := 0;
                     END;

    OnNewRecord=BEGIN
                  SetUpNewLine(xRec,BelowxRec);
                END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 75      ;1   ;ActionGroup;
                      CaptionML=[ENU=&Line;
                                 ESM=&L°nea;
                                 FRC=&Ligne;
                                 ENC=&Line];
                      Image=Line }
      { 1000000005;2 ;Action    ;
                      Name=SourceDocument;
                      CaptionML=ENU=Source Document;
                      Image=View;
                      OnAction=VAR
                                 SalesInvHeader@1000000000 : Record 112;
                                 SalesCrMemoHeader@1000000001 : Record 114;
                               BEGIN
                                 CASE "Source Document Type" OF
                                   "Source Document Type"::Invoice:
                                     BEGIN
                                       SalesInvHeader.RESET;
                                       SalesInvHeader.GET("Source Document No.");
                                       PAGE.RUNMODAL(PAGE::"Posted Sales Invoice",SalesInvHeader);
                                     END;
                                   "Source Document Type"::"Credit Memo":
                                     BEGIN
                                       SalesCrMemoHeader.RESET;
                                       SalesCrMemoHeader.GET("Source Document No.");
                                       PAGE.RUNMODAL(PAGE::"Posted Sales Credit Memo",SalesCrMemoHeader);
                                     END;
                                 END;
                                 CurrPage.UPDATE(TRUE);
                               END;
                                }
      { 43      ;1   ;ActionGroup;
                      CaptionML=[ENU=A&ccount;
                                 ESM=&Cuenta;
                                 FRC=&Compte;
                                 ENC=A&ccount];
                      Image=ChartOfAccounts }
      { 44      ;2   ;Action    ;
                      Name=<Codeunit Comm.. Jnl.-Show Card>;
                      ShortCutKey=Shift+F7;
                      CaptionML=[ENU=Card;
                                 ESM=Ficha;
                                 FRC=Fiche;
                                 ENC=Card];
                      RunObject=Codeunit 51704;
                      Image=EditLines }
      { 45      ;2   ;Action    ;
                      Name=<Codeunit Comm. Jnl.-Show Entries;
                      ShortCutKey=Ctrl+F7;
                      CaptionML=[ENU=Ledger E&ntries;
                                 ESM=&Movimientos;
                                 FRC=ê&critures comptables;
                                 ENC=Ledger E&ntries];
                      RunObject=Codeunit 51703;
                      Promoted=No;
                      Image=GLRegisters;
                      PromotedCategory=Process }
      { 1000000007;1 ;ActionGroup;
                      CaptionML=[ENU=&Payments;
                                 ESM=&Pagos;
                                 FRC=&Paiements;
                                 ENC=&Payments];
                      Image=Payment }
      { 1000000006;2 ;Action    ;
                      Name=SuggestMfrRepPayments;
                      Ellipsis=Yes;
                      CaptionML=ENU=Suggest Mfr. Rep. Payments;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=SuggestCustomerPayments;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 SuggestCommPayments@1001 : Report 51700;
                               BEGIN
                                 CLEAR(SuggestCommPayments);
                                 SuggestCommPayments.SetCommJnlLine(Rec);
                                 SuggestCommPayments.RUNMODAL;
                               END;
                                }
      { 1000000015;2 ;Action    ;
                      Name=SuggestLocationPayments;
                      Ellipsis=Yes;
                      CaptionML=ENU=Suggest Location Payments;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=SuggestVendorPayments;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 SuggestLocationPayments@1001 : Report 51701;
                               BEGIN
                                 CLEAR(SuggestLocationPayments);
                                 SuggestLocationPayments.SetCommJnlLine(Rec);
                                 SuggestLocationPayments.RUNMODAL;
                               END;
                                }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1000000021;1 ;ActionGroup;
                      CaptionML=ENU=&Email }
      { 1000000017;2 ;Action    ;
                      CaptionML=ENU=Send Mfr. Rep. Statement;
                      Image=MailAttachment;
                      OnAction=BEGIN
                                 TESTFIELD("Account Type","Account Type"::"Mfr. Rep.");
                                 MfrRep.GET("Account No.");
                                 EmailMgt.SendMfrRepStatement(MfrRep,Rec,TRUE,FALSE);
                               END;
                                }
      { 1000000018;2 ;Action    ;
                      CaptionML=ENU=Send Location Statement;
                      Image=MailAttachment;
                      OnAction=BEGIN
                                 TESTFIELD("Account Type","Account Type"::Location);
                                 Location.GET("Account No.");
                                 EmailMgt.SendLocHdlgStatement(Location,Rec,TRUE,FALSE);
                               END;
                                }
      { 1000000038;2 ;Action    ;
                      CaptionML=ENU=Batch Send Mfr. Rep.  Email;
                      OnAction=VAR
                                 EmailListEntry@1000000000 : Record 14000908;
                                 EmailTo@1000000001 : Text;
                                 EmailCC@1000000002 : Text;
                                 I@1000000003 : Integer;
                                 J@1000000014 : Integer;
                                 MfrRep@1000000007 : Record 50027;
                                 CommJournalLine@1000000006 : Record 51705;
                                 MainCommJournalLine@1000000005 : Record 51705;
                                 MailSMTP@1000000012 : DotNet "'Microsoft.Dynamics.Nav.SMTP, Version=10.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35'.Microsoft.Dynamics.Nav.SMTP.SmtpMessage";
                                 MailVar@1000000011 : Codeunit 400;
                                 MfrRepS@1000000010 : Report 51706;
                                 tmpaccountNo@1000000009 : Code[10];
                                 SMTP_Setup@1000000008 : Record 409;
                                 Subject@1000000004 : Text;
                                 CommJnlSendSourceDoc@1000000013 : Codeunit 51705;
                                 UserSetup@1000000015 : Record 91;
                                 LFChar@1000000017 : Char;
                                 CRChar@1000000018 : Char;
                                 CRLF@1000000019 : Text;
                                 EMailSetup@1000000028 : Record 14000905;
                                 EMailRule@1000000027 : Record 14000907;
                                 EMailHeader@1000000026 : Record 14000901;
                                 EMailLine@1000000025 : Record 14000902;
                                 EMailLineFirstOnLevel@1000000024 : ARRAY [10] OF Record 14000902;
                                 EMailListEntryTmp@1000000023 : TEMPORARY Record 14000908;
                                 EMailAttachment@1000000022 : Record 14000909;
                                 EMailAttachmentTmp@1000000021 : TEMPORARY Record 14000909;
                                 FieldValue@1000000020 : Codeunit 14000901;
                                 MailInt@1000000016 : Codeunit 14000905;
                               BEGIN
                                 //<TPZ1415>
                                 MainCommJournalLine.RESET();
                                 MainCommJournalLine.SETFILTER("Journal Template Name","Journal Template Name");
                                 MainCommJournalLine.SETFILTER("Journal Batch Name","Journal Batch Name");
                                 MainCommJournalLine.SETRANGE("Account Type",MainCommJournalLine."Account Type"::"Mfr. Rep.");
                                 MainCommJournalLine.SETRANGE("E-Mail Notification Handled",FALSE);
                                 IF MainCommJournalLine.FINDFIRST THEN
                                   REPEAT
                                     IF MainCommJournalLine."Account No."<>tmpaccountNo THEN BEGIN
                                       IF MfrRep.GET(MainCommJournalLine."Account No.") THEN BEGIN
                                           EmailMgt.SendMfrRepStatement(MfrRep,MainCommJournalLine,TRUE,TRUE);
                                           tmpaccountNo:=MainCommJournalLine."Account No.";
                                           COMMIT();
                                        END;
                                     END;
                                    UNTIL MainCommJournalLine.NEXT=0;
                                 //</TPZ1415>
                               END;
                                }
      { 1000000039;2 ;Action    ;
                      CaptionML=ENU=Batch Send Location Statementl;
                      OnAction=VAR
                                 EmailListEntry@1000000000 : Record 14000908;
                                 EmailTo@1000000001 : Text;
                                 EmailCC@1000000002 : Text;
                                 I@1000000003 : Integer;
                                 J@1000000014 : Integer;
                                 MfrRep@1000000007 : Record 50027;
                                 CommJournalLine@1000000006 : Record 51705;
                                 MainCommJournalLine@1000000005 : Record 51705;
                                 MailSMTP@1000000012 : DotNet "'Microsoft.Dynamics.Nav.SMTP, Version=10.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35'.Microsoft.Dynamics.Nav.SMTP.SmtpMessage";
                                 MailVar@1000000011 : Codeunit 400;
                                 MfrRepS@1000000010 : Report 51706;
                                 tmpaccountNo@1000000009 : Code[10];
                                 SMTP_Setup@1000000008 : Record 409;
                                 Subject@1000000004 : Text;
                                 CommJnlSendSourceDoc@1000000013 : Codeunit 51705;
                                 UserSetup@1000000015 : Record 91;
                                 LFChar@1000000017 : Char;
                                 CRChar@1000000018 : Char;
                                 CRLF@1000000019 : Text;
                                 EMailSetup@1000000028 : Record 14000905;
                                 EMailRule@1000000027 : Record 14000907;
                                 EMailHeader@1000000026 : Record 14000901;
                                 EMailLine@1000000025 : Record 14000902;
                                 EMailLineFirstOnLevel@1000000024 : ARRAY [10] OF Record 14000902;
                                 EMailListEntryTmp@1000000023 : TEMPORARY Record 14000908;
                                 EMailAttachment@1000000022 : Record 14000909;
                                 EMailAttachmentTmp@1000000021 : TEMPORARY Record 14000909;
                                 FieldValue@1000000020 : Codeunit 14000901;
                                 MailInt@1000000016 : Codeunit 14000905;
                               BEGIN
                                   //<TPZ1415>
                                 MainCommJournalLine.RESET();
                                 MainCommJournalLine.SETFILTER("Journal Template Name","Journal Template Name");
                                 MainCommJournalLine.SETFILTER("Journal Batch Name","Journal Batch Name");
                                 MainCommJournalLine.SETRANGE("Account Type",MainCommJournalLine."Account Type"::Location);
                                 MainCommJournalLine.SETRANGE("E-Mail Notification Handled",FALSE);
                                 IF MainCommJournalLine.FINDFIRST THEN
                                   REPEAT
                                     IF MainCommJournalLine."Account No."<>tmpaccountNo THEN BEGIN
                                       IF Location.GET(MainCommJournalLine."Account No.") THEN BEGIN
                                           EmailMgt.SendLocHdlgStatement(Location,MainCommJournalLine,TRUE,TRUE);
                                           tmpaccountNo:=MainCommJournalLine."Account No.";
                                           COMMIT();
                                       END;
                                     END;
                                    UNTIL MainCommJournalLine.NEXT=0;
                                 //</TPZ1415>
                               END;
                                }
      { 1000000014;1 ;ActionGroup;
                      CaptionML=[ENU=&Print;
                                 ESM=&Imprimir;
                                 FRC=&Imprimer;
                                 ENC=&Print];
                      Image=Print }
      { 1000000013;2 ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=ENU=Mfr. Rep. Statement;
                      Image=PrintDocument;
                      OnAction=VAR
                                 MfrRep@1000000001 : Record 50027;
                                 MfrRepCommStatement@1000000000 : Report 51702;
                                 CommJnlSendSourceDoc@1000000002 : Codeunit 51705;
                               BEGIN
                                 TESTFIELD("Account Type","Account Type"::"Mfr. Rep.");
                                 TESTFIELD("Account No.");
                                 CommJnlSendSourceDoc.SetCommJnlLine(Rec);
                                 MfrRep.SETRANGE(Code,"Account No.");
                                 REPORT.RUNMODAL(REPORT::"Mfr. Rep. Comm. Statement",TRUE,FALSE,MfrRep);
                               END;
                                }
      { 1000000016;2 ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=ENU=Location Statement;
                      Image=PrintDocument;
                      OnAction=VAR
                                 Location@1000000001 : Record 14;
                                 LocationCommStatement@1000000000 : Report 51703;
                                 CommJnlSendSourceDoc@1000000002 : Codeunit 51705;
                               BEGIN
                                 TESTFIELD("Account Type","Account Type"::Location);
                                 TESTFIELD("Account No.");
                                 CommJnlSendSourceDoc.SetCommJnlLine(Rec);
                                 Location.SETRANGE(Code,"Account No.");
                                 REPORT.RUNMODAL(REPORT::"Location Comm. Statement",TRUE,FALSE,Location);
                               END;
                                }
      { 1000000033;2 ;Action    ;
                      CaptionML=ENU=Account Summary Statement;
                      Image=ExportToExcel;
                      OnAction=VAR
                                 CommJnlSendSourceDoc@1000000000 : Codeunit 51705;
                               BEGIN
                                 TESTFIELD("Account No.");
                                 CommJnlSendSourceDoc.SetCommJnlLine(Rec);
                                 REPORT.RUNMODAL(REPORT::"Account Summary Statement",TRUE,FALSE);
                               END;
                                }
      { 1000000019;2 ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=ENU=Source Invoice;
                      Image=PrintForm;
                      OnAction=VAR
                                 SalesInvHeader@1000000000 : Record 112;
                                 SalesInvHeaderBatch@1000000001 : Integer;
                               BEGIN
                                 TESTFIELD("Source Document Type","Source Document Type"::Invoice);
                                 TESTFIELD("Source Document No.");
                                 SalesInvHeader.SETRANGE("No.","Source Document No.");
                                 //REPORT.RUNMODAL(REPORT::"Sales Invoice",TRUE,FALSE,SalesInvHeader);
                                 REPORT.RUNMODAL(REPORT::"Sales Invoice Batch",TRUE,FALSE,SalesInvHeader);
                               END;
                                }
      { 1000000020;2 ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=ENU=Source Credit Memo;
                      Image=PrintForm;
                      OnAction=VAR
                                 SalesCrMemoHeader@1000000000 : Record 114;
                               BEGIN
                                 TESTFIELD("Source Document Type","Source Document Type"::"Credit Memo");
                                 TESTFIELD("Source Document No.");
                                 SalesCrMemoHeader.SETRANGE("No.","Source Document No.");
                                 REPORT.RUNMODAL(REPORT::"Sales Invoice",TRUE,FALSE,SalesCrMemoHeader);
                               END;
                                }
      { 1000000037;2 ;Action    ;
                      CaptionML=ENU=Summary;
                      Image=CreateDocument;
                      OnAction=VAR
                                 CommJnlSendSourceDoc@1000000000 : Codeunit 51705;
                               BEGIN
                                 // <TPZ1321>
                                 CommJnlSendSourceDoc.SetCommJnlLine(Rec);
                                 REPORT.RUNMODAL(REPORT::"Commission Journal - Summary",TRUE,FALSE);
                                 // </TPZ1321>
                               END;
                                }
      { 1000000025;1 ;ActionGroup;
                      CaptionML=ENU=&Payable;
                      ActionContainerType=NewDocumentItems }
      { 1000000027;2 ;Action    ;
                      CaptionML=ENU=Create Mfr. Rep. Payable Document;
                      Image=Invoice;
                      OnAction=VAR
                                 CreateMfrRepPayableDoc@1000000000 : Report 51714;
                               BEGIN
                                 IF CONFIRM(Text51700,FALSE) THEN BEGIN
                                   CreateMfrRepPayableDoc.USEREQUESTPAGE(FALSE);
                                   CreateMfrRepPayableDoc.InitializeRequest("Journal Template Name","Journal Batch Name");
                                   CreateMfrRepPayableDoc.RUNMODAL();
                                 END;
                               END;
                                }
      { 1000000028;2 ;Action    ;
                      CaptionML=ENU=Create Loc. Hdlg. Payable Document;
                      Image=Invoice;
                      OnAction=VAR
                                 CreateLocHdlgPayableDoc@1000000000 : Report 51715;
                               BEGIN
                                 IF CONFIRM(Text51701,FALSE) THEN BEGIN
                                   CreateLocHdlgPayableDoc.USEREQUESTPAGE(FALSE);
                                   CreateLocHdlgPayableDoc.InitializeRequest("Journal Template Name","Journal Batch Name");
                                   CreateLocHdlgPayableDoc.RUNMODAL()
                                 END;
                               END;
                                }
      { 1000000026;1 ;ActionGroup;
                      CaptionML=[ENU=P&osting;
                                 ESM=Acci&ones;
                                 FRC=F&onctions;
                                 ENC=F&unctions];
                      Image=Action }
      { 1000000029;2 ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Test Report;
                                 ESM=Informe prueba;
                                 FRC=Tester le report;
                                 ENC=Test Report];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=TestReport;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 CommJnlTemplate@1000000001 : Record 51703;
                                 CommJnlLine@1000000000 : Record 51705;
                               BEGIN
                                 CommJnlLine.COPY(Rec);
                                 CommJnlLine.SETRANGE("Journal Template Name",CommJnlLine."Journal Template Name");
                                 CommJnlLine.SETRANGE("Journal Batch Name",CommJnlLine."Journal Batch Name");
                                 CommJnlTemplate.GET(CommJnlLine."Journal Template Name");
                                 CommJnlTemplate.TESTFIELD("Test Report ID");
                                 REPORT.RUN(CommJnlTemplate."Test Report ID",TRUE,FALSE,CommJnlLine);
                               END;
                                }
      { 1000000023;2 ;Action    ;
                      Name=Post;
                      ShortCutKey=F9;
                      CaptionML=[ENU=P&ost;
                                 ESM=&Registrar;
                                 FRC=Rep&orter;
                                 ENC=P&ost];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=PostOrder;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CODEUNIT.RUN(CODEUNIT::"Comm. Jnl.-Post",Rec);
                                 CurrentJnlBatchName := GETRANGEMAX("Journal Batch Name");
                                 CurrPage.UPDATE(FALSE);
                               END;
                                }
      { 1000000022;2 ;Action    ;
                      ShortCutKey=Shift+F9;
                      CaptionML=[ENU=Post and &Print;
                                 ESM=Registrar e &imprimir;
                                 FRC=Reporter et im&primer;
                                 ENC=Post and &Print];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=PostPrint;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CODEUNIT.RUN(CODEUNIT::"Comm. Jnl.-Post+Print",Rec);
                                 CurrentJnlBatchName := GETRANGEMAX("Journal Batch Name");
                                 CurrPage.UPDATE(FALSE);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 39  ;1   ;Field     ;
                Lookup=Yes;
                CaptionML=[ENU=Batch Name;
                           ESM=Nombre secci¢n;
                           FRC=Nom de lot;
                           ENC=Batch Name];
                SourceExpr=CurrentJnlBatchName;
                OnValidate=BEGIN
                             CommJnlManagement.CheckName(CurrentJnlBatchName,Rec);
                             CurrentJnlBatchNameOnAfterVali;
                           END;

                OnLookup=BEGIN
                           CurrPage.SAVERECORD;
                           CommJnlManagement.LookupName(CurrentJnlBatchName,Rec);
                           CurrPage.UPDATE(FALSE);
                         END;
                          }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 2   ;2   ;Field     ;
                SourceExpr="Posting Date";
                StyleExpr=StyleTxt }

    { 1000000001;2;Field  ;
                SourceExpr="Account Type" }

    { 1000000002;2;Field  ;
                SourceExpr="Account No." }

    { 1000000032;2;Field  ;
                SourceExpr="Account Name";
                Visible=FALSE }

    { 4   ;2   ;Field     ;
                SourceExpr="Document Type";
                StyleExpr=StyleTxt }

    { 6   ;2   ;Field     ;
                SourceExpr="Document No." }

    { 12  ;2   ;Field     ;
                SourceExpr=Description;
                StyleExpr=StyleTxt }

    { 18  ;2   ;Field     ;
                SourceExpr=Amount;
                StyleExpr=StyleTxt }

    { 1000000003;2;Field  ;
                SourceExpr="Base Amount" }

    { 1000000004;2;Field  ;
                SourceExpr="Comm./Hdlg. %";
                Visible=FALSe }

    { 1000000008;2;Field  ;
                SourceExpr="Source Document Type" }

    { 1000000009;2;Field  ;
                SourceExpr="Source Document No." }

    { 1000000010;2;Field  ;
                SourceExpr="Source Document Posting Date" }

    { 81  ;2   ;Field     ;
                SourceExpr="External Document No.";
                Visible=FALSE }

    { 1000000000;2;Field  ;
                SourceExpr="Shortcut Dimension 5 Code" }

    { 1000000011;2;Field  ;
                SourceExpr="Comment Type" }

    { 7   ;2   ;Field     ;
                SourceExpr=Comment }

    { 1000000034;2;Field  ;
                SourceExpr="Customer No." }

    { 1000000035;2;Field  ;
                SourceExpr="Customer Name" }

    { 1000000012;2;Field  ;
                CaptionML=ENU=Calcualted Comm./Hdlg. %;
                BlankZero=Yes;
                SourceExpr=CalcCommHandlRate;
                Editable=FALSE }

    { 1000000024;2;Field  ;
                SourceExpr="Reason Type" }

    { 1000000030;2;Field  ;
                SourceExpr="E-Mail Notification Handled";
                Visible=FALSE }

    { 1000000031;2;Field  ;
                SourceExpr=Invoiced;
                Visible=FALSE }

    { 1000000036;2;Field  ;
                SourceExpr="Location Code";
                Visible=FALSE }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 1900919607;1;Part   ;
                SubPageLink=Dimension Set ID=FIELD(Field480);
                PagePartID=Page699;
                Visible=FALSE;
                PartType=Page }

    { 1900383207;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      MfrRep@1000000002 : Record 50027;
      Location@1000000003 : Record 14;
      UserSetup@1000000006 : Record 91;
      CommJnlManagement@1002 : Codeunit 51706;
      ReportPrint@1003 : Codeunit 228;
      EmailMgt@1000000001 : Codeunit 14000903;
      CurrentJnlBatchName@1004 : Code[10];
      OpenedFromBatch@1014 : Boolean;
      StyleTxt@1015 : Text;
      CalcCommHandlRate@1000000000 : Decimal;
      Text51700@1000000004 : TextConst 'ENU=Do you want to create Mfr. Rep. payable documents?';
      Text51701@1000000005 : TextConst 'ENU=Do you want to create Location Handling payable documents?';
      EMailSetup@1000000007 : Record 14000905;
      TempFilename@1000000008 : Text[250];

    LOCAL PROCEDURE CurrentJnlBatchNameOnAfterVali@19002411();
    BEGIN
      CurrPage.SAVERECORD;
      CommJnlManagement.SetName(CurrentJnlBatchName,Rec);
      CurrPage.UPDATE(FALSE);
    END;

    PROCEDURE SaveReport@1240020001(ReportNo@1000000000 : Integer;VAR SaveFileName@1000000001 : Text[250]);
    BEGIN
      MfrRep.SETRECFILTER;
      IF ISSERVICETIER THEN BEGIN
        EMailSetup.ChangeFilenameToPDF(SaveFileName);
        REPORT.SAVEASPDF(ReportNo,SaveFileName,MfrRep);
      END ELSE
        REPORT.SAVEASHTML(ReportNo,SaveFileName);
    END;

    PROCEDURE SaveReportExcel@1000000000(ReportNo@1000000000 : Integer;VAR SaveFileName@1000000001 : Text[250]);
    BEGIN
      REPORT.SAVEASEXCEL(ReportNo,SaveFileName);
    END;

    BEGIN
    {
      2015-05-11 TPZ92 TAKHMETO
        Page has been created
      2015-07-30 TPZ858 TAKHMETO
        Managing commission / handling permissions has been added
      2016-01-13 TPZ1321 TAKHMETO
        Action Summary has been added
      2016-11-2 TPZ1415 EBAGIM
        Commission batch created for both Mfr Rep and Locations
    }
    END.
  }
}

