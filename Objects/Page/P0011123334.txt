OBJECT Page 11123334 SC - Items Activity
{
  OBJECT-PROPERTIES
  {
    Date=04/18/17;
    Time=[ 1:00:00 PM];
    Version List=SCW19.2.0;
  }
  PROPERTIES
  {
    CaptionML=ENU=Items Activity;
    SourceTable=Table11123330;
    SourceTableView=SORTING(Decimal Value)
                    ORDER(Descending);
    PageType=ListPart;
    SourceTableTemporary=Yes;
    OnOpenPage=BEGIN
                 GetData;
               END;

    OnAfterGetRecord=VAR
                       Item@1000 : Record 27;
                     BEGIN
                       IF Item.GET(Key) THEN
                         ItemDescription := Item.Description;
                     END;

    ActionList=ACTIONS
    {
      { 11123311;0   ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 11123310;1   ;Action    ;
                      ShortCutKey=Return;
                      CaptionML=ENU=Open;
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 30;
                      RunPageView=SORTING(No.);
                      RunPageLink=No.=FIELD(Key);
                      Image=ViewDetails;
                      RunPageMode=View }
      { 11123309;1   ;ActionGroup;
                      Name=Options;
                      CaptionML=ENU=Options;
                      Image=SelectChart }
      { 11123308;2   ;ActionGroup;
                      Name=ValueToCalculate;
                      CaptionML=ENU=Value to Calculate;
                      ActionContainerType=ActionItems;
                      Image=Calculate }
      { 11123307;3   ;Action    ;
                      Name=Amount;
                      CaptionML=ENU=Items Sold (Revenue);
                      ApplicationArea=#Basic,#Suite;
                      Enabled=EnabledAmount;
                      OnAction=BEGIN
                                 GetAmount;
                               END;
                                }
      { 11123306;3   ;Action    ;
                      Name=Quantity;
                      CaptionML=ENU=Items Sold (Quantity);
                      ApplicationArea=#Basic,#Suite;
                      Enabled=EnabledQuantity;
                      OnAction=BEGIN
                                 GetQuantity;
                               END;
                                }
      { 11123305;3   ;Action    ;
                      Name=Stock;
                      CaptionML=ENU=Items Stock Info;
                      ApplicationArea=#Basic,#Suite;
                      Enabled=EnabledStock;
                      OnAction=BEGIN
                                 GetStock;
                               END;
                                }
      { 11123304;1   ;Separator  }
      { 11123303;1   ;Action    ;
                      Name=Refresh;
                      CaptionML=ENU=Refresh;
                      ApplicationArea=#Basic,#Suite;
                      Image=Refresh;
                      OnAction=BEGIN
                                 UpdateData;
                               END;
                                }
      { 11123302;1   ;Separator  }
    }
  }
  CONTROLS
  {
    { 11123316;;Container ;
                CaptionML=ENU=Items Activity;
                ContainerType=ContentArea }

    { 11123315;1;Group    ;
                GroupType=Repeater }

    { 11123314;2;Field    ;
                CaptionML=ENU=Item No.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=Key }

    { 11123313;2;Field    ;
                CaptionML=ENU=Description;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=ItemDescription }

    { 11123312;2;Field    ;
                CaptionML=ENU=Value;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Decimal Value" }

  }
  CODE
  {
    VAR
      ItemDescription@1002 : Text;
      EnabledAmount@1000 : Boolean;
      EnabledQuantity@1001 : Boolean;
      EnabledStock@1003 : Boolean;

    LOCAL PROCEDURE GetData@1();
    VAR
      RoleCenterMgt@1000 : Codeunit 11123332;
    BEGIN
      RoleCenterMgt.GetAmountTopSoldItems(Rec);
      EnabledQuantity := TRUE;
      EnabledStock := TRUE;
    END;

    LOCAL PROCEDURE GetAmount@5();
    VAR
      RoleCenterMgt@1000 : Codeunit 11123332;
    BEGIN
      Rec.DELETEALL;
      RoleCenterMgt.GetAmountTopSoldItems(Rec);
      CurrPage.UPDATE(FALSE);

      EnabledQuantity := TRUE;
      EnabledAmount := FALSE;
      EnabledStock := TRUE;
    END;

    LOCAL PROCEDURE GetQuantity@6();
    VAR
      RoleCenterMgt@1000 : Codeunit 11123332;
    BEGIN
      Rec.DELETEALL;
      RoleCenterMgt.GetQuantityTopSoldItems(Rec);
      CurrPage.UPDATE(FALSE);

      EnabledQuantity := FALSE;
      EnabledAmount := TRUE;
      EnabledStock := TRUE;
    END;

    LOCAL PROCEDURE GetStock@3();
    VAR
      RoleCenterMgt@1000 : Codeunit 11123332;
    BEGIN
      Rec.DELETEALL;
      RoleCenterMgt.GetItemsStockInfo(Rec);
      CurrPage.UPDATE(FALSE);

      EnabledQuantity := TRUE;
      EnabledAmount := TRUE;
      EnabledStock := FALSE;
    END;

    LOCAL PROCEDURE UpdateData@2();
    BEGIN
      IF NOT EnabledAmount THEN
        GetAmount;

      IF NOT EnabledQuantity THEN
        GetQuantity;

      IF NOT EnabledStock THEN
        GetStock;
    END;

    BEGIN
    END.
  }
}

