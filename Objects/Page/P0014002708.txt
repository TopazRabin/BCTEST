OBJECT Page 14002708 Usage Redirects
{
  OBJECT-PROPERTIES
  {
    Date=07/01/18;
    Time=12:00:00 PM;
    Version List=UBP2.99;
  }
  PROPERTIES
  {
    CaptionML=ENU=Usage Redirects;
    InsertAllowed=No;
    DeleteAllowed=No;
    SourceTable=Table14000575;
    DataCaptionFields=Location Code,Item No.,Variant Code,Customer No.,Redirect Location Code,Redirect Item No.,Redirect Variant Code,Redirect Customer No.;
    PageType=List;
    SourceTableTemporary=Yes;
    OnAfterGetRecord=BEGIN
                       IF "Error Found" THEN
                         ErrorStyle := UnfavorableStyle
                       ELSE
                         ErrorStyle := DefaultStyle;
                     END;

    OnModifyRecord=BEGIN
                     ModifyUsageRedirect(Rec);
                   END;

  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1240030000;1;Group  ;
                GroupType=Repeater }

    { 2   ;2   ;Field     ;
                SourceExpr=Level;
                Visible=FALSE }

    { 1240030001;2;Field  ;
                SourceExpr="Location Code";
                Editable=FALSE }

    { 1   ;2   ;Field     ;
                SourceExpr="Item No.";
                Editable=FALSE;
                StyleExpr=ErrorStyle }

    { 1240030003;2;Field  ;
                SourceExpr="Variant Code";
                Editable=FALSE }

    { 1240030005;2;Field  ;
                SourceExpr="Customer No." }

    { 1240030007;2;Field  ;
                SourceExpr="Redirect Location Code" }

    { 1240030009;2;Field  ;
                SourceExpr="Redirect Item No.";
                StyleExpr=ErrorStyle }

    { 1240030011;2;Field  ;
                SourceExpr="Redirect Variant Code";
                Visible=FALSE }

    { 1240030013;2;Field  ;
                SourceExpr="Redirect Customer No." }

    { 1240030020;2;Field  ;
                SourceExpr="Change Pending";
                Editable=FALSE }

    { 1240020000;2;Field  ;
                SourceExpr="Delete Pending" }

    { 1240030018;2;Field  ;
                SourceExpr="Delete Redirect" }

    { 6   ;2   ;Field     ;
                SourceExpr="Error Found" }

  }
  CODE
  {
    VAR
      DefaultStyle@1000 : TextConst 'ENU=Standard';
      UnfavorableStyle@1001 : TextConst 'ENU=Unfavorable';
      ErrorStyle@1002 : Text[20];

    LOCAL PROCEDURE ModifyUsageRedirect@2(VAR CurrUsageRedirect@1000 : Record 14000575);
    VAR
      UsageRedirect@1001 : Record 14000575;
    BEGIN
      IF UsageRedirect.GET(CurrUsageRedirect."Item No.", CurrUsageRedirect."Location Code", CurrUsageRedirect."Variant Code", CurrUsageRedirect."Customer No.") THEN BEGIN
        UsageRedirect."Redirect Item No." :=  CurrUsageRedirect."Redirect Item No.";
        UsageRedirect."Redirect Location Code" := CurrUsageRedirect."Redirect Location Code";
        UsageRedirect."Redirect Variant Code" := CurrUsageRedirect."Redirect Variant Code";
        UsageRedirect."Redirect Customer No." := CurrUsageRedirect."Redirect Customer No.";
        UsageRedirect."Delete Redirect" := CurrUsageRedirect."Delete Redirect";
        UsageRedirect."Delete Pending" := UsageRedirect."Delete Redirect";
        // change is updated in modify trigger if delete is off
        //UsageRedirect."Change Pending" := CurrUsageREdirect."Change Pending";
        UsageRedirect.MODIFY(TRUE);
      END;
    END;

    BEGIN
    END.
  }
}

