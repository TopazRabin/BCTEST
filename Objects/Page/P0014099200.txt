OBJECT Page 14099200 Inbound ASN
{
  OBJECT-PROPERTIES
  {
    Date=02/18/21;
    Time=[ 7:31:49 AM];
    Modified=Yes;
    Version List=IBA1.11,001;
  }
  PROPERTIES
  {
    CaptionML=ENU=Inbound ASN;
    SourceTable=Table14099200;
    PageType=Document;
    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 1240020038;1 ;ActionGroup;
                      CaptionML=ENU=&ASN }
      { 1240020048;2 ;Action    ;
                      CaptionML=ENU=&Comments;
                      RunObject=Page 14099208;
                      RunPageView=SORTING(No.,Attached to Line No.,Line No.);
                      RunPageLink=No.=FIELD(ASN No.);
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=ViewComments;
                      PromotedCategory=Process }
      { 1240020049;2 ;Action    ;
                      ShortCutKey=F7;
                      CaptionML=ENU=&Statistics;
                      RunObject=Page 14099209;
                      RunPageView=SORTING(ASN No.);
                      RunPageLink=ASN No.=FIELD(ASN No.);
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Statistics;
                      PromotedCategory=Process }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1240020036;1 ;ActionGroup;
                      CaptionML=ENU=F&unctions }
      { 1240020039;2 ;Action    ;
                      CaptionML=ENU=Get Purchase Order;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=GetLines;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 TESTFIELD("ASN No.");
                                 ASNPost.GetPurchaseOrder("ASN No.");
                               END;
                                }
      { 1240020046;1 ;ActionGroup;
                      CaptionML=ENU=&Posting }
      { 1240020047;2 ;Action    ;
                      ShortCutKey=F9;
                      CaptionML=ENU=&Post ASN;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Post;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 //<TPZ2524>
                                 ValidateItemDuplicates;
                                 //</TPZ2524>
                                 IF CONFIRM(Text001,FALSE) THEN BEGIN
                                   //>>001 TPZ2911
                                   MatchCostValue();
                                   //<<001 TPZ2911
                                   CLEAR(ASNPost);
                                   ASNPost.PostInboundASN("ASN No.");
                                 END;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1240020000;1;Group  ;
                CaptionML=ENU=General }

    { 1240020001;2;Field  ;
                SourceExpr="ASN No." }

    { 1240020025;2;Field  ;
                SourceExpr="Vessel Number" }

    { 1240020051;2;Field  ;
                SourceExpr="Booking Number" }

    { 1240020055;2;Field  ;
                SourceExpr="Bill of Lading Number" }

    { 1240020059;2;Field  ;
                SourceExpr="Declared Value (LCY)" }

    { 1240020057;2;Field  ;
                SourceExpr="Container Group Number";
                Importance=Additional }

    { 1240020003;2;Field  ;
                SourceExpr="Ship From";
                Importance=Additional }

    { 1240020005;2;Field  ;
                SourceExpr="Ship From Address 1";
                Importance=Additional }

    { 1240020007;2;Field  ;
                SourceExpr="Ship From Address 2";
                Importance=Additional }

    { 1240020009;2;Field  ;
                SourceExpr="Ship From City";
                Importance=Additional }

    { 1240020011;2;Field  ;
                CaptionML=ENU=State/Zip Code;
                SourceExpr="Ship From State";
                Importance=Additional }

    { 1240020013;2;Field  ;
                SourceExpr="Ship From Postal Code";
                Importance=Additional }

    { 1240020015;2;Field  ;
                SourceExpr="Ship From Country";
                Importance=Additional }

    { 1240020017;2;Field  ;
                SourceExpr="Shipping Agent";
                Importance=Promoted }

    { 1240020061;2;Field  ;
                SourceExpr="Shipment Method Code";
                Importance=Promoted }

    { 1240020026;2;Field  ;
                SourceExpr="Posting Date" }

    { 1240020019;2;Field  ;
                SourceExpr="Transfer Shipment Date" }

    { 1240020021;2;Field  ;
                SourceExpr="Transfer Receipt Date";
                Importance=Promoted }

    { 1240020023;2;Field  ;
                SourceExpr="On The Water Location" }

    { 1240020052;2;Field  ;
                SourceExpr="Inbound Container Number";
                Importance=Promoted }

    { 1240020063;2;Field  ;
                SourceExpr="Group by Purchase Order" }

    { 1240020027;2;Field  ;
                SourceExpr=Status;
                Importance=Promoted }

    { 1240020014;1;Part   ;
                Name=InboundASNLines;
                SubPageView=SORTING(ASN No.)
                            ORDER(Ascending);
                SubPageLink=ASN No.=FIELD(ASN No.);
                PagePartID=Page14099201 }

    { 1905396001;1;Group  ;
                CaptionML=ENU=EDI }

    { 1240020029;2;Field  ;
                SourceExpr="Doc. Received Date" }

    { 1240020031;2;Field  ;
                SourceExpr="Doc. Received Time" }

    { 1240020033;2;Field  ;
                SourceExpr="EDI Internal Doc. No." }

  }
  CODE
  {
    VAR
      PurchaseHeader@1240020000 : Record 38;
      PurchaseReceiptHeader@1240020003 : Record 120;
      TransferHeader@1240020002 : Record 5740;
      ASNPost@1240020001 : Codeunit 14099200;
      Text001@1240020004 : TextConst 'ENU=Post ASN';

    LOCAL PROCEDURE MatchCostValue@1000000000();
    VAR
      InboundASNLine@1000000000 : Record 14099201;
      PurchaseLine@1000000001 : Record 39;
      TEXT003@1000000002 : TextConst 'ENU=Unit Cost mismatch between ASN Line and Purchase Order Line for Item %1, Line No. %2. Please fix it to post ASN.';
    BEGIN
      //>>001 TPZ2911
      InboundASNLine.SETRANGE("ASN No.","ASN No.");
      IF InboundASNLine.FINDSET THEN
      REPEAT
        PurchaseLine.RESET;
        PurchaseLine.SETRANGE("Document No.",InboundASNLine."Purchase Order No.");
        PurchaseLine.SETRANGE("No.",InboundASNLine."Item No.");
        PurchaseLine.SETRANGE("Line No.",InboundASNLine."Purchase Order Line No.");
        IF PurchaseLine.FINDFIRST THEN
          IF PurchaseLine."Unit Cost (LCY)" <> InboundASNLine."Imported Unit Cost" THEN
            ERROR(TEXT003,InboundASNLine."Item No.",InboundASNLine."Purchase Order Line No.");
      UNTIL InboundASNLine.NEXT = 0;
      //<<001 TPZ2911
    END;

    BEGIN
    {
      2019-06-12 VSO2524 VAHAMAD
        New Code added on PostASN Button
      001 TPZ2911 RPS 08/26/2020 - Add validation for ASN Manifest upload |Procurement
    }
    END.
  }
}

