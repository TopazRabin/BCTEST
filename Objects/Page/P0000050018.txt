OBJECT Page 50018 Stock Status Document Wksh.
{
  OBJECT-PROPERTIES
  {
    Date=10/22/20;
    Time=[ 4:57:39 AM];
    Modified=Yes;
    Version List=TOP170,010B,010C,010D,010E;
  }
  PROPERTIES
  {
    InsertAllowed=No;
    DeleteAllowed=No;
    SourceTable=Table50000;
    SourceTableView=SORTING(Blocked Sequence)
                    ORDER(Ascending);
    PageType=Worksheet;
    OnOpenPage=BEGIN

                 UserSetup.GET(USERID);
                 CompanyInformation.GET;

                 IF LocationCode = '' THEN BEGIN
                   IF CustDiv.GET(CustNo,DivisionCodeFilter) THEN BEGIN
                     IF (CustDiv."Location Code" <> '') THEN
                       LocationCode := CustDiv."Location Code"
                     ELSE
                       LocationCode := CompanyInformation."Location Code";
                   END;
                 END;
                 RefreshLines;
                 ;ESACC_EasySecurity(TRUE);
               END;

    OnClosePage=BEGIN
                  //TOP010D KT ABCSI SSQQ Unit Price 07152015
                  QuickQuoteWorkSheet.RESET;
                  QuickQuoteWorkSheet.SETCURRENTKEY("Location Code",Description,"Item No.","Sell-To Customer No.");
                  QuickQuoteWorkSheet.SETFILTER("Current Qty.",'<>%1',0);
                  QuickQuoteWorkSheet.SETFILTER("Lost Opportunity",'%1',FALSE);
                  IF QuickQuoteWorkSheet.FINDFIRST THEN
                    IF CONFIRM(Text00004,TRUE,FORMAT(DocumentType),DocumentNo) THEN
                     BEGIN
                        IF DocumentType = 0 THEN
                          NewOrderQuote(0,DocumentNo)
                        ELSE
                          NewOrderQuote(1,DocumentNo);
                     END;
                  //TOP010D KT ABCSI SSQQ Unit Price 07152015
                END;

    OnAfterGetRecord=BEGIN

                       CLEAR("Reason Code");
                       CLEAR("Reason Code Comment");
                       CLEAR("Lost Opportunity");
                       CLEAR("Lost Opportunity Description");  //TOP230 KT ABCSI CRP 2 Fixes 06092015
                       CLEAR("Last Reason Code");
                       CLEAR("Last Reason Code Comment");
                       CLEAR("Last Lost Opportunity");

                       //TOP010D KT ABCSI SSQQ Unit Price 07142015
                       CLEAR("Recomm. Unit Price");
                       CLEAR("Last Unit Price");
                       CLEAR("Last Price UOM");
                       CLEAR("Last Price Qty.");
                       CLEAR("Last Price Date");
                       //TOP010D KT ABCSI SSQQ Unit Price 07142015

                       UpdateLine;

                       CALCFIELDS("Cust. Qty. on SO", "Qty. on Sales Order");
                     END;

    OnAfterGetCurrRecord=BEGIN
                           UpdateLine;
                           CALCFIELDS("Cust. Qty. on SO", "Qty. on Sales Order");
                         END;

    ActionList=ACTIONS
    {
      { 1000000060;  ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1000000062;1 ;ActionGroup;
                      CaptionML=ENU=Process;
                      ActionContainerType=HomeItems;
                      Image=RefreshLines }
      { 1000000061;2 ;Action    ;
                      Name=Add to Document;
                      Promoted=Yes;
                      Visible=ESACC_C1000000061_Visible;
                      Enabled=ESACC_C1000000061_Enabled;
                      Image=Add;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 IF DocumentType = 0 THEN
                                   NewOrderQuote(0,DocumentNo)
                                 ELSE
                                   NewOrderQuote(1,DocumentNo);
                               END;
                                }
      { 1000000065;2 ;Action    ;
                      Name=Go Home;
                      ShortCutKey=F12;
                      Visible=ESACC_C1000000065_Visible;
                      Enabled=ESACC_C1000000065_Enabled;
                      Image=MoveUp;
                      OnAction=BEGIN
                                 FINDFIRST; //TOP010D KT ABCSI SSQQ Unit Price 07142015
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1000000000;0;Container;
                ContainerType=ContentArea }

    { 1000000063;1;Group  ;
                CaptionML=ENU=General;
                GroupType=Group }

    { 1000000059;2;Field  ;
                Name=CustNo;
                CaptionML=ENU=Customer No.;
                SourceExpr=CustNo;
                Editable=FALSE }

    { 1000000058;2;Field  ;
                Name=DocumentType;
                CaptionML=ENU=Document Type;
                SourceExpr=DocumentType;
                Editable=FALSE;
                QuickEntry=FALSE }

    { 1000000057;2;Field  ;
                Name=LocationCode;
                CaptionML=ENU=Location Code;
                SourceExpr=LocationCode;
                Editable=FALSE;
                Style=Standard;
                StyleExpr=TRUE;
                OnValidate=BEGIN
                             CustDiv.RESET;
                             CustDiv.SETRANGE("Customer No.",CustNo);
                             CustDiv.SETRANGE("Location Code",LocationCode);
                             CustDiv.FINDFIRST;
                             RefreshLines;
                           END;

                OnLookup=BEGIN
                           GLSetup.GET;
                           IF GLSetup."Shortcut Dimension 5 Code" = '' THEN
                             ERROR(ab005,GLSetup.TABLECAPTION);

                           CustDiv.RESET;
                           CustDiv.SETRANGE("Customer No.",CustNo);
                           IF PAGE.RUNMODAL(50007,CustDiv) = ACTION::LookupOK THEN BEGIN
                             LocationCode := CustDiv."Location Code"
                           END;
                           RefreshLines
                         END;

                QuickEntry=FALSE }

    { 1000000056;2;Field  ;
                Name=CustName;
                CaptionML=ENU=Customer Name;
                SourceExpr=CustName;
                Editable=FALSE;
                QuickEntry=FALSE }

    { 1000000055;2;Field  ;
                Name=DocumentNo;
                CaptionML=ENU=Document No.;
                SourceExpr=DocumentNo;
                Editable=FALSE;
                QuickEntry=FALSE }

    { 1000000054;2;Field  ;
                Name=Division Code Filter;
                SourceExpr=DivisionCodeFilter;
                Editable=FALSE;
                QuickEntry=FALSE }

    { 1000000066;2;Group  ;
                CaptionML=ENU=Item;
                GroupType=Group }

    { 1000000064;3;Field  ;
                Name=ItemNoFilter;
                CaptionML=ENU=Item No. Filter;
                SourceExpr=ItemNoFilter;
                OnValidate=BEGIN
                             //TOP10C KT ABCSI - SSQQ Item Search 07082015
                             FindItemNo(ItemNoFilter);
                             UserUpdate;
                             //TOP10C KT ABCSI - SSQQ Item Search 07082015
                           END;
                            }

    { 1000000067;2;Field  ;
                Name=VendItemNoFilter;
                CaptionML=ENU=Vendor Item No. Filter;
                SourceExpr=VendItemNoFilter;
                OnValidate=BEGIN
                             //TOP10E KT ABCSI - Additional Stock Status 07282015
                             FindVendItemNo(VendItemNoFilter);
                             UserUpdate;
                             //TOP10E KT ABCSI - Additional Stock Status 07282015
                           END;
                            }

    { 1000000001;1;Group  ;
                Name=Group;
                GroupType=Repeater }

    { 1000000048;2;Field  ;
                SourceExpr=Blocked;
                Visible=ESACC_F54_Visible;
                Editable=FALSE;
                HideValue=ESACC_F54_HideValue }

    { 1000000051;2;Field  ;
                SourceExpr="Blocked Sequence";
                Visible=ESACC_F50040_Visible;
                Editable=FALSE;
                HideValue=ESACC_F50040_HideValue }

    { 1000000049;2;Field  ;
                SourceExpr="Shortcut Dimension 5 Code";
                Visible=ESACC_F50100_Visible;
                Enabled=ESACC_F50100_Editable;
                Editable=FALSE;
                HideValue=ESACC_F50100_HideValue }

    { 1000000002;2;Field  ;
                SourceExpr="Item No.";
                Visible=ESACC_F6_Visible;
                Editable=FALSE;
                HideValue=ESACC_F6_HideValue }

    { 1000000003;2;Field  ;
                SourceExpr=Description;
                Visible=ESACC_F11_Visible;
                Editable=FALSE;
                HideValue=ESACC_F11_HideValue }

    { 1000000004;2;Field  ;
                SourceExpr="Description 2";
                Visible=ESACC_F12_Visible;
                Editable=FALSE;
                HideValue=ESACC_F12_HideValue }

    { 1000000043;2;Field  ;
                SourceExpr="Base Unit of Measure";
                Visible=ESACC_F8_Visible;
                Editable=FALSE;
                HideValue=ESACC_F8_HideValue }

    { 1000000017;2;Field  ;
                SourceExpr="Item Category Code";
                Visible=ESACC_F5709_Visible;
                Editable=FALSE;
                HideValue=ESACC_F5709_HideValue }

    { 1000000041;2;Field  ;
                SourceExpr="Product Group Code";
                Visible=ESACC_F5712_Visible;
                Editable=FALSE;
                HideValue=ESACC_F5712_HideValue }

    { 1000000008;2;Field  ;
                SourceExpr="Country/Region of Origin Code";
                Visible=ESACC_F95_Visible;
                Editable=FALSE;
                HideValue=ESACC_F95_HideValue }

    { 1000000009;2;Field  ;
                SourceExpr="Manufacturer Code";
                Visible=ESACC_F5701_Visible;
                Editable=FALSE;
                HideValue=ESACC_F5701_HideValue }

    { 1000000006;2;Field  ;
                SourceExpr="Quantity Available on Location";
                Visible=ESACC_F50000_Visible;
                Editable=FALSE;
                HideValue=ESACC_F50000_HideValue }

    { 1000000007;2;Field  ;
                SourceExpr="Main Loc. Qty. Avail";
                Visible=ESACC_F50001_Visible;
                Editable=FALSE;
                HideValue=ESACC_F50001_HideValue }

    { 1000000005;2;Field  ;
                SourceExpr="Order Date";
                Visible=ESACC_F19_Visible;
                Editable=ESACC_F19_Editable;
                HideValue=ESACC_F19_HideValue }

    { 1000000014;2;Field  ;
                SourceExpr="Location Code";
                Visible=ESACC_F7_Visible;
                Editable=ESACC_F7_Editable;
                HideValue=ESACC_F7_HideValue;
                OnValidate=VAR
                             Count@1000000000 : Integer;
                           BEGIN
                             IF (Blocked = TRUE) THEN //TPZ2785
                               FIELDERROR(Blocked);

                             IF "Location Code" <> xRec."Location Code" THEN BEGIN
                               CLEAR(Count);
                               QuickQuoteWorkSheet.RESET;
                               IF QuickQuoteWorkSheet.FIND('-') THEN REPEAT
                                 IF QuickQuoteWorkSheet."Item No." = "Item No." THEN Count += 1;
                               UNTIL QuickQuoteWorkSheet.NEXT = 0;
                               IF Count = 1 THEN BEGIN
                                 QuickQuoteWorkSheet.RESET;
                                 QuickQuoteWorkSheet.SETCURRENTKEY("Item No.",Description);
                                 QuickQuoteWorkSheet.SETRANGE("Item No.","Item No.");
                                 IF QuickQuoteWorkSheet.FIND('-') THEN BEGIN
                                   QuickQuoteWorkSheet."Location Code" := "Location Code";
                                   QuickQuoteWorkSheet.MODIFY;
                                 END;
                               END;
                             END;

                             UpdateSingleLine("Location Code");
                           END;
                            }

    { 1000000037;2;Field  ;
                SourceExpr="Current Qty.";
                Visible=ESACC_F50005_Visible;
                Editable=ESACC_F50005_Editable;
                HideValue=ESACC_F50005_HideValue;
                OnValidate=BEGIN
                             IF (Blocked = TRUE) THEN//TPZ2785
                               FIELDERROR(Blocked);


                             IF "Current Qty." <> 0 THEN
                               BEGIN
                                 UpdateLastSalesPrice(Rec);
                                 FetchRecommFieldValues("Item No.",InCustFilter); //TOP230 KT ABCSI CRP 2 Fixes 05282015
                                 IF NOT StockStatusQuickQuote.GET("Item No.") THEN
                                   BEGIN
                                     StockStatusQuickQuote.INIT;
                                     StockStatusQuickQuote.TRANSFERFIELDS(Rec);
                                     StockStatusQuickQuote."Sell-to Customer No." := InCustFilter;
                                     StockStatusQuickQuote."Location Code" := "Location Code";
                                     StockStatusQuickQuote."Unit Price" := "Unit Price";
                                     StockStatusQuickQuote."Recomm. Unit Price" := "Recomm. Unit Price"; //TOP230 KT ABCSI CRP 2 Fixes 05282015
                                     StockStatusQuickQuote."Current Qty." := "Current Qty.";
                                     StockStatusQuickQuote."Current UOM" := "Current UOM";
                                     StockStatusQuickQuote.INSERT;
                                     QuickQuoteWorkSheet.TRANSFERFIELDS(StockStatusQuickQuote);
                                     LineNo += 1;
                                     QuickQuoteWorkSheet."Line No." := LineNo;
                                     IF ItemUOM.GET("Item No.","Current UOM") THEN
                                       QuickQuoteWorkSheet."Qty per Unit of Measure" := ItemUOM."Qty. per Unit of Measure"
                                     ELSE QuickQuoteWorkSheet."Qty per Unit of Measure" := 1;
                                     QuickQuoteWorkSheet."Current Qty (Base)" := QuickQuoteWorkSheet."Qty per Unit of Measure" * "Current Qty.";
                                     QuickQuoteWorkSheet.INSERT;
                                     //LineNo := LineNo +1;
                                   END
                                 ELSE
                                   BEGIN
                                     StockStatusQuickQuote."Current Qty." := "Current Qty.";
                                     StockStatusQuickQuote."Recomm. Unit Price" := "Recomm. Unit Price"; //TOP230 KT ABCSI CRP 2 Fixes 05282015
                                     StockStatusQuickQuote.MODIFY;
                                     QuickQuoteWorkSheet.RESET;
                                     QuickQuoteWorkSheet.SETRANGE("Item No.","Item No.");
                                     IF QuickQuoteWorkSheet.FIND('+') THEN BEGIN
                                       OldLineNo := QuickQuoteWorkSheet."Line No.";
                                       //LineNo := QuickQuoteWorkSheet."Line No." + 1;
                                     END ELSE BEGIN
                                       QuickQuoteWorkSheet.RESET;
                                       IF QuickQuoteWorkSheet.FIND('+') THEN LineNo := QuickQuoteWorkSheet."Line No.";
                                       OldLineNo := LineNo;
                                       LineNo := LineNo + 1;
                                     END;
                                     QuickQuoteWorkSheet.TRANSFERFIELDS(StockStatusQuickQuote);
                                     QuickQuoteWorkSheet."Line No." := OldLineNo;
                                     IF ItemUOM.GET("Item No.","Current UOM") THEN
                                       QuickQuoteWorkSheet."Qty per Unit of Measure" := ItemUOM."Qty. per Unit of Measure"
                                     ELSE QuickQuoteWorkSheet."Qty per Unit of Measure" := 1;
                                     QuickQuoteWorkSheet."Current Qty (Base)" := QuickQuoteWorkSheet."Qty per Unit of Measure" * "Current Qty.";
                                     QuickQuoteWorkSheet."Promotion Code" := "Promotion Code";
                                     QuickQuoteWorkSheet.MODIFY;
                                   END;
                               END ELSE
                                 IF StockStatusQuickQuote.GET("Item No.") THEN
                                   IF xRec."Current Qty." <> 0 THEN BEGIN
                                     StockStatusQuickQuote."Current Qty." := "Current Qty.";
                                     StockStatusQuickQuote.MODIFY;
                                     QuickQuoteWorkSheet.RESET;
                                     QuickQuoteWorkSheet.SETRANGE("Item No.","Item No.");
                                     IF QuickQuoteWorkSheet.FIND('+') THEN BEGIN
                                        OldLineNo := QuickQuoteWorkSheet."Line No.";
                                        //LineNo := QuickQuoteWorkSheet."Line No." + 1;
                                     END ELSE BEGIN
                                        QuickQuoteWorkSheet.RESET;
                                        IF QuickQuoteWorkSheet.FIND('+') THEN LineNo := QuickQuoteWorkSheet."Line No.";
                                        OldLineNo := LineNo;
                                        LineNo := LineNo + 1;
                                     END;
                                     QuickQuoteWorkSheet.TRANSFERFIELDS(StockStatusQuickQuote);
                                     QuickQuoteWorkSheet."Line No." := OldLineNo;
                                     IF ItemUOM.GET("Item No.","Current UOM") THEN
                                       QuickQuoteWorkSheet."Qty per Unit of Measure" := ItemUOM."Qty. per Unit of Measure"
                                     ELSE QuickQuoteWorkSheet."Qty per Unit of Measure" := 1;
                                     QuickQuoteWorkSheet."Current Qty (Base)" := QuickQuoteWorkSheet."Qty per Unit of Measure" * "Current Qty.";
                                     QuickQuoteWorkSheet."Promotion Code" := "Promotion Code";
                                     QuickQuoteWorkSheet.MODIFY;
                                   END;
                           END;
                            }

    { 1000000011;2;Field  ;
                SourceExpr="Unit Price";
                Visible=ESACC_F22_Visible;
                Editable=ESACC_F22_Editable;
                HideValue=ESACC_F22_HideValue;
                OnValidate=BEGIN
                             IF (Blocked = TRUE) THEN //TPZ2785
                               FIELDERROR(Blocked);

                             IF "Unit Price" <> 0 THEN
                               BEGIN
                                 UpdateLastSalesPrice(Rec);
                                 IF NOT StockStatusQuickQuote.GET("Item No.") THEN
                                   BEGIN
                                     StockStatusQuickQuote.INIT;
                                     StockStatusQuickQuote.TRANSFERFIELDS(Rec);
                                     StockStatusQuickQuote."Sell-to Customer No." := InCustFilter;
                                     StockStatusQuickQuote."Location Code" := "Location Code";
                                     StockStatusQuickQuote."Unit Price" := "Unit Price";
                                     StockStatusQuickQuote."Current Qty." := "Current Qty.";
                                     StockStatusQuickQuote."Current UOM" := "Current UOM";
                                     StockStatusQuickQuote.INSERT;
                                     QuickQuoteWorkSheet.TRANSFERFIELDS(StockStatusQuickQuote);
                                     LineNo += 1;
                                     QuickQuoteWorkSheet."Line No." := LineNo;
                                     //LineNo := LineNo + 1;
                                     IF ItemUOM.GET("Item No.","Current UOM") THEN
                                       QuickQuoteWorkSheet."Qty per Unit of Measure" := ItemUOM."Qty. per Unit of Measure"
                                     ELSE QuickQuoteWorkSheet."Qty per Unit of Measure" := 1;
                                     QuickQuoteWorkSheet."Current Qty (Base)" := QuickQuoteWorkSheet."Qty per Unit of Measure" * "Current Qty.";
                                     QuickQuoteWorkSheet.INSERT;
                                   END
                                 ELSE
                                   BEGIN
                                     StockStatusQuickQuote."Sell-to Customer No." := InCustFilter;
                                     StockStatusQuickQuote."Unit Price" := "Unit Price";
                                     StockStatusQuickQuote.MODIFY;
                                     QuickQuoteWorkSheet.RESET;
                                     QuickQuoteWorkSheet.SETRANGE("Item No.","Item No.");
                                     IF QuickQuoteWorkSheet.FIND('+') THEN BEGIN
                                        OldLineNo := QuickQuoteWorkSheet."Line No.";
                                        //LineNo := QuickQuoteWorkSheet."Line No." + 1;
                                     END ELSE BEGIN
                                       QuickQuoteWorkSheet.RESET;
                                       IF QuickQuoteWorkSheet.FIND('+') THEN LineNo := QuickQuoteWorkSheet."Line No.";
                                        OldLineNo := LineNo;
                                        LineNo := LineNo + 1;
                                     END;
                                     QuickQuoteWorkSheet.TRANSFERFIELDS(StockStatusQuickQuote);
                                     QuickQuoteWorkSheet."Line No." := OldLineNo;
                                     IF ItemUOM.GET("Item No.","Current UOM") THEN
                                       QuickQuoteWorkSheet."Qty per Unit of Measure" := ItemUOM."Qty. per Unit of Measure"
                                     ELSE QuickQuoteWorkSheet."Qty per Unit of Measure" := 1;
                                     QuickQuoteWorkSheet."Current Qty (Base)" := QuickQuoteWorkSheet."Qty per Unit of Measure" * "Current Qty.";
                                     QuickQuoteWorkSheet.MODIFY;
                                   END;
                               END ELSE
                                 IF StockStatusQuickQuote.GET("Item No.") THEN
                                   IF xRec."Current Qty." <> 0 THEN BEGIN
                                     StockStatusQuickQuote."Current Qty." := "Current Qty.";
                                     StockStatusQuickQuote.MODIFY;
                                     QuickQuoteWorkSheet.RESET;
                                     QuickQuoteWorkSheet.SETRANGE("Item No.","Item No.");
                                     IF QuickQuoteWorkSheet.FIND('+') THEN BEGIN
                                        OldLineNo := QuickQuoteWorkSheet."Line No.";
                                        //LineNo := QuickQuoteWorkSheet."Line No." + 1;
                                     END ELSE BEGIN
                                       QuickQuoteWorkSheet.RESET;
                                       IF QuickQuoteWorkSheet.FIND('+') THEN LineNo := QuickQuoteWorkSheet."Line No.";
                                       OldLineNo := LineNo;
                                       LineNo := LineNo + 1;
                                     END;
                                     QuickQuoteWorkSheet.TRANSFERFIELDS(StockStatusQuickQuote);
                                     IF Customer."Location Code" <> StockStatusQuickQuote."Location Code" THEN BEGIN
                                       WLoc.GET(StockStatusQuickQuote."Location Code");
                                       //QuickQuoteWorkSheet."Location Code" := WLoc."Location Code";
                                     END;
                                     QuickQuoteWorkSheet."Line No." := OldLineNo;
                                     IF ItemUOM.GET("Item No.","Current UOM") THEN
                                       QuickQuoteWorkSheet."Qty per Unit of Measure" := ItemUOM."Qty. per Unit of Measure"
                                     ELSE QuickQuoteWorkSheet."Qty per Unit of Measure" := 1;
                                     QuickQuoteWorkSheet."Current Qty (Base)" := QuickQuoteWorkSheet."Qty per Unit of Measure" * "Current Qty.";
                                     QuickQuoteWorkSheet.MODIFY;
                                   END;
                           END;
                            }

    { 1000000052;2;Field  ;
                SourceExpr="Recomm. Unit Price";
                Visible=ESACC_F50202_Visible;
                Editable=FALSE;
                HideValue=ESACC_F50202_HideValue }

    { 1000000013;2;Field  ;
                SourceExpr="Current UOM";
                Visible=ESACC_F50006_Visible;
                Editable=ESACC_F50006_Editable;
                HideValue=ESACC_F50006_HideValue;
                OnValidate=BEGIN

                             IF "Current UOM" <> '' THEN
                               BEGIN
                                 IF (CompanyInformation."Location Code" <> '') AND (Item3.GET("Item No.")) AND
                                    ("Current UOM" <> xRec."Current UOM") THEN BEGIN
                                   Item3.SETFILTER("Location Filter",CompanyInformation."Location Code");
                                   Item3.CALCFIELDS(Inventory,"Qty. on Sales Order");
                                   "Main Loc. Qty. Avail" := (Item3.Inventory - Item3."Qty. on Sales Order") / QtyPerUOM;
                                 END;
                                 IF Item.GET("Item No.") THEN
                                   BEGIN
                                     QtyPerUOM := UOMMgt.GetQtyPerUnitOfMeasure(Item,"Current UOM");
                                     //Item.SETFILTER("Location Filter",StockStatusQuickQuote.Location);
                                     Item.SETRANGE("Location Filter","Location Code");
                                     Item.CALCFIELDS(Inventory,"Qty. on Sales Order","Qty. on Purch. Order");
                                     "Quantity Available on Location" := (Item.Inventory - Item."Qty. on Sales Order") / QtyPerUOM;
                                     "Qty. on Hand" := Item.Inventory / QtyPerUOM;
                                     "Qty. on Purch. Order" := Item."Qty. on Purch. Order" / QtyPerUOM;
                                   END;
                                 IF "Unit Price" <> 0 THEN
                                   UpdateLastSalesPrice(Rec);

                                 IF NOT StockStatusQuickQuote.GET("Item No.") THEN
                                   BEGIN
                                     StockStatusQuickQuote.INIT;
                                     StockStatusQuickQuote.TRANSFERFIELDS(Rec);
                                     StockStatusQuickQuote."Sell-to Customer No." := InCustFilter;
                                     StockStatusQuickQuote."Location Code" := "Location Code";
                                     StockStatusQuickQuote."Unit Price" := "Unit Price";
                                     StockStatusQuickQuote."Current Qty." := "Current Qty.";
                                     StockStatusQuickQuote."Current UOM" := "Current UOM";
                                     StockStatusQuickQuote.INSERT;
                                     QuickQuoteWorkSheet.TRANSFERFIELDS(StockStatusQuickQuote);
                                     LineNo += 1;
                                     QuickQuoteWorkSheet."Line No." := LineNo;
                                     IF ItemUOM.GET("Item No.","Current UOM") THEN
                                       QuickQuoteWorkSheet."Qty per Unit of Measure" := ItemUOM."Qty. per Unit of Measure"
                                     ELSE QuickQuoteWorkSheet."Qty per Unit of Measure" := 1;
                                     QuickQuoteWorkSheet."Current Qty (Base)" := QuickQuoteWorkSheet."Qty per Unit of Measure" * "Current Qty.";
                                     QuickQuoteWorkSheet."Promotion Code" := "Promotion Code";
                                     QuickQuoteWorkSheet.INSERT;
                                     //LineNo := LineNo + 1;
                                   END
                                 ELSE
                                   BEGIN
                                     StockStatusQuickQuote."Current UOM" := "Current UOM";
                                     StockStatusQuickQuote.MODIFY;
                                     QuickQuoteWorkSheet.RESET;
                                     QuickQuoteWorkSheet.SETRANGE("Item No.","Item No.");
                                     IF QuickQuoteWorkSheet.FIND('+') THEN BEGIN
                                        OldLineNo := QuickQuoteWorkSheet."Line No.";
                                        //LineNo := QuickQuoteWorkSheet."Line No." + 1;
                                     END ELSE BEGIN
                                       QuickQuoteWorkSheet.RESET;
                                       IF QuickQuoteWorkSheet.FIND('+') THEN LineNo := QuickQuoteWorkSheet."Line No.";
                                       OldLineNo := LineNo;
                                       LineNo := QuickQuoteWorkSheet."Line No." + 1;
                                     END;
                                     QuickQuoteWorkSheet.TRANSFERFIELDS(StockStatusQuickQuote);
                                     IF ItemUOM.GET("Item No.","Current UOM") THEN
                                       QuickQuoteWorkSheet."Qty per Unit of Measure" := ItemUOM."Qty. per Unit of Measure"
                                     ELSE QuickQuoteWorkSheet."Qty per Unit of Measure" := 1;
                                     QuickQuoteWorkSheet."Current Qty (Base)" := QuickQuoteWorkSheet."Qty per Unit of Measure" * "Current Qty.";
                                     QuickQuoteWorkSheet."Promotion Code" := "Promotion Code";
                                     QuickQuoteWorkSheet."Line No." := OldLineNo;
                                     QuickQuoteWorkSheet.MODIFY;
                                   END;
                               END;
                             IF "Current UOM" <> xRec."Current UOM" THEN UpdateSingleLine("Location Code");
                           END;
                            }

    { 1000000015;2;Field  ;
                SourceExpr="Unit Cost";
                Visible=ESACC_F23_Visible;
                Editable=FALSE;
                HideValue=ESACC_F23_HideValue }

    { 1000000016;2;Field  ;
                SourceExpr="Sell-to Customer No.";
                Visible=FALSE;
                Editable=FALSE;
                HideValue=ESACC_F2_HideValue }

    { 1000000044;2;Field  ;
                SourceExpr="Lost Opportunity";
                Visible=ESACC_F50026_Visible;
                Editable=FALSE;
                HideValue=ESACC_F50026_HideValue }

    { 1000000046;2;Field  ;
                SourceExpr="Reason Code";
                Visible=ESACC_F50027_Visible;
                Editable=ESACC_F50027_Editable;
                HideValue=ESACC_F50027_HideValue;
                OnValidate=BEGIN

                             IF "Reason Code" <> xRec."Reason Code" THEN UpdateLastSalesPrice(Rec);
                             IF "Reason Code" <> '' THEN BEGIN
                               StockStatusQuickQuote."Reason Code" := "Reason Code";
                               StockStatusQuickQuote."Reason Code Comment" := "Reason Code Comment"; //TOP010 KT ABCSI Stock Status Quick Quote 06042015
                               StockStatusQuickQuote."Lost Opportunity Description" := "Lost Opportunity Description";  //TOP230 KT ABCSI CRP 2 Fixes 06092015
                               StockStatusQuickQuote."Lost Opportunity" := "Lost Opportunity";
                               StockStatusQuickQuote.MODIFY;
                               QuickQuoteWorkSheet.RESET;
                               QuickQuoteWorkSheet.SETRANGE("Item No.","Item No.");
                               IF QuickQuoteWorkSheet.FIND('+') THEN
                                 OldLineNo := QuickQuoteWorkSheet."Line No.";
                               QuickQuoteWorkSheet.TRANSFERFIELDS(StockStatusQuickQuote);
                               QuickQuoteWorkSheet.MODIFY;
                             END;
                           END;
                            }

    { 1000000047;2;Field  ;
                SourceExpr="Reason Code Comment";
                Visible=ESACC_F50028_Visible;
                Editable=ESACC_F50028_Editable;
                HideValue=ESACC_F50028_HideValue;
                OnValidate=BEGIN

                             IF xRec."Reason Code Comment" <> "Reason Code Comment" THEN UpdateLastSalesPrice(Rec);
                             IF "Reason Code Comment" <> '' THEN BEGIN
                               StockStatusQuickQuote."Reason Code Comment" := "Reason Code Comment";
                               StockStatusQuickQuote.MODIFY;
                               QuickQuoteWorkSheet.RESET;
                               QuickQuoteWorkSheet.SETRANGE("Item No.","Item No.");
                               IF QuickQuoteWorkSheet.FIND('+') THEN
                                 OldLineNo := QuickQuoteWorkSheet."Line No.";
                               QuickQuoteWorkSheet.TRANSFERFIELDS(StockStatusQuickQuote);
                               QuickQuoteWorkSheet.MODIFY;
                             END;
                           END;
                            }

    { 1000000053;2;Field  ;
                SourceExpr="Lost Opportunity Description";
                Visible=ESACC_F50029_Visible;
                Editable=ESACC_F50029_Editable;
                HideValue=ESACC_F50029_HideValue }

    { 1000000018;2;Field  ;
                SourceExpr="Last Unit Price";
                Visible=ESACC_F50007_Visible;
                Editable=FALSE;
                HideValue=ESACC_F50007_HideValue }

    { 1000000019;2;Field  ;
                SourceExpr="Last Price UOM";
                Visible=ESACC_F50008_Visible;
                Editable=FALSE;
                HideValue=ESACC_F50008_HideValue }

    { 1000000020;2;Field  ;
                SourceExpr="Last Price Qty.";
                Visible=ESACC_F50009_Visible;
                Editable=ESACC_F50009_Editable;
                HideValue=ESACC_F50009_HideValue }

    { 1000000024;2;Field  ;
                SourceExpr="Last Price Date";
                Visible=ESACC_F50013_Visible;
                Editable=ESACC_F50013_Editable;
                HideValue=ESACC_F50013_HideValue }

    { 1000000068;2;Field  ;
                SourceExpr="Last Price User ID";
                Visible=ESACC_F50031_Visible;
                Editable=FALSE;
                HideValue=ESACC_F50031_HideValue }

    { 1000000021;2;Field  ;
                SourceExpr="Last Reason Code";
                Visible=ESACC_F50010_Visible;
                Editable=FALSE;
                HideValue=ESACC_F50010_HideValue }

    { 1000000022;2;Field  ;
                SourceExpr="Last Reason Code Comment";
                Visible=ESACC_F50011_Visible;
                Editable=FALSE;
                HideValue=ESACC_F50011_HideValue }

    { 1000000023;2;Field  ;
                SourceExpr="Last Lost Opportunity";
                Visible=ESACC_F50012_Visible;
                Editable=FALSE;
                HideValue=ESACC_F50012_HideValue }

    { 1000000010;2;Field  ;
                SourceExpr="Last Quoted Unit Price";
                Visible=ESACC_F50002_Visible;
                Editable=FALSE;
                HideValue=ESACC_F50002_HideValue }

    { 1000000012;2;Field  ;
                SourceExpr="Last Quoted Qty.";
                Visible=ESACC_F50004_Visible;
                Editable=FALSE;
                HideValue=ESACC_F50004_HideValue }

    { 1000000038;2;Field  ;
                SourceExpr="Last Quoted UOM";
                Visible=ESACC_F50003_Visible;
                Editable=FALSE;
                HideValue=ESACC_F50003_HideValue }

    { 1000000025;2;Field  ;
                SourceExpr="Last Invoice Price";
                Visible=ESACC_F50014_Visible;
                Editable=FALSE;
                HideValue=ESACC_F50014_HideValue }

    { 1000000026;2;Field  ;
                SourceExpr="Last Invoiced Qty.";
                Visible=ESACC_F50015_Visible;
                Editable=FALSE;
                HideValue=ESACC_F50015_HideValue }

    { 1000000028;2;Field  ;
                SourceExpr="Qty. on Purch. Order";
                Visible=ESACC_F84_Visible;
                Editable=FALSE;
                HideValue=ESACC_F84_HideValue;
                OnLookup=VAR
                           PurchLines@1000000000 : Record 39;
                         BEGIN
                           PurchLines.RESET;
                           PurchLines.SETRANGE("Document Type",PurchLines."Document Type"::Order);
                           PurchLines.SETRANGE(Type,PurchLines.Type::Item);
                           PurchLines.SETRANGE("No.","Item No.");
                           PurchLines.SETRANGE("Location Code","Location Code");
                           PAGE.RUN(518,PurchLines);
                         END;
                          }

    { 1000000029;2;Field  ;
                SourceExpr="Vendor Item No.";
                Visible=ESACC_F32_Visible;
                Editable=FALSE;
                HideValue=ESACC_F32_HideValue }

    { 1000000030;2;Field  ;
                SourceExpr="Qty. on Sales Order";
                Visible=ESACC_F85_Visible;
                Editable=FALSE;
                HideValue=ESACC_F85_HideValue }

    { 1000000031;2;Field  ;
                SourceExpr="Cust. Qty. on SO";
                Visible=ESACC_F50016_Visible;
                Editable=FALSE;
                HideValue=ESACC_F50016_HideValue }

    { 1000000032;2;Field  ;
                SourceExpr="Qty. on Hand";
                Visible=ESACC_F50017_Visible;
                Editable=FALSE;
                HideValue=ESACC_F50017_HideValue }

    { 1000000033;2;Field  ;
                SourceExpr="Total Qty. on Hand";
                Visible=ESACC_F50018_Visible;
                Editable=FALSE;
                HideValue=ESACC_F50018_HideValue }

    { 1000000034;2;Field  ;
                SourceExpr="Qty. on Pick Loc.";
                Visible=ESACC_F5777_Visible;
                Editable=FALSE;
                HideValue=ESACC_F5777_HideValue }

    { 1000000035;2;Field  ;
                SourceExpr="Qty. Avail. to Pick";
                Visible=ESACC_F50019_Visible;
                Editable=FALSE;
                HideValue=ESACC_F50019_HideValue }

    { 1000000036;2;Field  ;
                SourceExpr="Promotion Code";
                Visible=ESACC_F50020_Visible;
                Editable=ESACC_F50020_Editable;
                HideValue=ESACC_F50020_HideValue }

    { 1000000027;2;Field  ;
                SourceExpr="Curr. Unit Price Starting Date";
                Visible=ESACC_F50021_Visible;
                Editable=FALSE;
                HideValue=ESACC_F50021_HideValue }

    { 1000000045;2;Field  ;
                SourceExpr="Curr. Unit Price Ending Date";
                Visible=ESACC_F50022_Visible;
                Editable=FALSE;
                HideValue=ESACC_F50022_HideValue }

    { 1000000039;2;Field  ;
                SourceExpr="Low Unit Price";
                Visible=ESACC_F50023_Visible;
                Editable=FALSE;
                HideValue=ESACC_F50023_HideValue }

    { 1000000050;2;Field  ;
                SourceExpr="Medium Unit Price";
                Visible=ESACC_F50030_Visible;
                Editable=FALSE;
                HideValue=ESACC_F50030_HideValue }

    { 1000000040;2;Field  ;
                SourceExpr="High Unit Price";
                Visible=ESACC_F50024_Visible;
                Editable=FALSE;
                HideValue=ESACC_F50024_HideValue }

    { 1000000042;2;Field  ;
                SourceExpr="Last Price Change Date";
                Visible=ESACC_F50025_Visible;
                Editable=FALSE;
                HideValue=ESACC_F50025_HideValue }

  }
  CODE
  {
    VAR
      ESACC_ESFLADSMgt@14123801 : Codeunit 14123801;
      ESACC_C1000000061_Visible@915000610 : Boolean INDATASET;
      ESACC_C1000000061_Enabled@915000613 : Boolean INDATASET;
      ESACC_C1000000065_Visible@915000650 : Boolean INDATASET;
      ESACC_C1000000065_Enabled@915000653 : Boolean INDATASET;
      ESACC_F2_Visible@900000020 : Boolean INDATASET;
      ESACC_F2_Editable@900000021 : Boolean INDATASET;
      ESACC_F2_HideValue@900000022 : Boolean INDATASET;
      ESACC_F6_Visible@900000060 : Boolean INDATASET;
      ESACC_F6_Editable@900000061 : Boolean INDATASET;
      ESACC_F6_HideValue@900000062 : Boolean INDATASET;
      ESACC_F7_Visible@900000070 : Boolean INDATASET;
      ESACC_F7_Editable@900000071 : Boolean INDATASET;
      ESACC_F7_HideValue@900000072 : Boolean INDATASET;
      ESACC_F8_Visible@900000080 : Boolean INDATASET;
      ESACC_F8_Editable@900000081 : Boolean INDATASET;
      ESACC_F8_HideValue@900000082 : Boolean INDATASET;
      ESACC_F11_Visible@900000110 : Boolean INDATASET;
      ESACC_F11_Editable@900000111 : Boolean INDATASET;
      ESACC_F11_HideValue@900000112 : Boolean INDATASET;
      ESACC_F12_Visible@900000120 : Boolean INDATASET;
      ESACC_F12_Editable@900000121 : Boolean INDATASET;
      ESACC_F12_HideValue@900000122 : Boolean INDATASET;
      ESACC_F19_Visible@900000190 : Boolean INDATASET;
      ESACC_F19_Editable@900000191 : Boolean INDATASET;
      ESACC_F19_HideValue@900000192 : Boolean INDATASET;
      ESACC_F22_Visible@900000220 : Boolean INDATASET;
      ESACC_F22_Editable@900000221 : Boolean INDATASET;
      ESACC_F22_HideValue@900000222 : Boolean INDATASET;
      ESACC_F23_Visible@900000230 : Boolean INDATASET;
      ESACC_F23_Editable@900000231 : Boolean INDATASET;
      ESACC_F23_HideValue@900000232 : Boolean INDATASET;
      ESACC_F32_Visible@900000320 : Boolean INDATASET;
      ESACC_F32_Editable@900000321 : Boolean INDATASET;
      ESACC_F32_HideValue@900000322 : Boolean INDATASET;
      ESACC_F54_Visible@900000540 : Boolean INDATASET;
      ESACC_F54_Editable@900000541 : Boolean INDATASET;
      ESACC_F54_HideValue@900000542 : Boolean INDATASET;
      ESACC_F84_Visible@900000840 : Boolean INDATASET;
      ESACC_F84_Editable@900000841 : Boolean INDATASET;
      ESACC_F84_HideValue@900000842 : Boolean INDATASET;
      ESACC_F85_Visible@900000850 : Boolean INDATASET;
      ESACC_F85_HideValue@900000852 : Boolean INDATASET;
      ESACC_F95_Visible@900000950 : Boolean INDATASET;
      ESACC_F95_Editable@900000951 : Boolean INDATASET;
      ESACC_F95_HideValue@900000952 : Boolean INDATASET;
      ESACC_F5701_Visible@900057010 : Boolean INDATASET;
      ESACC_F5701_Editable@900057011 : Boolean INDATASET;
      ESACC_F5701_HideValue@900057012 : Boolean INDATASET;
      ESACC_F5709_Visible@900057090 : Boolean INDATASET;
      ESACC_F5709_Editable@900057091 : Boolean INDATASET;
      ESACC_F5709_HideValue@900057092 : Boolean INDATASET;
      ESACC_F5712_Visible@900057120 : Boolean INDATASET;
      ESACC_F5712_Editable@900057121 : Boolean INDATASET;
      ESACC_F5712_HideValue@900057122 : Boolean INDATASET;
      ESACC_F5777_Visible@900057770 : Boolean INDATASET;
      ESACC_F5777_HideValue@900057772 : Boolean INDATASET;
      ESACC_F50000_Visible@900500000 : Boolean INDATASET;
      ESACC_F50000_Editable@900500001 : Boolean INDATASET;
      ESACC_F50000_HideValue@900500002 : Boolean INDATASET;
      ESACC_F50001_Visible@900500010 : Boolean INDATASET;
      ESACC_F50001_Editable@900500011 : Boolean INDATASET;
      ESACC_F50001_HideValue@900500012 : Boolean INDATASET;
      ESACC_F50002_Visible@900500020 : Boolean INDATASET;
      ESACC_F50002_Editable@900500021 : Boolean INDATASET;
      ESACC_F50002_HideValue@900500022 : Boolean INDATASET;
      ESACC_F50003_Visible@900500030 : Boolean INDATASET;
      ESACC_F50003_Editable@900500031 : Boolean INDATASET;
      ESACC_F50003_HideValue@900500032 : Boolean INDATASET;
      ESACC_F50004_Visible@900500040 : Boolean INDATASET;
      ESACC_F50004_Editable@900500041 : Boolean INDATASET;
      ESACC_F50004_HideValue@900500042 : Boolean INDATASET;
      ESACC_F50005_Visible@900500050 : Boolean INDATASET;
      ESACC_F50005_Editable@900500051 : Boolean INDATASET;
      ESACC_F50005_HideValue@900500052 : Boolean INDATASET;
      ESACC_F50006_Visible@900500060 : Boolean INDATASET;
      ESACC_F50006_Editable@900500061 : Boolean INDATASET;
      ESACC_F50006_HideValue@900500062 : Boolean INDATASET;
      ESACC_F50007_Visible@900500070 : Boolean INDATASET;
      ESACC_F50007_Editable@900500071 : Boolean INDATASET;
      ESACC_F50007_HideValue@900500072 : Boolean INDATASET;
      ESACC_F50008_Visible@900500080 : Boolean INDATASET;
      ESACC_F50008_Editable@900500081 : Boolean INDATASET;
      ESACC_F50008_HideValue@900500082 : Boolean INDATASET;
      ESACC_F50009_Visible@900500090 : Boolean INDATASET;
      ESACC_F50009_Editable@900500091 : Boolean INDATASET;
      ESACC_F50009_HideValue@900500092 : Boolean INDATASET;
      ESACC_F50010_Visible@900500100 : Boolean INDATASET;
      ESACC_F50010_Editable@900500101 : Boolean INDATASET;
      ESACC_F50010_HideValue@900500102 : Boolean INDATASET;
      ESACC_F50011_Visible@900500110 : Boolean INDATASET;
      ESACC_F50011_Editable@900500111 : Boolean INDATASET;
      ESACC_F50011_HideValue@900500112 : Boolean INDATASET;
      ESACC_F50012_Visible@900500120 : Boolean INDATASET;
      ESACC_F50012_Editable@900500121 : Boolean INDATASET;
      ESACC_F50012_HideValue@900500122 : Boolean INDATASET;
      ESACC_F50013_Visible@900500130 : Boolean INDATASET;
      ESACC_F50013_Editable@900500131 : Boolean INDATASET;
      ESACC_F50013_HideValue@900500132 : Boolean INDATASET;
      ESACC_F50014_Visible@900500140 : Boolean INDATASET;
      ESACC_F50014_Editable@900500141 : Boolean INDATASET;
      ESACC_F50014_HideValue@900500142 : Boolean INDATASET;
      ESACC_F50015_Visible@900500150 : Boolean INDATASET;
      ESACC_F50015_Editable@900500151 : Boolean INDATASET;
      ESACC_F50015_HideValue@900500152 : Boolean INDATASET;
      ESACC_F50016_Visible@900500160 : Boolean INDATASET;
      ESACC_F50016_HideValue@900500162 : Boolean INDATASET;
      ESACC_F50017_Visible@900500170 : Boolean INDATASET;
      ESACC_F50017_Editable@900500171 : Boolean INDATASET;
      ESACC_F50017_HideValue@900500172 : Boolean INDATASET;
      ESACC_F50018_Visible@900500180 : Boolean INDATASET;
      ESACC_F50018_Editable@900500181 : Boolean INDATASET;
      ESACC_F50018_HideValue@900500182 : Boolean INDATASET;
      ESACC_F50019_Visible@900500190 : Boolean INDATASET;
      ESACC_F50019_Editable@900500191 : Boolean INDATASET;
      ESACC_F50019_HideValue@900500192 : Boolean INDATASET;
      ESACC_F50020_Visible@900500200 : Boolean INDATASET;
      ESACC_F50020_Editable@900500201 : Boolean INDATASET;
      ESACC_F50020_HideValue@900500202 : Boolean INDATASET;
      ESACC_F50021_Visible@900500210 : Boolean INDATASET;
      ESACC_F50021_Editable@900500211 : Boolean INDATASET;
      ESACC_F50021_HideValue@900500212 : Boolean INDATASET;
      ESACC_F50022_Visible@900500220 : Boolean INDATASET;
      ESACC_F50022_Editable@900500221 : Boolean INDATASET;
      ESACC_F50022_HideValue@900500222 : Boolean INDATASET;
      ESACC_F50023_Visible@900500230 : Boolean INDATASET;
      ESACC_F50023_Editable@900500231 : Boolean INDATASET;
      ESACC_F50023_HideValue@900500232 : Boolean INDATASET;
      ESACC_F50024_Visible@900500240 : Boolean INDATASET;
      ESACC_F50024_Editable@900500241 : Boolean INDATASET;
      ESACC_F50024_HideValue@900500242 : Boolean INDATASET;
      ESACC_F50025_Visible@900500250 : Boolean INDATASET;
      ESACC_F50025_Editable@900500251 : Boolean INDATASET;
      ESACC_F50025_HideValue@900500252 : Boolean INDATASET;
      ESACC_F50026_Visible@900500260 : Boolean INDATASET;
      ESACC_F50026_Editable@900500261 : Boolean INDATASET;
      ESACC_F50026_HideValue@900500262 : Boolean INDATASET;
      ESACC_F50027_Visible@900500270 : Boolean INDATASET;
      ESACC_F50027_Editable@900500271 : Boolean INDATASET;
      ESACC_F50027_HideValue@900500272 : Boolean INDATASET;
      ESACC_F50028_Visible@900500280 : Boolean INDATASET;
      ESACC_F50028_Editable@900500281 : Boolean INDATASET;
      ESACC_F50028_HideValue@900500282 : Boolean INDATASET;
      ESACC_F50029_Visible@900500290 : Boolean INDATASET;
      ESACC_F50029_Editable@900500291 : Boolean INDATASET;
      ESACC_F50029_HideValue@900500292 : Boolean INDATASET;
      ESACC_F50030_Visible@900500300 : Boolean INDATASET;
      ESACC_F50030_Editable@900500301 : Boolean INDATASET;
      ESACC_F50030_HideValue@900500302 : Boolean INDATASET;
      ESACC_F50031_Visible@900500310 : Boolean INDATASET;
      ESACC_F50031_Editable@900500311 : Boolean INDATASET;
      ESACC_F50031_HideValue@900500312 : Boolean INDATASET;
      ESACC_F50040_Visible@900500400 : Boolean INDATASET;
      ESACC_F50040_Editable@900500401 : Boolean INDATASET;
      ESACC_F50040_HideValue@900500402 : Boolean INDATASET;
      ESACC_F50100_Visible@900501000 : Boolean INDATASET;
      ESACC_F50100_Editable@900501001 : Boolean INDATASET;
      ESACC_F50100_HideValue@900501002 : Boolean INDATASET;
      ESACC_F50202_Visible@900502020 : Boolean INDATASET;
      ESACC_F50202_Editable@900502021 : Boolean INDATASET;
      ESACC_F50202_HideValue@900502022 : Boolean INDATASET;
      ItemNoFilter@1000000068 : Code[20];
      VendItemNoFilter@1000000070 : Text[30];
      StockStatusQuickQuote@1000000001 : TEMPORARY Record 50000;
      QuickQuoteWorkSheet@1000000000 : TEMPORARY Record 50001;
      LineNo@1000000002 : Integer;
      PrevLocationCode@1000000049 : Code[10];
      NextLocationCode@1000000050 : Code[10];
      LocationUpdated@1000000051 : Boolean;
      InFromItemNo@1000000006 : Code[20];
      InToItemNo@1000000005 : Code[20];
      InCustFilter@1000000004 : Code[20];
      InLocFilter@1000000003 : Code[10];
      Item@1000000012 : Record 27;
      Item2@1000000007 : Record 27;
      UserSetup@1000000008 : Record 91;
      SalesHeader@1000000010 : Record 36;
      SalesLine@1000000009 : Record 37;
      SalesLineNo@1000000011 : Integer;
      ItemUnitCost@1000000014 : Decimal;
      ItemUnitPrice@1000000013 : Decimal;
      EffPriceIncrDate@1000000015 : Date;
      QtyPerUOM@1000000016 : Decimal;
      UOMMgt@1000000017 : Codeunit 5402;
      ItemAvail@1000000018 : Decimal;
      ItemQOH@1000000020 : Decimal;
      ItemQPO@1000000019 : Decimal;
      ItemLead@1000000021 : DateFormula;
      CompanyInformation@1000000022 : Record 79;
      Item3@1000000024 : Record 27;
      MItemAvail@1000000023 : Decimal;
      LastSalesPrice@1000000044 : Record 50004;
      NewLastSalesPrice@1000000045 : Record 50004;
      SalesPrice@1000000026 : Record 7002;
      NewSalesPrice@1000000025 : Record 7002;
      BaseUOM@1000000027 : Code[10];
      Company@1000000028 : Record 79;
      OrderTotal@1000000033 : Decimal;
      SLoc@1000000034 : Record 14;
      MultiOrder@1000000032 : Boolean;
      FirstNo@1000000031 : Code[10];
      LastNo@1000000030 : Code[10];
      ONo@1000000029 : Code[10];
      LastPriceInfo@1000000035 : Text[60];
      LastPriceUserID@1000000036 : Code[10];
      Customer@1000000038 : Record 18;
      WLoc@1000000039 : Record 14;
      ItemUOM@1000000040 : Record 5404;
      OldLineNo@1000000041 : Integer;
      TempSalesHeader@1000000043 : TEMPORARY Record 36;
      TempSalesLine@1000000037 : TEMPORARY Record 37;
      LastSalesLineNo@1000000042 : Integer;
      CurrDivisionCodeFilter@1000000046 : Code[20];
      LastLostOpportunity@1000000047 : Record 50002;
      DocType@1000000048 : 'Quote,Order,Stock Status';
      Text00001@1000000052 : TextConst 'ENU=There are No Lines with Curr. Quantity Populated \ Please poulate Lines with Curr. Quantity and Unit Price to Proceed further';
      "****ABCSI****"@1000000053 : Integer;
      CustNo@1000000058 : Code[20];
      CustName@1000000057 : Text[50];
      CustDiv@1000000056 : Record 50007;
      CustDivFilter@1000000055 : Text;
      DimVal@1000000054 : Record 349;
      DocumentNo@1000000061 : Code[20];
      DocumentType@1000000060 : 'Order,Quote';
      LocationCode@1000000059 : Code[10];
      CustRec@1000000062 : Record 18;
      DivisionCodeFilter@1000000063 : Code[20];
      GLSetup@1000000064 : Record 98;
      ab005@1000000065 : TextConst 'ENU=This Shortcut Dimension is not defined in the %1.;ESM=Este Shortcut de dimensin no est def. en el %1.;FRC=La dimension de ce raccourci n''est pas dfinie dans le %1.;ENC=This Shortcut Dimension is not defined in the %1.';
      Text00002@1000000067 : TextConst 'ENU=There are Lines with Current Qty Populated. \ Are you sure you want to change the Division Code?';
      Text00003@1000000066 : TextConst 'ENU=Processing halted to respect the user selection';
      Text00004@1000000069 : TextConst 'ENU=There are Lines with Current Qty Populated. \ Do you want to Add them to %1 %2?';

    LOCAL PROCEDURE ESACC_EasySecurity@14123801(OpenObject@14123801 : Boolean);
    VAR
      SetFilters@14123802 : Codeunit 14123812;
      TempBoolean@14123803 : Boolean;
    BEGIN
      IF OpenObject THEN BEGIN
        SetFilters.Filter50000(Rec,8,50018);

        TempBoolean := CurrPage.EDITABLE;
        IF ESACC_ESFLADSMgt.PageGeneral(50000,50018,TempBoolean) THEN
          CurrPage.EDITABLE := TempBoolean;
      END;

      ESACC_ESFLADSMgt.PageControl(
        50000,50018,1,1000000061,
        ESACC_C1000000061_Visible,ESACC_C1000000061_Enabled,TempBoolean);

      ESACC_ESFLADSMgt.PageControl(
        50000,50018,1,1000000065,
        ESACC_C1000000065_Visible,ESACC_C1000000065_Enabled,TempBoolean);

      ESACC_ESFLADSMgt.PageControl(
        50000,50018,0,2,
        ESACC_F2_Visible,ESACC_F2_Editable,ESACC_F2_HideValue);

      ESACC_ESFLADSMgt.PageControl(
        50000,50018,0,6,
        ESACC_F6_Visible,ESACC_F6_Editable,ESACC_F6_HideValue);

      ESACC_ESFLADSMgt.PageControl(
        50000,50018,0,7,
        ESACC_F7_Visible,ESACC_F7_Editable,ESACC_F7_HideValue);

      ESACC_ESFLADSMgt.PageControl(
        50000,50018,0,8,
        ESACC_F8_Visible,ESACC_F8_Editable,ESACC_F8_HideValue);

      ESACC_ESFLADSMgt.PageControl(
        50000,50018,0,11,
        ESACC_F11_Visible,ESACC_F11_Editable,ESACC_F11_HideValue);

      ESACC_ESFLADSMgt.PageControl(
        50000,50018,0,12,
        ESACC_F12_Visible,ESACC_F12_Editable,ESACC_F12_HideValue);

      ESACC_ESFLADSMgt.PageControl(
        50000,50018,0,19,
        ESACC_F19_Visible,ESACC_F19_Editable,ESACC_F19_HideValue);

      ESACC_ESFLADSMgt.PageControl(
        50000,50018,0,22,
        ESACC_F22_Visible,ESACC_F22_Editable,ESACC_F22_HideValue);

      ESACC_ESFLADSMgt.PageControl(
        50000,50018,0,23,
        ESACC_F23_Visible,ESACC_F23_Editable,ESACC_F23_HideValue);

      ESACC_ESFLADSMgt.PageControl(
        50000,50018,0,32,
        ESACC_F32_Visible,ESACC_F32_Editable,ESACC_F32_HideValue);

      ESACC_ESFLADSMgt.PageControl(
        50000,50018,0,54,
        ESACC_F54_Visible,ESACC_F54_Editable,ESACC_F54_HideValue);

      ESACC_ESFLADSMgt.PageControl(
        50000,50018,0,84,
        ESACC_F84_Visible,ESACC_F84_Editable,ESACC_F84_HideValue);

      ESACC_ESFLADSMgt.PageControl(
        50000,50018,0,85,
        ESACC_F85_Visible,TempBoolean,ESACC_F85_HideValue);

      ESACC_ESFLADSMgt.PageControl(
        50000,50018,0,95,
        ESACC_F95_Visible,ESACC_F95_Editable,ESACC_F95_HideValue);

      ESACC_ESFLADSMgt.PageControl(
        50000,50018,0,5701,
        ESACC_F5701_Visible,ESACC_F5701_Editable,ESACC_F5701_HideValue);

      ESACC_ESFLADSMgt.PageControl(
        50000,50018,0,5709,
        ESACC_F5709_Visible,ESACC_F5709_Editable,ESACC_F5709_HideValue);

      ESACC_ESFLADSMgt.PageControl(
        50000,50018,0,5712,
        ESACC_F5712_Visible,ESACC_F5712_Editable,ESACC_F5712_HideValue);

      ESACC_ESFLADSMgt.PageControl(
        50000,50018,0,5777,
        ESACC_F5777_Visible,TempBoolean,ESACC_F5777_HideValue);

      ESACC_ESFLADSMgt.PageControl(
        50000,50018,0,50000,
        ESACC_F50000_Visible,ESACC_F50000_Editable,ESACC_F50000_HideValue);

      ESACC_ESFLADSMgt.PageControl(
        50000,50018,0,50001,
        ESACC_F50001_Visible,ESACC_F50001_Editable,ESACC_F50001_HideValue);

      ESACC_ESFLADSMgt.PageControl(
        50000,50018,0,50002,
        ESACC_F50002_Visible,ESACC_F50002_Editable,ESACC_F50002_HideValue);

      ESACC_ESFLADSMgt.PageControl(
        50000,50018,0,50003,
        ESACC_F50003_Visible,ESACC_F50003_Editable,ESACC_F50003_HideValue);

      ESACC_ESFLADSMgt.PageControl(
        50000,50018,0,50004,
        ESACC_F50004_Visible,ESACC_F50004_Editable,ESACC_F50004_HideValue);

      ESACC_ESFLADSMgt.PageControl(
        50000,50018,0,50005,
        ESACC_F50005_Visible,ESACC_F50005_Editable,ESACC_F50005_HideValue);

      ESACC_ESFLADSMgt.PageControl(
        50000,50018,0,50006,
        ESACC_F50006_Visible,ESACC_F50006_Editable,ESACC_F50006_HideValue);

      ESACC_ESFLADSMgt.PageControl(
        50000,50018,0,50007,
        ESACC_F50007_Visible,ESACC_F50007_Editable,ESACC_F50007_HideValue);

      ESACC_ESFLADSMgt.PageControl(
        50000,50018,0,50008,
        ESACC_F50008_Visible,ESACC_F50008_Editable,ESACC_F50008_HideValue);

      ESACC_ESFLADSMgt.PageControl(
        50000,50018,0,50009,
        ESACC_F50009_Visible,ESACC_F50009_Editable,ESACC_F50009_HideValue);

      ESACC_ESFLADSMgt.PageControl(
        50000,50018,0,50010,
        ESACC_F50010_Visible,ESACC_F50010_Editable,ESACC_F50010_HideValue);

      ESACC_ESFLADSMgt.PageControl(
        50000,50018,0,50011,
        ESACC_F50011_Visible,ESACC_F50011_Editable,ESACC_F50011_HideValue);

      ESACC_ESFLADSMgt.PageControl(
        50000,50018,0,50012,
        ESACC_F50012_Visible,ESACC_F50012_Editable,ESACC_F50012_HideValue);

      ESACC_ESFLADSMgt.PageControl(
        50000,50018,0,50013,
        ESACC_F50013_Visible,ESACC_F50013_Editable,ESACC_F50013_HideValue);

      ESACC_ESFLADSMgt.PageControl(
        50000,50018,0,50014,
        ESACC_F50014_Visible,ESACC_F50014_Editable,ESACC_F50014_HideValue);

      ESACC_ESFLADSMgt.PageControl(
        50000,50018,0,50015,
        ESACC_F50015_Visible,ESACC_F50015_Editable,ESACC_F50015_HideValue);

      ESACC_ESFLADSMgt.PageControl(
        50000,50018,0,50016,
        ESACC_F50016_Visible,TempBoolean,ESACC_F50016_HideValue);

      ESACC_ESFLADSMgt.PageControl(
        50000,50018,0,50017,
        ESACC_F50017_Visible,ESACC_F50017_Editable,ESACC_F50017_HideValue);

      ESACC_ESFLADSMgt.PageControl(
        50000,50018,0,50018,
        ESACC_F50018_Visible,ESACC_F50018_Editable,ESACC_F50018_HideValue);

      ESACC_ESFLADSMgt.PageControl(
        50000,50018,0,50019,
        ESACC_F50019_Visible,ESACC_F50019_Editable,ESACC_F50019_HideValue);

      ESACC_ESFLADSMgt.PageControl(
        50000,50018,0,50020,
        ESACC_F50020_Visible,ESACC_F50020_Editable,ESACC_F50020_HideValue);

      ESACC_ESFLADSMgt.PageControl(
        50000,50018,0,50021,
        ESACC_F50021_Visible,ESACC_F50021_Editable,ESACC_F50021_HideValue);

      ESACC_ESFLADSMgt.PageControl(
        50000,50018,0,50022,
        ESACC_F50022_Visible,ESACC_F50022_Editable,ESACC_F50022_HideValue);

      ESACC_ESFLADSMgt.PageControl(
        50000,50018,0,50023,
        ESACC_F50023_Visible,ESACC_F50023_Editable,ESACC_F50023_HideValue);

      ESACC_ESFLADSMgt.PageControl(
        50000,50018,0,50024,
        ESACC_F50024_Visible,ESACC_F50024_Editable,ESACC_F50024_HideValue);

      ESACC_ESFLADSMgt.PageControl(
        50000,50018,0,50025,
        ESACC_F50025_Visible,ESACC_F50025_Editable,ESACC_F50025_HideValue);

      ESACC_ESFLADSMgt.PageControl(
        50000,50018,0,50026,
        ESACC_F50026_Visible,ESACC_F50026_Editable,ESACC_F50026_HideValue);

      ESACC_ESFLADSMgt.PageControl(
        50000,50018,0,50027,
        ESACC_F50027_Visible,ESACC_F50027_Editable,ESACC_F50027_HideValue);

      ESACC_ESFLADSMgt.PageControl(
        50000,50018,0,50028,
        ESACC_F50028_Visible,ESACC_F50028_Editable,ESACC_F50028_HideValue);

      ESACC_ESFLADSMgt.PageControl(
        50000,50018,0,50029,
        ESACC_F50029_Visible,ESACC_F50029_Editable,ESACC_F50029_HideValue);

      ESACC_ESFLADSMgt.PageControl(
        50000,50018,0,50030,
        ESACC_F50030_Visible,ESACC_F50030_Editable,ESACC_F50030_HideValue);

      ESACC_ESFLADSMgt.PageControl(
        50000,50018,0,50031,
        ESACC_F50031_Visible,ESACC_F50031_Editable,ESACC_F50031_HideValue);

      ESACC_ESFLADSMgt.PageControl(
        50000,50018,0,50040,
        ESACC_F50040_Visible,ESACC_F50040_Editable,ESACC_F50040_HideValue);

      ESACC_ESFLADSMgt.PageControl(
        50000,50018,0,50100,
        ESACC_F50100_Visible,ESACC_F50100_Editable,ESACC_F50100_HideValue);

      ESACC_ESFLADSMgt.PageControl(
        50000,50018,0,50202,
        ESACC_F50202_Visible,ESACC_F50202_Editable,ESACC_F50202_HideValue);

      ESACC_EasySecurityManual(OpenObject);
    END;

    LOCAL PROCEDURE ESACC_EasySecurityManual@14123811(OpenObject@14123811 : Boolean);
    BEGIN
    END;

    PROCEDURE UserPrompt@1000000013();
    BEGIN
      //TOP010B KT ABCSI SSQQ Division Code 07092015
      QuickQuoteWorkSheet.RESET;
      QuickQuoteWorkSheet.SETCURRENTKEY("Location Code",Description,"Item No.","Sell-To Customer No.");
      QuickQuoteWorkSheet.SETFILTER("Current Qty.",'<>%1',0);
      QuickQuoteWorkSheet.SETFILTER("Lost Opportunity",'%1',FALSE);
      IF QuickQuoteWorkSheet.FINDFIRST THEN
        IF NOT CONFIRM(Text00002) THEN
          ERROR(Text00003) ELSE
        BEGIN
          CheckLostOpportunity;
          StockStatusQuickQuote.RESET;
          StockStatusQuickQuote.DELETEALL;
          QuickQuoteWorkSheet.RESET;
          QuickQuoteWorkSheet.DELETEALL;
          CLEAR(LineNo);
        END;
      //TOP010B KT ABCSI SSQQ Division Code 07092015
    END;

    PROCEDURE UserUpdate@1000000000();
    BEGIN
      CurrPage.UPDATE(FALSE);
    END;

    PROCEDURE Refresh@1000000001(NewCust@1000000000 : Boolean);
    VAR
      CustRec@1000000001 : Record 18;
      ItemDivMatrix@1000000002 : Record 50032;
    BEGIN
      IF NewCust THEN
        BEGIN
          CheckLostOpportunity;
          StockStatusQuickQuote.RESET;
          StockStatusQuickQuote.DELETEALL;
          QuickQuoteWorkSheet.RESET;
          QuickQuoteWorkSheet.DELETEALL;
          CLEAR(LineNo);
        END;

      RESET;

      //TOP130 KT ABCSI Item List Sort and Filter by Status 04102015 Start
      ASCENDING := TRUE;
      SETCURRENTKEY("Blocked Sequence");

      IF CustRec.GET(InCustFilter) THEN BEGIN
        IF  (NOT CustRec."Non Divisional") THEN BEGIN
          FILTERGROUP(2);
          IF ItemDivMatrix.GET(CurrDivisionCodeFilter) THEN
            SETFILTER("Shortcut Dimension 5 Code",ItemDivMatrix."Divisional Filter");
          FILTERGROUP(0);
        END;
      END;
      //TOP130 KT ABCSI Item List Sort and Filter by Status 04102015 End

      QuickQuoteWorkSheet.RESET;
      QuickQuoteWorkSheet.SETCURRENTKEY(Description,"Item No.","Sell-To Customer No.");
      {
      IF InCustFilter <> '' THEN
         QuickQuoteWorkSheet.SETRANGE("Sell-To Customer No.", InCustFilter);
      IF NOT QuickQuoteWorkSheet.FIND('+') THEN
         LineNo := 1
      ELSE
         LineNo := QuickQuoteWorkSheet."Line No." + 1;
      }
      IF FIND('-') THEN;
      CurrPage.UPDATE(FALSE);
      CurrPage.ACTIVATE;
    END;

    PROCEDURE FindItemNo@1000000008(varItemNo@1000000000 : Code[20]);
    VAR
      WSHSHELL@1000000001 : Automation "{F935DC20-1CF0-11D0-ADB9-00C04FD58A0B} 1.0:{72C24DD5-D70A-438B-8A42-98424B88AFB8}:'Windows Script Host Object Model'.WshShell";
    BEGIN
      //TOP10C KT ABCSI - SSQQ Item Search 07082015
      IF varItemNo = '' THEN
        EXIT;

      SETFILTER("Item No.",varItemNo +'*');
      IF FIND('-') THEN;
      CurrPage.UPDATE(FALSE);
      CurrPage.ACTIVATE(TRUE);

      IF ISCLEAR(WSHSHELL) THEN
        CREATE(WSHSHELL, TRUE, TRUE);

      WSHSHELL.SendKeys('^+A');
      //TOP10C KT ABCSI - SSQQ Item Search 07082015
    END;

    PROCEDURE FindVendItemNo@1000000012(varVendItemNo@1000000000 : Text[30]);
    VAR
      WSHSHELL@1000000001 : Automation "{F935DC20-1CF0-11D0-ADB9-00C04FD58A0B} 1.0:{72C24DD5-D70A-438B-8A42-98424B88AFB8}:'Windows Script Host Object Model'.WshShell";
    BEGIN
      //TOP10E KT ABCSI - Additional Stock Status 07282015
      IF varVendItemNo = '' THEN
        EXIT;

      SETFILTER("Vendor Item No.",varVendItemNo +'*');
      IF FIND('-') THEN;
      CurrPage.UPDATE(FALSE);
      CurrPage.ACTIVATE(TRUE);

      IF ISCLEAR(WSHSHELL) THEN
        CREATE(WSHSHELL, TRUE, TRUE);

      WSHSHELL.SendKeys('^+A');
      //TOP10E KT ABCSI - Additional Stock Status 07282015
    END;

    PROCEDURE SetUserFilters@1000000002(InCustomer@1000000000 : Code[20];InLocation@1000000001 : Code[10];InDivisionCodeFilter@1000000002 : Code[20]);
    BEGIN
      InCustFilter := InCustomer;
      InLocFilter := InLocation;
      CurrDivisionCodeFilter := InDivisionCodeFilter;
      UpdateLine;
    END;

    PROCEDURE UpdateLastSalesPrice@1000000003(VAR InRec@1000000000 : Record 50000);
    BEGIN
      IF Item.GET(InRec."Item No.") THEN BEGIN
        BaseUOM := Item."Base Unit of Measure";
      END;

      IF "Unit Price" = 0 THEN
        EXIT;
      NewLastSalesPrice.RESET;
      NewLastSalesPrice.SETRANGE("Document Type",NewLastSalesPrice."Document Type"::"Stock Status");
      NewLastSalesPrice.SETRANGE("Document No.",'');
      NewLastSalesPrice.SETRANGE("Sell-to Customer No.",InCustFilter);
      NewLastSalesPrice.SETRANGE("Item No.","Item No.");
      NewLastSalesPrice.SETRANGE("Unit of Measure Code","Current UOM");
      IF NewLastSalesPrice.FINDFIRST THEN BEGIN
        NewLastSalesPrice."Document Date" := "Order Date";
        NewLastSalesPrice."Last Unit Price" := "Unit Price";
        NewLastSalesPrice."Last Price UOM" := "Current UOM";
        NewLastSalesPrice."Last Price Qty." := "Current Qty.";
        NewLastSalesPrice."Last Price Date" := TODAY;
        NewLastSalesPrice."Last Price User ID" := USERID;
        NewLastSalesPrice.MODIFY;
      END ELSE BEGIN
        NewLastSalesPrice.INIT;
        NewLastSalesPrice."Document Type" := NewLastSalesPrice."Document Type"::"Stock Status";
        NewLastSalesPrice."Document No." := '';
        NewLastSalesPrice."Sell-to Customer No." := InCustFilter;
        NewLastSalesPrice."Item No." := "Item No.";
        NewLastSalesPrice."Unit of Measure Code" := "Current UOM";
        NewLastSalesPrice."Document Date" := "Order Date";
        NewLastSalesPrice."Last Unit Price" := "Unit Price";
        NewLastSalesPrice."Last Price UOM" := "Current UOM";
        NewLastSalesPrice."Last Price Qty." := "Current Qty.";
        NewLastSalesPrice."Last Price Date" := TODAY;
        NewLastSalesPrice."Last Price User ID" := USERID;
        NewLastSalesPrice.INSERT;
      END;
    END;

    PROCEDURE NewOrderQuote@1000000005(CreateType@1000000000 : 'Order,Quote,Credit Memo,Return Order';"Doc No."@1000000001 : Code[10]);
    VAR
      OLocation@1000000002 : Code[10];
      NLocation@1000000003 : Code[10];
      OK@1000000004 : Boolean;
      ONo@1000000005 : Code[10];
      SOrders@1000000007 : Record 36;
      "LostQuoteNo."@1000000006 : Code[10];
      OnlyLost@1000000008 : Boolean;
    BEGIN
      IF (StockStatusQuickQuote.COUNT = 0) AND ((CreateType = CreateType::Order) OR (CreateType = CreateType::Quote)) THEN
        BEGIN
          MESSAGE('There is no item to process.');
          EXIT;
        END;

      //TOP010 KT ABCSI Stock Status Quick Quote 06042015
      QuickQuoteWorkSheet.RESET;
      QuickQuoteWorkSheet.SETCURRENTKEY("Location Code",Description,"Item No.","Sell-To Customer No.");
      QuickQuoteWorkSheet.SETFILTER("Current Qty.",'<>%1',0);
      QuickQuoteWorkSheet.SETFILTER("Lost Opportunity",'%1',FALSE);
      IF NOT QuickQuoteWorkSheet.FINDFIRST THEN
        ERROR(Text00001);
      //TOP010 KT ABCSI Stock Status Quick Quote 06042015

      CheckLostOpportunity;
      StockStatusQuickQuote.SETFILTER("Lost Opportunity",'%1',FALSE);
      IF (StockStatusQuickQuote.COUNT <> 0) THEN BEGIN
        CLEAR(OnlyLost);
        CLEAR(OLocation);
        CLEAR(NLocation);
        CLEAR(SalesHeader);
        CLEAR(LocationUpdated);
        CLEAR(PrevLocationCode);
        CLEAR(NextLocationCode);
        CLEAR(MultiOrder);
        CLEAR(FirstNo);
        CLEAR(LastNo);
        OrderTotal := CalcTotal(MultiOrder);
        SalesHeader.INIT;
        IF CreateType = CreateType::Order THEN
          SalesHeader."Document Type" := SalesHeader."Document Type"::Order
        ELSE
          BEGIN
          IF CreateType = CreateType::Quote THEN
            SalesHeader."Document Type" := SalesHeader."Document Type"::Quote
          ELSE
            EXIT;
          END;

        IF "Doc No." = '' THEN
          BEGIN
            SalesHeader.INSERT(TRUE);
            SalesHeader.SetHideValidationDialog(TRUE);
            SalesHeader.VALIDATE("Sell-to Customer No.",InCustFilter);
            SalesHeader.VALIDATE("Payment Terms Code");
            SalesHeader.VALIDATE("Shortcut Dimension 5 Code",CurrDivisionCodeFilter);  //TOP130 KT ABCSI Item List Sort and Filter by Status 04172015
            SalesHeader."Location Code" := '';
            SalesHeader.VALIDATE("Order Date",TODAY);
            SalesHeader.MODIFY(TRUE);
            //TOP040 KT ABCSI Sales Order Split by Locations 03052015 Commented per SMT
            {
            FirstNo := SalesHeader."No.";
            IF MultiOrder THEN BEGIN
              SalesHeader."Master Order No." := FirstNo;
              SalesHeader."Original Free Freight Base" := OrderTotal;
            END;
            LastNo := SalesHeader."No."
            }
            //TOP040 KT ABCSI Sales Order Split by Locations 03052015 Commented per SMT
          END;

        SalesLine.RESET;
        SalesLine.SETCURRENTKEY("Document Type","Document No.");
        SalesLine.SETRANGE(SalesLine."Document Type",SalesHeader."Document Type");
        //TOP170 KT ABCSI Sales Order Updates 04022015
        IF "Doc No." <> '' THEN
          SalesLine.SETRANGE(SalesLine."Document No.","Doc No.")
        ELSE
          SalesLine.SETRANGE(SalesLine."Document No.",SalesHeader."No.");
        //TOP170 KT ABCSI Sales Order Updates 04022015
        IF SalesLine.FIND('+') THEN
          SalesLineNo := SalesLine."Line No." + 10000
        ELSE
          SalesLineNo := 10000;
        QuickQuoteWorkSheet.RESET;
        QuickQuoteWorkSheet.SETCURRENTKEY("Location Code",Description,"Item No.","Sell-To Customer No.");
        QuickQuoteWorkSheet.SETFILTER("Current Qty.",'<>%1',0);
        QuickQuoteWorkSheet.SETFILTER("Lost Opportunity",'%1',FALSE);

        IF QuickQuoteWorkSheet.FIND('-') THEN
          REPEAT
            IF "Doc No." = '' THEN
              IF SalesHeader."Location Code" = '' THEN BEGIN
                SalesHeader.VALIDATE(SalesHeader."Location Code",QuickQuoteWorkSheet."Location Code");
                SalesHeader.MODIFY(TRUE);
              END;
            //TOP040 KT ABCSI Sales Order Split by Locations 03052015 Commented per SMT
            {
            IF OLocation = '' THEN OLocation := QuickQuoteWorkSheet."Location Code"
            ELSE OLocation := NLocation;
            NLocation := QuickQuoteWorkSheet."Location Code";
            IF OLocation <> NLocation THEN BEGIN
              SLoc.GET(NLocation);
              CLEAR(SalesHeader);
              SalesHeader.INIT;
              IF CreateType = CreateType::Order THEN
                SalesHeader."Document Type" := SalesHeader."Document Type"::Order
              ELSE IF CreateType = CreateType::Quote THEN
                SalesHeader."Document Type" := SalesHeader."Document Type"::Quote;
              IF "Doc No." = '' THEN BEGIN
                MultiOrder := TRUE;
                SalesHeader.INSERT(TRUE);
                SalesHeader.SetHideValidationDialog(TRUE);
                SalesHeader.VALIDATE("Sell-to Customer No.",InCustFilter);
                LastNo := SalesHeader."No.";
                SalesHeader."Master Order No." := FirstNo;
                SalesHeader."Original Free Freight Base" := OrderTotal;
                SalesHeader.VALIDATE("Payment Terms Code");
                SalesHeader.VALIDATE("Location Code",NLocation);
                SalesHeader.VALIDATE("Order Date",TODAY);
                PrevLocationCode := NLocation;
                SalesHeader.MODIFY(TRUE);
              END;
            END;
            }
            //TOP040 KT ABCSI Sales Order Split by Locations 03052015 Commented per SMT
            SalesLine.INIT;
            SalesLine."Document Type" := SalesHeader."Document Type";
            IF "Doc No." = '' THEN
              SalesLine."Document No." := SalesHeader."No."
            ELSE
              SalesLine."Document No." := "Doc No.";
            SalesLine."Line No." := SalesLineNo;
            SalesLineNo := SalesLineNo + 10000;
            SalesLine.VALIDATE("Sell-to Customer No.",InCustFilter);
            SalesLine.Type := SalesLine.Type::Item;
            SalesLine.VALIDATE("No.",QuickQuoteWorkSheet."Item No.");
            IF QuickQuoteWorkSheet."Location Code" <> '' THEN
              SalesLine.VALIDATE("Location Code",QuickQuoteWorkSheet."Location Code");
            SalesLine.Quantity := QuickQuoteWorkSheet."Current Qty.";
            SalesLine.VALIDATE("Unit of Measure Code",QuickQuoteWorkSheet."Current UOM");
            SalesLine.VALIDATE("Unit Price",QuickQuoteWorkSheet."Unit Price");
            SalesLine."Base UOM Price" := QuickQuoteWorkSheet."Unit Price";
            SalesLine."Last Unit Price" := QuickQuoteWorkSheet."Last Unit Price";
            SalesLine."Last Price UOM" := QuickQuoteWorkSheet."Last Price UOM";
            SalesLine."Last Price Qty." := QuickQuoteWorkSheet."Last Price Qty.";
            SalesLine."Last Price Date" := QuickQuoteWorkSheet."Last Price Date";
            SalesLine."Modified UserID" := USERID;
           SalesLine.INSERT(TRUE);
          UNTIL QuickQuoteWorkSheet.NEXT = 0;
      END ELSE OnlyLost := TRUE;

      StockStatusQuickQuote.RESET;
      StockStatusQuickQuote.DELETEALL;

      QuickQuoteWorkSheet.RESET;
      QuickQuoteWorkSheet.DELETEALL;

      COMMIT;
      IF NOT OnlyLost THEN BEGIN
        IF "Doc No." = '' THEN
          //IF NOT MultiOrder THEN BEGIN //TOP040 KT ABCSI Sales Order Split by Locations 03052015 Commented per SMT
            IF CreateType = CreateType::Order THEN
              PAGE.RUNMODAL(42,SalesHeader)
            ELSE
              PAGE.RUNMODAL(41,SalesHeader);
          //TOP040 KT ABCSI Sales Order Split by Locations 03052015 Commented per SMT
          {
          END ELSE BEGIN
            SOrders.RESET;
            SOrders.SETFILTER("No.",'%1..%2',FirstNo,LastNo);
            SOrders.FIND('-');
            IF CreateType = CreateType::Order THEN
              PAGE.RUNMODAL(PAGE::"Sales Order List",SOrders)
            ELSE
              PAGE.RUNMODAL(PAGE::"Sales Quotes",SOrders);
          END;
          }
          //TOP040 KT ABCSI Sales Order Split by Locations 03052015 Commented per SMT
      END;
    END;

    PROCEDURE ShowWorksheet@1000000004();
    VAR
      QuickQuoteWkshPg@1000000000 : Page 50001;
      LocalOrderTotal@1000000001 : Decimal;
    BEGIN
      QuickQuoteWorkSheet.SETCURRENTKEY("Line No.","Item No.","Sell-To Customer No.");
      QuickQuoteWorkSheet.SETFILTER("Line No.", '<>%1',0);
      PAGE.RUNMODAL(50001,QuickQuoteWorkSheet);
      QuickQuoteWorkSheet.RESET;
      IF QuickQuoteWorkSheet.FIND('-') THEN
        REPEAT
          IF StockStatusQuickQuote.GET(QuickQuoteWorkSheet."Item No.") THEN
            BEGIN
              StockStatusQuickQuote."Current Qty." := QuickQuoteWorkSheet."Current Qty.";
              StockStatusQuickQuote."Current UOM" := QuickQuoteWorkSheet."Current UOM";
              StockStatusQuickQuote."Unit Price" := QuickQuoteWorkSheet."Unit Price";
              StockStatusQuickQuote."Location Code" := QuickQuoteWorkSheet."Location Code";
              StockStatusQuickQuote.MODIFY;
            END;
        UNTIL QuickQuoteWorkSheet.NEXT = 0;
    END;

    PROCEDURE UpdateLine@1000000007();
    VAR
      OK@1000000000 : Boolean;
    BEGIN

      IF (StockStatusQuickQuote.GET("Item No.")) THEN
        BEGIN
          "Current Qty." := StockStatusQuickQuote."Current Qty.";
          "Current UOM" := StockStatusQuickQuote."Current UOM";
          "Unit Price" := StockStatusQuickQuote."Unit Price";
          "Reason Code" := StockStatusQuickQuote."Reason Code";
          "Reason Code Comment" := StockStatusQuickQuote."Reason Code Comment";
          "Lost Opportunity Description" := StockStatusQuickQuote."Lost Opportunity Description";  //TOP230 KT ABCSI CRP 2 Fixes 06092015
          "Lost Opportunity" := StockStatusQuickQuote."Lost Opportunity";
          "Order Date" := TODAY;
          //TOP230 KT ABCSI CRP 2 Fixes 05282015
          "Recomm. Unit Price" := StockStatusQuickQuote."Recomm. Unit Price";
          "Recomm. Multiplier" := StockStatusQuickQuote."Recomm. Multiplier";
          //TOP230 KT ABCSI CRP 2 Fixes 05282015
          IF (StockStatusQuickQuote."Location Code" <> InLocFilter) AND ("Location Code" = xRec."Location Code") THEN BEGIN
            "Location Code" := StockStatusQuickQuote."Location Code";
            "Location Filter" := StockStatusQuickQuote."Location Code"
          END;
          //"Shortcut Dimension 5 Code" := CurrDivisionCodeFilter;
          "Sell-to Customer No." := InCustFilter;
          CALCFIELDS("Cust. Qty. on SO", "Qty. on Sales Order");
          IF Item.GET("Item No.") THEN
            BEGIN
              Description := Item.Description;
              "Unit Cost" := Item."Unit Cost";
              QtyPerUOM := UOMMgt.GetQtyPerUnitOfMeasure(Item,"Current UOM");
              Item.SETRANGE("Location Filter");
              Item.CALCFIELDS(Inventory,"Qty. on Sales Order","Qty. on Purch. Order");
              "Total Qty. on Hand" := Item.Inventory / QtyPerUOM;
              Item.SETRANGE("Location Filter",StockStatusQuickQuote."Location Code");
              Item.CALCFIELDS(Inventory,"Qty. on Sales Order","Qty. on Purch. Order");

              "Quantity Available on Location" := (Item.Inventory - Item."Qty. on Sales Order") / QtyPerUOM;

              "Qty. on Hand" := Item.Inventory / QtyPerUOM;
              "Qty. on Purch. Order" := Item."Qty. on Purch. Order" / QtyPerUOM;
              "Qty. on Sales Order" := Item."Qty. on Sales Order" / QtyPerUOM;
              ItemLead := Item."Lead Time Calculation";
              IF (CompanyInformation."Location Code" <> '') AND (Item3.GET("Item No.")) THEN BEGIN
                Item3.SETFILTER("Location Filter",CompanyInformation."Location Code");
                Item3.CALCFIELDS(Inventory,"Qty. on Sales Order");
                "Main Loc. Qty. Avail" := (Item3.Inventory - Item3."Qty. on Sales Order") / QtyPerUOM;
              END ELSE CLEAR("Main Loc. Qty. Avail");
              //TOP230 KT ABCSI CRP 2 Fixes 05282015
              "Low Unit Price" := Item."Low Unit Price";
              "High Unit Price" := Item."High Unit Price";
              "Medium Unit Price" := Item."Medium Unit Price";
              //TOP230 KT ABCSI CRP 2 Fixes 05282015
            END;

            SalesPrice.RESET;
            SalesPrice.SETRANGE("Item No.","Item No.");
            SalesPrice.SETRANGE("Sales Type",SalesPrice."Sales Type"::Customer);
            SalesPrice.SETRANGE("Sales Code",InCustFilter);
            IF SalesPrice.FINDLAST THEN BEGIN
              "Last Price Change Date" := SalesPrice."Starting Date";
              //"Low Unit Price" := SalesPrice."Low Unit Price";
              //"High Unit Price" := SalesPrice."High Unit Price";
              //"Medium Unit Price" := SalesPrice."Medium Unit Price";
              "Curr. Unit Price Starting Date" := SalesPrice."Starting Date";
              "Curr. Unit Price Ending Date" := SalesPrice."Ending Date";
            END;

          //Find Last Lost Opportunity
          LastLostOpportunity.RESET;
          LastLostOpportunity.SETRANGE("Document Type",LastLostOpportunity."Document Type"::"3");
          LastLostOpportunity.SETRANGE("No.","Item No.");
          LastLostOpportunity.SETRANGE("Sell-to Customer No.",InCustFilter);
          IF LastLostOpportunity.FINDLAST THEN BEGIN
            "Last Lost Opportunity" := TRUE;
            "Last Reason Code" := LastLostOpportunity."Reason Code";
            "Last Reason Code Comment" := LastLostOpportunity."Reason Code Comment";
          END;

          //Find Last Quoted Unit Price and related fields
          LastSalesPrice.RESET;
          //TOP180 KT ABCSI Customer Pricing - Hot Sheets 04162015 Start
          LastSalesPrice.ASCENDING;
          LastSalesPrice.SETCURRENTKEY("Sell-to Customer No.","Item No.","Document Date");
          //TOP180 KT ABCSI Customer Pricing - Hot Sheets 04162015 Start
          LastSalesPrice.SETRANGE("Document Type",LastSalesPrice."Document Type"::Quote);
          LastSalesPrice.SETRANGE("Sell-to Customer No.",InCustFilter);
          LastSalesPrice.SETRANGE("Item No.","Item No.");
          LastSalesPrice.SETRANGE("Unit of Measure Code","Base Unit of Measure");
          IF LastSalesPrice.FINDLAST THEN BEGIN
            "Last Quoted Unit Price" := LastSalesPrice."Last Unit Price";
            "Last Quoted UOM" := LastSalesPrice."Last Price UOM";
            "Last Quoted Qty." := LastSalesPrice."Last Price Qty.";
          END ELSE BEGIN
            "Last Quoted Unit Price" := 0;
            "Last Quoted UOM" := '';
            "Last Quoted Qty." := 0;
          END;

          //Find Last Invoiced Unit Price and related fields
          LastSalesPrice.RESET;
          //TOP180 KT ABCSI Customer Pricing - Hot Sheets 04162015 Start
          LastSalesPrice.ASCENDING;
          LastSalesPrice.SETCURRENTKEY("Sell-to Customer No.","Item No.","Document Date");
          //TOP180 KT ABCSI Customer Pricing - Hot Sheets 04162015 Start
          LastSalesPrice.SETRANGE("Document Type",LastSalesPrice."Document Type"::"Posted Sales Invoice");
          LastSalesPrice.SETRANGE("Sell-to Customer No.",InCustFilter);
          LastSalesPrice.SETRANGE("Item No.","Item No.");
          LastSalesPrice.SETRANGE("Unit of Measure Code","Base Unit of Measure");
          IF LastSalesPrice.FINDLAST THEN BEGIN
            "Last Invoice Price" := LastSalesPrice."Last Unit Price";
            "Last Invoiced Qty." := LastSalesPrice."Last Price Qty.";
          END ELSE BEGIN
            "Last Invoice Price" := 0;
            "Last Invoiced Qty." := 0;
          END;

          //Find Last Unit Price and related fields
          LastSalesPrice.RESET;
          //TOP180 KT ABCSI Customer Pricing - Hot Sheets 04162015 Start
          LastSalesPrice.ASCENDING;
          LastSalesPrice.SETCURRENTKEY("Sell-to Customer No.","Item No.","Document Date");
          //TOP180 KT ABCSI Customer Pricing - Hot Sheets 04162015 Start
          LastSalesPrice.SETRANGE("Sell-to Customer No.",InCustFilter);
          LastSalesPrice.SETRANGE("Item No.","Item No.");
          IF LastSalesPrice.FINDLAST THEN BEGIN
            "Last Unit Price" := LastSalesPrice."Last Unit Price";
            "Last Price UOM" := LastSalesPrice."Last Price UOM";
            "Last Price Qty." := LastSalesPrice."Last Price Qty.";
            "Last Price Date" := LastSalesPrice."Last Price Date";
            "Last Price User ID" := LastSalesPrice."Last Price User ID";  //TOP010E KT ABCSI 07282015
          END ELSE BEGIN
            "Last Unit Price" := 0;
            "Last Price UOM" := '';
            "Last Price Qty." := 0;
            "Last Price Date" := 0D;
            "Last Price User ID" := '';  //TOP010E KT ABCSI 07282015
          END;


        END
      ELSE
        BEGIN
        IF Item.GET("Item No.") THEN
          BEGIN
            Description := Item.Description;
            "Unit Cost" := Item."Unit Cost";
            ItemUnitPrice := Item."Unit Price";
            "Unit Price" := 0;
            "Order Date" := TODAY;
            "Current UOM" := Item."Sales Unit of Measure";
            QtyPerUOM := UOMMgt.GetQtyPerUnitOfMeasure(Item,"Current UOM");
            Item.SETRANGE("Location Filter");
            Item.CALCFIELDS(Inventory,"Qty. on Sales Order","Qty. on Purch. Order");
            "Total Qty. on Hand" := Item.Inventory / QtyPerUOM;
            Item.SETRANGE("Location Filter",InLocFilter);
            Item.CALCFIELDS(Inventory,"Qty. on Sales Order","Qty. on Purch. Order");

            "Quantity Available on Location" := (Item.Inventory - Item."Qty. on Sales Order") / QtyPerUOM;

            "Qty. on Hand" := Item.Inventory / QtyPerUOM;
            "Qty. on Purch. Order" := Item."Qty. on Purch. Order" / QtyPerUOM;
            "Qty. on Sales Order" := Item."Qty. on Sales Order" / QtyPerUOM;
            ItemLead := Item."Lead Time Calculation";
            IF (CompanyInformation."Location Code" <> '') AND (Item3.GET("Item No.")) THEN BEGIN
              Item3.SETFILTER("Location Filter",CompanyInformation."Location Code");
              Item3.CALCFIELDS(Inventory,"Qty. on Sales Order");
              "Main Loc. Qty. Avail" := (Item3.Inventory - Item3."Qty. on Sales Order") / QtyPerUOM;
            END ELSE CLEAR("Main Loc. Qty. Avail");
            "Current Qty." := 0;
            BaseUOM := Item."Base Unit of Measure";
            "Location Code" := InLocFilter;
            //"Shortcut Dimension 5 Code" := CurrDivisionCodeFilter;
            CALCFIELDS("Cust. Qty. on SO", "Qty. on Sales Order");
            "Sell-to Customer No." := InCustFilter;
            "Vendor Item No." := Item."Vendor Item No.";

            //TOP230 KT ABCSI CRP 2 Fixes 05282015
            "Low Unit Price" := Item."Low Unit Price";
            "High Unit Price" := Item."High Unit Price";
            "Medium Unit Price" := Item."Medium Unit Price";
            //TOP230 KT ABCSI CRP 2 Fixes 05282015

            SalesPrice.RESET;
            SalesPrice.SETRANGE("Item No.","Item No.");
            SalesPrice.SETRANGE("Sales Type",SalesPrice."Sales Type"::Customer);
            SalesPrice.SETRANGE("Sales Code",InCustFilter);
            IF SalesPrice.FINDLAST THEN BEGIN
              "Last Price Change Date" := SalesPrice."Starting Date";
              //"Low Unit Price" := SalesPrice."Low Unit Price";
              //"High Unit Price" := SalesPrice."High Unit Price";
              //"Medium Unit Price" := SalesPrice."Medium Unit Price";
              "Curr. Unit Price Starting Date" := SalesPrice."Starting Date";
              "Curr. Unit Price Ending Date" := SalesPrice."Ending Date";
            END;


            //Find Last Lost Opportunity
            LastLostOpportunity.RESET;
            LastLostOpportunity.SETRANGE("Document Type",LastLostOpportunity."Document Type"::"3");
            LastLostOpportunity.SETRANGE("No.","Item No.");
            LastLostOpportunity.SETRANGE("Sell-to Customer No.",InCustFilter);
            IF LastLostOpportunity.FINDLAST THEN BEGIN
              "Last Lost Opportunity" := TRUE;
              "Last Reason Code" := LastLostOpportunity."Reason Code";
              "Last Reason Code Comment" := LastLostOpportunity."Reason Code Comment";
            END;

            //Find Last Quoted Unit Price and related fields
            LastSalesPrice.RESET;
            //TOP180 KT ABCSI Customer Pricing - Hot Sheets 04162015 Start
            LastSalesPrice.ASCENDING;
            LastSalesPrice.SETCURRENTKEY("Sell-to Customer No.","Item No.","Document Date");
            //TOP180 KT ABCSI Customer Pricing - Hot Sheets 04162015 Start
            LastSalesPrice.SETRANGE("Document Type",LastSalesPrice."Document Type"::Quote);
            LastSalesPrice.SETRANGE("Sell-to Customer No.",InCustFilter);
            LastSalesPrice.SETRANGE("Item No.","Item No.");
            LastSalesPrice.SETRANGE("Unit of Measure Code","Base Unit of Measure");
            IF LastSalesPrice.FINDLAST THEN BEGIN
              "Last Quoted Unit Price" := LastSalesPrice."Last Unit Price";
              "Last Quoted UOM" := LastSalesPrice."Last Price UOM";
              "Last Quoted Qty." := LastSalesPrice."Last Price Qty.";
            END ELSE BEGIN
              "Last Quoted Unit Price" := 0;
              "Last Quoted UOM" := '';
              "Last Quoted Qty." := 0;
            END;

            //Find Last Invoiced Unit Price and related fields
            LastSalesPrice.RESET;
            //TOP180 KT ABCSI Customer Pricing - Hot Sheets 04162015 Start
            LastSalesPrice.ASCENDING;
            LastSalesPrice.SETCURRENTKEY("Sell-to Customer No.","Item No.","Document Date");
            //TOP180 KT ABCSI Customer Pricing - Hot Sheets 04162015 Start
            LastSalesPrice.SETRANGE("Document Type",LastSalesPrice."Document Type"::"Posted Sales Invoice");
            LastSalesPrice.SETRANGE("Sell-to Customer No.",InCustFilter);
            LastSalesPrice.SETRANGE("Item No.","Item No.");
            LastSalesPrice.SETRANGE("Unit of Measure Code","Base Unit of Measure");
            IF LastSalesPrice.FINDLAST THEN BEGIN
              "Last Invoice Price" := LastSalesPrice."Last Unit Price";
              "Last Invoiced Qty." := LastSalesPrice."Last Price Qty.";
            END ELSE BEGIN
              "Last Invoice Price" := 0;
              "Last Invoiced Qty." := 0;
            END;

            LastSalesPrice.RESET;
            //TOP180 KT ABCSI Customer Pricing - Hot Sheets 04162015 Start
            LastSalesPrice.ASCENDING;
            LastSalesPrice.SETCURRENTKEY("Sell-to Customer No.","Item No.","Document Date");
            //TOP180 KT ABCSI Customer Pricing - Hot Sheets 04162015 Start
            LastSalesPrice.SETRANGE("Sell-to Customer No.",InCustFilter);
            LastSalesPrice.SETRANGE("Item No.","Item No.");
            IF LastSalesPrice.FINDLAST THEN BEGIN
              "Last Unit Price" := LastSalesPrice."Last Unit Price";
              //TOP010D KT ABCSI SSQQ Unit Price 07142015
              IF ("Shortcut Dimension 5 Code" = 'I') OR ("Shortcut Dimension 5 Code" = 'L') THEN
                "Unit Price" := LastSalesPrice."Last Unit Price";
              //TOP010D KT ABCSI SSQQ Unit Price 07142015
              "Last Price UOM" := LastSalesPrice."Last Price UOM";
              "Last Price Qty." := LastSalesPrice."Last Price Qty.";
              "Last Price Date" := LastSalesPrice."Last Price Date";
              "Last Price User ID" := LastSalesPrice."Last Price User ID";  //TOP010E KT ABCSI 07282015
            END ELSE BEGIN
              "Last Unit Price" := 0;
              "Last Price UOM" := '';
              "Last Price Qty." := 0;
              "Last Price Date" := 0D;
              "Last Price User ID" := '';  //TOP010E KT ABCSI 07282015
            END;
            //TOP010D KT ABCSI SSQQ Unit Price 07142015
            IF "Shortcut Dimension 5 Code" = 'E' THEN
              "Unit Price" := "Recomm. Unit Price";
            //TOP010D KT ABCSI SSQQ Unit Price 07142015
          END;
        END;
    END;

    PROCEDURE UpdateSingleLine@1000000009(LineLocation@1000000000 : Code[10]);
    BEGIN

      IF (StockStatusQuickQuote.GET("Item No.")) THEN
        BEGIN
          "Current Qty." := StockStatusQuickQuote."Current Qty.";
          "Current UOM" := StockStatusQuickQuote."Current UOM";
          "Unit Price" := StockStatusQuickQuote."Unit Price";
          "Reason Code" := StockStatusQuickQuote."Reason Code";
          "Reason Code Comment" := StockStatusQuickQuote."Reason Code Comment";
          "Lost Opportunity Description" := StockStatusQuickQuote."Lost Opportunity Description";  //TOP230 KT ABCSI CRP 2 Fixes 06092015
          "Lost Opportunity" := StockStatusQuickQuote."Lost Opportunity";
          "Location Code" := LineLocation;
          "Order Date" := TODAY;
          //TOP230 KT ABCSI CRP 2 Fixes 05282015
          "Recomm. Unit Price" := StockStatusQuickQuote."Recomm. Unit Price";
          "Recomm. Multiplier" := StockStatusQuickQuote."Recomm. Multiplier";
          //TOP230 KT ABCSI CRP 2 Fixes 05282015
          //"Shortcut Dimension 5 Code" := CurrDivisionCodeFilter;
          "Sell-to Customer No." := InCustFilter;
          IF Item.GET("Item No.") THEN
            BEGIN
              Description := Item.Description;
              "Unit Cost" := Item."Unit Cost";
              ItemUnitPrice := Item."Unit Price";
              QtyPerUOM := UOMMgt.GetQtyPerUnitOfMeasure(Item,"Current UOM");
              Item.SETRANGE("Location Filter");
              Item.CALCFIELDS(Inventory,"Qty. on Sales Order","Qty. on Purch. Order");
              "Total Qty. on Hand" := Item.Inventory / QtyPerUOM;
              Item.SETFILTER("Location Filter","Location Code");
              Item.CALCFIELDS(Inventory,"Qty. on Sales Order","Qty. on Purch. Order");

              "Quantity Available on Location" := (Item.Inventory - Item."Qty. on Sales Order") / QtyPerUOM;

              "Qty. on Hand" := Item.Inventory / QtyPerUOM;
              "Qty. on Purch. Order" := Item."Qty. on Purch. Order" / QtyPerUOM;
              "Qty. on Sales Order" := Item."Qty. on Sales Order" / QtyPerUOM;

              IF (CompanyInformation."Location Code" <> '') AND (Item3.GET("Item No.")) THEN BEGIN
                Item3.SETFILTER("Location Filter",CompanyInformation."Location Code");
                Item3.CALCFIELDS(Inventory,"Qty. on Sales Order");
                "Main Loc. Qty. Avail" := (Item3.Inventory - Item3."Qty. on Sales Order") / QtyPerUOM;
              END ELSE CLEAR("Main Loc. Qty. Avail");
              //TOP230 KT ABCSI CRP 2 Fixes 05282015
              "Low Unit Price" := Item."Low Unit Price";
              "High Unit Price" := Item."High Unit Price";
              "Medium Unit Price" := Item."Medium Unit Price";
              //TOP230 KT ABCSI CRP 2 Fixes 05282015
            END;

            SalesPrice.RESET;
            SalesPrice.SETRANGE("Item No.","Item No.");
            SalesPrice.SETRANGE("Sales Type",SalesPrice."Sales Type"::Customer);
            SalesPrice.SETRANGE("Sales Code",InCustFilter);
            IF SalesPrice.FINDLAST THEN BEGIN
              "Last Price Change Date" := SalesPrice."Starting Date";
              //"Low Unit Price" := SalesPrice."Low Unit Price";
              //"High Unit Price" := SalesPrice."High Unit Price";
              //"Medium Unit Price" := SalesPrice."Medium Unit Price";
              "Curr. Unit Price Starting Date" := SalesPrice."Starting Date";
              "Curr. Unit Price Ending Date" := SalesPrice."Ending Date";
            END;


            //Find Last Quoted Unit Price and related fields
            LastSalesPrice.RESET;
            //TOP180 KT ABCSI Customer Pricing - Hot Sheets 04162015 Start
            LastSalesPrice.ASCENDING;
            LastSalesPrice.SETCURRENTKEY("Sell-to Customer No.","Item No.","Document Date");
            //TOP180 KT ABCSI Customer Pricing - Hot Sheets 04162015 End
            LastSalesPrice.SETRANGE("Document Type",LastSalesPrice."Document Type"::Quote);
            LastSalesPrice.SETRANGE("Sell-to Customer No.",InCustFilter);
            LastSalesPrice.SETRANGE("Item No.","Item No.");
            LastSalesPrice.SETRANGE("Unit of Measure Code","Base Unit of Measure");
            IF LastSalesPrice.FINDLAST THEN BEGIN
              "Last Quoted Unit Price" := LastSalesPrice."Last Unit Price";
              "Last Quoted UOM" := LastSalesPrice."Last Price UOM";
              "Last Quoted Qty." := LastSalesPrice."Last Price Qty.";
            END ELSE BEGIN
              "Last Quoted Unit Price" := 0;
              "Last Quoted UOM" := '';
              "Last Quoted Qty." := 0;
            END;

            //Find Last Invoiced Unit Price and related fields
            LastSalesPrice.RESET;
            //TOP180 KT ABCSI Customer Pricing - Hot Sheets 04162015 Start
            LastSalesPrice.ASCENDING;
            LastSalesPrice.SETCURRENTKEY("Sell-to Customer No.","Item No.","Document Date");
            //TOP180 KT ABCSI Customer Pricing - Hot Sheets 04162015 End
            LastSalesPrice.SETRANGE("Document Type",LastSalesPrice."Document Type"::"Posted Sales Invoice");
            LastSalesPrice.SETRANGE("Sell-to Customer No.",InCustFilter);
            LastSalesPrice.SETRANGE("Item No.","Item No.");
            LastSalesPrice.SETRANGE("Unit of Measure Code","Base Unit of Measure");
            IF LastSalesPrice.FINDLAST THEN BEGIN
              "Last Invoice Price" := LastSalesPrice."Last Unit Price";
              "Last Invoiced Qty." := LastSalesPrice."Last Price Qty.";
            END ELSE BEGIN
              "Last Invoice Price" := 0;
              "Last Invoiced Qty." := 0;
            END;

            //Find Last Unit Price and related fields
            LastSalesPrice.RESET;
            //TOP180 KT ABCSI Customer Pricing - Hot Sheets 04162015 Start
            LastSalesPrice.ASCENDING;
            LastSalesPrice.SETCURRENTKEY("Sell-to Customer No.","Item No.","Document Date");
            //TOP180 KT ABCSI Customer Pricing - Hot Sheets 04162015 End
            LastSalesPrice.SETRANGE("Sell-to Customer No.",InCustFilter);
            LastSalesPrice.SETRANGE("Item No.","Item No.");
            IF LastSalesPrice.FINDLAST THEN BEGIN
              "Last Unit Price" := LastSalesPrice."Last Unit Price";
              "Last Price UOM" := LastSalesPrice."Last Price UOM";
              "Last Price Qty." := LastSalesPrice."Last Price Qty.";
              "Last Price Date" := LastSalesPrice."Last Price Date";
              "Last Price User ID" := LastSalesPrice."Last Price User ID";  //TOP010E KT ABCSI 07282015
            END ELSE BEGIN
              "Last Unit Price" := 0;
              "Last Price UOM" := '';
              "Last Price Qty." := 0;
              "Last Price Date" := 0D;
              "Last Price User ID" := '';  //TOP010E KT ABCSI 07282015
            END;
        END
      ELSE
        BEGIN
        IF Item.GET("Item No.") THEN
          BEGIN
            "Unit Cost" := Item."Unit Cost";
            ItemUnitPrice := Item."Unit Price";
            "Unit Price" := 0;
            "Order Date" := TODAY;
            "Current UOM" := Item."Sales Unit of Measure";
            QtyPerUOM := UOMMgt.GetQtyPerUnitOfMeasure(Item,"Current UOM");
            Item.SETRANGE("Location Filter");
            Item.CALCFIELDS(Inventory,"Qty. on Sales Order","Qty. on Purch. Order");
            "Total Qty. on Hand" := Item.Inventory / QtyPerUOM;
            Item.SETRANGE("Location Filter",LineLocation);
            Item.CALCFIELDS(Inventory,"Qty. on Sales Order","Qty. on Purch. Order");

            "Quantity Available on Location" := (Item.Inventory - Item."Qty. on Sales Order") / QtyPerUOM;

            "Qty. on Hand" := Item.Inventory / QtyPerUOM;
            "Qty. on Purch. Order" := Item."Qty. on Purch. Order" / QtyPerUOM;
            "Qty. on Sales Order" := Item."Qty. on Sales Order" / QtyPerUOM;
            ItemLead := Item."Lead Time Calculation";
            IF (CompanyInformation."Location Code" <> '') AND (Item3.GET("Item No.")) THEN BEGIN
              Item3.SETFILTER("Location Filter",CompanyInformation."Location Code");
              Item3.CALCFIELDS(Inventory,"Qty. on Sales Order");
              "Main Loc. Qty. Avail" := (Item3.Inventory - Item3."Qty. on Sales Order") / QtyPerUOM;
            END ELSE CLEAR("Main Loc. Qty. Avail");
            "Current Qty." := 0;
            BaseUOM := Item."Base Unit of Measure";
            "Location Code" := LineLocation;
            //"Shortcut Dimension 5 Code" := CurrDivisionCodeFilter;
            "Sell-to Customer No." := InCustFilter;
            "Vendor Item No." := Item."Vendor Item No.";

            //TOP230 KT ABCSI CRP 2 Fixes 05282015
            "Low Unit Price" := Item."Low Unit Price";
            "High Unit Price" := Item."High Unit Price";
            "Medium Unit Price" := Item."Medium Unit Price";
            //TOP230 KT ABCSI CRP 2 Fixes 05282015

            SalesPrice.RESET;
            SalesPrice.SETRANGE("Item No.","Item No.");
            SalesPrice.SETRANGE("Sales Type",SalesPrice."Sales Type"::Customer);
            SalesPrice.SETRANGE("Sales Code",InCustFilter);
            IF SalesPrice.FINDLAST THEN BEGIN
              "Last Price Change Date" := SalesPrice."Starting Date";
              //"Low Unit Price" := SalesPrice."Low Unit Price";
              //"High Unit Price" := SalesPrice."High Unit Price";
              //"Medium Unit Price" := SalesPrice."Medium Unit Price";
              "Curr. Unit Price Starting Date" := SalesPrice."Starting Date";
              "Curr. Unit Price Ending Date" := SalesPrice."Ending Date";
            END;


            //Find Last Quoted Unit Price and related fields
            LastSalesPrice.RESET;
            //TOP180 KT ABCSI Customer Pricing - Hot Sheets 04162015 Start
            LastSalesPrice.ASCENDING;
            LastSalesPrice.SETCURRENTKEY("Sell-to Customer No.","Item No.","Document Date");
            //TOP180 KT ABCSI Customer Pricing - Hot Sheets 04162015 End
            LastSalesPrice.SETRANGE("Document Type",LastSalesPrice."Document Type"::Quote);
            LastSalesPrice.SETRANGE("Sell-to Customer No.",InCustFilter);
            LastSalesPrice.SETRANGE("Item No.","Item No.");
            LastSalesPrice.SETRANGE("Unit of Measure Code","Current UOM");
            IF LastSalesPrice.FINDLAST THEN BEGIN
              "Last Quoted Unit Price" := LastSalesPrice."Last Unit Price";
              "Last Quoted UOM" := LastSalesPrice."Last Price UOM";
              "Last Quoted Qty." := LastSalesPrice."Last Price Qty.";
            END ELSE BEGIN
              "Last Quoted Unit Price" := 0;
              "Last Quoted UOM" := '';
              "Last Quoted Qty." := 0;
            END;

            //Find Last Invoiced Unit Price and related fields
            LastSalesPrice.RESET;
            //TOP180 KT ABCSI Customer Pricing - Hot Sheets 04162015 Start
            LastSalesPrice.ASCENDING;
            LastSalesPrice.SETCURRENTKEY("Sell-to Customer No.","Item No.","Document Date");
            //TOP180 KT ABCSI Customer Pricing - Hot Sheets 04162015 End
            LastSalesPrice.SETRANGE("Document Type",LastSalesPrice."Document Type"::"Posted Sales Invoice");
            LastSalesPrice.SETRANGE("Sell-to Customer No.",InCustFilter);
            LastSalesPrice.SETRANGE("Item No.","Item No.");
            LastSalesPrice.SETRANGE("Unit of Measure Code","Current UOM");
            IF LastSalesPrice.FINDLAST THEN BEGIN
              "Last Invoice Price" := LastSalesPrice."Last Unit Price";
              "Last Invoiced Qty." := LastSalesPrice."Last Price Qty.";
            END ELSE BEGIN
              "Last Invoice Price" := 0;
              "Last Invoiced Qty." := 0;
            END;

            //Find Last Unit Price and related fields
            LastSalesPrice.RESET;
            //TOP180 KT ABCSI Customer Pricing - Hot Sheets 04162015 Start
            LastSalesPrice.ASCENDING;
            LastSalesPrice.SETCURRENTKEY("Sell-to Customer No.","Item No.","Document Date");
            //TOP180 KT ABCSI Customer Pricing - Hot Sheets 04162015 End
            LastSalesPrice.SETRANGE("Sell-to Customer No.",InCustFilter);
            LastSalesPrice.SETRANGE("Item No.","Item No.");
            IF LastSalesPrice.FINDLAST THEN BEGIN
              "Last Unit Price" := LastSalesPrice."Last Unit Price";
              "Last Price UOM" := LastSalesPrice."Last Price UOM";
              "Last Price Qty." := LastSalesPrice."Last Price Qty.";
              "Last Price Date" := LastSalesPrice."Last Price Date";
              "Last Price User ID" := LastSalesPrice."Last Price User ID";  //TOP010E KT ABCSI 07282015
            END ELSE BEGIN
              "Last Unit Price" := 0;
              "Last Price UOM" := '';
              "Last Price Qty." := 0;
              "Last Price Date" := 0D;
              "Last Price User ID" := '';  //TOP010E KT ABCSI 07282015
            END;
          END;
        END;
    END;

    PROCEDURE CheckLostOpportunity@1000000016();
    VAR
      "LostQuoteNo."@1000000000 : Code[10];
    BEGIN
      QuickQuoteWorkSheet.RESET;
      QuickQuoteWorkSheet.SETCURRENTKEY("Location Code",Description,"Item No.","Sell-To Customer No.");
      QuickQuoteWorkSheet.SETFILTER("Current Qty.",'<>%1',0);
      QuickQuoteWorkSheet.SETFILTER("Lost Opportunity",'%1',TRUE);
      IF QuickQuoteWorkSheet.FIND('-') THEN REPEAT
        UpDateLostOpportunity(DocType::"Stock Status","LostQuoteNo.",QuickQuoteWorkSheet."Line No."*10000,QuickQuoteWorkSheet,QuickQuoteWorkSheet."Location Code");
      UNTIL QuickQuoteWorkSheet.NEXT = 0;
    END;

    PROCEDURE CalcTotal@1000000010(VAR MultiOrder@1000000000 : Boolean) OrderTotal : Decimal;
    VAR
      OLocation@1000000001 : Code[10];
    BEGIN
      CLEAR(OLocation);
      QuickQuoteWorkSheet.RESET;
      QuickQuoteWorkSheet.SETCURRENTKEY("Location Code",Description,"Item No.","Sell-To Customer No.");
      QuickQuoteWorkSheet.SETFILTER("Current Qty.",'<>%1',0);
      QuickQuoteWorkSheet.SETRANGE("Sell-To Customer No.",InCustFilter);
      IF QuickQuoteWorkSheet.FIND('-') THEN REPEAT
        IF OLocation = '' THEN OLocation := QuickQuoteWorkSheet."Location Code"
        ELSE IF QuickQuoteWorkSheet."Location Code" <> OLocation THEN MultiOrder := TRUE;
        OLocation := QuickQuoteWorkSheet."Location Code";
        OrderTotal += QuickQuoteWorkSheet."Current Qty (Base)" * QuickQuoteWorkSheet."Unit Price";
      UNTIL QuickQuoteWorkSheet.NEXT = 0;
    END;

    PROCEDURE VerifySalesLine@1000000017() HasLine : Boolean;
    BEGIN
      StockStatusQuickQuote.SETFILTER("Lost Opportunity",'%1',FALSE);
      HasLine := (StockStatusQuickQuote.COUNT <> 0);
    END;

    PROCEDURE FetchRecommFieldValues@1000000006(ItemNo@1000000001 : Code[20];CustNo@1000000000 : Code[20]);
    VAR
      LocalItem@1000000002 : Record 27;
      SalesSetup@1000000003 : Record 311;
      NoSeriesMgt@1000000004 : Codeunit 396;
      TSalesHeader@1000000005 : Record 36;
      TSalesLine@1000000006 : Record 37;
    BEGIN
      IF ItemNo = '' THEN
        EXIT;

      IF CustNo = '' THEN
        EXIT;

      IF "Shortcut Dimension 5 Code" = 'E' THEN BEGIN //TOP010D KT ABCSI SSQQ Unit Price 07142015
        //TOP230 KT ABCSI CRP 2 Fixes 05012015
        LocalItem.GET(ItemNo);
        SalesSetup.GET;
        SalesSetup.TESTFIELD("Temp Order Nos.");
        //TOP230 KT ABCSI CRP 2 Fixes 05012015
        //IF NOT TSalesHeader.GET(TSalesHeader."Document Type"::Order,ab_Text001) THEN BEGIN
          TSalesHeader."Document Type" := TSalesHeader."Document Type"::Order;
          TSalesHeader.VALIDATE("No.",NoSeriesMgt.GetNextNo(SalesSetup."Temp Order Nos.",WORKDATE,TRUE));//TOP230 KT ABCSI CRP 2 Fixes 05012015
          TSalesHeader.INSERT(TRUE);
          TSalesHeader.SetHideValidationDialog(TRUE);
          TSalesHeader.VALIDATE("Sell-to Customer No.",CustNo);
          TSalesHeader.VALIDATE("Shortcut Dimension 5 Code",CurrDivisionCodeFilter); //TOP10B KT ABCSI - SSQQ Division Code 07142015
          IF TSalesHeader."Shortcut Dimension 5 Code" = '' THEN
            TSalesHeader.VALIDATE("Shortcut Dimension 5 Code",LocalItem."Shortcut Dimension 5 Code");
          TSalesHeader."Location Code" := "Location Code";
          TSalesHeader.VALIDATE("Order Date",TODAY);
          TSalesHeader.MODIFY(TRUE);
        //END;

          TSalesLine.RESET;
          TSalesLine.SETCURRENTKEY("Document Type","Document No.");
          TSalesLine.SETRANGE(TSalesLine."Document Type",TSalesHeader."Document Type");
          TSalesLine.SETRANGE(TSalesLine."Document No.",TSalesHeader."No.");
          IF TSalesLine.FIND('+') THEN
            SalesLineNo := TSalesLine."Line No." + 10000
          ELSE
            SalesLineNo := 10000;

          TSalesLine.INIT;
          TSalesLine."Document Type" := TSalesLine."Document Type"::Order;
          TSalesLine."Document No." := TSalesHeader."No.";
          TSalesLine."Line No." := SalesLineNo;
          TSalesLine.VALIDATE("Sell-to Customer No.",CustNo);
          TSalesLine.Type := TSalesLine.Type::Item;
          TSalesLine.VALIDATE("No.",ItemNo);
          TSalesLine.VALIDATE("Location Code","Location Code");
          TSalesLine.Quantity := 1;
          TSalesLine.INSERT(TRUE);

        "Recomm. Multiplier" := TSalesLine."Recomm. Multiplier";
        "Recomm. Unit Price" := TSalesLine."Recomm. Unit Price";
        "Unit Price" := TSalesLine."Recomm. Unit Price";

        TSalesHeader.DELETE(TRUE);
      END ELSE BEGIN
        LastSalesPrice.RESET;
        LastSalesPrice.ASCENDING;
        LastSalesPrice.SETCURRENTKEY("Sell-to Customer No.","Item No.","Document Date");
        LastSalesPrice.SETRANGE("Sell-to Customer No.",InCustFilter);
        LastSalesPrice.SETRANGE("Item No.","Item No.");
        IF LastSalesPrice.FINDLAST THEN BEGIN
          "Last Unit Price" := LastSalesPrice."Last Unit Price";
          "Last Price UOM" := LastSalesPrice."Last Price UOM";
          "Last Price Qty." := LastSalesPrice."Last Price Qty.";
          "Last Price Date" := LastSalesPrice."Last Price Date";
          "Last Price User ID" := LastSalesPrice."Last Price User ID";  //TOP010E KT ABCSI 07282015
        END ELSE BEGIN
          "Last Unit Price" := 0;
          "Last Price UOM" := '';
          "Last Price Qty." := 0;
          "Last Price Date" := 0D;
          "Last Price User ID" := '';  //TOP010E KT ABCSI 07282015
        END;
        "Unit Price" := "Last Unit Price";
      END;
      //TOP010D KT ABCSI SSQQ Unit Price 07142015
    END;

    PROCEDURE SetDocumentFilters@1000000032(DocType@1000000000 : 'Order,Quote';DocNo@1000000001 : Code[20];varLocCode@1000000004 : Code[10];varCustNo@1000000002 : Code[20];varDivisionCodeFilter@1000000003 : Code[20]);
    BEGIN
      DocumentType := DocType;
      DocumentNo := DocNo;
      CustNo := varCustNo;
      LocationCode := varLocCode;
      IF CustRec.GET(CustNo) THEN
        CustName := CustRec.Name
      ELSE
        CustName := '';
      DivisionCodeFilter := varDivisionCodeFilter;
    END;

    PROCEDURE RefreshLines@1000000011();
    BEGIN

      SetUserFilters(CustNo,LocationCode,DivisionCodeFilter);
      Refresh(TRUE);
    END;

    BEGIN
    {
      TOP170 KT ABCSI Sales Order Updates 06302015
        - Created this page as part of the fixes.

      TOP010B KT ABCSI SSQQ Division Code 07142015
        - Created a new function UserPrompt for checking the curr. qty field

      TOP10C KT ABCSI - SSQQ Item Search 07142015
        - Added a function FindItemNo

      TOP010D KT ABCSI SSQQ Unit Price 07142015
        - Added code in UpdateLine function to update the Unit Price and Recomm. Unit Price

      TOP10E KT ABCSI - Additional Stock Status 07282015
        - Added a function FindVendItemNo
        - Added a new field Vendor Item No. Filter
        - Added a new field 'Last Price User ID' and the code to populate the field
      TPZ2785 05112020 GGUPTA Remove Item blocking Topaz Customization
    }
    END.
  }
}

