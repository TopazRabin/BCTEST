OBJECT Page 14000827 Bill of Lading Worksheet
{
  OBJECT-PROPERTIES
  {
    Date=02/25/19;
    Time=12:00:00 PM;
    Version List=SE0.61;
  }
  PROPERTIES
  {
    Permissions=TableData 36=rm;
    Editable=No;
    CaptionML=ENU=Bill of Lading Worksheet;
    SourceTable=Table14000822;
    PageType=Card;
    OnOpenPage=BEGIN
                 ShippingSetup.GET;
                 PackingStation.GetPackingStation;
               END;

    OnAfterGetRecord=BEGIN
                       UpdateValues;
                     END;

    ActionList=ACTIONS
    {
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 25      ;1   ;ActionGroup;
                      CaptionML=ENU=F&unctions }
      { 28      ;2   ;ActionGroup;
                      CaptionML=ENU=Add }
      { 26      ;3   ;Action    ;
                      CaptionML=ENU=Add Sales &Order;
                      Promoted=Yes;
                      Image=NewDocument;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 AddSalesHeader(1);

                                 UpdateValues;
                               END;
                                }
      { 29      ;3   ;Action    ;
                      ShortCutKey=Ctrl+F11;
                      CaptionML=ENU=Add Posted Sales &Shipments;
                      Promoted=Yes;
                      Image=NewDocument;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 AddPostedSalesShipment;

                                 UpdateValues;
                               END;
                                }
      { 30      ;3   ;Action    ;
                      CaptionML=ENU=Add Posted &Packages;
                      Promoted=Yes;
                      Image=ItemTracing;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 AddPostedPackages;

                                 UpdateValues;
                               END;
                                }
      { 1240030010;3 ;Action    ;
                      CaptionML=ENU=Add &Bill of Lading;
                      Promoted=Yes;
                      Image=NewDocument;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 AddBillOfLading;

                                 UpdateValues;
                               END;
                                }
      { 38      ;3   ;ActionGroup;
                      CaptionML=ENU=Other }
      { 39      ;4   ;Action    ;
                      CaptionML=ENU=Add Sales Invoice;
                      OnAction=VAR
                                 SalesHeader@1240030001 : Record 36;
                               BEGIN
                                 AddSalesHeader(2);

                                 UpdateValues;
                               END;
                                }
      { 40      ;4   ;Action    ;
                      CaptionML=ENU=Add &Purchase Credit Memo;
                      OnAction=BEGIN
                                 AddPurchaseHeader(3);

                                 UpdateValues;
                               END;
                                }
      { 1240030002;4 ;Action    ;
                      CaptionML=ENU=Add &Return Shipment;
                      OnAction=BEGIN
                                 AddPurchaseHeader(5);

                                 UpdateValues;
                               END;
                                }
      { 1240030004;4 ;Action    ;
                      CaptionML=ENU=Add &Transfer Order;
                      OnAction=BEGIN
                                 AddTransferOrder;

                                 UpdateValues;
                               END;
                                }
      { 1240030001;4 ;Separator  }
      { 41      ;4   ;Action    ;
                      CaptionML=ENU=Add &Posted Purchase Credit Memo;
                      OnAction=BEGIN
                                 AddPostedPurchaseCreditMemo;

                                 UpdateValues;
                               END;
                                }
      { 1240030000;4 ;Action    ;
                      CaptionML=ENU=Add &Posted Return Shipment;
                      OnAction=BEGIN
                                 AddPostedReturnShipment;

                                 UpdateValues;
                               END;
                                }
      { 1240030003;4 ;Action    ;
                      CaptionML=ENU=Add &Posted Transfer Shipment;
                      OnAction=BEGIN
                                 AddPostedTransferShipment;

                                 UpdateValues;
                               END;
                                }
      { 37      ;3   ;Action    ;
                      ShortCutKey=F7;
                      CaptionML=ENU=Scan New Lines;
                      OnAction=BEGIN
                                 CLEAR(BillOfLadingScanning);
                                 BillOfLadingScanning.OpenWithBillOfLading("No.",TRUE);
                                 BillOfLadingScanning.RUNMODAL;
                               END;
                                }
      { 27      ;2   ;Action    ;
                      CaptionML=ENU=Delete;
                      OnAction=VAR
                                 BillOfLadingStatDetail@1000000001 : TEMPORARY Record 14000826;
                               BEGIN
                                 TESTFIELD(Released,FALSE);

                                 CurrPage.StatLines.PAGE.GetCurrentRec(BillOfLadingStatDetail);

                                 BillOfLadingWorksheetMgt.DeleteBillOfLadingStatDetail(Rec,BillOfLadingStatDetail);

                                 UpdateValues;
                               END;
                                }
      { 32      ;2   ;Action    ;
                      ShortCutKey=Ctrl+F11;
                      CaptionML=ENU=&Rate Shop;
                      Promoted=Yes;
                      Image=Calculate;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 Shipping.RateShopBillOfLading(Rec);

                                 UpdateValues;
                               END;
                                }
      { 34      ;2   ;Action    ;
                      ShortCutKey=Alt+F11;
                      CaptionML=ENU=Fast Pack;
                      ToolTipML=ENU=Opens Fast Pack in order to pack the packages associated to the record.;
                      OnAction=BEGIN
                                 CurrPage.StatLines.PAGE.FastPackSalesOrder;

                                 UpdateValues;
                               END;
                                }
      { 1240030005;2 ;ActionGroup;
                      CaptionML=ENU=Close Document }
      { 35      ;3   ;Action    ;
                      ShortCutKey=F9;
                      CaptionML=ENU=Post Document;
                      OnAction=BEGIN
                                 CurrPage.StatLines.PAGE.PostSalesOrder;

                                 UpdateValues;
                               END;
                                }
      { 1240030006;3 ;Action    ;
                      CaptionML=ENU=Close &Order;
                      OnAction=BEGIN
                                 CurrPage.StatLines.PAGE.CloseDocument(FALSE,FALSE,FALSE);

                                 UpdateValues;
                               END;
                                }
      { 1240030007;3 ;Action    ;
                      CaptionML=ENU=Close Order &Print;
                      OnAction=BEGIN
                                 CurrPage.StatLines.PAGE.CloseDocument(TRUE,FALSE,FALSE);

                                 UpdateValues;
                               END;
                                }
      { 1240030008;3 ;Action    ;
                      CaptionML=ENU=Close Order &Force;
                      OnAction=BEGIN
                                 CurrPage.StatLines.PAGE.CloseDocument(FALSE,TRUE,FALSE);

                                 UpdateValues;
                               END;
                                }
      { 1240030009;3 ;Action    ;
                      CaptionML=ENU=Close Order &Force Print;
                      OnAction=BEGIN
                                 CurrPage.StatLines.PAGE.CloseDocument(TRUE,TRUE,FALSE);

                                 UpdateValues;
                               END;
                                }
      { 1038    ;2   ;Action    ;
                      CaptionML=ENU=Post Shipment &Invoice;
                      OnAction=BEGIN
                                 IF NOT CONFIRM(Text001) THEN
                                   EXIT;

                                 CurrPage.StatLines.PAGE.PostShipmentInvoice;

                                 UpdateValues;
                               END;
                                }
      { 36      ;2   ;Action    ;
                      CaptionML=ENU=Batch Post;
                      OnAction=VAR
                                 SalesHeader@1000000001 : Record 36;
                               BEGIN
                                 SalesHeader.RESET;
                                 IF ShippingSetup."Location Packing" THEN
                                   SalesHeader.SETRANGE("Location Filter",PackingStation."Location Code");
                                 SalesHeader.SETRANGE("Document Type",SalesHeader."Document Type"::Order);
                                 SalesHeader.SETRANGE("Exists on Bill of Lading",TRUE);
                                 REPORT.RUNMODAL(REPORT::"Batch Post Sales Orders",TRUE,TRUE,SalesHeader);

                                 UpdateValues;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                CaptionML=ENU=General }

    { 1903895301;2;Group  ;
                GroupType=FixedLayout }

    { 1900725501;3;Group  ;
                CaptionML=ENU=Posted }

    { 3   ;4   ;Field     ;
                CaptionML=ENU=Weight;
                SourceExpr="Posted Weight";
                Editable=FALSE }

    { 5   ;4   ;Field     ;
                CaptionML=ENU=Volume;
                SourceExpr="Posted Volume";
                Editable=FALSE }

    { 7   ;4   ;Field     ;
                CaptionML=ENU=Value;
                SourceExpr="Posted Value";
                Editable=FALSE }

    { 1900494901;3;Group  ;
                CaptionML=ENU=Qty. to Pack }

    { 13  ;4   ;Field     ;
                CaptionML=ENU=Qty. to Pack Weight;
                DecimalPlaces=0:5;
                BlankZero=Yes;
                SourceExpr=CalculatedWeight[5];
                Editable=FALSE }

    { 15  ;4   ;Field     ;
                CaptionML=ENU=Qty. to Pack Volume;
                DecimalPlaces=0:5;
                BlankZero=Yes;
                SourceExpr=CalculatedVolume[5];
                Editable=FALSE }

    { 16  ;4   ;Field     ;
                CaptionML=ENU=Qty. to Pack Value;
                BlankZero=Yes;
                SourceExpr=CalculatedValue[5];
                Editable=FALSE }

    { 1902759901;3;Group  ;
                CaptionML=ENU=Packed }

    { 17  ;4   ;Field     ;
                CaptionML=ENU=Packed Weight;
                DecimalPlaces=0:5;
                BlankZero=Yes;
                SourceExpr=CalculatedWeight[4];
                Editable=FALSE }

    { 18  ;4   ;Field     ;
                CaptionML=ENU=Packed Volume;
                DecimalPlaces=0:5;
                BlankZero=Yes;
                SourceExpr=CalculatedVolume[4];
                Editable=FALSE }

    { 19  ;4   ;Field     ;
                CaptionML=ENU=Packed Value;
                BlankZero=Yes;
                SourceExpr=CalculatedValue[4];
                Editable=FALSE }

    { 1901652701;3;Group  ;
                CaptionML=ENU=Posted + Packed }

    { 20  ;4   ;Field     ;
                CaptionML=ENU=Posted and Packed Weight;
                DecimalPlaces=0:5;
                BlankZero=Yes;
                SourceExpr="Posted Weight" + CalculatedWeight[4];
                Editable=FALSE }

    { 21  ;4   ;Field     ;
                CaptionML=ENU=Posted and Packed Volume;
                DecimalPlaces=0:5;
                BlankZero=Yes;
                SourceExpr="Posted Volume" + CalculatedVolume[4];
                Editable=FALSE }

    { 22  ;4   ;Field     ;
                CaptionML=ENU=Posted and Packed Value;
                BlankZero=Yes;
                SourceExpr="Posted Value" + CalculatedValue[4];
                Editable=FALSE }

    { 10  ;1   ;Part      ;
                Name=StatLines;
                PagePartID=Page14000829 }

  }
  CODE
  {
    VAR
      ShippingSetup@1240030000 : Record 14000707;
      BillOfLadingStatDetailTmp@1240030002 : TEMPORARY Record 14000826;
      PackingStation@1240030012 : Record 14000709;
      BillOfLadingScanning@1240030006 : Page 14000837;
      Shipping@1240030007 : Codeunit 14000701;
      BillOfLadingWorksheetMgt@1240030008 : Codeunit 14000822;
      CalculatedWeight@1240030009 : ARRAY [5] OF Decimal;
      CalculatedVolume@1240030010 : ARRAY [5] OF Decimal;
      CalculatedValue@1240030011 : ARRAY [5] OF Decimal;
      Text001@1001 : TextConst 'ENU=Post Shipment Invoice?';

    PROCEDURE UpdateValues@1();
    BEGIN
      BillOfLadingWorksheetMgt.UpdateBOLWorkSheetLines(
        Rec,BillOfLadingStatDetailTmp,ShippingSetup,
        CalculatedWeight,CalculatedVolume,CalculatedValue);

      CurrPage.StatLines.PAGE.LoadLines(BillOfLadingStatDetailTmp);
      // CurrForm.UPDATE(FALSE);
    END;

    BEGIN
    END.
  }
}

