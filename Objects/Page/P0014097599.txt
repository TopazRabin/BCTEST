OBJECT Page 14097599 DP Manual Setup
{
  OBJECT-PROPERTIES
  {
    Date=11/01/20;
    Time=12:00:00 PM;
    Version List=UBP3.03;
  }
  PROPERTIES
  {
    CaptionML=ENU=Demand Planning Setup;
    InsertAllowed=No;
    DeleteAllowed=No;
    LinksAllowed=No;
    PageType=Card;
    ShowFilter=No;
    OnInit=BEGIN

             CLEAR(SetupMgt);
             CheckSetupProcesses;
             CurrWorkdate := WORKDATE;
             IntroText := DemandPlanningTitle;
           END;

    OnOpenPage=BEGIN
                 DoneMessageVisible := FALSE;
                 SetupMgtVisible := TRUE;
               END;

    ActionList=ACTIONS
    {
      { 9       ;    ;ActionContainer;
                      CaptionML=ENU=Default Configuration;
                      ActionContainerType=ActionItems }
      { 1240020008;1 ;Action    ;
                      Name=SimpleConfiguration;
                      CaptionML=ENU=Create Default Setup;
                      ApplicationArea=#All;
                      Visible=SetupMgtVisible;
                      Image=Setup;
                      OnAction=VAR
                                 DPSetupRunner@1240020000 : Codeunit 14098054;
                               BEGIN
                                 CLEAR(DPSetupRunner);
                                 DPSetupRunner.ProcessAll;
                               END;
                                }
      { 1240020007;1 ;Action    ;
                      Name=Setup Processes;
                      CaptionML=ENU=View Configuration Processes;
                      ApplicationArea=#All;
                      RunObject=Page 14097597;
                      Visible=FALSE;
                      Image=Setup }
      { 1240020025;1 ;Action    ;
                      Name=Configuration Package;
                      ApplicationArea=#All;
                      Visible=FALSE;
                      Image=CheckRulesSyntax;
                      OnAction=BEGIN
                                 ViewConfiguration;
                               END;
                                }
      { 1240020013;1 ;Action    ;
                      CaptionML=ENU=Generate Demo Data;
                      Image=History;
                      OnAction=VAR
                                 GenTestDemoData@1240020000 : Codeunit 14002691;
                               BEGIN
                                 CLEAR(GenTestDemoData);
                                 GenTestDemoData.RUN;
                               END;
                                }
      { 1240020024;1 ;Action    ;
                      CaptionML=ENU=View Historical Demo Data;
                      RunObject=Page 14097590;
                      Image=Evaluate }
      { 1240020027;1 ;Action    ;
                      CaptionML=ENU=View BOM Demo Data;
                      RunObject=Page 14097593;
                      Image=Evaluate }
      { 1240020031;1 ;Action    ;
                      Name=ProcessDemoDataSetup;
                      CaptionML=ENU=Create ERP Demo Data;
                      ApplicationArea=#All;
                      Image=History;
                      OnAction=VAR
                                 CompanyInfo@1000 : Record 79;
                               BEGIN
                                 CompanyInfo.GET;
                                 IF CompanyInfo."Demo Company" THEN
                                   DemoConfigurationRunProcessCU;
                               END;
                                }
      { 1240020000;1 ;Action    ;
                      Name=DEMO - Execute Configuration;
                      CaptionML=ENU=Create ERP Demo Data;
                      ApplicationArea=#All;
                      Visible=FALSE;
                      Image=History;
                      OnAction=VAR
                                 CompanyInfo@1240020000 : Record 79;
                               BEGIN
                                 CompanyInfo.GET;
                                 IF CompanyInfo."Demo Company" THEN
                                   DemoConfigurationRun;
                               END;
                                }
      { 1240020028;1 ;Action    ;
                      Name=ProcessLocationForecastPeriods;
                      CaptionML=ENU=Process Location Forecasting;
                      Image=Period;
                      OnAction=VAR
                                 PeriodEndYN@1240020000 : Codeunit 14000556;
                               BEGIN
                                 CLEAR(PeriodEndYN);
                                 PeriodEndYN.RUN;
                               END;
                                }
      { 1240020026;  ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 1240020020;1 ;Action    ;
                      Name=Formulas;
                      ApplicationArea=#All;
                      RunObject=Page 14002654;
                      Image=Evaluate }
      { 1240020014;1 ;Action    ;
                      Name=Locations;
                      ApplicationArea=#All;
                      RunObject=Page 15;
                      Image=Warehouse;
                      PromotedCategory=New }
      { 1240020022;1 ;Action    ;
                      Name=Inventory Management Setup;
                      ApplicationArea=#All;
                      RunObject=Page 14000552;
                      Image=InventorySetup;
                      PromotedCategory=New }
      { 1240020021;1 ;Action    ;
                      Name=Advanced Forecasting Setup;
                      ApplicationArea=#All;
                      RunObject=Page 14002651;
                      Image=Forecast;
                      PromotedCategory=New }
      { 1240020015;1 ;Action    ;
                      Name=Forecast User Setup;
                      ApplicationArea=#All;
                      RunObject=Page 14097453;
                      Image=UserSetup }
      { 1240020019;1 ;Action    ;
                      Name=Collaboartive Setup;
                      ApplicationArea=#All;
                      RunObject=Page 14002610;
                      Image=Customer }
      { 1240020018;1 ;Action    ;
                      Name=Production Setup;
                      ApplicationArea=#All;
                      RunObject=Page 14002677;
                      Image=ProductionSetup }
      { 1240020017;1 ;Action    ;
                      Name=Production Templates;
                      ApplicationArea=#All;
                      RunObject=Page 14002680;
                      Image=Production }
      { 1240020016;1 ;Action    ;
                      Name=Alert Setup;
                      ApplicationArea=#All;
                      RunObject=Page 14002716;
                      Image=Alerts }
      { 1240020012;1 ;Action    ;
                      Name=Item Class;
                      ApplicationArea=#All;
                      RunObject=Page 14000555;
                      Image=ItemInvoice }
      { 1240020011;1 ;Action    ;
                      Name=Item Ranking;
                      ApplicationArea=#All;
                      RunObject=Page 14002656;
                      Image=ItemRegisters }
      { 1240020010;1 ;Action    ;
                      Name=Sporadic Rules;
                      ApplicationArea=#All;
                      RunObject=Page 14002704;
                      Image=Allocate }
      { 1240020009;1 ;Action    ;
                      Name=Stocking Rule;
                      ApplicationArea=#All;
                      RunObject=Page 14000599;
                      Image=NonStockItemSetup }
      { 1240020030;1 ;Action    ;
                      Name=Processing Log;
                      RunObject=Page 14000600;
                      Image=Log }
      { 1240020023;1 ;Action    ;
                      Name=Period End Processing;
                      ApplicationArea=#All;
                      RunObject=Page 14000574;
                      Image=Period }
      { 1240020005;  ;ActionContainer;
                      CaptionML=ENU=Setup Activities;
                      ActionContainerType=Reports }
      { 1240020004;1 ;Action    ;
                      Name=Create Forecast Inventory Period;
                      ApplicationArea=#All;
                      RunObject=Report 14000552;
                      Image=New;
                      PromotedCategory=New }
      { 1240020001;1 ;Action    ;
                      Name=Initialize Item Ledger Entry;
                      ApplicationArea=#All;
                      RunObject=Report 14000582;
                      Image=History;
                      PromotedCategory=New }
      { 1240020003;1 ;Action    ;
                      Name=Import Formulas;
                      CaptionML=ENU=Import Formulas;
                      ApplicationArea=#All;
                      RunObject=XMLport 14002701;
                      Image=Evaluate;
                      PromotedCategory=New }
      { 1240020006;1 ;Action    ;
                      Name=Import Historical Usage;
                      CaptionML=ENU=Import Historical Usage;
                      ApplicationArea=#All;
                      RunObject=XMLport 14002702;
                      Image=History;
                      PromotedCategory=New }
      { 1240020029;1 ;Action    ;
                      Name=Period End Processing2;
                      CaptionML=ENU=Location Period Processing;
                      ApplicationArea=#All;
                      RunObject=Page 14000574;
                      Image=Period }
      { 1240020032;1 ;Action    ;
                      Name=Create User Roles;
                      CaptionML=ENU=Create User Roles & Permissoins;
                      Image=Users;
                      OnAction=VAR
                                 CreateUserRoles@1240020000 : Codeunit 14000588;
                               BEGIN
                                 CLEAR(CreateUserRoles);
                                 CreateUserRoles.RUN;
                               END;
                                }
      { 1240020033;1 ;Action    ;
                      Name=Delete Usage Ledger Entries;
                      ApplicationArea=#All;
                      RunObject=Report 14002667;
                      Image=Delete }
    }
  }
  CONTROLS
  {
    { 1   ;    ;Container ;
                Name=Control 1;
                ContainerType=ContentArea }

    { 1240020002;1;Field  ;
                Name=InstructionText;
                ApplicationArea=#All;
                SourceExpr=IntroText;
                Editable=FALSE;
                MultiLine=Yes;
                ShowCaption=No }

  }
  CODE
  {
    VAR
      CurrWorkdate@1240020001 : Date;
      IntroText@1240020002 : Text;
      InstructionText@1240020024 : Text;
      ClientTypeManagement@1039 : Codeunit 4;
      InvMgtSetup@1240020030 : Record 14000551;
      Step@1008 : 'Intro,SetupMgt,LocationSetup,UpdateExistingHistory,Done';
      BackEnabled@1002 : Boolean;
      NextEnabled@1003 : Boolean;
      FinishEnabled@1004 : Boolean;
      IntroVisible@1005 : Boolean;
      SetupMgtVisible@1006 : Boolean;
      DoneVisible@1007 : Boolean;
      NAVNotSetUpQst@1027 : TextConst 'ENU=Are you sure that you want to quit before completing setup?;ESM=" No se termin¢ la configuraci¢n del registro de correo electr¢nico\\¨Est  seguro de que desea salir?";FRC=La configuration de la connexion … la messagerie n''a pas ‚t‚ men‚e … bien. \\Òtes-vous s–r de vouloir quitterÿ?;ENC=Setup of Email Logging was not finished. \\Are you sure that you want to exit?';
      LocationSetupVisible@1240020004 : Boolean;
      SkipDeployment@1038 : Boolean;
      DoneMessageVisible@1240020029 : Boolean;
      DemandPlanningTitle@1240020000 : TextConst 'ENU=Welcome to Demand Planning by Lanham and Associates.  This page is a tool to allow the trained user to manual configure Demand Planning.';
      UpdateExistingHistoryVisible@1240020005 : Boolean;
      SetupMgt@1240020003 : Codeunit 14098053;
      InventoryManagement@1240020006 : Codeunit 14000553;

    LOCAL PROCEDURE InventoryMgtIsSetup@53() SetupEnabled : Boolean;
    BEGIN
      SetupEnabled := FALSE;

      IF NOT InvMgtSetup.GET THEN
        EXIT(SetupEnabled);

      IF InvMgtSetup."Usage Start Date" = 0D THEN
        EXIT(SetupEnabled);

      SetupEnabled := TRUE;
    END;

    PROCEDURE SetWorkdate@1240020000(VAR CurrWorkdate@1000 : Date);
    BEGIN
      IF CurrWorkdate <> WORKDATE THEN
        WORKDATE(CurrWorkdate);
    END;

    PROCEDURE ViewConfiguration@2();
    BEGIN
      PAGE.RUN(PAGE::"Config. Packages");
    END;

    LOCAL PROCEDURE CheckSetupProcesses@1240020001();
    VAR
      SetupRunner@1240020000 : Codeunit 14098054;
      SetupProcessEntry@1000 : Record 14097491;
    BEGIN
      IF SetupProcessEntry.ISEMPTY THEN BEGIN
        SetupRunner.CreateProcesses;
      END;
    END;

    LOCAL PROCEDURE CheckILENextEnabled@1240020002() MoveToNextStep : Boolean;
    VAR
      ItemLedgerEntry@1240020000 : Record 32;
    BEGIN
      MoveToNextStep := FALSE;
      IF ItemLedgerEntry.ISEMPTY THEN
        MoveToNextStep := TRUE;
      IF NOT MoveToNextStep THEN BEGIN
        ItemLedgerEntry.SETRANGE("Entry Type", ItemLedgerEntry."Entry Type"::Sale);
        IF NOT ItemLedgerEntry.ISEMPTY THEN BEGIN
          ItemLedgerEntry.SETRANGE("First Shipment", TRUE);
          IF NOT ItemLedgerEntry.ISEMPTY THEN
            MoveToNextStep := TRUE;
        END;
      END;
      EXIT(MoveToNextStep);
    END;

    LOCAL PROCEDURE FinishPage@1240020005();
    VAR
      AssistedSetup@1240020000 : Record 1808;
    BEGIN
      IF SetupMgt.CheckDPSetupStatus(AssistedSetup) = AssistedSetup.Status::"Not Completed" THEN BEGIN
        IF NOT CONFIRM(NAVNotSetUpQst,FALSE) THEN
          ERROR('');
      END;
      CurrPage.CLOSE;
    END;

    LOCAL PROCEDURE DemoConfigurationRun@1240020003();
    VAR
      HistoricalData@1240020000 : Record 14097490;
      CreateHistoricalData@1240020001 : Codeunit 14098056;
      LogEntryNo@1240020002 : Integer;
      DemoDataMissing@1240020003 : TextConst 'ENU=The Demo data records do not exist.  The Demand Planning demo data is generated from the Historical Usage table.';
    BEGIN
      IF HistoricalData.FINDSET THEN BEGIN
        CLEARLASTERROR;
        CLEAR(CreateHistoricalData);
        IF NOT CreateHistoricalData.RUN THEN BEGIN
          InventoryManagement.CreateLogEntry('',COPYSTR(GETLASTERRORTEXT, 1, 250), LogEntryNo);
        END;
      END ELSE BEGIN
        MESSAGE(DemoDataMissing);
      END;
    END;

    LOCAL PROCEDURE DemoConfigurationRunProcessCU@3();
    VAR
      HistoricalData@1240020000 : Record 14097490;
      CreateHistoricalData@1240020001 : Codeunit 14002692;
      LogEntryNo@1240020002 : Integer;
      DemoDataMissing@1240020003 : TextConst 'ENU=The Demo data records do not exist.  The Demand Planning demo data is generated from the Historical Usage table.';
    BEGIN
      IF HistoricalData.FINDSET THEN BEGIN
        CLEARLASTERROR;
        CLEAR(CreateHistoricalData);
        IF NOT CreateHistoricalData.RUN THEN BEGIN
          InventoryManagement.CreateLogEntry('',COPYSTR(GETLASTERRORTEXT, 1, 250), LogEntryNo);
        END;
      END ELSE BEGIN
        MESSAGE(DemoDataMissing);
      END;
    END;

    BEGIN
    END.
  }
}

