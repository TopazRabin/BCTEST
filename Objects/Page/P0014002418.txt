OBJECT Page 14002418 E.D.I. Order Change Status
{
  OBJECT-PROPERTIES
  {
    Date=02/25/19;
    Time=12:00:00 PM;
    Version List=SE0.61;
  }
  PROPERTIES
  {
    CaptionML=ENU=Order Change Status;
    InsertAllowed=No;
    ModifyAllowed=Yes;
    SourceTable=Table14002400;
    SourceTableView=WHERE(Document Type=FILTER(Order Change Status));
    PageType=Document;
    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 22      ;1   ;ActionGroup;
                      CaptionML=ENU=Order &Status }
      { 23      ;2   ;Action    ;
                      ShortCutKey=Shift+Ctrl+L;
                      CaptionML=ENU=List;
                      RunObject=Page 14002420;
                      Image=List }
      { 1240030033;2 ;Action    ;
                      CaptionML=ENU=&Order;
                      Promoted=Yes;
                      Image=View;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 OrderStatusHdr.Order(Rec);
                               END;
                                }
      { 1240030034;2 ;Action    ;
                      CaptionML=ENU=S&hipments;
                      Promoted=Yes;
                      Image=View;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 OrderStatusHdr.Shipments(Rec);
                               END;
                                }
      { 1240030030;2 ;Action    ;
                      CaptionML=ENU=Order Change Status Entries;
                      RunObject=Page 14002409;
                      RunPageView=SORTING(Trade Partner No.,EDI Internal Doc. No.,Export Version,Line No.)
                                  ORDER(Ascending);
                      RunPageLink=Trade Partner No.=FIELD(Trade Partner Code),
                                  EDI Internal Doc. No.=FIELD(Internal Doc. No.),
                                  Source Doc. No.=FIELD(Source Doc. No.),
                                  Source Doc. Type=FIELD(Source Doc. Type),
                                  Export Version=FIELD(Export Version),
                                  Document Type=FIELD(Document Type);
                      Promoted=Yes;
                      Image=EntriesList;
                      PromotedCategory=Process }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1240030032;1 ;ActionGroup;
                      CaptionML=ENU=F&unctions }
      { 1240020016;2 ;Action    ;
                      CaptionML=ENU=Release;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=ReleaseDoc;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 TESTFIELD(Released,FALSE);

                                 EDISalesOrderStatusSend.ReleaseDoc(Rec);
                                 CurrPage.UPDATE(FALSE);
                               END;
                                }
      { 1240020017;2 ;Action    ;
                      CaptionML=ENU=Reopen;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=ReOpen;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 TESTFIELD(Released,TRUE);

                                 EDISalesOrderStatusSend.ReopenDoc(Rec);
                                 CurrPage.UPDATE(FALSE);
                               END;
                                }
      { 1240020000;2 ;Action    ;
                      CaptionML=ENU=Send &Order Change Status;
                      Promoted=Yes;
                      Image=TransmitElectronicDoc;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CLEAR(EDIIntegration);
                                 EDIIntegration.SendOrderChangeStatus(Rec);
                                 CurrPage.UPDATE(FALSE);
                               END;
                                }
      { 1240020001;2 ;Action    ;
                      CaptionML=ENU=&Update Lines;
                      Image=EditLines;
                      OnAction=BEGIN
                                 IF OrderStatusLine.UpdateLines(
                                   "Internal Doc. No.","Source Doc. Type","Source Doc. No.","Trade Partner Code",
                                   "Document Type")
                                 THEN
                                   MESSAGE(Text001)
                                 ELSE
                                   MESSAGE(Text002);
                                 CurrPage.UPDATE(FALSE);
                               END;
                                }
      { 1240020003;2 ;Action    ;
                      CaptionML=ENU=Trace;
                      ToolTipML=ENU=Select to review all records with the same 'EDI Internal Doc No.';
                      Image=Trace;
                      OnAction=VAR
                                 EDITrace@1240020000 : Page 14002386;
                               BEGIN
                                 CLEAR(EDITrace);
                                 EDITrace.SetDoc("Internal Doc. No.");
                                 EDITrace.RUNMODAL;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                CaptionML=ENU=General }

    { 2   ;2   ;Field     ;
                ToolTipML=ENU=Specifies the Trade Partner "No." from the EDI Trade Partner page.;
                SourceExpr="Trade Partner Code" }

    { 4   ;2   ;Field     ;
                ToolTipML=ENU=Specifies the EDI Internal Doc No that is a link back to the EDI Receive Document.;
                SourceExpr="Internal Doc. No." }

    { 6   ;2   ;Field     ;
                ToolTipML=ENU=Specifies the EDI Send Document's Export Version number when the EDI file was exported.;
                SourceExpr="Export Version" }

    { 8   ;2   ;Field     ;
                ToolTipML=ENU=Specifies the system source document 'Type,' such as Quote, from which the EDI Document page is associated. Used with the 'Source Doc. No.' field.;
                SourceExpr="Source Doc. Type" }

    { 10  ;2   ;Field     ;
                ToolTipML=ENU=Specifies the system source document 'No.' from which the EDI Document page is associated. Used with the 'Source Doc. Type' field.;
                SourceExpr="Source Doc. No." }

    { 1240020010;2;Field  ;
                ToolTipML=ENU=Specifies the associated system source document 'Type,' such as Quote, from which the EDI Document page is associated. Used with the 'Source Doc. No.' field.;
                SourceExpr="Assoc. Source Doc. Type" }

    { 1240020012;2;Field  ;
                ToolTipML=ENU=Specifies the associated system source document 'No.' from which the EDI Document page is associated. Used with the 'Source Doc. Type' field.;
                SourceExpr="Assoc. Source Doc. No." }

    { 1240030016;2;Field  ;
                ToolTipML=ENU=Select the applicable Status Code from the list to send in the outbound EDI file.;
                SourceExpr="EDI Status Code";
                OnValidate=BEGIN
                             CurrPage.OrderStatusLines.PAGE.UpdateForm;
                           END;
                            }

    { 1240030018;2;Field  ;
                ToolTipML=ENU=Optionally, select the applicable Reason Code from the list to send in the outbound EDI file.;
                SourceExpr="EDI Reason Code";
                OnValidate=BEGIN
                             CurrPage.OrderStatusLines.PAGE.UpdateForm;
                           END;
                            }

    { 1240030020;2;Field  ;
                ToolTipML=ENU=Optionally, populate the Expected Date to be sent in the EDI file. The EDI Status Code table may enable the "Expected Date Required" when a certain Status Code is selected per the Trade Partner requirements.;
                SourceExpr="Expected Date";
                OnValidate=BEGIN
                             CurrPage.OrderStatusLines.PAGE.UpdateForm;
                           END;
                            }

    { 1240030000;2;Field  ;
                ToolTipML=ENU=Optionally, enable when only the header is required in the outbound EDI file. The EDI Status Code table may enable the "Header Status Send Only" when a certain Status Code is selected per the Trade Partner requirements.;
                SourceExpr="Send Hdr. Status Only" }

    { 1240020018;2;Field  ;
                ToolTipML=ENU=Enabled when a discrepancy exists between the calculated system sales price and the mapped,received EDI Unit Price.;
                SourceExpr="Pricing Discrepancy" }

    { 1240020021;2;Field  ;
                ToolTipML=ENU=Enabled when the inbound Purchase Order Change (860) has been processed and the system Sales Order updated.;
                SourceExpr="Change Processed" }

    { 1240020014;2;Field  ;
                ToolTipML=ENU=Enabled when the EDI Document is Released.  The EDI Document must be released in order to send outbound EDI files.;
                SourceExpr=Released }

    { 21  ;1   ;Part      ;
                Name=OrderStatusLines;
                SubPageLink=Internal Doc. No.=FIELD(Internal Doc. No.),
                            Export Version=FIELD(Export Version),
                            Source Doc. Type=FIELD(Source Doc. Type),
                            Source Doc. No.=FIELD(Source Doc. No.),
                            Document Type=FILTER(Order Change Status);
                PagePartID=Page14002419 }

    { 1901254101;1;Group  ;
                CaptionML=ENU=Status }

    { 1240030022;2;Field  ;
                ToolTipML=ENU=Enabled when the EDI file is exported.;
                SourceExpr=Exported }

    { 1240030024;2;Field  ;
                ToolTipML=ENU=Specifies the date the EDI file was exported.;
                SourceExpr="Date Exported" }

    { 1240030026;2;Field  ;
                ToolTipML=ENU=Specifies the time the EDI file was exported from the system.;
                SourceExpr="Time Exported" }

    { 1240030028;2;Field  ;
                ToolTipML=ENU=Specifies the User ID that exported the EDI file.;
                SourceExpr="Exported By" }

    { 1240020023;2;Field  ;
                ToolTipML=ENU=Enabled when the inbound EDI Purchase Order Change (860) is unable to update the applicable system Sales Order due to the orders Released status.;
                SourceExpr="Released Order Cancellation" }

    { 1240020025;2;Field  ;
                ToolTipML=ENU=Enabled when the inbound EDI Sales Order No. cannot be reconciled to the system Sales Order No. therefore no update occurs.;
                SourceExpr="Sales Order Find Error" }

    { 1240020002;2;Field  ;
                ToolTipML=ENU=Enabled when the change was generated by the buyer, typically from an EDI PO Change (860).;
                SourceExpr="Buyer Initiated Change" }

    { 1240020004;2;Field  ;
                ToolTipML=ENU=Enabled when the inbound Purchase Order Change (860) is processed and the system Sales Order updated.;
                SourceExpr="P.O. Change Processed" }

    { 1240020008;2;Field  ;
                ToolTipML=ENU=Populated with the date the inbound Purchase Order Change (860) was processed.;
                SourceExpr="P.O. Change Processed Date" }

    { 1240020006;2;Field  ;
                ToolTipML=ENU=Populated with the time the inbound Purchase Order Change (860) was processed.;
                SourceExpr="P.O. Change Processed Time" }

  }
  CODE
  {
    VAR
      EDIIntegration@1240020003 : Codeunit 14000363;
      EDISalesOrderStatusSend@1240020004 : Codeunit 14002400;
      OrderStatusHdr@1000000000 : Record 14002400;
      OrderStatusLine@1240020000 : Record 14002401;
      Text001@1240020001 : TextConst 'ENU=Order Status Lines updated.';
      Text002@1240020002 : TextConst 'ENU=Order Status Lines not updated.';

    BEGIN
    END.
  }
}

