OBJECT Codeunit 51860 Page143EventSubscriber
{
  OBJECT-PROPERTIES
  {
    Date=09/04/20;
    Time=[ 9:23:48 AM];
    Modified=Yes;
    Version List=NAVEVT1.0.0,001;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {

    [EventSubscriber(Page,143,OnBeforeActionEvent,Action1000000023)]
    PROCEDURE Pg143_Card_OnAction@1000000018(VAR Rec@1000000000 : Record 112);
    BEGIN
      PAGE.RUN(PAGE::"Posted Sales Invoice",Rec);
    END;

    [EventSubscriber(Page,143,OnBeforeActionEvent,Action1000000004)]
    PROCEDURE Pg143_ChangeLogEntries_OnAction@1000000019(VAR Rec@1000000000 : Record 112);
    VAR
      ChangeLogEntry@1000000001 : Record 405;
      CUSubscriber@1000000002 : Codeunit 51876;
    BEGIN
      WITH Rec DO BEGIN
        //>>001 TPZ2936
        CUSubscriber.CU423_OpenSSRSReport(DATABASE::"Sales Header", '1', "Order No.",'');//<TPZ2829> Event Conversion
        EXIT;
        //<<001 TPZ2936
        // <TPZ129>
        ChangeLogEntry.RESET;
        ChangeLogEntry.SETRANGE("Table No.",DATABASE::"Sales Header");
        ChangeLogEntry.SETRANGE("Primary Key Field 1 Value",'1');
        ChangeLogEntry.SETRANGE("Primary Key Field 2 Value","Order No.");
        PAGE.RUNMODAL(PAGE::"Change Log Entries",ChangeLogEntry);
        // </TPZ129>
      END;
    END;

    [EventSubscriber(Page,143,OnBeforeActionEvent,Action1000000007)]
    PROCEDURE Pg143_EMailInvoice_OnAction@1000000020(VAR Rec@1000000000 : Record 112);
    VAR
      EMailMgt@1000000002 : Codeunit 14000903;
    BEGIN
        Rec.TESTFIELD("E-Mail Invoice Notice Handled",FALSE);

      EMailMgt.SendSalesInvoiceNotice(Rec,TRUE,FALSE);
    END;

    BEGIN
    {
      001 TPZ2936 RPS 08312020 - Replicate "Change Log Entry" Action from Card to List
    }
    END.
  }
}

