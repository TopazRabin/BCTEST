OBJECT Codeunit 14002652 Export Vendor Forecast
{
  OBJECT-PROPERTIES
  {
    Date=03/01/20;
    Time=12:00:00 PM;
    Version List=UBP3.02;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {
    VAR
      ExcelCreate@1240030001 : Codeunit 14000587;

    PROCEDURE ByVendor@1240030000(CurrForecastVendor@1240030000 : Record 14002705);
    VAR
      AdvForSetup@1240030002 : Record 14002651;
      ForecastVendorLine@1240030001 : Record 14002706;
      Item@1240030014 : Record 27;
      Vendor@1240030004 : Record 23;
      ProgressWindow@1240030012 : Dialog;
      Text003@1240030007 : TextConst 'ENU=Exporting Vendor Forecast';
      Text004@1240030008 : TextConst 'ENU=Vendor';
      Text005@1240030009 : TextConst 'ENU=Items';
      TotalLines@1240030010 : Decimal;
      Lines@1240030011 : Decimal;
      Text006@1240030013 : TextConst 'ENU=Location';
      Text007@1240030023 : TextConst 'ENU=Item';
      Text008@1240030024 : TextConst 'ENU=Variant';
      Text009@1240030025 : TextConst 'ENU=Description';
    BEGIN
      ProgressWindow.OPEN(
        Text003 + '\' +
        PADSTR(Text004,12) + '#1##################\' +
        PADSTR(Text005,12) + '@2@@@@@@@@@@@@@@@@@@@@@@@');

      AdvForSetup.GET;
      Vendor.GET(CurrForecastVendor."Vendor No.");

      ProgressWindow.UPDATE(1,CurrForecastVendor."Vendor No.");

      ForecastVendorLine.RESET;
      ForecastVendorLine.SETRANGE("Vendor No.",CurrForecastVendor."Vendor No.");
      ForecastVendorLine.SETFILTER(Type,'%1|%2',ForecastVendorLine.Type::Title,ForecastVendorLine.Type::Forecast);
      TotalLines := ForecastVendorLine.COUNT;
      Lines := 0;
      IF ForecastVendorLine.FINDSET THEN BEGIN
        ExcelCreate.CreateBook;

        ExcelCreate.AddNewSheet(Vendor."No.");

        ExcelCreate.EnterIntoNextColumn(Text004,TRUE,TRUE,TRUE,0);
        ExcelCreate.EnterIntoNextColumn(CurrForecastVendor."Vendor No.",FALSE,FALSE,FALSE,0);
        ExcelCreate.EnterIntoNextRow(Vendor.Name,FALSE,FALSE,FALSE,0);

        ExcelCreate.EnterIntoNextRow('',TRUE,FALSE,TRUE,0);
        ExcelCreate.EnterIntoNextRow('',TRUE,FALSE,TRUE,0);
        REPEAT
          CASE ForecastVendorLine.Type OF
            ForecastVendorLine.Type::Title:
              BEGIN
                ExcelCreate.EnterIntoNextRow(Text006,TRUE,FALSE,TRUE,0);
                ExcelCreate.EnterIntoNextColumn(Text007,FALSE,FALSE,TRUE,20);
                IF AdvForSetup."Include Variant Code" THEN
                  ExcelCreate.EnterIntoNextColumn(Text008,FALSE,FALSE,TRUE,0);
                ExcelCreate.EnterIntoNextColumn(Text009,FALSE,FALSE,TRUE,30);
                ExcelCreate.EnterIntoNextColumn(ForecastVendorLine."Period 1",FALSE,FALSE,TRUE,10);
                ExcelCreate.EnterIntoNextColumn(ForecastVendorLine."Period 2",FALSE,FALSE,TRUE,10);
                ExcelCreate.EnterIntoNextColumn(ForecastVendorLine."Period 3",FALSE,FALSE,TRUE,10);
                ExcelCreate.EnterIntoNextColumn(ForecastVendorLine."Period 4",FALSE,FALSE,TRUE,10);
                ExcelCreate.EnterIntoNextColumn(ForecastVendorLine."Period 5",FALSE,FALSE,TRUE,10);
                ExcelCreate.EnterIntoNextColumn(ForecastVendorLine."Period 6",FALSE,FALSE,TRUE,10);
                ExcelCreate.EnterIntoNextColumn(ForecastVendorLine."Period 7",FALSE,FALSE,TRUE,10);
                ExcelCreate.EnterIntoNextColumn(ForecastVendorLine."Period 8",FALSE,FALSE,TRUE,10);
                ExcelCreate.EnterIntoNextColumn(ForecastVendorLine."Period 9",FALSE,FALSE,TRUE,10);
                ExcelCreate.EnterIntoNextColumn(ForecastVendorLine."Period 10",FALSE,FALSE,TRUE,10);
                ExcelCreate.EnterIntoNextColumn(ForecastVendorLine."Period 11",FALSE,FALSE,TRUE,10);
                ExcelCreate.EnterIntoNextColumn(ForecastVendorLine."Period 12",FALSE,FALSE,TRUE,10);
                ExcelCreate.EnterIntoNextColumn(ForecastVendorLine."Period 13",FALSE,FALSE,TRUE,10);
                ExcelCreate.EnterIntoNextColumn(ForecastVendorLine."Period 14",FALSE,FALSE,TRUE,10);
                ExcelCreate.EnterIntoNextColumn(ForecastVendorLine."Period 15",FALSE,FALSE,TRUE,10);
              END;
            ForecastVendorLine.Type::Forecast:
              BEGIN
                ExcelCreate.EnterIntoNextRow(ForecastVendorLine."Location Code",FALSE,FALSE,FALSE,15);
                ExcelCreate.EnterIntoNextColumn(ForecastVendorLine."Item No.",FALSE,FALSE,FALSE,0);
                IF AdvForSetup."Include Variant Code" THEN
                  ExcelCreate.EnterIntoNextColumn(ForecastVendorLine."Variant Code",FALSE,FALSE,FALSE,0);
                Item.GET(ForecastVendorLine."Item No.");
                ExcelCreate.EnterIntoNextColumn(Item.Description,FALSE,FALSE,FALSE,0);
                ExcelCreate.EnterIntoNextColumn(ForecastVendorLine."Period 1",FALSE,FALSE,FALSE,0);
                ExcelCreate.EnterIntoNextColumn(ForecastVendorLine."Period 2",FALSE,FALSE,FALSE,0);
                ExcelCreate.EnterIntoNextColumn(ForecastVendorLine."Period 3",FALSE,FALSE,FALSE,0);
                ExcelCreate.EnterIntoNextColumn(ForecastVendorLine."Period 4",FALSE,FALSE,FALSE,0);
                ExcelCreate.EnterIntoNextColumn(ForecastVendorLine."Period 5",FALSE,FALSE,FALSE,0);
                ExcelCreate.EnterIntoNextColumn(ForecastVendorLine."Period 6",FALSE,FALSE,FALSE,0);
                ExcelCreate.EnterIntoNextColumn(ForecastVendorLine."Period 7",FALSE,FALSE,FALSE,0);
                ExcelCreate.EnterIntoNextColumn(ForecastVendorLine."Period 8",FALSE,FALSE,FALSE,0);
                ExcelCreate.EnterIntoNextColumn(ForecastVendorLine."Period 9",FALSE,FALSE,FALSE,0);
                ExcelCreate.EnterIntoNextColumn(ForecastVendorLine."Period 10",FALSE,FALSE,FALSE,0);
                ExcelCreate.EnterIntoNextColumn(ForecastVendorLine."Period 11",FALSE,FALSE,FALSE,0);
                ExcelCreate.EnterIntoNextColumn(ForecastVendorLine."Period 12",FALSE,FALSE,FALSE,0);
                ExcelCreate.EnterIntoNextColumn(ForecastVendorLine."Period 13",FALSE,FALSE,FALSE,0);
                ExcelCreate.EnterIntoNextColumn(ForecastVendorLine."Period 14",FALSE,FALSE,FALSE,0);
                ExcelCreate.EnterIntoNextColumn(ForecastVendorLine."Period 15",FALSE,FALSE,FALSE,0);
              END;
          END;
          Lines := Lines + 1;
          ProgressWindow.UPDATE(2,ROUND(10000 * (Lines / TotalLines),1));
          ExcelCreate.EnterIntoNextRow('',TRUE,FALSE,FALSE,0);
        UNTIL ForecastVendorLine.NEXT = 0;
        ExcelCreate.Complete(Vendor."No.");
      END;

      ProgressWindow.CLOSE;
    END;

    BEGIN
    END.
  }
}

