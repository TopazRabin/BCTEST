OBJECT Codeunit 51746 Codeunit228EventSubscriber
{
  OBJECT-PROPERTIES
  {
    Date=07/01/20;
    Time=12:00:00 AM;
    Modified=Yes;
    Version List=NAVEVENT;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {
    VAR
      ReportSelection@1000000000 : Record 77;

    PROCEDURE PrintSalesUnpostedCM@1000000000(NewSalesHeader@1000 : Record 36);
    VAR
      SalesHeader@1002 : Record 36;
    BEGIN
      //TPZCodeunit 228
      SalesHeader := NewSalesHeader;
      SalesHeader.SETRECFILTER;
      CU228_CalcSalesDisc(SalesHeader);
      ReportSelection.PrintWithCheck(ReportSelection.Usage::SalesUnpostedCM,SalesHeader,SalesHeader.FIELDNO("Bill-to Customer No."));
    END;

    LOCAL PROCEDURE CU228_CalcSalesDisc@25(VAR SalesHeader@1000 : Record 36);
    VAR
      SalesLine@1004 : Record 37;
      SalesSetup@1001 : Record 311;
    BEGIN
      SalesSetup.GET;
      IF SalesSetup."Calc. Inv. Discount" THEN BEGIN
        SalesLine.RESET;
        SalesLine.SETRANGE("Document Type",SalesHeader."Document Type");
        SalesLine.SETRANGE("Document No.",SalesHeader."No.");
        SalesLine.FINDFIRST;
        CODEUNIT.RUN(CODEUNIT::"Sales-Calc. Discount",SalesLine);
        SalesHeader.GET(SalesHeader."Document Type",SalesHeader."No.");
        COMMIT;
      END;
    END;

    BEGIN
    {
      2020-05-19  TPZ2830  PSHUKLA
    }
    END.
  }
}

