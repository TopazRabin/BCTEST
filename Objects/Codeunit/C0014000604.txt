OBJECT Codeunit 14000604 Fast Receive
{
  OBJECT-PROPERTIES
  {
    Date=06/28/17;
    Time=12:00:00 PM;
    Version List=SE0.50.50;
  }
  PROPERTIES
  {
    OnRun=BEGIN
            ReceiveSetup.GET;

            REPEAT
              ReceiveControl."Source Type" := 0;
              ReceiveControl."Source Subtype" := 0;
              IF NOT ReceiveSetup.SelectSourceType(
                       ReceiveControl."Source Type",ReceiveControl."Source Subtype")
              THEN
                EXIT;

              CASE ReceiveControl."Source Type" OF
                DATABASE::"Purchase Header":
                  BEGIN
                    PurchHeader.RESET;
                    PurchHeader.SETRANGE("Document Type",ReceiveControl."Source Subtype");
                    IF PAGE.RUNMODAL(0,PurchHeader) <> ACTION::LookupOK THEN
                      EXIT;

                    IF PurchHeader.Status = PurchHeader.Status::Released THEN BEGIN
                      FastReceiveLine.RESET;
                      FastReceiveLine.SETRANGE("Source Type",DATABASE::"Purchase Header");
                      FastReceiveLine.SETRANGE("Source Subtype",PurchHeader."Document Type");
                      FastReceiveLine.SETRANGE("Source ID",PurchHeader."No.");

                      PAGE.RUNMODAL(PAGE::"Fast Receive Order",FastReceiveLine);
                    END ELSE
                      MESSAGE(
                        Text002,
                        ReceiveControl.FormatSource(
                          DATABASE::"Purchase Header",PurchHeader."Document Type",PurchHeader."No."));
                  END;
                DATABASE::"Sales Header":
                  BEGIN
                    SalesHeader.RESET;
                    SalesHeader.SETRANGE("Document Type",ReceiveControl."Source Subtype");
                    IF PAGE.RUNMODAL(0,SalesHeader) <> ACTION::LookupOK THEN
                      EXIT;

                    IF SalesHeader.Status = SalesHeader.Status::Released THEN BEGIN
                      FastReceiveLine.RESET;
                      FastReceiveLine.SETRANGE("Source Type",DATABASE::"Sales Header");
                      FastReceiveLine.SETRANGE("Source Subtype",SalesHeader."Document Type");
                      FastReceiveLine.SETRANGE("Source ID",SalesHeader."No.");

                      PAGE.RUNMODAL(PAGE::"Fast Receive Order",FastReceiveLine);
                    END ELSE
                      MESSAGE(
                        Text002,
                        ReceiveControl.FormatSource(
                          DATABASE::"Sales Header",SalesHeader."Document Type",SalesHeader."No."));
                  END;
                DATABASE::"Transfer Header":
                  BEGIN
                    TransferHeader.RESET;
                    IF PAGE.RUNMODAL(0,TransferHeader) <> ACTION::LookupOK THEN
                      EXIT;

                    IF TransferHeader.Status = TransferHeader.Status::Released THEN BEGIN
                      FastReceiveLine.RESET;
                      FastReceiveLine.SETRANGE("Source Type",DATABASE::"Transfer Header");
                      FastReceiveLine.SETRANGE("Source Subtype",0);
                      FastReceiveLine.SETRANGE("Source ID",TransferHeader."No.");

                      PAGE.RUNMODAL(PAGE::"Fast Receive Order",FastReceiveLine);
                    END ELSE
                      MESSAGE(
                        Text002,
                        ReceiveControl.FormatSource(
                          DATABASE::"Transfer Header",0,TransferHeader."No."));
                  END;
              END;
            UNTIL FALSE;
          END;

  }
  CODE
  {
    VAR
      ReceiveSetup@1240030008 : Record 14000607;
      SalesHeader@1240030002 : Record 36;
      PurchHeader@1240030003 : Record 38;
      TransferHeader@1240030004 : Record 5740;
      FastReceiveLine@1240030005 : Record 14000609;
      ReceiveControl@1240030007 : Record 14000611;
      Text002@1240030006 : TextConst 'ENU=%1 is not released.';

    BEGIN
    END.
  }
}

