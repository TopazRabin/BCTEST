OBJECT Codeunit 52004 Contact Management CU
{
  OBJECT-PROPERTIES
  {
    Date=10/29/21;
    Time=11:39:24 AM;
    Modified=Yes;
    Version List=3385;
  }
  PROPERTIES
  {
    OnRun=BEGIN
            {NOT required ASSERTERROR we will run it on MonthNo END
            IF NOT automaticvar THEN
              Setfilterfun;
            }
            NumVar := 1;
            GetQuarterDate(DATE2DMY(DateVar,2));  //getting month filter
            MonthNo := DATE2DMY(DateVar,2);
            //--
            ContactAdded;
            ContactAddedByJob;
            ProspectContactAdded;
            ProspectContactAddedByJob;
          END;

  }
  CODE
  {
    VAR
      YearVarFilter@1000000064 : Text[4];
      YearVar@1000000063 : Text[4];
      DateVar@1000000062 : Date;
      QuarterVar@1000000061 : 'Quarter 1 - Jan to March,Quarter 2 - April to June, Quarter 3 - July to Sep,Quarter 4 - Oct to Dec';
      TempContactBuffer@1000000060 : TEMPORARY Record 50063;
      NumVar@1000000059 : Integer;
      QMonth1@1000000058 : Text[10];
      QMonth2@1000000057 : Text[10];
      QMonth3@1000000056 : Text[10];
      QMonth4@1000000055 : Text[10];
      QMonth5@1000000054 : Text[10];
      QMonth6@1000000053 : Text[10];
      QMonth7@1000000052 : Text[10];
      QMonth8@1000000051 : Text[10];
      QMonth9@1000000050 : Text[10];
      QMonth10@1000000049 : Text[10];
      QMonth11@1000000048 : Text[10];
      QMonth12@1000000047 : Text[10];
      QMonth1Fil@1000000046 : Text[30];
      QMonth2Fil@1000000045 : Text[30];
      QMonth3Fil@1000000044 : Text[30];
      QMonth4Fil@1000000043 : Text[30];
      QMonth5Fil@1000000042 : Text[30];
      QMonth6Fil@1000000041 : Text[30];
      QMonth7Fil@1000000040 : Text[30];
      QMonth8Fil@1000000039 : Text[30];
      QMonth9Fil@1000000038 : Text[30];
      QMonth10Fil@1000000037 : Text[30];
      QMonth11Fil@1000000036 : Text[30];
      QMonth12Fil@1000000035 : Text[30];
      MonthTxt1@1000000034 : Text[20];
      MonthTxt2@1000000033 : Text[20];
      MonthTxt3@1000000032 : Text[20];
      MonthTxt4@1000000031 : Text[20];
      MonthTxt5@1000000030 : Text[20];
      MonthTxt6@1000000029 : Text[20];
      MonthTxt7@1000000028 : Text[20];
      MonthTxt8@1000000027 : Text[20];
      MonthTxt9@1000000026 : Text[20];
      MonthTxt10@1000000025 : Text[20];
      MonthTxt11@1000000024 : Text[20];
      MonthTxt12@1000000023 : Text[20];
      TempExcelBuffer@1000000019 : TEMPORARY Record 370;
      Contact@1000000017 : Record 5050;
      RowNo@1000000015 : Integer;
      ColumnNo@1000000014 : Integer;
      automaticvar@1000000013 : Boolean;
      MonthNo@1000000012 : Integer;
      M1@1000000011 : Decimal;
      M2@1000000010 : Decimal;
      M3@1000000009 : Decimal;
      M4@1000000008 : Integer;
      M5@1000000007 : Integer;
      M6@1000000006 : Integer;
      M7@1000000005 : Integer;
      M8@1000000004 : Integer;
      M9@1000000003 : Integer;
      M10@1000000002 : Integer;
      M11@1000000001 : Integer;
      M12@1000000000 : Integer;

    LOCAL PROCEDURE ContactAdded@1000000014();
    VAR
      ContactJobResponsibility@1000000003 : Record 5067;
      TempContactBuffer1@1000000000 : TEMPORARY Record 50063;
      DivisionVar@1000000015 : Code[20];
      FirstVar@1000000014 : Boolean;
      T1@1000000013 : Integer;
      T2@1000000012 : Integer;
      T3@1000000011 : Integer;
      T4@1000000010 : Integer;
      T5@1000000009 : Integer;
      T6@1000000008 : Integer;
      T7@1000000007 : Integer;
      T8@1000000006 : Integer;
      T9@1000000005 : Integer;
      T10@1000000004 : Integer;
      T11@1000000002 : Integer;
      T12@1000000001 : Integer;
      ContactBufferPermanent@1000000016 : Record 50063;
    BEGIN
      //-->'Customer Contact Added' and 'Customer Contact Added by Person'
      M1 := 0;M2 := 0;M3 := 0;M4 := 0;M5 := 0;M6 := 0;
      M7 := 0;M8 := 0;M9 := 0;M10 := 0;M11 := 0;M12 := 0;
      CLEAR(TempContactBuffer);
      TempContactBuffer.DELETEALL;
      ContactAddedData(MonthNo);
      NumVar := 0; //ReInitializing
      TempContactBuffer.RESET;
      TempContactBuffer.SETCURRENTKEY("Division Code",Integer_1);
      IF TempContactBuffer.FINDSET THEN BEGIN
        FirstVar := TRUE;
        REPEAT
          IF (NOT FirstVar) AND (DivisionVar <> TempContactBuffer."Division Code") THEN BEGIN
            NumVar += 2;
            TempContactBuffer1.INIT;
            TempContactBuffer1.Option := 'CONTACTMANAGEMENT';
            TempContactBuffer1."Option Choice" := FORMAT(NumVar);
            TempContactBuffer1.DefaultInteger := NumVar;
            TempContactBuffer1.DefaultText250 := 'Total for Division ' + DivisionVar;
            TempContactBuffer1."User ID" := 'Total for Division ' + DivisionVar;
            TempContactBuffer1.DefaultInteger_1 := T1;
            TempContactBuffer1.DefaultInteger_2 := T2;
            TempContactBuffer1.DefaultInteger_3 := T3;
            TempContactBuffer1.DefaultInteger_4 := T4;
            TempContactBuffer1.DefaultInteger_5 := T5;
            TempContactBuffer1.DefaultInteger_6 := T6;
            TempContactBuffer1.DefaultInteger_7 := T7;
            TempContactBuffer1.DefaultInteger_8 := T8;
            TempContactBuffer1.DefaultInteger_9 := T9;
            TempContactBuffer1.DefaultInteger_10 := T10;
            TempContactBuffer1.DefaultInteger_11 := T11;
            TempContactBuffer1.DefaultInteger_12 := T12;
            TempContactBuffer1."Default Boolean" := TRUE;
            TempContactBuffer1."Division Code" := DivisionVar; //Division Code
            TempContactBuffer1.INSERT;
            T1 := 0; T2 := 0;T3 := 0;T4 := 0;T5 := 0;T6 := 0;
            T7 := 0;T8 := 0;T9 := 0;T10 := 0;T11 := 0;T12 := 0;
          END;
          NumVar += 2;FirstVar := FALSE;

          DivisionVar := TempContactBuffer."Division Code";
          T1 += TempContactBuffer.DefaultInteger_1;
          T2 += TempContactBuffer.DefaultInteger_2;
          T3 += TempContactBuffer.DefaultInteger_3;
          T4 += TempContactBuffer.DefaultInteger_4;
          T5 += TempContactBuffer.DefaultInteger_5;
          T6 += TempContactBuffer.DefaultInteger_6;
          T7 += TempContactBuffer.DefaultInteger_7;
          T8 += TempContactBuffer.DefaultInteger_8;
          T9 += TempContactBuffer.DefaultInteger_9;
          T10 += TempContactBuffer.DefaultInteger_10;
          T11 += TempContactBuffer.DefaultInteger_11;
          T12 += TempContactBuffer.DefaultInteger_12;
        UNTIL TempContactBuffer.NEXT = 0;
        NumVar += 2;
        TempContactBuffer1.INIT;
        TempContactBuffer1.Option := 'CONTACTMANAGEMENT';
        TempContactBuffer1."Option Choice" := FORMAT(NumVar);
        TempContactBuffer1.DefaultInteger := NumVar;
        TempContactBuffer1.DefaultText250 := 'Total for Division ' + DivisionVar;
        TempContactBuffer1."User ID" := 'Total for Division ' + DivisionVar;
        TempContactBuffer1.DefaultInteger_1 := T1;
        TempContactBuffer1.DefaultInteger_2 := T2;
        TempContactBuffer1.DefaultInteger_3 := T3;
        TempContactBuffer1.DefaultInteger_4 := T4;
        TempContactBuffer1.DefaultInteger_5 := T5;
        TempContactBuffer1.DefaultInteger_6 := T6;
        TempContactBuffer1.DefaultInteger_7 := T7;
        TempContactBuffer1.DefaultInteger_8 := T8;
        TempContactBuffer1.DefaultInteger_9 := T9;
        TempContactBuffer1.DefaultInteger_10 := T10;
        TempContactBuffer1.DefaultInteger_11 := T11;
        TempContactBuffer1.DefaultInteger_12 := T12;
        TempContactBuffer1."Default Boolean" := TRUE;
        TempContactBuffer1."Division Code" := DivisionVar; //Division Code
        TempContactBuffer1.INSERT;
      END;
      TempContactBuffer.DELETEALL;
      TempContactBuffer1.RESET;
      IF TempContactBuffer1.FINDFIRST THEN
        REPEAT
          TempContactBuffer.INIT;
          TempContactBuffer.TRANSFERFIELDS(TempContactBuffer1);
          TempContactBuffer.INSERT;
        UNTIL TempContactBuffer1.NEXT = 0;

      //Write code to transfer from temporary to permanent
      NumVar := 100;
      TempContactBuffer.RESET;
      TempContactBuffer.SETCURRENTKEY(DefaultInteger);
      IF TempContactBuffer.FINDSET THEN
        REPEAT
          ContactBufferPermanent.RESET;
          ContactBufferPermanent.SETRANGE(Option,'DUMPCONTACTLOG');
          ContactBufferPermanent.SETRANGE("Division Code",TempContactBuffer."Division Code");
          ContactBufferPermanent.SETRANGE("DefaultText 30_1",'20'+YearVar);  //it will add total contact line also
          IF ContactBufferPermanent.FINDFIRST THEN BEGIN
            IF MonthNo = 1 THEN
              ContactBufferPermanent.DefaultInteger_1 := TempContactBuffer.DefaultInteger_1
            ELSE IF MonthNo = 2 THEN
              ContactBufferPermanent.DefaultInteger_2 := TempContactBuffer.DefaultInteger_2
            ELSE IF MonthNo = 3 THEN
              ContactBufferPermanent.DefaultInteger_3 := TempContactBuffer.DefaultInteger_3
            ELSE IF MonthNo = 4 THEN
              ContactBufferPermanent.DefaultInteger_4 := TempContactBuffer.DefaultInteger_4
            ELSE IF MonthNo = 5 THEN
              ContactBufferPermanent.DefaultInteger_5 := TempContactBuffer.DefaultInteger_5
            ELSE IF MonthNo = 6 THEN
              ContactBufferPermanent.DefaultInteger_6 := TempContactBuffer.DefaultInteger_6
            ELSE IF MonthNo = 7 THEN
              ContactBufferPermanent.DefaultInteger_7 := TempContactBuffer.DefaultInteger_7
            ELSE IF MonthNo = 8 THEN
              ContactBufferPermanent.DefaultInteger_8 := TempContactBuffer.DefaultInteger_8
            ELSE IF MonthNo = 9 THEN
              ContactBufferPermanent.DefaultInteger_9 := TempContactBuffer.DefaultInteger_9
            ELSE IF MonthNo = 10 THEN
              ContactBufferPermanent.DefaultInteger_10 := TempContactBuffer.DefaultInteger_10
            ELSE IF MonthNo = 11 THEN
              ContactBufferPermanent.DefaultInteger_11 := TempContactBuffer.DefaultInteger_11
            ELSE IF MonthNo = 12 THEN
              ContactBufferPermanent.DefaultInteger_12 := TempContactBuffer.DefaultInteger_12;
            ContactBufferPermanent.MODIFY;
            NumVar := ContactBufferPermanent.DefaultInteger;
          END ELSE BEGIN
            ContactBufferPermanent.INIT;
            ContactBufferPermanent.Option := 'DUMPCONTACTLOG';
            ContactBufferPermanent."Option Choice" := FORMAT(NumVar + 10);
            ContactBufferPermanent.DefaultInteger := NumVar + 10;
            ContactBufferPermanent."DefaultText 30_1" := '20'+YearVar;
            ContactBufferPermanent.DefaultText250 := 'Total for Division ' + TempContactBuffer."Division Code";
            ContactBufferPermanent."User ID" := 'Total for Division ' + TempContactBuffer."Division Code";
            ContactBufferPermanent."Division Code" := TempContactBuffer."Division Code";
            IF MonthNo = 1 THEN
              ContactBufferPermanent.DefaultInteger_1 := TempContactBuffer.DefaultInteger_1
            ELSE IF MonthNo = 2 THEN
              ContactBufferPermanent.DefaultInteger_2 := TempContactBuffer.DefaultInteger_2
            ELSE IF MonthNo = 3 THEN
              ContactBufferPermanent.DefaultInteger_3 := TempContactBuffer.DefaultInteger_3
            ELSE IF MonthNo = 4 THEN
              ContactBufferPermanent.DefaultInteger_4 := TempContactBuffer.DefaultInteger_4
            ELSE IF MonthNo = 5 THEN
              ContactBufferPermanent.DefaultInteger_5 := TempContactBuffer.DefaultInteger_5
            ELSE IF MonthNo = 6 THEN
              ContactBufferPermanent.DefaultInteger_6 := TempContactBuffer.DefaultInteger_6
            ELSE IF MonthNo = 7 THEN
              ContactBufferPermanent.DefaultInteger_7 := TempContactBuffer.DefaultInteger_7
            ELSE IF MonthNo = 8 THEN
              ContactBufferPermanent.DefaultInteger_8 := TempContactBuffer.DefaultInteger_8
            ELSE IF MonthNo = 9 THEN
              ContactBufferPermanent.DefaultInteger_9 := TempContactBuffer.DefaultInteger_9
            ELSE IF MonthNo = 10 THEN
              ContactBufferPermanent.DefaultInteger_10 := TempContactBuffer.DefaultInteger_10
            ELSE IF MonthNo = 11 THEN
              ContactBufferPermanent.DefaultInteger_11 := TempContactBuffer.DefaultInteger_11
            ELSE IF MonthNo = 12 THEN
              ContactBufferPermanent.DefaultInteger_12 := TempContactBuffer.DefaultInteger_12;
            ContactBufferPermanent.INSERT;
          END;
        UNTIL TempContactBuffer.NEXT = 0;
      ContactBufferPermanent.RESET;
      ContactBufferPermanent.SETRANGE(Option,'DUMPCONTACTLOG');
      //ContactBufferPermanent.SETRANGE("Division Code",TempContactBuffer."Division Code");
      ContactBufferPermanent.SETRANGE(DefaultText250,'Total Contact');  //it will add total contact line also
      ContactBufferPermanent.SETRANGE("DefaultText 30_1",'20'+YearVar);
      IF ContactBufferPermanent.FINDFIRST THEN BEGIN
        IF MonthNo = 1 THEN
          ContactBufferPermanent.DefaultInteger_1 := M1
        ELSE IF MonthNo = 2 THEN
          ContactBufferPermanent.DefaultInteger_2 := M2
        ELSE IF MonthNo = 3 THEN
          ContactBufferPermanent.DefaultInteger_3 := M3
        ELSE IF MonthNo = 4 THEN
          ContactBufferPermanent.DefaultInteger_4 := M4
        ELSE IF MonthNo = 5 THEN
          ContactBufferPermanent.DefaultInteger_5 := M5
        ELSE IF MonthNo = 6 THEN
          ContactBufferPermanent.DefaultInteger_6 := M6
        ELSE IF MonthNo = 7 THEN
          ContactBufferPermanent.DefaultInteger_7 := M7
        ELSE IF MonthNo = 8 THEN
          ContactBufferPermanent.DefaultInteger_8 := M8
        ELSE IF MonthNo = 9 THEN
          ContactBufferPermanent.DefaultInteger_9 := M9
        ELSE IF MonthNo = 10 THEN
          ContactBufferPermanent.DefaultInteger_10 := M10
        ELSE IF MonthNo = 11 THEN
          ContactBufferPermanent.DefaultInteger_11 := M11
        ELSE IF MonthNo = 12 THEN
          ContactBufferPermanent.DefaultInteger_12 := M12;
        ContactBufferPermanent.MODIFY;
      END ELSE BEGIN
        ContactBufferPermanent.INIT;
        ContactBufferPermanent.Option := 'DUMPCONTACTLOG';
        ContactBufferPermanent."Option Choice" := FORMAT(NumVar + 100);
        ContactBufferPermanent.DefaultText250 := 'Total Contact';
        ContactBufferPermanent."DefaultText 30_1" := '20'+YearVar;
        IF MonthNo = 1 THEN
          ContactBufferPermanent.DefaultInteger_1 := M1
        ELSE IF MonthNo = 2 THEN
          ContactBufferPermanent.DefaultInteger_2 := M2
        ELSE IF MonthNo = 3 THEN
          ContactBufferPermanent.DefaultInteger_3 := M3
        ELSE IF MonthNo = 4 THEN
          ContactBufferPermanent.DefaultInteger_4 := M4
        ELSE IF MonthNo = 5 THEN
          ContactBufferPermanent.DefaultInteger_5 := M5
        ELSE IF MonthNo = 6 THEN
          ContactBufferPermanent.DefaultInteger_6 := M6
        ELSE IF MonthNo = 7 THEN
          ContactBufferPermanent.DefaultInteger_7 := M7
        ELSE IF MonthNo = 8 THEN
          ContactBufferPermanent.DefaultInteger_8 := M8
        ELSE IF MonthNo = 9 THEN
          ContactBufferPermanent.DefaultInteger_9 := M9
        ELSE IF MonthNo = 10 THEN
          ContactBufferPermanent.DefaultInteger_10 := M10
        ELSE IF MonthNo = 11 THEN
          ContactBufferPermanent.DefaultInteger_11 := M11
        ELSE IF MonthNo = 12 THEN
          ContactBufferPermanent.DefaultInteger_12 := M12;
        ContactBufferPermanent.DefaultInteger := NumVar + 100;
        ContactBufferPermanent.INSERT;
      END;
    END;

    LOCAL PROCEDURE ContactAddedByJob@1000000036();
    VAR
      ContactJobResponsibility@1000000004 : Record 5067;
      TempContactBuffer1@1000000016 : TEMPORARY Record 50063;
      DivisionVar@1000000015 : Code[20];
      FirstVar@1000000014 : Boolean;
      T1@1000000013 : Integer;
      T2@1000000012 : Integer;
      T3@1000000011 : Integer;
      T4@1000000010 : Integer;
      T5@1000000009 : Integer;
      T6@1000000008 : Integer;
      T7@1000000007 : Integer;
      T8@1000000006 : Integer;
      T9@1000000005 : Integer;
      T10@1000000002 : Integer;
      T11@1000000001 : Integer;
      T12@1000000000 : Integer;
      ContactBufferPermanent@1000000003 : Record 50063;
      ContactBufferZ@1000000017 : Record 50063;
    BEGIN
      //-->'Prospect Contact Added' and 'Prospect Contact Added by Person'
      M1 := 0;M2 := 0;M3 := 0;M4 := 0;M5 := 0;M6 := 0;
      M7 := 0;M8 := 0;M9 := 0;M10 := 0;M11 := 0;M12 := 0;
      CLEAR(TempContactBuffer);
      TempContactBuffer.DELETEALL;
      ContactAddedDatabyJob(MonthNo);
      CLEAR(TempContactBuffer1);
      TempContactBuffer1.DELETEALL;
      //--------------------------------
      NumVar := 0; //ReInitializing
      TempContactBuffer.RESET;
      TempContactBuffer.SETCURRENTKEY("Division Code",Integer_1);
      IF TempContactBuffer.FINDSET THEN BEGIN
        FirstVar := TRUE;
        REPEAT
          IF (NOT FirstVar) AND (DivisionVar <> TempContactBuffer."Division Code") THEN BEGIN
            NumVar += 2;
            TempContactBuffer1.INIT;
            TempContactBuffer1.Option := 'CONTACTMANAGEMENT';
            TempContactBuffer1."Option Choice" := FORMAT(NumVar);
            TempContactBuffer1.DefaultInteger := NumVar;
            TempContactBuffer1.DefaultText250 := 'Total for Division ' + DivisionVar;
            TempContactBuffer1."User ID" := 'Total for Division ' + DivisionVar;
            TempContactBuffer1.DefaultInteger_1 := T1;
            TempContactBuffer1.DefaultInteger_2 := T2;
            TempContactBuffer1.DefaultInteger_3 := T3;
            TempContactBuffer1.DefaultInteger_4 := T4;
            TempContactBuffer1.DefaultInteger_5 := T5;
            TempContactBuffer1.DefaultInteger_6 := T6;
            TempContactBuffer1.DefaultInteger_7 := T7;
            TempContactBuffer1.DefaultInteger_8 := T8;
            TempContactBuffer1.DefaultInteger_9 := T9;
            TempContactBuffer1.DefaultInteger_10 := T10;
            TempContactBuffer1.DefaultInteger_11 := T11;
            TempContactBuffer1.DefaultInteger_12 := T12;
            TempContactBuffer1."Default Boolean" := TRUE;
            TempContactBuffer1."Division Code" := DivisionVar; //Division Code
            TempContactBuffer1.INSERT;
            T1 := 0; T2 := 0;T3 := 0;T4 := 0;T5 := 0;T6 := 0;
            T7 := 0;T8 := 0;T9 := 0;T10 := 0;T11 := 0;T12 := 0;
          END;
          NumVar += 2;FirstVar := FALSE;
          TempContactBuffer1.INIT;
          TempContactBuffer1.TRANSFERFIELDS(TempContactBuffer);
          TempContactBuffer1."Option Choice" := FORMAT(NumVar);
          TempContactBuffer1.DefaultInteger := NumVar;
          TempContactBuffer1.INSERT;
          DivisionVar := TempContactBuffer."Division Code";
          T1 += TempContactBuffer.DefaultInteger_1;
          T2 += TempContactBuffer.DefaultInteger_2;
          T3 += TempContactBuffer.DefaultInteger_3;
          T4 += TempContactBuffer.DefaultInteger_4;
          T5 += TempContactBuffer.DefaultInteger_5;
          T6 += TempContactBuffer.DefaultInteger_6;
          T7 += TempContactBuffer.DefaultInteger_7;
          T8 += TempContactBuffer.DefaultInteger_8;
          T9 += TempContactBuffer.DefaultInteger_9;
          T10 += TempContactBuffer.DefaultInteger_10;
          T11 += TempContactBuffer.DefaultInteger_11;
          T12 += TempContactBuffer.DefaultInteger_12;
        UNTIL TempContactBuffer.NEXT = 0;
        NumVar += 2;
        TempContactBuffer1.INIT;
        TempContactBuffer1.Option := 'CONTACTMANAGEMENT';
        TempContactBuffer1."Option Choice" := FORMAT(NumVar);
        TempContactBuffer1.DefaultInteger := NumVar;
        TempContactBuffer1.DefaultText250 := 'Total for Division ' + DivisionVar;
        TempContactBuffer1."User ID" := 'Total for Division ' + DivisionVar;
        TempContactBuffer1.DefaultInteger_1 := T1;
        TempContactBuffer1.DefaultInteger_2 := T2;
        TempContactBuffer1.DefaultInteger_3 := T3;
        TempContactBuffer1.DefaultInteger_4 := T4;
        TempContactBuffer1.DefaultInteger_5 := T5;
        TempContactBuffer1.DefaultInteger_6 := T6;
        TempContactBuffer1.DefaultInteger_7 := T7;
        TempContactBuffer1.DefaultInteger_8 := T8;
        TempContactBuffer1.DefaultInteger_9 := T9;
        TempContactBuffer1.DefaultInteger_10 := T10;
        TempContactBuffer1.DefaultInteger_11 := T11;
        TempContactBuffer1.DefaultInteger_12 := T12;
        TempContactBuffer1."Default Boolean" := TRUE;
        TempContactBuffer1."Division Code" := DivisionVar; //Division Code
        TempContactBuffer1.INSERT;
      END;
      CLEAR(TempContactBuffer);
      TempContactBuffer.DELETEALL;
      TempContactBuffer1.RESET;
      IF TempContactBuffer1.FINDFIRST THEN
        REPEAT
          TempContactBuffer.INIT;
          TempContactBuffer.TRANSFERFIELDS(TempContactBuffer1);
          TempContactBuffer.INSERT;
      //    TempContactBufferZ.init;
      //    TempContactBufferz.TRANSFERFIELDS(TempContactBuffer1);
      //    TempContactBufferZ."To Email" := 'PSHUKLA';
      //    TempContactBufferz.INSERT;
        UNTIL TempContactBuffer1.NEXT = 0;

      //Write code to transfer from temporary to permanent
      NumVar := 100;
      TempContactBuffer.RESET;
      TempContactBuffer.SETCURRENTKEY(DefaultInteger);
      IF TempContactBuffer.FINDSET THEN
        REPEAT
          ContactBufferPermanent.RESET;
          ContactBufferPermanent.SETRANGE(Option,'DUMPCONTACTLOGBYJOB');
          ContactBufferPermanent.SETRANGE("Division Code",TempContactBuffer."Division Code");
          ContactBufferPermanent.SETRANGE("DefaultText 30_1",'20'+YearVar);  //it will add total contact line also
          ContactBufferPermanent.SETRANGE(DefaultText250,TempContactBuffer."User ID");
          IF ContactBufferPermanent.FINDFIRST THEN BEGIN
            IF MonthNo = 1 THEN
              ContactBufferPermanent.DefaultInteger_1 := TempContactBuffer.DefaultInteger_1
            ELSE IF MonthNo = 2 THEN
              ContactBufferPermanent.DefaultInteger_2 := TempContactBuffer.DefaultInteger_2
            ELSE IF MonthNo = 3 THEN
              ContactBufferPermanent.DefaultInteger_3 := TempContactBuffer.DefaultInteger_3
            ELSE IF MonthNo = 4 THEN
              ContactBufferPermanent.DefaultInteger_4 := TempContactBuffer.DefaultInteger_4
            ELSE IF MonthNo = 5 THEN
              ContactBufferPermanent.DefaultInteger_5 := TempContactBuffer.DefaultInteger_5
            ELSE IF MonthNo = 6 THEN
              ContactBufferPermanent.DefaultInteger_6 := TempContactBuffer.DefaultInteger_6
            ELSE IF MonthNo = 7 THEN
              ContactBufferPermanent.DefaultInteger_7 := TempContactBuffer.DefaultInteger_7
            ELSE IF MonthNo = 8 THEN
              ContactBufferPermanent.DefaultInteger_8 := TempContactBuffer.DefaultInteger_8
            ELSE IF MonthNo = 9 THEN
              ContactBufferPermanent.DefaultInteger_9 := TempContactBuffer.DefaultInteger_9
            ELSE IF MonthNo = 10 THEN
              ContactBufferPermanent.DefaultInteger_10 := TempContactBuffer.DefaultInteger_10
            ELSE IF MonthNo = 11 THEN
              ContactBufferPermanent.DefaultInteger_11 := TempContactBuffer.DefaultInteger_11
            ELSE IF MonthNo = 12 THEN
              ContactBufferPermanent.DefaultInteger_12 := TempContactBuffer.DefaultInteger_12;
            ContactBufferPermanent.Integer_1 := TempContactBuffer.Integer_1;
            ContactBufferPermanent."Default Boolean" := TempContactBuffer."Default Boolean";
            ContactBufferPermanent.MODIFY;
            NumVar := ContactBufferPermanent.DefaultInteger;
          END ELSE BEGIN
            ContactBufferPermanent.INIT;
            ContactBufferPermanent.Option := 'DUMPCONTACTLOGBYJOB';
            IF STRPOS(TempContactBuffer."User ID",'Total for') > 0 THEN
              NumVar := GetLineNoContactbyJob(TempContactBuffer."Division Code",TempContactBuffer.Integer_1,TRUE)
            ELSE
              NumVar := GetLineNoContactbyJob(TempContactBuffer."Division Code",TempContactBuffer.Integer_1,FALSE);
            ContactBufferPermanent."Option Choice" := FORMAT(NumVar);
            ContactBufferPermanent.DefaultInteger := NumVar;
            ContactBufferPermanent."DefaultText 30_1" := '20'+YearVar;
            ContactBufferPermanent.DefaultText250 := TempContactBuffer."User ID";;//'Total for Division ' + TempContactBuffer."Division Code";
            ContactBufferPermanent.DefaultText250_1 := TempContactBuffer."User ID";
            ContactBufferPermanent."Division Code" := TempContactBuffer."Division Code";
            ContactBufferPermanent.Integer_1 := TempContactBuffer.Integer_1;
            IF MonthNo = 1 THEN
              ContactBufferPermanent.DefaultInteger_1 := TempContactBuffer.DefaultInteger_1
            ELSE IF MonthNo = 2 THEN
              ContactBufferPermanent.DefaultInteger_2 := TempContactBuffer.DefaultInteger_2
            ELSE IF MonthNo = 3 THEN
              ContactBufferPermanent.DefaultInteger_3 := TempContactBuffer.DefaultInteger_3
            ELSE IF MonthNo = 4 THEN
              ContactBufferPermanent.DefaultInteger_4 := TempContactBuffer.DefaultInteger_4
            ELSE IF MonthNo = 5 THEN
              ContactBufferPermanent.DefaultInteger_5 := TempContactBuffer.DefaultInteger_5
            ELSE IF MonthNo = 6 THEN
              ContactBufferPermanent.DefaultInteger_6 := TempContactBuffer.DefaultInteger_6
            ELSE IF MonthNo = 7 THEN
              ContactBufferPermanent.DefaultInteger_7 := TempContactBuffer.DefaultInteger_7
            ELSE IF MonthNo = 8 THEN
              ContactBufferPermanent.DefaultInteger_8 := TempContactBuffer.DefaultInteger_8
            ELSE IF MonthNo = 9 THEN
              ContactBufferPermanent.DefaultInteger_9 := TempContactBuffer.DefaultInteger_9
            ELSE IF MonthNo = 10 THEN
              ContactBufferPermanent.DefaultInteger_10 := TempContactBuffer.DefaultInteger_10
            ELSE IF MonthNo = 11 THEN
              ContactBufferPermanent.DefaultInteger_11 := TempContactBuffer.DefaultInteger_11
            ELSE IF MonthNo = 12 THEN
              ContactBufferPermanent.DefaultInteger_12 := TempContactBuffer.DefaultInteger_12;
            ContactBufferPermanent."Default Boolean" := TempContactBuffer."Default Boolean";
            ContactBufferPermanent.INSERT;
            //NumVar += 10;
          END;
        UNTIL TempContactBuffer.NEXT = 0;
      ContactBufferPermanent.RESET;
      ContactBufferPermanent.SETRANGE(Option,'DUMPCONTACTLOGBYJOB');
      //ContactBufferPermanent.SETRANGE("Division Code",TempContactBuffer."Division Code");
      ContactBufferPermanent.SETRANGE(DefaultText250,'Total Contact');  //it will add total contact line also
      ContactBufferPermanent.SETRANGE("DefaultText 30_1",'20'+YearVar);
      IF ContactBufferPermanent.FINDFIRST THEN BEGIN
        IF MonthNo = 1 THEN
          ContactBufferPermanent.DefaultInteger_1 := M1
        ELSE IF MonthNo = 2 THEN
          ContactBufferPermanent.DefaultInteger_2 := M2
        ELSE IF MonthNo = 3 THEN
          ContactBufferPermanent.DefaultInteger_3 := M3
        ELSE IF MonthNo = 4 THEN
          ContactBufferPermanent.DefaultInteger_4 := M4
        ELSE IF MonthNo = 5 THEN
          ContactBufferPermanent.DefaultInteger_5 := M5
        ELSE IF MonthNo = 6 THEN
          ContactBufferPermanent.DefaultInteger_6 := M6
        ELSE IF MonthNo = 7 THEN
          ContactBufferPermanent.DefaultInteger_7 := M7
        ELSE IF MonthNo = 8 THEN
          ContactBufferPermanent.DefaultInteger_8 := M8
        ELSE IF MonthNo = 9 THEN
          ContactBufferPermanent.DefaultInteger_9 := M9
        ELSE IF MonthNo = 10 THEN
          ContactBufferPermanent.DefaultInteger_10 := M10
        ELSE IF MonthNo = 11 THEN
          ContactBufferPermanent.DefaultInteger_11 := M11
        ELSE IF MonthNo = 12 THEN
          ContactBufferPermanent.DefaultInteger_12 := M12;
        ContactBufferPermanent.MODIFY;
      END ELSE BEGIN
        ContactBufferPermanent.INIT;
        ContactBufferPermanent.Option := 'DUMPCONTACTLOGBYJOB';
        ContactBufferPermanent."Option Choice" := FORMAT(NumVar + 100);
        ContactBufferPermanent.DefaultText250 := 'Total Contact';
        ContactBufferPermanent."DefaultText 30_1" := '20'+YearVar;
        IF MonthNo = 1 THEN
          ContactBufferPermanent.DefaultInteger_1 := M1
        ELSE IF MonthNo = 2 THEN
          ContactBufferPermanent.DefaultInteger_2 := M2
        ELSE IF MonthNo = 3 THEN
          ContactBufferPermanent.DefaultInteger_3 := M3
        ELSE IF MonthNo = 4 THEN
          ContactBufferPermanent.DefaultInteger_4 := M4
        ELSE IF MonthNo = 5 THEN
          ContactBufferPermanent.DefaultInteger_5 := M5
        ELSE IF MonthNo = 6 THEN
          ContactBufferPermanent.DefaultInteger_6 := M6
        ELSE IF MonthNo = 7 THEN
          ContactBufferPermanent.DefaultInteger_7 := M7
        ELSE IF MonthNo = 8 THEN
          ContactBufferPermanent.DefaultInteger_8 := M8
        ELSE IF MonthNo = 9 THEN
          ContactBufferPermanent.DefaultInteger_9 := M9
        ELSE IF MonthNo = 10 THEN
          ContactBufferPermanent.DefaultInteger_10 := M10
        ELSE IF MonthNo = 11 THEN
          ContactBufferPermanent.DefaultInteger_11 := M11
        ELSE IF MonthNo = 12 THEN
          ContactBufferPermanent.DefaultInteger_12 := M12;
        ContactBufferPermanent.DefaultInteger := NumVar + 100;
        ContactBufferPermanent.INSERT;
      END;
    END;

    LOCAL PROCEDURE ProspectContactAdded@1000000022();
    VAR
      ContactJobResponsibility@1000000003 : Record 5067;
      TempContactBuffer1@1000000000 : TEMPORARY Record 50063;
      DivisionVar@1000000015 : Code[20];
      FirstVar@1000000014 : Boolean;
      T1@1000000013 : Integer;
      T2@1000000012 : Integer;
      T3@1000000011 : Integer;
      T4@1000000010 : Integer;
      T5@1000000009 : Integer;
      T6@1000000008 : Integer;
      T7@1000000007 : Integer;
      T8@1000000006 : Integer;
      T9@1000000005 : Integer;
      T10@1000000004 : Integer;
      T11@1000000002 : Integer;
      T12@1000000001 : Integer;
      ContactBufferPermanent@1000000016 : Record 50063;
    BEGIN
      //-->'Customer Contact Added' and 'Customer Contact Added by Person'
      M1 := 0;M2 := 0;M3 := 0;M4 := 0;M5 := 0;M6 := 0;
      M7 := 0;M8 := 0;M9 := 0;M10 := 0;M11 := 0;M12 := 0;
      CLEAR(TempContactBuffer);
      TempContactBuffer.DELETEALL;
      ContactAddedDataPros(MonthNo);
      CLEAR(TempContactBuffer1);
      TempContactBuffer1.DELETEALL;
      NumVar := 0; //ReInitializing
      CLEAR(TempContactBuffer1);
      TempContactBuffer1.DELETEALL;
      TempContactBuffer.RESET;
      TempContactBuffer.SETCURRENTKEY("Division Code",Integer_1);
      IF TempContactBuffer.FINDSET THEN BEGIN
        FirstVar := TRUE;
        REPEAT
          IF (NOT FirstVar) AND (DivisionVar <> TempContactBuffer."Division Code") THEN BEGIN
            NumVar += 2;
            TempContactBuffer1.INIT;
            TempContactBuffer1.Option := 'CONTACTMANAGEMENT';
            TempContactBuffer1."Option Choice" := FORMAT(NumVar);
            TempContactBuffer1.DefaultInteger := NumVar;
            TempContactBuffer1.DefaultText250 := 'Total for Division ' + DivisionVar;
            TempContactBuffer1."User ID" := 'Total for Division ' + DivisionVar;
            TempContactBuffer1.DefaultInteger_1 := T1;
            TempContactBuffer1.DefaultInteger_2 := T2;
            TempContactBuffer1.DefaultInteger_3 := T3;
            TempContactBuffer1.DefaultInteger_4 := T4;
            TempContactBuffer1.DefaultInteger_5 := T5;
            TempContactBuffer1.DefaultInteger_6 := T6;
            TempContactBuffer1.DefaultInteger_7 := T7;
            TempContactBuffer1.DefaultInteger_8 := T8;
            TempContactBuffer1.DefaultInteger_9 := T9;
            TempContactBuffer1.DefaultInteger_10 := T10;
            TempContactBuffer1.DefaultInteger_11 := T11;
            TempContactBuffer1.DefaultInteger_12 := T12;
            TempContactBuffer1."Default Boolean" := TRUE;
            TempContactBuffer1."Division Code" := DivisionVar; //Division Code
            TempContactBuffer1.INSERT;
            T1 := 0; T2 := 0;T3 := 0;T4 := 0;T5 := 0;T6 := 0;
            T7 := 0;T8 := 0;T9 := 0;T10 := 0;T11 := 0;T12 := 0;
          END;
          NumVar += 2;FirstVar := FALSE;
          DivisionVar := TempContactBuffer."Division Code";
          T1 += TempContactBuffer.DefaultInteger_1;
          T2 += TempContactBuffer.DefaultInteger_2;
          T3 += TempContactBuffer.DefaultInteger_3;
          T4 += TempContactBuffer.DefaultInteger_4;
          T5 += TempContactBuffer.DefaultInteger_5;
          T6 += TempContactBuffer.DefaultInteger_6;
          T7 += TempContactBuffer.DefaultInteger_7;
          T8 += TempContactBuffer.DefaultInteger_8;
          T9 += TempContactBuffer.DefaultInteger_9;
          T10 += TempContactBuffer.DefaultInteger_10;
          T11 += TempContactBuffer.DefaultInteger_11;
          T12 += TempContactBuffer.DefaultInteger_12;
        UNTIL TempContactBuffer.NEXT = 0;
        NumVar += 2;
        TempContactBuffer1.INIT;
        TempContactBuffer1.Option := 'CONTACTMANAGEMENT';
        TempContactBuffer1."Option Choice" := FORMAT(NumVar);
        TempContactBuffer1.DefaultInteger := NumVar;
        TempContactBuffer1.DefaultText250 := 'Total for Division ' + DivisionVar;
        TempContactBuffer1."User ID" := 'Total for Division ' + DivisionVar;
        TempContactBuffer1.DefaultInteger_1 := T1;
        TempContactBuffer1.DefaultInteger_2 := T2;
        TempContactBuffer1.DefaultInteger_3 := T3;
        TempContactBuffer1.DefaultInteger_4 := T4;
        TempContactBuffer1.DefaultInteger_5 := T5;
        TempContactBuffer1.DefaultInteger_6 := T6;
        TempContactBuffer1.DefaultInteger_7 := T7;
        TempContactBuffer1.DefaultInteger_8 := T8;
        TempContactBuffer1.DefaultInteger_9 := T9;
        TempContactBuffer1.DefaultInteger_10 := T10;
        TempContactBuffer1.DefaultInteger_11 := T11;
        TempContactBuffer1.DefaultInteger_12 := T12;
        TempContactBuffer1."Default Boolean" := TRUE;
        TempContactBuffer1."Division Code" := DivisionVar; //Division Code
        TempContactBuffer1.INSERT;
      END;
      TempContactBuffer.DELETEALL;
      TempContactBuffer1.RESET;
      IF TempContactBuffer1.FINDFIRST THEN
        REPEAT
          TempContactBuffer.INIT;
          TempContactBuffer.TRANSFERFIELDS(TempContactBuffer1);
          TempContactBuffer.INSERT;
        UNTIL TempContactBuffer1.NEXT = 0;

      //Write code to transfer from temporary to permanent
      NumVar := 100;
      TempContactBuffer.RESET;
      TempContactBuffer.SETCURRENTKEY(DefaultInteger);
      IF TempContactBuffer.FINDSET THEN
        REPEAT
          ContactBufferPermanent.RESET;
          ContactBufferPermanent.SETRANGE(Option,'DUMPCONTACTLOGPROSPECT');
          ContactBufferPermanent.SETRANGE("Division Code",TempContactBuffer."Division Code");
          ContactBufferPermanent.SETRANGE("DefaultText 30_1",'20'+YearVar);  //it will add total contact line also
          IF ContactBufferPermanent.FINDFIRST THEN BEGIN
            IF MonthNo = 1 THEN
              ContactBufferPermanent.DefaultInteger_1 := TempContactBuffer.DefaultInteger_1
            ELSE IF MonthNo = 2 THEN
              ContactBufferPermanent.DefaultInteger_2 := TempContactBuffer.DefaultInteger_2
            ELSE IF MonthNo = 3 THEN
              ContactBufferPermanent.DefaultInteger_3 := TempContactBuffer.DefaultInteger_3
            ELSE IF MonthNo = 4 THEN
              ContactBufferPermanent.DefaultInteger_4 := TempContactBuffer.DefaultInteger_4
            ELSE IF MonthNo = 5 THEN
              ContactBufferPermanent.DefaultInteger_5 := TempContactBuffer.DefaultInteger_5
            ELSE IF MonthNo = 6 THEN
              ContactBufferPermanent.DefaultInteger_6 := TempContactBuffer.DefaultInteger_6
            ELSE IF MonthNo = 7 THEN
              ContactBufferPermanent.DefaultInteger_7 := TempContactBuffer.DefaultInteger_7
            ELSE IF MonthNo = 8 THEN
              ContactBufferPermanent.DefaultInteger_8 := TempContactBuffer.DefaultInteger_8
            ELSE IF MonthNo = 9 THEN
              ContactBufferPermanent.DefaultInteger_9 := TempContactBuffer.DefaultInteger_9
            ELSE IF MonthNo = 10 THEN
              ContactBufferPermanent.DefaultInteger_10 := TempContactBuffer.DefaultInteger_10
            ELSE IF MonthNo = 11 THEN
              ContactBufferPermanent.DefaultInteger_11 := TempContactBuffer.DefaultInteger_11
            ELSE IF MonthNo = 12 THEN
              ContactBufferPermanent.DefaultInteger_12 := TempContactBuffer.DefaultInteger_12;
            ContactBufferPermanent.MODIFY;
            NumVar := ContactBufferPermanent.DefaultInteger;
          END ELSE BEGIN
            ContactBufferPermanent.INIT;
            ContactBufferPermanent.Option := 'DUMPCONTACTLOGPROSPECT';
            ContactBufferPermanent."Option Choice" := FORMAT(NumVar + 10);
            ContactBufferPermanent.DefaultInteger := NumVar + 10;
            ContactBufferPermanent."DefaultText 30_1" := '20'+YearVar;
            ContactBufferPermanent.DefaultText250 := 'Total for Division ' + TempContactBuffer."Division Code";
            ContactBufferPermanent."User ID" := 'Total for Division ' + TempContactBuffer."Division Code";
            ContactBufferPermanent."Division Code" := TempContactBuffer."Division Code";
            IF MonthNo = 1 THEN
              ContactBufferPermanent.DefaultInteger_1 := TempContactBuffer.DefaultInteger_1
            ELSE IF MonthNo = 2 THEN
              ContactBufferPermanent.DefaultInteger_2 := TempContactBuffer.DefaultInteger_2
            ELSE IF MonthNo = 3 THEN
              ContactBufferPermanent.DefaultInteger_3 := TempContactBuffer.DefaultInteger_3
            ELSE IF MonthNo = 4 THEN
              ContactBufferPermanent.DefaultInteger_4 := TempContactBuffer.DefaultInteger_4
            ELSE IF MonthNo = 5 THEN
              ContactBufferPermanent.DefaultInteger_5 := TempContactBuffer.DefaultInteger_5
            ELSE IF MonthNo = 6 THEN
              ContactBufferPermanent.DefaultInteger_6 := TempContactBuffer.DefaultInteger_6
            ELSE IF MonthNo = 7 THEN
              ContactBufferPermanent.DefaultInteger_7 := TempContactBuffer.DefaultInteger_7
            ELSE IF MonthNo = 8 THEN
              ContactBufferPermanent.DefaultInteger_8 := TempContactBuffer.DefaultInteger_8
            ELSE IF MonthNo = 9 THEN
              ContactBufferPermanent.DefaultInteger_9 := TempContactBuffer.DefaultInteger_9
            ELSE IF MonthNo = 10 THEN
              ContactBufferPermanent.DefaultInteger_10 := TempContactBuffer.DefaultInteger_10
            ELSE IF MonthNo = 11 THEN
              ContactBufferPermanent.DefaultInteger_11 := TempContactBuffer.DefaultInteger_11
            ELSE IF MonthNo = 12 THEN
              ContactBufferPermanent.DefaultInteger_12 := TempContactBuffer.DefaultInteger_12;
            ContactBufferPermanent.INSERT;
          END;
        UNTIL TempContactBuffer.NEXT = 0;
      ContactBufferPermanent.RESET;
      ContactBufferPermanent.SETRANGE(Option,'DUMPCONTACTLOGPROSPECT');
      //ContactBufferPermanent.SETRANGE("Division Code",TempContactBuffer."Division Code");
      ContactBufferPermanent.SETRANGE(DefaultText250,'Total Prospects');  //it will add total contact line also
      ContactBufferPermanent.SETRANGE("DefaultText 30_1",'20'+YearVar);
      IF ContactBufferPermanent.FINDFIRST THEN BEGIN
        IF MonthNo = 1 THEN
          ContactBufferPermanent.DefaultInteger_1 := M1
        ELSE IF MonthNo = 2 THEN
          ContactBufferPermanent.DefaultInteger_2 := M2
        ELSE IF MonthNo = 3 THEN
          ContactBufferPermanent.DefaultInteger_3 := M3
        ELSE IF MonthNo = 4 THEN
          ContactBufferPermanent.DefaultInteger_4 := M4
        ELSE IF MonthNo = 5 THEN
          ContactBufferPermanent.DefaultInteger_5 := M5
        ELSE IF MonthNo = 6 THEN
          ContactBufferPermanent.DefaultInteger_6 := M6
        ELSE IF MonthNo = 7 THEN
          ContactBufferPermanent.DefaultInteger_7 := M7
        ELSE IF MonthNo = 8 THEN
          ContactBufferPermanent.DefaultInteger_8 := M8
        ELSE IF MonthNo = 9 THEN
          ContactBufferPermanent.DefaultInteger_9 := M9
        ELSE IF MonthNo = 10 THEN
          ContactBufferPermanent.DefaultInteger_10 := M10
        ELSE IF MonthNo = 11 THEN
          ContactBufferPermanent.DefaultInteger_11 := M11
        ELSE IF MonthNo = 12 THEN
          ContactBufferPermanent.DefaultInteger_12 := M12;
        ContactBufferPermanent.MODIFY;
      END ELSE BEGIN
        ContactBufferPermanent.INIT;
        ContactBufferPermanent.Option := 'DUMPCONTACTLOGPROSPECT';
        ContactBufferPermanent."Option Choice" := FORMAT(NumVar + 100);
        ContactBufferPermanent.DefaultText250 := 'Total Prospects';
        ContactBufferPermanent."DefaultText 30_1" := '20'+YearVar;
        IF MonthNo = 1 THEN
          ContactBufferPermanent.DefaultInteger_1 := M1
        ELSE IF MonthNo = 2 THEN
          ContactBufferPermanent.DefaultInteger_2 := M2
        ELSE IF MonthNo = 3 THEN
          ContactBufferPermanent.DefaultInteger_3 := M3
        ELSE IF MonthNo = 4 THEN
          ContactBufferPermanent.DefaultInteger_4 := M4
        ELSE IF MonthNo = 5 THEN
          ContactBufferPermanent.DefaultInteger_5 := M5
        ELSE IF MonthNo = 6 THEN
          ContactBufferPermanent.DefaultInteger_6 := M6
        ELSE IF MonthNo = 7 THEN
          ContactBufferPermanent.DefaultInteger_7 := M7
        ELSE IF MonthNo = 8 THEN
          ContactBufferPermanent.DefaultInteger_8 := M8
        ELSE IF MonthNo = 9 THEN
          ContactBufferPermanent.DefaultInteger_9 := M9
        ELSE IF MonthNo = 10 THEN
          ContactBufferPermanent.DefaultInteger_10 := M10
        ELSE IF MonthNo = 11 THEN
          ContactBufferPermanent.DefaultInteger_11 := M11
        ELSE IF MonthNo = 12 THEN
          ContactBufferPermanent.DefaultInteger_12 := M12;
        ContactBufferPermanent.DefaultInteger := NumVar + 100;
        ContactBufferPermanent.INSERT;
      END;
    END;

    LOCAL PROCEDURE ProspectContactAddedByJob@1000000020();
    VAR
      ContactJobResponsibility@1000000004 : Record 5067;
      TempContactBuffer1@1000000016 : TEMPORARY Record 50063;
      DivisionVar@1000000015 : Code[20];
      FirstVar@1000000014 : Boolean;
      T1@1000000013 : Integer;
      T2@1000000012 : Integer;
      T3@1000000011 : Integer;
      T4@1000000010 : Integer;
      T5@1000000009 : Integer;
      T6@1000000008 : Integer;
      T7@1000000007 : Integer;
      T8@1000000006 : Integer;
      T9@1000000005 : Integer;
      T10@1000000002 : Integer;
      T11@1000000001 : Integer;
      T12@1000000000 : Integer;
      ContactBufferPermanent@1000000003 : Record 50063;
    BEGIN
      //-->'Prospect Contact Added' and 'Prospect Contact Added by Person'
      M1 := 0;M2 := 0;M3 := 0;M4 := 0;M5 := 0;M6 := 0;
      M7 := 0;M8 := 0;M9 := 0;M10 := 0;M11 := 0;M12 := 0;
      CLEAR(TempContactBuffer);
      TempContactBuffer.DELETEALL;
      ContactAddedDatabyJobPros(MonthNo);
      CLEAR(TempContactBuffer1);
      TempContactBuffer1.DELETEALL;
      //--------------------------------
      NumVar := 0; //ReInitializing
      TempContactBuffer.RESET;
      TempContactBuffer.SETCURRENTKEY("Division Code",Integer_1);
      IF TempContactBuffer.FINDSET THEN BEGIN
        FirstVar := TRUE;
        REPEAT
          IF (NOT FirstVar) AND (DivisionVar <> TempContactBuffer."Division Code") THEN BEGIN
            NumVar += 2;
            TempContactBuffer1.INIT;
            TempContactBuffer1.Option := 'CONTACTMANAGEMENT';
            TempContactBuffer1."Option Choice" := FORMAT(NumVar);
            TempContactBuffer1.DefaultInteger := NumVar;
            TempContactBuffer1.DefaultText250 := 'Total for Division ' + DivisionVar;
            TempContactBuffer1."User ID" := 'Total for Division ' + DivisionVar;
            TempContactBuffer1.DefaultInteger_1 := T1;
            TempContactBuffer1.DefaultInteger_2 := T2;
            TempContactBuffer1.DefaultInteger_3 := T3;
            TempContactBuffer1.DefaultInteger_4 := T4;
            TempContactBuffer1.DefaultInteger_5 := T5;
            TempContactBuffer1.DefaultInteger_6 := T6;
            TempContactBuffer1.DefaultInteger_7 := T7;
            TempContactBuffer1.DefaultInteger_8 := T8;
            TempContactBuffer1.DefaultInteger_9 := T9;
            TempContactBuffer1.DefaultInteger_10 := T10;
            TempContactBuffer1.DefaultInteger_11 := T11;
            TempContactBuffer1.DefaultInteger_12 := T12;
            TempContactBuffer1."Default Boolean" := TRUE;
            TempContactBuffer1."Division Code" := DivisionVar; //Division Code
            TempContactBuffer1.INSERT;
            T1 := 0; T2 := 0;T3 := 0;T4 := 0;T5 := 0;T6 := 0;
            T7 := 0;T8 := 0;T9 := 0;T10 := 0;T11 := 0;T12 := 0;
          END;
          NumVar += 2;FirstVar := FALSE;
          TempContactBuffer1.INIT;
          TempContactBuffer1.TRANSFERFIELDS(TempContactBuffer);
          TempContactBuffer1."Option Choice" := FORMAT(NumVar);
          TempContactBuffer1.DefaultInteger := NumVar;
          TempContactBuffer1.INSERT;
          DivisionVar := TempContactBuffer."Division Code";
          T1 += TempContactBuffer.DefaultInteger_1;
          T2 += TempContactBuffer.DefaultInteger_2;
          T3 += TempContactBuffer.DefaultInteger_3;
          T4 += TempContactBuffer.DefaultInteger_4;
          T5 += TempContactBuffer.DefaultInteger_5;
          T6 += TempContactBuffer.DefaultInteger_6;
          T7 += TempContactBuffer.DefaultInteger_7;
          T8 += TempContactBuffer.DefaultInteger_8;
          T9 += TempContactBuffer.DefaultInteger_9;
          T10 += TempContactBuffer.DefaultInteger_10;
          T11 += TempContactBuffer.DefaultInteger_11;
          T12 += TempContactBuffer.DefaultInteger_12;
        UNTIL TempContactBuffer.NEXT = 0;
        NumVar += 2;
        TempContactBuffer1.INIT;
        TempContactBuffer1.Option := 'CONTACTMANAGEMENT';
        TempContactBuffer1."Option Choice" := FORMAT(NumVar);
        TempContactBuffer1.DefaultInteger := NumVar;
        TempContactBuffer1.DefaultText250 := 'Total for Division ' + DivisionVar;
        TempContactBuffer1."User ID" := 'Total for Division ' + DivisionVar;
        TempContactBuffer1.DefaultInteger_1 := T1;
        TempContactBuffer1.DefaultInteger_2 := T2;
        TempContactBuffer1.DefaultInteger_3 := T3;
        TempContactBuffer1.DefaultInteger_4 := T4;
        TempContactBuffer1.DefaultInteger_5 := T5;
        TempContactBuffer1.DefaultInteger_6 := T6;
        TempContactBuffer1.DefaultInteger_7 := T7;
        TempContactBuffer1.DefaultInteger_8 := T8;
        TempContactBuffer1.DefaultInteger_9 := T9;
        TempContactBuffer1.DefaultInteger_10 := T10;
        TempContactBuffer1.DefaultInteger_11 := T11;
        TempContactBuffer1.DefaultInteger_12 := T12;
        TempContactBuffer1."Default Boolean" := TRUE;
        TempContactBuffer1."Division Code" := DivisionVar; //Division Code
        TempContactBuffer1.INSERT;
      END;
      TempContactBuffer.DELETEALL;
      TempContactBuffer1.RESET;
      IF TempContactBuffer1.FINDFIRST THEN
        REPEAT
          TempContactBuffer.INIT;
          TempContactBuffer.TRANSFERFIELDS(TempContactBuffer1);
          TempContactBuffer.INSERT;
        UNTIL TempContactBuffer1.NEXT = 0;

      //--------------------------------
      //Write code to transfer from temporary to permanent
      NumVar := 100;
      TempContactBuffer.RESET;
      TempContactBuffer.SETCURRENTKEY(DefaultInteger);
      IF TempContactBuffer.FINDSET THEN
        REPEAT
          ContactBufferPermanent.RESET;
          ContactBufferPermanent.SETRANGE(Option,'DUMPCONTACTLOGPROSPECTJOB');
          ContactBufferPermanent.SETRANGE("Division Code",TempContactBuffer."Division Code");
          ContactBufferPermanent.SETRANGE("DefaultText 30_1",'20'+YearVar);  //it will add total contact line also
          ContactBufferPermanent.SETRANGE(DefaultText250_1,TempContactBuffer."User ID");
          IF ContactBufferPermanent.FINDFIRST THEN BEGIN
            IF MonthNo = 1 THEN
              ContactBufferPermanent.DefaultInteger_1 := TempContactBuffer.DefaultInteger_1
            ELSE IF MonthNo = 2 THEN
              ContactBufferPermanent.DefaultInteger_2 := TempContactBuffer.DefaultInteger_2
            ELSE IF MonthNo = 3 THEN
              ContactBufferPermanent.DefaultInteger_3 := TempContactBuffer.DefaultInteger_3
            ELSE IF MonthNo = 4 THEN
              ContactBufferPermanent.DefaultInteger_4 := TempContactBuffer.DefaultInteger_4
            ELSE IF MonthNo = 5 THEN
              ContactBufferPermanent.DefaultInteger_5 := TempContactBuffer.DefaultInteger_5
            ELSE IF MonthNo = 6 THEN
              ContactBufferPermanent.DefaultInteger_6 := TempContactBuffer.DefaultInteger_6
            ELSE IF MonthNo = 7 THEN
              ContactBufferPermanent.DefaultInteger_7 := TempContactBuffer.DefaultInteger_7
            ELSE IF MonthNo = 8 THEN
              ContactBufferPermanent.DefaultInteger_8 := TempContactBuffer.DefaultInteger_8
            ELSE IF MonthNo = 9 THEN
              ContactBufferPermanent.DefaultInteger_9 := TempContactBuffer.DefaultInteger_9
            ELSE IF MonthNo = 10 THEN
              ContactBufferPermanent.DefaultInteger_10 := TempContactBuffer.DefaultInteger_10
            ELSE IF MonthNo = 11 THEN
              ContactBufferPermanent.DefaultInteger_11 := TempContactBuffer.DefaultInteger_11
            ELSE IF MonthNo = 12 THEN
              ContactBufferPermanent.DefaultInteger_12 := TempContactBuffer.DefaultInteger_12;
            ContactBufferPermanent.Integer_1 := TempContactBuffer.Integer_1;
            ContactBufferPermanent."Default Boolean" := TempContactBuffer."Default Boolean";
            ContactBufferPermanent.MODIFY;
            NumVar := ContactBufferPermanent.DefaultInteger;
          END ELSE BEGIN
            ContactBufferPermanent.INIT;
            ContactBufferPermanent.Option := 'DUMPCONTACTLOGPROSPECTJOB';
            IF STRPOS(TempContactBuffer."User ID",'Total for') > 0 THEN
              NumVar := GetLineNoContactbyJob(TempContactBuffer."Division Code",TempContactBuffer.Integer_1,TRUE)
            ELSE
              NumVar := GetLineNoContactbyJob(TempContactBuffer."Division Code",TempContactBuffer.Integer_1,FALSE);
            ContactBufferPermanent."Option Choice" := FORMAT(NumVar);
            ContactBufferPermanent.DefaultInteger := NumVar;
            ContactBufferPermanent."DefaultText 30_1" := '20'+YearVar;
            ContactBufferPermanent.DefaultText250 := 'Total for Division ' + TempContactBuffer."Division Code";
            ContactBufferPermanent.DefaultText250_1 := TempContactBuffer."User ID";
            ContactBufferPermanent."Division Code" := TempContactBuffer."Division Code";
            ContactBufferPermanent.Integer_1 := TempContactBuffer.Integer_1;
            IF MonthNo = 1 THEN
              ContactBufferPermanent.DefaultInteger_1 := TempContactBuffer.DefaultInteger_1
            ELSE IF MonthNo = 2 THEN
              ContactBufferPermanent.DefaultInteger_2 := TempContactBuffer.DefaultInteger_2
            ELSE IF MonthNo = 3 THEN
              ContactBufferPermanent.DefaultInteger_3 := TempContactBuffer.DefaultInteger_3
            ELSE IF MonthNo = 4 THEN
              ContactBufferPermanent.DefaultInteger_4 := TempContactBuffer.DefaultInteger_4
            ELSE IF MonthNo = 5 THEN
              ContactBufferPermanent.DefaultInteger_5 := TempContactBuffer.DefaultInteger_5
            ELSE IF MonthNo = 6 THEN
              ContactBufferPermanent.DefaultInteger_6 := TempContactBuffer.DefaultInteger_6
            ELSE IF MonthNo = 7 THEN
              ContactBufferPermanent.DefaultInteger_7 := TempContactBuffer.DefaultInteger_7
            ELSE IF MonthNo = 8 THEN
              ContactBufferPermanent.DefaultInteger_8 := TempContactBuffer.DefaultInteger_8
            ELSE IF MonthNo = 9 THEN
              ContactBufferPermanent.DefaultInteger_9 := TempContactBuffer.DefaultInteger_9
            ELSE IF MonthNo = 10 THEN
              ContactBufferPermanent.DefaultInteger_10 := TempContactBuffer.DefaultInteger_10
            ELSE IF MonthNo = 11 THEN
              ContactBufferPermanent.DefaultInteger_11 := TempContactBuffer.DefaultInteger_11
            ELSE IF MonthNo = 12 THEN
              ContactBufferPermanent.DefaultInteger_12 := TempContactBuffer.DefaultInteger_12;
            ContactBufferPermanent."Default Boolean" := TempContactBuffer."Default Boolean";
            ContactBufferPermanent.INSERT;
            //NumVar += 10;
          END;
        UNTIL TempContactBuffer.NEXT = 0;
      ContactBufferPermanent.RESET;
      ContactBufferPermanent.SETRANGE(Option,'DUMPCONTACTLOGPROSPECTJOB');
      //ContactBufferPermanent.SETRANGE("Division Code",TempContactBuffer."Division Code");
      ContactBufferPermanent.SETRANGE(DefaultText250_1,'Total Prospects');  //it will add total contact line also
      ContactBufferPermanent.SETRANGE("DefaultText 30_1",'20'+YearVar);
      IF ContactBufferPermanent.FINDFIRST THEN BEGIN
        IF MonthNo = 1 THEN
          ContactBufferPermanent.DefaultInteger_1 := M1
        ELSE IF MonthNo = 2 THEN
          ContactBufferPermanent.DefaultInteger_2 := M2
        ELSE IF MonthNo = 3 THEN
          ContactBufferPermanent.DefaultInteger_3 := M3
        ELSE IF MonthNo = 4 THEN
          ContactBufferPermanent.DefaultInteger_4 := M4
        ELSE IF MonthNo = 5 THEN
          ContactBufferPermanent.DefaultInteger_5 := M5
        ELSE IF MonthNo = 6 THEN
          ContactBufferPermanent.DefaultInteger_6 := M6
        ELSE IF MonthNo = 7 THEN
          ContactBufferPermanent.DefaultInteger_7 := M7
        ELSE IF MonthNo = 8 THEN
          ContactBufferPermanent.DefaultInteger_8 := M8
        ELSE IF MonthNo = 9 THEN
          ContactBufferPermanent.DefaultInteger_9 := M9
        ELSE IF MonthNo = 10 THEN
          ContactBufferPermanent.DefaultInteger_10 := M10
        ELSE IF MonthNo = 11 THEN
          ContactBufferPermanent.DefaultInteger_11 := M11
        ELSE IF MonthNo = 12 THEN
          ContactBufferPermanent.DefaultInteger_12 := M12;
        ContactBufferPermanent.MODIFY;
      END ELSE BEGIN
        ContactBufferPermanent.INIT;
        ContactBufferPermanent.Option := 'DUMPCONTACTLOGPROSPECTJOB';
        ContactBufferPermanent."Option Choice" := FORMAT(NumVar + 100);
        ContactBufferPermanent.DefaultText250_1 := 'Total Prospects';
        ContactBufferPermanent."DefaultText 30_1" := '20'+YearVar;
        IF MonthNo = 1 THEN
          ContactBufferPermanent.DefaultInteger_1 := M1
        ELSE IF MonthNo = 2 THEN
          ContactBufferPermanent.DefaultInteger_2 := M2
        ELSE IF MonthNo = 3 THEN
          ContactBufferPermanent.DefaultInteger_3 := M3
        ELSE IF MonthNo = 4 THEN
          ContactBufferPermanent.DefaultInteger_4 := M4
        ELSE IF MonthNo = 5 THEN
          ContactBufferPermanent.DefaultInteger_5 := M5
        ELSE IF MonthNo = 6 THEN
          ContactBufferPermanent.DefaultInteger_6 := M6
        ELSE IF MonthNo = 7 THEN
          ContactBufferPermanent.DefaultInteger_7 := M7
        ELSE IF MonthNo = 8 THEN
          ContactBufferPermanent.DefaultInteger_8 := M8
        ELSE IF MonthNo = 9 THEN
          ContactBufferPermanent.DefaultInteger_9 := M9
        ELSE IF MonthNo = 10 THEN
          ContactBufferPermanent.DefaultInteger_10 := M10
        ELSE IF MonthNo = 11 THEN
          ContactBufferPermanent.DefaultInteger_11 := M11
        ELSE IF MonthNo = 12 THEN
          ContactBufferPermanent.DefaultInteger_12 := M12;
        ContactBufferPermanent.DefaultInteger := NumVar + 100;
        ContactBufferPermanent.INSERT;
      END;
    END;

    PROCEDURE Header@1000000021(GroupPara@1000000000 : Integer);
    VAR
      UptoMonth@1000000001 : Integer;
    BEGIN
      TempExcelBuffer.DELETEALL;
      RowNo := 1;
      ColumnNo := 1;
      IF GroupPara = 0 THEN
        UptoMonth := MonthNo + 1
      ELSE IF GroupPara = 1 THEN
        UptoMonth := MonthNo + 2;
      TempContactBuffer.RESET;
      TempContactBuffer.DELETEALL;

      IF GroupPara = 1 THEN BEGIN
        EnterCell(RowNo,ColumnNo,'Division',TRUE,TRUE,FALSE,'',1);
        ColumnNo += 1;
      END;
      IF GroupPara = 0 THEN BEGIN
        EnterCell(RowNo,ColumnNo,'Division',TRUE,TRUE,FALSE,'',1);
        ColumnNo += 1;
      END ELSE IF GroupPara = 1 THEN BEGIN
        EnterCell(RowNo,ColumnNo,'Job Responsibility',TRUE,TRUE,FALSE,'',1);
        ColumnNo += 1;
      END;
      IF ColumnNo <= UptoMonth THEN BEGIN
        EnterCell(RowNo,ColumnNo,'Total for Month '+ MonthTxt1,TRUE,TRUE,FALSE,'',1);
        ColumnNo += 1;
      END;
      IF ColumnNo <= UptoMonth THEN BEGIN
        EnterCell(RowNo,ColumnNo,'Total for Month '+ MonthTxt2,TRUE,TRUE,FALSE,'',1);
        ColumnNo += 1;
      END;
      IF ColumnNo <= UptoMonth THEN BEGIN
        EnterCell(RowNo,ColumnNo,'Total for Month '+ MonthTxt3,TRUE,TRUE,FALSE,'',1);
        ColumnNo += 1;
      END;
      IF ColumnNo <= UptoMonth THEN BEGIN
        EnterCell(RowNo,ColumnNo,'Total for Month '+ MonthTxt4,TRUE,TRUE,FALSE,'',1);
        ColumnNo += 1;
      END;
      IF ColumnNo <= UptoMonth THEN BEGIN
        EnterCell(RowNo,ColumnNo,'Total for Month '+ MonthTxt5,TRUE,TRUE,FALSE,'',1);
        ColumnNo += 1;
      END;
      IF ColumnNo <= UptoMonth THEN BEGIN
        EnterCell(RowNo,ColumnNo,'Total for Month '+ MonthTxt6,TRUE,TRUE,FALSE,'',1);
        ColumnNo += 1;
      END;
      IF ColumnNo <= UptoMonth THEN BEGIN
        EnterCell(RowNo,ColumnNo,'Total for Month '+ MonthTxt7,TRUE,TRUE,FALSE,'',1);
        ColumnNo += 1;
      END;
      IF ColumnNo <= UptoMonth THEN BEGIN
        EnterCell(RowNo,ColumnNo,'Total for Month '+ MonthTxt8,TRUE,TRUE,FALSE,'',1);
        ColumnNo += 1;
      END;
      IF ColumnNo <= UptoMonth THEN BEGIN
        EnterCell(RowNo,ColumnNo,'Total for Month '+ MonthTxt9,TRUE,TRUE,FALSE,'',1);
        ColumnNo += 1;
      END;
      IF ColumnNo <= UptoMonth THEN BEGIN
        EnterCell(RowNo,ColumnNo,'Total for Month '+ MonthTxt10,TRUE,TRUE,FALSE,'',1);
        ColumnNo += 1;
      END;
      IF ColumnNo <= UptoMonth THEN BEGIN
        EnterCell(RowNo,ColumnNo,'Total for Month '+ MonthTxt11,TRUE,TRUE,FALSE,'',1);
        ColumnNo += 1;
      END;
      IF ColumnNo <= UptoMonth THEN BEGIN
        EnterCell(RowNo,ColumnNo,'Total for Month '+ MonthTxt12,TRUE,TRUE,FALSE,'',1);
        ColumnNo += 1;
      END;
      // EnterCell(RowNo,ColumnNo,FORMAT(QuarterVar),TRUE,TRUE,FALSE,'',1);
      // ColumnNo += 1;
    END;

    LOCAL PROCEDURE LinesFun@1000000028(GroupPara@1000000001 : Integer;JobOptionPara@1000000003 : Text[50]);
    VAR
      BoldVar@1000000000 : Boolean;
      UptoMonth@1000000002 : Integer;
      ContactBufferRec@1000000004 : Record 50063;
    BEGIN
      RowNo := 2;
      IF GroupPara = 0 THEN
        UptoMonth := MonthNo + 1
      ELSE IF GroupPara = 1 THEN
        UptoMonth := MonthNo + 2;
      ContactBufferRec.RESET;
      ContactBufferRec.SETCURRENTKEY(DefaultInteger);
      ContactBufferRec.SETRANGE(Option,JobOptionPara);
      IF ContactBufferRec.FINDSET THEN
        REPEAT
          ColumnNo := 1;
          BoldVar := FALSE;
          IF STRPOS(ContactBufferRec.DefaultText250,'Total') > 0 THEN
            BoldVar := TRUE;
          IF GroupPara = 1 THEN BEGIN
            EnterCell(RowNo,ColumnNo,ContactBufferRec."Division Code",BoldVar,FALSE,FALSE,'',1);
            ColumnNo += 1;
          END;
          EnterCell(RowNo,ColumnNo,ContactBufferRec.DefaultText250,BoldVar,FALSE,FALSE,'',1);
          ColumnNo += 1;
          IF ColumnNo <= UptoMonth THEN BEGIN
            EnterCell(RowNo,ColumnNo,FORMAT(ContactBufferRec.DefaultInteger_1),BoldVar,FALSE,FALSE,'',0);
            ColumnNo += 1;
          END;
          IF ColumnNo <= UptoMonth THEN BEGIN
            EnterCell(RowNo,ColumnNo,FORMAT(ContactBufferRec.DefaultInteger_2),BoldVar,FALSE,FALSE,'',0);
            ColumnNo += 1;
          END;
          IF ColumnNo <= UptoMonth THEN BEGIN
            EnterCell(RowNo,ColumnNo,FORMAT(ContactBufferRec.DefaultInteger_3),BoldVar,FALSE,FALSE,'',0);
            ColumnNo += 1;
          END;
          IF ColumnNo <= UptoMonth THEN BEGIN
            EnterCell(RowNo,ColumnNo,FORMAT(ContactBufferRec.DefaultInteger_4),BoldVar,FALSE,FALSE,'',0);
            ColumnNo += 1;
          END;
          IF ColumnNo <= UptoMonth THEN BEGIN
            EnterCell(RowNo,ColumnNo,FORMAT(ContactBufferRec.DefaultInteger_5),BoldVar,FALSE,FALSE,'',0);
            ColumnNo += 1;
          END;
          IF ColumnNo <= UptoMonth THEN BEGIN
            EnterCell(RowNo,ColumnNo,FORMAT(ContactBufferRec.DefaultInteger_6),BoldVar,FALSE,FALSE,'',0);
            ColumnNo += 1;
          END;
          IF ColumnNo <= UptoMonth THEN BEGIN
            EnterCell(RowNo,ColumnNo,FORMAT(ContactBufferRec.DefaultInteger_7),BoldVar,FALSE,FALSE,'',0);
            ColumnNo += 1;
          END;
          IF ColumnNo <= UptoMonth THEN BEGIN
            EnterCell(RowNo,ColumnNo,FORMAT(ContactBufferRec.DefaultInteger_8),BoldVar,FALSE,FALSE,'',0);
            ColumnNo += 1;
          END;
          IF ColumnNo <= UptoMonth THEN BEGIN
            EnterCell(RowNo,ColumnNo,FORMAT(ContactBufferRec.DefaultInteger_9),BoldVar,FALSE,FALSE,'',0);
            ColumnNo += 1;
          END;
          IF ColumnNo <= UptoMonth THEN BEGIN
            EnterCell(RowNo,ColumnNo,FORMAT(ContactBufferRec.DefaultInteger_10),BoldVar,FALSE,FALSE,'',0);
            ColumnNo += 1;
          END;
          IF ColumnNo <= UptoMonth THEN BEGIN
            EnterCell(RowNo,ColumnNo,FORMAT(ContactBufferRec.DefaultInteger_11),BoldVar,FALSE,FALSE,'',0);
            ColumnNo += 1;
          END;
          IF ColumnNo <= UptoMonth THEN BEGIN
            EnterCell(RowNo,ColumnNo,FORMAT(ContactBufferRec.DefaultInteger_12),BoldVar,FALSE,FALSE,'',0);
            ColumnNo += 1;
          END;
          //EnterCell(RowNo,ColumnNo,FORMAT(ContactBufferRec.DefaultInteger_4),BoldVar,FALSE,FALSE,'',0);
          RowNo += 1;
        UNTIL ContactBufferRec.NEXT = 0;
    END;

    LOCAL PROCEDURE GetQuarter@1000000003() : Integer;
    BEGIN
      IF NOT automaticvar THEN BEGIN
        IF (DATE2DMY(CALCDATE('<-1D>',TODAY),2) > DATE2DMY(123121D,2)) AND (DATE2DMY(CALCDATE('<-1D>',TODAY),2) <= DATE2DMY(033121D,2)) THEN
          EXIT(0)
        ELSE IF (DATE2DMY(CALCDATE('<-1D>',TODAY),2) > DATE2DMY(033121D,2)) AND (DATE2DMY(CALCDATE('<-1D>',TODAY),2) <= DATE2DMY(063021D,2)) THEN
          EXIT(1)
        ELSE IF (DATE2DMY(CALCDATE('<-1D>',TODAY),2) > DATE2DMY(063021D,2)) AND (DATE2DMY(CALCDATE('<-1D>',TODAY),2) <= DATE2DMY(093021D,2)) THEN
          EXIT(2)
        ELSE IF (DATE2DMY(CALCDATE('<-1D>',TODAY),2) > DATE2DMY(093021D,2)) AND (DATE2DMY(CALCDATE('<-1D>',TODAY),2) <= DATE2DMY(123121D,2)) THEN
          EXIT(3);
      END ELSE BEGIN
        IF (DATE2DMY(TODAY,2) > DATE2DMY(123121D,2)) AND (DATE2DMY(TODAY,2) <= DATE2DMY(033121D,2)) THEN
          EXIT(0)
        ELSE IF (DATE2DMY(TODAY,2) > DATE2DMY(033121D,2)) AND (DATE2DMY(TODAY,2) <= DATE2DMY(063021D,2)) THEN
          EXIT(1)
        ELSE IF (DATE2DMY(TODAY,2) > DATE2DMY(063021D,2)) AND (DATE2DMY(TODAY,2) <= DATE2DMY(093021D,2)) THEN
          EXIT(2)
        ELSE IF (DATE2DMY(TODAY,2) > DATE2DMY(093021D,2)) AND (DATE2DMY(TODAY,2) <= DATE2DMY(123121D,2)) THEN
          EXIT(3);
      END;
    END;

    LOCAL PROCEDURE GetQuarterDateFilter@1000000000() : Text;
    BEGIN
      IF QuarterVar = 0 THEN
        EXIT('0101'+YearVar+'D..0331'+YearVar+'D')
      ELSE IF QuarterVar = 1 THEN
        EXIT('0401'+YearVar+'D..0630'+YearVar+'D')
      ELSE IF QuarterVar = 2 THEN
        EXIT('0701'+YearVar+'D..0930'+YearVar+'D')
      ELSE IF QuarterVar = 3 THEN
        EXIT('1001'+YearVar+'D..1231'+YearVar+'D')
    END;

    LOCAL PROCEDURE GetQuarterDate@1000000001(IdentVar@1000000000 : Integer) : Text;
    BEGIN
      IF IdentVar = 1 THEN BEGIN
        QMonth1 := '01';//'0101'+YearVar+'D';
        QMonth1Fil := '<=0131'+YearVar+'D';//'0101'+YearVar+'D..0131'+YearVar+'D';
        MonthTxt1 := 'January';
      END ELSE IF IdentVar = 2 THEN BEGIN
        QMonth1 := '01';//'0101'+YearVar+'D';
        QMonth1Fil := '<=0131'+YearVar+'D';//'0101'+YearVar+'D..0131'+YearVar+'D';
        MonthTxt1 := 'January';
        QMonth2 := '02';//01'+YearVar+'D';
        QMonth2Fil := '<=0228'+YearVar+'D';
        MonthTxt2 := 'February';
      END ELSE IF IdentVar = 3 THEN BEGIN
        QMonth1 := '01';//'0101'+YearVar+'D';
        QMonth1Fil := '<=0131'+YearVar+'D';
        MonthTxt1 := 'January';
        QMonth2 := '02';//01'+YearVar+'D';
        QMonth2Fil := '<=0228'+YearVar+'D';
        MonthTxt2 := 'February';
        QMonth3 := '03';//01'+YearVar+'D';
        QMonth3Fil := '<=0331'+YearVar+'D';
        MonthTxt3 := 'March';
      END ELSE IF IdentVar = 4 THEN BEGIN
        QMonth1 := '01';//'0101'+YearVar+'D';
        QMonth1Fil := '<=0131'+YearVar+'D';
        MonthTxt1 := 'January';
        QMonth2 := '02';//01'+YearVar+'D';
        QMonth2Fil := '<=0228'+YearVar+'D';
        MonthTxt2 := 'February';
        QMonth3 := '03';//01'+YearVar+'D';
        QMonth3Fil := '<=0331'+YearVar+'D';
        MonthTxt3 := 'March';
        QMonth4 := '04';//01'+YearVar+'D';
        QMonth4Fil := '<=0430'+YearVar+'D';
        MonthTxt4 := 'April';
      END ELSE IF IdentVar = 5 THEN BEGIN
        QMonth1 := '01';//'0101'+YearVar+'D';
        QMonth1Fil := '<=0131'+YearVar+'D';
        MonthTxt1 := 'January';
        QMonth2 := '02';//01'+YearVar+'D';
        QMonth2Fil := '<=0228'+YearVar+'D';
        MonthTxt2 := 'February';
        QMonth3 := '03';//01'+YearVar+'D';
        QMonth3Fil := '<=0331'+YearVar+'D';
        MonthTxt3 := 'March';
        QMonth4 := '04';//01'+YearVar+'D';
        QMonth4Fil := '<=0430'+YearVar+'D';
        MonthTxt4 := 'April';
        QMonth5 := '05';//01'+YearVar+'D';
        QMonth5Fil := '<=0531'+YearVar+'D';
        MonthTxt5 := 'May';
      END ELSE IF IdentVar = 6 THEN BEGIN
        QMonth1 := '01';//'0101'+YearVar+'D';
        QMonth1Fil := '<=0131'+YearVar+'D';
        MonthTxt1 := 'January';
        QMonth2 := '02';//01'+YearVar+'D';
        QMonth2Fil := '<=0228'+YearVar+'D';
        MonthTxt2 := 'February';
        QMonth3 := '03';//01'+YearVar+'D';
        QMonth3Fil := '<=0331'+YearVar+'D';
        MonthTxt3 := 'March';
        QMonth4 := '04';//01'+YearVar+'D';
        QMonth4Fil := '<=0430'+YearVar+'D';
        MonthTxt4 := 'April';
        QMonth5 := '05';//01'+YearVar+'D';
        QMonth5Fil := '<=0531'+YearVar+'D';
        MonthTxt5 := 'May';
        QMonth6 := '06';//01'+YearVar+'D';
        QMonth6Fil := '<=0630'+YearVar+'D';
        MonthTxt6 := 'June';
      END ELSE IF IdentVar = 7 THEN BEGIN
        QMonth1 := '01';//'0101'+YearVar+'D';
        QMonth1Fil := '<=0131'+YearVar+'D';
        MonthTxt1 := 'January';
        QMonth2 := '02';//01'+YearVar+'D';
        QMonth2Fil := '<=0228'+YearVar+'D';
        MonthTxt2 := 'February';
        QMonth3 := '03';//01'+YearVar+'D';
        QMonth3Fil := '<=0331'+YearVar+'D';
        MonthTxt3 := 'March';
        QMonth4 := '04';//01'+YearVar+'D';
        QMonth4Fil := '<=0430'+YearVar+'D';
        MonthTxt4 := 'April';
        QMonth5 := '05';//01'+YearVar+'D';
        QMonth5Fil := '<=0531'+YearVar+'D';
        MonthTxt5 := 'May';
        QMonth6 := '06';//01'+YearVar+'D';
        QMonth6Fil := '<=0630'+YearVar+'D';
        MonthTxt6 := 'June';
        QMonth7 := '07';//01'+YearVar+'D';
        QMonth7Fil := '<=0731'+YearVar+'D';
        MonthTxt7 := 'July';
      END ELSE IF IdentVar = 8 THEN BEGIN
        QMonth1 := '01';//'0101'+YearVar+'D';
        QMonth1Fil := '<=0131'+YearVar+'D';
        MonthTxt1 := 'January';
        QMonth2 := '02';//01'+YearVar+'D';
        QMonth2Fil := '<=0228'+YearVar+'D';
        MonthTxt2 := 'February';
        QMonth3 := '03';//01'+YearVar+'D';
        QMonth3Fil := '<=0331'+YearVar+'D';
        MonthTxt3 := 'March';
        QMonth4 := '04';//01'+YearVar+'D';
        QMonth4Fil := '<=0430'+YearVar+'D';
        MonthTxt4 := 'April';
        QMonth5 := '05';//01'+YearVar+'D';
        QMonth5Fil := '<=0531'+YearVar+'D';
        MonthTxt5 := 'May';
        QMonth6 := '06';//01'+YearVar+'D';
        QMonth6Fil := '<=0630'+YearVar+'D';
        MonthTxt6 := 'June';
        QMonth7 := '07';//01'+YearVar+'D';
        QMonth7Fil := '<=0731'+YearVar+'D';
        MonthTxt7 := 'July';
        QMonth8 := '08';//01'+YearVar+'D';
        QMonth8Fil := '<=0831'+YearVar+'D';
        MonthTxt8 := 'August';
      END ELSE IF IdentVar = 9 THEN BEGIN
        QMonth1 := '01';//'0101'+YearVar+'D';
        QMonth1Fil := '<=0131'+YearVar+'D';
        MonthTxt1 := 'January';
        QMonth2 := '02';//01'+YearVar+'D';
        QMonth2Fil := '<=0228'+YearVar+'D';
        MonthTxt2 := 'February';
        QMonth3 := '03';//01'+YearVar+'D';
        QMonth3Fil := '<=0331'+YearVar+'D';
        MonthTxt3 := 'March';
        QMonth4 := '04';//01'+YearVar+'D';
        QMonth4Fil := '<=0430'+YearVar+'D';
        MonthTxt4 := 'April';
        QMonth5 := '05';//01'+YearVar+'D';
        QMonth5Fil := '<=0531'+YearVar+'D';
        MonthTxt5 := 'May';
        QMonth6 := '06';//01'+YearVar+'D';
        QMonth6Fil := '<=0630'+YearVar+'D';
        MonthTxt6 := 'June';
        QMonth7 := '07';//01'+YearVar+'D';
        QMonth7Fil := '<=0731'+YearVar+'D';
        MonthTxt7 := 'July';
        QMonth8 := '08';//01'+YearVar+'D';
        QMonth8Fil := '<=0831'+YearVar+'D';
        MonthTxt8 := 'August';
        QMonth9 := '09';//01'+YearVar+'D';
        QMonth9Fil := '<=0930'+YearVar+'D';
        MonthTxt9 := 'Sepetember';
      END ELSE IF IdentVar = 10 THEN BEGIN
        QMonth1 := '01';//'0101'+YearVar+'D';
        QMonth1Fil := '<=0131'+YearVar+'D';
        MonthTxt1 := 'January';
        QMonth2 := '02';//01'+YearVar+'D';
        QMonth2Fil := '<=0228'+YearVar+'D';
        MonthTxt2 := 'February';
        QMonth3 := '03';//01'+YearVar+'D';
        QMonth3Fil := '<=0331'+YearVar+'D';
        MonthTxt3 := 'March';
        QMonth4 := '04';//01'+YearVar+'D';
        QMonth4Fil := '<=0430'+YearVar+'D';
        MonthTxt4 := 'April';
        QMonth5 := '05';//01'+YearVar+'D';
        QMonth5Fil := '<=0531'+YearVar+'D';
        MonthTxt5 := 'May';
        QMonth6 := '06';//01'+YearVar+'D';
        QMonth6Fil := '<=0630'+YearVar+'D';
        MonthTxt6 := 'June';
        QMonth7 := '07';//01'+YearVar+'D';
        QMonth7Fil := '<=0731'+YearVar+'D';
        MonthTxt7 := 'July';
        QMonth8 := '08';//01'+YearVar+'D';
        QMonth8Fil := '<=0831'+YearVar+'D';
        MonthTxt8 := 'August';
        QMonth9 := '09';//01'+YearVar+'D';
        QMonth9Fil := '<=0930'+YearVar+'D';
        MonthTxt9 := 'Sepetember';
        QMonth10 := '10';//01'+YearVar+'D';
        QMonth10Fil := '<=1031'+YearVar+'D';
        MonthTxt10 := 'October';
      END ELSE IF(QuarterVar = 3) AND (IdentVar = 2) THEN BEGIN
        QMonth1 := '01';//'0101'+YearVar+'D';
        QMonth1Fil := '<=0131'+YearVar+'D';
        MonthTxt1 := 'January';
        QMonth2 := '02';//01'+YearVar+'D';
        QMonth2Fil := '<=0228'+YearVar+'D';
        MonthTxt2 := 'February';
        QMonth3 := '03';//01'+YearVar+'D';
        QMonth3Fil := '<=0331'+YearVar+'D';
        MonthTxt3 := 'March';
        QMonth4 := '04';//01'+YearVar+'D';
        QMonth4Fil := '<=0430'+YearVar+'D';
        MonthTxt4 := 'April';
        QMonth5 := '05';//01'+YearVar+'D';
        QMonth5Fil := '<=0531'+YearVar+'D';
        MonthTxt5 := 'May';
        QMonth6 := '06';//01'+YearVar+'D';
        QMonth6Fil := '<=0630'+YearVar+'D';
        MonthTxt6 := 'June';
        QMonth7 := '07';//01'+YearVar+'D';
        QMonth7Fil := '<=0731'+YearVar+'D';
        MonthTxt7 := 'July';
        QMonth8 := '08';//01'+YearVar+'D';
        QMonth8Fil := '<=0831'+YearVar+'D';
        MonthTxt8 := 'August';
        QMonth9 := '09';//01'+YearVar+'D';
        QMonth9Fil := '<=0930'+YearVar+'D';
        MonthTxt9 := 'Sepetember';
        QMonth10 := '10';//01'+YearVar+'D';
        QMonth10Fil := '<=1031'+YearVar+'D';
        MonthTxt10 := 'October';
        QMonth11 := '11';//01'+YearVar+'D';
        QMonth11Fil := '<=1130'+YearVar+'D';
        MonthTxt11 := 'November';
      END ELSE IF(QuarterVar = 3) AND (IdentVar = 3) THEN BEGIN
        QMonth1 := '01';//'0101'+YearVar+'D';
        QMonth1Fil := '<=0131'+YearVar+'D';
        MonthTxt1 := 'January';
        QMonth2 := '02';//01'+YearVar+'D';
        QMonth2Fil := '<=0228'+YearVar+'D';
        MonthTxt2 := 'February';
        QMonth3 := '03';//01'+YearVar+'D';
        QMonth3Fil := '<=0331'+YearVar+'D';
        MonthTxt3 := 'March';
        QMonth4 := '04';//01'+YearVar+'D';
        QMonth4Fil := '<=0430'+YearVar+'D';
        MonthTxt4 := 'April';
        QMonth5 := '05';//01'+YearVar+'D';
        QMonth5Fil := '<=0531'+YearVar+'D';
        MonthTxt5 := 'May';
        QMonth6 := '06';//01'+YearVar+'D';
        QMonth6Fil := '<=0630'+YearVar+'D';
        MonthTxt6 := 'June';
        QMonth7 := '07';//01'+YearVar+'D';
        QMonth7Fil := '<=0731'+YearVar+'D';
        MonthTxt7 := 'July';
        QMonth8 := '08';//01'+YearVar+'D';
        QMonth8Fil := '<=0831'+YearVar+'D';
        MonthTxt8 := 'August';
        QMonth9 := '09';//01'+YearVar+'D';
        QMonth9Fil := '<=0930'+YearVar+'D';
        MonthTxt9 := 'Sepetember';
        QMonth10 := '10';//01'+YearVar+'D';
        QMonth10Fil := '<=1031'+YearVar+'D';
        MonthTxt10 := 'October';
        QMonth11 := '11';//01'+YearVar+'D';
        QMonth11Fil := '<=1130'+YearVar+'D';
        MonthTxt11 := 'November';
        QMonth12 := '12';//01'+YearVar+'D';
        QMonth12Fil := '<=1231'+YearVar+'D';
        MonthTxt12 := 'December';
      END;
    END;

    LOCAL PROCEDURE ExporttoExcelCreateBook@1000000006(SheetNamePara@1000000000 : Text[250]);
    VAR
      TopazSetupLoc@1000000001 : Record 50056;
    BEGIN
      IF TopazSetupLoc.GET('CONTACTMANAGEMENTSETUP','') THEN;
      IF NOT automaticvar THEN BEGIN
        IF FILE.EXISTS(TopazSetupLoc.DefaultText250) THEN BEGIN
          FILE.COPY(TopazSetupLoc.DefaultText250,'\\nyvsvnavnsttst4\Contact Management\Archive\Contacts'+
          DELCHR(FORMAT(DT2DATE(CURRENTDATETIME),0,'<Year,2>-<Month,2>-<Day,2>') + '-'+FORMAT(TIME,0,'<hours24,2><Filler Character,0>-<minutes,2>'),'=',':.\/')+'.xlsx');
          FILE.ERASE(TopazSetupLoc.DefaultText250);
        END;
        TempExcelBuffer.CreateBook(TopazSetupLoc.DefaultText250,SheetNamePara);
      END ELSE
        TempExcelBuffer.CreateBook('',SheetNamePara);
      TempExcelBuffer.WriteSheet('',COMPANYNAME,USERID);
    END;

    LOCAL PROCEDURE ExporttoExcelWriteSheet@1000000002(SheetNamePara@1000000000 : Text[250]);
    BEGIN
      TempExcelBuffer.AddSheet(SheetNamePara);
      TempExcelBuffer.WriteSheet('','','');
    END;

    LOCAL PROCEDURE ExporttoExcelWriteSheetandClose@1000000007(SheetNamePara@1000000000 : Text[250]);
    BEGIN
      TempExcelBuffer.AddSheet(SheetNamePara);
      TempExcelBuffer.WriteSheet('','','');
      TempExcelBuffer.CloseBook;
      TempExcelBuffer.OpenExcel;
      TempExcelBuffer.GiveUserControl;
    END;

    LOCAL PROCEDURE ExporttoExcel@1000000013();
    BEGIN
      TempExcelBuffer.CreateBook('','Details');
      TempExcelBuffer.WriteSheet('',COMPANYNAME,USERID);
      TempExcelBuffer.CloseBook;
      TempExcelBuffer.OpenExcel;
      TempExcelBuffer.GiveUserControl;
    END;

    LOCAL PROCEDURE EnterCell@2(RowNo@1000 : Integer;ColumnNo@1001 : Integer;CellValue@1002 : Text[250];Bold@1003 : Boolean;Italic@1000000000 : Boolean;UnderLine@1000000001 : Boolean;Format@1006 : Text[30];CellType@1007 : Option);
    BEGIN
      TempExcelBuffer.INIT;
      TempExcelBuffer.VALIDATE("Row No.",RowNo);
      TempExcelBuffer.VALIDATE("Column No.",ColumnNo);
      TempExcelBuffer."Cell Value as Text" := CellValue;
      TempExcelBuffer.Formula := '';
      TempExcelBuffer.Bold := Bold;
      TempExcelBuffer.Italic := Italic;
      TempExcelBuffer.Underline := UnderLine;
      TempExcelBuffer.NumberFormat := Format;
      TempExcelBuffer."Cell Type" := CellType;//Number,Text,Date,Time
      TempExcelBuffer.INSERT;
    END;

    PROCEDURE Setfilterfun@1000000008(DatePara@1000000000 : Date);
    BEGIN
      YearVarFilter := FORMAT(DATE2DMY(DatePara,3));
      YearVar := COPYSTR(YearVarFilter,3,2);
      DateVar := CALCDATE('<-1D>',TODAY);
      QuarterVar := GetQuarter;
      //SplitinSheets := TRUE;
    END;

    LOCAL PROCEDURE PreviousQuarterProspects@1170000001();
    BEGIN
    END;

    LOCAL PROCEDURE ContactAddedData@1000000009(MonthIdenPara@1000000000 : Integer);
    VAR
      ContactJobResponsibility@1000000001 : Record 5067;
      ContactBufferRec@1000000002 : Record 50063;
      PKS@1000000003 : Integer;
    BEGIN
      IF MonthNo < MonthIdenPara THEN EXIT;
      Contact.RESET;
      IF MonthIdenPara = 1 THEN
        Contact.SETFILTER("Date Created",QMonth1Fil)
      ELSE IF MonthIdenPara = 2 THEN
        Contact.SETFILTER("Date Created",QMonth2Fil)
      ELSE IF MonthIdenPara = 3 THEN
        Contact.SETFILTER("Date Created",QMonth3Fil)
      ELSE IF MonthIdenPara = 4 THEN
        Contact.SETFILTER("Date Created",QMonth4Fil)
      ELSE IF MonthIdenPara = 5 THEN
        Contact.SETFILTER("Date Created",QMonth5Fil)
      ELSE IF MonthIdenPara = 6 THEN
        Contact.SETFILTER("Date Created",QMonth6Fil)
      ELSE IF MonthIdenPara = 7 THEN
        Contact.SETFILTER("Date Created",QMonth7Fil)
      ELSE IF MonthIdenPara = 8 THEN
        Contact.SETFILTER("Date Created",QMonth8Fil)
      ELSE IF MonthIdenPara = 9 THEN
        Contact.SETFILTER("Date Created",QMonth9Fil)
      ELSE IF MonthIdenPara = 10 THEN
        Contact.SETFILTER("Date Created",QMonth10Fil)
      ELSE IF MonthIdenPara = 11 THEN
        Contact.SETFILTER("Date Created",QMonth11Fil)
      ELSE IF MonthIdenPara = 12 THEN
        Contact.SETFILTER("Date Created",QMonth12Fil);
      Contact.SETFILTER("Company No.",'<>%1','');
      Contact.SETRANGE(Type,Contact.Type::Person);
      //Contact.SETFILTER("Shortcut Dimension 5 Code",'<>%1','');
      Contact.SETAUTOCALCFIELDS("Blocked Customer");
      Contact.SETFILTER("Blocked Customer",'<>%1',Contact."Blocked Customer"::All);
      IF Contact.FINDFIRST THEN
        REPEAT
          //IF Contact."No." = 'CT1030917' THEN
           // PKS := 1;
          ContactJobResponsibility.RESET;
          ContactJobResponsibility.SETRANGE("Contact No.",Contact."No.");
          IF ContactJobResponsibility.FINDFIRST THEN BEGIN
            //IF NOT ProspectJob(ContactJobResponsibility."Job Responsibility Code") THEN BEGIN
              TempContactBuffer.RESET;
              TempContactBuffer.SETRANGE(Option,'CONTACTMANAGEMENT');
              //TempContactBuffer.SETRANGE("User ID",Contact."Created By");
              TempContactBuffer.SETRANGE("DefaultCode 20",'CMBYPERSON');
              TempContactBuffer.SETRANGE("Division Code",Contact."Shortcut Dimension 5 Code");
              IF NOT TempContactBuffer.FINDFIRST THEN BEGIN
                NumVar += 2;
                TempContactBuffer.INIT;
                TempContactBuffer.Option := 'CONTACTMANAGEMENT';
                TempContactBuffer."Option Choice" := FORMAT(NumVar);
                TempContactBuffer."DefaultCode 20" := 'CMBYPERSON';
                //TempContactBuffer."User ID" := Contact."Created By";
                TempContactBuffer."Division Code" := Contact."Shortcut Dimension 5 Code"; //Division Code
                TempContactBuffer.DefaultInteger := NumVar;
                TempContactBuffer.DefaultText250 := 'Customer Contact';
                IF MonthIdenPara = 1 THEN BEGIN
                  TempContactBuffer.DefaultInteger_1 := 1;
                  M1 += 1;
                END ELSE IF MonthIdenPara = 2 THEN BEGIN
                  TempContactBuffer.DefaultInteger_2 := 1;
                  M2 += 1;
                END ELSE IF MonthIdenPara = 3 THEN BEGIN
                  TempContactBuffer.DefaultInteger_3 := 1;
                  M3 += 1;
                END ELSE IF MonthIdenPara = 4 THEN BEGIN
                  TempContactBuffer.DefaultInteger_4 := 1;
                  M4 += 1;
                END ELSE IF MonthIdenPara = 5 THEN BEGIN
                  TempContactBuffer.DefaultInteger_5 := 1;
                  M5 += 1;
                END ELSE IF MonthIdenPara = 6 THEN BEGIN
                  TempContactBuffer.DefaultInteger_6 := 1;
                  M6 += 1;
                END ELSE IF MonthIdenPara = 7 THEN BEGIN
                  TempContactBuffer.DefaultInteger_7 := 1;
                  M7 += 1;
                END ELSE IF MonthIdenPara = 8 THEN BEGIN
                  TempContactBuffer.DefaultInteger_8 := 1;
                  M8 += 1;
                END ELSE IF MonthIdenPara = 9 THEN BEGIN
                  TempContactBuffer.DefaultInteger_9 := 1;
                  M9 += 1;
                END ELSE IF MonthIdenPara = 10 THEN BEGIN
                  TempContactBuffer.DefaultInteger_10 := 1;
                  M10 += 1;
                END ELSE IF MonthIdenPara = 11 THEN BEGIN
                  TempContactBuffer.DefaultInteger_11 := 1;
                  M11 += 1;
                END ELSE IF MonthIdenPara = 12 THEN BEGIN
                  TempContactBuffer.DefaultInteger_12 := 1;
                  M12 += 1;
                END;
                TempContactBuffer.INSERT;
              END ELSE BEGIN
                IF MonthIdenPara = 1 THEN BEGIN
                  TempContactBuffer.DefaultInteger_1 += 1;
                  M1 += 1;
                END ELSE IF MonthIdenPara = 2 THEN BEGIN
                  TempContactBuffer.DefaultInteger_2 += 1;
                  M2 += 1;
                END ELSE IF MonthIdenPara = 3 THEN BEGIN
                  TempContactBuffer.DefaultInteger_3 += 1;
                  M3 += 1;
                END ELSE IF MonthIdenPara = 4 THEN BEGIN
                  TempContactBuffer.DefaultInteger_4 += 1;
                  M4 += 1;
                END ELSE IF MonthIdenPara = 5 THEN BEGIN
                  TempContactBuffer.DefaultInteger_5 += 1;
                  M5 += 1;
                END ELSE IF MonthIdenPara = 6 THEN BEGIN
                  TempContactBuffer.DefaultInteger_6 += 1;
                  M6 += 1;
                END ELSE IF MonthIdenPara = 7 THEN BEGIN
                  TempContactBuffer.DefaultInteger_7 += 1;
                  M7 += 1;
                END ELSE IF MonthIdenPara = 8 THEN BEGIN
                  TempContactBuffer.DefaultInteger_8 += 1;
                  M8 += 1;
                END ELSE IF MonthIdenPara = 9 THEN BEGIN
                  TempContactBuffer.DefaultInteger_9 += 1;
                  M9 += 1;
                END ELSE IF MonthIdenPara = 10 THEN BEGIN
                  TempContactBuffer.DefaultInteger_10 += 1;
                  M10 += 1;
                END ELSE IF MonthIdenPara = 11 THEN BEGIN
                  TempContactBuffer.DefaultInteger_11 += 1;
                  M11 += 1;
                END ELSE IF MonthIdenPara = 12 THEN BEGIN
                  TempContactBuffer.DefaultInteger_12 += 1;
                  M12 += 1;
                END;
                TempContactBuffer.MODIFY;
              END;
            //END;
          END;
        UNTIL Contact.NEXT =0;

    END;

    LOCAL PROCEDURE ContactAddedDatabyJob@1000000035(MonthIdenPara@1000000000 : Integer);
    VAR
      ContactJobResponsibility@1000000010 : Record 5067;
    BEGIN
      IF MonthNo < MonthIdenPara THEN EXIT;
      Contact.RESET;
      IF MonthIdenPara = 1 THEN
        Contact.SETFILTER("Date Created",QMonth1Fil)
      ELSE IF MonthIdenPara = 2 THEN
        Contact.SETFILTER("Date Created",QMonth2Fil)
      ELSE IF MonthIdenPara = 3 THEN
        Contact.SETFILTER("Date Created",QMonth3Fil)
      ELSE IF MonthIdenPara = 4 THEN
        Contact.SETFILTER("Date Created",QMonth4Fil)
      ELSE IF MonthIdenPara = 5 THEN
        Contact.SETFILTER("Date Created",QMonth5Fil)
      ELSE IF MonthIdenPara = 6 THEN
        Contact.SETFILTER("Date Created",QMonth6Fil)
      ELSE IF MonthIdenPara = 7 THEN
        Contact.SETFILTER("Date Created",QMonth7Fil)
      ELSE IF MonthIdenPara = 8 THEN
        Contact.SETFILTER("Date Created",QMonth8Fil)
      ELSE IF MonthIdenPara = 9 THEN
        Contact.SETFILTER("Date Created",QMonth9Fil)
      ELSE IF MonthIdenPara = 10 THEN
        Contact.SETFILTER("Date Created",QMonth10Fil)
      ELSE IF MonthIdenPara = 11 THEN
        Contact.SETFILTER("Date Created",QMonth11Fil)
      ELSE IF MonthIdenPara = 12 THEN
        Contact.SETFILTER("Date Created",QMonth12Fil);
      Contact.SETFILTER("Company No.",'<>%1','');
      Contact.SETRANGE(Type,Contact.Type::Person);
      //Contact.SETFILTER("Shortcut Dimension 5 Code",'<>%1','');
      Contact.SETAUTOCALCFIELDS("Blocked Customer");
      Contact.SETFILTER("Blocked Customer",'<>%1',Contact."Blocked Customer"::All);
      IF Contact.FINDSET THEN BEGIN
        REPEAT
            ContactJobResponsibility.RESET;
            ContactJobResponsibility.SETRANGE("Contact No.",Contact."No.");
            IF ContactJobResponsibility.FINDFIRST THEN BEGIN
              //IF NOT ProspectJob(ContactJobResponsibility."Job Responsibility Code") THEN BEGIN
                ContactJobResponsibility.CALCFIELDS("Job Responsibility Description");
                TempContactBuffer.RESET;
                TempContactBuffer.SETRANGE(Option,'CONTACTMANAGEMENT');
                IF ContactJobResponsibility."Job Responsibility Code" <> '' THEN
                  TempContactBuffer.SETRANGE("User ID",COPYSTR(ContactJobResponsibility."Job Responsibility Code"+' - '+ContactJobResponsibility."Job Responsibility Description",1,50))
                ELSE
                  TempContactBuffer.SETRANGE("User ID",ContactJobResponsibility."Job Responsibility Code");
                TempContactBuffer.SETRANGE("DefaultCode 20",'PCMBYPERSON');
                TempContactBuffer.SETRANGE("Division Code" , Contact."Shortcut Dimension 5 Code");
                IF NOT TempContactBuffer.FINDFIRST THEN BEGIN
                  NumVar += 1;
                  TempContactBuffer.INIT;
                  TempContactBuffer.Option := 'CONTACTMANAGEMENT';
                  TempContactBuffer."Option Choice" := FORMAT(NumVar);
                  TempContactBuffer."DefaultCode 20" := 'PCMBYPERSON';
                  IF ContactJobResponsibility."Job Responsibility Code" <> '' THEN BEGIN
                    TempContactBuffer."User ID" := COPYSTR(ContactJobResponsibility."Job Responsibility Code"+' - '+ContactJobResponsibility."Job Responsibility Description",1,50);
                    EVALUATE(TempContactBuffer.Integer_1,ContactJobResponsibility."Job Responsibility Code");
                  END ELSE
                    TempContactBuffer."User ID" := ContactJobResponsibility."Job Responsibility Code";
                  TempContactBuffer."Division Code" := Contact."Shortcut Dimension 5 Code";
                  TempContactBuffer.DefaultInteger := NumVar;
                  TempContactBuffer.DefaultText250 := 'Contact by Job Responsibility';
                  IF MonthIdenPara = 1 THEN BEGIN
                    TempContactBuffer.DefaultInteger_1 := 1;
                    M1 += 1;
                  END ELSE IF MonthIdenPara = 2 THEN BEGIN
                    TempContactBuffer.DefaultInteger_2 := 1;
                    M2 += 1;
                  END ELSE IF MonthIdenPara = 3 THEN BEGIN
                    TempContactBuffer.DefaultInteger_3 := 1;
                    M3 += 1;
                  END ELSE IF MonthIdenPara = 4 THEN BEGIN
                    TempContactBuffer.DefaultInteger_4 := 1;
                    M4 += 1;
                  END ELSE IF MonthIdenPara = 5 THEN BEGIN
                    TempContactBuffer.DefaultInteger_5 := 1;
                    M5 += 1;
                  END ELSE IF MonthIdenPara = 6 THEN BEGIN
                    TempContactBuffer.DefaultInteger_6 := 1;
                    M6 += 1;
                  END ELSE IF MonthIdenPara = 7 THEN BEGIN
                    TempContactBuffer.DefaultInteger_7 := 1;
                    M7 += 1;
                  END ELSE IF MonthIdenPara = 8 THEN BEGIN
                    TempContactBuffer.DefaultInteger_8 := 1;
                    M8 += 1;
                  END ELSE IF MonthIdenPara = 9 THEN BEGIN
                    TempContactBuffer.DefaultInteger_9 := 1;
                    M9 += 1;
                  END ELSE IF MonthIdenPara = 10 THEN BEGIN
                    TempContactBuffer.DefaultInteger_10 := 1;
                    M10 += 1;
                  END ELSE IF MonthIdenPara = 11 THEN BEGIN
                    TempContactBuffer.DefaultInteger_11 := 1;
                    M11 += 1;
                  END ELSE IF MonthIdenPara = 12 THEN BEGIN
                    TempContactBuffer.DefaultInteger_12 := 1;
                    M12 += 1;
                  END;
                  TempContactBuffer.INSERT;
                END ELSE BEGIN
                  IF MonthIdenPara = 1 THEN BEGIN
                    TempContactBuffer.DefaultInteger_1 += 1;
                    //TempContactBuffer.DefaultInteger_4 += TempContactBuffer.DefaultInteger_1 + TempContactBuffer.DefaultInteger_2 + TempContactBuffer.DefaultInteger_3;
                    M1 += 1;
                  END ELSE IF MonthIdenPara = 2 THEN BEGIN
                    TempContactBuffer.DefaultInteger_2 += 1;
                    M2 += 1;
                  END ELSE IF MonthIdenPara = 3 THEN BEGIN
                    TempContactBuffer.DefaultInteger_3 += 1;
                    M3 += 1;
                  END ELSE IF MonthIdenPara = 4 THEN BEGIN
                    TempContactBuffer.DefaultInteger_4 += 1;
                    M4 += 1;
                  END ELSE IF MonthIdenPara = 5 THEN BEGIN
                    TempContactBuffer.DefaultInteger_5 += 1;
                    M5 += 1;
                  END ELSE IF MonthIdenPara = 6 THEN BEGIN
                    TempContactBuffer.DefaultInteger_6 += 1;
                    M6 += 1;
                  END ELSE IF MonthIdenPara = 7 THEN BEGIN
                    TempContactBuffer.DefaultInteger_7 += 1;
                    M7 += 1;
                  END ELSE IF MonthIdenPara = 8 THEN BEGIN
                    TempContactBuffer.DefaultInteger_8 += 1;
                    M8 += 1;
                  END ELSE IF MonthIdenPara = 9 THEN BEGIN
                    TempContactBuffer.DefaultInteger_9 += 1;
                    M9 += 1;
                  END ELSE IF MonthIdenPara = 10 THEN BEGIN
                    TempContactBuffer.DefaultInteger_10 += 1;
                    M10 += 1;
                  END ELSE IF MonthIdenPara = 11 THEN BEGIN
                    TempContactBuffer.DefaultInteger_11 += 1;
                    M11 += 1;
                  END ELSE IF MonthIdenPara = 12 THEN BEGIN
                    TempContactBuffer.DefaultInteger_12 += 1;
                    M12 += 1;
                  END;
                  TempContactBuffer.MODIFY;
                END;
              //END;
            END;
        UNTIL Contact.NEXT =0;
      END;
    END;

    LOCAL PROCEDURE ContactAddedDataPros@1000000032(MonthIdenPara@1000000000 : Integer);
    VAR
      ContactJobResponsibility@1000000001 : Record 5067;
    BEGIN
      IF MonthNo < MonthIdenPara THEN EXIT;
      Contact.RESET;
      IF MonthIdenPara = 1 THEN
        Contact.SETFILTER("Date Created",QMonth1Fil)
      ELSE IF MonthIdenPara = 2 THEN
        Contact.SETFILTER("Date Created",QMonth2Fil)
      ELSE IF MonthIdenPara = 3 THEN
        Contact.SETFILTER("Date Created",QMonth3Fil)
      ELSE IF MonthIdenPara = 4 THEN
        Contact.SETFILTER("Date Created",QMonth4Fil)
      ELSE IF MonthIdenPara = 5 THEN
        Contact.SETFILTER("Date Created",QMonth5Fil)
      ELSE IF MonthIdenPara = 6 THEN
        Contact.SETFILTER("Date Created",QMonth6Fil)
      ELSE IF MonthIdenPara = 7 THEN
        Contact.SETFILTER("Date Created",QMonth7Fil)
      ELSE IF MonthIdenPara = 8 THEN
        Contact.SETFILTER("Date Created",QMonth8Fil)
      ELSE IF MonthIdenPara = 9 THEN
        Contact.SETFILTER("Date Created",QMonth9Fil)
      ELSE IF MonthIdenPara = 10 THEN
        Contact.SETFILTER("Date Created",QMonth10Fil)
      ELSE IF MonthIdenPara = 11 THEN
        Contact.SETFILTER("Date Created",QMonth11Fil)
      ELSE IF MonthIdenPara = 12 THEN
        Contact.SETFILTER("Date Created",QMonth12Fil);
      Contact.SETRANGE(Type,Contact.Type::Person);
      //Contact.SETFILTER("Shortcut Dimension 5 Code",'<>%1','');
      Contact.SETAUTOCALCFIELDS("Blocked Customer");
      Contact.SETFILTER("Blocked Customer",'<>%1',Contact."Blocked Customer"::All);
      IF Contact.FINDFIRST THEN
        REPEAT
          IF (Contact."Company No." = '')  THEN BEGIN//OR (Contact."Prospect Converted By" <> '')
            ContactJobResponsibility.RESET;
            ContactJobResponsibility.SETRANGE("Contact No.",Contact."No.");
            IF ContactJobResponsibility.FINDFIRST THEN BEGIN
                TempContactBuffer.RESET;
                TempContactBuffer.SETRANGE(Option,'CONTACTMANAGEMENT');
                //TempContactBuffer.SETRANGE("User ID",Contact."Created By");
                TempContactBuffer.SETRANGE("DefaultCode 20",'CMBYPERSON');
                TempContactBuffer.SETRANGE("Division Code",Contact."Shortcut Dimension 5 Code");
                IF NOT TempContactBuffer.FINDFIRST THEN BEGIN
                  NumVar += 2;
                  TempContactBuffer.INIT;
                  TempContactBuffer.Option := 'CONTACTMANAGEMENT';
                  TempContactBuffer."Option Choice" := FORMAT(NumVar);
                  TempContactBuffer."DefaultCode 20" := 'CMBYPERSON';
                  //TempContactBuffer."User ID" := Contact."Created By";
                  TempContactBuffer."Division Code" := Contact."Shortcut Dimension 5 Code"; //Division Code
                  TempContactBuffer.DefaultInteger := NumVar;
                  TempContactBuffer.DefaultText250 := 'Customer Contact';
                  IF MonthIdenPara = 1 THEN BEGIN
                    TempContactBuffer.DefaultInteger_1 := 1;
                    M1 += 1;
                  END ELSE IF MonthIdenPara = 2 THEN BEGIN
                    TempContactBuffer.DefaultInteger_2 := 1;
                    M2 += 1;
                  END ELSE IF MonthIdenPara = 3 THEN BEGIN
                    TempContactBuffer.DefaultInteger_3 := 1;
                    M3 += 1;
                  END ELSE IF MonthIdenPara = 4 THEN BEGIN
                    TempContactBuffer.DefaultInteger_4 := 1;
                    M4 += 1;
                  END ELSE IF MonthIdenPara = 5 THEN BEGIN
                    TempContactBuffer.DefaultInteger_5 := 1;
                    M5 += 1;
                  END ELSE IF MonthIdenPara = 6 THEN BEGIN
                    TempContactBuffer.DefaultInteger_6 := 1;
                    M6 += 1;
                  END ELSE IF MonthIdenPara = 7 THEN BEGIN
                    TempContactBuffer.DefaultInteger_7 := 1;
                    M7 += 1;
                  END ELSE IF MonthIdenPara = 8 THEN BEGIN
                    TempContactBuffer.DefaultInteger_8 := 1;
                    M8 += 1;
                  END ELSE IF MonthIdenPara = 9 THEN BEGIN
                    TempContactBuffer.DefaultInteger_9 := 1;
                    M9 += 1;
                  END ELSE IF MonthIdenPara = 10 THEN BEGIN
                    TempContactBuffer.DefaultInteger_10 := 1;
                    M10 += 1;
                  END ELSE IF MonthIdenPara = 11 THEN BEGIN
                    TempContactBuffer.DefaultInteger_11 := 1;
                    M11 += 1;
                  END ELSE IF MonthIdenPara = 12 THEN BEGIN
                    TempContactBuffer.DefaultInteger_12 := 1;
                    M12 += 1;
                  END;
                  TempContactBuffer.INSERT;
                END ELSE BEGIN
                  IF MonthIdenPara = 1 THEN BEGIN
                    TempContactBuffer.DefaultInteger_1 += 1;
                    M1 += 1;
                  END ELSE IF MonthIdenPara = 2 THEN BEGIN
                    TempContactBuffer.DefaultInteger_2 += 1;
                    M2 += 1;
                  END ELSE IF MonthIdenPara = 3 THEN BEGIN
                    TempContactBuffer.DefaultInteger_3 += 1;
                    M3 += 1;
                  END ELSE IF MonthIdenPara = 4 THEN BEGIN
                    TempContactBuffer.DefaultInteger_4 += 1;
                    M4 += 1;
                  END ELSE IF MonthIdenPara = 5 THEN BEGIN
                    TempContactBuffer.DefaultInteger_5 += 1;
                    M5 += 1;
                  END ELSE IF MonthIdenPara = 6 THEN BEGIN
                    TempContactBuffer.DefaultInteger_6 += 1;
                    M6 += 1;
                  END ELSE IF MonthIdenPara = 7 THEN BEGIN
                    TempContactBuffer.DefaultInteger_7 += 1;
                    M7 += 1;
                  END ELSE IF MonthIdenPara = 8 THEN BEGIN
                    TempContactBuffer.DefaultInteger_8 += 1;
                    M8 += 1;
                  END ELSE IF MonthIdenPara = 9 THEN BEGIN
                    TempContactBuffer.DefaultInteger_9 += 1;
                    M9 += 1;
                  END ELSE IF MonthIdenPara = 10 THEN BEGIN
                    TempContactBuffer.DefaultInteger_10 += 1;
                    M10 += 1;
                  END ELSE IF MonthIdenPara = 11 THEN BEGIN
                    TempContactBuffer.DefaultInteger_11 += 1;
                    M11 += 1;
                  END ELSE IF MonthIdenPara = 12 THEN BEGIN
                    TempContactBuffer.DefaultInteger_12 += 1;
                    M12 += 1;
                  END;
                  TempContactBuffer.MODIFY;
                END;
              END;
            //END;
          END;
        UNTIL Contact.NEXT =0;
    END;

    LOCAL PROCEDURE ContactAddedDatabyJobPros@1000000031(MonthIdenPara@1000000000 : Integer);
    VAR
      ContactJobResponsibility@1000000010 : Record 5067;
    BEGIN
      IF MonthNo < MonthIdenPara THEN EXIT;
      Contact.RESET;
      IF MonthIdenPara = 1 THEN
        Contact.SETFILTER("Date Created",QMonth1Fil)
      ELSE IF MonthIdenPara = 2 THEN
        Contact.SETFILTER("Date Created",QMonth2Fil)
      ELSE IF MonthIdenPara = 3 THEN
        Contact.SETFILTER("Date Created",QMonth3Fil)
      ELSE IF MonthIdenPara = 4 THEN
        Contact.SETFILTER("Date Created",QMonth4Fil)
      ELSE IF MonthIdenPara = 5 THEN
        Contact.SETFILTER("Date Created",QMonth5Fil)
      ELSE IF MonthIdenPara = 6 THEN
        Contact.SETFILTER("Date Created",QMonth6Fil)
      ELSE IF MonthIdenPara = 7 THEN
        Contact.SETFILTER("Date Created",QMonth7Fil)
      ELSE IF MonthIdenPara = 8 THEN
        Contact.SETFILTER("Date Created",QMonth8Fil)
      ELSE IF MonthIdenPara = 9 THEN
        Contact.SETFILTER("Date Created",QMonth9Fil)
      ELSE IF MonthIdenPara = 10 THEN
        Contact.SETFILTER("Date Created",QMonth10Fil)
      ELSE IF MonthIdenPara = 11 THEN
        Contact.SETFILTER("Date Created",QMonth11Fil)
      ELSE IF MonthIdenPara = 12 THEN
        Contact.SETFILTER("Date Created",QMonth12Fil);
      Contact.SETRANGE(Type,Contact.Type::Person);
      //Contact.SETFILTER("Shortcut Dimension 5 Code",'<>%1','');
      //Contact.SETRANGE("Shortcut Dimension 5 Code",'E');
      Contact.SETAUTOCALCFIELDS("Blocked Customer");
      Contact.SETFILTER("Blocked Customer",'<>%1',Contact."Blocked Customer"::All);
      // Contact.SETAUTOCALCFIELDS("Job Responsibility");
      // Contact.SETRANGE("Job Responsibility",'18');
      IF Contact.FINDSET THEN BEGIN
        REPEAT
          IF (Contact."Company No." = '')  THEN BEGIN //OR (Contact."Prospect Converted By" <> '')
            ContactJobResponsibility.RESET;
            ContactJobResponsibility.SETRANGE("Contact No.",Contact."No.");
            IF ContactJobResponsibility.FINDFIRST THEN BEGIN
              //IF ProspectJob(ContactJobResponsibility."Job Responsibility Code") THEN BEGIN
                ContactJobResponsibility.CALCFIELDS("Job Responsibility Description");
                TempContactBuffer.RESET;
                TempContactBuffer.SETRANGE(Option,'CONTACTMANAGEMENT');
                IF ContactJobResponsibility."Job Responsibility Code" <> '' THEN
                  TempContactBuffer.SETRANGE("User ID",COPYSTR(ContactJobResponsibility."Job Responsibility Code"+' - '+ContactJobResponsibility."Job Responsibility Description",1,50))
               ELSE
                  TempContactBuffer.SETRANGE("User ID",ContactJobResponsibility."Job Responsibility Code");
                TempContactBuffer.SETRANGE("DefaultCode 20",'PCMBYPERSON');
                TempContactBuffer.SETRANGE("Division Code" , Contact."Shortcut Dimension 5 Code");
                IF NOT TempContactBuffer.FINDFIRST THEN BEGIN
                  NumVar += 1;
                  TempContactBuffer.INIT;
                  TempContactBuffer.Option := 'CONTACTMANAGEMENT';
                  TempContactBuffer."Option Choice" := FORMAT(NumVar);
                  TempContactBuffer."DefaultCode 20" := 'PCMBYPERSON';
                  IF ContactJobResponsibility."Job Responsibility Code" <> '' THEN BEGIN
                    TempContactBuffer."User ID" := COPYSTR(ContactJobResponsibility."Job Responsibility Code"+' - '+ContactJobResponsibility."Job Responsibility Description",1,50);
                    EVALUATE(TempContactBuffer.Integer_1,ContactJobResponsibility."Job Responsibility Code");
                  END ELSE
                    TempContactBuffer."User ID" := ContactJobResponsibility."Job Responsibility Code";
                  TempContactBuffer."Division Code" := Contact."Shortcut Dimension 5 Code";
                  TempContactBuffer.DefaultInteger := NumVar;
                  TempContactBuffer.DefaultText250 := 'Contact by Job Responsibility';
                  IF MonthIdenPara = 1 THEN BEGIN
                    TempContactBuffer.DefaultInteger_1 := 1;
                    M1 += 1;
                  END ELSE IF MonthIdenPara = 2 THEN BEGIN
                    TempContactBuffer.DefaultInteger_2 := 1;
                    M2 += 1;
                  END ELSE IF MonthIdenPara = 3 THEN BEGIN
                    TempContactBuffer.DefaultInteger_3 := 1;
                    M3 += 1;
                  END ELSE IF MonthIdenPara = 4 THEN BEGIN
                    TempContactBuffer.DefaultInteger_4 := 1;
                    M4 += 1;
                  END ELSE IF MonthIdenPara = 5 THEN BEGIN
                    TempContactBuffer.DefaultInteger_5 := 1;
                    M5 += 1;
                  END ELSE IF MonthIdenPara = 6 THEN BEGIN
                    TempContactBuffer.DefaultInteger_6 := 1;
                    M6 += 1;
                  END ELSE IF MonthIdenPara = 7 THEN BEGIN
                    TempContactBuffer.DefaultInteger_7 := 1;
                    M7 += 1;
                  END ELSE IF MonthIdenPara = 8 THEN BEGIN
                    TempContactBuffer.DefaultInteger_8 := 1;
                    M8 += 1;
                  END ELSE IF MonthIdenPara = 9 THEN BEGIN
                    TempContactBuffer.DefaultInteger_9 := 1;
                    M9 += 1;
                  END ELSE IF MonthIdenPara = 10 THEN BEGIN
                    TempContactBuffer.DefaultInteger_10 := 1;
                    M10 += 1;
                  END ELSE IF MonthIdenPara = 11 THEN BEGIN
                    TempContactBuffer.DefaultInteger_11 := 1;
                    M11 += 1;
                  END ELSE IF MonthIdenPara = 12 THEN BEGIN
                    TempContactBuffer.DefaultInteger_12 := 1;
                    M12 += 1;
                  END;
                  TempContactBuffer.INSERT;
                END ELSE BEGIN
                  IF MonthIdenPara = 1 THEN BEGIN
                    TempContactBuffer.DefaultInteger_1 += 1;
                    //TempContactBuffer.DefaultInteger_4 += TempContactBuffer.DefaultInteger_1 + TempContactBuffer.DefaultInteger_2 + TempContactBuffer.DefaultInteger_3;
                    M1 += 1;
                  END ELSE IF MonthIdenPara = 2 THEN BEGIN
                    TempContactBuffer.DefaultInteger_2 += 1;
                    M2 += 1;
                  END ELSE IF MonthIdenPara = 3 THEN BEGIN
                    TempContactBuffer.DefaultInteger_3 += 1;
                    M3 += 1;
                  END ELSE IF MonthIdenPara = 4 THEN BEGIN
                    TempContactBuffer.DefaultInteger_4 += 1;
                    M4 += 1;
                  END ELSE IF MonthIdenPara = 5 THEN BEGIN
                    TempContactBuffer.DefaultInteger_5 += 1;
                    M5 += 1;
                  END ELSE IF MonthIdenPara = 6 THEN BEGIN
                    TempContactBuffer.DefaultInteger_6 += 1;
                    M6 += 1;
                  END ELSE IF MonthIdenPara = 7 THEN BEGIN
                    TempContactBuffer.DefaultInteger_7 += 1;
                    M7 += 1;
                  END ELSE IF MonthIdenPara = 8 THEN BEGIN
                    TempContactBuffer.DefaultInteger_8 += 1;
                    M8 += 1;
                  END ELSE IF MonthIdenPara = 9 THEN BEGIN
                    TempContactBuffer.DefaultInteger_9 += 1;
                    M9 += 1;
                  END ELSE IF MonthIdenPara = 10 THEN BEGIN
                    TempContactBuffer.DefaultInteger_10 += 1;
                    M10 += 1;
                  END ELSE IF MonthIdenPara = 11 THEN BEGIN
                    TempContactBuffer.DefaultInteger_11 += 1;
                    M11 += 1;
                  END ELSE IF MonthIdenPara = 12 THEN BEGIN
                    TempContactBuffer.DefaultInteger_12 += 1;
                    M12 += 1;
                  END;
                  TempContactBuffer.MODIFY;
                END;
              END;
            //END;
          END;
        UNTIL Contact.NEXT =0;
      END;
    END;

    LOCAL PROCEDURE ProspectJob@1000000004(JobPara@1000000001 : Code[20]) : Boolean;
    VAR
      ContactBufferLoc@1000000000 : Record 50063;
    BEGIN
      IF ContactBufferLoc.GET(JobPara,'CONTACTPROSJOB') THEN
        EXIT(ContactBufferLoc."Default Boolean");
      EXIT(FALSE);
    END;

    PROCEDURE GetLineNoContactbyJob@1000000005(DivisionPara@1000000001 : Code[20];JobPara@1000000002 : Integer;TotalLine@1000000003 : Boolean) : Integer;
    VAR
      ContactBufferPermanent@1000000000 : Record 50063;
    BEGIN
      ContactBufferPermanent.RESET;
      ContactBufferPermanent.SETCURRENTKEY(DefaultInteger);
      ContactBufferPermanent.SETRANGE(Option,'DUMPCONTACTLOGBYJOB');
      ContactBufferPermanent.SETRANGE("Division Code",DivisionPara);
      ContactBufferPermanent.SETRANGE("DefaultText 30_1",'20'+YearVar);  //it will add total contact line also
      ContactBufferPermanent.SETFILTER(DefaultText250_1,'<>%1','Total Contact');
      IF ContactBufferPermanent.FINDFIRST THEN BEGIN
        REPEAT
          IF ContactBufferPermanent.Integer_1 > JobPara THEN
            IF NOT TotalLine THEN
              EXIT(ContactBufferPermanent.DefaultInteger - 10);
        UNTIL ContactBufferPermanent.NEXT = 0;
        IF NOT TotalLine THEN
          EXIT(ContactBufferPermanent.DefaultInteger - 10)
        ELSE
          EXIT(ContactBufferPermanent.DefaultInteger + 10);
      END ELSE BEGIN
        ContactBufferPermanent.RESET;
        ContactBufferPermanent.SETCURRENTKEY(DefaultInteger);
        ContactBufferPermanent.SETRANGE(Option,'DUMPCONTACTLOGBYJOB');
        ContactBufferPermanent.SETFILTER("Division Code",'<%1',DivisionPara);
        ContactBufferPermanent.SETRANGE("DefaultText 30_1",'20'+YearVar);  //it will add total contact line also
        ContactBufferPermanent.SETFILTER(DefaultText250_1,'<>%1','Total Contact');
        IF ContactBufferPermanent.FINDLAST THEN
          EXIT(ContactBufferPermanent.DefaultInteger + 10)
        ELSE BEGIN
          ContactBufferPermanent.RESET;
          ContactBufferPermanent.SETCURRENTKEY(DefaultInteger);
          ContactBufferPermanent.SETRANGE(Option,'DUMPCONTACTLOGBYJOB');
          ContactBufferPermanent.SETFILTER("Division Code",'>%1',DivisionPara);
          ContactBufferPermanent.SETRANGE("DefaultText 30_1",'20'+YearVar);  //it will add total contact line also
          ContactBufferPermanent.SETFILTER(DefaultText250_1,'<>%1','Total Contact');
          IF ContactBufferPermanent.FINDLAST THEN
            EXIT(ContactBufferPermanent.DefaultInteger - 10)
        END;
      END;
      EXIT(100);
    END;

    PROCEDURE ExportData@1000000010();
    BEGIN
      NumVar := 1;
      GetQuarterDate(DATE2DMY(DateVar,2));  //getting month filter
      MonthNo := DATE2DMY(DateVar,2);
      Header(0);
      LinesFun(0,'DUMPCONTACTLOG');
      ExporttoExcelCreateBook('Total Contacts');


      Header(1);
      LinesFun(1,'DUMPCONTACTLOGBYJOB');
      ExporttoExcelWriteSheet('Total Contact grp by Job');

      Header(0);
      LinesFun(0,'DUMPCONTACTLOGPROSPECT');

      ExporttoExcelWriteSheet('Total Prospect');


      Header(1);
      LinesFun(1,'DUMPCONTACTLOGPROSPECTJOB');
      ExporttoExcelWriteSheetandClose('Total Prospect grp by Job');
    END;

    BEGIN
    END.
  }
}

