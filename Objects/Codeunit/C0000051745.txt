OBJECT Codeunit 51745 Codeunit46EventSubscriber
{
  OBJECT-PROPERTIES
  {
    Date=08/19/20;
    Time=10:10:03 AM;
    Modified=Yes;
    Version List=NAVEVENT;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {

    PROCEDURE GetSelectionFilterForMfrRep@1000000000(VAR MfrRep@1000 : Record 50027) : Text;
    VAR
      RecRef@1001 : RecordRef;
    BEGIN
      // <TPZ92>
      RecRef.GETTABLE(MfrRep);
      EXIT(GetSelectionFilter(RecRef,MfrRep.FIELDNO(Code)));
      // <//TPZ92>
    END;

    LOCAL PROCEDURE GetSelectionFilter@1(VAR TempRecRef@1008 : RecordRef;SelectionFieldID@1001 : Integer) : Text;
    VAR
      RecRef@1000 : RecordRef;
      FieldRef@1007 : FieldRef;
      FirstRecRef@1006 : Text;
      LastRecRef@1005 : Text;
      SelectionFilter@1004 : Text;
      SavePos@1009 : Text;
      TempRecRefCount@1003 : Integer;
      More@1002 : Boolean;
    BEGIN
      IF TempRecRef.ISTEMPORARY THEN BEGIN
        RecRef := TempRecRef.DUPLICATE;
        RecRef.RESET;
      END ELSE
        RecRef.OPEN(TempRecRef.NUMBER);

      TempRecRefCount := TempRecRef.COUNT;
      IF TempRecRefCount > 0 THEN BEGIN
        TempRecRef.ASCENDING(TRUE);
        TempRecRef.FIND('-');
        WHILE TempRecRefCount > 0 DO BEGIN
          TempRecRefCount := TempRecRefCount - 1;
          RecRef.SETPOSITION(TempRecRef.GETPOSITION);
          RecRef.FIND;
          FieldRef := RecRef.FIELD(SelectionFieldID);
          FirstRecRef := FORMAT(FieldRef.VALUE);
          LastRecRef := FirstRecRef;
          More := TempRecRefCount > 0;
          WHILE More DO
            IF RecRef.NEXT = 0 THEN
              More := FALSE
            ELSE BEGIN
              SavePos := TempRecRef.GETPOSITION;
              TempRecRef.SETPOSITION(RecRef.GETPOSITION);
              IF NOT TempRecRef.FIND THEN BEGIN
                More := FALSE;
                TempRecRef.SETPOSITION(SavePos);
              END ELSE BEGIN
                FieldRef := RecRef.FIELD(SelectionFieldID);
                LastRecRef := FORMAT(FieldRef.VALUE);
                TempRecRefCount := TempRecRefCount - 1;
                IF TempRecRefCount = 0 THEN
                  More := FALSE;
              END;
            END;
          IF SelectionFilter <> '' THEN
            SelectionFilter := SelectionFilter + '|';
          IF FirstRecRef = LastRecRef THEN
            SelectionFilter := SelectionFilter + AddQuotes(FirstRecRef)
          ELSE
            SelectionFilter := SelectionFilter + AddQuotes(FirstRecRef) + '..' + AddQuotes(LastRecRef);
          IF TempRecRefCount > 0 THEN
            TempRecRef.NEXT;
        END;
        EXIT(SelectionFilter);
      END;
    END;

    PROCEDURE AddQuotes@11(inString@1000 : Text[1024]) : Text;
    BEGIN
      IF DELCHR(inString,'=',' &|()*') = inString THEN
        EXIT(inString);
      EXIT('''' + inString + '''');
    END;

    PROCEDURE GetSelectionFilterForLP@1000000001(VAR LPHeader@1000 : Record 23044505) : Text;
    VAR
      RecRef@1001 : RecordRef;
    BEGIN
      // <TPZ2808>
      RecRef.GETTABLE(LPHeader);
      EXIT(GetSelectionFilter(RecRef,LPHeader.FIELDNO("No.")));
      // <//TPZ2808>
    END;

    BEGIN
    {
      2020-05-19  TPZ2830  PSHUKLA
    }
    END.
  }
}

