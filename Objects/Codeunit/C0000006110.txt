OBJECT Codeunit 6110 GL Acc. Data Migration Facade
{
  OBJECT-PROPERTIES
  {
    Date=11/22/17;
    Time=12:00:00 PM;
    Version List=NAVW111.00;
  }
  PROPERTIES
  {
    TableNo=1798;
    OnRun=BEGIN
            FINDSET;
            REPEAT
              OnMigrateGlAccount("Staging Table RecId To Process");
              GLAccountIsSet := FALSE;
            UNTIL NEXT = 0;
          END;

  }
  CODE
  {
    VAR
      GlobalGLAccount@1001 : Record 15;
      GLAccountIsSet@1000 : Boolean;
      InternalGLAccountNotSetErr@1002 : TextConst 'ENU=Internal G/L Account is not set. Create it first.;ESM=La cuenta de contabilidad interna no est  establecida. Cr‚ela primero.;FRC=Le compte GL interne n''est pas d‚fini. Cr‚ez-le au pr‚alable.;ENC=Internal G/L Account is not set. Create it first.';

    [Integration(TRUE)]
    LOCAL PROCEDURE OnMigrateGlAccount@1(RecordIdToMigrate@1000 : RecordID);
    BEGIN
    END;

    [External]
    PROCEDURE SetGlobalGLAccount@40(GLAccountNo@1000 : Code[20]) : Boolean;
    BEGIN
      GLAccountIsSet := GlobalGLAccount.GET(GLAccountNo);
      EXIT(GLAccountIsSet);
    END;

    [External]
    PROCEDURE ModifyGLAccount@2(RunTrigger@1000 : Boolean);
    BEGIN
      IF NOT GLAccountIsSet THEN
        ERROR(InternalGLAccountNotSetErr);

      GlobalGLAccount.MODIFY(RunTrigger);
    END;

    [External]
    PROCEDURE CreateGLAccountIfNeeded@13(AccountNoToSet@1000 : Code[20];AccountNameToSet@1003 : Text[50];AccountTypeToSet@1002 : 'Posting,Heading,Total,Begin-Total,End-Total') : Boolean;
    VAR
      GLAccount@1001 : Record 15;
    BEGIN
      IF GLAccount.GET(AccountNoToSet) THEN BEGIN
        GlobalGLAccount := GLAccount;
        GLAccountIsSet := TRUE;
        EXIT;
      END;

      GLAccount.INIT;

      GLAccount.VALIDATE("No.",AccountNoToSet);
      GLAccount.VALIDATE(Name,AccountNameToSet);
      GLAccount.VALIDATE("Account Type",AccountTypeToSet);

      GLAccount.INSERT(TRUE);

      GlobalGLAccount := GLAccount;
      GLAccountIsSet := TRUE;
      EXIT(TRUE);
    END;

    [External]
    PROCEDURE SetIncomeBalanceType@16(IncomeBalanceTypeToSet@1000 : 'Income Statement,Balance Sheet');
    BEGIN
      IF NOT GLAccountIsSet THEN
        ERROR(InternalGLAccountNotSetErr);

      GlobalGLAccount.VALIDATE("Income/Balance",IncomeBalanceTypeToSet);
    END;

    [External]
    PROCEDURE SetTotaling@18(TotalingToSet@1000 : Text[250]);
    BEGIN
      IF NOT GLAccountIsSet THEN
        ERROR(InternalGLAccountNotSetErr);

      GlobalGLAccount.VALIDATE(Totaling,TotalingToSet);
    END;

    [External]
    PROCEDURE SetDebitCreditType@19(DebitCreditTypeToSet@1000 : 'Both,Debit,Credit');
    BEGIN
      IF NOT GLAccountIsSet THEN
        ERROR(InternalGLAccountNotSetErr);

      GlobalGLAccount.VALIDATE("Debit/Credit",DebitCreditTypeToSet);
    END;

    [External]
    PROCEDURE SetExchangeRateAdjustmentType@22(ExchangeRateAdjustmentTypeToSet@1000 : 'No Adjustment,Adjust Amount,Adjust Additional-Currency Amount');
    BEGIN
      IF NOT GLAccountIsSet THEN
        ERROR(InternalGLAccountNotSetErr);

      GlobalGLAccount.VALIDATE("Exchange Rate Adjustment",ExchangeRateAdjustmentTypeToSet);
    END;

    [External]
    PROCEDURE SetDirectPosting@25(DirectPostingToSet@1000 : Boolean);
    BEGIN
      IF NOT GLAccountIsSet THEN
        ERROR(InternalGLAccountNotSetErr);

      GlobalGLAccount.VALIDATE("Direct Posting",DirectPostingToSet);
    END;

    [External]
    PROCEDURE SetBlocked@26(BlockedToSet@1000 : Boolean);
    BEGIN
      IF NOT GLAccountIsSet THEN
        ERROR(InternalGLAccountNotSetErr);

      GlobalGLAccount.VALIDATE(Blocked,BlockedToSet);
    END;

    [External]
    PROCEDURE SetLastModifiedDateTime@27(LastModifiedDateTimeToSet@1000 : DateTime);
    BEGIN
      IF NOT GLAccountIsSet THEN
        ERROR(InternalGLAccountNotSetErr);

      GlobalGLAccount.VALIDATE("Last Modified Date Time",LastModifiedDateTimeToSet);
    END;

    [External]
    PROCEDURE SetLastDateModified@28(LastDateModifiedToSet@1000 : Date);
    BEGIN
      IF NOT GLAccountIsSet THEN
        ERROR(InternalGLAccountNotSetErr);

      GlobalGLAccount.VALIDATE("Last Date Modified",LastDateModifiedToSet);
    END;

    BEGIN
    END.
  }
}

