OBJECT Codeunit 51995 Table5050EventSubsciber
{
  OBJECT-PROPERTIES
  {
    Date=06/11/21;
    Time=[ 4:31:54 AM];
    Modified=Yes;
    Version List=TPZ3064,3160;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {

    [EventSubscriber(Table,5050,OnAfterInsertEvent)]
    LOCAL PROCEDURE Tb5050_OnInsert@1000000000(VAR Rec@1000000000 : Record 5050;RunTrigger@1000000001 : Boolean);
    VAR
      ContactFeederEntry@1000000002 : Record 50019;
    BEGIN
      IF RunTrigger THEN BEGIN
        Rec."Date Created" := TODAY;
        IF STRPOS(USERID,'SA_NY_NST_NAVNST') = 0 THEN
          Rec."Created By" := USERID
        ELSE BEGIN
          ContactFeederEntry.RESET;
          ContactFeederEntry.SETRANGE("Contact No.",Rec."No.");
          ContactFeederEntry.SETFILTER("User ID",'<>%1','');
          IF ContactFeederEntry.FINDFIRST THEN
            Rec."Created By" := ContactFeederEntry."User ID";
        END;
      END;
    END;

    [EventSubscriber(Table,5050,OnBeforeDeleteEvent)]
    LOCAL PROCEDURE Tb5050_OnDelete@1000000004(VAR Rec@1000000000 : Record 5050;RunTrigger@1000000001 : Boolean);
    VAR
      ContactBuffer@1000000002 : Record 50063;
      ContactJobResponsibility@1000000003 : Record 5067;
    BEGIN
      IF RunTrigger THEN BEGIN
        ContactBuffer.INIT;
        ContactBuffer.Option := 'DELETECONTACT';
        ContactBuffer."Option Choice" := Rec."No.";
        ContactBuffer.DefaultDate := TODAY;
        ContactBuffer."DefaultCode 20" := Rec."Company No.";
        ContactBuffer.DefaultDate1 := Rec."Date Created";
        ContactBuffer."Division Code" := Rec."Shortcut Dimension 5 Code";
        ContactJobResponsibility.RESET;
        ContactJobResponsibility.SETRANGE("Contact No.",Rec."No.");
        IF ContactJobResponsibility.FINDFIRST THEN
          ContactBuffer."DefaultCode 20_1" := ContactJobResponsibility."Job Responsibility Code";
        ContactBuffer."User ID" := USERID;
        ContactBuffer."DefaultText 30" := FORMAT(Rec.Type);
        IF ContactBuffer.INSERT THEN;
      END;
    END;

    [EventSubscriber(Table,5050,OnAfterValidateEvent,"Company No.")]
    LOCAL PROCEDURE Tb5050_Company_OnValidate@1000000001(VAR Rec@1000000000 : Record 5050;VAR xRec@1000000001 : Record 5050;CurrFieldNo@1000000002 : Integer);
    BEGIN
      IF STRPOS(USERID,'SA_NY_NST_NAVNST') = 0 THEN BEGIN
        IF Rec."Company No." = '' THEN BEGIN
          Rec."Prospect to Customer" := 0D;
          Rec."Prospect Converted By" := '';
        END ELSE BEGIN
          Rec."Prospect to Customer" := TODAY;
          Rec."Prospect Converted By" := USERID;
        END;
      END;
    END;

    [EventSubscriber(Table,5050,OnAfterModifyEvent)]
    LOCAL PROCEDURE Tb5050_OnModify@1000000002(VAR Rec@1000000000 : Record 5050;VAR xRec@1000000001 : Record 5050;RunTrigger@1000000002 : Boolean);
    VAR
      ContactBuffer@1000000003 : Record 50063;
      ContactJobResponsibility@1000000004 : Record 5067;
    BEGIN
      //TPZ3158
      // ContactBuffer.RESET;
      // ContactBuffer.SETRANGE("Option Choice",'EDITCONTACTS');
      // ContactBuffer.SETRANGE(Option,USERID);
      // ContactBuffer.SETRANGE("Default Boolean",TRUE);
      IF Rec.Type = Rec.Type::Person THEN BEGIN
        ContactBuffer.INIT;
        ContactBuffer.Option := 'EDITCONTACTS';
        ContactBuffer."Option Choice" := Rec."No." + FORMAT(CURRENTDATETIME);//Rec."No.";
        ContactBuffer.DefaultDate := TODAY;
        ContactBuffer."DefaultCode 20_1" := Rec."No.";
        ContactBuffer."DefaultCode 20" := Rec."Company No.";
        ContactBuffer.DefaultDate := Rec."Date Created";
        ContactBuffer.DefaultInteger := 1;
        ContactJobResponsibility.RESET;
        ContactJobResponsibility.SETRANGE("Contact No.",Rec."No.");
        IF ContactJobResponsibility.FINDFIRST THEN
          ContactBuffer."DefaultCode 20_2" := ContactJobResponsibility."Job Responsibility Code";
        ContactBuffer."User ID" := USERID;
        ContactBuffer."DefaultText 30" := FORMAT(Rec.Type);
        ContactBuffer."Default DateTime" := CURRENTDATETIME;
        ContactBuffer.DefaultTime := TIME;
        ContactBuffer."Division Code" := Rec."Shortcut Dimension 5 Code";
        IF ContactBuffer.INSERT THEN;
      END;
    END;

    BEGIN
    {
      TPZ3064 PKS  Created new object
    }
    END.
  }
}

