OBJECT Codeunit 50033 Bin Renaming
{
  OBJECT-PROPERTIES
  {
    Date=07/01/20;
    Time=12:00:00 AM;
    Modified=Yes;
    Version List=TPZ000.00.00;
  }
  PROPERTIES
  {
    OnRun=BEGIN
            //RenameLocation1Bins;
            UpdateBinContent('1', 'MISSING');
            MESSAGE('DONE: %1', CURRENTDATETIME);
          END;

  }
  CODE
  {
    VAR
      RenameCount@1000000000 : Integer;

    PROCEDURE UpdateBinContent@1000000000(LocationCode@1000000000 : Code[10];BinCode@1000000001 : Code[10]);
    VAR
      Bin@1000000002 : Record 7354;
      BinContent@1000000003 : Record 7302;
    BEGIN
      Bin.GET(LocationCode, BinCode);
      BinContent.SETRANGE("Location Code", LocationCode);
      BinContent.SETRANGE("Bin Code", BinCode);
      IF BinContent.FINDSET THEN
      REPEAT
        BinContent."Bin Type Code" := Bin."Bin Type Code";
        BinContent."Zone Code" := Bin."Zone Code";
        BinContent.MODIFY;
      UNTIL BinContent.NEXT = 0;
    END;

    PROCEDURE RenameBin@1000000001(LocationCode@1000000000 : Code[10];OldBinCode@1000000001 : Code[10];NewBinCode@1000000002 : Code[10]);
    VAR
      OldBin@1000000003 : Record 7354;
      NewBin@1000000004 : Record 7354;
      OldBinContent@1000000005 : Record 7302;
      NewBinContent@1000000006 : Record 7302;
      OldWhseEntry@1000000007 : Record 7312;
      NewWhseEntry@1000000008 : Record 7312;
      OldWhseShipmentLine@1000000009 : Record 7321;
      NewWhseShipmentLine@1000000010 : Record 7321;
      OldPostedWhseShptLine@1000000011 : Record 7323;
      NewPostedWhseShptLine@1000000012 : Record 7323;
      OldWhseActLine@1000000013 : Record 5767;
      NewWhseActLine@1000000014 : Record 5767;
      OldPostedWhseActLine@1000000015 : Record 5773;
      NewPostedWhseActLine@1000000016 : Record 5773;
      WhseWrkshtLine@1000000017 : Record 7326;
      OldWhseRcptLine@1000000018 : Record 7317;
      NewWhseRcptLine@1000000019 : Record 7317;
      OldPostedWhseRcptLine@1000000020 : Record 7319;
      NewPostedWhseRcptLine@1000000021 : Record 7319;
      OldWhseJnlLine@1000000022 : Record 7311;
      NewWhseJnlLine@1000000023 : Record 7311;
      Counter@1000000025 : Integer;
      Window@1000000026 : Dialog;
    BEGIN
      RenameCount += 1;

      IF (OldBinCode = '') AND (NewBinCode <> '') THEN BEGIN
        IF NewBin.GET(LocationCode, NewBinCode) THEN
          EXIT;

        NewBin.INIT;
        NewBin.Code := NewBinCode;
        NewBin."Location Code" := LocationCode;
        NewBin."Bin Type Code" := 'PICKPUT';
        NewBin."Zone Code" := 'PICKPUT';
        IF NewBin.INSERT THEN;

        EXIT;
      END;

      IF OldBinCode = NewBinCode THEN
        EXIT;

      Window.OPEN('#1######## --> #2########\#3################\#4####### of #5#######\ #6########');
      Window.UPDATE(1, OldBinCode);
      Window.UPDATE(2, NewBinCode);
      Window.UPDATE(6, RenameCount);

      //Bin table
      Window.UPDATE(3, OldBin.TABLENAME);
      Window.UPDATE(5, 1);
      Window.UPDATE(4, 1);


      IF OldBin.GET(LocationCode, OldBinCode) = FALSE THEN
        EXIT;

      NewBin.INIT;
      NewBin.TRANSFERFIELDS(OldBin);
      NewBin.Code := NewBinCode;
      OldBin.DELETE;
      IF NewBin.INSERT THEN;
      //AddNewColumn(TempExcelBuffer, RowNo, 1, 'A', NewBinCode);

      //Bin Content table.
      Window.UPDATE(3, OldBinContent.TABLENAME);
      Counter := 0;
      OldBinContent.SETRANGE("Location Code", LocationCode);
      OldBinContent.SETRANGE("Bin Code", OldBinCode);
      Window.UPDATE(4, 0);
      Window.UPDATE(5, OldBinContent.COUNT);
      IF OldBinContent.FINDSET THEN
      REPEAT
        Counter += 1;
        NewBinContent.INIT;
        NewBinContent.TRANSFERFIELDS(OldBinContent);
        NewBinContent."Bin Code" := NewBinCode;
        IF NewBinContent.INSERT THEN;

        OldBinContent.DELETE;
        Window.UPDATE(4, Counter);
      UNTIL OldBinContent.NEXT = 0;
      //AddNewColumn(TempExcelBuffer, RowNo, 2, 'B', FORMAT(Counter));

      //Warehouse Entry
      Window.UPDATE(3, OldWhseEntry.TABLENAME);
      Counter := 0;
      OldWhseEntry.SETCURRENTKEY("Location Code", "Bin Code");
      OldWhseEntry.SETRANGE("Location Code", LocationCode);
      OldWhseEntry.SETRANGE("Bin Code", OldBinCode);
      Window.UPDATE(4, 0);
      Window.UPDATE(5, OldWhseEntry.COUNT);
      IF OldWhseEntry.FINDSET THEN
      REPEAT
        NewWhseEntry.GET(OldWhseEntry."Entry No.");
        IF NewWhseEntry."Bin Code" = OldBinCode THEN BEGIN
          Counter += 1;
          NewWhseEntry."Bin Code" := NewBinCode;
          NewWhseEntry.MODIFY;
          Window.UPDATE(4, Counter);
        END;
      UNTIL OldWhseEntry.NEXT = 0;
      //AddNewColumn(TempExcelBuffer, RowNo, 3, 'C', FORMAT(Counter));

      //Warehouse shipment line
      Window.UPDATE(3, OldWhseShipmentLine.TABLENAME);
      Counter := 0;
      OldWhseShipmentLine.SETCURRENTKEY("Location Code", "Bin Code");
      OldWhseShipmentLine.SETRANGE("Location Code", LocationCode);
      OldWhseShipmentLine.SETRANGE("Bin Code", OldBinCode);
      Window.UPDATE(4, 0);
      Window.UPDATE(5, OldWhseShipmentLine.COUNT);

      IF OldWhseShipmentLine.FINDSET THEN
      REPEAT
        NewWhseShipmentLine.GET(OldWhseShipmentLine."No.",OldWhseShipmentLine."Line No.");
        IF NewWhseShipmentLine."Bin Code" = OldBinCode THEN BEGIN
          Counter += 1;
          NewWhseShipmentLine."Bin Code" := NewBinCode;
          NewWhseShipmentLine.MODIFY;
          Window.UPDATE(4, Counter);
        END;
      UNTIL OldWhseShipmentLine.NEXT = 0;
      //AddNewColumn(TempExcelBuffer, RowNo, 4, 'D', FORMAT(Counter));

      //Posted Whse. Shipment Line
      Window.UPDATE(3, OldPostedWhseShptLine.TABLENAME);
      Counter := 0;
      OldPostedWhseShptLine.SETRANGE("Location Code", LocationCode);
      OldPostedWhseShptLine.SETRANGE("Bin Code", OldBinCode);
      Window.UPDATE(4, 0);
      Window.UPDATE(5, OldPostedWhseShptLine.COUNT);

      IF OldPostedWhseShptLine.FINDSET THEN
      REPEAT
        NewPostedWhseShptLine.GET(OldPostedWhseShptLine."No.",OldPostedWhseShptLine."Line No.");
        IF NewPostedWhseShptLine."Bin Code" = OldBinCode THEN BEGIN
          Counter += 1;
          Window.UPDATE(4, Counter);
          NewPostedWhseShptLine."Bin Code" := NewBinCode;
          NewPostedWhseShptLine.MODIFY;
        END;
      UNTIL OldPostedWhseShptLine.NEXT = 0;
      //AddNewColumn(TempExcelBuffer, RowNo, 5, 'E', FORMAT(Counter));

      //Warehouse Activity Line
      Window.UPDATE(3, OldWhseActLine.TABLENAME);
      Counter := 0;
      OldWhseActLine.SETCURRENTKEY("Location Code", "Bin Code");
      OldWhseActLine.SETRANGE("Location Code", LocationCode);
      OldWhseActLine.SETRANGE("Bin Code", OldBinCode);
      Window.UPDATE(4, 0);
      Window.UPDATE(5, OldWhseActLine.COUNT);

      IF OldWhseActLine.FINDSET THEN
      REPEAT
        NewWhseActLine.GET(OldWhseActLine."Activity Type", OldWhseActLine."No.", OldWhseActLine."Line No.");
        IF NewWhseActLine."Bin Code" = OldBinCode THEN BEGIN
          Counter += 1;
          Window.UPDATE(4, Counter);
          NewWhseActLine."Bin Code" := NewBinCode;
          NewWhseActLine.MODIFY;
        END;
      UNTIL OldWhseActLine.NEXT = 0;
      //AddNewColumn(TempExcelBuffer, RowNo, 6, 'F', FORMAT(Counter));

      //Registered Whse. Activity Line
      Window.UPDATE(3, OldPostedWhseActLine.TABLENAME);
      Counter := 0;
      OldPostedWhseActLine.SETRANGE("Location Code", LocationCode);
      OldPostedWhseActLine.SETRANGE("Bin Code", OldBinCode);
      Window.UPDATE(4, 0);
      Window.UPDATE(5, OldPostedWhseActLine.COUNT);

      IF OldPostedWhseActLine.FINDSET THEN
      REPEAT
        NewPostedWhseActLine.GET(OldPostedWhseActLine."Activity Type", OldPostedWhseActLine."No.", OldPostedWhseActLine."Line No.");
        IF NewPostedWhseActLine."Bin Code" = OldBinCode THEN BEGIN
          Counter += 1;
          Window.UPDATE(4, Counter);
          NewPostedWhseActLine."Bin Code" := NewBinCode;
          NewPostedWhseActLine.MODIFY;
        END;
      UNTIL OldPostedWhseActLine.NEXT = 0;
      //AddNewColumn(TempExcelBuffer, RowNo, 7, 'G', FORMAT(Counter));

      //Whse. Worksheet Line
      Window.UPDATE(3, WhseWrkshtLine.TABLENAME);
      Counter := 0;
      WhseWrkshtLine.SETCURRENTKEY("Location Code");
      Window.UPDATE(4, 0);
      Window.UPDATE(5, WhseWrkshtLine.COUNT);

      IF WhseWrkshtLine.FINDSET THEN
      REPEAT
        IF WhseWrkshtLine."From Bin Code" = OldBinCode THEN BEGIN
          Counter += 1;
          WhseWrkshtLine."From Bin Code" := NewBinCode;
          WhseWrkshtLine.MODIFY;
        END;

        IF WhseWrkshtLine."To Bin Code" = OldBinCode THEN BEGIN
          Counter += 1;
          WhseWrkshtLine."To Bin Code" := NewBinCode;
          WhseWrkshtLine.MODIFY;
        END;

        Window.UPDATE(4, Counter);
      UNTIL WhseWrkshtLine.NEXT = 0;
      //AddNewColumn(TempExcelBuffer, RowNo, 8, 'H', FORMAT(Counter));

      //Warehouse Receipt Line
      Window.UPDATE(3, OldWhseRcptLine.TABLENAME);
      Counter := 0;
      OldWhseRcptLine.SETCURRENTKEY("Location Code", "Bin Code");
      OldWhseRcptLine.SETRANGE("Location Code", LocationCode);
      OldWhseRcptLine.SETRANGE("Bin Code", OldBinCode);
      Window.UPDATE(4, 0);
      Window.UPDATE(5, OldWhseRcptLine.COUNT);

      IF OldWhseRcptLine.FINDSET THEN
      REPEAT
        NewWhseRcptLine.GET(OldWhseRcptLine."No.",OldWhseRcptLine."Line No.");
        IF NewWhseRcptLine."Bin Code" = OldBinCode THEN BEGIN
          Counter += 1;
          Window.UPDATE(4, Counter);
          NewWhseRcptLine."Bin Code" := NewBinCode;
          NewWhseRcptLine.MODIFY;
        END;
      UNTIL OldWhseRcptLine.NEXT = 0;
      //AddNewColumn(TempExcelBuffer, RowNo, 9, 'I', FORMAT(Counter));

      //Posted Whse. Receipt Line
      Window.UPDATE(3, OldPostedWhseRcptLine.TABLENAME);
      Counter := 0;
      OldPostedWhseRcptLine.SETRANGE("Location Code", LocationCode);
      OldPostedWhseRcptLine.SETRANGE("Bin Code", OldBinCode);
      Window.UPDATE(4, 0);
      Window.UPDATE(5, OldPostedWhseRcptLine.COUNT);

      IF OldPostedWhseRcptLine.FINDSET THEN
      REPEAT
        NewPostedWhseRcptLine.GET(OldPostedWhseRcptLine."No.",OldPostedWhseRcptLine."Line No.");
        IF NewPostedWhseRcptLine."Bin Code" = OldBinCode THEN BEGIN
          Counter += 1;
          Window.UPDATE(4, Counter);
          NewPostedWhseRcptLine."Bin Code" := NewBinCode;
          NewPostedWhseRcptLine.MODIFY;
        END;
      UNTIL OldPostedWhseRcptLine.NEXT = 0;
      //AddNewColumn(TempExcelBuffer, RowNo, 10, 'J', FORMAT(Counter));

      //Warehouse Journal Line
      Window.UPDATE(3, OldWhseJnlLine.TABLENAME);
      Counter := 0;
      OldWhseJnlLine.SETCURRENTKEY("Location Code","Bin Code","Item No.","Variant Code");
      OldWhseJnlLine.SETRANGE("Location Code", LocationCode);
      OldWhseJnlLine.SETRANGE("Bin Code", OldBinCode);
      Window.UPDATE(4, 0);
      Window.UPDATE(5, OldWhseJnlLine.COUNT);

      IF OldWhseJnlLine.FINDSET THEN
      REPEAT
        NewWhseJnlLine.GET(OldWhseJnlLine."Journal Template Name",OldWhseJnlLine."Journal Batch Name",
                           OldWhseJnlLine."Location Code",OldWhseJnlLine."Line No.");
        NewWhseJnlLine."Bin Code" := NewBinCode;
        NewWhseJnlLine.MODIFY;
        Counter += 1;
        Window.UPDATE(4, Counter);
      UNTIL OldWhseJnlLine.NEXT = 0;


      Window.CLOSE;
      COMMIT;
    END;

    PROCEDURE RenameLocation1Bins@1000000004();
    BEGIN
      RenameBin('1', '0101A', '0142A01');
      RenameBin('1', '0101B', '0142B01');
      RenameBin('1', '0101C', '0142C01');
      RenameBin('1', '0102B', '0140A01');
      RenameBin('1', '0102C', '0140B01');
      RenameBin('1', '0102F', '0140C01');
      RenameBin('1', '0103B', '0138A01');
      RenameBin('1', '0103C', '0138B01');
      RenameBin('1', '0103F', '0138C01');
      RenameBin('1', '0104A', '0136A01');
      RenameBin('1', '0104B', '0136B01');
      RenameBin('1', '0104C', '0136C01');
      RenameBin('1', '0105B', '0134A01');
      RenameBin('1', '0105C', '0134B01');
      RenameBin('1', '0105D', '0134C01');
      RenameBin('1', '0106A', '0132A01');
      RenameBin('1', '0106B', '0132B01');
      RenameBin('1', '0106C', '0132C01');
      RenameBin('1', '0107B', '0130A01');
      RenameBin('1', '0107C', '0130B01');
      RenameBin('1', '0107D', '0130C01');
      RenameBin('1', '0108B', '0128A01');
      RenameBin('1', '0108C', '0128B01');
      RenameBin('1', '0110A', '0124A01');
      RenameBin('1', '0110B', '0124B01');
      RenameBin('1', '0110C', '0124C01');
      RenameBin('1', '0111A', '0122A01');
      RenameBin('1', '0111B', '0122B01');
      RenameBin('1', '0111C', '0122C01');
      RenameBin('1', '0112A', '0120A01');
      RenameBin('1', '0112B', '0120B01');
      RenameBin('1', '0112C', '0120C01');
      RenameBin('1', '0113A', '0118A01');
      RenameBin('1', '0113B', '0118B01');
      RenameBin('1', '0113C', '0118C01');
      RenameBin('1', '0114A', '0116A01');
      RenameBin('1', '0114B', '0116B01');
      RenameBin('1', '0114C', '0116C01');
      RenameBin('1', '0115A', '0114A01');
      RenameBin('1', '0115B', '0114B01');
      RenameBin('1', '0115C', '0114C01');
      RenameBin('1', '0116B', '0112B01');
      RenameBin('1', '0116C', '0112C01');
      RenameBin('1', '0117A', '0110A01');
      RenameBin('1', '0117B', '0110B01');
      RenameBin('1', '0117C', '0110C01');
      RenameBin('1', '0118A', '0108A01');
      RenameBin('1', '0118B', '0108B01');
      RenameBin('1', '0118C', '0108C01');
      RenameBin('1', '0118D', '0108D01');
      RenameBin('1', '0119A', '0106A01');
      RenameBin('1', '0119B', '0106B01');
      RenameBin('1', '0119C', '0106C01');
      RenameBin('1', '0119D', '0106D01');
      RenameBin('1', '0120A', '0104A01');
      RenameBin('1', '0120B', '0104B01');
      RenameBin('1', '0120C', '0104C01');
      RenameBin('1', '0120D', '0104D01');
      RenameBin('1', '0120E', '0104E01');
      RenameBin('1', '0121A', '0102A01');
      RenameBin('1', '0121B', '0102B01');
      RenameBin('1', '0121C', '0102C01');
      RenameBin('1', '0121D', '0102D01');
      RenameBin('1', '0121E', '0102E01');
      RenameBin('1', '0122A', '0101A01');
      RenameBin('1', '0122B', '0101B01');
      RenameBin('1', '0122C', '0101C01');
      RenameBin('1', '0122D', '0101D01');
      RenameBin('1', '0122F', '0101E01');
      RenameBin('1', '0123A', '0103A01');
      RenameBin('1', '0123B', '0103B01');
      RenameBin('1', '0123C', '0103C01');
      RenameBin('1', '0123D', '0103D01');
      RenameBin('1', '0123E', '0103E01');
      RenameBin('1', '0124A', '0104A01');
      RenameBin('1', '0124C', '0104C01');
      RenameBin('1', '0124D', '0104D01');
      RenameBin('1', '0124E', '0104E01');
      RenameBin('1', '0125A', '0105A01');
      RenameBin('1', '0125B', '0105B01');
      RenameBin('1', '0125C', '0105C01');
      RenameBin('1', '0125E', '0105D01');
      RenameBin('1', '0125F', '0105E01');
    END;

    BEGIN
    END.
  }
}

