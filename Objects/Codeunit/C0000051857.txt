OBJECT Codeunit 51857 Page135EventSubscriber
{
  OBJECT-PROPERTIES
  {
    Date=08/20/20;
    Time=[ 7:27:38 AM];
    Modified=Yes;
    Version List=NAVEVT1.0.0;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {

    [EventSubscriber(Codeunit,51858,Pg135_OnOpenPage)]
    PROCEDURE Pg135_OnOpenPage@1000000013(VAR Sender@1000000000 : Codeunit 51858;VAR Rec@1000000001 : Record 115;VAR ChangeLogEntriesVisible@1000000002 : Boolean;VAR CommHdlgVisible@1000000004 : Boolean);
    VAR
      UserMgt@1000000003 : Codeunit 5700;
    BEGIN
      // <TPZ159>
      ChangeLogEntriesVisible := TRUE;
      IF UserMgt.GetMfrRepSalesFilter <> '' THEN
        ChangeLogEntriesVisible := FALSE;
      // </TPZ159>

      // <TPZ858>
      CommHdlgVisible := UserMgt.GetCommHdlgAdmin(USERID);
      // </TPZ858>
    END;

    [EventSubscriber(Page,135,OnBeforeActionEvent,Action1000000020)]
    PROCEDURE Pg135_ChangeLogEntries_OnAction@1000000012(VAR Rec@1000000000 : Record 115);
    VAR
      ChangeLogEntry@1000000003 : Record 405;
      SalesCrMemoHeader@1000000002 : Record 114;
      ChangeLogMgt@1000000001 : Codeunit 423;
      CUSubscriber@1000000004 : Codeunit 51876;
    BEGIN
      WITH Rec DO BEGIN
       //<TPZ1728>
        SalesCrMemoHeader.GET("Document No.");
        IF SalesCrMemoHeader."Return Order No." <> '' THEN
          //ChangeLogMgt.OpenSSRSReport(DATABASE::"Sales Line", '5', SalesCrMemoHeader."Return Order No.", FORMAT("Line No."))//<TPZ2829> Event Conversion
          CUSubscriber.CU423_OpenSSRSReport(DATABASE::"Sales Line", '5', SalesCrMemoHeader."Return Order No.", FORMAT("Line No."))//<TPZ2829> Event Conversion
        ELSE
          //ChangeLogMgt.OpenSSRSReport(DATABASE::"Sales Line", '3', "Document No.",FORMAT("Line No."));//<TPZ2829> Event Conversion
          CUSubscriber.CU423_OpenSSRSReport(DATABASE::"Sales Line", '3', "Document No.",FORMAT("Line No."));//<TPZ2829> Event Conversion

        EXIT;
        //</TPZ1728>

      END;
    END;

    BEGIN
    END.
  }
}

