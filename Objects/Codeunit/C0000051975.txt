OBJECT Codeunit 51975 Page9231EventSubsriber
{
  OBJECT-PROPERTIES
  {
    Date=07/01/20;
    Time=12:00:00 AM;
    Modified=Yes;
    Version List=TPZ000.00.00;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {

    LOCAL PROCEDURE Pg9231_MATRIX_OnAfterGetRecord@1047(ColumnID@1000 : Integer;VAR MATRIX_CellData@1000000001 : ARRAY [32] OF Decimal;MatrixRecords@1000000003 : ARRAY [32] OF Record 14;Rec@1000000004 : Record 27);
    VAR
      Item@1001 : Record 27;
      BinContent@1000000000 : Record 7302;
      Location@1000000002 : Record 14;
    BEGIN
      //<TPZ2522>
      MATRIX_CellData[ColumnID]  := 0;
      IF Location.GET(MatrixRecords[ColumnID].Code) AND Location."Bin Mandatory" THEN BEGIN
        BinContent.RESET;
        BinContent.SETRANGE("Location Code",MatrixRecords[ColumnID].Code);
        BinContent.SETRANGE("Item No.",Rec."No.");
        BinContent.SETFILTER("Bin Type Code",'%1|%2','PICKPUT', 'PICK');
        BinContent.SETFILTER("Block Movement",'<>%1&<>%2',BinContent."Block Movement"::Outbound,BinContent."Block Movement"::All);
        BinContent.SETFILTER("Bin Code", '<>%1&<>%2&<>%3&<>%4', 'RTV','MRB','QA','QC');
        IF BinContent.FINDSET THEN
        REPEAT
          BinContent.CALCFIELDS(Quantity,"Pick Qty.","Neg. Adjmt. Qty.");
          MATRIX_CellData[ColumnID] := MATRIX_CellData[ColumnID] + BinContent.Quantity - BinContent."Pick Qty." - BinContent."Neg. Adjmt. Qty.";
        UNTIL BinContent.NEXT = 0;
      END ELSE BEGIN //</TPZ2522>
        Item.COPY(Rec);
        Item.SETRANGE("Location Filter",MatrixRecords[ColumnID].Code);
        Item.CALCFIELDS(Inventory);
        MATRIX_CellData[ColumnID] := Item.Inventory;
      END;
      //SetVisible;
    END;

    [EventSubscriber(Codeunit,51976,Pg9231On_OnAfterGetRecord)]
    LOCAL PROCEDURE Pg9231_OnAfterGetRecord@1000000003(VAR Sender@1000000001 : Codeunit 51976;MatrixRecord@1000000002 : Record 14;VAR MATRIX_CellData@1000000003 : ARRAY [32] OF Decimal;MatrixRecords@1000000004 : ARRAY [32] OF Record 14;Rec@1000000005 : Record 27;MATRIX_NoOfMatrixColumns@1000000006 : Integer);
    VAR
      MATRIX_CurrentColumnOrdinal@1000000000 : Integer;
    BEGIN
      MATRIX_CurrentColumnOrdinal := 0;
      IF MatrixRecord.FIND('-') THEN
        REPEAT
          MATRIX_CurrentColumnOrdinal := MATRIX_CurrentColumnOrdinal + 1;
          Pg9231_MATRIX_OnAfterGetRecord(MATRIX_CurrentColumnOrdinal,MATRIX_CellData,MatrixRecords,Rec);
        UNTIL (MatrixRecord.NEXT(1) = 0) OR (MATRIX_CurrentColumnOrdinal = MATRIX_NoOfMatrixColumns);
    END;

    BEGIN
    END.
  }
}

