OBJECT Codeunit 51917 Codeunit229EventSubscriber
{
  OBJECT-PROPERTIES
  {
    Date=09/24/20;
    Time=[ 9:31:45 AM];
    Modified=Yes;
    Version List=NAVEVENT;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {

    PROCEDURE PrintSalesProFormaInv@1000000001(SalesHeader@1000 : Record 36);
    VAR
      ReportSelection@1002 : Record 77;
      SalesSetup@1000000001 : Record 311;
      SalesLine@1000000000 : Record 37;
      SalesCalcDisc@1000000002 : Codeunit 60;
    BEGIN
      // <TPZ781>Codeunit 229
      IF SalesHeader."Document Type" <> SalesHeader."Document Type"::Order THEN
        EXIT;

      SalesHeader.SETRANGE("No.",SalesHeader."No.");
      SalesSetup.GET;
      IF SalesSetup."Calc. Inv. Discount" THEN BEGIN
        SalesLine.RESET;
        SalesLine.SETRANGE("Document Type",SalesHeader."Document Type");
        SalesLine.SETRANGE("Document No.",SalesHeader."No.");
        SalesLine.FINDFIRST;
        SalesCalcDisc.RUN(SalesLine);
        SalesHeader.GET(SalesHeader."Document Type",SalesHeader."No.");
        COMMIT;
      END;

      ReportSelection.RESET;
      ReportSelection.SETRANGE(Usage,ReportSelection.Usage::"Pro Forma S. Invoice");
      ReportSelection.SETFILTER("Report ID",'<>0');
      ReportSelection.FINDSET;
      REPEAT
        REPORT.RUNMODAL(ReportSelection."Report ID",GUIALLOWED,FALSE,SalesHeader)
      UNTIL ReportSelection.NEXT = 0;
      // </TPZ781>
    END;

    BEGIN
    {
      2020-05-27  TPZ2830  PSHUKLA
    }
    END.
  }
}

