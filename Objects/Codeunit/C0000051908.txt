OBJECT Codeunit 51908 Codeunit408EventSubscriber
{
  OBJECT-PROPERTIES
  {
    Date=07/01/20;
    Time=12:00:00 AM;
    Modified=Yes;
    Version List=TPZ000.00.00;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {

    PROCEDURE Cu408_GetShortcutDim5Code@1000000004(DimSetID@1000000000 : Integer) : Code[20];
    VAR
      GLSetup@1000000002 : Record 98;
      DimSetEntry@1000000001 : Record 480;
    BEGIN
      // <TOP9116>
      GLSetup.GET;

      IF (GLSetup."Shortcut Dimension 5 Code" <> '') AND
         DimSetEntry.GET(DimSetID,GLSetup."Shortcut Dimension 5 Code")
      THEN
        EXIT(DimSetEntry."Dimension Value Code");
      // </TOP9116>
    END;

    PROCEDURE Cu408_EditDimensionSet2Custom@1000000001(DimSetID@1000 : Integer;NewCaption@1003 : Text[250];VAR GlobalDimVal1@1006 : Code[20];VAR GlobalDimVal2@1005 : Code[20];VAR ShortcutDimVal5@1000000000 : Code[20]) : Integer;
    VAR
      EditDimSetEntries@1002 : Page 480;
      NewDimSetID@1004 : Integer;
      DimSetEntry@1000000001 : Record 480;
    BEGIN
      NewDimSetID := DimSetID;
      DimSetEntry.RESET;
      DimSetEntry.FILTERGROUP(2);
      DimSetEntry.SETRANGE("Dimension Set ID",DimSetID);
      DimSetEntry.FILTERGROUP(0);
      EditDimSetEntries.SETTABLEVIEW(DimSetEntry);
      EditDimSetEntries.SetFormCaption(NewCaption);
      EditDimSetEntries.RUNMODAL;
      NewDimSetID := EditDimSetEntries.GetDimensionID;
      Cu408_UpdateGlobalDimFromDimSetIDCustom(NewDimSetID,GlobalDimVal1,GlobalDimVal2,ShortcutDimVal5);
      DimSetEntry.RESET;
      EXIT(NewDimSetID);
    END;

    PROCEDURE Cu408_UpdateGlobalDimFromDimSetIDCustom@1000000002(DimSetID@1000 : Integer;VAR GlobalDimVal1@1001 : Code[20];VAR GlobalDimVal2@1002 : Code[20];VAR ShortcutDimVal5@1000000000 : Code[20]);
    VAR
      GLSetup@1000000001 : Record 98;
      GLSetupShortcutDimCode@1000000002 : ARRAY [8] OF Code[20];
      DimSetEntry@1000000003 : Record 480;
    BEGIN
      //GetGLSetup;
      //start NAVEVENT
        GLSetup.GET;
        GLSetupShortcutDimCode[1] := GLSetup."Shortcut Dimension 1 Code";
        GLSetupShortcutDimCode[2] := GLSetup."Shortcut Dimension 2 Code";
        GLSetupShortcutDimCode[3] := GLSetup."Shortcut Dimension 3 Code";
        GLSetupShortcutDimCode[4] := GLSetup."Shortcut Dimension 4 Code";
        GLSetupShortcutDimCode[5] := GLSetup."Shortcut Dimension 5 Code";
        GLSetupShortcutDimCode[6] := GLSetup."Shortcut Dimension 6 Code";
        GLSetupShortcutDimCode[7] := GLSetup."Shortcut Dimension 7 Code";
        GLSetupShortcutDimCode[8] := GLSetup."Shortcut Dimension 8 Code";
      //end NAVEVENT
      GlobalDimVal1 := '';
      GlobalDimVal2 := '';
      ShortcutDimVal5 := '';
      IF GLSetupShortcutDimCode[1] <> '' THEN
        IF DimSetEntry.GET(DimSetID,GLSetupShortcutDimCode[1]) THEN
          GlobalDimVal1 := DimSetEntry."Dimension Value Code";
      IF GLSetupShortcutDimCode[2] <> '' THEN
        IF DimSetEntry.GET(DimSetID,GLSetupShortcutDimCode[2]) THEN
          GlobalDimVal2 := DimSetEntry."Dimension Value Code";
      IF GLSetupShortcutDimCode[5] <> '' THEN
        IF DimSetEntry.GET(DimSetID,GLSetupShortcutDimCode[5]) THEN
          ShortcutDimVal5 := DimSetEntry."Dimension Value Code";
    END;

    PROCEDURE Cu408_GetConsolidatedDimFilterByDimFilter@37(VAR Dimension@1000 : Record 348;DimFilter@1001 : Text) ConsolidatedDimFilter : Text;
    BEGIN
      Dimension.SETFILTER("Consolidation Code",DimFilter);
      ConsolidatedDimFilter += DimFilter;
      IF Dimension.FINDSET THEN
        REPEAT
          ConsolidatedDimFilter += '|' + Dimension.Code;
        UNTIL Dimension.NEXT = 0;
    END;

    BEGIN
    END.
  }
}

