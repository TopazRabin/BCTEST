OBJECT Codeunit 5708 Release Transfer Document
{
  OBJECT-PROPERTIES
  {
    Date=02/09/21;
    Time=[ 2:20:10 PM];
    Modified=Yes;
    Version List=NAVW111.00.00.44345;
  }
  PROPERTIES
  {
    TableNo=5740;
    Permissions=TableData 5740=rm;
    OnRun=VAR
            TransLine@1000 : Record 5741;
          BEGIN
            IF Status = Status::Released THEN
              EXIT;

            OnBeforeReleaseTransferDoc(Rec);
            TESTFIELD("Transfer-from Code");
            TESTFIELD("Transfer-to Code");
            IF "Transfer-from Code" = "Transfer-to Code" THEN
              ERROR(Text001,"No.",FIELDCAPTION("Transfer-from Code"),FIELDCAPTION("Transfer-to Code"));
            IF NOT "Direct Transfer" THEN
              TESTFIELD("In-Transit Code")
            ELSE BEGIN
              VerifyNoOutboundWhseHandlingOnLocation("Transfer-from Code");
              VerifyNoInboundWhseHandlingOnLocation("Transfer-to Code");
            END;

            TESTFIELD(Status,Status::Open);

            //TM BEG 072415
            //TESTFIELD("Shortcut Dimension 5 Code"); //NAVEVENT
            //TM END 072415


            TransLine.SETRANGE("Document No.","No.");
            TransLine.SETFILTER(Quantity,'<>0');
            IF TransLine.ISEMPTY THEN
              ERROR(Text002,"No.");

            // >> Shipping //3073 code commented
            {
            InventorySetup.GET;
            IF InventorySetup."Enable Shipping" AND NOT RunFromEship THEN
              NameAndAddressMgt.CheckNameAddressTransferHeader(Rec,"Shipping Agent Code");
            }// << Shipping
             { IF ("Shipment Date")<WORKDATE THEN BEGIN //TPZ1894 EB
                  "Shipment Date" := WORKDATE;
                  MODIFY();
              END;} //NAVEVENT

            VALIDATE(Status,Status::Released);
            MODIFY;
            //ArchiveManagement.ArchiveTransferDocument(Rec);  //TPZ2466 //NAVEVENT
            WhseTransferRelease.SetCallFromTransferOrder(TRUE);
            WhseTransferRelease.Release(Rec);

            OnAfterReleaseTransferDoc(Rec);
          END;

  }
  CODE
  {
    VAR
      Text001@1001 : TextConst 'ENU=The transfer order %1 cannot be released because %2 and %3 are the same.;ESM=El ped. transfer. %1 no puede ser lanzado porque %2 y %3 son el mismo.;FRC=L''ordre de transfert %1 ne peut �tre lib�r� car %2 et %3 sont identiques.;ENC=The transfer order %1 cannot be released because %2 and %3 are the same.';
      Text002@1002 : TextConst 'ENU=There is nothing to release for transfer order %1.;ESM=No hay nada que lanzar para pedido transfer. %1.;FRC=Il n''y a rien � lib�rer pour l''ordre de transfert %1.;ENC=There is nothing to release for transfer order %1.';
      WhseTransferRelease@1005 : Codeunit 5773;
      InventorySetup@14000802 : Record 313;
      NameAndAddressMgt@14000803 : Codeunit 14000709;
      RunFromEship@14000800 : Boolean;
      ArchiveManagement@1000000000 : Codeunit 5063;

    [External]
    PROCEDURE Reopen@1(VAR TransHeader@1000 : Record 5740);
    BEGIN
      WITH TransHeader DO BEGIN
        IF Status = Status::Open THEN
          EXIT;
        WhseTransferRelease.Reopen(TransHeader);
        VALIDATE(Status,Status::Open);
        MODIFY;
      END;
    END;

    PROCEDURE SetRunFromEShip@14000701();
    BEGIN
      RunFromEship := TRUE;
    END;

    [Integration]
    LOCAL PROCEDURE OnBeforeReleaseTransferDoc@2(VAR TransferHeader@1000 : Record 5740);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterReleaseTransferDoc@3(VAR TransferHeader@1000 : Record 5740);
    BEGIN
    END;

    BEGIN
    {
      2017-06-29 TPZ1894 EBAGIM
        Shipment Date Validation
      2019-02-04 TPZ2466 AKUMAR
        Added code for tranfer order archive.
    }
    END.
  }
}

