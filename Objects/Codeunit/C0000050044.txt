OBJECT Codeunit 50044 Ship Notification Handling
{
  OBJECT-PROPERTIES
  {
    Date=07/01/20;
    Time=12:00:00 AM;
    Modified=Yes;
    Version List=TPZ000.00.00;
  }
  PROPERTIES
  {
    TableNo=472;
    OnRun=BEGIN

            TPZ_SendNotifications("Parameter String");
          END;

  }
  CODE
  {
    VAR
      SalesSetup@1000000000 : Record 311;

    LOCAL PROCEDURE TPZ_SendNotifications@1000000012(ShipNo@1000000000 : Code[20]);
    VAR
      EMailMgt@1000000001 : Codeunit 14000903;
      FaxMgmt@1000000005 : Codeunit 50010;
      SalesPostPrint@1000000006 : Codeunit 82;
      EmailInvoice@1000000007 : Boolean;
      PrintInvoice@1000000008 : Boolean;
      FaxInvoice@1000000009 : Boolean;
      EmailCredit@1000000010 : Boolean;
      EmailShipment@1000000011 : Boolean;
      JobQueueCat@1000000012 : Record 471;
      JobQueueEntry@1000000013 : Record 472;
      PostDescription@1000000014 : Text;
      SalesInvHeader@1000000002 : Record 112;
      SalesShptHeader@1000000003 : Record 110;
    BEGIN
      SalesSetup.GET;
      IF SalesShptHeader.GET(ShipNo)THEN
       EMailMgt.SendSalesShipmentNotice(SalesShptHeader,FALSE,FALSE);
    END;

    BEGIN
    {
      2018-02-13 TPZ2214 EBAGIM
        Handle Shipment/ASN Notifications Via Job Queue
    }
    END.
  }
}

