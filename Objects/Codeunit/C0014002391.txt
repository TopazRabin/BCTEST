OBJECT Codeunit 14002391 E.D.I. Same Day Ship Orders
{
  OBJECT-PROPERTIES
  {
    Date=03/06/15;
    Time=12:00:00 PM;
    Version List=SE0.60.06;
  }
  PROPERTIES
  {
    OnRun=BEGIN
            SalesHeaderTmp.RESET;
            SalesHeaderTmp.DELETEALL;

            GetEDISetup;

            EDIRecDocHdr.RESET;
            EDIRecDocHdr.SETRANGE("Date Received",TODAY);
            EDIRecDocHdr.SETRANGE("Use Same Day Ship Time",TRUE);
            IF EDIRecDocHdr.FIND('-') THEN
              REPEAT
                IF EDIRecDocHdr."Transaction Time" <= EDIRecDocHdr."Same Day Ship Time" THEN BEGIN
                  SalesHeader.RESET;
                  SalesHeader.SETCURRENTKEY("EDI Order","EDI Trade Partner","EDI Internal Doc. No.");
                  SalesHeader.SETRANGE("Document Type",SalesHeader."Document Type"::Order);
                  SalesHeader.SETRANGE("EDI Order",TRUE);
                  SalesHeader.SETRANGE("EDI Trade Partner",EDIRecDocHdr."Trade Partner No.");
                  SalesHeader.SETRANGE("EDI Internal Doc. No.",EDIRecDocHdr."Internal Doc. No.");
                  IF SalesHeader.FIND('-') THEN
                    REPEAT
                      IF NOT SalesHeaderTmp.GET(SalesHeader."Document Type",SalesHeader."No.") THEN BEGIN
                        SalesHeaderTmp := SalesHeader;
                        SalesHeaderTmp.INSERT;
                      END;
                    UNTIL SalesHeader.NEXT = 0;
                END;
              UNTIL EDIRecDocHdr.NEXT = 0;
            IF EDISetup.ListView THEN
              PAGE.RUN(PAGE::"Sales List",SalesHeaderTmp)
            ELSE
              PAGE.RUN(PAGE::"Sales Order",SalesHeaderTmp);
          END;

  }
  CODE
  {
    VAR
      SalesHeader@1240020003 : Record 36;
      SalesHeaderTmp@1240020000 : TEMPORARY Record 36;
      EDIRecDocHdr@1240020001 : Record 14002358;
      EDISetup@1240030001 : Record 14002367;
      EDISetupRetrieved@1240030000 : Boolean;

    PROCEDURE GetEDISetup@1();
    BEGIN
      IF NOT EDISetupRetrieved THEN BEGIN
        EDISetup.GET;
        EDISetupRetrieved := TRUE;
      END;
    END;

    BEGIN
    END.
  }
}

