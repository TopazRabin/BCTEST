OBJECT Codeunit 8623 Create D365 RapidStart Package
{
  OBJECT-PROPERTIES
  {
    Date=11/22/17;
    Time=12:00:00 PM;
    Version List=NAVW111.00,NAVNA11.00;
  }
  PROPERTIES
  {
    OnRun=BEGIN
            CreatePackage;
            CreateBasicTables;
            CreateGLTables;
            CreateItemTables;
          END;

  }
  CODE
  {
    VAR
      ConfigPackage@1001 : Record 8623;
      ConfigPackageTable@1002 : Record 8613;
      ConfigPackageMgt@1000 : Codeunit 8611;
      XPackageNameTxt@1149 : TextConst '@@@={Locked};ENU=DYNAMICS365 DEFAULT PKG;ESM=DYNAMICS365 DEFAULT PKG;FRC=DYNAMICS365 DEFAULT PKG;ENC=DYNAMICS365 DEFAULT PKG';
      XPackageCodeTxt@1150 : TextConst '@@@={Locked};ENU=DYNAMICS365;ESM=DYNAMICS365;FRC=DYNAMICS365;ENC=DYNAMICS365';
      RuleAction@1003 : ',Custom,Post,Invoice,Ship,Receive';

    PROCEDURE CreateBasicTables@30();
    BEGIN
      CreateTable(DATABASE::"Payment Terms");
      CreateTable(DATABASE::"Customer Price Group");
      CreateTable(DATABASE::"Shipment Method");
      CreateTable(DATABASE::"Salesperson/Purchaser");
      CreateTable(DATABASE::Location);
      CreateTable(DATABASE::Customer);
      CreateTable(DATABASE::Vendor);
      CreateTable(DATABASE::"Unit of Measure");
      CreateTable(DATABASE::"Sales Header");
      CreateTableChild(DATABASE::"Sales Line",DATABASE::"Sales Header");
      CreateTable(DATABASE::"Purchase Header");
      CreateTableChild(DATABASE::"Purchase Line",DATABASE::"Purchase Header");
      CreateTable(DATABASE::"Inventory Posting Group");
      CreateTable(DATABASE::Territory);
      CreateTable(DATABASE::"Sales Price");
      CreateTable(DATABASE::"Customer Posting Group");
      CreateTable(DATABASE::"Vendor Posting Group");
      CreateTable(DATABASE::"Purchase Price");
    END;

    PROCEDURE CreateGLTables@31();
    BEGIN
      CreateTable(DATABASE::"G/L Account");
      CreateTable(DATABASE::"Gen. Journal Line");
      CreateTable(DATABASE::"Gen. Business Posting Group");
      CreateTable(DATABASE::"Gen. Product Posting Group");
      CreateTable(DATABASE::"General Posting Setup");
    END;

    PROCEDURE CreateItemTables@32();
    BEGIN
      CreateTable(DATABASE::Item);
      CreateTable(DATABASE::"Item Journal Line");
      CreateTable(DATABASE::"Inventory Posting Group");
      CreateTable(DATABASE::"Item Category");
    END;

    PROCEDURE CreatePackage@1();
    BEGIN
      ConfigPackage.INIT;
      ConfigPackage.Code := XPackageCodeTxt;
      ConfigPackage."Package Name" := XPackageNameTxt;
      ConfigPackage."Language ID" := GLOBALLANGUAGE;
      ConfigPackage."Product Version" := XPackageCodeTxt;
      ConfigPackage."Exclude Config. Tables" := TRUE;
      ConfigPackage.INSERT(TRUE);
    END;

    PROCEDURE CreateTable@2(TableID@1000 : Integer);
    BEGIN
      ConfigPackageMgt.InsertPackageTable(ConfigPackageTable,ConfigPackage.Code,TableID);
      SetFields(TableID);
    END;

    PROCEDURE CreateTableChild@48(TableID@1000 : Integer;ParentTableID@1001 : Integer);
    BEGIN
      ConfigPackageMgt.InsertPackageTable(ConfigPackageTable,ConfigPackage.Code,TableID);
      ConfigPackageTable."Parent Table ID" := ParentTableID;
      ConfigPackageTable.MODIFY;
      SetFields(TableID);
    END;

    PROCEDURE ApplyPackage@55();
    BEGIN
      ConfigPackageTable.RESET;
      ConfigPackageTable.SETRANGE("Package Code",ConfigPackage.Code);
      ConfigPackageMgt.ApplyPackage(ConfigPackage,ConfigPackageTable,TRUE);
    END;

    PROCEDURE IncludeField@4(FieldID@1000 : Integer;SetInclude@1002 : Boolean);
    VAR
      ConfigPackageField@1001 : Record 8616;
    BEGIN
      ConfigPackageField.SETRANGE("Package Code",ConfigPackageTable."Package Code");
      ConfigPackageField.SETRANGE("Table ID",ConfigPackageTable."Table ID");
      ConfigPackageField.SETRANGE("Field ID",FieldID);
      ConfigPackageMgt.SelectAllPackageFields(ConfigPackageField,SetInclude);
    END;

    PROCEDURE ExcludeAllFields@5();
    VAR
      ConfigPackageField@1000 : Record 8616;
    BEGIN
      ConfigPackageField.SETRANGE("Package Code",ConfigPackageTable."Package Code");
      ConfigPackageField.SETRANGE("Table ID",ConfigPackageTable."Table ID");
      ConfigPackageMgt.SelectAllPackageFields(ConfigPackageField,FALSE);
    END;

    PROCEDURE ValidateField@13(FieldID@1000 : Integer;SetValidate@1001 : Boolean);
    VAR
      ConfigPackageField@1002 : Record 8616;
    BEGIN
      ConfigPackageField.GET(ConfigPackageTable."Package Code",ConfigPackageTable."Table ID",FieldID);
      ConfigPackageField.VALIDATE("Validate Field",SetValidate);
      ConfigPackageField.MODIFY;
    END;

    LOCAL PROCEDURE SetFields@46(TableID@1000 : Integer);
    BEGIN
      CASE TableID OF
        DATABASE::"Salesperson/Purchaser":
          SetSalespersonPurchaser;
        DATABASE::Location:
          SetLocFields;
        DATABASE::"G/L Account":
          SetGLAcc;
        DATABASE::Customer:
          SetCust;
        DATABASE::Vendor:
          SetVend;
        DATABASE::Item:
          SetItem;
        DATABASE::"Sales Header":
          SetSalesHeader;
        DATABASE::"Sales Line":
          SetSalesLine;
        DATABASE::"Gen. Journal Line":
          SetGenJnlLine;
        DATABASE::"Item Journal Line":
          SetItemJnlLine;
        DATABASE::"Vendor Posting Group":
          SetVendorPostingGroup;
        DATABASE::"Unit of Measure":
          SetUnitOfMeasure;
        DATABASE::"General Posting Setup":
          SetGenPostingSetup;
        DATABASE::"Sales Price":
          SetSalesPrice;
        DATABASE::"Purchase Header":
          SetPurchaseHeader;
        DATABASE::"Purchase Line":
          SetPurchaseLine;
        DATABASE::"Purchase Price":
          SetPurchasePrice;
        DATABASE::"Payment Terms":
          SetPaymentTerms;
        DATABASE::"Shipment Method":
          SetShipmentMethod;
        DATABASE::"Item Category":
          SetItemCategory;
      END;
    END;

    LOCAL PROCEDURE SetGenJnlLine@1802();
    VAR
      GenJournalLine@1903 : Record 81;
    BEGIN
      ExcludeAllFields;
      IncludeField(GenJournalLine.FIELDNO("Journal Template Name"),TRUE);
      IncludeField(GenJournalLine.FIELDNO("Journal Batch Name"),TRUE);
      IncludeField(GenJournalLine.FIELDNO("Line No."),TRUE);
      IncludeField(GenJournalLine.FIELDNO("Account Type"),TRUE);
      IncludeField(GenJournalLine.FIELDNO("Account No."),TRUE);
      IncludeField(GenJournalLine.FIELDNO("Posting Date"),TRUE);
      IncludeField(GenJournalLine.FIELDNO("Document Type"),TRUE);
      IncludeField(GenJournalLine.FIELDNO("Document No."),TRUE);
      IncludeField(GenJournalLine.FIELDNO(Description),TRUE);
      IncludeField(GenJournalLine.FIELDNO("Bal. Account No."),TRUE);
      IncludeField(GenJournalLine.FIELDNO(Amount),TRUE);
      IncludeField(GenJournalLine.FIELDNO("Debit Amount"),TRUE);
      IncludeField(GenJournalLine.FIELDNO("Credit Amount"),TRUE);
      IncludeField(GenJournalLine.FIELDNO("Amount (LCY)"),TRUE);
      IncludeField(GenJournalLine.FIELDNO("Balance (LCY)"),TRUE);
      IncludeField(GenJournalLine.FIELDNO("Sales/Purch. (LCY)"),TRUE);
      IncludeField(GenJournalLine.FIELDNO("Profit (LCY)"),TRUE);
      IncludeField(GenJournalLine.FIELDNO("Inv. Discount (LCY)"),TRUE);
      IncludeField(GenJournalLine.FIELDNO("Bill-to/Pay-to No."),TRUE);
      IncludeField(GenJournalLine.FIELDNO("Posting Group"),TRUE);
      IncludeField(GenJournalLine.FIELDNO("Shortcut Dimension 1 Code"),TRUE);
      IncludeField(GenJournalLine.FIELDNO("Shortcut Dimension 2 Code"),TRUE);
      IncludeField(GenJournalLine.FIELDNO("Salespers./Purch. Code"),TRUE);
      IncludeField(GenJournalLine.FIELDNO("Source Code"),TRUE);
      IncludeField(GenJournalLine.FIELDNO("Applies-to Doc. Type"),TRUE);
      IncludeField(GenJournalLine.FIELDNO("Applies-to Doc. No."),TRUE);
      IncludeField(GenJournalLine.FIELDNO("Due Date"),TRUE);
      IncludeField(GenJournalLine.FIELDNO("Pmt. Discount Date"),TRUE);
      IncludeField(GenJournalLine.FIELDNO("Payment Discount %"),TRUE);
      IncludeField(GenJournalLine.FIELDNO(Quantity),TRUE);
      IncludeField(GenJournalLine.FIELDNO("Payment Terms Code"),TRUE);
      IncludeField(GenJournalLine.FIELDNO("Recurring Method"),TRUE);
      IncludeField(GenJournalLine.FIELDNO("Expiration Date"),TRUE);
      IncludeField(GenJournalLine.FIELDNO("Recurring Frequency"),TRUE);
      IncludeField(GenJournalLine.FIELDNO("Gen. Posting Type"),TRUE);
      IncludeField(GenJournalLine.FIELDNO("Gen. Bus. Posting Group"),TRUE);
      CreateMissingCodes(GenJournalLine.FIELDNO("Gen. Bus. Posting Group"),TRUE);
      IncludeField(GenJournalLine.FIELDNO("Gen. Prod. Posting Group"),TRUE);
      CreateMissingCodes(GenJournalLine.FIELDNO("Gen. Prod. Posting Group"),TRUE);
      IncludeField(GenJournalLine.FIELDNO("Allow Application"),TRUE);
      IncludeField(GenJournalLine.FIELDNO("Bal. Account Type"),TRUE);
      IncludeField(GenJournalLine.FIELDNO("Bal. Gen. Posting Type"),TRUE);
      IncludeField(GenJournalLine.FIELDNO("Bal. Gen. Bus. Posting Group"),TRUE);
      CreateMissingCodes(GenJournalLine.FIELDNO("Bal. Gen. Bus. Posting Group"),TRUE);
      IncludeField(GenJournalLine.FIELDNO("Bal. Gen. Prod. Posting Group"),TRUE);
      CreateMissingCodes(GenJournalLine.FIELDNO("Bal. Gen. Prod. Posting Group"),TRUE);
      IncludeField(GenJournalLine.FIELDNO("Bank Payment Type"),TRUE);
      IncludeField(GenJournalLine.FIELDNO("VAT Base Amount"),TRUE);
      IncludeField(GenJournalLine.FIELDNO("Bal. VAT Base Amount"),TRUE);
      IncludeField(GenJournalLine.FIELDNO(Correction),TRUE);
      IncludeField(GenJournalLine.FIELDNO("Check Printed"),TRUE);
      IncludeField(GenJournalLine.FIELDNO("Document Date"),TRUE);
      IncludeField(GenJournalLine.FIELDNO("External Document No."),TRUE);
      IncludeField(GenJournalLine.FIELDNO("Source Type"),TRUE);
      IncludeField(GenJournalLine.FIELDNO("Source No."),TRUE);
      IncludeField(GenJournalLine.FIELDNO("Posting No. Series"),TRUE);
      IncludeField(GenJournalLine.FIELDNO("Tax Area Code"),TRUE);
      IncludeField(GenJournalLine.FIELDNO("Tax Liable"),TRUE);
      IncludeField(GenJournalLine.FIELDNO("Tax Group Code"),TRUE);
      IncludeField(GenJournalLine.FIELDNO("Use Tax"),TRUE);
      IncludeField(GenJournalLine.FIELDNO("Bal. Tax Area Code"),TRUE);
      IncludeField(GenJournalLine.FIELDNO("Bal. Tax Liable"),TRUE);
      IncludeField(GenJournalLine.FIELDNO("Bal. Tax Group Code"),TRUE);
      IncludeField(GenJournalLine.FIELDNO("Bal. Use Tax"),TRUE);
      IncludeField(GenJournalLine.FIELDNO("Additional-Currency Posting"),TRUE);
      IncludeField(GenJournalLine.FIELDNO("FA Add.-Currency Factor"),TRUE);
      IncludeField(GenJournalLine.FIELDNO("Source Currency Code"),TRUE);
      IncludeField(GenJournalLine.FIELDNO("Source Currency Amount"),TRUE);
      IncludeField(GenJournalLine.FIELDNO("Source Curr. VAT Base Amount"),TRUE);
      IncludeField(GenJournalLine.FIELDNO("Source Curr. VAT Amount"),TRUE);
      IncludeField(GenJournalLine.FIELDNO("VAT Base Discount %"),TRUE);
      IncludeField(GenJournalLine.FIELDNO("VAT Amount (LCY)"),TRUE);
      IncludeField(GenJournalLine.FIELDNO("VAT Base Amount (LCY)"),TRUE);
      IncludeField(GenJournalLine.FIELDNO("Bal. VAT Amount (LCY)"),TRUE);
      IncludeField(GenJournalLine.FIELDNO("Bal. VAT Base Amount (LCY)"),TRUE);
      IncludeField(GenJournalLine.FIELDNO("Reversing Entry"),TRUE);
      IncludeField(GenJournalLine.FIELDNO("Allow Zero-Amount Posting"),TRUE);
      IncludeField(GenJournalLine.FIELDNO("Ship-to/Order Address Code"),TRUE);
      IncludeField(GenJournalLine.FIELDNO("VAT Difference"),TRUE);
      IncludeField(GenJournalLine.FIELDNO("Bal. VAT Difference"),TRUE);
      IncludeField(GenJournalLine.FIELDNO("IC Partner Code"),TRUE);
      IncludeField(GenJournalLine.FIELDNO("IC Direction"),TRUE);
      IncludeField(GenJournalLine.FIELDNO("IC Partner G/L Acc. No."),TRUE);
      IncludeField(GenJournalLine.FIELDNO("IC Partner Transaction No."),TRUE);
      IncludeField(GenJournalLine.FIELDNO("Sell-to/Buy-from No."),TRUE);
      IncludeField(GenJournalLine.FIELDNO("VAT Registration No."),TRUE);
      IncludeField(GenJournalLine.FIELDNO("Country/Region Code"),TRUE);
      IncludeField(GenJournalLine.FIELDNO(Prepayment),TRUE);
      IncludeField(GenJournalLine.FIELDNO("Financial Void"),TRUE);
      IncludeField(GenJournalLine.FIELDNO("Incoming Document Entry No."),TRUE);
      IncludeField(GenJournalLine.FIELDNO("Creditor No."),TRUE);
      IncludeField(GenJournalLine.FIELDNO("Payment Reference"),TRUE);
      IncludeField(GenJournalLine.FIELDNO("Payment Method Code"),TRUE);
      IncludeField(GenJournalLine.FIELDNO("Applies-to Ext. Doc. No."),TRUE);
      IncludeField(GenJournalLine.FIELDNO("Recipient Bank Account"),TRUE);
      IncludeField(GenJournalLine.FIELDNO("Dimension Set ID"),TRUE);
      IncludeField(GenJournalLine.FIELDNO("Tax Type"),TRUE);
      IncludeField(GenJournalLine.FIELDNO("Tax Exemption No."),TRUE);
      IncludeField(GenJournalLine.FIELDNO("IRS 1099 Code"),TRUE);
      IncludeField(GenJournalLine.FIELDNO("IRS 1099 Amount"),TRUE);
    END;

    PROCEDURE SetGLAcc@12();
    VAR
      GLAcc@1000 : Record 15;
    BEGIN
      IncludeField(GLAcc.FIELDNO("Global Dimension 1 Code"),FALSE);
      IncludeField(GLAcc.FIELDNO("Global Dimension 2 Code"),FALSE);
      IncludeField(GLAcc.FIELDNO("No. 2"),FALSE);
      IncludeField(GLAcc.FIELDNO(Indentation),FALSE);
      IncludeField(GLAcc.FIELDNO("Last Modified Date Time"),FALSE);
      IncludeField(GLAcc.FIELDNO("Consol. Translation Method"),FALSE);
      IncludeField(GLAcc.FIELDNO("Consol. Debit Acc."),FALSE);
      IncludeField(GLAcc.FIELDNO("Consol. Credit Acc."),FALSE);
      IncludeField(GLAcc.FIELDNO(Picture),FALSE);
      IncludeField(GLAcc.FIELDNO("Tax Area Code"),FALSE);
      IncludeField(GLAcc.FIELDNO("Tax Liable"),FALSE);
      IncludeField(GLAcc.FIELDNO("Default IC Partner G/L Acc. No"),FALSE);
      IncludeField(GLAcc.FIELDNO("Cost Type No."),FALSE);
      IncludeField(GLAcc.FIELDNO(Id),FALSE);
      IncludeField(GLAcc.FIELDNO("GIFI Code"),FALSE);
      IncludeField(GLAcc.FIELDNO("SAT Account Code"),FALSE);
      CreateMissingCodes(GLAcc.FIELDNO("Gen. Bus. Posting Group"),TRUE);
      CreateMissingCodes(GLAcc.FIELDNO("Gen. Prod. Posting Group"),TRUE);
    END;

    PROCEDURE SetCust@7();
    VAR
      Cust@1000 : Record 18;
    BEGIN
      IncludeField(Cust.FIELDNO("Search Name"),FALSE);
      IncludeField(Cust.FIELDNO("Name 2"),FALSE);
      IncludeField(Cust.FIELDNO("Telex No."),FALSE);
      IncludeField(Cust.FIELDNO("Our Account No."),FALSE);
      IncludeField(Cust.FIELDNO("Territory Code"),FALSE);
      IncludeField(Cust.FIELDNO("Global Dimension 1 Code"),FALSE);
      IncludeField(Cust.FIELDNO("Global Dimension 2 Code"),FALSE);
      IncludeField(Cust.FIELDNO("Chain Name"),FALSE);
      IncludeField(Cust.FIELDNO("Budgeted Amount"),FALSE);
      IncludeField(Cust.FIELDNO("Statistics Group"),FALSE);
      IncludeField(Cust.FIELDNO("Fin. Charge Terms Code"),FALSE);
      IncludeField(Cust.FIELDNO("Place of Export"),FALSE);
      IncludeField(Cust.FIELDNO("Collection Method"),FALSE);
      IncludeField(Cust.FIELDNO(Amount),FALSE);
      IncludeField(Cust.FIELDNO(Priority),FALSE);
      IncludeField(Cust.FIELDNO("Last Modified Date Time"),TRUE);
      IncludeField(Cust.FIELDNO("Last Date Modified"),TRUE);
      IncludeField(Cust.FIELDNO("Application Method"),FALSE);
      IncludeField(Cust.FIELDNO("Prices Including VAT"),FALSE);
      IncludeField(Cust.FIELDNO("Fax No."),FALSE);
      IncludeField(Cust.FIELDNO("Telex Answer Back"),FALSE);
      IncludeField(Cust.FIELDNO("Combine Shipments"),FALSE);
      IncludeField(Cust.FIELDNO("Reminder Terms Code"),FALSE);
      IncludeField(Cust.FIELDNO("No. Series"),FALSE);
      IncludeField(Cust.FIELDNO("VAT Bus. Posting Group"),FALSE);
      IncludeField(Cust.FIELDNO(Reserve),FALSE);
      IncludeField(Cust.FIELDNO("IC Partner Code"),FALSE);
      IncludeField(Cust.FIELDNO("Prepayment %"),FALSE);
      IncludeField(Cust.FIELDNO("Cash Flow Payment Terms Code"),FALSE);
      IncludeField(Cust.FIELDNO("Contact Type"),FALSE);
      IncludeField(Cust.FIELDNO("Responsibility Center"),FALSE);
      IncludeField(Cust.FIELDNO("Shipping Advice"),FALSE);
      IncludeField(Cust.FIELDNO("Shipping Agent Service Code"),FALSE);
      IncludeField(Cust.FIELDNO("Service Zone Code"),FALSE);
      IncludeField(Cust.FIELDNO("Base Calendar Code"),FALSE);
      IncludeField(Cust.FIELDNO("Copy Sell-to Addr. to Qte From"),FALSE);
      ValidateField(Cust.FIELDNO(Contact),FALSE);
      ValidateField(Cust.FIELDNO(City),FALSE);
      IncludeField(Cust.FIELDNO("Validate EU Vat Reg. No."),FALSE);
      IncludeField(Cust.FIELDNO(Id),FALSE);
      IncludeField(Cust.FIELDNO("UPS Zone"),FALSE);
      IncludeField(Cust.FIELDNO("RFC No."),FALSE);
      IncludeField(Cust.FIELDNO("CURP No."),FALSE);
      IncludeField(Cust.FIELDNO("State Inscription"),FALSE);
      CreateMissingCodes(Cust.FIELDNO("Customer Posting Group"),TRUE);
      IncludeField(Cust.FIELDNO("Validate EU Vat Reg. No."),FALSE);
      IncludeField(Cust.FIELDNO(Id),FALSE);
      IncludeField(Cust.FIELDNO("Tax Area ID"),FALSE);
      IncludeField(Cust.FIELDNO("Currency Id"),FALSE);
      IncludeField(Cust.FIELDNO("Payment Terms Id"),FALSE);
      IncludeField(Cust.FIELDNO("Shipment Method Id"),FALSE);
      IncludeField(Cust.FIELDNO("Payment Method Id"),FALSE);
      IncludeField(Cust.FIELDNO("Contact ID"),FALSE);
      IncludeField(Cust.FIELDNO("Contact Graph Id"),FALSE);
    END;

    PROCEDURE SetVend@8();
    VAR
      Vend@1000 : Record 23;
    BEGIN
      ExcludeAllFields;
      IncludeField(Vend.FIELDNO("No."),TRUE);
      IncludeField(Vend.FIELDNO(Name),TRUE);
      IncludeField(Vend.FIELDNO(Address),TRUE);
      IncludeField(Vend.FIELDNO("Address 2"),TRUE);
      IncludeField(Vend.FIELDNO(City),TRUE);
      ValidateField(Vend.FIELDNO(City),FALSE);
      IncludeField(Vend.FIELDNO(Contact),TRUE);
      ValidateField(Vend.FIELDNO(Contact),FALSE);
      IncludeField(Vend.FIELDNO("Phone No."),TRUE);
      IncludeField(Vend.FIELDNO("Our Account No."),TRUE);
      IncludeField(Vend.FIELDNO("Vendor Posting Group"),TRUE);
      CreateMissingCodes(Vend.FIELDNO("Vendor Posting Group"),TRUE);
      IncludeField(Vend.FIELDNO("Currency Code"),TRUE);
      IncludeField(Vend.FIELDNO("Language Code"),TRUE);
      IncludeField(Vend.FIELDNO("Payment Terms Code"),TRUE);
      IncludeField(Vend.FIELDNO("Invoice Disc. Code"),TRUE);
      IncludeField(Vend.FIELDNO("Country/Region Code"),TRUE);
      IncludeField(Vend.FIELDNO(Blocked),TRUE);
      IncludeField(Vend.FIELDNO("Payment Method Code"),TRUE);
      IncludeField(Vend.FIELDNO("Last Modified Date Time"),TRUE);
      IncludeField(Vend.FIELDNO("Last Date Modified"),TRUE);
      IncludeField(Vend.FIELDNO("VAT Registration No."),TRUE);
      IncludeField(Vend.FIELDNO("Gen. Bus. Posting Group"),TRUE);
      IncludeField(Vend.FIELDNO(Picture),TRUE);
      IncludeField(Vend.FIELDNO(GLN),TRUE);
      IncludeField(Vend.FIELDNO("Post Code"),TRUE);
      IncludeField(Vend.FIELDNO(County),TRUE);
      IncludeField(Vend.FIELDNO("E-Mail"),TRUE);
      IncludeField(Vend.FIELDNO("Home Page"),TRUE);
      IncludeField(Vend.FIELDNO("Tax Area Code"),TRUE);
      IncludeField(Vend.FIELDNO("Tax Liable"),TRUE);
      IncludeField(Vend.FIELDNO("VAT Bus. Posting Group"),TRUE);
      IncludeField(Vend.FIELDNO("Block Payment Tolerance"),TRUE);
      IncludeField(Vend.FIELDNO("Prepayment %"),TRUE);
      IncludeField(Vend.FIELDNO("Partner Type"),TRUE);
      IncludeField(Vend.FIELDNO(Image),TRUE);
      IncludeField(Vend.FIELDNO("Preferred Bank Account Code"),TRUE);
      IncludeField(Vend.FIELDNO("Primary Contact No."),TRUE);
      IncludeField(Vend.FIELDNO("Location Code"),TRUE);
      IncludeField(Vend.FIELDNO("Document Sending Profile"),TRUE);
      IncludeField(Vend.FIELDNO("Federal ID No."),TRUE);
      IncludeField(Vend.FIELDNO("Bank Communication"),TRUE);
      IncludeField(Vend.FIELDNO("Check Date Format"),TRUE);
      IncludeField(Vend.FIELDNO("Check Date Separator"),TRUE);
      IncludeField(Vend.FIELDNO("IRS 1099 Code"),TRUE);
      IncludeField(Vend.FIELDNO("State Inscription"),TRUE);
      IncludeField(Vend.FIELDNO("FATCA filing requirement"),TRUE);
      IncludeField(Vend.FIELDNO("Tax Identification Type"),TRUE);
    END;

    PROCEDURE SetItem@9();
    VAR
      Item@1000 : Record 27;
    BEGIN
      ExcludeAllFields;
      IncludeField(Item.FIELDNO("No."),TRUE);
      IncludeField(Item.FIELDNO(Description),TRUE);
      IncludeField(Item.FIELDNO("Search Description"),TRUE);
      IncludeField(Item.FIELDNO("Base Unit of Measure"),TRUE);
      ValidateField(Item.FIELDNO("Base Unit of Measure"),FALSE);
      CreateMissingCodes(Item.FIELDNO("Base Unit of Measure"),TRUE);
      IncludeField(Item.FIELDNO(Type),TRUE);
      IncludeField(Item.FIELDNO("Inventory Posting Group"),TRUE);
      CreateMissingCodes(Item.FIELDNO("Inventory Posting Group"),TRUE);
      IncludeField(Item.FIELDNO("Item Disc. Group"),TRUE);
      IncludeField(Item.FIELDNO("Allow Invoice Disc."),TRUE);
      IncludeField(Item.FIELDNO("Unit Price"),TRUE);
      IncludeField(Item.FIELDNO("Price/Profit Calculation"),TRUE);
      IncludeField(Item.FIELDNO("Last DateTime Modified"),TRUE);
      IncludeField(Item.FIELDNO("Profit %"),TRUE);
      IncludeField(Item.FIELDNO("Unit Cost"),TRUE);
      IncludeField(Item.FIELDNO("Last Direct Cost"),TRUE);
      IncludeField(Item.FIELDNO("Indirect Cost %"),TRUE);
      IncludeField(Item.FIELDNO("Vendor No."),TRUE);
      CreateMissingCodes(Item.FIELDNO("Vendor No."),TRUE);
      IncludeField(Item.FIELDNO("Net Weight"),TRUE);
      IncludeField(Item.FIELDNO(Blocked),TRUE);
      IncludeField(Item.FIELDNO("Gen. Prod. Posting Group"),TRUE);
      IncludeField(Item.FIELDNO("Automatic Ext. Texts"),TRUE);
      IncludeField(Item.FIELDNO("Tax Group Code"),TRUE);
      IncludeField(Item.FIELDNO("Stockout Warning"),TRUE);
      IncludeField(Item.FIELDNO("Prevent Negative Inventory"),TRUE);
      IncludeField(Item.FIELDNO(GTIN),TRUE);
      IncludeField(Item.FIELDNO("Sales Unit of Measure"),TRUE);
      IncludeField(Item.FIELDNO("Purch. Unit of Measure"),TRUE);
      IncludeField(Item.FIELDNO("Item Category Code"),TRUE);
      AddItemProcessingRule(XPackageCodeTxt,DATABASE::Item,0,RuleAction::Post);
    END;

    LOCAL PROCEDURE SetSalesHeader@42();
    VAR
      SalesHeader@1000 : Record 36;
    BEGIN
      IncludeField(SalesHeader.FIELDNO("Bill-to Name 2"),FALSE);
      IncludeField(SalesHeader.FIELDNO("Ship-to Name 2"),FALSE);
      IncludeField(SalesHeader.FIELDNO("Currency Factor"),FALSE);
      IncludeField(SalesHeader.FIELDNO("Language Code"),FALSE);
      IncludeField(SalesHeader.FIELDNO("Order Class"),FALSE);
      IncludeField(SalesHeader.FIELDNO("No. Printed"),FALSE);
      IncludeField(SalesHeader.FIELDNO(Ship),FALSE);
      IncludeField(SalesHeader.FIELDNO(Invoice),FALSE);
      IncludeField(SalesHeader.FIELDNO("Print Posted Documents"),FALSE);
      IncludeField(SalesHeader.FIELDNO("Shipping No."),FALSE);
      IncludeField(SalesHeader.FIELDNO("Posting No."),FALSE);
      IncludeField(SalesHeader.FIELDNO("Last Shipping No."),FALSE);
      IncludeField(SalesHeader.FIELDNO("Last Posting No."),FALSE);
      IncludeField(SalesHeader.FIELDNO("Prepayment No."),FALSE);
      IncludeField(SalesHeader.FIELDNO("Last Prepayment No."),FALSE);
      IncludeField(SalesHeader.FIELDNO("Prepmt. Cr. Memo No."),FALSE);
      IncludeField(SalesHeader.FIELDNO("Last Prepmt. Cr. Memo No."),FALSE);
      IncludeField(SalesHeader.FIELDNO("Combine Shipments"),FALSE);
      IncludeField(SalesHeader.FIELDNO("Reason Code"),FALSE);
      IncludeField(SalesHeader.FIELDNO("EU 3-Party Trade"),FALSE);
      IncludeField(SalesHeader.FIELDNO("Transaction Type"),FALSE);
      IncludeField(SalesHeader.FIELDNO("Transport Method"),FALSE);
      IncludeField(SalesHeader.FIELDNO("Sell-to Customer Name 2"),FALSE);
      IncludeField(SalesHeader.FIELDNO("Bal. Account Type"),FALSE);
      IncludeField(SalesHeader.FIELDNO("Exit Point"),FALSE);
      IncludeField(SalesHeader.FIELDNO(Correction),FALSE);
      IncludeField(SalesHeader.FIELDNO(Area),FALSE);
      IncludeField(SalesHeader.FIELDNO("Transaction Specification"),FALSE);
      IncludeField(SalesHeader.FIELDNO("Shipping No. Series"),FALSE);
      IncludeField(SalesHeader.FIELDNO("Applies-to ID"),FALSE);
      IncludeField(SalesHeader.FIELDNO("VAT Base Discount %"),FALSE);
      IncludeField(SalesHeader.FIELDNO(Status),FALSE);
      IncludeField(SalesHeader.FIELDNO("Send IC Document"),FALSE);
      IncludeField(SalesHeader.FIELDNO("IC Status"),FALSE);
      IncludeField(SalesHeader.FIELDNO("Sell-to IC Partner Code"),FALSE);
      IncludeField(SalesHeader.FIELDNO("Bill-to IC Partner Code"),FALSE);
      IncludeField(SalesHeader.FIELDNO("IC Direction"),FALSE);
      IncludeField(SalesHeader.FIELDNO(Id),FALSE);
      ValidateField(SalesHeader.FIELDNO("No."),FALSE);
      CreateMissingCodes(SalesHeader.FIELDNO("Customer Posting Group"),TRUE);
      CreateMissingCodes(SalesHeader.FIELDNO("Bal. Account No."),TRUE);
    END;

    LOCAL PROCEDURE SetSalespersonPurchaser@23();
    VAR
      SalespersonPurchaser@1000 : Record 13;
    BEGIN
      IncludeField(SalespersonPurchaser.FIELDNO("Global Dimension 1 Code"),FALSE);
      IncludeField(SalespersonPurchaser.FIELDNO("Global Dimension 2 Code"),FALSE);
      IncludeField(SalespersonPurchaser.FIELDNO("Search E-Mail"),FALSE);
      IncludeField(SalespersonPurchaser.FIELDNO("E-Mail 2"),FALSE);
    END;

    LOCAL PROCEDURE SetLocFields@25();
    VAR
      Location@1000 : Record 14;
    BEGIN
      ExcludeAllFields;
      IncludeField(Location.FIELDNO(Code),TRUE);
      IncludeField(Location.FIELDNO(Name),TRUE);
      IncludeField(Location.FIELDNO(Address),TRUE);
      IncludeField(Location.FIELDNO("Address 2"),TRUE);
      IncludeField(Location.FIELDNO(City),TRUE);
      IncludeField(Location.FIELDNO("Phone No."),TRUE);
      IncludeField(Location.FIELDNO(Contact),TRUE);
      IncludeField(Location.FIELDNO("Post Code"),TRUE);
      IncludeField(Location.FIELDNO(County),TRUE);
      IncludeField(Location.FIELDNO("E-Mail"),TRUE);
      IncludeField(Location.FIELDNO("Home Page"),TRUE);
      IncludeField(Location.FIELDNO("Country/Region Code"),TRUE);
      IncludeField(Location.FIELDNO("Use As In-Transit"),TRUE);
      IncludeField(Location.FIELDNO("Tax Area Code"),TRUE);
      IncludeField(Location.FIELDNO("Tax Exemption No."),TRUE);
      IncludeField(Location.FIELDNO("Do Not Use For Tax Calculation"),TRUE);
      IncludeField(Location.FIELDNO("Provincial Tax Area Code"),TRUE);
    END;

    LOCAL PROCEDURE SetItemJnlLine@59();
    VAR
      ItemJournalLine@1000 : Record 83;
    BEGIN
      ExcludeAllFields;
      IncludeField(ItemJournalLine.FIELDNO("Journal Template Name"),TRUE);
      IncludeField(ItemJournalLine.FIELDNO("Journal Batch Name"),TRUE);
      IncludeField(ItemJournalLine.FIELDNO("Line No."),TRUE);
      IncludeField(ItemJournalLine.FIELDNO("Item No."),TRUE);
      CreateMissingCodes(ItemJournalLine.FIELDNO("Item No."),TRUE);
      IncludeField(ItemJournalLine.FIELDNO("Posting Date"),TRUE);
      IncludeField(ItemJournalLine.FIELDNO("Entry Type"),TRUE);
      IncludeField(ItemJournalLine.FIELDNO("Source No."),TRUE);
      IncludeField(ItemJournalLine.FIELDNO("Document No."),TRUE);
      IncludeField(ItemJournalLine.FIELDNO(Description),TRUE);
      IncludeField(ItemJournalLine.FIELDNO("Location Code"),TRUE);
      IncludeField(ItemJournalLine.FIELDNO("Inventory Posting Group"),TRUE);
      CreateMissingCodes(ItemJournalLine.FIELDNO("Inventory Posting Group"),TRUE);
      IncludeField(ItemJournalLine.FIELDNO(Quantity),TRUE);
      IncludeField(ItemJournalLine.FIELDNO("Invoiced Quantity"),TRUE);
      IncludeField(ItemJournalLine.FIELDNO("Unit Amount"),TRUE);
      IncludeField(ItemJournalLine.FIELDNO("Unit Cost"),TRUE);
      IncludeField(ItemJournalLine.FIELDNO(Amount),TRUE);
      IncludeField(ItemJournalLine.FIELDNO("Discount Amount"),TRUE);
      IncludeField(ItemJournalLine.FIELDNO("Salespers./Purch. Code"),TRUE);
      IncludeField(ItemJournalLine.FIELDNO("Source Code"),TRUE);
      IncludeField(ItemJournalLine.FIELDNO("Applies-to Entry"),TRUE);
      IncludeField(ItemJournalLine.FIELDNO("Item Shpt. Entry No."),TRUE);
      IncludeField(ItemJournalLine.FIELDNO("Shortcut Dimension 1 Code"),TRUE);
      IncludeField(ItemJournalLine.FIELDNO("Shortcut Dimension 2 Code"),TRUE);
      IncludeField(ItemJournalLine.FIELDNO("Indirect Cost %"),TRUE);
      IncludeField(ItemJournalLine.FIELDNO("Source Type"),TRUE);
      IncludeField(ItemJournalLine.FIELDNO("Reason Code"),TRUE);
      IncludeField(ItemJournalLine.FIELDNO("Recurring Method"),TRUE);
      IncludeField(ItemJournalLine.FIELDNO("Expiration Date"),TRUE);
      IncludeField(ItemJournalLine.FIELDNO("Recurring Frequency"),TRUE);
      IncludeField(ItemJournalLine.FIELDNO("Drop Shipment"),TRUE);
      IncludeField(ItemJournalLine.FIELDNO("Transaction Type"),TRUE);
      IncludeField(ItemJournalLine.FIELDNO("Transport Method"),TRUE);
      IncludeField(ItemJournalLine.FIELDNO("Country/Region Code"),TRUE);
      IncludeField(ItemJournalLine.FIELDNO("New Location Code"),TRUE);
      IncludeField(ItemJournalLine.FIELDNO("New Shortcut Dimension 1 Code"),TRUE);
      IncludeField(ItemJournalLine.FIELDNO("New Shortcut Dimension 2 Code"),TRUE);
      IncludeField(ItemJournalLine.FIELDNO("Qty. (Calculated)"),TRUE);
      IncludeField(ItemJournalLine.FIELDNO("Qty. (Phys. Inventory)"),TRUE);
      IncludeField(ItemJournalLine.FIELDNO("Phys. Inventory"),TRUE);
      IncludeField(ItemJournalLine.FIELDNO("Gen. Bus. Posting Group"),TRUE);
      CreateMissingCodes(ItemJournalLine.FIELDNO("Gen. Bus. Posting Group"),TRUE);
      IncludeField(ItemJournalLine.FIELDNO("Gen. Prod. Posting Group"),TRUE);
      CreateMissingCodes(ItemJournalLine.FIELDNO("Gen. Prod. Posting Group"),TRUE);
      IncludeField(ItemJournalLine.FIELDNO("Document Date"),TRUE);
      IncludeField(ItemJournalLine.FIELDNO("External Document No."),TRUE);
      IncludeField(ItemJournalLine.FIELDNO("Unit of Measure Code"),TRUE);
      IncludeField(ItemJournalLine.FIELDNO("Quantity (Base)"),TRUE);
      IncludeField(ItemJournalLine.FIELDNO("Invoiced Qty. (Base)"),TRUE);
      IncludeField(ItemJournalLine.FIELDNO("Item Category Code"),TRUE);
      IncludeField(ItemJournalLine.FIELDNO("Rolled-up Mfg. Ovhd Cost"),TRUE);
      IncludeField(ItemJournalLine.FIELDNO("Rolled-up Cap. Overhead Cost"),TRUE);
    END;

    LOCAL PROCEDURE SetVendorPostingGroup@61();
    VAR
      VendorPostingGroup@1000 : Record 93;
    BEGIN
      IncludeField(VendorPostingGroup.FIELDNO("Invoice Rounding Account"),FALSE);
    END;

    LOCAL PROCEDURE SetUnitOfMeasure@62();
    VAR
      UnitOfMeasure@1000 : Record 204;
    BEGIN
      IncludeField(UnitOfMeasure.FIELDNO(Symbol),FALSE);
      IncludeField(UnitOfMeasure.FIELDNO("Last Modified Date Time"),FALSE);
      IncludeField(UnitOfMeasure.FIELDNO(Id),FALSE);
    END;

    LOCAL PROCEDURE SetGenPostingSetup@63();
    VAR
      GeneralPostingSetup@1000 : Record 252;
    BEGIN
      IncludeField(GeneralPostingSetup.FIELDNO("Sales Prepayments Account"),FALSE);
      IncludeField(GeneralPostingSetup.FIELDNO("Purch. Prepayments Account"),FALSE);
      IncludeField(GeneralPostingSetup.FIELDNO("Purch. FA Disc. Account"),FALSE);
      IncludeField(GeneralPostingSetup.FIELDNO("Invt. Accrual Acc. (Interim)"),FALSE);
      IncludeField(GeneralPostingSetup.FIELDNO("COGS Account (Interim)"),FALSE);
    END;

    LOCAL PROCEDURE SetSalesPrice@64();
    VAR
      SalesPrice@1000 : Record 7002;
    BEGIN
      IncludeField(SalesPrice.FIELDNO("Price Includes VAT"),FALSE);
      IncludeField(SalesPrice.FIELDNO("Allow Invoice Disc."),FALSE);
      IncludeField(SalesPrice.FIELDNO("VAT Bus. Posting Gr. (Price)"),FALSE);
      IncludeField(SalesPrice.FIELDNO("Allow Line Disc."),FALSE);
      CreateMissingCodes(SalesPrice.FIELDNO("Item No."),TRUE);
      CreateMissingCodes(SalesPrice.FIELDNO("Sales Code"),TRUE);
    END;

    LOCAL PROCEDURE SetSalesLine@3();
    VAR
      SalesLine@1000 : Record 37;
    BEGIN
      ValidateField(SalesLine.FIELDNO("Document No."),FALSE);
      IncludeField(SalesLine.FIELDNO("Description 2"),FALSE);
      IncludeField(SalesLine.FIELDNO("Units per Parcel"),FALSE);
      IncludeField(SalesLine.FIELDNO("Appl.-to Item Entry"),FALSE);
      IncludeField(SalesLine.FIELDNO("Job No."),FALSE);
      IncludeField(SalesLine.FIELDNO("Work Type Code"),FALSE);
      IncludeField(SalesLine.FIELDNO("Exit Point"),FALSE);
      IncludeField(SalesLine.FIELDNO(Area),FALSE);
      IncludeField(SalesLine.FIELDNO("Transaction Specification"),FALSE);
      IncludeField(SalesLine.FIELDNO("Tax Category"),FALSE);
      IncludeField(SalesLine.FIELDNO("VAT Clause Code"),FALSE);
      IncludeField(SalesLine.FIELDNO("VAT Bus. Posting Group"),FALSE);
      IncludeField(SalesLine.FIELDNO("VAT Prod. Posting Group"),FALSE);
      IncludeField(SalesLine.FIELDNO("Blanket Order No."),FALSE);
      IncludeField(SalesLine.FIELDNO("Blanket Order Line No."),FALSE);
      IncludeField(SalesLine.FIELDNO("VAT Base Amount"),FALSE);
      IncludeField(SalesLine.FIELDNO("System-Created Entry"),FALSE);
      IncludeField(SalesLine.FIELDNO("VAT Difference"),FALSE);
      IncludeField(SalesLine.FIELDNO("VAT Identifier"),FALSE);
      IncludeField(SalesLine.FIELDNO("IC Partner Ref. Type"),FALSE);
      IncludeField(SalesLine.FIELDNO("IC Partner Reference"),FALSE);
      IncludeField(SalesLine.FIELDNO("Prepayment %"),FALSE);
      IncludeField(SalesLine.FIELDNO("Prepmt. Line Amount"),FALSE);
      IncludeField(SalesLine.FIELDNO("Prepmt. Amt. Inv."),FALSE);
      IncludeField(SalesLine.FIELDNO("Prepmt. Amt. Incl. VAT"),FALSE);
      IncludeField(SalesLine.FIELDNO("Prepayment Amount"),FALSE);
      IncludeField(SalesLine.FIELDNO("Prepmt. VAT Base Amt."),FALSE);
      IncludeField(SalesLine.FIELDNO("Prepayment VAT %"),FALSE);
      IncludeField(SalesLine.FIELDNO("Prepmt. VAT Calc. Type"),FALSE);
      IncludeField(SalesLine.FIELDNO("Prepayment VAT Identifier"),FALSE);
      IncludeField(SalesLine.FIELDNO("Prepayment Tax Area Code"),FALSE);
      IncludeField(SalesLine.FIELDNO("Prepayment Tax Liable"),FALSE);
      IncludeField(SalesLine.FIELDNO("Prepayment Tax Group Code"),FALSE);
      IncludeField(SalesLine.FIELDNO("Prepmt Amt to Deduct"),FALSE);
      IncludeField(SalesLine.FIELDNO("Prepmt Amt Deducted"),FALSE);
      IncludeField(SalesLine.FIELDNO("Prepayment Line"),FALSE);
      IncludeField(SalesLine.FIELDNO("Prepmt. Amount Inv. Incl. VAT"),FALSE);
      IncludeField(SalesLine.FIELDNO("Prepmt. Amount Inv. (LCY)"),FALSE);
      IncludeField(SalesLine.FIELDNO("IC Partner Code"),FALSE);
      IncludeField(SalesLine.FIELDNO("Prepmt. VAT Amount Inv. (LCY)"),FALSE);
      IncludeField(SalesLine.FIELDNO("Prepayment VAT Difference"),FALSE);
      IncludeField(SalesLine.FIELDNO("Prepmt VAT Diff. to Deduct"),FALSE);
      IncludeField(SalesLine.FIELDNO("Prepmt VAT Diff. Deducted"),FALSE);
      IncludeField(SalesLine.FIELDNO("Qty. to Assemble to Order"),FALSE);
      IncludeField(SalesLine.FIELDNO("Qty. to Asm. to Order (Base)"),FALSE);
      IncludeField(SalesLine.FIELDNO("Job Task No."),FALSE);
      IncludeField(SalesLine.FIELDNO("Job Contract Entry No."),FALSE);
      IncludeField(SalesLine.FIELDNO("Deferral Code"),FALSE);
      IncludeField(SalesLine.FIELDNO("Returns Deferral Start Date"),FALSE);
      IncludeField(SalesLine.FIELDNO("Variant Code"),FALSE);
      IncludeField(SalesLine.FIELDNO("Bin Code"),FALSE);
      IncludeField(SalesLine.FIELDNO("Qty. per Unit of Measure"),FALSE);
      IncludeField(SalesLine.FIELDNO(Planned),FALSE);
      IncludeField(SalesLine.FIELDNO("FA Posting Date"),FALSE);
      IncludeField(SalesLine.FIELDNO("Depreciation Book Code"),FALSE);
      IncludeField(SalesLine.FIELDNO("Depr. until FA Posting Date"),FALSE);
      IncludeField(SalesLine.FIELDNO("Duplicate in Depreciation Book"),FALSE);
      IncludeField(SalesLine.FIELDNO("Use Duplication List"),FALSE);
      IncludeField(SalesLine.FIELDNO("Responsibility Center"),FALSE);
      IncludeField(SalesLine.FIELDNO("Out-of-Stock Substitution"),FALSE);
      IncludeField(SalesLine.FIELDNO("Originally Ordered No."),FALSE);
      IncludeField(SalesLine.FIELDNO("Originally Ordered Var. Code"),FALSE);
      IncludeField(SalesLine.FIELDNO("Cross-Reference No."),FALSE);
      IncludeField(SalesLine.FIELDNO("Unit of Measure (Cross Ref.)"),FALSE);
      IncludeField(SalesLine.FIELDNO("Cross-Reference Type"),FALSE);
      IncludeField(SalesLine.FIELDNO("Cross-Reference Type No."),FALSE);
      IncludeField(SalesLine.FIELDNO("Special Order"),FALSE);
      IncludeField(SalesLine.FIELDNO("Special Order Purchase No."),FALSE);
      IncludeField(SalesLine.FIELDNO("Special Order Purch. Line No."),FALSE);
      IncludeField(SalesLine.FIELDNO("Completely Shipped"),FALSE);
      IncludeField(SalesLine.FIELDNO("Outbound Whse. Handling Time"),FALSE);
      IncludeField(SalesLine.FIELDNO("Appl.-from Item Entry"),FALSE);
      IncludeField(SalesLine.FIELDNO("BOM Item No."),FALSE);
      IncludeField(SalesLine.FIELDNO("Return Receipt No."),FALSE);
      IncludeField(SalesLine.FIELDNO("Return Receipt Line No."),FALSE);
      IncludeField(SalesLine.FIELDNO("Return Reason Code"),FALSE);
      IncludeField(SalesLine.FIELDNO("Price description"),FALSE);
      CreateMissingCodes(SalesLine.FIELDNO("Gen. Bus. Posting Group"),TRUE);
      CreateMissingCodes(SalesLine.FIELDNO("Gen. Prod. Posting Group"),TRUE);
    END;

    LOCAL PROCEDURE SetPurchaseHeader@6();
    VAR
      PurchaseHeader@1000 : Record 38;
    BEGIN
      ValidateField(PurchaseHeader.FIELDNO("No."),FALSE);
      IncludeField(PurchaseHeader.FIELDNO("Pay-to Name 2"),FALSE);
      IncludeField(PurchaseHeader.FIELDNO("Ship-to Name 2"),FALSE);
      IncludeField(PurchaseHeader.FIELDNO("Shipment Method Code"),FALSE);
      IncludeField(PurchaseHeader.FIELDNO("Language Code"),FALSE);
      IncludeField(PurchaseHeader.FIELDNO("Last Receiving No."),FALSE);
      IncludeField(PurchaseHeader.FIELDNO("Last Posting No."),FALSE);
      IncludeField(PurchaseHeader.FIELDNO("Reason Code"),FALSE);
      IncludeField(PurchaseHeader.FIELDNO("Buy-from Vendor Name 2"),FALSE);
      IncludeField(PurchaseHeader.FIELDNO("Order Address Code"),FALSE);
      IncludeField(PurchaseHeader.FIELDNO("Entry Point"),FALSE);
      IncludeField(PurchaseHeader.FIELDNO(Area),FALSE);
      IncludeField(PurchaseHeader.FIELDNO("Transaction Specification"),FALSE);
      IncludeField(PurchaseHeader.FIELDNO("VAT Bus. Posting Group"),FALSE);
      IncludeField(PurchaseHeader.FIELDNO("VAT Base Discount %"),FALSE);
      IncludeField(PurchaseHeader.FIELDNO("Send IC Document"),FALSE);
      IncludeField(PurchaseHeader.FIELDNO("IC Status"),FALSE);
      IncludeField(PurchaseHeader.FIELDNO("Buy-from IC Partner Code"),FALSE);
      IncludeField(PurchaseHeader.FIELDNO("Pay-to IC Partner Code"),FALSE);
      IncludeField(PurchaseHeader.FIELDNO("IC Direction"),FALSE);
      IncludeField(PurchaseHeader.FIELDNO("Job Queue Status"),FALSE);
      IncludeField(PurchaseHeader.FIELDNO("Job Queue Entry ID"),FALSE);
      IncludeField(PurchaseHeader.FIELDNO("Incoming Document Entry No."),FALSE);
      IncludeField(PurchaseHeader.FIELDNO("Dimension Set ID"),FALSE);
      IncludeField(PurchaseHeader.FIELDNO("Campaign No."),FALSE);
      IncludeField(PurchaseHeader.FIELDNO("Responsibility Center"),FALSE);
      IncludeField(PurchaseHeader.FIELDNO("Posting from Whse. Ref."),FALSE);
      IncludeField(PurchaseHeader.FIELDNO("Lead Time Calculation"),FALSE);
      IncludeField(PurchaseHeader.FIELDNO("Inbound Whse. Handling Time"),FALSE);
      CreateMissingCodes(PurchaseHeader.FIELDNO("Vendor Posting Group"),TRUE);
      CreateMissingCodes(PurchaseHeader.FIELDNO("Bal. Account No."),TRUE);
      IncludeField(PurchaseHeader.FIELDNO(Id),FALSE);
    END;

    LOCAL PROCEDURE SetPurchaseLine@10();
    VAR
      PurchaseLine@1000 : Record 39;
    BEGIN
      ValidateField(PurchaseLine.FIELDNO("Document No."),FALSE);
      IncludeField(PurchaseLine.FIELDNO("Description 2"),FALSE);
      IncludeField(PurchaseLine.FIELDNO("Appl.-to Item Entry"),FALSE);
      IncludeField(PurchaseLine.FIELDNO("Job No."),FALSE);
      IncludeField(PurchaseLine.FIELDNO("Transaction Type"),FALSE);
      IncludeField(PurchaseLine.FIELDNO("Transport Method"),FALSE);
      IncludeField(PurchaseLine.FIELDNO("Attached to Line No."),FALSE);
      IncludeField(PurchaseLine.FIELDNO("Entry Point"),FALSE);
      IncludeField(PurchaseLine.FIELDNO(Area),FALSE);
      IncludeField(PurchaseLine.FIELDNO("Transaction Specification"),FALSE);
      IncludeField(PurchaseLine.FIELDNO("Blanket Order No."),FALSE);
      IncludeField(PurchaseLine.FIELDNO("Blanket Order Line No."),FALSE);
      IncludeField(PurchaseLine.FIELDNO("System-Created Entry"),FALSE);
      IncludeField(PurchaseLine.FIELDNO("IC Partner Ref. Type"),FALSE);
      IncludeField(PurchaseLine.FIELDNO("IC Partner Reference"),FALSE);
      IncludeField(PurchaseLine.FIELDNO("Prepayment %"),FALSE);
      IncludeField(PurchaseLine.FIELDNO("Prepmt. Line Amount"),FALSE);
      IncludeField(PurchaseLine.FIELDNO("Prepmt. Amt. Inv."),FALSE);
      IncludeField(PurchaseLine.FIELDNO("Prepmt. Amt. Incl. VAT"),FALSE);
      IncludeField(PurchaseLine.FIELDNO("Prepayment Amount"),FALSE);
      IncludeField(PurchaseLine.FIELDNO("Prepmt. VAT Base Amt."),FALSE);
      IncludeField(PurchaseLine.FIELDNO("Prepayment VAT %"),FALSE);
      IncludeField(PurchaseLine.FIELDNO("Prepmt. VAT Calc. Type"),FALSE);
      IncludeField(PurchaseLine.FIELDNO("Prepayment VAT Identifier"),FALSE);
      IncludeField(PurchaseLine.FIELDNO("Prepayment Tax Area Code"),FALSE);
      IncludeField(PurchaseLine.FIELDNO("Prepayment Tax Liable"),FALSE);
      IncludeField(PurchaseLine.FIELDNO("Prepayment Tax Group Code"),FALSE);
      IncludeField(PurchaseLine.FIELDNO("Prepmt Amt to Deduct"),FALSE);
      IncludeField(PurchaseLine.FIELDNO("Prepmt Amt Deducted"),FALSE);
      IncludeField(PurchaseLine.FIELDNO("Prepayment Line"),FALSE);
      IncludeField(PurchaseLine.FIELDNO("Prepmt. Amount Inv. Incl. VAT"),FALSE);
      IncludeField(PurchaseLine.FIELDNO("Prepmt. Amount Inv. (LCY)"),FALSE);
      IncludeField(PurchaseLine.FIELDNO("IC Partner Code"),FALSE);
      IncludeField(PurchaseLine.FIELDNO("Prepmt. VAT Amount Inv. (LCY)"),FALSE);
      IncludeField(PurchaseLine.FIELDNO("Prepayment VAT Difference"),FALSE);
      IncludeField(PurchaseLine.FIELDNO("Prepmt VAT Diff. to Deduct"),FALSE);
      IncludeField(PurchaseLine.FIELDNO("Prepmt VAT Diff. Deducted"),FALSE);
      IncludeField(PurchaseLine.FIELDNO("Dimension Set ID"),FALSE);
      IncludeField(PurchaseLine.FIELDNO("Job Task No."),FALSE);
      IncludeField(PurchaseLine.FIELDNO("Job Line Type"),FALSE);
      IncludeField(PurchaseLine.FIELDNO("Job Unit Price"),FALSE);
      IncludeField(PurchaseLine.FIELDNO("Job Total Price"),FALSE);
      IncludeField(PurchaseLine.FIELDNO("Job Line Amount"),FALSE);
      IncludeField(PurchaseLine.FIELDNO("Job Line Discount Amount"),FALSE);
      IncludeField(PurchaseLine.FIELDNO("Job Line Discount %"),FALSE);
      IncludeField(PurchaseLine.FIELDNO("Job Unit Price (LCY)"),FALSE);
      IncludeField(PurchaseLine.FIELDNO("Job Total Price (LCY)"),FALSE);
      IncludeField(PurchaseLine.FIELDNO("Job Line Amount (LCY)"),FALSE);
      IncludeField(PurchaseLine.FIELDNO("Job Line Disc. Amount (LCY)"),FALSE);
      IncludeField(PurchaseLine.FIELDNO("Job Currency Factor"),FALSE);
      IncludeField(PurchaseLine.FIELDNO("Job Currency Code"),FALSE);
      IncludeField(PurchaseLine.FIELDNO("Job Planning Line No."),FALSE);
      IncludeField(PurchaseLine.FIELDNO("Job Remaining Qty."),FALSE);
      IncludeField(PurchaseLine.FIELDNO("Job Remaining Qty. (Base)"),FALSE);
      IncludeField(PurchaseLine.FIELDNO("Prod. Order No."),FALSE);
      IncludeField(PurchaseLine.FIELDNO("Variant Code"),FALSE);
      IncludeField(PurchaseLine.FIELDNO("Bin Code"),FALSE);
      IncludeField(PurchaseLine.FIELDNO("FA Posting Date"),FALSE);
      IncludeField(PurchaseLine.FIELDNO("FA Posting Type"),FALSE);
      IncludeField(PurchaseLine.FIELDNO("Depreciation Book Code"),FALSE);
      IncludeField(PurchaseLine.FIELDNO("Salvage Value"),FALSE);
      IncludeField(PurchaseLine.FIELDNO("Depr. until FA Posting Date"),FALSE);
      IncludeField(PurchaseLine.FIELDNO("Depr. Acquisition Cost"),FALSE);
      IncludeField(PurchaseLine.FIELDNO("Maintenance Code"),FALSE);
      IncludeField(PurchaseLine.FIELDNO("Insurance No."),FALSE);
      IncludeField(PurchaseLine.FIELDNO("Budgeted FA No."),FALSE);
      IncludeField(PurchaseLine.FIELDNO("Duplicate in Depreciation Book"),FALSE);
      IncludeField(PurchaseLine.FIELDNO("Use Duplication List"),FALSE);
      IncludeField(PurchaseLine.FIELDNO("Responsibility Center"),FALSE);
      IncludeField(PurchaseLine.FIELDNO("Cross-Reference No."),FALSE);
      IncludeField(PurchaseLine.FIELDNO("Unit of Measure (Cross Ref.)"),FALSE);
      IncludeField(PurchaseLine.FIELDNO("Cross-Reference Type"),FALSE);
      IncludeField(PurchaseLine.FIELDNO("Cross-Reference Type No."),FALSE);
      IncludeField(PurchaseLine.FIELDNO("Routing No."),FALSE);
      IncludeField(PurchaseLine.FIELDNO("Operation No."),FALSE);
      IncludeField(PurchaseLine.FIELDNO("Work Center No."),FALSE);
      IncludeField(PurchaseLine.FIELDNO(Finished),FALSE);
      IncludeField(PurchaseLine.FIELDNO("Prod. Order Line No."),FALSE);
      IncludeField(PurchaseLine.FIELDNO("Overhead Rate"),FALSE);
      IncludeField(PurchaseLine.FIELDNO("MPS Order"),FALSE);
      IncludeField(PurchaseLine.FIELDNO("Planning Flexibility"),FALSE);
      IncludeField(PurchaseLine.FIELDNO("Safety Lead Time"),FALSE);
      IncludeField(PurchaseLine.FIELDNO("Routing Reference No."),FALSE);
      IncludeField(PurchaseLine.FIELDNO("Tax To Be Expensed"),FALSE);
      IncludeField(PurchaseLine.FIELDNO("Provincial Tax Area Code"),FALSE);
      IncludeField(PurchaseLine.FIELDNO("GST/HST"),FALSE);
      CreateMissingCodes(PurchaseLine.FIELDNO("Gen. Bus. Posting Group"),TRUE);
      CreateMissingCodes(PurchaseLine.FIELDNO("Gen. Prod. Posting Group"),TRUE);
    END;

    LOCAL PROCEDURE CreateMissingCodes@11(FieldID@1000 : Integer;CreateMissingCodes@1001 : Boolean);
    VAR
      ConfigPackageField@1002 : Record 8616;
    BEGIN
      ConfigPackageField.GET(ConfigPackageTable."Package Code",ConfigPackageTable."Table ID",FieldID);
      ConfigPackageField.VALIDATE("Create Missing Codes",CreateMissingCodes);
      ConfigPackageField.MODIFY;
    END;

    LOCAL PROCEDURE SetPurchasePrice@26();
    VAR
      PurchasePrice@1000 : Record 7012;
    BEGIN
      CreateMissingCodes(PurchasePrice.FIELDNO("Item No."),TRUE);
      CreateMissingCodes(PurchasePrice.FIELDNO("Vendor No."),TRUE);
    END;

    LOCAL PROCEDURE SetPaymentTerms@14();
    VAR
      PaymentTerms@1000 : Record 3;
    BEGIN
      IncludeField(PaymentTerms.FIELDNO("Last Modified Date Time"),FALSE);
      IncludeField(PaymentTerms.FIELDNO(Id),FALSE);
    END;

    LOCAL PROCEDURE SetShipmentMethod@17();
    VAR
      ShipmentMethod@1000 : Record 10;
    BEGIN
      IncludeField(ShipmentMethod.FIELDNO("Last Modified Date Time"),FALSE);
      IncludeField(ShipmentMethod.FIELDNO(Id),FALSE);
    END;

    LOCAL PROCEDURE SetItemCategory@16();
    VAR
      ItemCategory@1000 : Record 5722;
    BEGIN
      IncludeField(ItemCategory.FIELDNO("Last Modified Date Time"),FALSE);
      IncludeField(ItemCategory.FIELDNO(Id),FALSE);
    END;

    LOCAL PROCEDURE AddItemProcessingRule@15(PackageCode@1007 : Code[20];TableID@1000 : Integer;CodeunitID@1003 : Integer;Action@1006 : ',Custom,Post,Invoice,Ship,Receive');
    VAR
      ConfigPackageTable@1005 : Record 8613;
      ConfigTableProcessingRule@1004 : Record 8631;
      ConfigPackageManagement@1002 : Codeunit 8611;
      RuleNo@1001 : Integer;
    BEGIN
      IF ConfigPackageTable.GET(PackageCode,TableID) THEN BEGIN
        RuleNo := 1;
        ConfigTableProcessingRule.SETRANGE("Package Code",PackageCode);
        ConfigTableProcessingRule.SETRANGE("Table ID",TableID);
        IF ConfigTableProcessingRule.FINDLAST THEN
          RuleNo := ConfigTableProcessingRule."Rule No." + 1;
        IF Action = Action::Custom THEN
          ConfigPackageManagement.InsertProcessingRuleCustom(
            ConfigTableProcessingRule,ConfigPackageTable,RuleNo,CodeunitID)
        ELSE
          CreateProcessingRule(PackageCode,TableID,CodeunitID,RuleNo,Action);
      END;
    END;

    LOCAL PROCEDURE CreateProcessingRule@18(PackageCode@1000 : Code[20];TableID@1001 : Integer;ProcessingCodeunitID@1002 : Integer;RuleNo@1008 : Integer;Action@1003 : ',Custom,Post,Invoice,Ship,Receive');
    VAR
      ConfigTableProcessingRule@1006 : Record 8631;
    BEGIN
      ConfigTableProcessingRule.INIT;
      ConfigTableProcessingRule."Package Code" := PackageCode;
      ConfigTableProcessingRule."Table ID" := TableID;
      ConfigTableProcessingRule."Rule No." := RuleNo;
      ConfigTableProcessingRule.Action := Action;
      ConfigTableProcessingRule."Custom Processing Codeunit ID" := ProcessingCodeunitID;
      IF NOT ConfigTableProcessingRule.INSERT THEN
        ConfigTableProcessingRule.MODIFY;
    END;

    BEGIN
    {
      // THIS IS NOT DEMODATA RELATED IT IS USED FOR IMPORTING CUSTOMER DATA

      This is designed for customers migrating from an another ERP solution to Dynamics 365.
      The package is defined to allow partners to populate the package with the customerÂs
      data and pull that data into Dynamics 365. This package is not DemoData related.
    }
    END.
  }
}

