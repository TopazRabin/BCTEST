OBJECT Codeunit 14002397 E.D.I. Map Comments
{
  OBJECT-PROPERTIES
  {
    Date=03/21/17;
    Time=12:00:00 PM;
    Version List=SE0.60.13;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {

    PROCEDURE MapSalesCommentLine@1240020000(EDIRecDocHdr@1240020015 : Record 14002358;SalesHdr@1240020016 : Record 36;SalesLine@1240020025 : Record 37;New@1240020017 : Boolean;CurrentEDIRecDocField@1240020022 : Record 14002359;Header@1240020024 : Boolean);
    VAR
      SalesHeader@1240020001 : Record 36;
      EDIRecDocField@1240020018 : Record 14002359;
      EDIRecDocField2@1240020014 : Record 14002359;
      SalesCommentLine@1240020019 : Record 44;
      EDILocalization@1240020020 : Codeunit 14002390;
      LineNo@1240020000 : Integer;
      LastComment@1240020002 : ARRAY [30] OF Text[80];
      PrintOnQuote@1240020003 : Boolean;
      PrintOnPickTicket@1240020004 : Boolean;
      PrintOnOrderConfirmation@1240020005 : Boolean;
      PrintOnShipment@1240020006 : Boolean;
      PrintOnInvoice@1240020007 : Boolean;
      PrintOnCreditMemo@1240020008 : Boolean;
      PrintOnReturnReceipt@1240020010 : Boolean;
      PrintOnReturnAuthorization@1240020011 : Boolean;
      IncludeInEmail@1240020009 : Boolean;
      LastCode@1240020012 : Code[80];
      UseTrigger@1240020013 : Boolean;
      i@1240020021 : Integer;
    BEGIN
      EDIRecDocField.RESET;
      EDIRecDocField.SETCURRENTKEY("Internal Doc. No.","NAV Table No.","Nav Field No.");
      EDIRecDocField.SETRANGE("Internal Doc. No.",EDIRecDocHdr."Internal Doc. No.");
      IF Header THEN
        EDIRecDocField.SETRANGE("NAV Table No.",DATABASE::"Sales Comment Line")
      ELSE
        EDIRecDocField.SETRANGE("NAV Table No.",10044);
      EDIRecDocField.SETRANGE("Segment Group",CurrentEDIRecDocField."Segment Group");
      IF EDIRecDocField.FIND('-') THEN BEGIN
        UseTrigger := FALSE;
        EDIRecDocField.RESET;
        EDIRecDocField.SETRANGE("Internal Doc. No.",EDIRecDocHdr."Internal Doc. No.");
        IF Header THEN
          EDIRecDocField.SETRANGE("NAV Table No.",DATABASE::"Sales Comment Line")
        ELSE
          EDIRecDocField.SETRANGE("NAV Table No.",10044);
        EDIRecDocField.SETRANGE("Segment Group",CurrentEDIRecDocField."Segment Group");
        EDIRecDocField.SETRANGE(Trigger,TRUE);
        IF EDIRecDocField.FIND('-') THEN
          UseTrigger := TRUE;
      END ELSE
        EXIT;

      EDIRecDocField.RESET;
      EDIRecDocField.SETCURRENTKEY("Internal Doc. No.","NAV Table No.","Nav Field No.");
      EDIRecDocField.SETRANGE("Internal Doc. No.",EDIRecDocHdr."Internal Doc. No.");
      IF Header THEN
        EDIRecDocField.SETRANGE("NAV Table No.",DATABASE::"Sales Comment Line")
      ELSE
        EDIRecDocField.SETRANGE("NAV Table No.",10044);
      EDIRecDocField.SETRANGE("Segment Group",CurrentEDIRecDocField."Segment Group");
      IF EDIRecDocField.FIND('-') THEN BEGIN
        LastCode := '';
        CLEAR(LastComment);
        PrintOnQuote  := FALSE;
        PrintOnCreditMemo := FALSE;
        PrintOnPickTicket := FALSE;
        PrintOnInvoice := FALSE;
        PrintOnShipment := FALSE;
        PrintOnReturnReceipt := FALSE;
        PrintOnOrderConfirmation := FALSE;
        PrintOnReturnAuthorization := FALSE;
        IncludeInEmail := FALSE;

        SalesHeader.RESET;
        IF New THEN
          SalesHeader.SETRANGE("EDI Internal Doc. No.",EDIRecDocHdr."Internal Doc. No.")
        ELSE BEGIN
          SalesHeader.SETRANGE("Document Type",SalesHdr."Document Type");
          SalesHeader.SETRANGE("No.",SalesHdr."No.");
        END;
        IF SalesHeader.FIND('-') THEN
          REPEAT
            i := 1;
            EDIRecDocField.RESET;
            EDIRecDocField.SETRANGE("Internal Doc. No.",EDIRecDocHdr."Internal Doc. No.");
            EDIRecDocField.SETRANGE("Segment Group",CurrentEDIRecDocField."Segment Group");
            IF EDIRecDocField.FIND('-') THEN
              REPEAT
                CASE EDIRecDocField."NAV Table No." OF
                  44,10044:
                    BEGIN
                      CASE EDIRecDocField."Nav Field No." OF
                        SalesCommentLine.FIELDNO(Code):
                          IF EDIRecDocField."Field Text Value" <> '' THEN
                            LastCode :=
                              LastCode +
                                EDILocalization.LoadTextFields(SalesCommentLine.Code,EDIRecDocField);
                        SalesCommentLine.FIELDNO(Comment):
                         IF EDIRecDocField."Field Text Value" <> '' THEN BEGIN
                           IF LastComment[i] <> '' THEN BEGIN
                             IF (NOT EDIRecDocField."Append to Field Contents") AND
                                (NOT EDIRecDocField."Insert into Field Contents")
                             THEN
                               i := i + 1;
                           END;
                           LastComment[i] :=
                             LastComment[i] +
                               EDILocalization.LoadTextFields(SalesCommentLine.Comment,EDIRecDocField);
                          END;
                        SalesCommentLine.FIELDNO("Print On Quote"):
                          IF EDIRecDocField."Field Text Value" = 'TRUE' THEN
                            PrintOnQuote := TRUE
                          ELSE
                            PrintOnQuote := FALSE;
                        SalesCommentLine.FIELDNO("Print On Credit Memo"):
                          IF EDIRecDocField."Field Text Value" = 'TRUE' THEN
                            PrintOnCreditMemo := TRUE
                          ELSE
                            PrintOnCreditMemo := FALSE;
                        SalesCommentLine.FIELDNO("Include in E-Mail"):
                          IF EDIRecDocField."Field Text Value" = 'TRUE' THEN
                            IncludeInEmail := TRUE
                          ELSE
                            IncludeInEmail := FALSE;
                        SalesCommentLine.FIELDNO("Print On Pick Ticket"):
                          IF EDIRecDocField."Field Text Value" = 'TRUE' THEN
                            PrintOnPickTicket := TRUE
                          ELSE
                            PrintOnPickTicket := FALSE;
                        SalesCommentLine.FIELDNO("Print On Invoice"):
                          IF EDIRecDocField."Field Text Value" = 'TRUE' THEN
                            PrintOnInvoice := TRUE
                          ELSE
                            PrintOnInvoice := FALSE;
                        SalesCommentLine.FIELDNO("Print On Shipment"):
                          IF EDIRecDocField."Field Text Value" = 'TRUE' THEN
                            PrintOnShipment := TRUE
                          ELSE
                            PrintOnShipment := FALSE;
                        SalesCommentLine.FIELDNO("Print On Return Receipt"):
                          IF EDIRecDocField."Field Text Value" = 'TRUE' THEN
                            PrintOnReturnReceipt := TRUE
                          ELSE
                            PrintOnReturnReceipt := FALSE;
                        SalesCommentLine.FIELDNO("Print On Return Authorization"):
                          IF EDIRecDocField."Field Text Value" = 'TRUE' THEN
                            PrintOnReturnAuthorization := TRUE
                          ELSE
                            PrintOnReturnAuthorization := FALSE;
                        SalesCommentLine.FIELDNO("Print On Order Confirmation"):
                          IF EDIRecDocField."Field Text Value" = 'TRUE' THEN
                            PrintOnOrderConfirmation := TRUE
                          ELSE
                            PrintOnOrderConfirmation := FALSE;
                      END;
                      IF (UseTrigger AND EDIRecDocField.Trigger) OR
                         ((UseTrigger = FALSE) AND (LastComment[i] <> ''))
                      THEN BEGIN
                        i := 1;
                        REPEAT
                          SalesCommentLine.RESET;
                          SalesCommentLine.SETRANGE("Document Type",SalesHeader."Document Type");
                          SalesCommentLine.SETRANGE("No.",SalesHeader."No.");
                          IF Header THEN
                            SalesCommentLine.SETRANGE("Document Line No.",0)
                          ELSE
                            SalesCommentLine.SETRANGE("Document Line No.",SalesLine."Line No.");
                          IF SalesCommentLine.FIND('+') THEN
                            LineNo := SalesCommentLine."Line No." + 10000
                          ELSE
                            LineNo := 10000;
                          SalesCommentLine.INIT;
                          SalesCommentLine."Document Type" := SalesHeader."Document Type";
                          SalesCommentLine."No." := SalesHeader."No.";
                          IF Header THEN
                            SalesCommentLine."Document Line No." := 0
                          ELSE
                            SalesCommentLine."Document Line No." := SalesLine."Line No.";
                          SalesCommentLine."Line No." := LineNo;
                          SalesCommentLine.Date := TODAY;
                          SalesCommentLine.Comment := LastComment[i];
                          IF LastCode = '' THEN
                            SalesCommentLine.Code := 'EDI'
                          ELSE
                            SalesCommentLine.Code := COPYSTR(LastCode,1,10);
                          SalesCommentLine."Print On Quote" := PrintOnQuote;
                          SalesCommentLine."Print On Credit Memo" := PrintOnCreditMemo;
                          SalesCommentLine."Print On Pick Ticket" := PrintOnPickTicket;
                          SalesCommentLine."Print On Invoice" := PrintOnInvoice;
                          SalesCommentLine."Print On Shipment" := PrintOnShipment;
                          SalesCommentLine."Print On Return Receipt" := PrintOnReturnReceipt;
                          SalesCommentLine."Print On Order Confirmation" := PrintOnOrderConfirmation;
                          SalesCommentLine."Print On Return Authorization" := PrintOnReturnAuthorization;
                          SalesCommentLine."Include in E-Mail" := IncludeInEmail;
                          SalesCommentLine.INSERT;
                          CLEAR(SalesCommentLine);
                          i := i + 1;
                        UNTIL LastComment[i] = '';
                        CLEAR(LastComment);
                        IF EDIRecDocField."Wrap Text" = TRUE THEN BEGIN
                          EDIRecDocField2.COPY(EDIRecDocField);
                          IF EDIRecDocField2.NEXT <> 0 THEN
                            IF EDIRecDocField2."Wrap Text" = FALSE THEN BEGIN
                              LastCode := '';
                              PrintOnQuote  := FALSE;
                              PrintOnCreditMemo := FALSE;
                              PrintOnPickTicket := FALSE;
                              PrintOnInvoice := FALSE;
                              PrintOnShipment := FALSE;
                              PrintOnReturnReceipt := FALSE;
                              PrintOnOrderConfirmation := FALSE;
                              PrintOnReturnAuthorization := FALSE;
                              IncludeInEmail := FALSE;
                            END;
                        END ELSE BEGIN
                          LastCode := '';
                          PrintOnQuote  := FALSE;
                          PrintOnCreditMemo := FALSE;
                          PrintOnPickTicket := FALSE;
                          PrintOnInvoice := FALSE;
                          PrintOnShipment := FALSE;
                          PrintOnReturnReceipt := FALSE;
                          PrintOnOrderConfirmation := FALSE;
                          PrintOnReturnAuthorization := FALSE;
                          IncludeInEmail := FALSE;
                        END;
                        i := 1;
                      END;
                    END;
                END;
              UNTIL EDIRecDocField.NEXT = 0;
          UNTIL SalesHeader.NEXT = 0;
      END;
    END;

    PROCEDURE MapPurchCommentLine@1240020001(EDIRecDocHdr@1240020011 : Record 14002358;PurchaseHdr@1240020012 : Record 38;PurchaseLine@1240020016 : Record 39;New@1240020013 : Boolean;CurrentEDIRecDocField@1240020014 : Record 14002359;Header@1240020015 : Boolean);
    VAR
      PurchaseHeader@1240020001 : Record 38;
      EDIRecDocField@1240020006 : Record 14002359;
      EDIRecDocField2@1240020007 : Record 14002359;
      PurchCommentLine@1240020010 : Record 43;
      EDILocalization@1240020008 : Codeunit 14002390;
      LineNo@1240020000 : Integer;
      LastCode@1240020002 : Code[80];
      LastComment@1240020003 : ARRAY [30] OF Text[80];
      IncludeInEmail@1240020004 : Boolean;
      UseTrigger@1240020005 : Boolean;
      i@1240020009 : Integer;
    BEGIN
      EDIRecDocField.RESET;
      EDIRecDocField.SETCURRENTKEY("Internal Doc. No.","NAV Table No.","Nav Field No.");
      EDIRecDocField.SETRANGE("Internal Doc. No.",EDIRecDocHdr."Internal Doc. No.");
      IF Header THEN
        EDIRecDocField.SETFILTER("NAV Table No.",'%1|%2',DATABASE::"Purch. Comment Line",10043)
      ELSE
        EDIRecDocField.SETRANGE("NAV Table No.",10043);
      EDIRecDocField.SETRANGE("Segment Group",CurrentEDIRecDocField."Segment Group");
      IF EDIRecDocField.FIND('-') THEN BEGIN
        UseTrigger := FALSE;
        EDIRecDocField.RESET;
        EDIRecDocField.SETRANGE("Internal Doc. No.",EDIRecDocHdr."Internal Doc. No.");
        IF Header THEN
          EDIRecDocField.SETFILTER("NAV Table No.",'%1|%2',DATABASE::"Purch. Comment Line",10043)
        ELSE
          EDIRecDocField.SETRANGE("NAV Table No.",10043);
        EDIRecDocField.SETRANGE("Segment Group",CurrentEDIRecDocField."Segment Group");
        EDIRecDocField.SETRANGE(Trigger,TRUE);
        IF EDIRecDocField.FIND('-') THEN
          UseTrigger := TRUE;
      END ELSE
        EXIT;

      EDIRecDocField.RESET;
      EDIRecDocField.SETCURRENTKEY("Internal Doc. No.","NAV Table No.","Nav Field No.");
      EDIRecDocField.SETRANGE("Internal Doc. No.",EDIRecDocHdr."Internal Doc. No.");
      IF Header THEN
        EDIRecDocField.SETFILTER("NAV Table No.",'%1|%2',DATABASE::"Purch. Comment Line",10043)
      ELSE
        EDIRecDocField.SETRANGE("NAV Table No.",10043);
      EDIRecDocField.SETRANGE("Segment Group",CurrentEDIRecDocField."Segment Group");
      IF EDIRecDocField.FIND('-') THEN BEGIN
        LastCode := '';
        CLEAR(LastComment);
        IncludeInEmail := FALSE;

        PurchaseHeader.RESET;
        IF New THEN
          PurchaseHeader.SETRANGE("EDI Internal Doc. No.",EDIRecDocHdr."Internal Doc. No.")
        ELSE BEGIN
          PurchaseHeader.SETRANGE("Document Type",PurchaseHdr."Document Type");
          PurchaseHeader.SETRANGE("No.",PurchaseHdr."No.");
        END;
        IF PurchaseHeader.FIND('-') THEN
          REPEAT
            i := 1;
            EDIRecDocField.RESET;
            EDIRecDocField.SETRANGE("Internal Doc. No.",EDIRecDocHdr."Internal Doc. No.");
            EDIRecDocField.SETRANGE("Segment Group",CurrentEDIRecDocField."Segment Group");
            IF EDIRecDocField.FIND('-') THEN
              REPEAT
                CASE EDIRecDocField."NAV Table No." OF
                  43,10043:
                    BEGIN
                      CASE EDIRecDocField."Nav Field No." OF
                        PurchCommentLine.FIELDNO(Code):
                         IF EDIRecDocField."Field Text Value" <> '' THEN
                           LastCode :=
                             LastCode +
                               EDILocalization.LoadTextFields(PurchCommentLine.Code,EDIRecDocField);
                        PurchCommentLine.FIELDNO(Comment):
                         IF EDIRecDocField."Field Text Value" <> '' THEN BEGIN
                           IF LastComment[i] <> '' THEN BEGIN
                             IF (NOT EDIRecDocField."Append to Field Contents") AND
                                (NOT EDIRecDocField."Insert into Field Contents")
                             THEN
                               i := i + 1;
                           END;
                           LastComment[i] :=
                             LastComment[i] +
                               EDILocalization.LoadTextFields(PurchCommentLine.Comment,EDIRecDocField);
                        END;
                        PurchCommentLine.FIELDNO("Include in E-Mail"):
                          IF EDIRecDocField."Field Text Value" = 'TRUE' THEN
                            IncludeInEmail := TRUE
                          ELSE
                            IncludeInEmail := FALSE;
                      END;
                      IF (UseTrigger AND EDIRecDocField.Trigger) OR
                         ((UseTrigger = FALSE) AND (LastComment[i] <> ''))
                      THEN BEGIN
                        i := 1;
                        REPEAT
                          PurchCommentLine.RESET;
                          PurchCommentLine.SETRANGE("Document Type",PurchaseHeader."Document Type");
                          PurchCommentLine.SETRANGE("No.",PurchaseHeader."No.");
                          IF Header THEN
                            PurchCommentLine.SETRANGE("Document Line No.",0)
                          ELSE
                            PurchCommentLine.SETRANGE("Document Line No.",PurchaseLine."Line No.");
                          IF PurchCommentLine.FIND('+') THEN
                            LineNo := PurchCommentLine."Line No." + 10000
                          ELSE
                            LineNo := 10000;
                          PurchCommentLine.INIT;
                          PurchCommentLine."Document Type" := PurchaseHeader."Document Type";
                          PurchCommentLine."No." := PurchaseHeader."No.";
                          PurchCommentLine."Line No." := LineNo;
                          IF Header THEN
                            PurchCommentLine."Document Line No." := 0
                          ELSE
                            PurchCommentLine."Document Line No." := PurchaseLine."Line No.";
                          PurchCommentLine.Date := TODAY;
                          PurchCommentLine.Comment := LastComment[i];
                          IF LastCode = '' THEN
                            PurchCommentLine.Code := 'EDI'
                          ELSE
                            PurchCommentLine.Code := COPYSTR(LastCode,1,10);
                          PurchCommentLine."Include in E-Mail" := IncludeInEmail;
                          PurchCommentLine.INSERT;
                          CLEAR(PurchCommentLine);
                          i := i + 1;
                        UNTIL LastComment[i] = '';
                        CLEAR(LastComment);
                        IF EDIRecDocField."Wrap Text" = TRUE THEN BEGIN
                          EDIRecDocField2.COPY(EDIRecDocField);
                          IF EDIRecDocField2.NEXT <> 0 THEN
                            IF EDIRecDocField2."Wrap Text" = FALSE THEN BEGIN
                              LastCode := '';
                              IncludeInEmail := FALSE;
                            END;
                        END ELSE BEGIN
                          LastCode := '';
                          IncludeInEmail := FALSE;
                        END;
                        i := 1;
                      END;
                    END;
                END;
              UNTIL EDIRecDocField.NEXT = 0;
          UNTIL PurchaseHeader.NEXT = 0;
      END;
    END;

    PROCEDURE MapInvtCommentLine@1240020002(EDIRecDocHdr@1240020006 : Record 14002358;TransHdr@1240020007 : Record 5740;New@1240020008 : Boolean);
    VAR
      TransferHdr@1240020001 : Record 5740;
      EDIRecDocField@1240020010 : Record 14002359;
      EDIRecDocField2@1240020011 : Record 14002359;
      InventoryCommentLine@1240020009 : Record 5748;
      EDILocalization@1240020005 : Codeunit 14002390;
      LineNo@1240020000 : Integer;
      UseTrigger@1240020002 : Boolean;
      LastCode@1240020004 : Code[80];
      LastComment@1240020003 : ARRAY [30] OF Text[80];
      i@1240020012 : Integer;
    BEGIN
      EDIRecDocField.RESET;
      EDIRecDocField.SETCURRENTKEY("Internal Doc. No.","NAV Table No.","Nav Field No.");
      EDIRecDocField.SETRANGE("Internal Doc. No.",EDIRecDocHdr."Internal Doc. No.");
      EDIRecDocField.SETRANGE("NAV Table No.",DATABASE::"Inventory Comment Line");
      IF EDIRecDocField.FIND('-') THEN BEGIN
        UseTrigger := FALSE;
        EDIRecDocField.RESET;
        EDIRecDocField.SETRANGE("Internal Doc. No.",EDIRecDocHdr."Internal Doc. No.");
        EDIRecDocField.SETRANGE("NAV Table No.",DATABASE::"Inventory Comment Line");
        EDIRecDocField.SETRANGE(Trigger,TRUE);
        IF EDIRecDocField.FIND('-') THEN
          UseTrigger := TRUE;
      END ELSE
        EXIT;

      EDIRecDocField.RESET;
      EDIRecDocField.SETCURRENTKEY("Internal Doc. No.","NAV Table No.","Nav Field No.");
      EDIRecDocField.SETRANGE("Internal Doc. No.",EDIRecDocHdr."Internal Doc. No.");
      EDIRecDocField.SETRANGE("NAV Table No.",DATABASE::"Inventory Comment Line");
      IF EDIRecDocField.FIND('-') THEN BEGIN
        LastCode := '';
        CLEAR(LastComment);

        TransferHdr.RESET;
        IF New THEN
          TransferHdr.SETRANGE("EDI Internal Doc. No.",EDIRecDocHdr."Internal Doc. No.")
        ELSE
          TransferHdr.SETRANGE("No.",TransHdr."No.");
        IF TransferHdr.FIND('-') THEN
          REPEAT
            IF New THEN BEGIN
              InventoryCommentLine.RESET;
              InventoryCommentLine.SETRANGE("Document Type",InventoryCommentLine."Document Type"::"Transfer Order");
              InventoryCommentLine.SETRANGE("No.",TransferHdr."No.");
              InventoryCommentLine.DELETEALL;
            END;

            i := 1;
            EDIRecDocField.RESET;
            EDIRecDocField.SETRANGE("Internal Doc. No.",EDIRecDocHdr."Internal Doc. No.");
            IF EDIRecDocField.FIND('-') THEN
              REPEAT
                CASE EDIRecDocField."NAV Table No." OF
                  DATABASE::"Inventory Comment Line":
                    BEGIN
                      CASE EDIRecDocField."Nav Field No." OF
                        InventoryCommentLine.FIELDNO(Code):
                         IF EDIRecDocField."Field Text Value" <> '' THEN
                           LastCode :=
                             LastCode +
                               EDILocalization.LoadTextFields(InventoryCommentLine.Code,EDIRecDocField);
                        InventoryCommentLine.FIELDNO(Comment):
                         IF EDIRecDocField."Field Text Value" <> '' THEN BEGIN
                           IF LastComment[i] <> '' THEN BEGIN
                             IF (NOT EDIRecDocField."Append to Field Contents") AND
                                (NOT EDIRecDocField."Insert into Field Contents")
                             THEN
                               i := i + 1;
                           END;
                           LastComment[i] :=
                             LastComment[i] +
                               EDILocalization.LoadTextFields(InventoryCommentLine.Comment,EDIRecDocField);
                         END;
                      END;
                      IF (UseTrigger AND EDIRecDocField.Trigger) OR
                         ((UseTrigger = FALSE) AND (LastComment[i] <> ''))
                      THEN BEGIN
                        i := 1;
                        REPEAT
                          InventoryCommentLine.RESET;
                          InventoryCommentLine.SETRANGE(
                            "Document Type",InventoryCommentLine."Document Type"::"Transfer Order");
                          InventoryCommentLine.SETRANGE("No.",TransferHdr."No.");
                          IF InventoryCommentLine.FIND('+') THEN
                            LineNo := InventoryCommentLine."Line No." + 10000
                          ELSE
                            LineNo := 10000;
                          InventoryCommentLine.INIT;
                          InventoryCommentLine."Document Type" :=
                            InventoryCommentLine."Document Type"::"Transfer Order";
                          InventoryCommentLine."No." := TransferHdr."No.";
                          InventoryCommentLine."Line No." := LineNo;
                          InventoryCommentLine.Date := TODAY;
                          InventoryCommentLine.Comment := LastComment[i];
                          IF LastCode = '' THEN
                            InventoryCommentLine.Code := 'EDI'
                          ELSE
                            InventoryCommentLine.Code := COPYSTR(LastCode,1,10);
                          InventoryCommentLine.INSERT;
                          CLEAR(InventoryCommentLine);
                          i := i + 1;
                        UNTIL LastComment[i] = '';
                        CLEAR(LastComment);
                        IF EDIRecDocField."Wrap Text" = TRUE THEN BEGIN
                          EDIRecDocField2.COPY(EDIRecDocField);
                          IF EDIRecDocField2.NEXT <> 0 THEN
                            IF EDIRecDocField2."Wrap Text" = FALSE THEN BEGIN
                              LastCode := '';
                            END;
                        END ELSE BEGIN
                          LastCode := '';
                        END;
                        i := 1;
                      END;
                    END;
                END;
              UNTIL EDIRecDocField.NEXT = 0;
          UNTIL TransferHdr.NEXT = 0;
      END;
    END;

    PROCEDURE MapSalesCommentLine1@1000000000(EDIRecDocHdr@1240020015 : Record 14002358;SalesHdr@1240020016 : Record 36;SalesLine@1240020025 : Record 37;New@1240020017 : Boolean;CurrentEDIRecDocField@1240020022 : Record 14002359;Header@1240020024 : Boolean);
    VAR
      SalesHeader@1240020001 : Record 36;
      EDIRecDocField@1240020018 : Record 14002359;
      EDIRecDocField2@1240020014 : Record 14002359;
      SalesCommentLine@1240020019 : Record 44;
      EDILocalization@1240020020 : Codeunit 14002390;
      LineNo@1240020000 : Integer;
      LastComment@1240020002 : ARRAY [30] OF Text[80];
      PrintOnQuote@1240020003 : Boolean;
      PrintOnPickTicket@1240020004 : Boolean;
      PrintOnOrderConfirmation@1240020005 : Boolean;
      PrintOnShipment@1240020006 : Boolean;
      PrintOnInvoice@1240020007 : Boolean;
      PrintOnCreditMemo@1240020008 : Boolean;
      PrintOnReturnReceipt@1240020010 : Boolean;
      PrintOnReturnAuthorization@1240020011 : Boolean;
      IncludeInEmail@1240020009 : Boolean;
      LastCode@1240020012 : Code[80];
      UseTrigger@1240020013 : Boolean;
      i@1240020021 : Integer;
    BEGIN
      EDIRecDocField.RESET;
      EDIRecDocField.SETCURRENTKEY("Internal Doc. No.","NAV Table No.","Nav Field No.");
      EDIRecDocField.SETRANGE("Internal Doc. No.",EDIRecDocHdr."Internal Doc. No.");
      EDIRecDocField.SETRANGE("Segment Group",CurrentEDIRecDocField."Segment Group");
      IF Header THEN
      EDIRecDocField.SETFILTER("NAV Table No.",'%1|%2',DATABASE::"Sales Comment Line",10044);
      EDIRecDocField.SETRANGE("Segment Group",CurrentEDIRecDocField."Segment Group");
      IF EDIRecDocField.FIND('-') THEN BEGIN
        UseTrigger := FALSE;
        EDIRecDocField.RESET;
        EDIRecDocField.SETRANGE("Internal Doc. No.",EDIRecDocHdr."Internal Doc. No.");
        IF Header THEN
          EDIRecDocField.SETFILTER("NAV Table No.",'%1|%2',DATABASE::"Sales Comment Line",10044);
        EDIRecDocField.SETRANGE("Segment Group",CurrentEDIRecDocField."Segment Group");
        EDIRecDocField.SETRANGE(Trigger,TRUE);
        IF EDIRecDocField.FIND('-') THEN
          UseTrigger := TRUE;
      END ELSE
        EXIT;

      EDIRecDocField.RESET;
      EDIRecDocField.SETCURRENTKEY("Internal Doc. No.","NAV Table No.","Nav Field No.");
      EDIRecDocField.SETRANGE("Internal Doc. No.",EDIRecDocHdr."Internal Doc. No.");
      IF Header THEN
          EDIRecDocField.SETFILTER("NAV Table No.",'%1|%2',DATABASE::"Sales Comment Line",10044);
      EDIRecDocField.SETRANGE("Segment Group",CurrentEDIRecDocField."Segment Group");
      IF EDIRecDocField.FIND('-') THEN BEGIN
        LastCode := '';
        CLEAR(LastComment);
        PrintOnQuote  := FALSE;
        PrintOnCreditMemo := FALSE;
        PrintOnPickTicket := FALSE;
        PrintOnInvoice := FALSE;
        PrintOnShipment := FALSE;
        PrintOnReturnReceipt := FALSE;
        PrintOnOrderConfirmation := FALSE;
        PrintOnReturnAuthorization := FALSE;
        IncludeInEmail := FALSE;

        SalesHeader.RESET;
        IF New THEN
          SalesHeader.SETRANGE("EDI Internal Doc. No.",EDIRecDocHdr."Internal Doc. No.")
        ELSE BEGIN
          SalesHeader.SETRANGE("Document Type",SalesHdr."Document Type");
          SalesHeader.SETRANGE("No.",SalesHdr."No.");
        END;
        IF SalesHeader.FIND('-') THEN
          REPEAT
            i := 1;
            EDIRecDocField.RESET;
            EDIRecDocField.SETRANGE("Internal Doc. No.",EDIRecDocHdr."Internal Doc. No.");
            EDIRecDocField.SETRANGE("Segment Group",CurrentEDIRecDocField."Segment Group");
            EDIRecDocField.SETRANGE("Field Name",'Comment');
            IF EDIRecDocField.FIND('-') THEN
              REPEAT
                CASE EDIRecDocField."NAV Table No." OF
                  44,10044:
                    BEGIN
                      CASE EDIRecDocField."Nav Field No." OF
                        SalesCommentLine.FIELDNO(Code):
                          IF EDIRecDocField."Field Text Value" <> '' THEN
                            LastCode :=
                              LastCode +
                                EDILocalization.LoadTextFields(SalesCommentLine.Code,EDIRecDocField);
                        SalesCommentLine.FIELDNO(Comment):
                         IF EDIRecDocField."Field Text Value" <> '' THEN BEGIN
                           IF LastComment[i] <> '' THEN BEGIN
                             IF (NOT EDIRecDocField."Append to Field Contents") AND
                                (NOT EDIRecDocField."Insert into Field Contents")
                             THEN
                               i := i + 1;
                           END;
                           LastComment[i] :=
                             LastComment[i] +
                               EDILocalization.LoadTextFields(SalesCommentLine.Comment,EDIRecDocField);
                          END;
                        SalesCommentLine.FIELDNO("Print On Quote"):
                          IF EDIRecDocField."Field Text Value" = 'TRUE' THEN
                            PrintOnQuote := TRUE
                          ELSE
                            PrintOnQuote := FALSE;
                        SalesCommentLine.FIELDNO("Print On Credit Memo"):
                          IF EDIRecDocField."Field Text Value" = 'TRUE' THEN
                            PrintOnCreditMemo := TRUE
                          ELSE
                            PrintOnCreditMemo := FALSE;
                        SalesCommentLine.FIELDNO("Include in E-Mail"):
                          IF EDIRecDocField."Field Text Value" = 'TRUE' THEN
                            IncludeInEmail := TRUE
                          ELSE
                            IncludeInEmail := FALSE;
                        SalesCommentLine.FIELDNO("Print On Pick Ticket"):
                          IF EDIRecDocField."Field Text Value" = 'TRUE' THEN
                            PrintOnPickTicket := TRUE
                          ELSE
                            PrintOnPickTicket := FALSE;
                        SalesCommentLine.FIELDNO("Print On Invoice"):
                          IF EDIRecDocField."Field Text Value" = 'TRUE' THEN
                            PrintOnInvoice := TRUE
                          ELSE
                            PrintOnInvoice := FALSE;
                        SalesCommentLine.FIELDNO("Print On Shipment"):
                          IF EDIRecDocField."Field Text Value" = 'TRUE' THEN
                            PrintOnShipment := TRUE
                          ELSE
                            PrintOnShipment := FALSE;
                        SalesCommentLine.FIELDNO("Print On Return Receipt"):
                          IF EDIRecDocField."Field Text Value" = 'TRUE' THEN
                            PrintOnReturnReceipt := TRUE
                          ELSE
                            PrintOnReturnReceipt := FALSE;
                        SalesCommentLine.FIELDNO("Print On Return Authorization"):
                          IF EDIRecDocField."Field Text Value" = 'TRUE' THEN
                            PrintOnReturnAuthorization := TRUE
                          ELSE
                            PrintOnReturnAuthorization := FALSE;
                        SalesCommentLine.FIELDNO("Print On Order Confirmation"):
                          IF EDIRecDocField."Field Text Value" = 'TRUE' THEN
                            PrintOnOrderConfirmation := TRUE
                          ELSE
                            PrintOnOrderConfirmation := FALSE;
                      END;
                      IF (UseTrigger AND EDIRecDocField.Trigger) OR
                         ((UseTrigger = FALSE) AND (LastComment[i] <> ''))
                      THEN BEGIN
                        i := 1;
                        REPEAT
                          SalesCommentLine.RESET;
                          SalesCommentLine.SETRANGE("Document Type",SalesHeader."Document Type");
                          SalesCommentLine.SETRANGE("No.",SalesHeader."No.");
                          IF Header THEN
                            SalesCommentLine.SETRANGE("Document Line No.",0)
                          ELSE
                            SalesCommentLine.SETRANGE("Document Line No.",SalesLine."Line No.");
                          IF SalesCommentLine.FIND('+') THEN
                            LineNo := SalesCommentLine."Line No." + 10000
                          ELSE
                            LineNo := 10000;
                          SalesCommentLine.INIT;
                          SalesCommentLine."Document Type" := SalesHeader."Document Type";
                          SalesCommentLine."No." := SalesHeader."No.";
                          IF Header THEN
                            SalesCommentLine."Document Line No." := 0
                          ELSE
                            SalesCommentLine."Document Line No." := SalesLine."Line No.";
                          SalesCommentLine."Line No." := LineNo;
                          SalesCommentLine.Date := TODAY;
                          SalesCommentLine.Comment := LastComment[i];
                          IF LastCode = '' THEN
                            SalesCommentLine.Code := 'EDI'
                          ELSE
                            SalesCommentLine.Code := COPYSTR(LastCode,1,10);
                          SalesCommentLine."Print On Quote" := PrintOnQuote;
                          SalesCommentLine."Print On Credit Memo" := PrintOnCreditMemo;
                          SalesCommentLine."Print On Pick Ticket" := PrintOnPickTicket;
                          SalesCommentLine."Print On Invoice" := PrintOnInvoice;
                          SalesCommentLine."Print On Shipment" := PrintOnShipment;
                          SalesCommentLine."Print On Return Receipt" := PrintOnReturnReceipt;
                          SalesCommentLine."Print On Order Confirmation" := PrintOnOrderConfirmation;
                          SalesCommentLine."Print On Return Authorization" := PrintOnReturnAuthorization;
                          SalesCommentLine."Include in E-Mail" := IncludeInEmail;
                          SalesCommentLine.INSERT;
                          CLEAR(SalesCommentLine);
                          i := i + 1;
                        UNTIL LastComment[i] = '';
                        CLEAR(LastComment);
                        IF EDIRecDocField."Wrap Text" = TRUE THEN BEGIN
                          EDIRecDocField2.COPY(EDIRecDocField);
                          IF EDIRecDocField2.NEXT <> 0 THEN
                            IF EDIRecDocField2."Wrap Text" = FALSE THEN BEGIN
                              LastCode := '';
                              PrintOnQuote  := FALSE;
                              PrintOnCreditMemo := FALSE;
                              PrintOnPickTicket := FALSE;
                              PrintOnInvoice := FALSE;
                              PrintOnShipment := FALSE;
                              PrintOnReturnReceipt := FALSE;
                              PrintOnOrderConfirmation := FALSE;
                              PrintOnReturnAuthorization := FALSE;
                              IncludeInEmail := FALSE;
                            END;
                        END ELSE BEGIN
                          LastCode := '';
                          PrintOnQuote  := FALSE;
                          PrintOnCreditMemo := FALSE;
                          PrintOnPickTicket := FALSE;
                          PrintOnInvoice := FALSE;
                          PrintOnShipment := FALSE;
                          PrintOnReturnReceipt := FALSE;
                          PrintOnOrderConfirmation := FALSE;
                          PrintOnReturnAuthorization := FALSE;
                          IncludeInEmail := FALSE;
                        END;
                        i := 1;
                      END;
                    END;
                END;
              UNTIL EDIRecDocField.NEXT = 0;
          UNTIL SalesHeader.NEXT = 0;
      END;
    END;

    BEGIN
    {
      TPZ2294 DKUMAR 05-11-2018
        Added new Function MapSalesCommentLine1
    }
    END.
  }
}

