OBJECT Codeunit 50096 Insert Item Cross ref
{
  OBJECT-PROPERTIES
  {
    Date=07/01/20;
    Time=12:00:00 AM;
    Modified=Yes;
    Version List=TPZ000.00.00;
  }
  PROPERTIES
  {
    OnRun=BEGIN
            itemcrossref.RESET;
            itemcrossref.MODIFYALL(Processed,FALSE);
            IF itemcrossref.FINDSET THEN REPEAT
              ItemCrossReference.RESET;
              ItemCrossReference.SETRANGE("Item No.",itemcrossref."Item No");
              ItemCrossReference.SETRANGE("Cross-Reference Type",ItemCrossReference."Cross-Reference Type"::Customer);
              ItemCrossReference.SETRANGE("Cross-Reference Type No.",itemcrossref."Cross-Reference Type No.");
              ItemCrossReference.SETRANGE("Cross-Reference No.",itemcrossref."Cross-Reference No.");
              IF ItemCrossReference.FINDFIRST THEN BEGIN
                itemcrossref.Processed := TRUE;
                itemcrossref.MODIFY;
              END ELSE BEGIN
                IF Item.GET(itemcrossref."Item No") THEN BEGIN
                  ItemCrossReference.INIT;
                  ItemCrossReference.VALIDATE("Item No.",itemcrossref."Item No");
                  ItemCrossReference.VALIDATE("Unit of Measure",'PCS');
                  ItemCrossReference.VALIDATE("Cross-Reference Type",ItemCrossReference."Cross-Reference Type"::Customer);
                  ItemCrossReference.VALIDATE("Cross-Reference Type No.",itemcrossref."Cross-Reference Type No.");
                  ItemCrossReference.VALIDATE("Cross-Reference No.",itemcrossref."Cross-Reference No.");
                  ItemCrossReference.INSERT(TRUE);
                  itemcrossref.Processed := TRUE;
                  itemcrossref.MODIFY;
                END;
              END;
            UNTIL itemcrossref.NEXT = 0;
            MESSAGE('done');
          END;

  }
  CODE
  {
    VAR
      ItemCrossReference@1000000000 : Record 5717;
      Item@1000000001 : Record 27;
      itemcrossref@1000000002 : Record 50058;

    BEGIN
    END.
  }
}

