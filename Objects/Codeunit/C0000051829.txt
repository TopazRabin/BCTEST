OBJECT Codeunit 51829 Page7002EventSubscriber
{
  OBJECT-PROPERTIES
  {
    Date=09/10/20;
    Time=11:13:32 AM;
    Modified=Yes;
    Version List=NAVEVT0.0.0;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {

    [EventSubscriber(Page,7002,OnBeforeActionEvent,"Copy Sales Prices from Other Account")]
    LOCAL PROCEDURE Pg7002_SalesPriceFromAnotherAcc_OnBeforeActionEvent@1000000000(VAR Rec@1000000000 : Record 7002);
    VAR
      SalesPrices@1000000002 : Record 7002;
      CopySalesPrices@1000000001 : Report 50076;
    BEGIN
      //<TPZ2861>
      //<TPZ2076>
      CLEAR(CopySalesPrices);
      CopySalesPrices.SetCusFilter(Rec."Sales Code");
      CopySalesPrices.RUN;
      //</TPZ2076>
      //</TPZ2861>
    END;

    [EventSubscriber(Page,7002,OnBeforeActionEvent,Action1000000011)]
    LOCAL PROCEDURE Pg7002_CLE_OnBeforeActionEvent@1000000002(VAR Rec@1000000000 : Record 7002);
    VAR
      ChangeLogEntry@1000000002 : Record 405;
      Number@1000000001 : Integer;
    BEGIN
      //<TPZ2861>
      WITH Rec DO BEGIN
      // <TPZ129>
      Number := "Sales Type";
      ChangeLogEntry.RESET;
      ChangeLogEntry.SETRANGE("Table No.",DATABASE::"Sales Price");
      ChangeLogEntry.SETRANGE("Primary Key Field 1 Value","Item No.");
      ChangeLogEntry.SETRANGE("Primary Key Field 2 Value",FORMAT(Number));
      ChangeLogEntry.SETRANGE("Primary Key Field 3 Value","Sales Code");
      PAGE.RUNMODAL(PAGE::"Change Log Entries",ChangeLogEntry);
      // </TPZ129>
      END;
      //</TPZ2861>
    END;

    BEGIN
    {
      TPZ2861 RSAH 05192020
        - Event Conversion
    }
    END.
  }
}

