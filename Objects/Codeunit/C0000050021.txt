OBJECT Codeunit 50021 Kill Inactive Session Job
{
  OBJECT-PROPERTIES
  {
    Date=07/01/20;
    Time=12:00:00 AM;
    Modified=Yes;
    Version List=TPZ000.00.00;
  }
  PROPERTIES
  {
    OnRun=VAR
            ActiveSession@1000000000 : Record 2000000110;
            CalendarMgt@1000000002 : Codeunit 7600;
            IdleCutOffDateTime@1000000003 : DateTime;
          BEGIN
            //Kill Windows Client Session that have login 6 hrs ago.
            IdleCutOffDateTime := CURRENTDATETIME - (6*60*60*1000); // 6 hrs. in miliseconds.

            ActiveSession.SETRANGE("Client Type", ActiveSession."Client Type"::"Windows Client");
            ActiveSession.SETFILTER("Login Datetime", '<=%1', IdleCutOffDateTime);
            IF ActiveSession.FINDSET THEN
            REPEAT
             STOPSESSION(ActiveSession."Session ID");
            UNTIL ActiveSession.NEXT = 0;
          END;

  }
  CODE
  {

    BEGIN
    {
      TPZ1691 2016-09-16 TMEI
        Create codeunit to be run by NAS Job Scheduler
    }
    END.
  }
}

