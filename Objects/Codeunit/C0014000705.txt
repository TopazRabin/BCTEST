OBJECT Codeunit 14000705 Fast Pack
{
  OBJECT-PROPERTIES
  {
    Date=06/28/17;
    Time=12:00:00 PM;
    Version List=SE0.53.08;
  }
  PROPERTIES
  {
    OnRun=BEGIN
            ShippingSetup.GET;

            REPEAT
              PackingControl."Source Type" := 0;
              PackingControl."Source Subtype" := 0;
              IF NOT ShippingSetup.SelectSourceType(
                       PackingControl."Source Type",PackingControl."Source Subtype")
              THEN
                EXIT;

              CASE PackingControl."Source Type" OF
                DATABASE::"Sales Header":
                  BEGIN
                    SalesHeader.RESET;
                    SalesHeader.SETRANGE("Document Type",PackingControl."Source Subtype");
                    IF PAGE.RUNMODAL(0,SalesHeader) <> ACTION::LookupOK THEN
                      EXIT;

                    IF SalesHeader.Status = SalesHeader.Status::Released THEN BEGIN
                      FastPackLine.RESET;
                      FastPackLine.SETRANGE("Source Type",DATABASE::"Sales Header");
                      FastPackLine.SETRANGE("Source Subtype",SalesHeader."Document Type");
                      FastPackLine.SETRANGE("Source ID",SalesHeader."No.");

                      PAGE.RUNMODAL(PAGE::"Fast Pack Order",FastPackLine);
                    END ELSE
                      MESSAGE(
                        Text002,
                        PackingControl.FormatSource(
                          DATABASE::"Sales Header",SalesHeader."Document Type",SalesHeader."No."));
                  END;
                DATABASE::"Purchase Header":
                  BEGIN
                    PurchHeader.RESET;
                    PurchHeader.SETRANGE("Document Type",PackingControl."Source Subtype");
                    IF PAGE.RUNMODAL(0,PurchHeader) <> ACTION::LookupOK THEN
                      EXIT;

                    IF PurchHeader.Status = PurchHeader.Status::Released THEN BEGIN
                      FastPackLine.RESET;
                      FastPackLine.SETRANGE("Source Type",DATABASE::"Purchase Header");
                      FastPackLine.SETRANGE("Source Subtype",PurchHeader."Document Type");
                      FastPackLine.SETRANGE("Source ID",PurchHeader."No.");

                      PAGE.RUNMODAL(PAGE::"Fast Pack Order",FastPackLine);
                    END ELSE
                      MESSAGE(
                        Text002,
                        PackingControl.FormatSource(
                          DATABASE::"Purchase Header",PurchHeader."Document Type",PurchHeader."No."));
                  END;
                DATABASE::"Transfer Header":
                  BEGIN
                    TransferHeader.RESET;
                    IF PAGE.RUNMODAL(0,TransferHeader) <> ACTION::LookupOK THEN
                      EXIT;

                    IF TransferHeader.Status = TransferHeader.Status::Released THEN BEGIN
                      FastPackLine.RESET;
                      FastPackLine.SETRANGE("Source Type",DATABASE::"Transfer Header");
                      FastPackLine.SETRANGE("Source Subtype",0);
                      FastPackLine.SETRANGE("Source ID",TransferHeader."No.");

                      PAGE.RUNMODAL(PAGE::"Fast Pack Order",FastPackLine);
                    END ELSE
                      MESSAGE(
                        Text002,
                        PackingControl.FormatSource(
                          DATABASE::"Transfer Header",0,TransferHeader."No."));
                  END;
                ELSE
                  EXIT;
              END;
            UNTIL FALSE;
          END;

  }
  CODE
  {
    VAR
      ShippingSetup@1240030000 : Record 14000707;
      SalesHeader@1240030002 : Record 36;
      PurchHeader@1240030003 : Record 38;
      TransferHeader@1240030004 : Record 5740;
      FastPackLine@1240030005 : Record 14000711;
      PackingControl@1240030007 : Record 14000717;
      Text002@1240030006 : TextConst 'ENU=%1 is not released.';

    BEGIN
    END.
  }
}

