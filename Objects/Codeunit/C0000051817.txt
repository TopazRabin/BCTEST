OBJECT Codeunit 51817 Page9302EventSubscriber
{
  OBJECT-PROPERTIES
  {
    Date=10/13/21;
    Time=[ 4:56:34 AM];
    Modified=Yes;
    Version List=NAVEVT0.0.0,002;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {

    [EventSubscriber(Page,9302,OnAfterActionEvent,Action51)]
    LOCAL PROCEDURE Pg9302_TestReport_OnAfterActionEvent@1000000000(VAR Rec@1000000000 : Record 36);
    VAR
      ReportPrint1@1000000001 : Codeunit 51746;
      ReportPrint@1000000002 : Codeunit 228;
    BEGIN
      //<TPZ2861>
      //SAN-SHAIL
      //ReportPrint.PrintSalesHeader(Rec);
      ReportPrint1.PrintSalesUnpostedCM(Rec);
    END;

    [EventSubscriber(Page,9302,OnBeforeActionEvent,Action1102601017)]
    LOCAL PROCEDURE P9302_OnBeforePost_OnAction@1000000003(VAR Rec@1000000000 : Record 36);
    VAR
      Text016@1000000001 : TextConst 'ENU="%1 is required for %2 = %3.";ESM="Se requiere %1 para %2 = %3.";FRC="%1 est requis pour %2 = %3.";ENC="%1 is required for %2 = %3."';
      DialogText@1000000002 : Text;
      Location@1000000003 : Record 14;
      SalesLine@1000000004 : Record 37;
    BEGIN
      //>>001 TPZ3065
      IF Rec.Status = Rec.Status::Open THEN BEGIN
        SalesLine.RESET;
        SalesLine.SETRANGE("Document Type",Rec."Document Type"::"Credit Memo");
        SalesLine.SETRANGE("Document No.",Rec."No.");
        SalesLine.SETRANGE(Type,SalesLine.Type::Item);
        IF SalesLine.FIND('-') THEN REPEAT
          IF SalesLine."Return Receipt No." = '' THEN
            IF Location.GET(SalesLine."Location Code") AND Location."Directed Put-away and Pick" THEN BEGIN
              DialogText += Location.GetRequirementText(Location.FIELDNO("Require Receive"));
              ERROR(Text016,DialogText,'Item No.',SalesLine."No.");
            END;
        UNTIL SalesLine.NEXT = 0;
      END;
      //<<001 TPZ3065
    END;

    [Integration(TRUE)]
    PROCEDURE Pg9302_OnaftergetRecord@1000000002(VAR Rec@1000000000 : Record 36;VAR Styletxt@1000000001 : Text);
    BEGIN
      //TPZ3356
    END;

    [EventSubscriber(Codeunit,51817,Pg9302_OnaftergetRecord)]
    LOCAL PROCEDURE Pg9302_OnaftergetRecord_Subscriber@1000000006(VAR Sender@1000000000 : Codeunit 51817;VAR Rec@1000000001 : Record 36;VAR Styletxt@1000000002 : Text);
    VAR
      Customer@1000000003 : Record 18;
    BEGIN
      //<TPZ3356>
      Styletxt :='';
      WITH Rec DO BEGIN
        Customer.RESET;
        IF Customer.GET("Sell-to Customer No.") THEN
          IF Customer."Buying Group Code" = 'IMARK' THEN
            Styletxt:= 'favorable';
        END;
      //</TPZ3356>
    END;

    BEGIN
    {
      TPZ2861 RSAH 05192020
        - Event Conversion
      001 TPZ3065 RPS 02032021 - Post routine for Sales Credit Memo not working properly
      002 TPZ3356 UTK 10132021 - Created new Publisher/Subscriber for Imark Customer no. name color change.
    }
    END.
  }
}

