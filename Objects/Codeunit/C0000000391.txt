OBJECT Codeunit 391 Shipment Header - Edit
{
  OBJECT-PROPERTIES
  {
    Date=02/18/21;
    Time=[ 9:52:28 AM];
    Modified=Yes;
    Version List=NAVW111.00.00.35815;
  }
  PROPERTIES
  {
    TableNo=110;
    Permissions=TableData 110=rm;
    OnRun=BEGIN
            SalesShptHeader := Rec;
            SalesShptHeader.LOCKTABLE;
            SalesShptHeader.FIND;
            SalesShptHeader."Shipping Agent Code" := "Shipping Agent Code";
            SalesShptHeader."Shipping Agent Service Code" := "Shipping Agent Service Code";
            SalesShptHeader."Package Tracking No." := "Package Tracking No.";
            OnBeforeSalesShptHeaderModify(SalesShptHeader,Rec);
            SalesShptHeader.TESTFIELD("No.","No.");

            SalesShptHeader.MODIFY;
            Rec := SalesShptHeader;
          END;

  }
  CODE
  {
    VAR
      SalesShptHeader@1000 : Record 110;

    PROCEDURE SalesInvoiceHeaderEdit@14000701(SalesInvoiceHeader@14000700 : Record 112);
    VAR
      SalesInvoiceHeader2@14000701 : Record 112;
    BEGIN
      // >> Shipping
      SalesInvoiceHeader2 := SalesInvoiceHeader;
      SalesInvoiceHeader2.LOCKTABLE;
      SalesInvoiceHeader2.FIND;
      // <TPZ162>
      SalesInvoiceHeader2."Mail Invoice Notice Handled" :=
        SalesInvoiceHeader."Mail Invoice Notice Handled";
      SalesInvoiceHeader2."Fax Invoice Notice Handled" :=
        SalesInvoiceHeader."Fax Invoice Notice Handled";
      // </TPZ162>
      SalesInvoiceHeader2."E-Mail Invoice Notice Handled" :=
        SalesInvoiceHeader."E-Mail Invoice Notice Handled";
      SalesInvoiceHeader2."EDI Order" := SalesInvoiceHeader."EDI Order";
      SalesInvoiceHeader2."EDI Trade Partner" :=
        SalesInvoiceHeader."EDI Trade Partner";
      SalesInvoiceHeader2."Invoice for Bill of Lading No." :=
        SalesInvoiceHeader."Invoice for Bill of Lading No.";
      SalesInvoiceHeader2."Invoice for Shipment No." :=
        SalesInvoiceHeader."Invoice for Shipment No.";
      SalesInvoiceHeader2."EDI Invoice" := SalesInvoiceHeader."EDI Invoice";

      SalesInvoiceHeader2.MODIFY;
      SalesInvoiceHeader := SalesInvoiceHeader2;
      // << Shipping
    END;

    PROCEDURE BillOfLadingSalesShipmentHdr@14000702(CurrentSalesShipmentHeader@14000700 : Record 110;BillOfLadingNo@14000701 : Code[20]);
    VAR
      PostedPackage@14000702 : Record 14000704;
      BillOfLadingLine@14000703 : Record 14000823;
    BEGIN
      SalesShptHeader.GET(CurrentSalesShipmentHeader."No.");
      SalesShptHeader.VALIDATE("Bill of Lading No.",BillOfLadingNo);
      SalesShptHeader.MODIFY;

      BillOfLadingLine.LOCKTABLE;

      PostedPackage.RESET;
      PostedPackage.SETCURRENTKEY("Source Type","Source Subtype","Posted Source ID");
      PostedPackage.SETRANGE("Source Type",DATABASE::"Sales Header");
      PostedPackage.SETRANGE("Posted Source ID",CurrentSalesShipmentHeader."No.");
      PostedPackage.MODIFYALL(
        "Used on Bill of Lading No.",BillOfLadingNo,TRUE);
    END;

    PROCEDURE PurchaseReceiptHeaderEdit@14000703(PurchReceiptHeader@14000700 : Record 120);
    VAR
      PurchReceiptHeader2@14000701 : Record 120;
    BEGIN
      // >> Shipping
      PurchReceiptHeader2 := PurchReceiptHeader;
      PurchReceiptHeader2.LOCKTABLE;
      PurchReceiptHeader2.FIND;

      PurchReceiptHeader2."E-Mail Receipt Notice Handled" :=
        PurchReceiptHeader."E-Mail Receipt Notice Handled";

      PurchReceiptHeader2.MODIFY;
      PurchReceiptHeader := PurchReceiptHeader2;
      // << Shipping
    END;

    PROCEDURE PurchaseInvoiceHeaderEdit@14000704(PurchInvoiceHeader@14000700 : Record 122);
    VAR
      PurchInvoiceHeader2@14000701 : Record 122;
    BEGIN
      // >> Shipping
      PurchInvoiceHeader2 := PurchInvoiceHeader;
      PurchInvoiceHeader2.LOCKTABLE;
      PurchInvoiceHeader2.FIND;

      PurchInvoiceHeader2."E-Mail Invoice Notice Handled" :=
        PurchInvoiceHeader."E-Mail Invoice Notice Handled";
      PurchInvoiceHeader2."EDI Order" := PurchInvoiceHeader."EDI Order";

      PurchInvoiceHeader2.MODIFY;
      PurchInvoiceHeader := PurchInvoiceHeader2;
      // << Shipping
    END;

    PROCEDURE TransferShipmentHeaderEdit@1240020000(TransferShipmentHeader@14000700 : Record 5744);
    VAR
      TransferShipmentHeader2@14000701 : Record 5744;
    BEGIN
      // >> EDI
      TransferShipmentHeader2 := TransferShipmentHeader;
      TransferShipmentHeader2.LOCKTABLE;
      TransferShipmentHeader2.FIND;

      TransferShipmentHeader2."EDI Trade Partner" := TransferShipmentHeader."EDI Trade Partner";
      TransferShipmentHeader2."EDI Order" := TransferShipmentHeader."EDI Order";

      TransferShipmentHeader2.MODIFY;
      TransferShipmentHeader := TransferShipmentHeader2;
      // << EDI
    END;

    PROCEDURE BillOfLadingPurchCrMemo@14000705(CurrentPurchCrMemoHeader@14000700 : Record 124;BillOfLadingNo@14000701 : Code[20]);
    VAR
      PurchCrMemoHeader@14000702 : Record 124;
      PostedPackage@14000703 : Record 14000704;
      BillOfLadingLine@14000704 : Record 14000823;
    BEGIN
      PurchCrMemoHeader.GET(CurrentPurchCrMemoHeader."No.");
      PurchCrMemoHeader.VALIDATE("Bill of Lading No.",BillOfLadingNo);
      PurchCrMemoHeader.MODIFY;

      BillOfLadingLine.LOCKTABLE;

      PostedPackage.RESET;
      PostedPackage.SETCURRENTKEY("Source Type","Source Subtype","Posted Source ID");
      PostedPackage.SETRANGE("Source Type",DATABASE::"Purchase Header");
      PostedPackage.SETRANGE("Posted Source ID",CurrentPurchCrMemoHeader."No.");
      PostedPackage.MODIFYALL(
        "Used on Bill of Lading No.",BillOfLadingNo,TRUE);
    END;

    PROCEDURE BillOfLadingReturnShipment@14000706(CurrentReturnShipmentHeader@14000700 : Record 6650;BillOfLadingNo@14000701 : Code[20]);
    VAR
      ReturnShipmentHeader@14000702 : Record 6650;
      PostedPackage@14000703 : Record 14000704;
      BillOfLadingLine@14000704 : Record 14000823;
    BEGIN
      ReturnShipmentHeader.GET(CurrentReturnShipmentHeader."No.");
      ReturnShipmentHeader.VALIDATE("Bill of Lading No.",BillOfLadingNo);
      ReturnShipmentHeader.MODIFY;

      BillOfLadingLine.LOCKTABLE;

      PostedPackage.RESET;
      PostedPackage.SETCURRENTKEY("Source Type","Source Subtype","Posted Source ID");
      PostedPackage.SETRANGE("Source Type",DATABASE::"Purchase Header");
      PostedPackage.SETRANGE("Posted Source ID",CurrentReturnShipmentHeader."No.");
      PostedPackage.MODIFYALL(
        "Used on Bill of Lading No.",BillOfLadingNo,TRUE);
    END;

    PROCEDURE BillOfLadingTransferShipment@14000707(CurrentTransferShipmentHeader@14000700 : Record 5744;BillOfLadingNo@14000701 : Code[20]);
    VAR
      TransferShipmentHeader@14000702 : Record 5744;
      PostedPackage@14000703 : Record 14000704;
      BillOfLadingLine@14000704 : Record 14000823;
    BEGIN
      TransferShipmentHeader.GET(CurrentTransferShipmentHeader."No.");
      TransferShipmentHeader.VALIDATE("Bill of Lading No.",BillOfLadingNo);
      TransferShipmentHeader.MODIFY;

      BillOfLadingLine.LOCKTABLE;

      PostedPackage.RESET;
      PostedPackage.SETCURRENTKEY("Source Type","Source Subtype","Posted Source ID");
      PostedPackage.SETRANGE("Source Type",DATABASE::"Transfer Header");
      PostedPackage.SETRANGE("Posted Source ID",CurrentTransferShipmentHeader."No.");
      PostedPackage.MODIFYALL(
        "Used on Bill of Lading No.",BillOfLadingNo,TRUE);
    END;

    PROCEDURE SalesCrMemoHeaderEdit@1240020001(SalesCrMemoHeader@14000700 : Record 114);
    VAR
      SalesCrMemoHeader2@14000701 : Record 114;
    BEGIN
      // >> EDI
      SalesCrMemoHeader2 := SalesCrMemoHeader;
      SalesCrMemoHeader2.LOCKTABLE;
      SalesCrMemoHeader2.FIND;

      SalesCrMemoHeader2."EDI Order" := SalesCrMemoHeader."EDI Order";
      SalesCrMemoHeader2."EDI Trade Partner" :=
        SalesCrMemoHeader."EDI Trade Partner";
      // <TPZ143>
      SalesCrMemoHeader2."E-Mail Cr. Memo Notice Handled" :=
        SalesCrMemoHeader."E-Mail Cr. Memo Notice Handled";
      // </TPZ143>
      SalesCrMemoHeader2.MODIFY;
      SalesCrMemoHeader := SalesCrMemoHeader2;
      // << EDI
    END;

    PROCEDURE SalesReturnReceiptHeaderEdit@14000351(ReturnReceiptHeader@14000700 : Record 6660);
    VAR
      ReturnReceiptHeader2@14000701 : Record 6660;
    BEGIN
      // >> EDI
      ReturnReceiptHeader2 := ReturnReceiptHeader;
      ReturnReceiptHeader2.LOCKTABLE;
      ReturnReceiptHeader2.FIND;

      ReturnReceiptHeader2."EDI Order" := ReturnReceiptHeader."EDI Order";
      ReturnReceiptHeader2."EDI Trade Partner" :=
        ReturnReceiptHeader."EDI Trade Partner";

      ReturnReceiptHeader2.MODIFY;
      ReturnReceiptHeader := ReturnReceiptHeader2;
      // << EDI
    END;

    [Integration]
    LOCAL PROCEDURE OnBeforeSalesShptHeaderModify@1(VAR SalesShptHeader@1000 : Record 110;FromSalesShptHeader@1001 : Record 110);
    BEGIN
    END;

    BEGIN
    {
      2015-08-25 TPZ143 TAKHMETO
        Permisison to modify Sales Cr.Memo Header has been added
      2015-09-14 TPZ162 TAKHMETO
        Handling of mail and fax norifications has been added
    }
    END.
  }
}

