OBJECT Codeunit 14002970 Pallet Lookup Mgt.
{
  OBJECT-PROPERTIES
  {
    Date=09/01/16;
    Time=12:00:00 PM;
    Version List=RF1.50.05;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {
    VAR
      Text000@1240020001 : TextConst 'ENU=<Empty>';

    PROCEDURE PalletInBin@1240020000(VAR Lookup@1240020003 : Record 14002971;LocationCode@1240020000 : Code[20];BinCode@1240020001 : Code[20];WarehouseEmployeeCode@1240020004 : Code[50]);
    VAR
      PalletBinContent@1240020002 : Record 14002963;
      Lookup2@1240020005 : Record 14002971;
      StorageID@1240020006 : Record 14002972;
    BEGIN
      Lookup.SETRANGE("Warehouse Employee Code",WarehouseEmployeeCode);
      Lookup.DELETEALL;

      PalletBinContent.SETRANGE(Location,LocationCode);
      PalletBinContent.SETRANGE(Bin,BinCode);
      IF PalletBinContent.FINDSET THEN BEGIN
        Lookup2.SETCURRENTKEY(Pallet);
        REPEAT
          IF StorageID.GET(PalletBinContent."Pallet No.") THEN;
          Lookup2.SETRANGE("Warehouse Employee Code",WarehouseEmployeeCode);
          Lookup2.SETRANGE(Location,PalletBinContent.Location);
          Lookup2.SETRANGE(Bin,PalletBinContent.Bin);
          Lookup2.SETRANGE(Pallet,PalletBinContent."Pallet No.");
          Lookup2.SETRANGE(Item,PalletBinContent."Item No.");
          IF Lookup2.ISEMPTY THEN BEGIN
            Lookup."Warehouse Employee Code" := WarehouseEmployeeCode;
            Lookup."Line No." := Lookup."Line No." + 1;
            Lookup.Location := PalletBinContent.Location;
            Lookup.Bin := PalletBinContent.Bin;
            Lookup.Pallet := PalletBinContent."Pallet No.";
            Lookup.Box := PalletBinContent."Box No.";
            IF PalletBinContent."Item No." = '' THEN
              Lookup.Item := Text000
            ELSE
              Lookup.Item := PalletBinContent."Item No.";
            Lookup.Variant := PalletBinContent."Variant No.";
            Lookup."UOM Code" := PalletBinContent."Unit of Measure";
            Lookup.Lot :=PalletBinContent."Lot No.";
            Lookup."Serial No." := PalletBinContent."Serial No.";
            Lookup.Quantity := PalletBinContent.Quantity;
            Lookup."Quantity (Base)" := PalletBinContent."Quantity (Base)";
            Lookup."Qty per UOM" := PalletBinContent."Qty per UOM";
            Lookup."QA Status" := StorageID."QA Status";
            Lookup.INSERT;
          END;
        UNTIL PalletBinContent.NEXT = 0;
      END;
    END;

    PROCEDURE PalletWithItem@1240020001(VAR Lookup@1240020003 : Record 14002971;LocationCode@1240020000 : Code[20];ItemCode@1240020001 : Code[20];WarehouseEmployeeCode@1240020004 : Code[50]);
    VAR
      PalletBinContent@1240020002 : Record 14002963;
      Lookup2@1240020005 : Record 14002971;
      StorageID@1240020006 : Record 14002972;
    BEGIN
      Lookup.SETRANGE("Warehouse Employee Code",WarehouseEmployeeCode);
      Lookup.DELETEALL;

      PalletBinContent.SETRANGE(Location,LocationCode);
      PalletBinContent.SETRANGE("Item No.",ItemCode);
      IF PalletBinContent.FINDSET THEN BEGIN
        Lookup2.SETCURRENTKEY(Pallet);
        REPEAT
          IF StorageID.GET(PalletBinContent."Pallet No.") THEN ;
          Lookup2.SETRANGE("Warehouse Employee Code",WarehouseEmployeeCode);
          Lookup2.SETRANGE(Location,PalletBinContent.Location);
          Lookup2.SETRANGE(Bin,PalletBinContent.Bin);
          Lookup2.SETRANGE(Pallet,PalletBinContent."Pallet No.");
          IF Lookup2.ISEMPTY THEN BEGIN
            Lookup."Warehouse Employee Code" := WarehouseEmployeeCode;
            Lookup."Line No." := Lookup."Line No." + 1;
            Lookup.Location := PalletBinContent.Location;
            Lookup.Bin := PalletBinContent.Bin;
            Lookup.Pallet := PalletBinContent."Pallet No.";
            Lookup.Box := PalletBinContent."Box No.";
            IF PalletBinContent."Item No." = '' THEN
              Lookup.Item := Text000
            ELSE
              Lookup.Item := PalletBinContent."Item No.";
            Lookup.Variant := PalletBinContent."Variant No.";
            Lookup."UOM Code" := PalletBinContent."Unit of Measure";
            Lookup.Lot :=PalletBinContent."Lot No.";
            Lookup."Serial No." := PalletBinContent."Serial No.";
            Lookup.Quantity := PalletBinContent.Quantity;
            Lookup."Quantity (Base)" := PalletBinContent."Quantity (Base)";
            Lookup."Qty per UOM" := PalletBinContent."Qty per UOM";
            Lookup."QA Status" := StorageID."QA Status";
            Lookup.INSERT;
          END;
        UNTIL PalletBinContent.NEXT = 0;
      END;
    END;

    PROCEDURE ItemOnPallet@1240020002(VAR Lookup@1240020003 : Record 14002971;LocationCode@1240020000 : Code[20];PalletCode@1240020001 : Code[20];WarehouseEmployeeCode@1240020004 : Code[50]);
    VAR
      PalletBinContent@1240020002 : Record 14002963;
      Lookup2@1240020005 : Record 14002971;
    BEGIN
      Lookup.SETRANGE("Warehouse Employee Code",WarehouseEmployeeCode);
      Lookup.DELETEALL;

      PalletBinContent.SETRANGE(Location,LocationCode);
      PalletBinContent.SETRANGE("Pallet No.",PalletCode);
      IF PalletBinContent.FINDSET THEN BEGIN
        Lookup2.SETCURRENTKEY(Pallet);
        REPEAT
          Lookup2.SETRANGE("Warehouse Employee Code",WarehouseEmployeeCode);
          Lookup2.SETRANGE(Location,PalletBinContent.Location);
          Lookup2.SETRANGE(Bin,PalletBinContent.Bin);
          Lookup2.SETRANGE(Pallet,PalletBinContent."Pallet No.");
          Lookup2.SETRANGE(Item,PalletBinContent."Item No.");
          IF Lookup2.ISEMPTY THEN BEGIN
            Lookup."Warehouse Employee Code" := WarehouseEmployeeCode;
            Lookup."Line No." := Lookup."Line No." + 1;
            Lookup.Location := PalletBinContent.Location;
            Lookup.Bin := PalletBinContent.Bin;
            Lookup.Pallet := PalletBinContent."Pallet No.";
            Lookup.Box := PalletBinContent."Box No.";
            IF PalletBinContent."Item No." = '' THEN
              Lookup.Item := Text000
            ELSE
              Lookup.Item := PalletBinContent."Item No.";
            Lookup.Variant := PalletBinContent."Variant No.";
            Lookup."UOM Code" := PalletBinContent."Unit of Measure";
            Lookup.Lot :=PalletBinContent."Lot No.";
            Lookup."Serial No." := PalletBinContent."Serial No.";
            Lookup.Quantity := PalletBinContent.Quantity;
            Lookup."Quantity (Base)" := PalletBinContent."Quantity (Base)";
            Lookup."Qty per UOM" := PalletBinContent."Qty per UOM";
            Lookup.INSERT;
          END;
        UNTIL PalletBinContent.NEXT = 0;
      END;
    END;

    BEGIN
    END.
  }
}

