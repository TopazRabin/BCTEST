OBJECT Codeunit 14000379 E.D.I. Document Status
{
  OBJECT-PROPERTIES
  {
    Date=11/22/10;
    Time=12:00:00 PM;
    Version List=SE0.55;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {
    VAR
      EDIChangedDocument@1240030004 : Record 14002373;
      EDIRecDocHdrTmp@1240030005 : TEMPORARY Record 14002358;
      EDISetup@1240030001 : Record 14002367;
      EDISetupRetrieved@1240030003 : Boolean;

    PROCEDURE AssocChangeDocument@1240030003(CurrSalesHdr@1240030000 : Record 36);
    VAR
      EDIRecDocHdr@1240030001 : Record 14002358;
    BEGIN
      EDIRecDocHdrTmp.RESET;
      EDIRecDocHdrTmp.DELETEALL;

      GetEDISetup;
      EDIChangedDocument.RESET;
      EDIChangedDocument.SETCURRENTKEY("Assoc. Internal Doc. No.");
      EDIChangedDocument.SETRANGE("Assoc. Internal Doc. No.",CurrSalesHdr."EDI Internal Doc. No.");
      IF EDIChangedDocument.FIND('-') THEN
        REPEAT
          EDIRecDocHdrTmp.RESET;
          EDIRecDocHdr.GET(EDIChangedDocument."Internal Doc. No.");
          EDIRecDocHdrTmp := EDIRecDocHdr;
          EDIRecDocHdrTmp."Internal Doc. No." := EDIRecDocHdr."Internal Doc. No.";
          IF NOT EDIRecDocHdrTmp.INSERT THEN
            ;
        UNTIL EDIChangedDocument.NEXT = 0;
      IF EDISetup.ListView THEN
        PAGE.RUN(PAGE::"E.D.I. Receive Document List",EDIRecDocHdrTmp)
      ELSE
        PAGE.RUN(PAGE::"E.D.I. Receive Document",EDIRecDocHdrTmp);
    END;

    PROCEDURE PurchOrderAssocChangeDoc@1240030006(CurrPurchaseHdr@1240030000 : Record 38);
    VAR
      EDIRecDocHdr@1240030001 : Record 14002358;
    BEGIN
      EDIRecDocHdrTmp.RESET;
      EDIRecDocHdrTmp.DELETEALL;

      GetEDISetup;
      EDIChangedDocument.RESET;
      EDIChangedDocument.SETCURRENTKEY("Assoc. Internal Doc. No.");
      EDIChangedDocument.SETRANGE("Assoc. Internal Doc. No.",CurrPurchaseHdr."EDI Internal Doc. No.");
      IF EDIChangedDocument.FIND('-') THEN
        REPEAT
          EDIRecDocHdrTmp.RESET;
          EDIRecDocHdr.GET(EDIChangedDocument."Internal Doc. No.");
          EDIRecDocHdrTmp := EDIRecDocHdr;
          EDIRecDocHdrTmp."Internal Doc. No." := EDIRecDocHdr."Internal Doc. No.";
          IF NOT EDIRecDocHdrTmp.INSERT THEN
            ;
        UNTIL EDIChangedDocument.NEXT = 0;
      IF EDISetup.ListView THEN
        PAGE.RUN(PAGE::"E.D.I. Receive Document List",EDIRecDocHdrTmp)
      ELSE
        PAGE.RUN(PAGE::"E.D.I. Receive Document",EDIRecDocHdrTmp);
    END;

    PROCEDURE GetEDISetup@1240030001();
    BEGIN
      IF NOT EDISetupRetrieved THEN BEGIN
        EDISetup.GET;
        EDISetupRetrieved := TRUE;
      END;
    END;

    PROCEDURE SlsOrderArchiveAssocChangeDoc@1240030000(SalesHdrArchive@1240030000 : Record 5107);
    VAR
      EDIRecDocHdr@1240030001 : Record 14002358;
    BEGIN
      EDIRecDocHdrTmp.RESET;
      EDIRecDocHdrTmp.DELETEALL;

      GetEDISetup;
      EDIChangedDocument.RESET;
      EDIChangedDocument.SETCURRENTKEY("Assoc. Internal Doc. No.");
      EDIChangedDocument.SETRANGE("Assoc. Internal Doc. No.",SalesHdrArchive."EDI Internal Doc. No.");
      IF EDIChangedDocument.FIND('-') THEN
        REPEAT
          EDIRecDocHdrTmp.RESET;
          EDIRecDocHdr.GET(EDIChangedDocument."Internal Doc. No.");
          EDIRecDocHdrTmp := EDIRecDocHdr;
          EDIRecDocHdrTmp."Internal Doc. No." := EDIRecDocHdr."Internal Doc. No.";
          IF NOT EDIRecDocHdrTmp.INSERT THEN
            ;
        UNTIL EDIChangedDocument.NEXT = 0;
      IF EDISetup.ListView THEN
        PAGE.RUN(PAGE::"E.D.I. Receive Document List",EDIRecDocHdrTmp)
      ELSE
        PAGE.RUN(PAGE::"E.D.I. Receive Document",EDIRecDocHdrTmp);
    END;

    PROCEDURE PurchOrderArchiveAssocDoc@1240030005(PurchaseHdrArchive@1240030000 : Record 5109);
    VAR
      EDIRecDocHdr@1240030001 : Record 14002358;
    BEGIN
      EDIRecDocHdrTmp.RESET;
      EDIRecDocHdrTmp.DELETEALL;

      GetEDISetup;
      EDIChangedDocument.RESET;
      EDIChangedDocument.SETCURRENTKEY("Assoc. Internal Doc. No.");
      EDIChangedDocument.SETRANGE("Assoc. Internal Doc. No.",PurchaseHdrArchive."EDI Internal Doc. No.");
      IF EDIChangedDocument.FIND('-') THEN
        REPEAT
          EDIRecDocHdrTmp.RESET;
          EDIRecDocHdr.GET(EDIChangedDocument."Internal Doc. No.");
          EDIRecDocHdrTmp := EDIRecDocHdr;
          EDIRecDocHdrTmp."Internal Doc. No." := EDIRecDocHdr."Internal Doc. No.";
          IF NOT EDIRecDocHdrTmp.INSERT THEN
            ;
        UNTIL EDIChangedDocument.NEXT = 0;
      IF EDISetup.ListView THEN
        PAGE.RUN(PAGE::"E.D.I. Receive Document List",EDIRecDocHdrTmp)
      ELSE
        PAGE.RUN(PAGE::"E.D.I. Receive Document",EDIRecDocHdrTmp);
    END;

    BEGIN
    END.
  }
}

