OBJECT Codeunit 50089 Table27EventSubcribers
{
  OBJECT-PROPERTIES
  {
    Date=02/25/21;
    Time=10:19:04 AM;
    Modified=Yes;
    Version List=TPZ000.00.00;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {
    VAR
      EventPublishers@1000000000 : Codeunit 50090;

    [EventSubscriber(Page,31,OnOpenPageEvent)]
    PROCEDURE Page31_SetSecurityFilterOnPriceBook@1000000002(VAR Rec@1000000000 : Record 27);
    VAR
      UserSetupMgt@1000000001 : Codeunit 5700;
    BEGIN
      // <TPZ159>
      WITH Rec DO BEGIN
        IF UserSetupMgt.GetPriceBookFilter <> '' THEN BEGIN
          FILTERGROUP(2);
          SETFILTER("Price Book Code",UserSetupMgt.GetPriceBookFilter);
          FILTERGROUP(0);
        END;
      END;
      // </TPZ159>
    END;

    [EventSubscriber(Page,31,OnOpenPageEvent)]
    PROCEDURE Page31_SetSecurityFilterOnLocation@1000000003(VAR Rec@1000000000 : Record 27);
    VAR
      UserSetupMgt@1000000001 : Codeunit 5700;
    BEGIN
      // <TPZ159>
      WITH Rec DO BEGIN
        IF UserSetupMgt.GetLocationFilter <> '' THEN BEGIN
          FILTERGROUP(2);
          SETFILTER("Location Filter",UserSetupMgt.GetLocationFilter);
          FILTERGROUP(0);
        END;
      END;
      // </TPZ159>
    END;

    [EventSubscriber(Page,30,OnOpenPageEvent)]
    PROCEDURE Page30_SetSecurityFilterOnPriceBook@1000000004(VAR Rec@1000000000 : Record 27);
    VAR
      UserSetupMgt@1000000001 : Codeunit 5700;
    BEGIN
      // <TPZ159>
      WITH Rec DO BEGIN
        IF UserSetupMgt.GetPriceBookFilter <> '' THEN BEGIN
          FILTERGROUP(2);
          SETFILTER("Price Book Code",UserSetupMgt.GetPriceBookFilter);
          FILTERGROUP(0);
        END;
      END;
      // </TPZ159>
    END;

    [EventSubscriber(Page,30,OnOpenPageEvent)]
    PROCEDURE Page30_SetSecurityFilterOnLocation@1000000001(VAR Rec@1000000000 : Record 27);
    VAR
      UserSetupMgt@1000000001 : Codeunit 5700;
    BEGIN
      // <TPZ159>
      WITH Rec DO BEGIN
        IF UserSetupMgt.GetLocationFilter <> '' THEN BEGIN
          FILTERGROUP(2);
          SETFILTER("Location Filter",UserSetupMgt.GetLocationFilter);
          FILTERGROUP(0);
        END;
      END;
      // </TPZ159>
    END;

    [EventSubscriber(Codeunit,50090,OnLookupShortcutDimCode)]
    LOCAL PROCEDURE LookupShortcutDimCode@1000000000(VAR Sender@1000000000 : Codeunit 50090;FieldNumber@1000000001 : Integer;VAR ShortcutDimCode@1000000002 : Code[20];VAR Rec@1000000003 : Record 27);
    VAR
      DimMgt@1000000004 : Codeunit 408;
    BEGIN
      DimMgt.LookupDimValueCode(FieldNumber,ShortcutDimCode);
      Rec.ValidateShortcutDimCode(5,Rec."Shortcut Dimension 5 Code");
    END;

    [EventSubscriber(Page,9231,OnOpenPageEvent)]
    PROCEDURE Page9231_SetSecurityFilterOnPriceBook@1000010006(VAR Rec@1000000000 : Record 27);
    VAR
      UserSetupMgt@1000000001 : Codeunit 5700;
    BEGIN
      // <TPZ159>
      WITH Rec DO BEGIN
        IF UserSetupMgt.GetPriceBookFilter <> '' THEN BEGIN
          FILTERGROUP(2);
          SETFILTER("Price Book Code",UserSetupMgt.GetPriceBookFilter);
          FILTERGROUP(0);
        END;
      END;
      // </TPZ159>
    END;

    [EventSubscriber(Page,9231,OnOpenPageEvent)]
    PROCEDURE Page9231_SetSecurityFilterOnLocation@1000010005(VAR Rec@1000000000 : Record 27);
    VAR
      UserSetupMgt@1000000001 : Codeunit 5700;
    BEGIN
      // <TPZ159>
      WITH Rec DO BEGIN
        IF UserSetupMgt.GetLocationFilter <> '' THEN BEGIN
          FILTERGROUP(2);
          SETFILTER("Location Filter",UserSetupMgt.GetLocationFilter);
          FILTERGROUP(0);
        END;
      END;
      // </TPZ159>
    END;

    [EventSubscriber(Codeunit,50090,OnUpdateItemDateTime_Sana)]
    LOCAL PROCEDURE UpdateItemDateTime_Sana@1000000005(VAR Sender@1000000001 : Codeunit 50090;VAR Rec@1000000002 : Record 27);
    VAR
      recordInfo@1000000000 : Record 11123331;
    BEGIN
      WITH Rec DO BEGIN
        recordInfo.SETRANGE("Table ID",27);
        recordInfo.SETRANGE("Code ID","No.");
        IF recordInfo.FINDFIRST THEN
            BEGIN
              recordInfo."Last Date/Time Modified":=CURRENTDATETIME;
              recordInfo.MODIFY;
            END ELSE BEGIN
               recordInfo.INIT;
               recordInfo.ID:=CREATEGUID;
               recordInfo."Table ID":=27;
               recordInfo."Code ID":="No.";
               recordInfo."Last Date/Time Modified":=CURRENTDATETIME;
               recordInfo."Modified Key":=RECORDID;
               recordInfo.INSERT;
            END;
      END;
    END;

    [EventSubscriber(Table,27,OnBeforeInsertEvent)]
    LOCAL PROCEDURE Tb27_OnInsert@1000000006(VAR Rec@1000000000 : Record 27;RunTrigger@1000000001 : Boolean);
    VAR
      recordInfo@1000000002 : Record 11123331;
    BEGIN
      IF NOT RunTrigger THEN
        EXIT;
      WITH Rec DO BEGIN
        // <TPZ161>
        "Date Created" := TODAY;
        "Created by User ID" := USERID;
        "Last Date Modified" := TODAY;
        "Last Modified by User ID" := USERID;
        // </TPZ161>
        //<VSO2381>
        EventPublishers.Tb27_OnUpdateItemDateTime_Sana(Rec);
        //</VSO2381>
      END;
    END;

    [EventSubscriber(Codeunit,50090,Tb27_OnInsert)]
    LOCAL PROCEDURE Tb27_OnInsert_1@1000000007(VAR Sender@1000000000 : Codeunit 50090;RunTrigger@1000000002 : Boolean;VAR Rec@1000000001 : Record 27);
    BEGIN
      IF NOT RunTrigger THEN
        EXIT;


      //<VSO2416>
      //Rec.TESTFIELD("No."); pankaj
      //</VSO2416>
    END;

    [EventSubscriber(Table,27,OnAfterInsertEvent)]
    LOCAL PROCEDURE Tb27_OnInsert_2@1000000008(VAR Rec@1000000000 : Record 27;RunTrigger@1000000001 : Boolean);
    VAR
      DocumentNoVisibility@1000000002 : Codeunit 1400;
      StockStatusWkshLine@1000000003 : Record 50000;
    BEGIN
      IF NOT RunTrigger THEN
        EXIT;

      WITH Rec DO BEGIN
          //TOP050 KT ABCSI Modification to Item Cards 01232015
        //Blocked := Blocked::"1";
        Blocked := FALSE;
        //TOP050 KT ABCSI Modification to Item Cards 01232015

        //<TPZ989>
        //Blocked := Blocked::"3";
        Blocked := TRUE;
        //</TPZ989>

        //TOP010 KT ABCSI Stock Status Quick Quote Screen - 01132015
        IF (NOT StockStatusWkshLine.GET("No.")) THEN BEGIN
          StockStatusWkshLine.INIT;
          StockStatusWkshLine."Item No." := "No.";
          StockStatusWkshLine.Description := Description;
          StockStatusWkshLine."Description 2" := "Description 2";
          StockStatusWkshLine."Vendor Item No." := "Vendor Item No.";
          StockStatusWkshLine.INSERT;
          StockStatusWkshLine."Country/Region of Origin Code" := "Country/Region of Origin Code";
          StockStatusWkshLine."Manufacturer Code" := "Manufacturer Code";
          StockStatusWkshLine."Base Unit of Measure" := "Base Unit of Measure";
          StockStatusWkshLine."Item Category Code" := "Item Category Code";
          StockStatusWkshLine."Product Group Code" := "Product Group Code";
          StockStatusWkshLine."ABC Code" := "ABC Code"; //<TPZ2839>
          // <TPZ591>
          StockStatusWkshLine."Sorting Order" := "Sorting Order";
          // </TPZ591>
          StockStatusWkshLine.MODIFY;
        END;
        //TOP010 KT ABCSI Stock Status Quick Quote Screen - 01132015
      END;
    END;

    [EventSubscriber(Table,27,OnAfterDeleteEvent)]
    LOCAL PROCEDURE Tb27_OnDelete@1000000009(VAR Rec@1000000000 : Record 27;RunTrigger@1000000001 : Boolean);
    VAR
      StockStatusWkshLine@1000000002 : Record 50000;
      UBPEvents@1000000003 : Codeunit 14000599;
    BEGIN
      IF NOT RunTrigger THEN
        EXIT;

      WITH Rec DO BEGIN
          //TOP010 KT ABCSI Stock Status Quick Quote Screen - 01132015
        StockStatusWkshLine.RESET;
        StockStatusWkshLine.SETRANGE("Item No.","No.");
        StockStatusWkshLine.DELETEALL;
        //TOP010 KT ABCSI Stock Status Quick Quote Screen - 01132015
        // UBP >>
        //UBPEvents.ItemOnAfterDelete(Rec, TRUE);
        // UBP <<
      END;
    END;

    [EventSubscriber(Table,27,OnAfterValidateEvent,"No.")]
    LOCAL PROCEDURE Tb27_No_OnValidate@1000000010(VAR Rec@1000000000 : Record 27;VAR xRec@1000000001 : Record 27;CurrFieldNo@1000000002 : Integer);
    VAR
      InventorySetup@1000000003 : Record 313;
    BEGIN
      //<TPZ2379>
      WITH Rec DO BEGIN
        InventorySetup.GET;
        IF (InventorySetup."Item Rename Not Allowed"=TRUE) AND ("No." <> xRec."No.") AND (xRec."No."<>'') THEN
          ERROR('Renaming of item %1 is not Allowed',"No.");
      END;
      //</TPZ2379>
    END;

    [EventSubscriber(Table,27,OnAfterValidateEvent,Description)]
    LOCAL PROCEDURE Tb27_Description_OnValidate@1000000012(VAR Rec@1000000000 : Record 27;VAR xRec@1000000001 : Record 27;CurrFieldNo@1000000002 : Integer);
    VAR
      StockStatusWkshLine@1000000003 : Record 50000;
    BEGIN
      WITH Rec DO BEGIN
        //TOP010 KT ABCSI Stock Status Quick Quote Screen - 01132015
        IF Description <> xRec.Description THEN
          IF StockStatusWkshLine.GET("No.") THEN
            BEGIN
              StockStatusWkshLine.Description := Description;
              StockStatusWkshLine.MODIFY;
            END;
        //TOP010 KT ABCSI Stock Status Quick Quote Screen - 01132015

      END;
    END;

    [EventSubscriber(Table,27,OnAfterValidateEvent,"Description 2")]
    LOCAL PROCEDURE Tb27_Description2_OnValidate@1000000014(VAR Rec@1000000000 : Record 27;VAR xRec@1000000001 : Record 27;CurrFieldNo@1000000002 : Integer);
    VAR
      StockStatusWkshLine@1000000003 : Record 50000;
    BEGIN
      WITH Rec DO BEGIN
          //TOP010 KT ABCSI Stock Status Quick Quote Screen - 01132015
        IF "Description 2" <> xRec."Description 2" THEN
          IF StockStatusWkshLine.GET("No.") THEN
            BEGIN
              StockStatusWkshLine."Description 2" := "Description 2";
              StockStatusWkshLine.MODIFY;
            END;
        //TOP010 KT ABCSI Stock Status Quick Quote Screen - 01132015
      END;
    END;

    [EventSubscriber(Table,27,OnAfterValidateEvent,"Base Unit of Measure")]
    LOCAL PROCEDURE Tb27_BaseUnitOfMeasure_OnValidate@1000000016(VAR Rec@1000000000 : Record 27;VAR xRec@1000000001 : Record 27;CurrFieldNo@1000000002 : Integer);
    VAR
      StockStatusWkshLine@1000000003 : Record 50000;
    BEGIN
      WITH Rec DO BEGIN
         //TOP010 KT ABCSI Stock Status Quick Quote Screen - 01132015
        IF "Base Unit of Measure" <> xRec."Base Unit of Measure" THEN
          IF StockStatusWkshLine.GET("No.") THEN
            BEGIN
              StockStatusWkshLine."Base Unit of Measure" := "Base Unit of Measure";
              StockStatusWkshLine.MODIFY;
            END;
        //TOP010 KT ABCSI Stock Status Quick Quote Screen - 01132015

      END;
    END;

    [EventSubscriber(Table,27,OnAfterValidateEvent,"Vendor Item No.")]
    LOCAL PROCEDURE Tb27_VendorItemNo_OnValidate@1000000018(VAR Rec@1000000000 : Record 27;VAR xRec@1000000001 : Record 27;CurrFieldNo@1000000002 : Integer);
    VAR
      StockStatusWkshLine@1000000003 : Record 50000;
    BEGIN
      WITH Rec DO BEGIN
         //TOP010 KT ABCSI Stock Status Quick Quote Screen - 01132015
        IF "Vendor Item No." <> xRec."Vendor Item No." THEN
          IF StockStatusWkshLine.GET("No.") THEN
            BEGIN
              StockStatusWkshLine."Vendor Item No." := "Vendor Item No.";
              StockStatusWkshLine.MODIFY;
            END;
        //TOP010 KT ABCSI Stock Status Quick Quote Screen - 01132015

      END;
    END;

    [EventSubscriber(Table,27,OnAfterValidateEvent,"Alternative Item No.")]
    LOCAL PROCEDURE Tb27_AlternativeItemNo_OnValidate@1000000011(VAR Rec@1000000000 : Record 27;VAR xRec@1000000001 : Record 27;CurrFieldNo@1000000002 : Integer);
    VAR
      ItemSubstitution@1000000004 : Record 5715;
      Item1@1000000003 : Record 27;
    BEGIN
      WITH Rec DO BEGIN
         //<TPZ2284>
        IF ("Alternative Item No." <> xRec."Alternative Item No.") AND ("Alternative Item No." <>'') THEN BEGIN
          ItemSubstitution.RESET;
          IF NOT ItemSubstitution.GET(0,"Alternative Item No.",'',0,"No.",'') THEN BEGIN
            ItemSubstitution.CreateSubstitutionItem2Item("Alternative Item No.",'',"No.",'',FALSE);
            IF Item1.GET(ItemSubstitution."Substitute No.") THEN
              ItemSubstitution.Description:= Item1.Description;
              ItemSubstitution.MODIFY;
          END;
        END;
          IF ItemSubstitution.GET(0,xRec."Alternative Item No.",'',0,"No.",'') THEN
            ItemSubstitution.DELETE;
        //</TPZ2284>

      END;
    END;

    [EventSubscriber(Table,27,OnAfterValidateEvent,blocked)]
    LOCAL PROCEDURE Tb27_Blocked_OnValidate@1000000015(VAR Rec@1000000000 : Record 27;VAR xRec@1000000001 : Record 27;CurrFieldNo@1000000002 : Integer);
    VAR
      StockStatusWkshLine@1000000005 : Record 50000;
      ItemMgt@1000000004 : Codeunit 50020;
      CommnetLine@1000000003 : Record 97;
    BEGIN
      WITH Rec DO BEGIN
          //TOP010 KT ABCSI Stock Status Quick Quote Screen - 01192015
        IF Blocked <> xRec.Blocked THEN BEGIN
          //<TPZ1456> no need to check journal when unblocking.
          IF Blocked <> Blocked::"0" THEN
          //</TPZ14656>
            CheckJournalsAndWorksheets(FIELDNO(Blocked));  //TOP050 KT ABCSI Modification to Item Cards 01192015

          //<TPZ989> - Check mandatory fields are populated
          //IF (xRec.Blocked = Blocked::"3") AND ("Mandatory Fields Checked" = FALSE) THEN BEGIN
          IF (xRec.Blocked = TRUE) AND ("Mandatory Fields Checked" = FALSE) THEN BEGIN
            IF ItemMgt.CheckItem(Rec,TRUE) = FALSE THEN
              ERROR('')
            ELSE
              "Mandatory Fields Checked" := TRUE;
          END;
          //</TPZ989>

          //<TPZ1456>  no need to check documents when unblocking.
          IF Blocked <> Blocked::"0" THEN
          //</TPZ1456>
            CheckDocuments(FIELDNO(Blocked));              //TOP050 KT ABCSI Modification to Item Cards 01192015
          IF StockStatusWkshLine.GET("No.") THEN BEGIN
            StockStatusWkshLine.Blocked := Blocked;
            //IF Blocked = Blocked::"3" THEN
            IF Blocked = TRUE THEN
              StockStatusWkshLine."Blocked Sequence" := TRUE
            ELSE
              StockStatusWkshLine."Blocked Sequence" := FALSE;
            StockStatusWkshLine.MODIFY;
          END;
          //TOP130 KT ABCSI Item List Sort and Filter by Status 04102015
          //IF Blocked = Blocked::"3" THEN
          IF Blocked = TRUE THEN
            "Blocked Sequence" := TRUE
          ELSE
            "Blocked Sequence" := FALSE;
          //TOP130 KT ABCSI Item List Sort and Filter by Status 04102015
          //TOP050 KT ABCSI Modification to Item Cards 08182015
          IF Blocked = Blocked::"0" THEN
            "Blocked Reason Code" := '';
          //TOP050 KT ABCSI Modification to Item Cards 08182015
        END;
        //TOP010 KT ABCSI Stock Status Quick Quote Screen - 01192015

      END;
    END;

    [EventSubscriber(Table,27,OnAfterValidateEvent,"Country/Region of Origin Code")]
    LOCAL PROCEDURE Tb27_CountryRegionOfOriginCode_OnValidate@1000000013(VAR Rec@1000000000 : Record 27;VAR xRec@1000000001 : Record 27;CurrFieldNo@1000000002 : Integer);
    VAR
      StockStatusWkshLine@1000000003 : Record 50000;
    BEGIN
      WITH Rec DO BEGIN
        //TOP010 KT ABCSI Stock Status Quick Quote Screen - 01132015
        IF "Country/Region of Origin Code" <> xRec."Country/Region of Origin Code" THEN
          IF StockStatusWkshLine.GET("No.") THEN
            BEGIN
              StockStatusWkshLine."Country/Region of Origin Code" := "Country/Region of Origin Code";
              StockStatusWkshLine.MODIFY;
            END;
        //TOP010 KT ABCSI Stock Status Quick Quote Screen - 01132015
      END;
    END;

    [EventSubscriber(Table,27,OnAfterValidateEvent,"Manufacturer Code")]
    LOCAL PROCEDURE Tb27_ManufacturingCode_OnValidate@1000000017(VAR Rec@1000000000 : Record 27;VAR xRec@1000000001 : Record 27;CurrFieldNo@1000000002 : Integer);
    VAR
      StockStatusWkshLine@1000000003 : Record 50000;
    BEGIN
      WITH Rec DO BEGIN
        //TOP010 KT ABCSI Stock Status Quick Quote Screen - 01132015
        IF "Manufacturer Code" <> xRec."Manufacturer Code" THEN
          IF StockStatusWkshLine.GET("No.") THEN
            BEGIN
              StockStatusWkshLine."Manufacturer Code" := "Manufacturer Code";
              StockStatusWkshLine.MODIFY;
            END;
        //TOP010 KT ABCSI Stock Status Quick Quote Screen - 01132015
      END;
    END;

    [EventSubscriber(Table,27,OnAfterValidateEvent,"Item Category Code")]
    LOCAL PROCEDURE Tb27_ItemCategoryCode_OnValidate@1000000019(VAR Rec@1000000000 : Record 27;VAR xRec@1000000001 : Record 27;CurrFieldNo@1000000002 : Integer);
    VAR
      StockStatusWkshLine@1000000003 : Record 50000;
    BEGIN
      WITH Rec DO BEGIN
        //TOP010 KT ABCSI Stock Status Quick Quote Screen - 01132015
        IF StockStatusWkshLine.GET("No.") THEN
          BEGIN
            StockStatusWkshLine."Item Category Code" := "Item Category Code";
            StockStatusWkshLine.MODIFY;
          END;
      //TOP010 KT ABCSI Stock Status Quick Quote Screen - 01132015
      END;
    END;

    [EventSubscriber(Table,27,OnAfterValidateEvent,"Product Group Code")]
    LOCAL PROCEDURE Tb27_ProductGroupCode_OnValidate@1000000021(VAR Rec@1000000000 : Record 27;VAR xRec@1000000001 : Record 27;CurrFieldNo@1000000002 : Integer);
    VAR
      StockStatusWkshLine@1000000003 : Record 50000;
    BEGIN
      WITH Rec DO BEGIN
         //TOP010 KT ABCSI Stock Status Quick Quote Screen - 01132015
        IF "Product Group Code" <> xRec."Product Group Code" THEN
          IF StockStatusWkshLine.GET("No.") THEN
            BEGIN
              StockStatusWkshLine."Product Group Code" := "Product Group Code";
              StockStatusWkshLine.MODIFY;
            END;
        //TOP010 KT ABCSI Stock Status Quick Quote Screen - 01132015
      END;
    END;

    [EventSubscriber(Table,27,OnBeforeModifyEvent)]
    LOCAL PROCEDURE Tb27_OnModify@1000000020(VAR Rec@1000000000 : Record 27;VAR xRec@1000000001 : Record 27;RunTrigger@1000000002 : Boolean);
    VAR
      StockStatusWkshLine@1000000003 : Record 50000;
    BEGIN
      IF NOT RunTrigger THEN
        EXIT;

      WITH Rec DO BEGIN
          "Last Date Modified" := TODAY;
        // <TPZ161>
        "Last Modified by User ID" := USERID;
        // </TPZ161>
        //<VSO2381>
        EventPublishers.Tb27_OnUpdateItemDateTime_Sana(Rec);
        //</VSO2381>
        //TOP010 KT ABCSI Stock Status Quick Quote Screen - 01132015
        IF StockStatusWkshLine.GET("No.") THEN BEGIN
          StockStatusWkshLine.Description := Description;
          StockStatusWkshLine."Description 2" := "Description 2";
          StockStatusWkshLine."Vendor Item No." := "Vendor Item No.";
          StockStatusWkshLine."Country/Region of Origin Code" := "Country/Region of Origin Code";
          StockStatusWkshLine."Manufacturer Code" := "Manufacturer Code";
          StockStatusWkshLine."Base Unit of Measure" := "Base Unit of Measure";
          StockStatusWkshLine."Item Category Code" := "Item Category Code";
          StockStatusWkshLine."Product Group Code" := "Product Group Code";
          //TOP130 KT ABCSI Item List Sort and Filter by Status 04102015
          StockStatusWkshLine.Blocked := Blocked;
          StockStatusWkshLine."Blocked Sequence" := "Blocked Sequence";
          StockStatusWkshLine."Shortcut Dimension 5 Code" := "Shortcut Dimension 5 Code";
          //TOP130 KT ABCSI Item List Sort and Filter by Status 04102015
          // <TPZ591>
          StockStatusWkshLine."Sorting Order" := "Sorting Order";
          // </TPZ591>
          StockStatusWkshLine.MODIFY;
        END;
        //TOP010 KT ABCSI Stock Status Quick Quote Screen - 01132015
      END;
    END;

    [EventSubscriber(Codeunit,50090,Tb27_OnCheckItemJnlLine)]
    LOCAL PROCEDURE Tb27_CheckItemJnlLine@1000000022(VAR Sender@1000000000 : Codeunit 50090;Rec@1000000001 : Record 27;CurrFieldNo@1000000002 : Integer);
    VAR
      ItemJnlLine@1000000003 : Record 83;
      CannotChangeFieldErr@1000000004 : TextConst '@@@="%1 = Field Caption, %2 = Item Table Name, %3 = Item No., %4 = Table Name";ENU=You cannot change the %1 field on %2 %3 because at least one %4 exists for this item.;ESM=No puede cambiar el campo %1 en %2 %3 porque existe como m�nimo una %4 de este producto.;FRC=Vous ne pouvez pas modifier le champ %1 de %2 %3, car il existe au moins un %4 pour cet article.;ENC=You cannot change the %1 field on %2 %3 because at least one %4 exists for this item.';
    BEGIN
      //TOP050 KT ABCSI Modification to Item Cards 01202015
      WITH Rec DO BEGIN
      IF CurrFieldNo = FIELDNO(Blocked) THEN
        ERROR(CannotChangeFieldErr,FIELDCAPTION(Blocked),TABLECAPTION,"No.",ItemJnlLine.TABLECAPTION);
      END;
      //TOP050 KT ABCSI Modification to Item Cards 01202015
    END;

    [EventSubscriber(Codeunit,50090,Tb27_CheckReqLine)]
    LOCAL PROCEDURE Tb27_CheckReqLine@1000000023(VAR Sender@1000000000 : Codeunit 50090;CurrFieldNo@1000000001 : Integer;Rec@1000000002 : Record 27);
    BEGIN
      WITH Rec DO BEGIN
          // <TPZ135>
        IF (CurrFieldNo = FIELDNO(Blocked)) AND
            (Blocked IN [Blocked::"0",Blocked::"1"])
        THEN
          EXIT;
        // </TPZ135>
      END;
    END;

    [EventSubscriber(Codeunit,50090,Tb27_OnCheckReqLine_2)]
    LOCAL PROCEDURE Tb27_CheckReqLine_2@1000000024(VAR Sender@1000000000 : Codeunit 50090;CurrFieldNo@1000000001 : Integer;Rec@1000000002 : Record 27);
    VAR
      RequisitionLine@1000000003 : Record 246;
      CannotChangeFieldErr@1000000004 : TextConst '@@@="%1 = Field Caption, %2 = Item Table Name, %3 = Item No., %4 = Table Name";ENU=You cannot change the %1 field on %2 %3 because at least one %4 exists for this item.;ESM=No puede cambiar el campo %1 en %2 %3 porque existe como m�nimo una %4 de este producto.;FRC=Vous ne pouvez pas modifier le champ %1 de %2 %3, car il existe au moins un %4 pour cet article.;ENC=You cannot change the %1 field on %2 %3 because at least one %4 exists for this item.';
    BEGIN
      WITH Rec DO BEGIN
         //TOP050 KT ABCSI Modification to Item Cards 01202015
        IF CurrFieldNo = FIELDNO(Blocked) THEN
          ERROR(CannotChangeFieldErr,FIELDCAPTION(Blocked),TABLECAPTION,"No.",RequisitionLine.TABLECAPTION);
        //TOP050 KT ABCSI Modification to Item Cards 01202015
      END;
    END;

    [EventSubscriber(Codeunit,50090,Tb27_OnCheckBOM)]
    LOCAL PROCEDURE Tb27_CheckBOM@1000000025(VAR Sender@1000000000 : Codeunit 50090;CurrFieldNo@1000000001 : Integer;Rec@1000000002 : Record 27);
    VAR
      CannotChangeFieldErr@1000000003 : TextConst '@@@="%1 = Field Caption, %2 = Item Table Name, %3 = Item No., %4 = Table Name";ENU=You cannot change the %1 field on %2 %3 because at least one %4 exists for this item.;ESM=No puede cambiar el campo %1 en %2 %3 porque existe como m�nimo una %4 de este producto.;FRC=Vous ne pouvez pas modifier le champ %1 de %2 %3, car il existe au moins un %4 pour cet article.;ENC=You cannot change the %1 field on %2 %3 because at least one %4 exists for this item.';
      BOMComp@1000000004 : Record 90;
    BEGIN
      WITH Rec DO BEGIN
          //TOP050 KT ABCSI Modification to Item Cards 01202015
        IF CurrFieldNo = FIELDNO(Blocked) THEN
          ERROR(CannotChangeFieldErr,FIELDCAPTION(Blocked),TABLECAPTION,"No.",BOMComp.TABLECAPTION);
        //TOP050 KT ABCSI Modification to Item Cards 01202015
      END;
    END;

    [EventSubscriber(Codeunit,50090,Tb27_OnCheckPurchLine)]
    LOCAL PROCEDURE Tb27_CheckPurchLine@1000000026(VAR Sender@1000000000 : Codeunit 50090;CurrFieldNo@1000000001 : Integer;Rec@1000000002 : Record 27);
    BEGIN
      WITH Rec DO BEGIN
        // <TPZ135>
        IF (CurrFieldNo = FIELDNO(Blocked)) AND
            (Blocked IN [Blocked::"0",Blocked::"1"])
        THEN
          EXIT;
        // </TPZ135>
      END;
    END;

    [EventSubscriber(Codeunit,50090,Tb27_OnCheckSalesLine)]
    LOCAL PROCEDURE Tb27_CheckSalesLine@1000000027(VAR Sender@1000000000 : Codeunit 50090;CurrFieldNo@1000000001 : Integer;Rec@1000000002 : Record 27);
    BEGIN
      WITH Rec DO BEGIN
          // <TPZ135>
        IF (CurrFieldNo = FIELDNO(Blocked)) AND
           //(Blocked IN [Blocked::"0",Blocked::"2"])
           Blocked = FALSE
        THEN
          EXIT;
        // </TPZ135>
      END;
    END;

    [EventSubscriber(Codeunit,50090,Tb27_OnCheckSalesLine_2)]
    LOCAL PROCEDURE Tb27_CheckSalesLine_2@1000000028(VAR Sender@1000000000 : Codeunit 50090;CurrFieldNo@1000000001 : Integer;Rec@1000000002 : Record 27);
    VAR
      CannotChangeFieldErr@1000000003 : TextConst '@@@="%1 = Field Caption, %2 = Item Table Name, %3 = Item No., %4 = Table Name";ENU=You cannot change the %1 field on %2 %3 because at least one %4 exists for this item.;ESM=No puede cambiar el campo %1 en %2 %3 porque existe como m�nimo una %4 de este producto.;FRC=Vous ne pouvez pas modifier le champ %1 de %2 %3, car il existe au moins un %4 pour cet article.;ENC=You cannot change the %1 field on %2 %3 because at least one %4 exists for this item.';
      SalesOrderLine@1000000004 : Record 37;
    BEGIN
      WITH Rec DO BEGIN
            //TOP050 KT ABCSI Modification to Item Cards 01202015
        IF CurrFieldNo = FIELDNO(Blocked) THEN
          ERROR(CannotChangeFieldErr,FIELDCAPTION(Blocked),TABLECAPTION,"No.",SalesOrderLine.TABLECAPTION);
        //TOP050 KT ABCSI Modification to Item Cards 01202015
      END;
    END;

    [EventSubscriber(Codeunit,50090,Tb27_OnCheckProdOrderLine)]
    LOCAL PROCEDURE Tb27_CheckProdOrderLine@1000000029(VAR Sender@1000000000 : Codeunit 50090;CurrFieldNo@1000000001 : Integer;Rec@1000000002 : Record 27);
    VAR
      CannotChangeFieldErr@1000000003 : TextConst '@@@="%1 = Field Caption, %2 = Item Table Name, %3 = Item No., %4 = Table Name";ENU=You cannot change the %1 field on %2 %3 because at least one %4 exists for this item.;ESM=No puede cambiar el campo %1 en %2 %3 porque existe como m�nimo una %4 de este producto.;FRC=Vous ne pouvez pas modifier le champ %1 de %2 %3, car il existe au moins un %4 pour cet article.;ENC=You cannot change the %1 field on %2 %3 because at least one %4 exists for this item.';
      ProdOrderLine@1000000004 : Record 5406;
    BEGIN
      WITH Rec DO BEGIN
          //TOP050 KT ABCSI Modification to Item Cards 01202015
        IF CurrFieldNo = FIELDNO(Blocked) THEN
          ERROR(CannotChangeFieldErr,FIELDCAPTION(Blocked),TABLECAPTION,"No.",ProdOrderLine.TABLECAPTION);
        //TOP050 KT ABCSI Modification to Item Cards 01202015
      END;
    END;

    [EventSubscriber(Codeunit,50090,Tb27_OnCheckPlanningCompLine)]
    LOCAL PROCEDURE Tb27_CheckPlanningCompLine@1000000030(VAR Sender@1000000000 : Codeunit 50090;CurrFieldNo@1000000001 : Integer;Rec@1000000002 : Record 27);
    VAR
      CannotChangeFieldErr@1000000003 : TextConst '@@@="%1 = Field Caption, %2 = Item Table Name, %3 = Item No., %4 = Table Name";ENU=You cannot change the %1 field on %2 %3 because at least one %4 exists for this item.;ESM=No puede cambiar el campo %1 en %2 %3 porque existe como m�nimo una %4 de este producto.;FRC=Vous ne pouvez pas modifier le champ %1 de %2 %3, car il existe au moins un %4 pour cet article.;ENC=You cannot change the %1 field on %2 %3 because at least one %4 exists for this item.';
      PlanningComponent@1000000004 : Record 99000829;
    BEGIN
      WITH Rec DO BEGIN
         //TOP050 KT ABCSI Modification to Item Cards 01202015
        IF CurrFieldNo = FIELDNO(Blocked) THEN
          ERROR(CannotChangeFieldErr,FIELDCAPTION(Blocked),TABLECAPTION,"No.",PlanningComponent.TABLECAPTION);
        //TOP050 KT ABCSI Modification to Item Cards 01202015
      END;
    END;

    [EventSubscriber(Codeunit,50090,Tb27_OnCheckTransLine)]
    LOCAL PROCEDURE Tb27_CheckTransLine@1000000031(VAR Sender@1000000000 : Codeunit 50090;VAR TransLine@1000000001 : Record 5741);
    BEGIN
      WITH TransLine DO BEGIN
        //<TPZ1648>
        TransLine.SETFILTER("Outstanding Quantity", '<>0');
        //</TPZ1648>
      END;
    END;

    [EventSubscriber(Codeunit,50090,Tb27_OnCheckTransLine_2)]
    LOCAL PROCEDURE Tb27_CheckTransLine_2@1000000032(VAR Sender@1000000000 : Codeunit 50090;CurrFieldNo@1000000001 : Integer;Rec@1000000002 : Record 27);
    VAR
      TransLine@1000000003 : Record 5741;
      CannotChangeFieldErr@1000000004 : TextConst '@@@="%1 = Field Caption, %2 = Item Table Name, %3 = Item No., %4 = Table Name";ENU=You cannot change the %1 field on %2 %3 because at least one %4 exists for this item.;ESM=No puede cambiar el campo %1 en %2 %3 porque existe como m�nimo una %4 de este producto.;FRC=Vous ne pouvez pas modifier le champ %1 de %2 %3, car il existe au moins un %4 pour cet article.;ENC=You cannot change the %1 field on %2 %3 because at least one %4 exists for this item.';
    BEGIN
      WITH Rec DO BEGIN
          //TOP050 KT ABCSI Modification to Item Cards 01202015
        IF CurrFieldNo = FIELDNO(Blocked) THEN
          ERROR(CannotChangeFieldErr,FIELDCAPTION(Blocked),TABLECAPTION,"No.",TransLine.TABLECAPTION);
        //TOP050 KT ABCSI Modification to Item Cards 01202015
      END;
    END;

    [EventSubscriber(Codeunit,50090,Tb27_OnCheckServLine)]
    PROCEDURE Tb27_CheckServLine@1000000033(VAR Sender@1000000000 : Codeunit 50090;CurrFieldNo@1000000001 : Integer;Rec@1000000002 : Record 27);
    VAR
      ServInvLine@1000000003 : Record 5993;
      CannotChangeFieldErr@1000000004 : TextConst '@@@="%1 = Field Caption, %2 = Item Table Name, %3 = Item No., %4 = Table Name";ENU=You cannot change the %1 field on %2 %3 because at least one %4 exists for this item.;ESM=No puede cambiar el campo %1 en %2 %3 porque existe como m�nimo una %4 de este producto.;FRC=Vous ne pouvez pas modifier le champ %1 de %2 %3, car il existe au moins un %4 pour cet article.;ENC=You cannot change the %1 field on %2 %3 because at least one %4 exists for this item.';
    BEGIN
      WITH Rec DO BEGIN
        //TOP050 KT ABCSI Modification to Item Cards 01202015
        IF CurrFieldNo = FIELDNO(Blocked) THEN
          ERROR(CannotChangeFieldErr,FIELDCAPTION(Blocked),TABLECAPTION,"No.",ServInvLine.TABLECAPTION);
        //TOP050 KT ABCSI Modification to Item Cards 01202015
      END;
    END;

    [EventSubscriber(Codeunit,50090,Tb27_OnCheckProdBOMLine)]
    PROCEDURE Tb27_CheckProdBOMLine@1000000034(VAR Sender@1000000000 : Codeunit 50090;CurrFieldNo@1000000001 : Integer;Rec@1000000002 : Record 27);
    VAR
      CannotChangeFieldErr@1000000003 : TextConst '@@@="%1 = Field Caption, %2 = Item Table Name, %3 = Item No., %4 = Table Name";ENU=You cannot change the %1 field on %2 %3 because at least one %4 exists for this item.;ESM=No puede cambiar el campo %1 en %2 %3 porque existe como m�nimo una %4 de este producto.;FRC=Vous ne pouvez pas modifier le champ %1 de %2 %3, car il existe au moins un %4 pour cet article.;ENC=You cannot change the %1 field on %2 %3 because at least one %4 exists for this item.';
      ProdBOMLine@1000000004 : Record 99000772;
    BEGIN
      WITH Rec DO BEGIN
            //TOP050 KT ABCSI Modification to Item Cards 01202015
        IF CurrFieldNo = FIELDNO(Blocked) THEN
          ERROR(CannotChangeFieldErr,FIELDCAPTION(Blocked),TABLECAPTION,"No.",ProdBOMLine.TABLECAPTION);
        //TOP050 KT ABCSI Modification to Item Cards 01202015
      END;
    END;

    [EventSubscriber(Codeunit,50090,Tb27_OnCheckServContractLine)]
    PROCEDURE Tb27_CheckServContractLine@1000000035(VAR Sender@1000000000 : Codeunit 50090;CurrFieldNo@1000000001 : Integer;Rec@1000000002 : Record 27);
    VAR
      CannotChangeFieldErr@1000000003 : TextConst '@@@="%1 = Field Caption, %2 = Item Table Name, %3 = Item No., %4 = Table Name";ENU=You cannot change the %1 field on %2 %3 because at least one %4 exists for this item.;ESM=No puede cambiar el campo %1 en %2 %3 porque existe como m�nimo una %4 de este producto.;FRC=Vous ne pouvez pas modifier le champ %1 de %2 %3, car il existe au moins un %4 pour cet article.;ENC=You cannot change the %1 field on %2 %3 because at least one %4 exists for this item.';
      ServiceContractLine@1000000005 : Record 5964;
    BEGIN
      WITH Rec DO BEGIN
            //TOP050 KT ABCSI Modification to Item Cards 01202015
        IF CurrFieldNo = FIELDNO(Blocked) THEN
          ERROR(CannotChangeFieldErr,FIELDCAPTION(Blocked),TABLECAPTION,"No.",ServiceContractLine.TABLECAPTION);
        //TOP050 KT ABCSI Modification to Item Cards 01202015
      END;
    END;

    [EventSubscriber(Codeunit,50090,Tb27_OnCheckAsmHeader)]
    PROCEDURE Tb27_CheckAsmHeader@1000000036(VAR Sender@1000000000 : Codeunit 50090;CurrFieldNo@1000000001 : Integer;Rec@1000000002 : Record 27);
    VAR
      CannotChangeFieldErr@1000000003 : TextConst '@@@="%1 = Field Caption, %2 = Item Table Name, %3 = Item No., %4 = Table Name";ENU=You cannot change the %1 field on %2 %3 because at least one %4 exists for this item.;ESM=No puede cambiar el campo %1 en %2 %3 porque existe como m�nimo una %4 de este producto.;FRC=Vous ne pouvez pas modifier le champ %1 de %2 %3, car il existe au moins un %4 pour cet article.;ENC=You cannot change the %1 field on %2 %3 because at least one %4 exists for this item.';
      AsmHeader@1000000004 : Record 900;
    BEGIN
      WITH Rec DO BEGIN
            //TOP050 KT ABCSI Modification to Item Cards 01202015
        IF CurrFieldNo = FIELDNO(Blocked) THEN
          ERROR(CannotChangeFieldErr,FIELDCAPTION(Blocked),TABLECAPTION,"No.",AsmHeader.TABLECAPTION);
        //TOP050 KT ABCSI Modification to Item Cards 01202015
      END;
    END;

    [EventSubscriber(Codeunit,50090,Tb27_OnCheckAsmLine)]
    PROCEDURE Tb27_CheckAsmLine@1000000037(VAR Sender@1000000000 : Codeunit 50090;CurrFieldNo@1000000001 : Integer;Rec@1000000002 : Record 27);
    VAR
      CannotChangeFieldErr@1000000003 : TextConst '@@@="%1 = Field Caption, %2 = Item Table Name, %3 = Item No., %4 = Table Name";ENU=You cannot change the %1 field on %2 %3 because at least one %4 exists for this item.;ESM=No puede cambiar el campo %1 en %2 %3 porque existe como m�nimo una %4 de este producto.;FRC=Vous ne pouvez pas modifier le champ %1 de %2 %3, car il existe au moins un %4 pour cet article.;ENC=You cannot change the %1 field on %2 %3 because at least one %4 exists for this item.';
      AsmLine@1000000004 : Record 901;
    BEGIN
      WITH Rec DO BEGIN
            //TOP050 KT ABCSI Modification to Item Cards 01202015
        IF CurrFieldNo = FIELDNO(Blocked) THEN
          ERROR(CannotChangeFieldErr,FIELDCAPTION(Blocked),TABLECAPTION,"No.",AsmLine.TABLECAPTION);
        //TOP050 KT ABCSI Modification to Item Cards 01202015
      END;
    END;

    [EventSubscriber(Codeunit,50090,Tb27_OnUpdateItemDateTime_Sana)]
    PROCEDURE Tb27_UpdateItemDateTime_Sana@1000000038(VAR Sender@1000000001 : Codeunit 50090;Rec@1000000002 : Record 27);
    VAR
      recordInfo@1000000000 : Record 11123331;
    BEGIN
      WITH Rec DO BEGIN
        recordInfo.SETRANGE("Table ID",27);
        recordInfo.SETRANGE("Code ID","No.");
        IF recordInfo.FINDFIRST THEN
            BEGIN
              recordInfo."Last Date/Time Modified":=CURRENTDATETIME;
              recordInfo.MODIFY;
            END ELSE BEGIN
               recordInfo.INIT;
               recordInfo.ID:=CREATEGUID;
               recordInfo."Table ID":=27;
               recordInfo."Code ID":="No.";
               recordInfo."Last Date/Time Modified":=CURRENTDATETIME;
               recordInfo."Modified Key":=RECORDID;
               recordInfo.INSERT;
            END;
      END;
    END;

    [EventSubscriber(Table,27,OnBeforeInsertEvent)]
    LOCAL PROCEDURE Tb27_OnInsert_BlankItemCheck@1000000039(VAR Rec@1000000000 : Record 27;RunTrigger@1000000001 : Boolean);
    BEGIN
      //Rec.TESTFIELD("No."); //TPZ2706  Pankaj
    END;

    [EventSubscriber(Table,27,OnBeforeModifyEvent)]
    LOCAL PROCEDURE Tb27_OnModify_BlankItemCheck@1000000040(VAR Rec@1000000000 : Record 27;VAR xRec@1000000001 : Record 27;RunTrigger@1000000002 : Boolean);
    BEGIN
      Rec.TESTFIELD("No."); //TPZ2706
    END;

    [EventSubscriber(Table,27,OnBeforeRenameEvent)]
    LOCAL PROCEDURE Tb27_OnRename_BlankItemCheck@1000000042(VAR Rec@1000000000 : Record 27;VAR xRec@1000000001 : Record 27;RunTrigger@1000000002 : Boolean);
    BEGIN
      Rec.TESTFIELD("No."); //TPZ2706
    END;

    BEGIN
    {
      2019-27-11 VAHAMAD TPZ2706
       Events added Tb27_OnInsert_BlankItemCheck,Tb27_Modify_BlankItemCheck,Tb27_OnRename_BlankItemCheck
      2020-05-13 UCHOUHAN TPZ2839
        Added code for ABC code update in Stock Status.
    }
    END.
  }
}

