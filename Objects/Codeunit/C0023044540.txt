OBJECT Codeunit 23044540 WHI Print Ext. Template
{
  OBJECT-PROPERTIES
  {
    Date=03/19/19;
    Time=[ 8:46:03 AM];
    Version List=WHI2.4.7684.0;
  }
  PROPERTIES
  {
    TableNo=23044511;
    OnRun=BEGIN
            // this is needed to work around a NAV 2013 R2 issue with records in codeunits started from a session.
            Rec.CHANGECOMPANY();


            SELECTLATESTVERSION; //</IW author="R.Trudeau" date="04/26/17" issue="" />


            trecEventParams.COPY(Rec, TRUE);  //make Rec data global

            CASE getEvent OF
              123: examplePrintFunction;
              456: examplePrintFunction;
            END;
          END;

  }
  CODE
  {
    VAR
      trecEventParams@1000000000 : TEMPORARY Record 23044511;
      cuPrintMgmt@1000000001 : Codeunit 23044525;
      cuCommonFuncs@1000000002 : Codeunit 23044501;

    LOCAL PROCEDURE examplePrintFunction@1000000001();
    BEGIN
      //
      // get whatever variables are required to run the report
      // E.g.
      //   lcodSomeValue := trecEventParams.getValue('');
      //

      //
      // initialize/run the report
      //
      //cuCommonFuncs.setPrinterSelection('printer name', REPORT::"");
      //lrpt.initReport();
      //lrpt.SETTABLEVIEW(lrecTable);
      //lrpt.USEREQUESTPAGE(FALSE);
      //lrpt.RUNMODAL();

      //
      // or
      //cuCommonFuncs.setPrinterSelection('printer name', REPORT::"");
      //REPORT.RUNMODAL(REPORT::"",FALSE,FALSE,lrecTable);

      // or

      //
      // If you want to use the framework for controlling the printer the following code example might help
      //
      //lrecSalesHeader.SETRANGE("Order No.",trecEventParams.getDocumentNo());
      //lrefRecRef.GETTABLE(lrecSalesHeader);
      //cuPrintMgmt.printReport( lrefRecRef, recConfig.Code, REPORT::"Sales Order", recPDAConfig."Regular Printer Name");
    END;

    BEGIN
    END.
  }
}

