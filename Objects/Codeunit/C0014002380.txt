OBJECT Codeunit 14002380 E.D.I. Record Assoc. Document
{
  OBJECT-PROPERTIES
  {
    Date=07/07/17;
    Time=12:00:00 PM;
    Version List=SE0.60.14;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {

    PROCEDURE RecordAssocDoc@1000000000(CurrEDIRecDocHeader@1000000001 : Record 14002358;CurrOrderHeader@1000000000 : Record 36;RecordAssocInternalDoc@1240030000 : Boolean) AssocInternalDocNo : Code[20];
    VAR
      EDIChangedDocument@1000000004 : Record 14002373;
      LineNo@1000000003 : Integer;
      EDIRecDocHdr2@1000000002 : Record 14002358;
    BEGIN
      IF CurrEDIRecDocHeader."Internal Doc. No." = CurrOrderHeader."EDI Internal Doc. No." THEN
        EXIT;

      EDIChangedDocument.RESET;
      EDIChangedDocument.SETRANGE("Internal Doc. No.",CurrEDIRecDocHeader."Internal Doc. No.");
      EDIChangedDocument.SETRANGE("Document Type",CurrOrderHeader."Document Type");
      EDIChangedDocument.SETRANGE("Document No.",CurrOrderHeader."No.");
      IF EDIChangedDocument.FIND('-') THEN
        EXIT;

      EDIChangedDocument.RESET;
      EDIChangedDocument.SETRANGE("Internal Doc. No.",CurrEDIRecDocHeader."Internal Doc. No.");
      IF NOT EDIChangedDocument.FIND('+') THEN
        LineNo := 1
      ELSE
        LineNo := EDIChangedDocument."Entry No." + 1;
      EDIChangedDocument."Internal Doc. No." := CurrEDIRecDocHeader."Internal Doc. No.";
      EDIChangedDocument."Entry No." := LineNo;
      EDIChangedDocument."Document Type" := CurrOrderHeader."Document Type";
      EDIChangedDocument."Document No." := CurrOrderHeader."No.";
      EDIChangedDocument."Assoc. Internal Doc. No." := CurrOrderHeader."EDI Internal Doc. No.";
      EDIChangedDocument."Date Received" := CurrEDIRecDocHeader."Date Received";
      EDIChangedDocument."Time Received" := CurrEDIRecDocHeader."Time Received";
      EDIChangedDocument."EDI Document No." := CurrEDIRecDocHeader."EDI Document No.";
      EDIChangedDocument.INSERT;

      IF RecordAssocInternalDoc THEN
        IF EDIRecDocHdr2.GET(EDIChangedDocument."Assoc. Internal Doc. No." )THEN BEGIN
          AssocInternalDocNo := EDIRecDocHdr2."Internal Doc. No.";
          EDIChangedDocument.RESET;
          EDIChangedDocument.SETRANGE("Internal Doc. No.",EDIRecDocHdr2."Internal Doc. No.");
          IF NOT EDIChangedDocument.FIND('+') THEN
            LineNo := 1
          ELSE
            LineNo := EDIChangedDocument."Entry No." + 1;
          EDIChangedDocument."Internal Doc. No." := CurrOrderHeader."EDI Internal Doc. No.";
          EDIChangedDocument."Entry No." := LineNo;
          EDIChangedDocument."Document Type" := CurrOrderHeader."Document Type";
          EDIChangedDocument."Document No." := CurrOrderHeader."No.";
          EDIChangedDocument."Assoc. Internal Doc. No." := CurrEDIRecDocHeader."Internal Doc. No.";
          EDIChangedDocument.INSERT;
          EXIT(AssocInternalDocNo);
        END;
    END;

    PROCEDURE RecordAssocPurchDoc@1000000001(CurrEDIRecDocHeader@1000000002 : Record 14002358;CurrPurchaseHdr@1000000001 : Record 38;RecordAssocInternalDoc@1000000000 : Boolean) AssocInternalDocNo : Code[10];
    VAR
      EDIChangedDocument@1000000005 : Record 14002373;
      LineNo@1000000004 : Integer;
      EDIRecDocHdr2@1000000003 : Record 14002358;
    BEGIN
      IF CurrEDIRecDocHeader."Internal Doc. No." = CurrPurchaseHdr."EDI Internal Doc. No." THEN
        EXIT;

      EDIChangedDocument.RESET;
      EDIChangedDocument.SETRANGE("Internal Doc. No.",CurrEDIRecDocHeader."Internal Doc. No.");
      EDIChangedDocument.SETRANGE("Document Type",CurrPurchaseHdr."Document Type");
      EDIChangedDocument.SETRANGE("Document No.",CurrPurchaseHdr."No.");
      IF EDIChangedDocument.FIND('-') THEN
        EXIT;

      EDIChangedDocument.RESET;
      EDIChangedDocument.SETRANGE("Internal Doc. No.",CurrEDIRecDocHeader."Internal Doc. No.");
      IF NOT EDIChangedDocument.FIND('+') THEN
        LineNo := 1
      ELSE
        LineNo := EDIChangedDocument."Entry No." + 1;
      EDIChangedDocument."Internal Doc. No." := CurrEDIRecDocHeader."Internal Doc. No.";
      EDIChangedDocument."Entry No." := LineNo;
      EDIChangedDocument."Document Type" := CurrPurchaseHdr."Document Type";
      EDIChangedDocument."Document No." := CurrPurchaseHdr."No.";
      EDIChangedDocument."Assoc. Internal Doc. No." := CurrPurchaseHdr."EDI Internal Doc. No.";
      EDIChangedDocument."Date Received" := CurrEDIRecDocHeader."Date Received";
      EDIChangedDocument."Time Received" := CurrEDIRecDocHeader."Time Received";
      EDIChangedDocument."EDI Document No." := CurrEDIRecDocHeader."EDI Document No.";
      EDIChangedDocument.INSERT;

      IF RecordAssocInternalDoc THEN
        IF EDIRecDocHdr2.GET(EDIChangedDocument."Assoc. Internal Doc. No." )THEN BEGIN
          AssocInternalDocNo := EDIRecDocHdr2."Internal Doc. No.";
          EDIChangedDocument.RESET;
          EDIChangedDocument.SETRANGE("Internal Doc. No.",EDIRecDocHdr2."Internal Doc. No.");
          IF NOT EDIChangedDocument.FIND('+') THEN
            LineNo := 1
          ELSE
            LineNo := EDIChangedDocument."Entry No." + 1;
          EDIChangedDocument."Internal Doc. No." := CurrPurchaseHdr."EDI Internal Doc. No.";
          EDIChangedDocument."Entry No." := LineNo;
          EDIChangedDocument."Document Type" := CurrPurchaseHdr."Document Type";
          EDIChangedDocument."Document No." := CurrPurchaseHdr."No.";
          EDIChangedDocument."Assoc. Internal Doc. No." := CurrEDIRecDocHeader."Internal Doc. No.";
          EDIChangedDocument.INSERT;
          EXIT(AssocInternalDocNo);
        END;
    END;

    PROCEDURE RecordAssocTransferDoc@1240020000(CurrEDIRecDocHeader@1000000002 : Record 14002358;CurrTransferHdr@1000000001 : Record 5740;RecordAssocInternalDoc@1000000000 : Boolean) AssocInternalDocNo : Code[10];
    VAR
      EDIChangedDocument@1000000005 : Record 14002373;
      LineNo@1000000004 : Integer;
      EDIRecDocHdr2@1000000003 : Record 14002358;
    BEGIN
      IF CurrEDIRecDocHeader."Internal Doc. No." = CurrTransferHdr."EDI Internal Doc. No." THEN
        EXIT;

      EDIChangedDocument.RESET;
      EDIChangedDocument.SETRANGE("Internal Doc. No.",CurrEDIRecDocHeader."Internal Doc. No.");
      EDIChangedDocument.SETRANGE("Document Type",EDIChangedDocument."Document Type"::Order);
      EDIChangedDocument.SETRANGE("Document No.",CurrTransferHdr."No.");
      IF EDIChangedDocument.FIND('-') THEN
        EXIT;

      EDIChangedDocument.RESET;
      EDIChangedDocument.SETRANGE("Internal Doc. No.",CurrEDIRecDocHeader."Internal Doc. No.");
      IF NOT EDIChangedDocument.FIND('+') THEN
        LineNo := 1
      ELSE
        LineNo := EDIChangedDocument."Entry No." + 1;
      EDIChangedDocument."Internal Doc. No." := CurrEDIRecDocHeader."Internal Doc. No.";
      EDIChangedDocument."Entry No." := LineNo;
      EDIChangedDocument."Document Type" := EDIChangedDocument."Document Type"::Order;
      EDIChangedDocument."Document No." := CurrTransferHdr."No.";
      EDIChangedDocument."Assoc. Internal Doc. No." := CurrTransferHdr."EDI Internal Doc. No.";
      EDIChangedDocument."Date Received" := CurrEDIRecDocHeader."Date Received";
      EDIChangedDocument."Time Received" := CurrEDIRecDocHeader."Time Received";
      EDIChangedDocument."EDI Document No." := CurrEDIRecDocHeader."EDI Document No.";
      EDIChangedDocument.INSERT;

      IF RecordAssocInternalDoc THEN
        IF EDIRecDocHdr2.GET(EDIChangedDocument."Assoc. Internal Doc. No." )THEN BEGIN
          AssocInternalDocNo := EDIRecDocHdr2."Internal Doc. No.";
          EDIChangedDocument.RESET;
          EDIChangedDocument.SETRANGE("Internal Doc. No.",EDIRecDocHdr2."Internal Doc. No.");
          IF NOT EDIChangedDocument.FIND('+') THEN
            LineNo := 1
          ELSE
            LineNo := EDIChangedDocument."Entry No." + 1;
          EDIChangedDocument."Internal Doc. No." := CurrTransferHdr."EDI Internal Doc. No.";
          EDIChangedDocument."Entry No." := LineNo;
          EDIChangedDocument."Document Type" := EDIChangedDocument."Document Type"::Order;
          EDIChangedDocument."Document No." := CurrTransferHdr."No.";
          EDIChangedDocument."Assoc. Internal Doc. No." := CurrEDIRecDocHeader."Internal Doc. No.";
          EDIChangedDocument.INSERT;
          EXIT(AssocInternalDocNo);
        END;
    END;

    PROCEDURE RecordAssocPostedDoc@1240020001(CurrEDIRecDocHeader@1000000002 : Record 14002358;RecRef@1000000001 : RecordRef;RecordAssocInternalDoc@1000000000 : Boolean;OverrideInternalDocNo@1240020003 : Code[10];OverrideEDIDocNo@1240020005 : Code[30]) AssocInternalDocNo : Code[10];
    VAR
      SalesShipmentHeader@1240020000 : Record 110;
      EDIChangedDocument@1000000005 : Record 14002373;
      LineNo@1000000004 : Integer;
      EDIRecDocHdr2@1000000003 : Record 14002358;
      DocumentNo@1240020001 : Code[20];
      DocInternalDocNo@1240020002 : Code[10];
      CurrentInternalDocNo@1240020004 : Code[10];
    BEGIN
      IF OverrideInternalDocNo <> '' THEN
        CurrentInternalDocNo := OverrideInternalDocNo
      ELSE
        CurrentInternalDocNo := CurrEDIRecDocHeader."Internal Doc. No.";

      CASE RecRef.NUMBER OF
        110:
          BEGIN
            RecRef.SETTABLE(SalesShipmentHeader);
            DocumentNo := SalesShipmentHeader."No.";
            DocInternalDocNo := SalesShipmentHeader."EDI Internal Doc. No.";
          END;
      END;

      IF CurrentInternalDocNo = DocInternalDocNo THEN
        EXIT;
      EDIChangedDocument.RESET;
      EDIChangedDocument.SETRANGE("Internal Doc. No.",CurrentInternalDocNo);
      EDIChangedDocument.SETRANGE("Document No.",DocumentNo);
      IF EDIChangedDocument.FIND('-') THEN
        EXIT;

      EDIChangedDocument.RESET;
      EDIChangedDocument.SETRANGE("Internal Doc. No.",CurrentInternalDocNo);
      IF NOT EDIChangedDocument.FIND('+') THEN
        LineNo := 1
      ELSE
        LineNo := EDIChangedDocument."Entry No." + 1;
      EDIChangedDocument."Internal Doc. No." := CurrentInternalDocNo;
      EDIChangedDocument."Entry No." := LineNo;
      EDIChangedDocument."Document Type" := EDIChangedDocument."Document Type"::" ";
      EDIChangedDocument."Document No." := DocumentNo;
      EDIChangedDocument."Assoc. Internal Doc. No." := DocInternalDocNo;
      IF OverrideInternalDocNo <> '' THEN BEGIN
        EDIChangedDocument."Date Received" := TODAY;
        EDIChangedDocument."Time Received" := TIME;
        EDIChangedDocument."EDI Document No." := OverrideEDIDocNo;
      END ELSE BEGIN
        EDIChangedDocument."Date Received" := CurrEDIRecDocHeader."Date Received";
        EDIChangedDocument."Time Received" := CurrEDIRecDocHeader."Time Received";
        EDIChangedDocument."EDI Document No." := CurrEDIRecDocHeader."EDI Document No.";
      END;
      EDIChangedDocument.INSERT;

      IF RecordAssocInternalDoc THEN
        IF EDIRecDocHdr2.GET(EDIChangedDocument."Assoc. Internal Doc. No." )THEN BEGIN
          IF OverrideInternalDocNo <> '' THEN
            AssocInternalDocNo := OverrideInternalDocNo
          ELSE
            AssocInternalDocNo := EDIRecDocHdr2."Internal Doc. No.";
          EDIChangedDocument.RESET;
          EDIChangedDocument.SETRANGE("Internal Doc. No.",EDIRecDocHdr2."Internal Doc. No.");
          IF NOT EDIChangedDocument.FIND('+') THEN
            LineNo := 1
          ELSE
            LineNo := EDIChangedDocument."Entry No." + 1;
          EDIChangedDocument."Internal Doc. No." := DocInternalDocNo;
          EDIChangedDocument."Entry No." := LineNo;
          EDIChangedDocument."Document Type" := EDIChangedDocument."Document Type"::" ";
          EDIChangedDocument."Document No." := DocumentNo;
          EDIChangedDocument."Assoc. Internal Doc. No." := AssocInternalDocNo;
          EDIChangedDocument.INSERT;
          EXIT(AssocInternalDocNo);
        END;
    END;

    BEGIN
    END.
  }
}

