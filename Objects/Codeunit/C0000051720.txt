OBJECT Codeunit 51720 Table81EventSubscriber
{
  OBJECT-PROPERTIES
  {
    Date=09/09/20;
    Time=[ 1:16:09 PM];
    Modified=Yes;
    Version List=NAVEVENT;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {

    [EventSubscriber(Table,81,OnAfterInsertEvent)]
    LOCAL PROCEDURE Tb81_OnInsert@1000000006(VAR Rec@1000000000 : Record 81;RunTrigger@1000000001 : Boolean);
    BEGIN
      IF NOT RunTrigger THEN
        EXIT;

      Tb81_ValidateShortcutDimCode(5,Rec."Shortcut Dimension 5 Code",Rec);
    END;

    [EventSubscriber(Table,81,OnAfterSetupNewLine)]
    PROCEDURE Tb81_SetUpNewLine@1000000003(VAR GenJournalLine@1000000000 : Record 81;GenJournalTemplate@1000000001 : Record 80;GenJournalBatch@1000000002 : Record 232;LastGenJournalLine@1000000003 : Record 81;Balance@1000000004 : Decimal;BottomLine@1000000005 : Boolean);
    BEGIN
      GenJournalLine."Shortcut Dimension 5 Code" := GenJournalBatch."Shortcut Dimension 5 Code";
    END;

    [EventSubscriber(Codeunit,51721,Tb81_OnShowDimensions)]
    PROCEDURE Tb81_ShowDimensions@15(VAR Sender@1000000001 : Codeunit 51721;VAR Rec@1000000002 : Record 81);
    VAR
      DimMgt@1000000000 : Codeunit 408;
      Cu225EventSubscriber@1000000003 : Codeunit 51908;
    BEGIN
      WITH Rec DO BEGIN
        //DimMgt.EditDimensionSet2Custom("Dimension Set ID",STRSUBSTNO('%1 %2 %3',"Journal Template Name","Journal Batch Name","Line No."),
          //      "Shortcut Dimension 1 Code","Shortcut Dimension 2 Code","Shortcut Dimension 5 Code");
       "Dimension Set ID" := Cu225EventSubscriber.Cu408_EditDimensionSet2Custom("Dimension Set ID",STRSUBSTNO('%1 %2 %3',"Journal Template Name","Journal Batch Name","Line No."),
                "Shortcut Dimension 1 Code","Shortcut Dimension 2 Code","Shortcut Dimension 5 Code");
        MODIFY;
        COMMIT;
        ERROR('');
      END;
    END;

    PROCEDURE Tb81_ValidateShortcutDimCode@14(FieldNumber@1000 : Integer;VAR ShortcutDimCode@1001 : Code[20];GenJnlLine@1000000001 : Record 81);
    VAR
      DimMgt@1000000000 : Codeunit 408;
    BEGIN
      GenJnlLine.TESTFIELD("Check Printed",FALSE);
      DimMgt.ValidateShortcutDimValues(FieldNumber,ShortcutDimCode,GenJnlLine."Dimension Set ID");
    END;

    [EventSubscriber(Table,81,OnAfterCopyGenJnlLineFromInvPostBuffer)]
    LOCAL PROCEDURE TB81_CopyFromInvoicePostBuffer@1000000000(InvoicePostBuffer@1000000000 : Record 49;VAR GenJournalLine@1000000001 : Record 81);
    BEGIN
      GenJournalLine."Shortcut Dimension 5 Code" := InvoicePostBuffer."Shortcut Dimension 5 Code";
    END;

    BEGIN
    {
      2020-05-05  TPZ2830  PSHUKLA  Created new object
    }
    END.
  }
}

