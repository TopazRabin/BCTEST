OBJECT Codeunit 51812 Page31EventSubscriber
{
  OBJECT-PROPERTIES
  {
    Date=10/15/20;
    Time=[ 1:38:05 PM];
    Modified=Yes;
    Version List=NAVEVT0.0.0;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {

    [EventSubscriber(Page,31,OnAfterActionEvent,CustAvailPrice)]
    LOCAL PROCEDURE P31_CustAvailPrice_OnAction@1000000001(VAR Rec@1000000000 : Record 27);
    VAR
      ItemCustAvailPage@1000000001 : Page 50048;
      CustRec@1000000002 : Record 18;
    BEGIN
      //<TPZ2861>
      //TOP100B KT ABCSI Item Cust. Avail. & Price 03192015
      CLEAR(ItemCustAvailPage);
      ItemCustAvailPage.SetRecords(Rec,CustRec,TRUE);
      ItemCustAvailPage.UpdateQuantities;
      ItemCustAvailPage.ACTIVATE;
      ItemCustAvailPage.RUN;
      //TOP100B KT ABCSI Item Cust. Avail. & Price 03192015
      //<TPZ2861>
    END;

    [EventSubscriber(Page,31,OnAfterActionEvent,Action1000000018)]
    LOCAL PROCEDURE P31_ChangeLogEntry_OnAction@1000000000(VAR Rec@1000000000 : Record 27);
    VAR
      ChangeLogEntry@1000000002 : Record 405;
      ChangeLogMgt@1000000001 : Codeunit 423;
      Codeunit423EventSubscriber@1000000003 : Codeunit 51876;
    BEGIN
      //<TPZ2861>
      WITH Rec DO BEGIN
        //<TPZ1728>
        //ChangeLogMgt.OpenSSRSReport(DATABASE::Item, "No.", '','');
        Codeunit423EventSubscriber.CU423_OpenSSRSReport(DATABASE::Item, "No.", '','');
        //EXIT;
        //</TPZ1728>

      END;
      //</TPZ2861>
    END;

    [EventSubscriber(Page,31,OnAfterActionEvent,Action1000000026)]
    LOCAL PROCEDURE P31_InvtHistDetail_OnAction@1000000002(VAR Rec@1000000000 : Record 27);
    VAR
      URL@1000000002 : Text[1000];
      HttpUtility@1000000001 : DotNet "'System.Web, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a'.System.Web.HttpUtility";
    BEGIN
      //<TPZ2861>
      WITH Rec DO BEGIN
        // <TPZ135>
        URL :=
        'http://nyvsvnavsql5/reportserver?/User%20Reports%20-%20Product/Inventory%20History%20Details&rs:Command=Render&ItemNo=' +
        //<TPZ1583>
        HttpUtility.UrlEncode("No.");
        //</TPZ1583>

        HYPERLINK(URL);
        // </TPZ135>
      END;
      //</TPZ2861>
    END;

    [EventSubscriber(Page,31,OnAfterActionEvent,InvHistDetailsNoVirtualSales)]
    LOCAL PROCEDURE P31_InvHistDetailsNoVirtualSales_OnAction@1000000003(VAR Rec@1000000000 : Record 27);
    VAR
      URL@1000000002 : Text[1000];
      HttpUtility@1000000001 : DotNet "'System.Web, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a'.System.Web.HttpUtility";
    BEGIN
      //<TPZ2861>
      WITH Rec DO BEGIN
        // <TPZ135>
        URL :=
        'http://nyvsvnavsql5/reportserver?/User%20Reports%20-%20Product/Inventory%20History%20Details%20No%20Virtual%20Sales&rs:Command=Render&ItemNo=' +
        //<TPZ1583>
        HttpUtility.UrlEncode("No.");
        //</TPZ1583>

        HYPERLINK(URL);
        // </TPZ135>
      END;
      //</TPZ2861>
    END;

    [EventSubscriber(Page,31,OnAfterActionEvent,Action1000000025)]
    LOCAL PROCEDURE P31_AltUOMInventoryHistoryDetails_OnAction@1000000004(VAR Rec@1000000000 : Record 27);
    VAR
      URL@1000000002 : Text[1000];
      HttpUtility@1000000001 : DotNet "'System.Web, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a'.System.Web.HttpUtility";
    BEGIN
      //<TPZ2861>
      WITH Rec DO BEGIN
        // <TPZ135>
        URL :=
        'http://nyvsvnavsql5/reportserver?/User%20Reports%20-%20Product/Inventory%20History%20Details&rs:Command=Render&ItemNo=' +
          //<TPZ1583>
          HttpUtility.UrlEncode("No.");
          //</TPZ1583>

        URL :=
          URL +
          '&DisplayQtysInAltPurchUOM=True';

        HYPERLINK(URL);
        // </TPZ135>
      END;
      //</TPZ2861>
    END;

    [EventSubscriber(Page,31,OnAfterActionEvent,InvHistDetailsNoVirtualSalesAltUOM)]
    LOCAL PROCEDURE P31_InvHistDetailsNoVirtualSalesAltUOM_OnAction@1000000005(VAR Rec@1000000000 : Record 27);
    VAR
      URL@1000000002 : Text[1000];
      HttpUtility@1000000001 : DotNet "'System.Web, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a'.System.Web.HttpUtility";
    BEGIN
      //<TPZ2861>
      WITH Rec DO BEGIN
        // <TPZ135>
        URL :=
        'http://nyvsvnavsql5/reportserver?/User%20Reports%20-%20Product/Inventory%20History%20Details%20No%20Virtual%20Sales&rs:Command=Render&ItemNo=' +
        //<TPZ1583>
        HttpUtility.UrlEncode("No.");
        //</TPZ1583>

        URL :=
        URL +
        '&DisplayQtysInAltPurchUOM=True';

        HYPERLINK(URL);
        // </TPZ135>
      END;
      //</TPZ2861>
    END;

    BEGIN
    {
      TPZ2861 RSAH 05192020
        - Event Conversion
    }
    END.
  }
}

