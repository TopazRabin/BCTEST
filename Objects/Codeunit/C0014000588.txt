OBJECT Codeunit 14000588 User Role Setup
{
  OBJECT-PROPERTIES
  {
    Date=03/01/20;
    Time=12:00:00 PM;
    Version List=UBP3.02;
  }
  PROPERTIES
  {
    OnRun=BEGIN
            CreateSuperRole;
            CreateBasicRole;
          END;

  }
  CODE
  {

    LOCAL PROCEDURE CreateSuperRole@1240020000();
    VAR
      UserRole@1240020003 : Record 2000000004;
      Permission@1240020002 : Record 2000000005;
      AllObj@1240020001 : Record 2000000038;
      TableType@1240020000 : ' ,Setup,Work,Post,Limited';
      Text001@1240020004 : TextConst 'ENU=LAX-DP-SUPER User Role Created';
    BEGIN
            IF UserRole.GET('LAX-DP-SUPER') THEN BEGIN
              UserRole.DELETE(TRUE);
              COMMIT;
            END;
            UserRole."Role ID" := 'LAX-DP-SUPER';
            UserRole.Name := 'Super User Demand Planning';
            IF NOT UserRole.INSERT THEN ;
            AllObj.RESET;
            AllObj.SETRANGE("Object Type",AllObj."Object Type"::TableData);
            AllObj.SETFILTER(
              "Object ID",
                '14000551..14000600|14002601..14002620|14002651..14002670|14002671..14002699|14002701..14002710|' +
                '14097450..14097499|14097601..14097680|14098050..14098069|14100351..14100370');
            IF AllObj.FIND('-') THEN
              REPEAT
                Permission."Role ID" := UserRole."Role ID";
                Permission."Object Type" := AllObj."Object Type";
                Permission."Object ID" := AllObj."Object ID";
                Permission."Read Permission" := Permission."Read Permission"::Yes;
                Permission."Insert Permission" := Permission."Insert Permission"::Yes;
                Permission."Modify Permission" := Permission."Modify Permission"::Yes;
                Permission."Delete Permission" := Permission."Delete Permission"::Yes;
                Permission."Execute Permission" := Permission."Execute Permission"::Yes;
                IF NOT Permission.INSERT THEN ;
              UNTIL AllObj.NEXT = 0;

            IF GUIALLOWED THEN
            MESSAGE(Text001);
    END;

    LOCAL PROCEDURE CreateBasicRole@1240020001();
    VAR
      UserRole@1240020003 : Record 2000000004;
      Permission@1240020002 : Record 2000000005;
      AllObj@1240020001 : Record 2000000038;
      TableType@1240020000 : ' ,Setup,Work,Post,Limited';
      Text001@1240020004 : TextConst 'ENU=LAX-DP-Basic User Role Created';
    BEGIN
      IF UserRole.GET('LAX-DP-BASIC') THEN BEGIN
        UserRole.DELETE(TRUE);
        COMMIT;
      END;
      UserRole."Role ID" := 'LAX-DP-Basic';
      UserRole.Name := 'Basic User Demand Planning';
      IF NOT UserRole.INSERT THEN ;
      AllObj.RESET;
      AllObj.SETRANGE("Object Type",AllObj."Object Type"::TableData);
      AllObj.SETFILTER(
        "Object ID",
          '14000551..14000600|14002601..14002620|14002651..14002670|14002671..14002699|14002701..14002710|' +
          '14097450..14097499|14097601..14097680|14098050..14098069|14100351..14100370');
      IF AllObj.FIND('-') THEN
        REPEAT
          Permission."Role ID" := UserRole."Role ID";
          Permission."Object Type" := AllObj."Object Type";
          Permission."Object ID" := AllObj."Object ID";
          Permission."Read Permission" := Permission."Read Permission"::Yes;
          Permission."Insert Permission" := Permission."Insert Permission"::" ";
          Permission."Modify Permission" := Permission."Modify Permission"::" ";
          Permission."Delete Permission" := Permission."Delete Permission"::" ";
          Permission."Execute Permission" := Permission."Execute Permission"::Yes;
          IF NOT Permission.INSERT THEN ;
        UNTIL AllObj.NEXT = 0;
      IF GUIALLOWED THEN
        MESSAGE(Text001);
    END;

    BEGIN
    END.
  }
}

