OBJECT Codeunit 14000764 UPS Select
{
  OBJECT-PROPERTIES
  {
    Date=06/28/17;
    Time=12:00:00 PM;
    Version List=SE0.60.13;
  }
  PROPERTIES
  {
    OnRun=BEGIN
            GetShippingSetup;

            IF ShippingSetup."UPS Version" = ShippingSetup."UPS Version"::HMU THEN
              PAGE.RUN(PAGE::"UPS Shipping Agent Account")
            ELSE
              PAGE.RUN(PAGE::"UPSlink Shipping Agent Account");
          END;

  }
  CODE
  {
    VAR
      ShippingSetup@1000000002 : Record 14000707;
      UPSTransaction@1240030001 : Codeunit 14000761;
      UPSlinkTransaction@1240030000 : Codeunit 14050001;
      ShippingSetupRetrieved@1000000006 : Boolean;
      Text037@1037 : TextConst 'ENU=Not Avaliable for %1 %2';

    PROCEDURE UPSAcctValidatePackingStation@1240030002(VAR CarrierPackingStation@1240030003 : Record 14000729);
    VAR
      UPSShippingAgentAccount@1240030002 : Record 14000770;
      UPSlinkShippingAgentAccount@1240030001 : Record 14050005;
    BEGIN
      GetShippingSetup;

      IF ShippingSetup."UPS Version" = ShippingSetup."UPS Version"::HMU THEN
        UPSShippingAgentAccount.GET(CarrierPackingStation."UPS Shipping Agent Account No.")
      ELSE
        UPSlinkShippingAgentAccount.GET(CarrierPackingStation."UPS Shipping Agent Account No.");
    END;

    PROCEDURE UPSAcctLookupPackingStation@1240030001(VAR CarrierPackingStation@1240030000 : Record 14000729);
    VAR
      UPSShippingAgentAccount@1240030002 : Record 14000770;
      UPSlinkShippingAgentAccount@1240030001 : Record 14050005;
    BEGIN
      GetShippingSetup;

      IF ShippingSetup."UPS Version" = ShippingSetup."UPS Version"::HMU THEN BEGIN
        IF PAGE.RUNMODAL(0,UPSShippingAgentAccount) = ACTION::LookupOK THEN
          CarrierPackingStation.VALIDATE(
            "UPS Shipping Agent Account No.",UPSShippingAgentAccount."Account No.");
      END ELSE
        IF PAGE.RUNMODAL(0,UPSlinkShippingAgentAccount) = ACTION::LookupOK THEN
          CarrierPackingStation.VALIDATE(
            "UPS Shipping Agent Account No.",UPSlinkShippingAgentAccount."Account No.");
    END;

    PROCEDURE GetShippingCharge@8(VAR CurrentPackage@1000000000 : Record 14000701;UpdateWeightAndValues@1000000001 : Boolean);
    BEGIN
      GetShippingSetup;

      CASE ShippingSetup."UPS Version" OF
        ShippingSetup."UPS Version"::HMU:
          UPSTransaction.GetShippingCharge(CurrentPackage,UpdateWeightAndValues);
        ShippingSetup."UPS Version"::UPSlink,ShippingSetup."UPS Version"::"UPSlink/UPS Web Service":
          UPSlinkTransaction.GetShippingCharge(CurrentPackage,UpdateWeightAndValues);
      END;
    END;

    PROCEDURE RateShop@16(RateShopHeader@1000000000 : Record 14000741;VAR RateShopLine@1000000001 : Record 14000742;CurrentShippingAgentService@1000000002 : Record 14000708);
    BEGIN
      GetShippingSetup;

      CASE ShippingSetup."UPS Version" OF
        ShippingSetup."UPS Version"::HMU:
          UPSTransaction.RateShop(RateShopHeader,RateShopLine,CurrentShippingAgentService);
        ShippingSetup."UPS Version"::UPSlink,ShippingSetup."UPS Version"::"UPSlink/UPS Web Service":
          UPSlinkTransaction.RateShop(RateShopHeader,RateShopLine,CurrentShippingAgentService);
      END;
    END;

    PROCEDURE ClosePackage@18(VAR CurrentPackage@1240030000 : Record 14000701;VAR MultiDocPackageTmp@1240030001 : Record 14000701;CurrentShippingAgent@1240030002 : Record 291;PrintLabel@1240030003 : Boolean);
    BEGIN
      GetShippingSetup;

      CASE ShippingSetup."UPS Version" OF
        ShippingSetup."UPS Version"::HMU:
          UPSTransaction.ClosePackage(CurrentPackage,MultiDocPackageTmp,CurrentShippingAgent,PrintLabel);
        ShippingSetup."UPS Version"::UPSlink,ShippingSetup."UPS Version"::"UPSlink/UPS Web Service":
          UPSlinkTransaction.ClosePackage(CurrentPackage,MultiDocPackageTmp,CurrentShippingAgent,PrintLabel);
      END;
    END;

    PROCEDURE OpenPackage@19(VAR CurrentPackage@1000000000 : Record 14000701);
    BEGIN
      GetShippingSetup;

      CASE ShippingSetup."UPS Version" OF
        ShippingSetup."UPS Version"::HMU:
          UPSTransaction.OpenPackage(CurrentPackage);
        ShippingSetup."UPS Version"::UPSlink,ShippingSetup."UPS Version"::"UPSlink/UPS Web Service":
          UPSlinkTransaction.OpenPackage(CurrentPackage);
      END;
    END;

    PROCEDURE ReOpenPostedPackage@44(VAR CurrentPostedPackage@1000000000 : Record 14000704);
    BEGIN
      GetShippingSetup;

      CASE ShippingSetup."UPS Version" OF
        ShippingSetup."UPS Version"::HMU:
          UPSTransaction.ReOpenPostedPackage(CurrentPostedPackage);
        ShippingSetup."UPS Version"::UPSlink,ShippingSetup."UPS Version"::"UPSlink/UPS Web Service":
          UPSlinkTransaction.ReOpenPostedPackage(CurrentPostedPackage);
      END;
    END;

    PROCEDURE PrintPackageLabel@24(VAR CurrentPackage@1000000000 : Record 14000701);
    BEGIN
      GetShippingSetup;

      CASE ShippingSetup."UPS Version" OF
        ShippingSetup."UPS Version"::HMU:
          UPSTransaction.PrintPackageLabel(CurrentPackage);
        ShippingSetup."UPS Version"::UPSlink,ShippingSetup."UPS Version"::"UPSlink/UPS Web Service":
          UPSlinkTransaction.PrintPackageLabel(CurrentPackage);
      END;
    END;

    PROCEDURE PrintCODLabel@36(CurrentPackage@1000000000 : Record 14000701);
    BEGIN
      GetShippingSetup;
      IF ShippingSetup."UPS Version" = ShippingSetup."UPS Version"::HMU THEN
        UPSTransaction.PrintCODLabel(CurrentPackage);
    END;

    PROCEDURE RePrintPostedPackageLabel@39(VAR CurrentPostedPackage@1000000000 : Record 14000704);
    BEGIN
      GetShippingSetup;

      CASE ShippingSetup."UPS Version" OF
        ShippingSetup."UPS Version"::HMU:
          UPSTransaction.RePrintPostedPackageLabel(CurrentPostedPackage);
        ShippingSetup."UPS Version"::UPSlink,ShippingSetup."UPS Version"::"UPSlink/UPS Web Service":
          UPSlinkTransaction.RePrintPostedPackageLabel(CurrentPostedPackage);
      END;
    END;

    PROCEDURE PrintReturnLabelOrion@27(CurrentPackage@1240030000 : Record 14000701;ToLine@1240030001 : ARRAY [7] OF Text[100];AddressBlock@1240030002 : ARRAY [7] OF Text[100];AdditionalRouting@1240030003 : ARRAY [7] OF Text[100];ShippingServiceCode@1240030004 : Text[100];TrackingNo@1240030005 : Text[100]);
    BEGIN
      GetShippingSetup;

      CASE ShippingSetup."UPS Version" OF
        ShippingSetup."UPS Version"::HMU:
          UPSTransaction.PrintReturnLabelOrion(
            CurrentPackage,ToLine,AddressBlock,AdditionalRouting,ShippingServiceCode,TrackingNo);
        ShippingSetup."UPS Version"::UPSlink,ShippingSetup."UPS Version"::"UPSlink/UPS Web Service":
          UPSlinkTransaction.PrintReturnLabel(
            CurrentPackage,ToLine,AddressBlock,AdditionalRouting,ShippingServiceCode,TrackingNo);
      END;
    END;

    PROCEDURE PrintReturnLabelZebra@32(CurrentPackage@1240030000 : Record 14000701;ToLine@1240030001 : ARRAY [7] OF Text[100];AddressBlock@1240030002 : ARRAY [7] OF Text[100];AdditionalRouting@1240030003 : ARRAY [7] OF Text[100];ShippingServiceCode@1240030004 : Text[100];TrackingNo@1240030005 : Text[100]);
    BEGIN
      GetShippingSetup;

      CASE ShippingSetup."UPS Version" OF
        ShippingSetup."UPS Version"::HMU:
          UPSTransaction.PrintReturnLabelZebra(
            CurrentPackage,ToLine,AddressBlock,AdditionalRouting,ShippingServiceCode,TrackingNo);
        ShippingSetup."UPS Version"::UPSlink,ShippingSetup."UPS Version"::"UPSlink/UPS Web Service":
          UPSlinkTransaction.PrintReturnLabel(
            CurrentPackage,ToLine,AddressBlock,AdditionalRouting,ShippingServiceCode,TrackingNo);
      END;
    END;

    PROCEDURE PrintPickupLabel@54(PickupCode@1000000000 : Code[15];PickupDate@1000000001 : Date;LastAccountNo@1000000002 : Code[30];ShippingInfo@1000000003 : Text[30];DomesticPackageCount@1000000004 : Integer;IntPackageCount@1000000005 : Decimal;MidPackCount@1000000006 : Decimal;BigPackCount@1000000007 : Decimal;CODPackCount@1000000008 : Decimal;NextDayAirPackages@1000000009 : Integer;SecondDayAirPackages@1000000010 : Integer;ThirdDayAirPackages@1000000011 : Integer;IntShipments@1240030000 : Decimal) : Text[250];
    BEGIN
      GetShippingSetup;

      CASE ShippingSetup."UPS Version" OF
        ShippingSetup."UPS Version"::HMU:
          EXIT(
            UPSTransaction.PrintPickupLabel(
              PickupCode,PickupDate,LastAccountNo,ShippingInfo,DomesticPackageCount,IntPackageCount,
              MidPackCount,BigPackCount,CODPackCount,NextDayAirPackages,SecondDayAirPackages,ThirdDayAirPackages));
        ShippingSetup."UPS Version"::UPSlink,ShippingSetup."UPS Version"::"UPSlink/UPS Web Service":
          EXIT(
            UPSlinkTransaction.PrintPickupLabel(
              PickupCode,PickupDate,LastAccountNo,ShippingInfo,DomesticPackageCount,IntPackageCount,
              MidPackCount,BigPackCount,CODPackCount,NextDayAirPackages,SecondDayAirPackages,ThirdDayAirPackages,
              IntShipments));
      END;
    END;

    PROCEDURE PackageInsertOptionPage@1240020001(CurrentPackage@1240020001 : Record 14000701;VAR UPSOptionPage@1240020000 : Record 14000761) : Boolean;
    VAR
      UPSlinkShippingAgentAccount@1240020002 : Record 14050005;
    BEGIN
      GetShippingSetup;

      CASE ShippingSetup."UPS Version" OF
        ShippingSetup."UPS Version"::UPSlink,ShippingSetup."UPS Version"::"UPSlink/UPS Web Service":
          BEGIN
              UPSlinkShippingAgentAccount.GET(CurrentPackage."Shipping Agent Account No.");
              IF UPSOptionPage.GET(UPSOptionPage.Type::Package,CurrentPackage."No.",0,0,'') THEN BEGIN
                UPSOptionPage."Direct Delivery Only" := UPSlinkShippingAgentAccount."Direct Delivery Only";
                EXIT(TRUE);
              END;
          END;
        ELSE
          EXIT(FALSE);
      END;
    END;

    PROCEDURE CreateManifest@43(ShippingAgentAccount@1000000000 : Code[20]);
    VAR
      UPSShippingAgentAccount@1000000001 : Record 14000770;
      UPSlinkShippingAgentAccount@1240030000 : Record 14050005;
    BEGIN
      GetShippingSetup;

      CASE ShippingSetup."UPS Version" OF
        ShippingSetup."UPS Version"::HMU:
          BEGIN
            UPSShippingAgentAccount.GET(ShippingAgentAccount);
            UPSTransaction.CreateManifest(UPSShippingAgentAccount);
          END;
        ShippingSetup."UPS Version"::UPSlink,ShippingSetup."UPS Version"::"UPSlink/UPS Web Service":
          BEGIN
            UPSlinkShippingAgentAccount.GET(ShippingAgentAccount);
            UPSlinkTransaction.CreateManifest(UPSlinkShippingAgentAccount);
          END;
      END;
    END;

    PROCEDURE CloseManifest@53(CurrentManifestHeader@1000000000 : Record 14000712);
    BEGIN
      GetShippingSetup;

      CASE ShippingSetup."UPS Version" OF
        ShippingSetup."UPS Version"::HMU:
          UPSTransaction.CloseManifest(CurrentManifestHeader);
        ShippingSetup."UPS Version"::UPSlink,ShippingSetup."UPS Version"::"UPSlink/UPS Web Service":
          UPSlinkTransaction.CloseManifest(CurrentManifestHeader);
      END;
    END;

    PROCEDURE OpenManifest@65(CurrentManifestHeader@1000000000 : Record 14000712);
    BEGIN
      GetShippingSetup;

      CASE ShippingSetup."UPS Version" OF
        ShippingSetup."UPS Version"::HMU:
          UPSTransaction.OpenManifest(CurrentManifestHeader);
        ShippingSetup."UPS Version"::UPSlink,ShippingSetup."UPS Version"::"UPSlink/UPS Web Service":
          UPSlinkTransaction.OpenManifest(CurrentManifestHeader);
      END;
    END;

    PROCEDURE VoidManifestLine@1240030000(ManifestLine@1240030000 : Record 14000713);
    BEGIN
      GetShippingSetup;

      CASE ShippingSetup."UPS Version" OF
        ShippingSetup."UPS Version"::HMU:
          ERROR(Text037,ShippingSetup.FIELDCAPTION("UPS Version"),ShippingSetup."UPS Version");
        ShippingSetup."UPS Version"::UPSlink,ShippingSetup."UPS Version"::"UPSlink/UPS Web Service":
          UPSlinkTransaction.VoidManifestLine(ManifestLine);
      END;
    END;

    LOCAL PROCEDURE GetShippingSetup@33();
    BEGIN
      IF NOT ShippingSetupRetrieved THEN BEGIN
        ShippingSetup.GET;
        ShippingSetupRetrieved := TRUE;
      END;
    END;

    PROCEDURE TrackPackage@1240030003(CurrentPackage@1240030000 : Record 14000701);
    BEGIN
      GetShippingSetup;

      CASE ShippingSetup."UPS Version" OF
        ShippingSetup."UPS Version"::HMU:
          UPSTransaction.TrackPackage(CurrentPackage);
        ShippingSetup."UPS Version"::UPSlink:
          UPSlinkTransaction.TrackPackage(CurrentPackage);
        ShippingSetup."UPS Version"::"UPSlink/UPS Web Service":
          UPSlinkTransaction.TrackPackage(CurrentPackage);
      END;
    END;

    PROCEDURE CheckManifest@1240020000(CurrentManifestHeader@1240020000 : Record 14000712) : Boolean;
    BEGIN
      GetShippingSetup;

      CASE ShippingSetup."UPS Version" OF
        ShippingSetup."UPS Version"::HMU:
          EXIT(TRUE);
        ShippingSetup."UPS Version"::UPSlink,ShippingSetup."UPS Version"::"UPSlink/UPS Web Service":
          EXIT(UPSlinkTransaction.CheckManifest(CurrentManifestHeader));
        ELSE
          EXIT(TRUE);
      END;
    END;

    PROCEDURE DeleteExportSourceDoc@1240030049(ExportSourceDoc@1240030000 : Record 14000982);
    BEGIN
      GetShippingSetup;

      CASE ShippingSetup."UPS Version" OF
        ShippingSetup."UPS Version"::HMU:
          EXIT;
        ShippingSetup."UPS Version"::UPSlink,ShippingSetup."UPS Version"::"UPSlink/UPS Web Service":
          UPSlinkTransaction.DeleteExportSourceDoc(ExportSourceDoc);
      END;
    END;

    PROCEDURE DeleteExportDoc@1240030050(ExportDocNo@1240030000 : Code[20]);
    BEGIN
      GetShippingSetup;

      CASE ShippingSetup."UPS Version" OF
        ShippingSetup."UPS Version"::HMU:
          EXIT;
        ShippingSetup."UPS Version"::UPSlink,ShippingSetup."UPS Version"::"UPSlink/UPS Web Service":
          UPSlinkTransaction.DeleteExportDoc(ExportDocNo);
      END;
    END;

    PROCEDURE PrintExportDocsOnCloseOrder@1240030051(ExportDocNo@1240030000 : Code[20]) : Boolean;
    BEGIN
      GetShippingSetup;

      CASE ShippingSetup."UPS Version" OF
        ShippingSetup."UPS Version"::HMU:
          EXIT(TRUE);
        ShippingSetup."UPS Version"::UPSlink,ShippingSetup."UPS Version"::"UPSlink/UPS Web Service":
          EXIT(UPSlinkTransaction.PrintExportDocsOnCloseOrder(ExportDocNo));
      END;
    END;

    PROCEDURE CheckName@1240030500(CurrentShippingAgent@1240030010 : Record 291;FromType@1240030003 : 'Package,Document,Master Data';VAR Name@1240030001 : Text[100];VAR Name2@1240030002 : Text[100];VAR Contact@1240030005 : Text[100];NameCaption@1240030009 : Text[100];Name2Caption@1240030008 : Text[100];ContactCaption@1240030000 : Text[100]);
    BEGIN
      GetShippingSetup;

      CASE ShippingSetup."UPS Version" OF
        ShippingSetup."UPS Version"::HMU:
          UPSTransaction.CheckName(
            CurrentShippingAgent,FromType,Name,Name2,Contact,
            NameCaption,Name2Caption,ContactCaption);
        ShippingSetup."UPS Version"::UPSlink,ShippingSetup."UPS Version"::"UPSlink/UPS Web Service":
          UPSlinkTransaction.CheckName(
            CurrentShippingAgent,FromType,Name,Name2,Contact,
            NameCaption,Name2Caption,ContactCaption);
      END;
    END;

    PROCEDURE CheckAddress@1240030501(CurrentShippingAgent@1240030010 : Record 291;FromType@1240030014 : 'Package,Document,Master Data';VAR Address@1240030012 : Text[100];VAR Address2@1240030011 : Text[100];VAR City@1240030009 : Text[100];VAR PostCode@1240030008 : Code[100];VAR State@1240030007 : Text[100];VAR Country@1240030006 : Code[100];AddressCaption@1240030005 : Text[100];Address2Caption@1240030004 : Text[100];CityCaption@1240030003 : Text[100];PostCodeCaption@1240030002 : Text[100];StateCaption@1240030001 : Text[100];CountryCaption@1240030000 : Text[100]);
    BEGIN
      GetShippingSetup;

      CASE ShippingSetup."UPS Version" OF
        ShippingSetup."UPS Version"::HMU:
          UPSTransaction.CheckAddress(
            CurrentShippingAgent,FromType,Address,Address2,City,PostCode,State,Country,
            AddressCaption,Address2Caption,CityCaption,PostCodeCaption,StateCaption,CountryCaption);
        ShippingSetup."UPS Version"::UPSlink,ShippingSetup."UPS Version"::"UPSlink/UPS Web Service":
          UPSlinkTransaction.CheckAddress(
            CurrentShippingAgent,FromType,Address,Address2,City,PostCode,State,Country,
            AddressCaption,Address2Caption,CityCaption,PostCodeCaption,StateCaption,CountryCaption);
      END;
    END;

    BEGIN
    END.
  }
}

