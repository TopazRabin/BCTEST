OBJECT Codeunit 14000560 Create Purchase Order (Yes/No)
{
  OBJECT-PROPERTIES
  {
    Date=03/23/09;
    Time=12:00:00 PM;
    Version List=UBP2.51;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {

    PROCEDURE CreatePurchOrder@1(SugOrderHeader@14000500 : Record 14000565);
    VAR
      SurplusInvValue@1240030000 : Record 14000584;
      CreatePurchOrder@14000501 : Codeunit 14000561;
      Text000@14000502 : TextConst 'ENU=Do you wish to create a purchase order for vendor %1?';
      Text001@1001 : TextConst 'ENU=Transfer Orders have not been created.';
    BEGIN
      IF CONFIRM(Text000,FALSE,SugOrderHeader."Buy-from Vendor No.") THEN BEGIN
        SurplusInvValue.RESET;
        SurplusInvValue.SETRANGE("Buy-from Vendor No.",SugOrderHeader."Buy-from Vendor No.");
        SurplusInvValue.SETRANGE("Suggested Order No.",SugOrderHeader."No.");
        SurplusInvValue.SETFILTER("Quantity To Transfer",'<>%1',0);
        IF SurplusInvValue.FIND('-') THEN
          REPEAT
            IF SurplusInvValue."Quantity To Transfer" <> SurplusInvValue."Quantity Transferred" THEN
              ERROR(Text001);
          UNTIL SurplusInvValue.NEXT = 0;
        CODEUNIT.RUN(CODEUNIT::"Create Purchase Order",SugOrderHeader);
      END;
    END;

    BEGIN
    END.
  }
}

