OBJECT Codeunit 14050305 E.D.I. EvaluateXRef Separately
{
  OBJECT-PROPERTIES
  {
    Date=03/06/15;
    Time=12:00:00 PM;
    Version List=SE0.60.06;
  }
  PROPERTIES
  {
    TableNo=14002358;
    OnRun=BEGIN
            {EDISetup.GET;
            CASE TRUE OF
              EDISetup."Enable General Cross Ref.":
                GeneralCrossReference := TRUE;
              EDISetup."Pre-evaluate Std. Cross Ref.":
                PreEvaluate := TRUE
              ELSE
                EXIT;
            END;}

            EDIRecDocHdr.GET("Internal Doc. No.");
            IF GeneralCrossReference THEN BEGIN
              EvaluateGeneralCrossReference;
              EDIRecDocHdr.CALCFIELDS("General Cross Reference Error");
              IF EDIRecDocHdr."General Cross Reference Error" THEN
                ERROR(Text001);
            END;
            IF PreEvaluate THEN BEGIN
              PreEvaluateCrossReferences;
              IF ((EDIRecDocHdr."Customer Cross Ref. Error") OR
                  (EDIRecDocHdr."Item Cross Ref. Error") OR
                  (EDIRecDocHdr."UOM Cross Ref. Error")) AND
                  (NOT EDIRecDocHdr."Disable Pre-evaluation")
              THEN
                ERROR(Text001);
            END;
          END;

  }
  CODE
  {
    VAR
      EDISetup@1240020007 : Record 14002367;
      EDIRecDocHdr@1240020006 : Record 14002358;
      EDITradePartner@1240020005 : Record 14002360;
      EvaluateCrossReference@1240020002 : Codeunit 14000380;
      GeneralCrossReference@1240020000 : Boolean;
      PreEvaluate@1240020001 : Boolean;
      Text001@1240020009 : TextConst 'ENU=EDI Cross references are not setup. \Check Receive Document for details.';

    PROCEDURE PreEvaluateCrossReferences@1240020000();
    BEGIN
      IF (PreEvaluate) AND
         (NOT EDITradePartner."Disable Pre-evaluation") AND
         (EDIRecDocHdr."Navision Document" = 'I_SLSORD')
      THEN BEGIN
        CLEAR(EvaluateCrossReference);
        EvaluateCrossReference.EvaluateCustomerCrossReference(EDIRecDocHdr);
        EvaluateCrossReference.EvaluateItemCrossReference(EDIRecDocHdr,DATABASE::"Sales Line");
      END;
    END;

    PROCEDURE EvaluateGeneralCrossReference@1240020003();
    BEGIN
      IF EDITradePartner.GET(EDIRecDocHdr."Trade Partner No.") THEN BEGIN
        IF (GeneralCrossReference) AND
           (NOT EDITradePartner."Disable General Cross Ref.")
        THEN BEGIN
          CLEAR(EvaluateCrossReference);
          EvaluateCrossReference.AssignNAVCrossReference(EDIRecDocHdr);
        END;
      END;
    END;

    PROCEDURE SetProcessID@1240020001(ProcessID@1240020000 : Integer);
    BEGIN
      GeneralCrossReference := FALSE;
      PreEvaluate := FALSE;

      CASE ProcessID OF
        1:
          GeneralCrossReference := TRUE;
        2:
          PreEvaluate := TRUE;
      END;
    END;

    BEGIN
    END.
  }
}

