OBJECT Codeunit 51988 Process Trade Tech Orders
{
  OBJECT-PROPERTIES
  {
    Date=03/09/21;
    Time=[ 6:44:35 AM];
    Modified=Yes;
    Version List=TPZ2986;
  }
  PROPERTIES
  {
    OnRun=BEGIN
            TTSOrderHeader.RESET;
            TTSOrderHeader.SETFILTER("Order Status",'<>%1',TTSOrderHeader."Order Status"::Confirm);
            IF TTSOrderHeader.FINDSET THEN REPEAT
              CLEARLASTERROR;
              TTSOrderHeader2.GET(TTSOrderHeader.Type,TTSOrderHeader.ttsOrderNumber,TTSOrderHeader.ttsOrderId,
                TTSOrderHeader.ttsReleaseId,TTSOrderHeader.ReleaseNumber);
              IF CreateTradeTechOrder.RUN(TTSOrderHeader) THEN BEGIN
                TTSOrderHeader2."Order Status" := TTSOrderHeader2."Order Status"::Confirm;
                TTSOrderHeader2."Nav Order No." := TTSOrderHeader."Nav Order No.";
                TTSOrderHeader2."Error Text" := '';
                TTSOrderHeader2.MODIFY;
              END ELSE BEGIN
                TTSOrderHeader2."Order Status" := TTSOrderHeader2."Order Status"::Error;
                TTSOrderHeader2."Error Text" := COPYSTR(GETLASTERRORTEXT,1,250);
                TTSOrderHeader2.MODIFY;
              END;
              COMMIT;
            UNTIL TTSOrderHeader.NEXT = 0;
            MESSAGE('done');
          END;

  }
  CODE
  {
    VAR
      TTSOrderHeader@1000000000 : Record 50060;
      TTSOrderHeader2@1000000002 : Record 50060;
      CreateTradeTechOrder@1000000001 : Codeunit 51987;

    BEGIN
    END.
  }
}

