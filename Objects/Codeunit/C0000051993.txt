OBJECT Codeunit 51993 Change Posting Date & Job Stat
{
  OBJECT-PROPERTIES
  {
    Date=02/11/21;
    Time=10:46:01 AM;
    Modified=Yes;
    Version List=TPZ000.00.00;
  }
  PROPERTIES
  {
    TableNo=472;
    OnRun=VAR
            JobQueueEntry@1000000000 : Record 472;
            tmptime@1000000001 : Time;
            SalesHeader@1000000002 : Record 36;
            OrderNo@1000000003 : Code[20];
          BEGIN
            JobQueueEntry.SETRANGE("Job Queue Category Code","Job Queue Category Code");
            JobQueueEntry.SETRANGE(Status,JobQueueEntry.Status::Ready);
            JobQueueEntry.SETRANGE("Parameter String",'');
            IF JobQueueEntry.FINDSET THEN
                REPEAT
                  OrderNo := COPYSTR(JobQueueEntry.Description,STRLEN(JobQueueEntry.Description)-10,10);
                  IF SalesHeader.GET(SalesHeader."Document Type"::Order,OrderNo) THEN
                    BEGIN
                      IF SalesHeader."Posting Date" = TODAY THEN BEGIN
                        SalesHeader.VALIDATE("Posting Date",TODAY-1);
                        SalesHeader.MODIFY(TRUE);
                      END;
                    END;
                  //EVALUATE(tmptime,"Parameter String");
                  JobQueueEntry.VALIDATE("Earliest Start Date/Time",CURRENTDATETIME);
                  JobQueueEntry.VALIDATE("User ID",'TOPAZ\SA_NY_NST_NAVNST6');
                  JobQueueEntry.MODIFY(TRUE);
                  //JobQueueEntry.Restart;
                  //MESSAGE('%1',OrderNo);
                UNTIL JobQueueEntry.NEXT=0;
          END;

  }
  CODE
  {

    BEGIN
    {
      2018-02-13 TPZ2218 VAH
        Change invoice jobs Posting Date and status on a schedule
    }
    END.
  }
}

