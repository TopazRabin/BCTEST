OBJECT Codeunit 14000562 Find Seasonal Items (Yes/No)
{
  OBJECT-PROPERTIES
  {
    Date=02/06/07;
    Time=12:00:00 PM;
    Version List=UBP2.34;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {

    PROCEDURE FindSeasonalItems@1();
    VAR
      LocInvPeriod@14000500 : Record 14000553;
      Location@14000501 : Record 14;
      FindSeasonalItems@14000502 : Codeunit 14000563;
      FirstClosedStartingDate@14000503 : Date;
      LastClosedEndingDate@14000504 : Date;
      Text000@14000505 : TextConst 'ENU=Do you wish to locate possible seasonal items for the selected locations?';
      Text001@14000506 : TextConst 'ENU=Location %1 does not have 1 year of closed inventory periods.';
      TestDate@14000507 : Date;
    BEGIN
      IF NOT CONFIRM(Text000,FALSE) THEN
        EXIT;

      Location.RESET;
      Location.SETRANGE("Select Period End Processing",USERID);
      IF Location.FIND('-') THEN
        REPEAT
          LocInvPeriod.RESET;
          LocInvPeriod.SETCURRENTKEY("Location Code","Starting Date","Period End Closed");
          LocInvPeriod.SETRANGE("Location Code",Location.Code);
          LocInvPeriod.SETRANGE("Period End Closed",TRUE);
          IF LocInvPeriod.FIND('+') THEN BEGIN
            LastClosedEndingDate := LocInvPeriod."Ending Date";
            LocInvPeriod.FIND('-');
            FirstClosedStartingDate := LocInvPeriod."Starting Date";
            TestDate := CALCDATE('<-1Y>',LastClosedEndingDate);
            TestDate := CALCDATE('<+1D>',TestDate);
            IF TestDate < FirstClosedStartingDate THEN
              ERROR(Text001,Location.Code);
          END;
        UNTIL Location.NEXT = 0;

      IF Location.FIND('-') THEN
        REPEAT
          FindSeasonalItems.RUN(Location);
        UNTIL Location.NEXT = 0;
    END;

    BEGIN
    END.
  }
}

