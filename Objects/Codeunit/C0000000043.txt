OBJECT Codeunit 43 LanguageManagement
{
  OBJECT-PROPERTIES
  {
    Date=11/22/17;
    Time=12:00:00 PM;
    Version List=NAVW111.00,NAVNA11.00;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {
    VAR
      SavedGlobalLanguageID@1000 : Integer;

    [Internal]
    PROCEDURE SetGlobalLanguage@1();
    VAR
      TempLanguage@1001 : TEMPORARY Record 2000000045;
    BEGIN
      GetApplicationLanguages(TempLanguage);

      WITH TempLanguage DO BEGIN
        SETCURRENTKEY(Name);
        IF GET(GLOBALLANGUAGE) THEN;
        PAGE.RUN(PAGE::"Application Languages",TempLanguage);
      END;
    END;

    PROCEDURE GetApplicationLanguages@2(VAR TempLanguage@1034 : TEMPORARY Record 2000000045);
    VAR
      Language@1035 : Record 2000000045;
    BEGIN
      WITH Language DO BEGIN
        GetLanguageFilters(Language);
        IF FINDSET THEN
          REPEAT
            TempLanguage := Language;
            TempLanguage.INSERT;
          UNTIL NEXT = 0;
      END;
    END;

    [Internal]
    PROCEDURE ValidateApplicationLanguage@3(LanguageID@1037 : Integer);
    VAR
      TempLanguage@1038 : TEMPORARY Record 2000000045;
    BEGIN
      GetApplicationLanguages(TempLanguage);

      WITH TempLanguage DO BEGIN
        SETRANGE("Language ID",LanguageID);
        FINDFIRST;
      END;
    END;

    [Internal]
    PROCEDURE LookupApplicationLanguage@4(VAR LanguageID@1040 : Integer);
    VAR
      TempLanguage@1039 : TEMPORARY Record 2000000045;
    BEGIN
      GetApplicationLanguages(TempLanguage);

      WITH TempLanguage DO BEGIN
        IF GET(LanguageID) THEN;
        IF PAGE.RUNMODAL(PAGE::"Windows Languages",TempLanguage) = ACTION::LookupOK THEN
          LanguageID := "Language ID";
      END;
    END;

    [External]
    PROCEDURE LookupWindowsLocale@5(VAR LocaleID@1000 : Integer);
    VAR
      WindowsLanguage@1002 : Record 2000000045;
    BEGIN
      WITH WindowsLanguage DO BEGIN
        SETCURRENTKEY(Name);
        IF PAGE.RUNMODAL(PAGE::"Windows Languages",WindowsLanguage) = ACTION::LookupOK THEN
          LocaleID := "Language ID";
      END;
    END;

    PROCEDURE SetGlobalLanguageByCode@150(LanguageCode@1000 : Code[10]);
    VAR
      Language@1001 : Record 8;
    BEGIN
      IF LanguageCode = '' THEN
        EXIT;
      SavedGlobalLanguageID := GLOBALLANGUAGE;
      GLOBALLANGUAGE(Language.GetLanguageID(LanguageCode));
    END;

    PROCEDURE RestoreGlobalLanguage@151();
    BEGIN
      IF SavedGlobalLanguageID <> 0 THEN BEGIN
        GLOBALLANGUAGE(SavedGlobalLanguageID);
        SavedGlobalLanguageID := 0;
      END;
    END;

    LOCAL PROCEDURE GetLanguageFilters@6(VAR WindowsLanguage@1000 : Record 2000000045);
    VAR
      CompanyInformation@1020001 : Record 79;
      IdentityManagement@1020000 : Codeunit 9801;
      EnglishUnitedStatesCode@1020002 : Integer;
      EnglishCanadaCode@1020003 : Integer;
      FrenchCanadaCode@1020004 : Integer;
    BEGIN
      WindowsLanguage.SETRANGE("Localization Exist",TRUE);
      WindowsLanguage.SETRANGE("Globally Enabled",TRUE);

      IF IdentityManagement.IsInvAppId THEN BEGIN
        IF NOT CompanyInformation.GET THEN
          EXIT;

        IF WindowsLanguage.COUNT <= 1 THEN
          EXIT;

        EnglishUnitedStatesCode := 1033;
        EnglishCanadaCode := 4105;
        FrenchCanadaCode := 3084;
        IF CompanyInformation."Country/Region Code" = 'CA' THEN
          // Filter in EN-CA and FR-CA in the Canadian build
          WindowsLanguage.SETFILTER("Language ID",'%1|%2',EnglishCanadaCode,FrenchCanadaCode)
        ELSE
          // Filter in US-EN in the US build
          WindowsLanguage.SETFILTER("Language ID",'%1',EnglishUnitedStatesCode);
      END;
    END;

    BEGIN
    END.
  }
}

