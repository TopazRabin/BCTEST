OBJECT Codeunit 50046 JQ to chck/unchck on inv setup
{
  OBJECT-PROPERTIES
  {
    Date=07/01/20;
    Time=12:00:00 AM;
    Modified=Yes;
    Version List=TPZ000.00.00;
  }
  PROPERTIES
  {
    OnRun=BEGIN
            FirstDateOfMonth := CALCDATE('-CM',TODAY);
            FirstDayOfMonth := DATE2DWY(FirstDateOfMonth,1);

            DescriptionOfFirstDayOfMonth := DescriptionOfDay(FirstDayOfMonth);

            IF DescriptionOfFirstDayOfMonth = 'Monday' THEN BEGIN
              DateOnSecondFriday := CALCDATE('4D+1W',FirstDateOfMonth);
              DateOnThirdMonday := CALCDATE('2W',FirstDateOfMonth);
            END;
            IF DescriptionOfFirstDayOfMonth = 'Tuesday' THEN BEGIN
              DateOnSecondFriday := CALCDATE('3D+1W',FirstDateOfMonth);
              DateOnThirdMonday := CALCDATE('6D+2W',FirstDateOfMonth);
            END;
            IF DescriptionOfFirstDayOfMonth = 'Wednesday' THEN BEGIN
              DateOnSecondFriday := CALCDATE('2D+1W',FirstDateOfMonth);
              DateOnThirdMonday := CALCDATE('5D+2W',FirstDateOfMonth);
            END;
            IF DescriptionOfFirstDayOfMonth = 'Thursday' THEN BEGIN
              DateOnSecondFriday := CALCDATE('1D+1W',FirstDateOfMonth);
              DateOnThirdMonday := CALCDATE('4D+2W',FirstDateOfMonth);
            END;
            IF DescriptionOfFirstDayOfMonth = 'Friday' THEN BEGIN
              DateOnSecondFriday := CALCDATE('1W',FirstDateOfMonth);
              DateOnThirdMonday := CALCDATE('3D+2W',FirstDateOfMonth);
            END;
            IF DescriptionOfFirstDayOfMonth = 'Saturday' THEN BEGIN
              DateOnSecondFriday := CALCDATE('6D+1W',FirstDateOfMonth);
              DateOnThirdMonday := CALCDATE('2D+2W',FirstDateOfMonth);
            END;
            IF DescriptionOfFirstDayOfMonth = 'Sunday' THEN BEGIN
              DateOnSecondFriday := CALCDATE('5D+1W',FirstDateOfMonth);
              DateOnThirdMonday := CALCDATE('1D+2W',FirstDateOfMonth);
            END;

            IF TODAY = DateOnThirdMonday THEN
              UnCheckNewProcUnitIfInvOnHand();

            IF TODAY = DateOnSecondFriday THEN
              CheckNewProcUnitIfInvOnHand
          END;

  }
  CODE
  {
    VAR
      FirstDateOfMonth@1000000000 : Date;
      FirstDayOfMonth@1000000005 : Integer;
      DescriptionOfFirstDayOfMonth@1000000004 : Text;
      DateOnSecondFriday@1000000003 : Date;
      DateOnThirdMonday@1000000002 : Date;

    LOCAL PROCEDURE CheckNewProcUnitIfInvOnHand@1000000004();
    VAR
      InventoryManagementSetup@1000000000 : Record 14000551;
    BEGIN
      InventoryManagementSetup.GET;

      InventoryManagementSetup."New Proc. Unit if Inv. On-Hand" := TRUE;
      InventoryManagementSetup.MODIFY(TRUE);
    END;

    LOCAL PROCEDURE UnCheckNewProcUnitIfInvOnHand@1000000005();
    VAR
      InventoryManagementSetup@1000000000 : Record 14000551;
    BEGIN
      InventoryManagementSetup.GET;

      InventoryManagementSetup."New Proc. Unit if Inv. On-Hand" := FALSE;
      InventoryManagementSetup.MODIFY(TRUE);
    END;

    LOCAL PROCEDURE DescriptionOfDay@1000000006(DayNo@1000000000 : Integer) : Text;
    BEGIN
      CASE DayNo OF
        1:EXIT('Monday');
        2:EXIT('Tuesday');
        3:EXIT('Wednesday');
        4:EXIT('Thursday');
        5:EXIT('Friday');
        6:EXIT('Saturday');
        7:EXIT('Sunday');
      END;
    END;

    BEGIN
    {
      2018-11-28 TPZ1990 SNAGPAL
        Added new codeunit to toggle the inventory setup based on dates.
    }
    END.
  }
}

