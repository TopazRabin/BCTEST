OBJECT Codeunit 14000781 FedEx Transaction
{
  OBJECT-PROPERTIES
  {
    Date=06/28/17;
    Time=12:00:00 PM;
    Version List=SE0.60.12;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {
    VAR
      PackingStation@1000000000 : Record 14000709;
      CarrierPackingStation@1240030000 : Record 14000729;
      FedExGlobalRegistration@1000000001 : Record 14000786;
      ShippingSetup@1000000002 : Record 14000707;
      ShippingAgent@1000000003 : Record 291;
      ShippingAgentService@1000000004 : Record 14000708;
      ShippingAgentAccount@1000000005 : Record 14000788;
      Shipping@1000000006 : Codeunit 14000701;
      NameAndAddressMgt@1240030100 : Codeunit 14000709;
      FedEx@1000000007 : Text;
      FedExGround@1000000008 : Text;
      Window@1000000009 : Dialog;
      BufferFileName@1000000010 : Text[250];
      ShippingSetupRetrieved@1000000011 : Boolean;
      Text001@1001 : TextConst 'ENU=Communicating with FedEx';
      Text002@1002 : TextConst 'ENU=Registration with FedEx was succesful.';
      Text003@1003 : TextConst 'ENU=Registration with FedEx could not be completed. Please see respons for details.';
      Text004@1004 : TextConst 'ENU=Communications Error\';
      Text005@1005 : TextConst 'ENU=Please check your connections';
      Text006@1006 : TextConst 'ENU=WEBAPI timed out';
      Text007@1007 : TextConst 'ENU=Security Violation Error';
      Text008@1008 : TextConst 'ENU=Client is not registered';
      Text009@1009 : TextConst 'ENU=WEBAPI Service is down';
      Text010@1010 : TextConst 'ENU=Non-existent FedEx Service';
      Text011@1011 : TextConst 'ENU=Data length is too long or short';
      Text012@1012 : TextConst 'ENU=WEBAPI is not inited';
      Text013@1013 : TextConst 'ENU=WEBAPI not connected';
      Text014@1014 : TextConst 'ENU=Bad Authentication File';
      Text015@1015 : TextConst 'ENU=WEBAPI not sending';
      Text016@1016 : TextConst 'ENU=Invalid Port Number';
      Text017@1017 : TextConst 'ENU=Failure to reopen the comm port';
      Text018@1018 : TextConst 'ENU=No Webapi.ini file found';
      Text019@1019 : TextConst 'ENU=No FDXHOST Variable in webapi.ini';
      Text020@1020 : TextConst 'ENU=Encryption package not working';
      Text021@1021 : TextConst 'ENU=Unable to locate response buffer';
      Text022@1022 : TextConst 'ENU=Local security init error';
      Text023@1023 : TextConst 'ENU=Remote security init error';
      Text024@1024 : TextConst 'ENU=User Name/Password not valid';
      Text025@1025 : TextConst 'ENU=Cannot open the server port';
      Text026@1026 : TextConst 'ENU=WEBAPI init Error\';
      Text027@1027 : TextConst 'ENU=Please check your system resources';
      Text028@1028 : TextConst 'ENU=Invalid filename';
      Text029@1029 : TextConst 'ENU=Unable to open log or trace file';
      Text030@1030 : TextConst 'ENU=WEBAPI Buffer too large';
      Text031@1031 : TextConst 'ENU=WEBAPI Buffer too small';
      Text032@1032 : TextConst 'ENU=WEBAPI not activated';
      Text033@1033 : TextConst 'ENU=Invalid data format in buffer';
      Text034@1034 : TextConst 'ENU=Decryption package not working';
      Text035@1035 : TextConst 'ENU=Unknown client message type';
      Text036@1036 : TextConst 'ENU=Unknown error code.  This is a temporary condition';
      Text037@1037 : TextConst 'ENU=Message must be sent to admin port';
      Text038@1038 : TextConst 'ENU=This user certificate is revoked';
      Text039@1039 : TextConst 'ENU=LDAP error on FEDEX server side';
      Text040@1040 : TextConst 'ENU=LDAP entry not found on FEDEX server side';
      Text041@1041 : TextConst 'ENU=Vendor software not enabled';
      Text042@1042 : TextConst 'ENU=Unknown Connection Error: %1';
      Text043@1043 : TextConst 'ENU=Error deleting package:\';
      Text044@1044 : TextConst 'ENU=Consignee is not available for FedEx Express shipments';
      Text045@1045 : TextConst 'ENU=Sales Order %1';
      Text046@1046 : TextConst 'ENU=There must be at least one item in the package.';
      Text047@1047 : TextConst 'ENU=Destination company name or destination contact name is required.';
      Text048@1048 : TextConst 'ENU="Order # "';
      Text049@1049 : TextConst 'ENU="Misc. Order # "';
      Text050@1050 : TextConst 'ENU=Wrong Filename.';
      Text051@1051 : TextConst 'ENU=FedEx Label';
      Text052@1052 : TextConst 'ENU=FedEx COD Label';
      Text053@1053 : TextConst 'ENU=There are no labels saved.';
      Text054@1054 : TextConst 'ENU=No Global Registration record.';
      Text055@1055 : TextConst 'ENU=Error %1 during session begin.';
      Text056@1056 : TextConst 'ENU=Subscription Service 1: %1\';
      Text057@1057 : TextConst 'ENU=Subscription Service 2: %2';
      Text058@1058 : TextConst 'ENU=FedEx Account %1';
      Text059@1059 : TextConst 'ENU=%1 account(s) has been manifested with FedEx';
      Text060@1060 : TextConst 'ENU=Manifest for FedEx Account %1 has been posted.';
      Text061@1061 : TextConst 'ENU=Driver Label %1';
      Text062@1062 : TextConst 'ENU=FedEx Account %1 closed.\%2';
      Text063@1063 : TextConst 'ENU=Error closing FedEx Account %1:\%2';
      Text064@1064 : TextConst 'ENU=File: %1 does not exist.';
      Text065@1065 : TextConst 'ENU=Airbill already deleted - delete request ignored.';
      Text066@1066 : TextConst 'ENU=Communications response from service uncertain - no reply message found';
      Text067@1067 : TextConst 'ENU=The service call to failed for reason';
      Text068@1068 : TextConst 'ENU=Rate request failed - Service Status Code';
      Text069@1069 : TextConst 'ENU=URSA request failed - Service Status Code';
      Text070@1070 : TextConst 'ENU=No courtesy rate provided for pay types bill recipient or bill third party.';
      Text071@1071 : TextConst 'ENU=The airbill number you have entered is invalid.';
      Text072@1072 : TextConst 'ENU=Service type does not allow alcohol';
      Text073@1073 : TextConst 'ENU=No COD Allowed for bill recipient';
      Text074@1074 : TextConst 'ENU=No COD Allowd for bill third party';
      Text075@1075 : TextConst 'ENU=Unknown or invalid transaction';
      Text076@1076 : TextConst 'ENU=Bad command line arguments';
      Text077@1077 : TextConst 'ENU=Service type does not allow inaccedsible dangerous goods';
      Text078@1078 : TextConst 'ENU=Service type cannot have declared value greater than $500';
      Text079@1079 : TextConst 'ENU=Declared value cannot exceed $50000';
      Text080@1080 : TextConst 'ENU=Service type cannot have declared value lower than $250';
      Text081@1081 : TextConst 'ENU=Length, width or height cannot be 0';
      Text082@1082 : TextConst 'ENU=Girth + length exceeds maximum for service type';
      Text083@1083 : TextConst 'ENU=Length exceeds maximum for service type';
      Text084@1084 : TextConst 'ENU=Service type does not allow accessible dangerous goods';
      Text085@1085 : TextConst 'ENU=Express Saver service not allowed for Bill Recipient/Bill Third Party';
      Text086@1086 : TextConst 'ENU=Package length, width and height dimensions must each be at least 7 inches for service type';
      Text087@1087 : TextConst 'ENU=Recipient address and ZIP code required';
      Text088@1088 : TextConst 'ENU=Service type does not allow dry ice';
      Text089@1089 : TextConst 'ENU=Puerto Rico destinations not valid via Domestic Ship - use International';
      Text090@1090 : TextConst 'ENU=Hold At Location requires complete hold address including ZIP code';
      Text091@1091 : TextConst 'ENU=Release specified but no authorization number provided';
      Text092@1092 : TextConst 'ENU=Release not allowed on dangerous goods shipment';
      Text093@1093 : TextConst 'ENU=No Hold At Location with Inside/Residential Delivery';
      Text094@1094 : TextConst 'ENU=Invalid package count';
      Text095@1095 : TextConst 'ENU=Saturday delivery to Hawaii destinations not available';
      Text096@1096 : TextConst 'ENU=No hold-at-location for service type on Saturday';
      Text097@1097 : TextConst 'ENU=No Saturday delivery for freight';
      Text098@1098 : TextConst 'ENU=Saturday delivery allowed only for Thursday ship date on economy service';
      Text099@1099 : TextConst 'ENU=Saturday delivery allowed only for Friday ship date on priority service';
      Text100@1100 : TextConst 'ENU=Service type does not allow Saturday delivery';
      Text101@1101 : TextConst 'ENU=No Saturday delivery with commitment';
      Text102@1102 : TextConst 'ENU=Saturday delivery to Alaska not valid with commitment';
      Text103@1103 : TextConst 'ENU=Saturday pick-up only available on Saturday ship date';
      Text104@1104 : TextConst 'ENU=Saturday pick-up for Hawaii origins not available';
      Text105@1105 : TextConst 'ENU=No Saturday pick-up for freight shipments';
      Text106@1106 : TextConst 'ENU=No Saturday pickup on service type with commitment';
      Text107@1107 : TextConst 'ENU=Service type not supported or defined';
      Text108@1108 : TextConst 'ENU=Hawaii origin/destination not allowed on service type';
      Text109@1109 : TextConst 'ENU=Service does not allow dimmed packaging';
      Text110@1110 : TextConst 'ENU=Service type not valid with commitment';
      Text111@1111 : TextConst 'ENU=Receive data underflow for transaction type';
      Text112@1112 : TextConst 'ENU=The service call to failed for reason - attempting local upload';
      Text113@1113 : TextConst 'ENU=Submitted weight evaluates to 0';
      Text114@1114 : TextConst 'ENU=Dry ice specified but dry ice weight evaluates to 0';
      Text115@1115 : TextConst 'ENU=Inconsistent - weight is less than dry ice weight';
      Text116@1116 : TextConst 'ENU=Invalid weight for service type - exceeds limit';
      Text117@1117 : TextConst 'ENU=Invalid weight for service type - below limit';
      Text118@1118 : TextConst 'ENU=Weight exceeds maximum for service type';
      Text119@1119 : TextConst 'ENU=Length and girth + length too small for submitted weight and service type';
      Text120@1120 : TextConst 'ENU=No COD allowed with service';
      Text121@1121 : TextConst 'ENU=Bad ZIP code format';
      Text122@1122 : TextConst 'ENU=Reply-to-client failed for reason';
      Text123@1123 : TextConst 'ENU=This service not available to this ZIP code';
      Text124@1124 : TextConst 'ENU=Drop-off and Saturday pick-up mutually exclusive';
      Text125@1125 : TextConst 'ENU=Shipper account number must be provided for Bill Sender';
      Text126@1126 : TextConst 'ENU=Saturday pick-up for Puerto Rico origins not available';
      Text127@1127 : TextConst 'ENU=Invalid current date';
      Text128@1128 : TextConst 'ENU=Invalid future date';
      Text129@1129 : TextConst 'ENU=No Inside Pickup with service type';
      Text130@1130 : TextConst 'ENU=No Inside Delivery with service type';
      Text131@1131 : TextConst 'ENU=Sunday shipment should be marked future day';
      Text132@1132 : TextConst 'ENU=L, W, H exceeds max 70, 48, 48 for service';
      Text133@1133 : TextConst 'ENU=Invalid date/time format';
      Text134@1134 : TextConst 'ENU=No COD allowed with commitment';
      Text135@1135 : TextConst 'ENU=Shipment originated from CAN version';
      Text136@1136 : TextConst 'ENU=COD Amount must be between 0 and $9,999,999.99';
      Text137@1137 : TextConst 'ENU=Invalid payment type';
      Text138@1138 : TextConst 'ENU=Release not allowed on COD shipment';
      Text139@1139 : TextConst 'ENU=Required address field missing: Contact name';
      Text140@1140 : TextConst 'ENU=Required address field missing: Company';
      Text141@1141 : TextConst 'ENU=Required address field missing: Address1';
      Text142@1142 : TextConst 'ENU=Required address field missing: Address2';
      Text143@1143 : TextConst 'ENU=Required address field missing: City';
      Text144@1144 : TextConst 'ENU=Required address field missing: State';
      Text145@1145 : TextConst 'ENU=Required address field missing: ZIP code';
      Text146@1146 : TextConst 'ENU=Required address field missing: Phone number';
      Text147@1147 : TextConst 'ENU=Required address field missing: Country';
      Text148@1148 : TextConst 'ENU=Bill recipient/Bill third party not allowed for service';
      Text149@1149 : TextConst 'ENU=COD flags/amount cannot be set for non-COD shipment';
      Text150@1150 : TextConst 'ENU=Account number field must be numeric';
      Text151@1151 : TextConst 'ENU=Height supplied exceeds height maximum for service';
      Text152@1152 : TextConst 'ENU=Width supplied exceeds width maximum for service';
      Text153@1153 : TextConst 'ENU=Alaska origin/destination not allowed on service type';
      Text154@1154 : TextConst 'ENU=Puerto Rico origin not allowed on service type';
      Text155@1155 : TextConst 'ENU=Internal consistency error - bad transaction passed to CheckLength';
      Text156@1156 : TextConst 'ENU=Returned URSA service type does not match that for submitted service type >';
      Text157@1157 : TextConst 'ENU=Track number request failed - Service Status code';
      Text158@1158 : TextConst 'ENU=Missing prerequisite logon - authentication failed';
      Text159@1159 : TextConst 'ENU=For Puerto Rico to US shipments please use Domestic ship';
      Text160@1160 : TextConst 'ENU=Hold At Location ZIP code must be 5 or 9 numeric digits';
      Text161@1161 : TextConst 'ENU=Canada Hold At Location requires province';
      Text162@1162 : TextConst 'ENU=US or Puerto Rico Hold At Location requires state';
      Text163@1163 : TextConst 'ENU=Saturday delivery to this destination not allowed';
      Text164@1164 : TextConst 'ENU=Saturday pickup from this location not allowed';
      Text165@1165 : TextConst 'ENU=Incomplete commodity information';
      Text166@1166 : TextConst 'ENU=Please provide description';
      Text167@1167 : TextConst 'ENU=Please provide country of manufacture for line 1';
      Text168@1168 : TextConst 'ENU=Please provide country of manufacture for line 2';
      Text169@1169 : TextConst 'ENU=Please provide country of manufacture for line 3';
      Text170@1170 : TextConst 'ENU=Please provide country of manufacture for line 4';
      Text171@1171 : TextConst 'ENU=Customs value must be 1 or NCV (No Customs Value)';
      Text172@1172 : TextConst 'ENU=Electronic Commercial Invoice not allowed for document shipment';
      Text173@1173 : TextConst 'ENU=Ultimate destination country required for commercial invoice';
      Text174@1174 : TextConst 'ENU=Terms of sale required for commercial invoice';
      Text175@1175 : TextConst 'ENU=Recipient country does not allow electronic commercial invoice';
      Text176@1176 : TextConst 'ENU=Complete importer information is required for electronic commercial invoice.';
      Text177@1177 : TextConst 'ENU=Importer ZIP code is required for commercial invoice';
      Text178@1178 : TextConst 'ENU=Importer ZIP code must be 5 or 9 numeric digits';
      Text179@1179 : TextConst 'ENU=ZIP code must be 5 or 9 numeric digits';
      Text180@1180 : TextConst 'ENU=Sender ZIP code must be 5 or 9 numeric digits';
      Text181@1181 : TextConst 'ENU=Recipient ZIP code must be 5 or 9 numeric digits';
      Text182@1182 : TextConst 'ENU=Ship date must be 8 numeric digits';
      Text183@1183 : TextConst 'ENU=Recipient Phone must be 10 digits';
      Text184@1184 : TextConst 'ENU=Sender phone must be 10 digits';
      Text185@1185 : TextConst 'ENU=Recipient phone for US/Canada must be 10 digits';
      Text186@1186 : TextConst 'ENU=Sender phone for US/Canada must be 10 digits';
      Text187@1187 : TextConst 'ENU=Phone number for US/Canada must be 10 digits';
      Text188@1188 : TextConst 'ENU=Phone number length must be 15 digits max';
      Text189@1189 : TextConst 'ENU=Account must match owner`s state, postal code, and country';
      Text190@1190 : TextConst 'ENU=Valid FedEx account number required for bill recipient or bill 3rd party';
      Text191@1191 : TextConst 'ENU=Billing or Duty/tax account number is either cash-only or invalid.';
      Text192@1192 : TextConst 'ENU="  Choose another billing option or account number."';
      Text193@1193 : TextConst 'ENU=Bad Return code from FedEx mainframe (IMS) system';
      Text194@1194 : TextConst 'ENU=Non Revenue Account';
      Text195@1195 : TextConst 'ENU=Incorrect software version';
      Text196@1196 : TextConst 'ENU=FedEx intraNetShip is temporarily unavailable';
      Text197@1197 : TextConst 'ENU=Invalid Request';
      Text198@1198 : TextConst 'ENU=Invalid Meter Number';
      Text199@1199 : TextConst 'ENU=Invalid Customer Account Number';
      Text200@1200 : TextConst 'ENU=Invalid shipping date';
      Text201@1201 : TextConst 'ENU=Invalid service type';
      Text202@1202 : TextConst 'ENU=Invalid recipient ZIP code';
      Text203@1203 : TextConst 'ENU=Invalid state code';
      Text204@1204 : TextConst 'ENU=Invalid weight for selected service';
      Text205@1205 : TextConst 'ENU=Invalid declared value';
      Text206@1206 : TextConst 'ENU=Invalid length';
      Text207@1207 : TextConst 'ENU=Invalid width';
      Text208@1208 : TextConst 'ENU=Invalid height';
      Text209@1209 : TextConst 'ENU=Invalid shipment handling';
      Text210@1210 : TextConst 'ENU=Dimension of package is missing';
      Text211@1211 : TextConst 'ENU=Shipment too small or too large';
      Text212@1212 : TextConst 'ENU=This is a city center account number';
      Text213@1213 : TextConst 'ENU=Account number marked for delete';
      Text214@1214 : TextConst 'ENU=Cash only account';
      Text215@1215 : TextConst 'ENU=ZIP code is neither in US nor in Canada';
      Text216@1216 : TextConst 'ENU=Could not communicate with FedEx mainframe(IMS) system';
      Text217@1217 : TextConst 'ENU=Rating failed';
      Text218@1218 : TextConst 'ENU=Invalid sender ZIP code';
      Text219@1219 : TextConst 'ENU=Inside pickup unavailable';
      Text220@1220 : TextConst 'ENU=Inside delivery unavailable';
      Text221@1221 : TextConst 'ENU=Account number is empty or NULL';
      Text222@1222 : TextConst 'ENU=Meter number is empty or NULL';
      Text223@1223 : TextConst 'ENU=Account number not in database';
      Text224@1224 : TextConst 'ENU=Meter number not in database';
      Text225@1225 : TextConst 'ENU=Invalid or blank package count';
      Text226@1226 : TextConst 'ENU=Invalid or blank package weight';
      Text227@1227 : TextConst 'ENU=No contact name specified';
      Text228@1228 : TextConst 'ENU=Invalid company close time';
      Text229@1229 : TextConst 'ENU=Unable to pickup before close time';
      Text230@1230 : TextConst 'ENU=Too late for pickup';
      Text231@1231 : TextConst 'ENU=No pickup service today';
      Text232@1232 : TextConst 'ENU=No pickup on Sunday or holiday';
      Text233@1233 : TextConst 'ENU=Bad transaction number';
      Text234@1234 : TextConst 'ENU="Bad Address; it is empty or null"';
      Text235@1235 : TextConst 'ENU="Bad City; Field is empty or null"';
      Text236@1236 : TextConst 'ENU=State field is empty or null';
      Text237@1237 : TextConst 'ENU=ZIP code field is empty or null';
      Text238@1238 : TextConst 'ENU=Invalid ready time';
      Text239@1239 : TextConst 'ENU=Invalid country code';
      Text240@1240 : TextConst 'ENU=Invalid ZIP code';
      Text241@1241 : TextConst 'ENU=Recipient ZIP code is invalid';
      Text242@1242 : TextConst 'ENU=Recipient ZIP code is an Unserved P.O. Box';
      Text243@1243 : TextConst 'ENU=Recipient ZIP code is a served P.O. Box';
      Text244@1244 : TextConst 'ENU=No Service in Recipient ZIP code';
      Text245@1245 : TextConst 'ENU=Service is not available to this location';
      Text246@1246 : TextConst 'ENU=Too Late For PickUp Service - Drop off available';
      Text247@1247 : TextConst 'ENU=Constant Surveillance Service is not allow to this location';
      Text248@1248 : TextConst 'ENU=Dangerous goods are not allow to this location';
      Text249@1249 : TextConst 'ENU=Dry Ice is not allow to this location';
      Text250@1250 : TextConst 'ENU=No Hold At Location service to this location';
      Text251@1251 : TextConst 'ENU=Sender ZIP code is a P.O. Box';
      Text252@1252 : TextConst 'ENU=Invalid pickup time';
      Text253@1253 : TextConst 'ENU=Recipient ZIP code is out of delivery area';
      Text254@1254 : TextConst 'ENU=Ready time after cutoff time';
      Text255@1255 : TextConst 'ENU=Cash-Only Account';
      Text256@1256 : TextConst 'ENU=Missing authentication flag';
      Text257@1257 : TextConst 'ENU=Invalid confirmation number';
      Text258@1258 : TextConst 'ENU=Invalid location ID';
      Text259@1259 : TextConst 'ENU=No Dispatch found for this account';
      Text260@1260 : TextConst 'ENU=Failed to open the URSA table';
      Text261@1261 : TextConst 'ENU=Failed to obtain stats on the URSA table';
      Text262@1262 : TextConst 'ENU=Failed in shared memory';
      Text263@1263 : TextConst 'ENU=Failed to attach to shared memory';
      Text264@1264 : TextConst 'ENU=Failed to obtain shared memory segment';
      Text265@1265 : TextConst 'ENU=Failed to set shared memory parameter';
      Text266@1266 : TextConst 'ENU=Failed to detach from shared memory';
      Text267@1267 : TextConst 'ENU=Shared memory usage less than zero';
      Text268@1268 : TextConst 'ENU=ZIP code is a Post Office Box';
      Text269@1269 : TextConst 'ENU=General URSA table lookup error';
      Text270@1270 : TextConst 'ENU=Postal code not served';
      Text271@1271 : TextConst 'ENU=Hold at Location not valid';
      Text272@1272 : TextConst 'ENU=Saturday delivery not available';
      Text273@1273 : TextConst 'ENU=Standard Overnight Service not available';
      Text274@1274 : TextConst 'ENU=This ZIP code is a bad ZIP code';
      Text275@1275 : TextConst 'ENU=Must be A1 commit for First Overnight service';
      Text276@1276 : TextConst 'ENU=Accessible Dangerous Goods not allowed';
      Text277@1277 : TextConst 'ENU=Inaccessible Dangerous Goods not allowed';
      Text278@1278 : TextConst 'ENU=Dry Ice not allowed';
      Text279@1279 : TextConst 'ENU=Express saver Economy 2 Day handling wrong';
      Text280@1280 : TextConst 'ENU=Express saver Economy 2 Day handling not set';
      Text281@1281 : TextConst 'ENU=First Overnight later delivery not available to this location';
      Text282@1282 : TextConst 'ENU=Government Overnight Service not available';
      Text283@1283 : TextConst 'ENU=ZIP code/city mismatch';
      Text284@1284 : TextConst 'ENU=Invalid format';
      Text285@1285 : TextConst 'ENU=Postal not found in lookup';
      Text286@1286 : TextConst 'ENU=Wrong format for country selected';
      Text287@1287 : TextConst 'ENU=Country not found in URSA';
      Text288@1288 : TextConst 'ENU=URSA file version not supported';
      Text289@1289 : TextConst 'ENU=ASCII prefix does not map to table value';
      Text290@1290 : TextConst 'ENU=Service was not found';
      Text291@1291 : TextConst 'ENU=Handling code was not found';
      Text292@1292 : TextConst 'ENU=Location was not found';
      Text293@1293 : TextConst 'ENU=Service not allowed. Used w/HI exception COD';
      Text294@1294 : TextConst 'ENU=Too many counties w/postal code for output';
      Text295@1295 : TextConst 'ENU=Load of table indexes corrupted';
      Text296@1296 : TextConst 'ENU=Mktime() failure';
      Text297@1297 : TextConst 'ENU=Malloc() failure';
      Text298@1298 : TextConst 'ENU=File I/O function failure';
      Text299@1299 : TextConst 'ENU=ASTRA location number not found';
      Text300@1300 : TextConst 'ENU=CRC check of file failed';
      Text301@1301 : TextConst 'ENU=Too many Loc Clearance points for output';
      Text302@1302 : TextConst 'ENU=Maximum number of open URSA files exceeded';
      Text303@1303 : TextConst 'ENU=Origin or Destination ZIP code not available for ZIP2zi';
      Text304@1304 : TextConst 'ENU=URSA table status is expired';
      Text305@1305 : TextConst 'ENU=URSA table status is early';
      Text306@1306 : TextConst 'ENU=Desired country is not IES served';
      Text307@1307 : TextConst 'ENU="Country in != country ou"';
      Text308@1308 : TextConst 'ENU=No signature on file';
      Text309@1309 : TextConst 'ENU=No rates';
      Text310@1310 : TextConst 'ENU=No tracking number server available';
      Text311@1311 : TextConst 'ENU=Unknown transaction type';
      Text312@1312 : TextConst 'ENU=Failed to get to Visa';
      Text313@1313 : TextConst 'ENU=Failed to write Visa buffer to a flat file';
      Text314@1314 : TextConst 'ENU=Failed to copy Visa buffer to upload directory';
      Text315@1315 : TextConst 'ENU=Failed to open Thermal Airwaybill file';
      Text316@1316 : TextConst 'ENU=Failed to read Thermal Airwaybill file';
      Text317@1317 : TextConst 'ENU=Declared value exceeds amount allowed for this country';
      Text318@1318 : TextConst 'ENU=Failed to obtain Master weight for multi-piece shipment calculations';
      Text319@1319 : TextConst 'ENU=Failed to obtain multi-piece shipment weight for multi-piece shipment calculations';
      Text320@1320 : TextConst 'ENU=Weight exceeds amount allowed for this country';
      Text321@1321 : TextConst 'ENU=Document shipping not allowed for this country';
      Text322@1322 : TextConst 'ENU=Non-document shipping not allowed for this country';
      Text323@1323 : TextConst 'ENU=Saturday delivery not allowed for this country';
      Text324@1324 : TextConst 'ENU=International shipping has been turned off';
      Text325@1325 : TextConst 'ENU=Failed to read parameter file';
      Text326@1326 : TextConst 'ENU=Failed to connect to database';
      Text327@1327 : TextConst 'ENU=Failed to open database';
      Text328@1328 : TextConst 'ENU=Failed to insert record into database';
      Text329@1329 : TextConst 'ENU=Failed to insert multi-piece shipment record into database';
      Text330@1330 : TextConst 'ENU=Failed to read multi-piece shipment record from database';
      Text331@1331 : TextConst 'ENU=Failed to read Customer database';
      Text332@1332 : TextConst 'ENU=Failed to delete record from database';
      Text333@1333 : TextConst 'ENU=Failed to update Master record in database';
      Text334@1334 : TextConst 'ENU=Failed to update database for upload file';
      Text335@1335 : TextConst 'ENU=Couldn`t find the upload directory to open';
      Text336@1336 : TextConst 'ENU=Couldn`t open the file in the upload directory';
      Text337@1337 : TextConst 'ENU=Couldn`t read the file in the upload directory';
      Text338@1338 : TextConst 'ENU=Couldn`t rename the upload file to the archive directory';
      Text339@1339 : TextConst 'ENU=Bad response back from Pipeline';
      Text340@1340 : TextConst 'ENU=Couldn`t open the file in the ies.dat directory';
      Text341@1341 : TextConst 'ENU=IES not available for this country';
      Text342@1342 : TextConst 'ENU=Date not within 10 days of current date';
      Text343@1343 : TextConst 'ENU=Shipment date on Sunday not allowed';
      Text344@1344 : TextConst 'ENU=Shipment date is not valid';
      Text345@1345 : TextConst 'ENU=Intra country not allowed for this country';
      Text346@1346 : TextConst 'ENU=Invalid Service type';
      Text347@1347 : TextConst 'ENU=Saturday delivery not allowed with service';
      Text348@1348 : TextConst 'ENU=IFO not available for this country';
      Text349@1349 : TextConst 'ENU=Saturday pickup not allowed with service';
      Text350@1350 : TextConst 'ENU=Hold at location not allowed with service';
      Text351@1351 : TextConst 'ENU=Service not available to this postal code';
      Text352@1352 : TextConst 'ENU=Only Bill Sender allowed for this service';
      Text353@1353 : TextConst 'ENU=Failed to open currency file';
      Text354@1354 : TextConst 'ENU=Failed to read currency file';
      Text355@1355 : TextConst 'ENU=Invalid currency type';
      Text356@1356 : TextConst 'ENU=Taiwan 3rd party error';
      Text357@1357 : TextConst 'ENU=Shipment origin or destination must be in Taiwan';
      Text358@1358 : TextConst 'ENU=No tracking number';
      Text359@1359 : TextConst 'ENU=Account number field is empty';
      Text360@1360 : TextConst 'ENU=Invalid account number';
      Text361@1361 : TextConst 'ENU=Database problem on FedEx Mainframe';
      Text362@1362 : TextConst 'ENU=Customer is cash only';
      Text363@1363 : TextConst 'ENU=Customer is not known to FedEx database CHEERS';
      Text364@1364 : TextConst 'ENU=Error with the name entered';
      Text365@1365 : TextConst 'ENU=Error with the phone entered';
      Text366@1366 : TextConst 'ENU=Error with the fax entered';
      Text367@1367 : TextConst 'ENU=The meter number exists';
      Text368@1368 : TextConst 'ENU=Initialization parameter required from section in file';
      Text369@1369 : TextConst 'ENU=Reply-to-client failed';
      Text370@1370 : TextConst 'ENU=Account and meter does not match';
      Text371@1371 : TextConst 'ENU=Could not retrieve device type for software type';
      Text372@1372 : TextConst 'ENU=Invalid device type';
      Text373@1373 : TextConst 'ENU=Invalid meter number - non-numeric in string';
      Text374@1374 : TextConst 'ENU=Name and/or company required';
      Text375@1375 : TextConst 'ENU=Street address required';
      Text376@1376 : TextConst 'ENU=City required';
      Text377@1377 : TextConst 'ENU=State required';
      Text378@1378 : TextConst 'ENU=ZIP code required';
      Text379@1379 : TextConst 'ENU=Country required';
      Text380@1380 : TextConst 'ENU=Phone number required';
      Text381@1381 : TextConst 'ENU=Invalid phone number -- non-numeric in string';
      Text382@1382 : TextConst 'ENU=Invalid phone number - incorrect length';
      Text383@1383 : TextConst 'ENU=Invalid account number - non-numeric in string';
      Text384@1384 : TextConst 'ENU=Product version no longer supported or not defined';
      Text385@1385 : TextConst 'ENU=Account number required';
      Text386@1386 : TextConst 'ENU=The call to service ZIP Inquiry failed';
      Text387@1387 : TextConst 'ENU=Submitted postal code and state/province mismatch';
      Text388@1388 : TextConst 'ENU=Could not obtain access numbers from phone service';
      Text389@1389 : TextConst 'ENU=Could not obtain access numbers from phone service -- empty buffer';
      Text390@1390 : TextConst 'ENU=Registration is down';
      Text391@1391 : TextConst 'ENU=Invalid account number - invalid length (max. 9 digits allowed)';
      Text392@1392 : TextConst 'ENU=Transaction returned unknown status';
      Text393@1393 : TextConst 'ENU=State or province abbreviation must be two characters';
      Text394@1394 : TextConst 'ENU=Country abbreviation must be two characters';
      Text395@1395 : TextConst 'ENU=Meter Number is required';
      Text396@1396 : TextConst 'ENU=Cycle number is required';
      Text397@1397 : TextConst 'ENU=Invalid cycle number -- non-numeric in string';
      Text398@1398 : TextConst 'ENU=Invalid cycle number';
      Text399@1399 : TextConst 'ENU=Invalid country on mainframe';
      Text400@1400 : TextConst 'ENU=Sign not found on mainframe';
      Text401@1401 : TextConst 'ENU=Unable to communicate with the mainframe';
      Text402@1402 : TextConst 'ENU=Receive data underflow';
      Text403@1403 : TextConst 'ENU=Receive data overflow';
      Text404@1404 : TextConst 'ENU=FedEx unable to process shipment at this time';
      Text405@1405 : TextConst 'ENU=Your billing account number cannot be validated at this time';
      Text406@1406 : TextConst 'ENU=International ship transaction failed';
      Text407@1407 : TextConst 'ENU=An intermediate transaction failed (ZIP Validation)';
      Text408@1408 : TextConst 'ENU=An intermediate transaction failed (Service Availability)';
      Text409@1409 : TextConst 'ENU=Please check the Recipient ZIP code and state';
      Text410@1410 : TextConst 'ENU=Service not allowed for this Postal code';
      Text411@1411 : TextConst 'ENU=Signature release not allowed for COD';
      Text412@1412 : TextConst 'ENU=Invalid State code';
      Text413@1413 : TextConst 'ENU=Null recipient country';
      Text414@1414 : TextConst 'ENU=Only International can be processed';
      Text415@1415 : TextConst 'ENU=Dimension length is not numeric';
      Text416@1416 : TextConst 'ENU=Dimension width is not numeric';
      Text417@1417 : TextConst 'ENU=Dimension height is not numeric';
      Text418@1418 : TextConst 'ENU=Declared value is not numeric';
      Text419@1419 : TextConst 'ENU=Package count is NULL';
      Text420@1420 : TextConst 'ENU=Package count is not numeric';
      Text421@1421 : TextConst 'ENU=Invalid country';
      Text422@1422 : TextConst 'ENU=Invalid recipient country';
      Text423@1423 : TextConst 'ENU=Service type is null';
      Text424@1424 : TextConst 'ENU=Dimension width is greater than 99';
      Text425@1425 : TextConst 'ENU=Package weight is null';
      Text426@1426 : TextConst 'ENU=Package weight is not numeric';
      Text427@1427 : TextConst 'ENU=Recipient ZIP code is null';
      Text428@1428 : TextConst 'ENU=Date is non-numeric';
      Text429@1429 : TextConst 'ENU=Invalid date';
      Text430@1430 : TextConst 'ENU=Date cannot be less than current date';
      Text431@1431 : TextConst 'ENU=Date cannot be increased more than 7 days from current date';
      Text432@1432 : TextConst 'ENU=Dangerous goods class is null';
      Text433@1433 : TextConst 'ENU=Cargo Aircraft is not allowed with this service';
      Text434@1434 : TextConst 'ENU=Invalid dangerous goods class';
      Text435@1435 : TextConst 'ENU=URSA state doesn`t match recipient state';
      Text436@1436 : TextConst 'ENU=Shipper ZIP code is null';
      Text437@1437 : TextConst 'ENU=Failure to properly access an *.INI file';
      Text438@1438 : TextConst 'ENU=Weight type not pounds or kilograms';
      Text439@1439 : TextConst 'ENU=Currency not found in *.INI file';
      Text440@1440 : TextConst 'ENU=Package count 1 is null';
      Text441@1441 : TextConst 'ENU=Package count 2 is null';
      Text442@1442 : TextConst 'ENU=Package count 3 is null';
      Text443@1443 : TextConst 'ENU=Package count 4 is null';
      Text444@1444 : TextConst 'ENU=Package count 1 is non-numeric';
      Text445@1445 : TextConst 'ENU=Package count 2 is non-numeric';
      Text446@1446 : TextConst 'ENU=Package count 3 is non-numeric';
      Text447@1447 : TextConst 'ENU=Package count 4 is non-numeric';
      Text448@1448 : TextConst 'ENU=Weight 1 is null';
      Text449@1449 : TextConst 'ENU=Weight 2 is null';
      Text450@1450 : TextConst 'ENU=Weight 3 is null';
      Text451@1451 : TextConst 'ENU=Weight 4 is null';
      Text452@1452 : TextConst 'ENU=Weight 1 is non-numeric';
      Text453@1453 : TextConst 'ENU=Weight 2 is non-numeric';
      Text454@1454 : TextConst 'ENU=Weight 3 is non-numeric';
      Text455@1455 : TextConst 'ENU=Weight 4 is non-numeric';
      Text456@1456 : TextConst 'ENU=Customs value 1 is null';
      Text457@1457 : TextConst 'ENU=Customs value 1 is non-numeric';
      Text458@1458 : TextConst 'ENU=Customs value 2 is non-numeric';
      Text459@1459 : TextConst 'ENU=Customs value 3 is non-numeric';
      Text460@1460 : TextConst 'ENU=Customs value 4 is non-numeric';
      Text461@1461 : TextConst 'ENU=Package count is greater than 999';
      Text462@1462 : TextConst 'ENU=Package weight is zero';
      Text463@1463 : TextConst 'ENU=Error opening input transaction';
      Text464@1464 : TextConst 'ENU=International Priority Freight Service not available to this country';
      Text465@1465 : TextConst 'ENU=International Priority Freight Service dimension height is greater than 70 inches';
      Text466@1466 : TextConst 'ENU=Invalid sender country';
      Text467@1467 : TextConst 'ENU=Null sender country';
      Text468@1468 : TextConst 'ENU=Drop off not available with this service';
      Text469@1469 : TextConst 'ENU=Saturday Pickup and Saturday Delivery mutually exclusive';
      Text470@1470 : TextConst 'ENU=Inconsistent dimension and weight units. Use CM with KG and IN with LB.';
      Text471@1471 : TextConst 'ENU=The FedEx RATING service is not responding';
      Text472@1472 : TextConst 'ENU=The FedEx ROUTING service is not responding';
      Text473@1473 : TextConst 'ENU=The FedEx AIRBILL service is not responding';
      Text474@1474 : TextConst 'ENU=The FedEx SHIP service is not responding';
      Text475@1475 : TextConst 'ENU=The FedEx ADMIN service is not responding';
      Text476@1476 : TextConst 'ENU=You must provide a billing account number';
      Text477@1477 : TextConst 'ENU=Please specify weight in whole numeric pounds';
      Text478@1478 : TextConst 'ENU=Please specify dry ice weight in whole numeric pounds';
      Text479@1479 : TextConst 'ENU=Please enter declared value in whole numeric dollars';
      Text480@1480 : TextConst 'ENU=Tracking number must be numeric';
      Text481@1481 : TextConst 'ENU=Customs value must be numeric';
      Text482@1482 : TextConst 'ENU=Carriage value must be numeric';
      Text483@1483 : TextConst 'ENU=Carriage value exceeds Customs value';
      Text484@1484 : TextConst 'ENU=Registration not allowed from selected country';
      Text485@1485 : TextConst 'ENU=User ID must be at least three digits';
      Text486@1486 : TextConst 'ENU=Invalid dimensional height';
      Text487@1487 : TextConst 'ENU=Invalid dimensional width';
      Text488@1488 : TextConst 'ENU=Invalid dimensional length';
      Text489@1489 : TextConst 'ENU=Invalid dimensional units';
      Text490@1490 : TextConst 'ENU=Declared value cannot exceed $25000';
      Text491@1491 : TextConst 'ENU=Label format code must be 1, 2, or 3';
      Text492@1492 : TextConst 'ENU=Label Type must be 1';
      Text493@1493 : TextConst 'ENU=Label Printer Type must be 1, 2, or 3';
      Text494@1494 : TextConst 'ENU=Label Media Type must be 2, 3, 4, 5';
      Text495@1495 : TextConst 'ENU=COD Flag must be Y or N';
      Text496@1496 : TextConst 'ENU=COD Add Freight Flag must be Y or N';
      Text497@1497 : TextConst 'ENU=COD Collection Type must be 1, 2, or 3';
      Text498@1498 : TextConst 'ENU=Home Delivery Flag must be Y or N';
      Text499@1499 : TextConst 'ENU=Home Type must be 1 or 2';
      Text500@1500 : TextConst 'ENU=Home Delivery date must be 8 numeric digits';
      Text501@1501 : TextConst 'ENU=Residential Delivery Flag must be Y or N';
      Text502@1502 : TextConst 'ENU=Auto POD Flag must be Y or N';
      Text503@1503 : TextConst 'ENU=AOD Flag must be Y or N';
      Text504@1504 : TextConst 'ENU=Hazardous Materials Flag must be Y or N';
      Text505@1505 : TextConst 'ENU=Date required for Select Day Delivery Service';
      Text506@1506 : TextConst 'ENU=Telephone number required for Select Day Delivery Service';
      Text507@1507 : TextConst 'ENU=Telephone number required for Appointment Delivery Service';
      Text508@1508 : TextConst 'ENU=Additional Handling Flag must be Y or N';
      Text509@1509 : TextConst 'ENU=Additional Handling Amount must be between 0 and $9,999,999.99';
      Text510@1510 : TextConst 'ENU=Additional Handling Percentage must be between 0 and 9999.99 percent';
      Text511@1511 : TextConst 'ENU="When using Additional Handling Flag, either Additional Handling Amount or "';
      Text512@1512 : TextConst 'ENU=Additional Handling Percentage are required';
      Text513@1513 : TextConst 'ENU=Date chosen for Select Day Delivery Service is a holiday';
      Text514@1514 : TextConst 'ENU=Ground Packaging type must be 01, 02, or 03';
      Text515@1515 : TextConst 'ENU=Ground Service Type must be 90 or 92';
      Text516@1516 : TextConst 'ENU=Home Delivery Telephone number must be 10 numeric digits';
      Text517@1517 : TextConst 'ENU=Electronic COD Flag must be Y or N';
      Text518@1518 : TextConst 'ENU=Pre-Delivery Alert Flag must be Y or N';
      Text519@1519 : TextConst 'ENU=COD and Electronic COD cannot both be used at the same time';
      Text520@1520 : TextConst 'ENU=Cash or Guaranteed funds cannot be used with Electronic COD';
      Text521@1521 : TextConst 'ENU=Combination of special services chosen are not valid for this shipment';
      Text522@1522 : TextConst 'ENU=Electronic COD is not allowed with Bill Third Party';
      Text523@1523 : TextConst 'ENU=COD is not allowed with Bill Collect unless AutoPOD is also selected';
      Text524@1524 : TextConst 'ENU=Purchase order number cannot exceed than 35 characters';
      Text525@1525 : TextConst 'ENU=Invoice number cannot exceed 35 characters';
      Text526@1526 : TextConst 'ENU=Customer reference number cannot exceed 35 characters';
      Text527@1527 : TextConst 'ENU=Shipper contact name cannot exceed 35 characters';
      Text528@1528 : TextConst 'ENU=Shipper company name cannot exceed 35 characters';
      Text529@1529 : TextConst 'ENU=Shipper address line 1 cannot exceed 35 characters';
      Text530@1530 : TextConst 'ENU=Shipper address line 2 cannot exceed 35 characters';
      Text531@1531 : TextConst 'ENU=Shipper city cannot exceed 20 characters';
      Text532@1532 : TextConst 'ENU=Shipper email address cannot exceed 80 characters';
      Text533@1533 : TextConst 'ENU=Recipient contact name cannot exceed 35 characters';
      Text534@1534 : TextConst 'ENU=Recipient company name cannot exceed 35 characters';
      Text535@1535 : TextConst 'ENU=Recipient address line 1 cannot exceed 35 characters';
      Text536@1536 : TextConst 'ENU=Recipient address line 2 cannot exceed 35 characters';
      Text537@1537 : TextConst 'ENU=Recipient city cannot exceed 20 characters';
      Text538@1538 : TextConst 'ENU=Recipient email address cannot exceed 80 characters';
      Text539@1539 : TextConst 'ENU=Shipper contact name must be at least 3 characters';
      Text540@1540 : TextConst 'ENU=Shipper company name must be at least 3 characters';
      Text541@1541 : TextConst 'ENU=Shipper address line 1 must be at least 3 characters';
      Text542@1542 : TextConst 'ENU=Shipper city must be at least 3 characters';
      Text543@1543 : TextConst 'ENU=Recipient contact name must be at least 3 characters';
      Text544@1544 : TextConst 'ENU=Recipient company name must be at least 3 characters';
      Text545@1545 : TextConst 'ENU=Recipient address line 1 must be at least 3 characters';
      Text546@1546 : TextConst 'ENU=Recipient city must be at least 3 characters';
      Text547@1547 : TextConst 'ENU=Sender Name and/or company required';
      Text548@1548 : TextConst 'ENU=Recipient Name and/or company required';
      Text549@1549 : TextConst 'ENU=Cannot ship from Puerto Rico';
      Text550@1550 : TextConst 'ENU=User ID must be numeric';
      Text551@1551 : TextConst 'ENU=This payment type not allowed to the selected destination';
      Text552@1552 : TextConst 'ENU=Girth + length exceeds maximum of 130  for service type';
      Text553@1553 : TextConst 'ENU=Special Service AOD not available to selected destination';
      Text554@1554 : TextConst 'ENU=Special Service Auto POD not available to selected destination';
      Text555@1555 : TextConst 'ENU=Special Service COD not available to selected destination';
      Text556@1556 : TextConst 'ENU=Special Service Electronic COD not available to selected destination';
      Text557@1557 : TextConst 'ENU=Special Service Hazardous Materials not available to selected destination';
      Text558@1558 : TextConst 'ENU=Special Service Pre-Delivery Alert not available to selected destination';
      Text559@1559 : TextConst 'ENU=Special Service Delivery by Appointment not available to selected destination';
      Text560@1560 : TextConst 'ENU=Special Service Evening Appointment not available to selected destination';
      Text561@1561 : TextConst 'ENU=Special Service Signature Delivery not available to selected destination';
      Text562@1562 : TextConst 'ENU=User ID not found in customer profile subscriber database';
      Text563@1563 : TextConst 'ENU=Special Service Auto POD not available for this user ID';
      Text564@1564 : TextConst 'ENU=Special Service COD not available for this user ID';
      Text565@1565 : TextConst 'ENU=Special Service Electronic COD not available for this user ID';
      Text566@1566 : TextConst 'ENU=Special Service Hazardous Materials not available for this user ID';
      Text567@1567 : TextConst 'ENU=Special Service Pre-Delivery Alert not available for this user ID';
      Text568@1568 : TextConst 'ENU=Special Service AOD not available for this user ID';
      Text569@1569 : TextConst 'ENU=Special Service Delivery by Appointment not available for this user ID';
      Text570@1570 : TextConst 'ENU=Special Service Evening Appointment not available for this user ID';
      Text571@1571 : TextConst 'ENU=Special Service Signature Delivery not available for this user ID';
      Text572@1572 : TextConst 'ENU="Pre-Delivery Alert requires either Recipient Email ID "';
      Text573@1573 : TextConst 'ENU=or Fax number exclusively,but not both';
      Text574@1574 : TextConst 'ENU=Either Recipient Email ID or Fax number must be used with Pre-Delivery Alert';
      Text575@1575 : TextConst 'ENU=FedEx Ground Rating Error - dynamically defined at run time';
      Text576@1576 : TextConst 'ENU=FedEx Ground Rating Error - Package dimensions too large';
      Text577@1577 : TextConst 'ENU=FedEx Ground Rating Error - Carrier Code passed not supported';
      Text578@1578 : TextConst 'ENU=FedEx Ground Rating Error - Service Code not available for destination area';
      Text579@1579 : TextConst 'ENU=FedEx Ground Rating Error - Origin Postal Code does not match Origin country';
      Text580@1580 : TextConst 'ENU=FedEx Ground Rating Error - Destination Postal Code does not match Destination country';
      Text581@1581 : TextConst 'ENU=FedEx Ground Rating Error - FedEx Home Delivery Packages may not exceed 70 lbs in weight';
      Text582@1582 : TextConst 'ENU=FedEx Ground Rating Error - Appointment Delivery already requires a signature.';
      Text583@1583 : TextConst 'ENU="FedEx Ground Rating Error - "';
      Text584@1584 : TextConst 'ENU=Appointment Delivery already allows consignee to select day and time of delivery';
      Text585@1585 : TextConst 'ENU=You must select Appointment Delivery instead of Select and Evening Delivery';
      Text586@1586 : TextConst 'ENU=AutoPOD must be accompanied by an accessorial which requires a signature';
      Text587@1587 : TextConst 'ENU=Electronic C.O.D. can not be selected with a payment type of Bill 3rd Party';
      Text588@1588 : TextConst 'ENU=FedEx Ground Upload Error - could not establish a TCP/IP connection pool';
      Text589@1589 : TextConst 'ENU=FedEx Ground Upload Error - could not get an FSS CST TCP/IP connection';
      Text590@1590 : TextConst 'ENU=FedEx Ground Upload Error - communications failure when uploading to FSS';
      Text591@1591 : TextConst 'ENU=FedEx Ground Upload Error - could not login to FSS when uploading shipment';
      Text592@1592 : TextConst 'ENU=FedEx Ground Upload Error - communications failure attempting FSS Logon';
      Text593@1593 : TextConst 'ENU=FedEx Ground Upload Error - communications failure when creating shipment queue';
      Text594@1594 : TextConst 'ENU=FedEx Ground Upload Error - communications failure when adding shipment to queue';
      Text595@1595 : TextConst 'ENU=FedEx Ground Upload Error - communications failure when deleting shipment from queue';
      Text596@1596 : TextConst 'ENU=FedEx Customer Profile Error - cannot access Customer Profile Database';
      Text597@1597 : TextConst 'ENU=%1 formatted is %2 with %3 decimals.';
      Text598@1598 : TextConst 'ENU=Environment strings SystemRoot and windir not found.';
      Text599@1599 : TextConst 'ENU=webapi.ini not found in %1.';
      Text600@1600 : TextConst 'ENU=Wrong FDXHOST string %1.';
      Text601@1601 : TextConst 'ENU=FDXHOST Line not found in %1.';

    PROCEDURE GlobalRegistrationRequest@1(VAR CurrentFedExGlobalRegistration@1000000000 : Record 14000786);
    VAR
      Answer@1000000001 : Integer;
    BEGIN
      WITH CurrentFedExGlobalRegistration DO BEGIN
        GetPackingStation;
        CarrierPackingStation.GetPackingStation(PackingStation);
        CarrierPackingStation.TESTFIELD("Proxy Address");
        CarrierPackingStation.TESTFIELD("Proxy Port");
        {
        FedEx.WebInit;
        FedEx.InitProperties;
        TESTFIELD("Shipper Company Name");
        TESTFIELD("Shipper Address 1");
        TESTFIELD("Shipper City");
        TESTFIELD("Shipper State");
        TESTFIELD("Shipper ZIP Code");
        TESTFIELD("Shipper Country Code");
        TESTFIELD("Shipper Account No.");
        TESTFIELD("Shipper Contact");
        TESTFIELD("Shipper Phone Number");
        FedEx.propTransactionType('211');
        FedEx.propTransactionID("Transaction ID");
        FedEx.propSenderFedExAccountNo("Shipper Account No.");

        FedEx.propSubscriberContactName("Shipper Contact");
        FedEx.propSubscriberCompanyName("Shipper Company Name");
        FedEx.propSubscriberAddressLine1("Shipper Address 1");
        FedEx.propSubscriberAddressLine2("Shipper Address 2");
        FedEx.propSubscriberCityName("Shipper City");
        FedEx.propSubscriberStateCode(FixState("Shipper State"));
        FedEx.propSubscriberPostalCode(FixZIPCode("Shipper ZIP Code"));
        FedEx.propSubscriberCountryCode("Shipper Country Code");
        FedEx.propSubscriberPhoneNo(FixPhoneNo("Shipper Phone Number"));
        FedEx.propSubscriberFaxNo(FixPhoneNo("Shipper FAX Number"));
        FedEx.propSubscriberEmailAddress("Email Address");

        Window.OPEN(Text001);
        Answer :=
          FedEx.WebSubscribe(CarrierPackingStation."Proxy Address",CarrierPackingStation."Proxy Port");
        Window.CLOSE;
        TestConnectionError(Answer);
        "Error Code" := FedEx.propErrorCode;
        "Error Message" := FedEx.propErrorMessage;;
        IF "Error Code" <> '' THEN
          IF CheckErrorCode("Error Code") <> '' THEN
            "Error Message" := CheckErrorCode("Error Code");
        IF "Error Code" = '0' THEN BEGIN
          "Meter Number" := FedEx.propMeterNo;
          "Subscription Service 1" := FedEx.propSubscriptionServiceName(1);
          "Subscription Service 2" := FedEx.propSubscriptionServiceName(2);
          MESSAGE(Text002);
        END ELSE
          MESSAGE(Text003);
        MODIFY;
        Window.OPEN(Text001);
        Answer := FedEx.WebRelease;}
        Window.CLOSE;
      END;
    END;

    LOCAL PROCEDURE GetTransactionID@3() NextTransactionID@1000000000 : Code[40];
    VAR
      ShippingNumbering@1240030000 : Record 14000725;
      NoSeriesMgt@1000000001 : Codeunit 396;
    BEGIN
      GetShippingSetup;
      GetPackingStation;
      CarrierPackingStation.GetPackingStation(PackingStation);

      IF ShippingNumbering.GET(
           DATABASE::"Shipping Setup",ShippingSetup."Primary Key",
           ShippingSetup.FIELDNO("Last FedEx Transaction No."))
      THEN BEGIN
        ShippingNumbering.GetNextNumber;
        NextTransactionID := ShippingNumbering."Last No. Used";
      END ELSE BEGIN
        ShippingSetup.TESTFIELD("FedEx Transaction Nos.");
        NextTransactionID := NoSeriesMgt.GetNextNo(ShippingSetup."FedEx Transaction Nos.",WORKDATE,TRUE);
      END;

      CarrierPackingStation.TESTFIELD("FedEx Buffer Directory");
      IF COPYSTR(
           CarrierPackingStation."FedEx Buffer Directory",
           STRLEN(CarrierPackingStation."FedEx Buffer Directory"),1) =
         '\'
      THEN
        BufferFileName :=
          CarrierPackingStation."FedEx Buffer Directory" + NextTransactionID + '.buf'
      ELSE
        BufferFileName :=
          CarrierPackingStation."FedEx Buffer Directory" + '\' + NextTransactionID + '.buf';
    END;

    LOCAL PROCEDURE TestConnectionError@6(ErrorNumber@1000000000 : Integer);
    BEGIN
      IF ErrorNumber = 0 THEN
        EXIT;

      CASE ABS(ErrorNumber) OF
        1:
          ERROR(Text004 + Text005);
        2:
          ERROR(Text006);
        3:
          ERROR(Text007);
        4:
          ERROR(Text008);
        5:
          ERROR(Text009);
        6:
          ERROR(Text010);
        7:
          ERROR(Text011);
        8:
          ERROR(Text012);
        9:
          ERROR(Text013);
        10:
          ERROR(Text014);
        11:
          ERROR(Text015);
        12:
          ERROR(Text016);
        13:
          ERROR(Text017);
        14,15:
          ERROR(Text018);
        16:
          ERROR(Text019);
        17,18:
          ERROR(Text020);
        19:
          ERROR(Text021);
        20:
          ERROR(Text022);
        21:
          ERROR(Text023);
        22:
          ERROR(Text024);
        23:
          ERROR(Text025);
        24:
          ERROR(Text026 + Text027);
        25:
          ERROR(Text028);
        26:
          ERROR(Text029);
        27:
          ERROR(Text030);
        28:
          ERROR(Text031);
        29:
          ERROR(Text032);
        30:
          ERROR(Text033);
        31:
          ERROR(Text034);
        32:
          ERROR(Text035);
        33:
          ERROR(Text036);
        62:
          ERROR(Text037);
        90:
          ERROR(Text038);
        91:
          ERROR(Text039);
        92:
          ERROR(Text040);
        93:
          ERROR(Text041);
        ELSE
          ERROR(Text042,ErrorNumber);
      END;
    END;

    LOCAL PROCEDURE TrackingRequest@4(CurrentFedExTracking@1000000000 : Record 14000785);
    VAR
      FedExTracking@1000000001 : Record 14000785;
    BEGIN
      // Not used RGN
    END;

    LOCAL PROCEDURE DeleteRequest@5(VAR CurrentFedExDeletePackage@1000000000 : Record 14000787) : Code[4];
    VAR
      FedExDeletePackage@1000000001 : Record 14000787;
      Package@1000000002 : Record 14000701;
      PostedPackage@1000000003 : Record 14000704;
      TransactionID@1000000004 : Code[40];
      Answer@1000000005 : Integer;
      SessionHandle@1000000006 : Integer;
    BEGIN
      WITH CurrentFedExDeletePackage DO BEGIN
        SessionHandle := GetSession(0,FALSE);
        TransactionID := "Transaction ID";
        FedExDeletePackage.RESET;
        FedExDeletePackage.SETRANGE("Transaction Type",123);
        FedExDeletePackage.SETRANGE("Transaction ID",TransactionID);
        IF FedExDeletePackage.FIND('+') THEN BEGIN
          TransactionID := GetTransactionID;
          FedExDeletePackage.INIT;
          FedExDeletePackage.COPY(CurrentFedExDeletePackage);
          FedExDeletePackage."Transaction ID" := TransactionID;
          FedExDeletePackage.INSERT;
        END;

        GetGlobalShipperInfo;
      {
        FedEx.propTransactionType(Integer2Text("Transaction Type"));
        FedEx.propTransactionID(TransactionID);
        IF "Shipper Account No." = '' THEN
          "Shipper Account No." := FedExGlobalRegistration."Shipper Account No.";
        FedEx.propSenderFedExAccountNo("Shipper Account No.");
        IF "Meter Number" = '' THEN
          "Meter Number" := FedExGlobalRegistration."Meter Number";
        FedEx.propMeterNo("Meter Number");
        FedEx.propTrackingNo("Master Tracking No.");
        IF Carrier = Carrier::"FedEx Express" THEN
          FedEx.propCarrierCode('FDXE')
        ELSE
          FedEx.propCarrierCode('FDXG');

        Window.OPEN(Text001);
        Answer := FedEx.WebDeleteAPackage(SessionHandle,Carrier <> Carrier::"FedEx Express");
        Window.CLOSE;
        TestConnectionError(Answer);

        FedExDeletePackage.INIT;
        FedExDeletePackage.COPY(CurrentFedExDeletePackage);
        FedExDeletePackage."Transaction Type" := Text2Integer(FedEx.propTransactionType);
        FedExDeletePackage."Transaction ID" := TransactionID;
        FedExDeletePackage."Error Code" := FedEx.propErrorCode;
        FedExDeletePackage."Error Message" := FedEx.propErrorMessage;
        IF FedExDeletePackage."Error Code" <> '' THEN BEGIN
          IF CheckErrorCode(FedExDeletePackage."Error Code") <> '' THEN
            FedExDeletePackage."Error Message" := CheckErrorCode(FedExDeletePackage."Error Code");
        END;
        FedExDeletePackage.INSERT;
        EndSession(SessionHandle,FALSE);
       }
        IF FedExDeletePackage."Error Code" = '0' THEN BEGIN
          Package.RESET;
          Package.SETCURRENTKEY("External Tracking No.");
          Package.SETRANGE("External Tracking No.","Master Tracking No.");
          IF Package.FIND('-') THEN
            REPEAT
              Package.Closed := FALSE;
              Package.MODIFY;
            UNTIL Package.NEXT = 0;
          PostedPackage.RESET;
          PostedPackage.SETCURRENTKEY("External Tracking No.");
          PostedPackage.SETRANGE("External Tracking No.","Master Tracking No.");
          IF PostedPackage.FIND('-') THEN
            REPEAT
              PostedPackage.Closed := FALSE;
              PostedPackage.MODIFY;
            UNTIL PostedPackage.NEXT = 0;
        END ELSE
          MESSAGE(Text043 + '%1',FedExDeletePackage."Error Message");

        EXIT(FedExDeletePackage."Error Code");
      END;
    END;

    LOCAL PROCEDURE GetRate@8(VAR CurrentFedExShipment@1000000000 : Record 14000783;GiveNoError@1000000001 : Boolean) : Decimal;
    VAR
      FedExShipment@1000000003 : Record 14000783;
      TransactionID@1000000004 : Code[40];
      Answer@1000000005 : Integer;
      SessionHandle@1000000006 : Integer;
    BEGIN
      WITH CurrentFedExShipment DO BEGIN
        SessionHandle := GetSession(0,FALSE);
        TransactionID := "Transaction ID";
        FedExShipment.RESET;
        FedExShipment.SETRANGE("Transaction Type",122);
        FedExShipment.SETRANGE("Transaction ID",TransactionID);
        IF FedExShipment.FIND('+') THEN BEGIN
          TransactionID := GetTransactionID;
          FedExShipment.INIT;
          FedExShipment.COPY(CurrentFedExShipment);
          FedExShipment."Transaction ID" := TransactionID;
          FedExShipment.INSERT;
        END;
        GetGlobalShipperInfo;
      {  FedEx.propTransactionType(Integer2Text("Transaction Type"));
        FedEx.propTransactionID(TransactionID);
        IF "Shipper Account No." = '' THEN
          "Shipper Account No." := FedExGlobalRegistration."Shipper Account No.";
        FedEx.propSenderFedExAccountNo("Shipper Account No.");
        IF "Meter Number" = '' THEN
          "Meter Number" := FedExGlobalRegistration."Meter Number";
        FedEx.propMeterNo("Meter Number");
        IF Carrier = Carrier::"FedEx Express" THEN
          FedEx.propCarrierCode('FDXE')
        ELSE
          FedEx.propCarrierCode('FDXG');

        SetOCXProperties(CurrentFedExShipment,NOT GiveNoError);

        Window.OPEN(Text001);
        Answer := FedEx.WebGetRate(SessionHandle,Carrier <> Carrier::"FedEx Express");
        Window.CLOSE;
        IF Answer <> 0 THEN BEGIN
          IF GiveNoError THEN
            EXIT(0)
          ELSE
            TestConnectionError(Answer);
        END;

        FedExShipment.INIT;
        FedExShipment.COPY(CurrentFedExShipment);
        FedExShipment."Transaction Type" := 122;
        FedExShipment."Transaction ID" := TransactionID;
        FedExShipment."Error Code" := FedEx.propErrorCode;
        FedExShipment."Error Message" := FedEx.propErrorMessage;
        IF FedExShipment."Error Code" <> '' THEN
          IF CheckErrorCode(FedExShipment."Error Code") <> '' THEN
            FedExShipment."Error Message" := CheckErrorCode(FedExShipment."Error Code");
        FedExShipment."Rate Currency Type" := FedEx.propRateCurrencyType;
        FedExShipment."Rate Weight Unit of Measure" := FedEx.propRateWeightUnitofMeasure;
        FedExShipment."Dim Weight Unit of Measure" := FedEx.propDimWeightUnitofMeasure;
        FedExShipment."Billed Weight" := Text2Decimal(FedEx.propBilledWeight);
        FedExShipment."Dim Weight" := Text2Decimal(FedEx.propDimWeight);
        FedExShipment."Base Charge" := Text2Decimal(FedEx.propBaseRateAmount);
        FedExShipment."Total Surcharge" := Text2Decimal(FedEx.propTotalSurchargeAmount);
        FedExShipment."Total Discount" := Text2Decimal(FedEx.propTotalDiscountAmount);
        FedExShipment."Net Charge" := Text2Decimal(FedEx.propNetChargeAmount);
        FedExShipment."Total Rebate Amount" := Text2Decimal(FedEx.propTotalRebateAmount);
        FedExShipment.Oversize := YN2Boolean(FedEx.propOversizeFlag);
        FedExShipment.INSERT;
        EndSession(SessionHandle,FALSE);}
        IF FedExShipment."Error Message" <> '' THEN BEGIN
          IF GiveNoError THEN
            EXIT(0)
          ELSE
            ERROR(FedExShipment."Error Message");
        END;
        EXIT(FedExShipment."Net Charge");
      END;
    END;

    PROCEDURE GetShippingCharge@12(VAR CurrentPackage@1000000000 : Record 14000701;GiveNoError@1000000001 : Boolean);
    VAR
      FedExOptionPage@1000000002 : Record 14000781;
      FedExShipment@1000000003 : Record 14000783;
      TransactionID@1000000006 : Code[40];
      TotalCharge@1000000007 : Decimal;
    BEGIN
      WITH CurrentPackage DO BEGIN
        GetShippingAgent("Shipping Agent Code");
        IF ShippingAgent."Disable Rate Calculation" THEN
          EXIT;

        GetShippingSetup;
        GetPackingStation;
        CarrierPackingStation.GetPackingStation(PackingStation);
        CarrierPackingStation.TESTFIELD("FedEx Shipping Agent Acc. No.");
        ShippingAgentAccount.GET(CarrierPackingStation."FedEx Shipping Agent Acc. No.");
        GetShippingAgentService("Shipping Agent Code","Shipping Agent Service","World Wide Service");
        FedExOptionPage.GET(FedExOptionPage.Type::Package,"No.",0,0);

        TestWEBAPI(ShippingAgentAccount);

        TransactionID := GetTransactionID;
        ClearTotalValueFields;
        VALIDATE("Calculation Weight",GetWeight);
        TESTFIELD("Calculation Weight");
        GetCalculationFields(1,'>');
        TESTFIELD("Calculation Value");

        FedExShipment.INIT;
        FedExShipment."Transaction Type" := 22;
        FedExShipment."Transaction ID" := TransactionID;

        IF ShippingAgentService."Transport Method Type" =
           ShippingAgentService."Transport Method Type"::Ground
        THEN
          FedExShipment.Carrier := FedExShipment.Carrier::"FedEx Ground";

        FedExShipment."Destination State" := FixState("Ship-to State");
        FedExShipment."Destination Zip Code" := FixZIPCode("Ship-to ZIP Code");
        FedExShipment."Destination Country Code" := GetFedExCountryCode("Ship-to Country Code");

        IF "Packing Date" = 0D THEN
          "Packing Date" := WORKDATE;
        FedExShipment."Shipment Date - Integer" := Date2Integer("Packing Date");

        CASE "Shipping Payment Type" OF
          "Shipping Payment Type"::"Third Party":
            BEGIN
              TESTFIELD("Third Party Ship. Account No.");
              FedExShipment."Payment Code" := '3';
              FedExShipment."Payer Country Code" := GetFedExCountryCode("Ship-to Country Code");
            END;
          "Shipping Payment Type"::"Freight Collect":
            BEGIN
              TESTFIELD("Third Party Ship. Account No.");
              FedExShipment."Payor Account Number" := "Third Party Ship. Account No.";
              IF FedExShipment.Carrier = FedExShipment.Carrier::"FedEx Express" THEN
                FedExShipment."Payment Code" := '2'
              ELSE
                FedExShipment."Payment Code" := '5';
            END;
          "Shipping Payment Type"::Consignee:
            BEGIN
              IF FedExShipment.Carrier = FedExShipment.Carrier::"FedEx Express" THEN
                ERROR(Text044);
              FedExShipment."Payment Code" := '2';
            END;
          ELSE
            FedExShipment."Payment Code" := '1';
        END;

        IF COD THEN BEGIN
          FedExShipment."Payment Code" := '1';
          FedExShipment."COD Flag" := TRUE;
          TESTFIELD("COD Amount");
          FedExShipment."COD Amount" := "COD Amount";
          IF "COD Cashiers Check" THEN
            FedExShipment."COD Collection Type" := '2'
          ELSE
            FedExShipment."COD Collection Type" := '1';
        END;

        IF ShippingSetup."Default Weight Units" =
           ShippingSetup."Default Weight Units"::LBS
        THEN
          FedExShipment."Weight Units" := 'LBS'
        ELSE
          FedExShipment."Weight Units" := 'KGS';

        FedExShipment."Service Code" := "Service Indicator";
        FedExShipment."Package Weight" := ROUND("Calculation Weight",0.1);
        FedExShipment."Declared Value" := ROUND("Calculation Insured Value",0.01);

        // RGN commented out because FEDEX doesn't support this yet.
        //  IF "Total Packages" > 1 THEN BEGIN
        //    DomesticShip."Package Sequence" := "Package No.";
        //    DomesticShip."Package Count" := "Total Packages";
        //  END ELSE BEGIN
        FedExShipment."Package Sequence" := 1;
        FedExShipment."Package Count" := 1;
        // END;
        FedExShipment."Source ID" := "Source ID";
        FedExShipment."Package No." := "No.";
        FedExShipment."Package Length" := "Calculation Length";
        FedExShipment."Package Width" := "Calculation Width";
        FedExShipment."Package Height" := "Calculation Height";

        TransferFromOptionPage(
          FedExShipment,FedExOptionPage,ShippingAgentService,"Residential Delivery");

        FedExShipment.INSERT;
        TotalCharge := GetRate(FedExShipment,GiveNoError);
        IF TotalCharge <> 0 THEN BEGIN
          FedExShipment.GET(122,TransactionID);
          "FedEx Transaction ID" := TransactionID;
          "Shipping Cost" := TotalCharge;
          "Base Charge" := FedExShipment."Base Charge";
          Surcharge := FedExShipment."Total Surcharge";
          "Discount Amount" := FedExShipment."Total Discount";
          "Rebate Amount" := FedExShipment."Total Rebate Amount";
          IF NOT Closed THEN BEGIN
            Markup :=
              Shipping.GetMarkup(
                ShippingAgentService,"Shipping Cost","Ship-to Type","Ship-to No.","Ship-to Code");
            IF "Override Shipping Charge" <> 0 THEN
              "Shipping Charge" := "Override Shipping Charge"
            ELSE
              "Shipping Charge" := "Shipping Cost" + Markup + "Additional Shipping Charge";
          END;
          TestAndTransferToThirdParty(CurrentPackage,FedExOptionPage,ShippingAgentService);
        END;
      END;
    END;

    PROCEDURE RateShop@14(RateShopHeader@1000000000 : Record 14000741;VAR RateShopLine@1000000001 : Record 14000742;CurrentShippingAgentService@1000000002 : Record 14000708);
    VAR
      FedExShipment@1000000003 : Record 14000783;
      FedExOptionPage@1000000004 : Record 14000781;
      RateShopLineCOD@1000000009 : Record 14000742;
      FedExTrans@1000000010 : Codeunit 14000781;
      ShipmentDate@1000000007 : Date;
      TransactionID@1000000008 : Code[40];
      InsureThroughShippingAgent@1240030000 : Boolean;
      TotalCharge@1240030001 : Decimal;
    BEGIN
      WITH RateShopHeader DO BEGIN
        GetShippingAgent(CurrentShippingAgentService."Shipping Agent Code");
        IF ShippingAgent."Disable Rate Calculation" THEN
          EXIT;

        GetShippingSetup;
        CLEAR(PackingStation);
        IF "Rate Shop Packing Station Code" <> '' THEN
          PackingStation.GET("Rate Shop Packing Station Code")
        ELSE
          GetPackingStation;
        CarrierPackingStation.GetPackingStation(PackingStation);
        CarrierPackingStation.TESTFIELD("FedEx Shipping Agent Acc. No.");
        ShippingAgentAccount.GET(CarrierPackingStation."FedEx Shipping Agent Acc. No.");

        TestWEBAPI(ShippingAgentAccount);

        IF NOT FedExOptionPage.GET(FedExOptionPage.Type::"Rate Shop",RateShopHeader."No.",0,0) THEN
          IF NOT FedExOptionPage.GET(FedExOptionPage.Type::Package,RateShopHeader."Package No.",0,0) THEN
            IF NOT FedExOptionPage.GET(
                     FedExOptionPage.Type::Document,RateShopHeader."Source ID",
                     RateShopHeader."Source Type",RateShopHeader."Source Subtype")
            THEN
              IF NOT FedExOptionPage.GET(
                       FedExOptionPage.Type::"Bill of Lading",RateShopHeader."Bill of Lading No.",0,0)
              THEN BEGIN
                FedExOptionPage.RESET;
                FedExOptionPage.SETCURRENTKEY(
                  Type,"Shipping Agent Code","Shipping Agent Service","World Wide Service");
                FedExOptionPage.SETRANGE(Type,FedExOptionPage.Type::Setup);
                FedExOptionPage.SETRANGE(
                  "Shipping Agent Code",CurrentShippingAgentService."Shipping Agent Code");
                FedExOptionPage.SETRANGE("Shipping Agent Service",CurrentShippingAgentService.Code);
                FedExOptionPage.SETRANGE(
                  "World Wide Service",CurrentShippingAgentService."World Wide Service");
                IF NOT FedExOptionPage.FIND('-') THEN
                  FedExOptionPage.INIT;
              END;

        TransactionID := GetTransactionID;
        IF "No. of Packages" < 1 THEN
          "No. of Packages" := 1;
        VALIDATE("Calculation Weight",GetWeight / "No. of Packages");
        TESTFIELD("Calculation Weight");
        "Calculation Value" := GetValue / "No. of Packages";
        TESTFIELD("Calculation Value");

        CASE "Shipping Insurance" OF
          "Shipping Insurance"::" ":
            IF "Shipping Payment Type" = "Shipping Payment Type"::Prepaid THEN
              InsureThroughShippingAgent := ShippingAgentAccount."Insure Through Carrier"
            ELSE
              InsureThroughShippingAgent := ShippingAgentAccount."Insured Third Party/Collect";
          "Shipping Insurance"::Never:
            InsureThroughShippingAgent := FALSE;
          "Shipping Insurance"::Always:
            InsureThroughShippingAgent := TRUE;
        END;
        "Calculation Insured Value" := GetInsuredValue(InsureThroughShippingAgent) / "No. of Packages";

        "Calculation Volume" := GetVolume / "No. of Packages";
        // Add Handling for Rate Shop for Dimensions
        IF ShippingAgentAccount."COD Rule" <>
           ShippingAgentAccount."COD Rule"::"All on Last Package"
        THEN
          "COD Amount" := "COD Amount" / "No. of Packages";

        FedExShipment.INIT;
        FedExShipment."Transaction Type" := 22;
        FedExShipment."Transaction ID" := TransactionID;

        IF CurrentShippingAgentService."Transport Method Type" =
           CurrentShippingAgentService."Transport Method Type"::Ground
        THEN
          FedExShipment.Carrier := FedExShipment.Carrier::"FedEx Ground";
        FedExShipment."Destination Zip Code" := FixZIPCode("Ship-to ZIP Code");
        FedExShipment."Destination Country Code" := GetFedExCountryCode("Ship-to Country Code");

        IF "Shipment Date" = 0D THEN
          ShipmentDate := WORKDATE
        ELSE
          ShipmentDate := "Shipment Date";
        FedExShipment."Shipment Date - Integer" := Date2Integer(ShipmentDate);

        FedExShipment."Payment Code" := '1';

        IF COD THEN BEGIN
          FedExShipment."COD Flag" := TRUE;
          TESTFIELD("COD Amount");
          FedExShipment."COD Amount" := "COD Amount";
          IF "COD Cashiers Check" THEN
            FedExShipment."COD Collection Type" := '2'
          ELSE
            FedExShipment."COD Collection Type" := '1';
        END;

        IF ShippingSetup."Default Weight Units" =
           ShippingSetup."Default Weight Units"::LBS
        THEN
          FedExShipment."Weight Units" := 'LBS'
        ELSE
          FedExShipment."Weight Units" := 'KGS';

        FedExShipment."Service Code" := CurrentShippingAgentService."Service Indicator";
        FedExShipment."Package Weight" := ROUND("Calculation Weight",0.1);
        FedExShipment."Declared Value" := ROUND("Calculation Insured Value",0.01);

        FedExShipment."Package Sequence" := 1;
        FedExShipment."Package Count" := 1;
        FedExShipment."Rate Shop No." := "No.";
        FedExShipment."Package Length" := "Calculation Length";
        FedExShipment."Package Width" := "Calculation Width";
        FedExShipment."Package Height" := "Calculation Height";

        TransferFromOptionPage(
          FedExShipment,FedExOptionPage,CurrentShippingAgentService,"Residential Delivery");

        FedExShipment.INSERT;
        TotalCharge := GetRate(FedExShipment,TRUE);
        IF CarrierPackingStation."FedEx Save RateShop Buffers" THEN
      //    FedEx.SaveBuffer(BufferFileName);

        IF FedExShipment.GET(122,TransactionID) THEN BEGIN
          RateShopLine.INIT;
          RateShopLine."Rate Shop No." := "No.";
          RateShopLine."Shipping Agent Code" := CurrentShippingAgentService."Shipping Agent Code";
          RateShopLine."World Wide Service" := CurrentShippingAgentService."World Wide Service";
          RateShopLine."Shipping Agent Service" := CurrentShippingAgentService.Code;
          RateShopLine."Insure Through Shipping Agent" := InsureThroughShippingAgent;
          RateShopLine.Sorting := CurrentShippingAgentService."Rateshop Sorting";
          RateShopLine."Service Description" := CurrentShippingAgentService.Description;
          RateShopLine."Service Error Message" := FedExShipment."Error Message";
          RateShopLine."Hundred Weight Rate" := FALSE;
          RateShopLine."Base Charge" := FedExShipment."Base Charge";
          RateShopLine.Surcharge := FedExShipment."Total Surcharge";
          RateShopLine."Discount Amount" := FedExShipment."Total Discount";
          RateShopLine."Rebate Amount" := FedExShipment."Total Rebate Amount";
          RateShopLine."Shipping Cost" := TotalCharge;
          RateShopLine.Markup :=
            Shipping.GetMarkup(
              CurrentShippingAgentService,RateShopLine."Shipping Cost",
              0,"Sell-to Customer No.","Ship-to Code");
          RateShopLine."Shipping Charge" :=
            RateShopLine."Shipping Cost" + RateShopLine.Markup + "Additional Shipping Charge";
          TestAndTransferToThirdPartyRS(
            RateShopHeader,RateShopLine,FedExOptionPage,CurrentShippingAgentService);

          IF "No. of Packages" > 1 THEN BEGIN
            IF COD AND
               (ShippingAgentAccount."COD Rule" = ShippingAgentAccount."COD Rule"::"All on Last Package")
            THEN BEGIN
              RateShopLineCOD := RateShopLine;
              COD := FALSE;

              FedExTrans.RateShop(RateShopHeader,RateShopLine,CurrentShippingAgentService);
              RateShopLine.DELETE;

              RateShopLine.DivideCharges("No. of Packages");
              RateShopLine.MultiplyCharges("No. of Packages" - 1);
              RateShopLine.AddCharges(RateShopLineCOD);

              COD := TRUE;
            END ELSE
              RateShopLine.MultiplyCharges("No. of Packages");
          END;

          IF "Value (Price)" <> 0 THEN
            RateShopLine."Order Amount" := "Value (Price)"
          ELSE
            RateShopLine."Order Amount" := "Override Value";
          RateShopLine."Total Amount" :=
            RateShopLine."Order Amount" + RateShopLine."Shipping Charge";
          RateShopLine.INSERT;
        END;
      END;
    END;

    LOCAL PROCEDURE TransferFromOptionPage@42(VAR CurrentFedExShipment@1000000000 : Record 14000783;FedExOptionPage@1000000001 : Record 14000781;CurrentShippingAGentService@1000000002 : Record 14000708;ResidentialDelivery@1240030000 : Boolean);
    BEGIN
      WITH CurrentFedExShipment DO BEGIN
        Autopod := FedExOptionPage.AutoPod;
        IF FedExOptionPage."Export Declared Value Currency" <> '' THEN
          Currency := FedExOptionPage."Export Declared Value Currency";

        CASE FedExOptionPage."Dimension Units" OF
          FedExOptionPage."Dimension Units"::Inches:
            "Dim Units" := 'I';
          FedExOptionPage."Dimension Units"::Centimeters:
            "Dim Units" := 'C';
        END;

        "Inside Pickup" := FedExOptionPage."Inside Pick Up";
        "Inside Delivery" := FedExOptionPage."Inside Delivery";
        //"Hold at Location" := FedExOptionPage."Hold At Location";
        "Ship Alert" := FedExOptionPage."Ship Notification";
        "Sunday Delivery" := FedExOptionPage."Sunday Delivery";
        "Saturday Delivery" := FedExOptionPage."Saturday Delivery";
        "Saturday Pickup" := FedExOptionPage."Saturday Pickup";
        "Dry Ice" := FedExOptionPage."Dry Ice";
        "Alcohol Flag" := FedExOptionPage.Alcohol;
        "Release Authorization No." := FedExOptionPage."Signature Release Auth.";
        "Signature Release Flag" := FedExOptionPage."Signature Release";
        "Acknowledgement of Delivery" := FedExOptionPage."Acknowledgement of Delivery";

        IF ResidentialDelivery THEN BEGIN
          "Residential Delivery Flag" := TRUE;
          "Home Signature Delivery Flag" := FedExOptionPage."Signature Required";
        END;

        IF FedExOptionPage."Dry Ice" THEN BEGIN
          "Dry Ice" := TRUE;
          FedExOptionPage.TESTFIELD("Dry Ice Weight");
          "Dry Ice Weight" := ROUND(FedExOptionPage."Dry Ice Weight",1);
        END;

        {CASE FedExOptionPage."Dangerous Goods Type" OF
          FedExOptionPage."Dangerous Goods Type"::Accessible:
            "Dangerous Goods Type" := 'A';
           FedExOptionPage."Dangerous Goods Type"::Inaccessible:
            "Dangerous Goods Type" := 'I';
        END;}

        CASE FedExOptionPage."Drop Off Type" OF
          FedExOptionPage."Drop Off Type"::"Regular Pickup":
            "Drop Off Type" := '1';
          FedExOptionPage."Drop Off Type"::"Request Courier":
            "Drop Off Type" := '2';
          FedExOptionPage."Drop Off Type"::"Drop Box":
            "Drop Off Type" := '3';
        END;

        IF NOT (CurrentShippingAGentService."Transport Method Type" =
                CurrentShippingAGentService."Transport Method Type"::Ground)
        THEN BEGIN
          CASE FedExOptionPage."FedEx Packaging Type" OF
            FedExOptionPage."FedEx Packaging Type"::"Customer Packaging":
              "Packaging Type" := '01';
            FedExOptionPage."FedEx Packaging Type"::"FedEx Pak":
              "Packaging Type" := '02';
            FedExOptionPage."FedEx Packaging Type"::"FedEx Box":
              "Packaging Type" := '03';
            FedExOptionPage."FedEx Packaging Type"::"FedEx Tube":
              "Packaging Type" := '04';
            FedExOptionPage."FedEx Packaging Type"::"FedEx Envelope":
              "Packaging Type" := '06';
            FedExOptionPage."FedEx Packaging Type"::Packet:
              "Packaging Type" := '08';
            FedExOptionPage."FedEx Packaging Type"::"FedEx 10kg Box":
              "Packaging Type" := '15';
            FedExOptionPage."FedEx Packaging Type"::"FedEx 25kg Box":
              "Packaging Type" := '25';
          END;
        END ELSE BEGIN
          "Packaging Type" := '01';
          "Nonstandard Package Flag" := 'N';
        END;

        IF CurrentShippingAGentService."World Wide Service" THEN BEGIN
          CASE FedExOptionPage."International Terms of Sale" OF
            FedExOptionPage."International Terms of Sale"::"Freight On Board",
            FedExOptionPage."International Terms of Sale"::"Free Carrier":
              "Terms of Sale" := '1';
            FedExOptionPage."International Terms of Sale"::"Cost-Insurance-Freight",
            FedExOptionPage."International Terms of Sale"::"Carriage Insurance Paid":
              "Terms of Sale" := '2';
            FedExOptionPage."International Terms of Sale"::"Cost and Freight",
            FedExOptionPage."International Terms of Sale"::"Carrier Paid To":
              "Terms of Sale" := '3';
            FedExOptionPage."International Terms of Sale"::"Ex Works":
              "Terms of Sale" := '4';
            FedExOptionPage."International Terms of Sale"::"Delivered Duty Unpaid":
              "Terms of Sale" := '5';
            FedExOptionPage."International Terms of Sale"::"Delivered Duty Paid":
              "Terms of Sale" := '6';
          END;
          "Document Flag" := FedExOptionPage."Non-dutiable Document";
          "NAFTA Flag" := FedExOptionPage.NAFTA;
        END;

        {IF FedExOptionPage."Hold At Location" THEN BEGIN
          "Hold at Location" := TRUE;
          "HAL Station Address 1" := FedExOptionPage."HAL FedEx Location Address";
          "HAL City" := FedExOptionPage."HAL FedEx Location City";
          "HAL State" := FixState(FedExOptionPage."HAL FedEx Location State");
          "HAL Zip Code" := FixZIPCode(FedExOptionPage."HAL FedEx Location Zip");
          "HAL Phone Number" := FixPhoneNo(FedExOptionPage."HAL Recipient Phone No.");
        END;}

      END;
    END;

    LOCAL PROCEDURE SetCustomeFields@43(VAR CurrentFedExShipment@1000000000 : Record 14000783;CurrentPackage@1000000001 : Record 14000701);
    VAR
      PackageLine@1000000002 : Record 14000702;
      PackingRule@1240030000 : Record 14000715;
    BEGIN
      WITH CurrentFedExShipment DO BEGIN
        PackageLine.RESET;
        PackageLine.SETRANGE("Package No.",CurrentPackage."No.");
        IF PackageLine.FIND('-') THEN BEGIN
          "Commodity Count 1" := PackageLine.Quantity;
          "Commodity Description 1" := CONVERTSTR(COPYSTR(PackageLine.Description,1,30),'"',' ');
          "Country of Manufacture 1" := GetFedExCountryCode(PackageLine."Country of Manufacture");
          IF PackageLine."Export License Required" THEN BEGIN
            PackageLine.TESTFIELD("Schedule B code");
            "Harmonized Code 1" := PackageLine."Schedule B code";
            "Export License No. 1" :=PackingStation."Export License No.";
            "Export License Exp. 1 - Int" :=
              Date2Integer(PackingStation."Export License Expiration Date");
            "License Exception Symbol 1" := PackingStation."Export License Exception";
          END;
          "Unit Quantity 1" := PackageLine."Qty. per Unit of Measure";
          "Unit of Measure 1" := FixUnitOfMeasure(PackageLine."Unit of Measure Code");
          "Export Control Class No. 1" := PackageLine."Export Controls Class No.";
          "Weight 1" := PackageLine."Net Weight";
          "Unit Value 1" := PackageLine."Value (Price)";
          "Customs Value 1" := PackageLine."Value (Price)";
          IF PackageLine.NEXT <> 0 THEN BEGIN
            "Commodity Count 2" := PackageLine.Quantity;
            "Commodity Description 2" := CONVERTSTR(COPYSTR(PackageLine.Description,1,30),'"',' ');
            "Country of Manufacture 2" := GetFedExCountryCode(PackageLine."Country of Manufacture");
            IF PackageLine."Export License Required" THEN BEGIN
              PackageLine.TESTFIELD("Schedule B code");
              "Harmonized Code 2" := PackageLine."Schedule B code";
              "Export License No. 2" := PackingStation."Export License No.";
              "Export License Exp. 2 - Int" :=
                Date2Integer(PackingStation."Export License Expiration Date");
              "License Exception Symbol 2" := PackingStation."Export License Exception";
            END;
            "Unit Quantity 2" := PackageLine."Qty. per Unit of Measure";
            "Unit of Measure 2" := FixUnitOfMeasure(PackageLine."Unit of Measure Code");
            "Export Control Class No. 2" := PackageLine."Export Controls Class No.";
            "Weight 2" := PackageLine."Net Weight";
            "Unit Value 2" := PackageLine."Value (Price)";
            "Customs Value 2" := PackageLine."Value (Price)";
            IF PackageLine.NEXT <> 0 THEN BEGIN
              "Commodity Count 3" := PackageLine.Quantity;
              "Commodity Description 3" := CONVERTSTR(COPYSTR(PackageLine.Description,1,30),'"',' ');
              "Country of Manufacture 3" := GetFedExCountryCode(PackageLine."Country of Manufacture");
              IF PackageLine."Export License Required" THEN BEGIN
                PackageLine.TESTFIELD("Schedule B code");
                "Harmonized Code 3" := PackageLine."Schedule B code";
                "Export License No. 3" := PackingStation."Export License No.";
                "Export License Exp. 3 - Int" :=
                  Date2Integer(PackingStation."Export License Expiration Date");
                "License Exception Symbol 3" :=
                  PackingStation."Export License Exception";
              END;
              "Unit Quantity 3" := PackageLine."Qty. per Unit of Measure";
              "Unit of Measure 3" := FixUnitOfMeasure(PackageLine."Unit of Measure Code");
              "Export Control Class No. 3" := PackageLine."Export Controls Class No.";
              "Weight 3" := PackageLine."Net Weight";
              "Unit Value 3" := PackageLine."Value (Price)";
              "Customs Value 3" := PackageLine."Value (Price)";
              IF PackageLine.NEXT <> 0 THEN BEGIN
                "Commodity Count 4" := PackageLine.Quantity;
                "Commodity Description 4" := CONVERTSTR(COPYSTR(PackageLine.Description,1,30),'"',' ');
                "Country of Manufacture 4" := GetFedExCountryCode(PackageLine."Country of Manufacture");
                IF PackageLine."Export License Required" THEN BEGIN
                  PackageLine.TESTFIELD("Schedule B code");
                  "Harmonized Code 4" := PackageLine."Schedule B code";
                  "Export License No. 4" := PackingStation."Export License No.";
                  "Export License Exp. 4 - Int" :=
                    Date2Integer(PackingStation."Export License Expiration Date");
                  "License Exception Symbol 4" :=
                    PackingStation."Export License Exception";
                END;
                "Unit Quantity 4" := PackageLine."Qty. per Unit of Measure";
                "Unit of Measure 4" :=
                  FixUnitOfMeasure(PackageLine."Unit of Measure Code");
                "Export Control Class No. 4" := PackageLine."Export Controls Class No.";
                "Weight 4" := PackageLine."Net Weight";
                "Unit Value 4" := PackageLine."Value (Price)";
                "Customs Value 4" := PackageLine."Value (Price)";
              END;
            END;
          END;
        END ELSE BEGIN
          GetShippingSetup;
          GetShippingAgent(CurrentPackage."Shipping Agent Code");
          PackingRule.GetPackingRule(
            CurrentPackage."Ship-to Type",CurrentPackage."Ship-to No.",CurrentPackage."Ship-to Code");
          IF NOT PackingRule.PackDetail(
                   CurrentPackage."Source Type",CurrentPackage."Source Subtype",
                   CurrentPackage."Shipping Agent Code")
          THEN BEGIN
            "Commodity Count 1" := 1;
            "Commodity Description 1" :=
              COPYSTR(STRSUBSTNO(Text045,CurrentPackage."Source ID"),1,30);
            "Country of Manufacture 1" := 'US';
          END ELSE
            ERROR(Text046);
        END;
      END;
    END;

    LOCAL PROCEDURE SetOCXProperties@46(CurrentFedExShipment@1000000000 : Record 14000783;GiveError@1000000001 : Boolean);
    BEGIN
      WITH CurrentFedExShipment DO BEGIN
      {  FedEx.propRecipientCompany("Destination Company Name");
        FedEx.propRecipientContactName("Destination Contact Name");
        FedEx.propRecipientAddressLine1("Destination Address 1");
        FedEx.propRecipientAddressLine2("Destination Address 2");
        FedEx.propRecipientCity("Destination City");
        FedEx.propRecipientState("Destination State");
        FedEx.propRecipientPostalCode("Destination Zip Code");
        FedEx.propRecipientPhoneNo("Destination Phone Number");
        FedEx.propRecipientCountry("Destination Country Code");
        FedEx.propRecipientIRSNo("Destination IRS EIN Number");
        FedEx.propDestDepartment("Recipient Department");

        FedEx.propShipDate(Integer2Text("Shipment Date - Integer"));

        IF "Payor Account Number" <> '' THEN
          FedEx.propPayorAccountNo("Payor Account Number");
        FedEx.propPayType("Payment Code");
        IF Currency = '' THEN
          Currency := 'USD';
        FedEx.propCustomsCurrencyType(Currency);

        IF "International Shipment" THEN BEGIN
          FedEx.propDutiesPayType("Payment Code");
          IF "Payor Account Number" <> '' THEN
            FedEx.propDutiesPayorAccountNo("Payor Account Number");
          FedEx.propDutiesPayorCountryCode("Payer Country Code");
        END;
        FedEx.propPayorCountryCode("Payer Country Code");

        FedEx.propPackageSequence(Integer2Text("Package Sequence"));
        FedEx.propNumberofPackages(Integer2Text("Package Count"));

        IF "International Shipment" THEN BEGIN
          IF NOT "Document Flag" THEN BEGIN
            IF GiveError THEN
              TESTFIELD("Terms of Sale");
            FedEx.propTermsofSale("Terms of Sale");
            FedEx.propDocumentFlag('N');
          END ELSE BEGIN
            FedEx.propDocumentFlag('Y');
          END;
          FedEx.propCountryofUltimateDest("Destination Country Code");
          FedEx.propTotalCustomsValue(Decimal2Text("Total Customs Value",2));
          IF "NAFTA Flag" THEN
            FedEx.propNAFTAFlag('Y');
          FedEx.propDeclaredValue(Decimal2Text("Declared Value",2));
        END;
        FedEx.propDeclaredValue(Decimal2Text("Declared Value",2));
        FedEx.propWeightUnits("Weight Units");
        FedEx.propTotalPackageWeight(Decimal2Text("Package Weight",1));
        FedEx.propDimUnits("Dim Units");
        IF "Package Height" <> 0 THEN
          FedEx.propDimHeight(Decimal2Text("Package Height",0));
        IF "Package Width" <> 0 THEN
          FedEx.propDimWidth(Decimal2Text("Package Width",0));
        IF "Package Length" <> 0 THEN
          FedEx.propDimLength(Decimal2Text("Package Length",0));

        IF "Signature Release Flag" THEN BEGIN
          IF GiveError THEN
            TESTFIELD("Release Authorization No.");
          FedEx.propReleaseAuthorizationNo("Release Authorization No.");
        END;

        IF "COD Flag" THEN BEGIN
          FedEx.propCODReturnContactName("COD Return Contact Name");
          FedEx.propCODReturnPhone(FixPhoneNo("COD Return Phone"));
          FedEx.propCODReturnCompany("COD Return Company");
          FedEx.propCODReturnDepartment("COD Return Department");
          FedEx.propCODReturnAddress1("COD Return Address 1");
          FedEx.propCODReturnAddress2("COD Return Address 2");
          FedEx.propCODReturnCity("COD Return City");
          FedEx.propCODReturnState(FixState("COD Return State"));
          FedEx.propCODReturnPostalCode(FixZIPCode("COD Return Postal Code"));

          FedEx.propCODShipmentFlag('Y');
          FedEx.propCODIncludeFreightCharges('Y');
          FedEx.propCODAmount(Decimal2Text("COD Amount",2));
          FedEx.propCODAddFlag(Boolean2YN("Add Freight Charges"));
          FedEx.propCODCollectionType("COD Collection Type");
        END;

        IF "Residential Delivery Flag" THEN BEGIN
          FedEx.propResidentialDeliveryFlag('Y');
          FedEx.propSignatureHomeDeliveryflag(Boolean2YN("Home Signature Delivery Flag"));
          FedEx.propHomeDeliveryType("Home Delivery Type");
          FedEx.propHomeDeliveryDate(Integer2Text("Home Delivery Date - Integer"));
          FedEx.propHomeDeliveryPhoneNo(FixPhoneNo("Home Delivery Phone No."));
        END;

        IF "Hold at Location" THEN BEGIN
          FedEx.propHALFlag('Y');
          FedEx.propHALAddress("HAL Station Address 1");
          FedEx.propHALCity("HAL City");
          FedEx.propHALState(FixState("HAL State"));
          FedEx.propHALPostalCode(FixZIPCode("HAL Zip Code"));
          FedEx.propHALPhoneNo(FixPhoneNo("HAL Phone Number"));
        END;

        IF "Dry Ice" THEN BEGIN
          FedEx.propDryIceFlag('Y');
          FedEx.propDryIceWeight(Decimal2Text("Dry Ice Weight",1));
        END;

        IF "Ship Alert" THEN BEGIN
          FedEx.propShipAlertNotificationFlag('Y');
          FedEx.propShipAlertMessage("Ship Alert Message");
          FedEx.propShipAlertFaxNo(FixPhoneNo("Ship Alert Fax No."));
          FedEx.propShipAlertEmailAddress("Ship Alert Email Address 1",1);
          FedEx.propShipAlertEmailAddress("Ship Alert Email Address 2",2);
          FedEx.propShipAlertEmailAddress("Ship Alert Email Address 3",3);
        END;

        FedEx.propPackagingType("Packaging Type");
        FedEx.propServiceType("Service Code");
        FedEx.propReferenceInformation("Reference Notes");
        FedEx.propGroundInvoiceNo("Ground Invoice No.");
        FedEx.propGroundCustomerReferenceNo("Ground Customer Reference No.");
        FedEx.propPurchaseOrderNo("Ground Purchase Order No.");
        FedEx.propDangerousGoodsType("Dangerous Goods Type");
        FedEx.propAlcoholFlag(Boolean2YN("Alcohol Flag"));
        FedEx.propSignatureReleaseOKFlag(Boolean2YN("Signature Release Flag"));
        FedEx.propFutureDayShipment(Boolean2YN("Future Day Ship"));
        FedEx.propInsidePickupFlag(Boolean2YN("Inside Pickup"));
        FedEx.propInsideDeliveryFlag(Boolean2YN("Inside Delivery"));
        FedEx.propSignatureRequired(Boolean2YN("No Indirect Delivery Flag"));
        FedEx.propSundayDeliveryFlag(Boolean2YN("Sunday Delivery"));
        FedEx.propSaturdayDeliveryFlag(Boolean2YN("Saturday Delivery"));
        FedEx.propSaturdayPickupFlag(Boolean2YN("Saturday Pickup"));
        FedEx.propDropOffType("Drop Off Type");
        FedEx.propAutopodFlag(Boolean2YN(Autopod));
        FedEx.propAODFlag(Boolean2YN("Acknowledgement of Delivery"));

        FedEx.propLabelType("Label Type");
        FedEx.propLabelPrinterType("Label Printer Type");
        FedEx.propLabelMediaType("Label Media Type");

        IF "International Shipment" THEN BEGIN
          IF "Commodity Count 1" > 0 THEN BEGIN
            FedEx.propCommodityNoOfPieces(Integer2Text("Commodity Count 1"),1);
            FedEx.propDescriptionofContents("Commodity Description 1",1);
            FedEx.propCountryofManufacturer("Country of Manufacture 1",1);
            FedEx.propHarmonizedCode("Harmonized Code 1",1);
            FedEx.propUnitQuantity(Integer2Text("Unit Quantity 1"),1);
            FedEx.propExportLicenseNo("Export License No. 1",1);
            FedEx.propExportLicenseExpDate(Integer2Text("Export License Exp. 1 - Int"),1);
            FedEx.propCommodityLicenseException("License Exception Symbol 1",1);
            FedEx.propCommodityUnitofMeasure("Unit of Measure 1",1);
            FedEx.propCommodityECCN("Export Control Class No. 1",1);
            FedEx.propCommodityWeight(Decimal2Text("Weight 1",1),1);
            FedEx.propCommodityUnitValue(Decimal2Text("Unit Value 1",6),1);
            FedEx.propCommodityCustomsValue(Decimal2Text("Customs Value 1",6),1);
          END;
          IF "Commodity Count 2" > 0 THEN BEGIN
            FedEx.propCommodityNoOfPieces(Integer2Text("Commodity Count 2"),2);
            FedEx.propDescriptionofContents("Commodity Description 2",2);
            FedEx.propCountryofManufacturer("Country of Manufacture 2",2);
            FedEx.propHarmonizedCode("Harmonized Code 2",2);
            FedEx.propUnitQuantity(Integer2Text("Unit Quantity 2"),2);
            FedEx.propExportLicenseNo("Export License No. 2",2);
            FedEx.propExportLicenseExpDate(Integer2Text("Export License Exp. 2 - Int"),2);
            FedEx.propCommodityLicenseException("License Exception Symbol 2",2);
            FedEx.propCommodityUnitofMeasure("Unit of Measure 2",2);
            FedEx.propCommodityECCN("Export Control Class No. 2",2);
            FedEx.propCommodityWeight(Decimal2Text("Weight 2",1),2);
            FedEx.propCommodityUnitValue(Decimal2Text("Unit Value 2",6),2);
            FedEx.propCommodityCustomsValue(Decimal2Text("Customs Value 2",6),2);
          END;
          IF "Commodity Count 3" > 0 THEN BEGIN
            FedEx.propCommodityNoOfPieces(Integer2Text("Commodity Count 3"),3);
            FedEx.propDescriptionofContents("Commodity Description 3",3);
            FedEx.propCountryofManufacturer("Country of Manufacture 3",3);
            FedEx.propHarmonizedCode("Harmonized Code 3",3);
            FedEx.propUnitQuantity(Integer2Text("Unit Quantity 3"),3);
            FedEx.propExportLicenseNo("Export License No. 3",3);
            FedEx.propExportLicenseExpDate(Integer2Text("Export License Exp. 3 - Int"),3);
            FedEx.propCommodityLicenseException("License Exception Symbol 3",3);
            FedEx.propCommodityUnitofMeasure("Unit of Measure 3",3);
            FedEx.propCommodityECCN("Export Control Class No. 3",3);
            FedEx.propCommodityWeight(Decimal2Text("Weight 3",1),3);
            FedEx.propCommodityUnitValue(Decimal2Text("Unit Value 3",6),3);
            FedEx.propCommodityCustomsValue(Decimal2Text("Customs Value 3",6),3);
          END;
          IF "Commodity Count 4" > 0 THEN BEGIN
            FedEx.propCommodityNoOfPieces(Integer2Text("Commodity Count 4"),4);
            FedEx.propDescriptionofContents("Commodity Description 4",4);
            FedEx.propCountryofManufacturer("Country of Manufacture 4",4);
            FedEx.propHarmonizedCode("Harmonized Code 4",4);
            FedEx.propUnitQuantity(Integer2Text("Unit Quantity 4"),4);
            FedEx.propExportLicenseNo("Export License No. 4",4);
            FedEx.propExportLicenseExpDate(Integer2Text("Export License Exp. 4 - Int"),4);
            FedEx.propCommodityLicenseException("License Exception Symbol 4",4);
            FedEx.propCommodityUnitofMeasure("Unit of Measure 4",4);
            FedEx.propCommodityECCN("Export Control Class No. 4",4);
            FedEx.propCommodityWeight(Decimal2Text("Weight 4",1),4);
            FedEx.propCommodityUnitValue(Decimal2Text("Unit Value 4",6),4);
            FedEx.propCommodityCustomsValue(Decimal2Text("Customs Value 4",6),4);
          END;
        END;}
      END;
    END;

    LOCAL PROCEDURE ShipPackage@9(VAR CurrentFedExShipment@1000000001 : Record 14000783;VAR NewTransactionID@1000000002 : Code[40];CurrentPackage@1000000003 : Record 14000701) ErrorMessage@1000000000 : Text[250];
    VAR
      FedExShipment@1000000004 : Record 14000783;
      GifFileName@1000000006 : Text[250];
      Answer@1000000007 : Integer;
      SessionHandle@1000000008 : Integer;
    BEGIN
      GetShippingSetup;

      WITH CurrentFedExShipment DO BEGIN
        SessionHandle := GetSession(0,FALSE);
        IF NOT "International Shipment" THEN
          TESTFIELD("Destination Zip Code");
        IF ("Destination Company Name" = '') AND ("Destination Contact Name" = '') THEN
          ERROR(Text047);
        TESTFIELD("Destination Address 1");
        TESTFIELD("Destination City");
        IF NOT "International Shipment" THEN
          TESTFIELD("Destination State");
        TESTFIELD("Destination Phone Number");
        TESTFIELD("Package Weight");
        TESTFIELD("Service Code");
        TESTFIELD("Payment Code");
        TESTFIELD("Shipment Date - Integer");

        NewTransactionID := "Transaction ID";
        FedExShipment.RESET;
        FedExShipment.SETRANGE("Transaction Type",21);
        FedExShipment.SETRANGE("Transaction ID",NewTransactionID);
        IF FedExShipment.FIND('+') THEN BEGIN
          NewTransactionID := GetTransactionID;
          FedExShipment.INIT;
          FedExShipment.COPY(CurrentFedExShipment);
          FedExShipment."Transaction ID" := NewTransactionID;
          FedExShipment.INSERT;
        END;
        GetGlobalShipperInfo;

      {  FedEx.propTransactionType('021');
        FedEx.propTransactionID(NewTransactionID);

        IF "Shipper Account No." = '' THEN
          "Shipper Account No." := FedExGlobalRegistration."Shipper Account No.";
        IF "Meter Number" = '' THEN
          "Meter Number" := FedExGlobalRegistration."Meter Number";

        FedEx.propSenderFedExAccountNo("Shipper Account No.");
        FedEx.propMeterNo("Meter Number");
        IF "International Shipment" THEN BEGIN
          TESTFIELD("Shipper IRS EIN No.");
          FedEx.propSenderIRSNo("Shipper IRS EIN No.");
        END;

        IF Carrier = Carrier::"FedEx Express" THEN
          FedEx.propCarrierCode('FDXE')
        ELSE
          FedEx.propCarrierCode('FDXG');

        SetOCXProperties(CurrentFedExShipment,TRUE);

        Window.OPEN(Text001);
        Answer := FedEx.WebShipPackage(SessionHandle,Carrier <> Carrier::"FedEx Express");
        Window.CLOSE;
        TestConnectionError(Answer);
        FedEx.SaveBuffer(BufferFileName);

        FedExShipment.INIT;
        FedExShipment.COPY(CurrentFedExShipment);
        FedExShipment."Transaction Type" := 121;
        FedExShipment."Transaction ID" := NewTransactionID;
        FedExShipment."Error Code" := FedEx.propErrorCode;
        FedExShipment."Error Message" := FedEx.propErrorMessage;
        IF FedExShipment."Error Code" <> '' THEN
          IF CheckErrorCode(FedExShipment."Error Code") <> '' THEN
            FedExShipment."Error Message" := CheckErrorCode(FedExShipment."Error Code");

        FedExShipment."Master Tracking No." := FedEx.propTrackingNo;
        FedExShipment."Tracking Form ID" := FedEx.propFormID;
        FedExShipment."COD Return Tracking No." := FedEx.propCODReturnTrackingNo;
        FedExShipment."COD Return Tracking Form ID" := FedEx.propCODReturnFormID;

        FedExShipment."DIM Weight Used Flag" := YN2Boolean(FedEx.propDimWeightUsedFlag);
        FedExShipment."Rate Scale" := FedEx.propRateScale;
        FedExShipment."Rate Currency Type" := FedEx.propRateCurrencyType;
        FedExShipment."Billed Weight" := Text2Decimal(FedEx.propBilledWeight);
        FedExShipment."Dim Weight" := Text2Decimal(FedEx.propDimWeight);
        FedExShipment."Base Charge" := Text2Decimal(FedEx.propBaseRateAmount);
        FedExShipment."Total Surcharge" := Text2Decimal(FedEx.propTotalSurchargeAmount);
        FedExShipment."Total Discount" := Text2Decimal(FedEx.propTotalDiscountAmount);
        FedExShipment."Net Charge" := Text2Decimal(FedEx.propNetChargeAmount);
        FedExShipment."Total Rebate Amount" := Text2Decimal(FedEx.propTotalRebateAmount);

        FedExShipment."URSA Code" := FedEx.propURSACode;
        FedExShipment."Service Area" := FedEx.propServiceCommitment;
        FedExShipment."ASTRA Bar Code Data" := FedEx.propASTRABarCodeData;
        FedExShipment."Delivery Day" := FedEx.propDeliveryDay;
        FedExShipment."Routing Location ID" := FedEx.propDestStationID;
        FedExShipment."Delivery Date - Text" := FedEx.propDeliveryDate;
        FedExShipment."COD Return ASTRA Barcode" := FedEx.propCODReturnAstraBarCode;
        FedExShipment."COD Return Service Area" := FedEx.propCODReturnServiceCommitment;
        FedExShipment."URSA Prefix Code" := FedEx.propUrsaPrefixCode;
        FedExShipment."Buffer File Name" := BufferFileName;}
        IF "Label Printer Type" = '1' THEN BEGIN
          IF Carrier = Carrier::"FedEx Express" THEN
            GifFileName := COPYSTR(BufferFileName,1,STRPOS(BufferFileName,'.buf') - 1) + '.gif'
          ELSE
            GifFileName := COPYSTR(BufferFileName,1,STRPOS(BufferFileName,'.buf') - 1) + '.png';
        END ELSE
          GifFileName := COPYSTR(BufferFileName,1,STRPOS(BufferFileName,'.buf') - 1) + '.txt';
        FedExShipment."Gif Label File Name" := GifFileName;
        FedExShipment.INSERT;
        EndSession(SessionHandle,FALSE);
        ErrorMessage := FedExShipment."Error Message";
      END;
    END;

    PROCEDURE ClosePackage@7(VAR CurrentPackage@1240030000 : Record 14000701;VAR MultiDocPackageTmp@1240030002 : Record 14000701;CurrentShippingAgent@1240030003 : Record 291;PrintLabel@1240030004 : Boolean);
    VAR
      FedExOptionPage@1000000002 : Record 14000781;
      FedExShipment@1000000003 : Record 14000783;
      FedExShipment2@1000000004 : Record 14000783;
      Package@1000000005 : Record 14000701;
      CompanyInfo@1000000006 : Record 79;
      MultiDocPackageMgt@1240030005 : Codeunit 14000703;
      ShipToPhone@1000000007 : Code[15];
      ErrorMessage@1000000009 : Text[250];
      TextPos@1000000010 : Integer;
      TempFileName@1000000011 : Text[250];
      BaseFileName@1000000012 : Text[250];
      Sequence@1000000013 : Integer;
      TextLabel@1000000015 : Boolean;
      TempBoolean@1000000016 : Boolean;
      TransactionID@1000000017 : Code[40];
      CODMarkup@1240030001 : Decimal;
    BEGIN
      WITH CurrentPackage DO BEGIN
        TESTFIELD(Closed,FALSE);

        IF "Manual Shipment" THEN BEGIN
          IF CurrentShippingAgent."Enter Ext. Track. No. on Close" THEN
            Shipping.EnterExternalTrackingNo(CurrentPackage,FALSE);

          "Closed by Packing Station Code" := PackingStation.Code;
          ClearTotalValueFields;
          VALIDATE("Calculation Weight",GetWeight);
          GetCalculationFields(1,'>');
          "Packing Date" := WORKDATE;
          "Packing Time" := TIME;
          "Packed By" := USERID;
          "Shipping Cost" := 0;
          Markup := 0;
          IF "Override Shipping Charge" <> 0 THEN
            "Shipping Charge" := "Override Shipping Charge"
          ELSE
            "Shipping Charge" := "Shipping Cost" + Markup + "Additional Shipping Charge";
          Closed := TRUE;
          MODIFY;
          COMMIT;

          IF "Multi Document Package" THEN BEGIN
            GetShippingSetup;
            GetPackingStation;
            MultiDocPackageMgt.SplitMultiDocPackage(
              CurrentPackage,MultiDocPackageTmp,PackingStation,ShippingSetup);
            COMMIT;
          END;

          EXIT;
        END;

        GetShippingSetup;
        GetPackingStation;
        CarrierPackingStation.GetPackingStation(PackingStation);
        CarrierPackingStation.TESTFIELD("FedEx Shipping Agent Acc. No.");
        IF PrintLabel THEN
          CarrierPackingStation.TESTFIELD("FedEx Label Printer Port");
        ShippingAgentAccount.GET(CarrierPackingStation."FedEx Shipping Agent Acc. No.");
        GetShippingAgentService("Shipping Agent Code","Shipping Agent Service","World Wide Service");
        FedExOptionPage.GET(FedExOptionPage.Type::Package,"No.",0,0);

        GetShippingAgent("Shipping Agent Code");
        CheckName(
          ShippingAgent,0,"Ship-to Name","Ship-to Name 2","Ship-to Contact",
          FIELDCAPTION("Ship-to Name"),FIELDCAPTION("Ship-to Name 2"),FIELDCAPTION("Ship-to Contact"));
        CheckAddress(
          ShippingAgent,0,"Ship-to Address","Ship-to Address 2","Ship-to City",
          "Ship-to ZIP Code","Ship-to State","Ship-to Country Code",
          FIELDCAPTION("Ship-to Address"),FIELDCAPTION("Ship-to Address 2"),
          FIELDCAPTION("Ship-to City"),FIELDCAPTION("Ship-to ZIP Code"),
          FIELDCAPTION("Ship-to State"),FIELDCAPTION("Ship-to Country Code"));

        TestWEBAPI(ShippingAgentAccount);

        TransactionID := GetTransactionID;
        "Closed by Packing Station Code" := PackingStation.Code;
        ClearTotalValueFields;
        VALIDATE("Calculation Weight",GetWeight);
        TESTFIELD("Calculation Weight");
        GetCalculationFields(1,'>');
        TESTFIELD("Calculation Value");

        CASE ShippingAgentAccount."Export Declare Value As" OF
          ShippingAgentAccount."Export Declare Value As"::Cost:
            BEGIN
              FedExOptionPage."Export Declared Value" := TotalValueCost;
              FedExOptionPage."Export Declare Value" := TRUE;
              FedExOptionPage.MODIFY;
            END;
          ShippingAgentAccount."Export Declare Value As"::Price:
            BEGIN
              FedExOptionPage."Export Declared Value" := TotalValuePrice;
              FedExOptionPage."Export Declare Value" := TRUE;
              FedExOptionPage.MODIFY;
            END;
        END;
        CarrierPackingStation.TESTFIELD("FedEx Label Printer Type");
        CarrierPackingStation.TESTFIELD("FedEx Label Media Type");
        FedExShipment.INIT;
        FedExShipment."International Shipment" := "World Wide Service";
        FedExShipment."Transaction Type" := 21;
        FedExShipment."Transaction ID" := TransactionID;

        IF ShippingAgentService."Transport Method Type" =
           ShippingAgentService."Transport Method Type"::Ground
        THEN
          FedExShipment.Carrier := FedExShipment.Carrier::"FedEx Ground";

        // Destination
        ShipToPhone := FixPhoneNo("Ship-to Phone No.");
        FedExShipment."Destination Company Name" := "Ship-to Name";
        FedExShipment."Destination Contact Name" := "Ship-to Contact";
        FedExShipment."Destination Address 1" := "Ship-to Address";
        FedExShipment."Destination Address 2" := "Ship-to Address 2";
        FedExShipment."Destination City" := "Ship-to City";
        FedExShipment."Destination State" := FixState("Ship-to State");
        FedExShipment."Destination Zip Code" := FixZIPCode("Ship-to ZIP Code");
        IF "Ship-to Phone No." = '' THEN
          "Ship-to Phone No." := FixPhoneNo(PackingStation."Phone No. to use If Blank");
        TESTFIELD("Ship-to Phone No.");
        FedExShipment."Destination Phone Number" := FixPhoneNo("Ship-to Phone No.");
        FedExShipment.Currency := "Currency Code";
        FedExShipment."Destination Country Code" := GetFedExCountryCode("Ship-to Country Code");

        // Special Service - Ship Alert
        IF FedExShipment.Currency = '' THEN
          FedExShipment.Currency := 'USD';
        IF FedExOptionPage."Ship Notification" THEN BEGIN
          FedExShipment."Ship Alert" := TRUE;
          FedExShipment."Ship Alert Message" := COPYSTR(FedExOptionPage."Ship Notification Memo",1,120);
          IF FedExOptionPage."Ship Notification Email" = '' THEN BEGIN
            FedExOptionPage.TESTFIELD("Ship Notification Fax No.");
            FedExShipment."Ship Alert Fax No." := FedExOptionPage."Ship Notification Fax No.";
          END ELSE
            FedExShipment."Ship Alert Email Address 1" := FedExOptionPage."Ship Notification Email";
        END;

        IF "Shipping Payment Type" <> "Shipping Payment Type"::Prepaid THEN BEGIN
          IF (ShippingAgentService."Transport Method Type" =
              ShippingAgentService."Transport Method Type"::Air) OR
             ("Shipping Payment Type" = "Shipping Payment Type"::"Third Party")
          THEN
            TESTFIELD("Third Party Ship. Account No.");
          FedExShipment."Payor Account Number" := "Third Party Ship. Account No.";
          IF "World Wide Service" THEN BEGIN
            FedExOptionPage.TESTFIELD("IRS EIN Number");
            FedExShipment."Destination IRS EIN Number" := FedExOptionPage."IRS EIN Number";
          END;
        END ELSE BEGIN
          TESTFIELD("Shipping Agent Account No.");
          FedExShipment."Payor Account Number" := "Shipping Agent Account No.";
          FedExShipment."Payer Country Code" := GetFedExCountryCode('');
        END;

        IF "Packing Date" = 0D THEN
          "Packing Date" := WORKDATE;
        FedExShipment."Shipment Date - Integer" := Date2Integer("Packing Date");
        EVALUATE(FedExShipment."Ship Time - Integer",Time2Text(TIME));

        CASE "Shipping Payment Type" OF
          "Shipping Payment Type"::"Third Party":
            BEGIN
              FedExShipment."Payment Code" := '3';
              FedExShipment."Payer Country Code" := GetFedExCountryCode('');
            END;
          "Shipping Payment Type"::"Freight Collect":
            BEGIN
              TESTFIELD("Third Party Ship. Account No.");
              FedExShipment."Payor Account Number" := "Third Party Ship. Account No.";
              IF FedExShipment.Carrier = FedExShipment.Carrier::"FedEx Express" THEN
                FedExShipment."Payment Code" := '2'
              ELSE
                FedExShipment."Payment Code" := '5';
            END;
          "Shipping Payment Type"::Consignee:
            BEGIN
              IF FedExShipment.Carrier = FedExShipment.Carrier::"FedEx Express" THEN BEGIN
                TESTFIELD("Third Party Ship. Account No.");
                FedExShipment."Payor Account Number" := "Third Party Ship. Account No.";
              END;
              FedExShipment."Payment Code" := '2';
            END;
          ELSE
            FedExShipment."Payment Code" := '1';
        END;
        IF COD THEN
          FedExShipment."Payment Code" := '1';

        IF ShippingAgentService."Transport Method Type" =
           ShippingAgentService."Transport Method Type"::Ground
        THEN BEGIN
          IF NOT Miscellaneous THEN BEGIN
            FedExShipment."Ground Customer Reference No." := "Source ID";
            FedExShipment."Ground Purchase Order No." := "External Document No.";
          END ELSE BEGIN
            FedExShipment."Ground Customer Reference No." := Description;
            FedExShipment."Ground Purchase Order No." := "External Document No.";
          END;
        END ELSE
          IF NOT Miscellaneous THEN
            FedExShipment."Reference Notes" := Text048 + "Source ID"
          ELSE
            FedExShipment."Reference Notes" := Text049 + "No.";

        IF ShippingSetup."Default Weight Units" =
           ShippingSetup."Default Weight Units"::LBS
        THEN
          FedExShipment."Weight Units" := 'LBS'
        ELSE
          FedExShipment."Weight Units" := 'KGS';

        // RGN commented out because FEDEX doesn't support this yet.
        // IF "Total Packages" > 1 THEN BEGIN
        //   FedExShipment."Package Sequence" := "Package No.";
        //   FedExShipment."Package Count" := "Total Packages";
        // END ELSE BEGIN
        FedExShipment."Package Sequence" := 1;
        FedExShipment."Package Count" := 1;
        // END;
        FedExShipment."Service Code" := "Service Indicator";
        FedExShipment."Package Weight" := ROUND("Calculation Weight",0.1);
        FedExShipment."Total Customs Value" := ROUND(FedExOptionPage."Export Declared Value",0.01);
        FedExShipment."Declared Value" := ROUND("Calculation Insured Value",0.01);
        IF COD THEN BEGIN
          CompanyInfo.GET;
          CompanyInfo.TESTFIELD("COD Phone No.");
          CompanyInfo.TESTFIELD("COD Address 1");
          CompanyInfo.TESTFIELD("COD City");
          CompanyInfo.TESTFIELD("COD State");
          CompanyInfo.TESTFIELD("COD Zip Code");
          FedExShipment."COD Return Phone" := COPYSTR(FixPhoneNo(CompanyInfo."COD Phone No."),1,15);
          FedExShipment."COD Return Company" := COPYSTR(CompanyInfo.Name,1,35);
          FedExShipment."COD Return Department" := COPYSTR(CompanyInfo."COD Department",1,10);
          FedExShipment."COD Return Address 1" := CompanyInfo."COD Address 1";
          FedExShipment."COD Return Address 2" := CompanyInfo."COD Address 2";
          FedExShipment."COD Return City" := CompanyInfo."COD City";
          FedExShipment."COD Return State" := COPYSTR(FixState(CompanyInfo."COD State"),1,14);
          FedExShipment."COD Return Postal Code" := COPYSTR(FixZIPCode(CompanyInfo."COD Zip Code"),1,9);
          FedExShipment."COD Flag" := TRUE;
          TESTFIELD("COD Amount");
          IF "Add Shipping Charge to COD Amt" THEN BEGIN
            CODMarkup := 0;
            CASE ShippingAgentService."Markup Type" OF
              ShippingAgentService."Markup Type"::Amount:
                BEGIN
                  "COD Amount" :=
                    "COD Amount" + ShippingAgentService."Additional Markup" +
                    "Additional Shipping Charge";
                  CODMarkup := ShippingAgentService."Additional Markup";
                END;
              ShippingAgentService."Markup Type"::Percent:
                BEGIN
                  GetShippingCharge(CurrentPackage,FALSE);
                  "COD Amount" := "COD Amount" + Markup + "Additional Shipping Charge";
                  CODMarkup := Markup;
                END;
              ELSE
                "COD Amount" := "COD Amount" + "Additional Shipping Charge";
            END;
          END;
          FedExShipment."COD Amount" := "COD Amount";
          IF "COD Cashiers Check" THEN
            FedExShipment."COD Collection Type" := '2'
          ELSE
            FedExShipment."COD Collection Type" := '1';
          FedExShipment."Add Freight Charges" := "Add Shipping Charge to COD Amt";
        END;

        IF "Packing Date" > TODAY THEN
          FedExShipment."Future Day Ship" := TRUE;

        FedExShipment."Label Type" := '1'; // Standard Label
        CASE CarrierPackingStation."FedEx Label Printer Type" OF
          CarrierPackingStation."FedEx Label Printer Type"::"1":
            BEGIN
              FedExShipment."Label Printer Type" := '1';
              TextLabel := FALSE;
            END;
          CarrierPackingStation."FedEx Label Printer Type"::"Eltron (EPL)":
            BEGIN
              FedExShipment."Label Printer Type" := '2';
              TextLabel := TRUE;
            END;
          CarrierPackingStation."FedEx Label Printer Type"::"3":
            BEGIN
              FedExShipment."Label Printer Type" := '3';
              TextLabel := TRUE;
            END;
        END;
        IF TextLabel THEN BEGIN
          CASE CarrierPackingStation."FedEx Label Media Type" OF
            CarrierPackingStation."FedEx Label Media Type"::"4X6 with Trailing Doc Tab":
              FedExShipment."Label Media Type" := '3';
            CarrierPackingStation."FedEx Label Media Type"::"4X6 W/O Doc Tab":
              FedExShipment."Label Media Type" := '4';
          END;
        END ELSE BEGIN
          IF ShippingAgentService."Transport Method Type" =
             ShippingAgentService."Transport Method Type"::Ground
          THEN
            FedExShipment."Label Media Type" := '5'
          ELSE
            FedExShipment."Label Media Type" := '1';
        END;

        IF "World Wide Service" THEN BEGIN
          SetCustomeFields(FedExShipment,CurrentPackage);

          ShippingAgentAccount.TESTFIELD("IRS EIN No.");
          FedExShipment."Shipper IRS EIN No." := ShippingAgentAccount."IRS EIN No.";
        END;

        FedExShipment."Shipping Agent Code" := "Shipping Agent Code";
        FedExShipment."Source ID" := "Source ID";
        FedExShipment."Package No." := "No.";
        FedExShipment."Package Length" := "Calculation Length";
        FedExShipment."Package Width" := "Calculation Width";
        FedExShipment."Package Height" := "Calculation Height";

        TransferFromOptionPage(
          FedExShipment,FedExOptionPage,ShippingAgentService,"Residential Delivery");

        FedExShipment.INSERT;

        ErrorMessage := ShipPackage(FedExShipment,TransactionID,CurrentPackage);
        IF ErrorMessage <> '' THEN
          ERROR(ErrorMessage);
        FedExShipment2.GET(121,TransactionID);
        "External Tracking No." := FedExShipment2."Master Tracking No.";
        "Dimensional Weight" := FedExShipment2."Dim Weight";
        "Shipping Cost" := FedExShipment2."Net Charge";
        "Base Charge" := FedExShipment2."Base Charge";
        Surcharge := FedExShipment2."Total Surcharge";
        "Rebate Amount" := FedExShipment2."Total Rebate Amount";
        "Discount Amount" := FedExShipment2."Total Discount";
        IF NOT Closed THEN BEGIN
          Markup :=
            Shipping.GetMarkup(
              ShippingAgentService,"Shipping Cost","Ship-to Type","Ship-to No.","Ship-to Code");
          IF COD AND "Add Shipping Charge to COD Amt" THEN BEGIN
            Markup := CODMarkup;
            "COD Amount" := "COD Amount" + "Shipping Cost";
          END;
          IF "Override Shipping Charge" <> 0 THEN
            "Shipping Charge" := "Override Shipping Charge"
          ELSE
            "Shipping Charge" := "Shipping Cost" + Markup + "Additional Shipping Charge";
        END;
        TestAndTransferToThirdParty(CurrentPackage,FedExOptionPage,ShippingAgentService);

        "Expected Delivery Date" := 0D;
        "FedEx Transaction ID" := TransactionID;
        "Packing Date" := WORKDATE;
        "Packing Time" := TIME;
        "Packed By" := USERID;
        Closed := TRUE;
        MODIFY;
        COMMIT;

        IF "Multi Document Package" THEN BEGIN
          GetShippingSetup;
          GetPackingStation;
          MultiDocPackageMgt.SplitMultiDocPackage(
            CurrentPackage,MultiDocPackageTmp,PackingStation,ShippingSetup);
          COMMIT;
        END;

        TextPos := STRPOS(UPPERCASE(FedExShipment2."Gif Label File Name"),'.GIF');
        IF TextPos = 0 THEN
          TextPos := STRPOS(UPPERCASE(FedExShipment2."Gif Label File Name"),'.PNG');
        IF TextPos = 0 THEN
          TextPos := STRPOS(UPPERCASE(FedExShipment2."Gif Label File Name"),'.TXT');
        IF TextPos < 2 THEN
          ERROR(Text050);
        BaseFileName := COPYSTR(FedExShipment2."Gif Label File Name",1,TextPos - 1);
      {
        CASE TRUE OF
          TextLabel: // (TXT-file)
            BEGIN
              CarrierPackingStation.TESTFIELD("FedEx Label Printer Port");

              TempBoolean := FALSE;
              FedEx.CreateGIFLabel(
                FedExShipment2."Buffer File Name",
                FedExShipment2."Gif Label File Name",TempBoolean);
              ReformatTextLabel(CurrentPackage,FedExShipment2."Gif Label File Name",FALSE);

              InsertLabelFile(
                FedExShipment2."Gif Label File Name",Text051,12,
                CarrierPackingStation."FedEx Label Printer Port",PackingStation.Code,
                NOT PackingStation."No Label Printer",PackingStation."Do Not Import Label File");

              IF PrintLabel THEN
                PackingStation.PrintLabelFile(
                  FedExShipment2."Gif Label File Name",CarrierPackingStation."FedEx Label Printer Port",
                  PackingStation."No Label Printer",PackingStation."Auto Delete Label Buffer File");

              IF COD THEN BEGIN
                TempFileName := BaseFileName + 'COD.txt';
                TempBoolean := FALSE;
                FedEx.CreateCODGIFLabel(FedExShipment2."Buffer File Name",TempFileName,TempBoolean);
                ReformatTextLabel(CurrentPackage,TempFileName,TRUE);

                IF EXISTS(TempFileName) THEN BEGIN
                  InsertLabelFile(
                    TempFileName,Text052,12,
                    CarrierPackingStation."FedEx Label Printer Port",PackingStation.Code,
                    NOT PackingStation."No Label Printer",PackingStation."Do Not Import Label File");

                  IF PrintLabel THEN
                    PackingStation.PrintLabelFile(
                      TempFileName,CarrierPackingStation."FedEx Label Printer Port",
                      PackingStation."No Label Printer",PackingStation."Auto Delete Label Buffer File");
                END;
              END;
            END;
          ShippingAgentService."Transport Method Type" =
          ShippingAgentService."Transport Method Type"::Ground: // (PNG-file)
            BEGIN
              CarrierPackingStation.TESTFIELD("FedEx Buffer Directory");

              TempBoolean := FALSE;
              FedEx.CreateGIFLabel(
                FedExShipment2."Buffer File Name",
                FedExShipment2."Gif Label File Name",TempBoolean);

              InsertLabelFile(
                FedExShipment2."Gif Label File Name",Text051,12,
                CarrierPackingStation."FedEx Label Printer Port",PackingStation.Code,PrintLabel,
                PackingStation."Do Not Import Label File");

              IF PrintLabel THEN BEGIN
                FedEx.LoadBuffer(FedExShipment2."Buffer File Name");
                FedEx.PrintBrowserLabel(CarrierPackingStation."FedEx Buffer Directory");
              END;

              IF COD THEN BEGIN
                TempFileName := BaseFileName + '.COD.png';
                TempBoolean := FALSE;
                FedEx.CreateCODGIFLabel(
                  FedExShipment2."Buffer File Name",TempFileName,TempBoolean);

                InsertLabelFile(
                  TempFileName,Text052,12,
                  CarrierPackingStation."FedEx Label Printer Port",PackingStation.Code,PrintLabel,
                  PackingStation."Do Not Import Label File");

                IF PrintLabel THEN BEGIN
                  // PM Code to print COD Ground

                END;
              END;
            END;
          ELSE  // Laser Printer and Transport Method Type = Air (GIF-file)
            BEGIN
              TempBoolean := FALSE;
              FedEx.CreateGIFLabel(
                FedExShipment2."Buffer File Name",
                FedExShipment2."Gif Label File Name",TempBoolean);

              InsertLabelFile(
                FedExShipment2."Gif Label File Name",Text051,12,
                CarrierPackingStation."FedEx Label Printer Port",PackingStation.Code,PrintLabel,
                PackingStation."Do Not Import Label File");

              IF PrintLabel THEN BEGIN
                FedEx.PrintGif(FedExShipment2."Gif Label File Name");
                IF "World Wide Service" THEN BEGIN
                  FedEx.PrintGif(FedExShipment2."Gif Label File Name");
                  FedEx.PrintGif(FedExShipment2."Gif Label File Name");
                END;
              END;

              IF COD THEN BEGIN
                TempFileName := BaseFileName + '.COD.gif';

                FedEx.CreateCODGIFLabel(
                  FedExShipment2."Buffer File Name",TempFileName,PrintLabel);

                IF EXISTS(TempFileName) THEN
                  InsertLabelFile(
                  TempFileName,Text052,12,
                    CarrierPackingStation."FedEx Label Printer Port",PackingStation.Code,PrintLabel,
                    PackingStation."Do Not Import Label File");
              END;
            END;
        END;}
      END;
    END;

    PROCEDURE OpenPackage@16(VAR CurrentPackage@1000000000 : Record 14000701);
    VAR
      FedExShipment@1000000001 : Record 14000783;
      FedExDeletePackage@1000000003 : Record 14000787;
      TransactionID@1000000004 : Code[40];
    BEGIN
      WITH CurrentPackage DO BEGIN
        TESTFIELD(Closed);
        TESTFIELD("Manifest No.",'');

        IF "Manual Shipment" THEN BEGIN
          Closed := FALSE;
          MODIFY;
          COMMIT;

          EXIT;
        END;

        GetPackingStation;
        CarrierPackingStation.GetPackingStation(PackingStation);
        CarrierPackingStation.TESTFIELD("FedEx Shipping Agent Acc. No.");
        ShippingAgentAccount.GET(CarrierPackingStation."FedEx Shipping Agent Acc. No.");

        TestWEBAPI(ShippingAgentAccount);

        TransactionID := GetTransactionID;
        GetPackingStation;
        FedExDeletePackage.INIT;
        FedExShipment.GET(121,"FedEx Transaction ID");
        FedExDeletePackage.TRANSFERFIELDS(FedExShipment);
        FedExDeletePackage."Transaction Type" := 23;
        FedExDeletePackage."Transaction ID" := TransactionID;
        FedExDeletePackage.INSERT;
        IF DeleteRequest(FedExDeletePackage) <> '0' THEN
          ERROR(FedExDeletePackage."Error Message");

        GET("No.");

        IF COD AND "Add Shipping Charge to COD Amt" THEN
          "COD Amount" := "COD Amount" - "Shipping Charge";
        "External Tracking No." := '';
        "FedEx Transaction ID" := '';
        Closed := FALSE;
        MODIFY;
        COMMIT;
      END;
    END;

    PROCEDURE ReOpenPostedPackage@50(VAR CurrentPostedPackage@1000000000 : Record 14000704);
    VAR
      FedExShipment@1000000001 : Record 14000783;
      FedExDeletePackage@1000000003 : Record 14000787;
      TransactionID@1000000004 : Code[40];
    BEGIN
      WITH CurrentPostedPackage DO BEGIN
        TESTFIELD(Closed);
        TESTFIELD("Manifest No.",'');

        IF "Manual Shipment" THEN BEGIN
          Closed := FALSE;
          MODIFY;
          COMMIT;

          EXIT;
        END;

        GetPackingStation;
        CarrierPackingStation.GetPackingStation(PackingStation);
        CarrierPackingStation.TESTFIELD("FedEx Shipping Agent Acc. No.");
        ShippingAgentAccount.GET(CarrierPackingStation."FedEx Shipping Agent Acc. No.");
        TestWEBAPI(ShippingAgentAccount);

        TransactionID := GetTransactionID;
        GetPackingStation;
        FedExDeletePackage.INIT;
        FedExShipment.GET(121,"FedEx Transaction ID");
        FedExDeletePackage.TRANSFERFIELDS(FedExShipment);
        FedExDeletePackage."Transaction Type" := 23;
        FedExDeletePackage."Transaction ID" := TransactionID;
        FedExDeletePackage.INSERT;
        IF DeleteRequest(FedExDeletePackage) <> '0' THEN
          ERROR(FedExDeletePackage."Error Message");

        GET("No.");

        IF COD AND "Add Shipping Charge to COD Amt" THEN
          "COD Amount" := "COD Amount" - "Shipping Charge";
        "External Tracking No." := '';
        "FedEx Transaction ID" := '';
        Closed := FALSE;
        MODIFY;
        COMMIT;
      END;
    END;

    PROCEDURE PrintPackageLabel@20(VAR CurrentPackage@1000000000 : Record 14000701);
    VAR
      FedExOptionPage@1000000001 : Record 14000781;
      FedExShipment@1000000002 : Record 14000783;
      TextPos@1000000003 : Integer;
      TempGifName@1000000004 : Text[250];
      Answer@1000000005 : Integer;
      GifFileName@1000000006 : Text[250];
    BEGIN
      WITH CurrentPackage DO BEGIN
        IF "Manual Shipment" THEN
          EXIT;

        TESTFIELD(Closed);

        GetPackingStation;
        CarrierPackingStation.GetPackingStation(PackingStation);
        GetShippingAgentService("Shipping Agent Code","Shipping Agent Service","World Wide Service");
        FedExOptionPage.GET(FedExOptionPage.Type::Package,"No.",0,0);
      {
        FedExShipment.GET(121,"FedEx Transaction ID");
        IF (CarrierPackingStation."FedEx Label Printer Type" =
            CarrierPackingStation."FedEx Label Printer Type"::"1") AND
           (ShippingAgentService."Transport Method Type" =
            ShippingAgentService."Transport Method Type"::Ground)
        THEN BEGIN
          FedEx.LoadBuffer(FedExShipment."Buffer File Name");
          Window.OPEN(Text001);
          Answer := FedEx.PrintBrowserLabel(CarrierPackingStation."FedEx Buffer Directory");
          Window.CLOSE;
        END ELSE BEGIN
          IF FedExShipment."Gif Label File Name" <> '' THEN BEGIN
            IF CarrierPackingStation."FedEx Label Printer Type" =
               CarrierPackingStation."FedEx Label Printer Type"::"1"
            THEN BEGIN
              FedEx.PrintGif(FedExShipment."Gif Label File Name");
              IF "World Wide Service" THEN BEGIN
                FedEx.PrintGif(FedExShipment."Gif Label File Name");
                FedEx.PrintGif(FedExShipment."Gif Label File Name");
              END;
            END ELSE BEGIN
              ReformatTextLabel(CurrentPackage,FedExShipment."Gif Label File Name",FALSE);
              CarrierPackingStation.TESTFIELD("FedEx Label Printer Port");
              InsertLabelFile(
                FedExShipment."Gif Label File Name",Text051,12,
                CarrierPackingStation."FedEx Label Printer Port",PackingStation.Code,
                NOT PackingStation."No Label Printer",PackingStation."Do Not Import Label File");
              PackingStation.PrintLabelFile(
                FedExShipment."Gif Label File Name",CarrierPackingStation."FedEx Label Printer Port",
                PackingStation."No Label Printer",PackingStation."Auto Delete Label Buffer File");
            END;
            IF COD THEN BEGIN
              TempGifName := FedExShipment."Gif Label File Name";
              TextPos := STRPOS(TempGifName,'.');
              GifFileName := COPYSTR(TempGifName,1,TextPos - 1) + 'COD' +
                COPYSTR(TempGifName,TextPos,STRLEN(TempGifName));
              IF CarrierPackingStation."FedEx Label Printer Type" =
                 CarrierPackingStation."FedEx Label Printer Type"::"1"
              THEN
                FedEx.PrintGif(GifFileName)
              ELSE BEGIN
                ReformatTextLabel(CurrentPackage,GifFileName,TRUE);
                CarrierPackingStation.TESTFIELD("FedEx Label Printer Port");
                IF EXISTS(GifFileName) THEN BEGIN
                  InsertLabelFile(
                    GifFileName,Text052,12,
                    CarrierPackingStation."FedEx Label Printer Port",PackingStation.Code,
                    NOT PackingStation."No Label Printer",PackingStation."Do Not Import Label File");
                  PackingStation.PrintLabelFile(
                    GifFileName,CarrierPackingStation."FedEx Label Printer Port",
                    PackingStation."No Label Printer",PackingStation."Auto Delete Label Buffer File");
                END;
              END;
            END;
          END ELSE
            ERROR(Text053);
        END;}
      END;
    END;

    PROCEDURE RePrintPostedPackageLabel@21(VAR CurrentPostedPackage@1000000000 : Record 14000704);
    VAR
      FedExShipment@1000000001 : Record 14000783;
      FedExPostedOptionPage@1000000002 : Record 14000782;
      CurrentPackage@1000000003 : Record 14000701;
      TextPos@1000000004 : Integer;
      TempGifName@1000000005 : Text[250];
      Answer@1000000007 : Integer;
      GifFileName@1000000008 : Text[250];
    BEGIN
      WITH CurrentPostedPackage DO BEGIN
        IF "Manual Shipment" THEN
          EXIT;

        GetPackingStation;
        CarrierPackingStation.GetPackingStation(PackingStation);
        GetShippingAgentService("Shipping Agent Code","Shipping Agent Service","World Wide Service");
        FedExPostedOptionPage.GET(CurrentPostedPackage."No.");
      {
        FedExShipment.GET(121,"FedEx Transaction ID");
        IF (CarrierPackingStation."FedEx Label Printer Type" =
            CarrierPackingStation."FedEx Label Printer Type"::"1") AND
           (ShippingAgentService."Transport Method Type" =
            ShippingAgentService."Transport Method Type"::Ground)
        THEN BEGIN
          FedEx.LoadBuffer(FedExShipment."Buffer File Name");
          Window.OPEN(Text001);
          Answer := FedEx.PrintBrowserLabel(CarrierPackingStation."FedEx Buffer Directory");
          Window.CLOSE;
        END ELSE BEGIN
          IF FedExShipment."Gif Label File Name" <> '' THEN BEGIN
            IF CarrierPackingStation."FedEx Label Printer Type" =
               CarrierPackingStation."FedEx Label Printer Type"::"1"
            THEN BEGIN
              FedEx.PrintGif(FedExShipment."Gif Label File Name");
              IF "World Wide Service" THEN BEGIN
                FedEx.PrintGif(FedExShipment."Gif Label File Name");
                FedEx.PrintGif(FedExShipment."Gif Label File Name");
              END;
            END ELSE BEGIN
                CurrentPackage.TRANSFERFIELDS(CurrentPostedPackage);
                ReformatTextLabel(CurrentPackage,FedExShipment."Gif Label File Name",FALSE);
                CarrierPackingStation.TESTFIELD("FedEx Label Printer Port");
                InsertLabelFile(
                  FedExShipment."Gif Label File Name",Text051,12,
                  CarrierPackingStation."FedEx Label Printer Port",PackingStation.Code,
                  NOT PackingStation."No Label Printer",PackingStation."Do Not Import Label File");
                PackingStation.PrintLabelFile(
                  FedExShipment."Gif Label File Name",CarrierPackingStation."FedEx Label Printer Port",
                  PackingStation."No Label Printer",PackingStation."Auto Delete Label Buffer File");
            END;
            IF COD THEN BEGIN
              TempGifName := FedExShipment."Gif Label File Name";
              TextPos := STRPOS(TempGifName,'.');
              GifFileName := COPYSTR(TempGifName,1,TextPos - 1) + 'COD' +
                COPYSTR(TempGifName,TextPos,STRLEN(TempGifName));
              IF CarrierPackingStation."FedEx Label Printer Type" =
                 CarrierPackingStation."FedEx Label Printer Type"::"1"
              THEN
                FedEx.PrintGif(GifFileName)
              ELSE BEGIN
                CurrentPackage.TRANSFERFIELDS(CurrentPostedPackage);
                ReformatTextLabel(CurrentPackage,GifFileName,TRUE);
                CarrierPackingStation.TESTFIELD("FedEx Label Printer Port");
                IF EXISTS(GifFileName) THEN BEGIN
                  InsertLabelFile(
                    GifFileName,Text052,12,
                    CarrierPackingStation."FedEx Label Printer Port",PackingStation.Code,
                    NOT PackingStation."No Label Printer",PackingStation."Do Not Import Label File");
                  PackingStation.PrintLabelFile(
                    GifFileName,CarrierPackingStation."FedEx Label Printer Port",
                    PackingStation."No Label Printer",PackingStation."Auto Delete Label Buffer File");
                END;
              END;
            END;
          END ELSE
            ERROR(Text053);
        END;}
      END;
    END;

    LOCAL PROCEDURE PrintInternationalShipTerms@26();
    BEGIN
      //FedEx.PrintTerms;
    END;

    LOCAL PROCEDURE GetGlobalShipperInfo@30();
    BEGIN
      GetPackingStation;
      CarrierPackingStation.GetPackingStation(PackingStation);
      {
      IF CarrierPackingStation."FedEx Global Registration No." <> '' THEN BEGIN
        FedExGlobalRegistration.GET(211,CarrierPackingStation."FedEx Global Registration No.");
        FedEx.propMeterNo(FedExGlobalRegistration."Meter Number");
        FedEx.propSenderFedExAccountNo(FedExGlobalRegistration."Shipper Account No.");
        FedEx.propSenderContactName(FedExGlobalRegistration."Shipper Contact");
        FedEx.propSenderCompany(FedExGlobalRegistration."Shipper Company Name");
        FedEx.propSenderAddressLine1(FedExGlobalRegistration."Shipper Address 1");
        FedEx.propSenderAddressLine2(FedExGlobalRegistration."Shipper Address 2");
        FedEx.propSenderCity(FedExGlobalRegistration."Shipper City");
        FedEx.propSenderState(FixState(FedExGlobalRegistration."Shipper State"));
        FedEx.propSenderPostalCode(FixZIPCode(FedExGlobalRegistration."Shipper ZIP Code"));
        FedEx.propSenderPhoneNo(FixPhoneNo(FedExGlobalRegistration."Shipper Phone Number"));
        FedEx.propSenderCountryCode(FedExGlobalRegistration."Shipper Country Code");
        FedEx.propSenderFax(FixPhoneNo(FedExGlobalRegistration."Shipper FAX Number"));
      END ELSE
        ERROR(Text054);}
    END;

    LOCAL PROCEDURE GetSession@2(Profile@1000000001 : Integer;UseGroundOCX@1000000002 : Boolean) Handle@1000000000 : Integer;
    BEGIN
      GetPackingStation;
      CarrierPackingStation.GetPackingStation(PackingStation);
      CarrierPackingStation.TESTFIELD("Proxy Address");
      CarrierPackingStation.TESTFIELD("Proxy Port");
      CarrierPackingStation.TESTFIELD("FedEx Global Registration No.");
      {
      FedExGlobalRegistration.GET(211,CarrierPackingStation."FedEx Global Registration No.");
      IF UseGroundOCX THEN BEGIN
        FedExGround.InitProperties;
        FedExGround.WebInit;
        Handle :=
          FedExGround.WebBeginSession(
            CarrierPackingStation."Proxy Address",CarrierPackingStation."Proxy Port",
            FedExGlobalRegistration."Shipper Account No.",
            FedExGlobalRegistration."Meter Number",Profile);
      END ELSE BEGIN
        CLEAR(FedEx);
        FedEx.InitProperties;
        FedEx.WebInit;
        Handle :=
          FedEx.WebBeginSession(
            CarrierPackingStation."Proxy Address",CarrierPackingStation."Proxy Port",
            FedExGlobalRegistration."Shipper Account No.",
            FedExGlobalRegistration."Meter Number",Profile);
      END;}

      IF Handle < 0 THEN
        ERROR(Text055,Handle);
    END;

    LOCAL PROCEDURE EndSession@31(Handle@1000000000 : Integer;UseGroundOCX@1000000001 : Boolean);
    VAR
      Answer@1000000002 : Integer;
    BEGIN
      Window.OPEN(Text001);
      {IF UseGroundOCX THEN
        Answer := FedExGround.WebEndSession(Handle)
      ELSE
        Answer := FedEx.WebEndSession(Handle);
      Window.CLOSE;
      TestConnectionError(Answer);
      Window.OPEN(Text001);
      IF UseGroundOCX THEN
        Answer := FedExGround.WebRelease
      ELSE
        Answer := FedEx.WebRelease;}
      Window.CLOSE;
    END;

    LOCAL PROCEDURE UpdateSubscriptionService@32(VAR CurrentFedExGlobalRegistration@1000000000 : Record 14000786);
    VAR
      SessionHandle@1000000001 : Integer;
    BEGIN
      WITH CurrentFedExGlobalRegistration DO BEGIN
        SessionHandle := GetSession(1,FALSE);
      {  "Subscription Service 1" := FedEx.propSubscriptionServiceName(1);
        "Subscription Service 2" := FedEx.propSubscriptionServiceName(2);}
        MESSAGE(
          Text056 +
          Text057,
          "Subscription Service 1","Subscription Service 2");
        EndSession(SessionHandle,FALSE);
        MODIFY;
      END;
    END;

    PROCEDURE CreateManifest@49(CurrentShippingAgentAccount@1000000000 : Record 14000788);
    VAR
      ManifestHeader@1000000001 : Record 14000712;
    BEGIN
      WITH CurrentShippingAgentAccount DO BEGIN
        ShippingAgent.RESET;
        ShippingAgent.SETRANGE("Shipper Type",ShippingAgent."Shipper Type"::FEDEX);
        ShippingAgent.FIND('-');

        CLEAR(ManifestHeader);
        ManifestHeader.INSERT(TRUE);
        ManifestHeader."Shipping Agent Code" := ShippingAgent.Code;
        ManifestHeader."Shipping Agent Account" := "Account No.";
        ManifestHeader.MODIFY(TRUE);

        ManifestHeader.GetSuggestedLines;

        COMMIT;

      //  PAGE.RUNMODAL(PAGE::Manifest,ManifestHeader);
      END;
    END;

    PROCEDURE CloseManifest@47(VAR CurrentManifestHeader@1000000000 : Record 14000712);
    VAR
      ManifestLine@1000000001 : Record 14000713;
      FedExShippingAgentAccountTmp@1000000002 : TEMPORARY Record 14000788;
      AccountsManifested@1000000003 : Integer;
    BEGIN
      WITH CurrentManifestHeader DO BEGIN
        TESTFIELD(Posted);
        TESTFIELD("FedEx Processing Required");

        FedExShippingAgentAccountTmp.DELETEALL;

        ManifestLine.RESET;
        ManifestLine.SETRANGE("Manifest No.","No.");
        ManifestLine.SETRANGE(Type,ManifestLine.Type::Summary);
        IF ManifestLine.FIND('-') THEN
          REPEAT
            IF NOT FedExShippingAgentAccountTmp.GET(ManifestLine."Shipping Agent Account No.") THEN
              IF ShippingAgentAccount.GET(ManifestLine."Shipping Agent Account No.") THEN BEGIN
                FedExShippingAgentAccountTmp := ShippingAgentAccount;
                FedExShippingAgentAccountTmp.INSERT;

                TestWEBAPI(ShippingAgentAccount);
              END;
          UNTIL ManifestLine.NEXT = 0;

        AccountsManifested := 0;
        IF FedExShippingAgentAccountTmp.FIND('-') THEN BEGIN
          ManifestLine.RESET;
          ManifestLine.SETRANGE("Manifest No.","No.");
          IF NOT ManifestLine.FIND('+') THEN
            ManifestLine."Manifest No." := "No.";

          REPEAT
            AccountsManifested := AccountsManifested + 1;

            ManifestLine.INIT;
            ManifestLine."Line No." := ManifestLine."Line No." + 10000;
            ManifestLine.Type := ManifestLine.Type::"FedEx Summary";
            ManifestLine.Description :=
              STRSUBSTNO(Text058,FedExShippingAgentAccountTmp."Account No.");

            ManifestLine.SummarizeAccount(FedExShippingAgentAccountTmp."Account No.");

            ManifestLine."Shipping Agent Account No." := FedExShippingAgentAccountTmp."Account No.";
            ManifestLine."FedEx Manifest File No." :=
              CreateOnlineManifest(CurrentManifestHeader,FedExShippingAgentAccountTmp,FALSE);
            ManifestLine.INSERT;
          UNTIL FedExShippingAgentAccountTmp.NEXT = 0;
        END;

        IF AccountsManifested <> 0 THEN
          MESSAGE(Text059,AccountsManifested);

        LOCKTABLE;
        FIND;
        "FedEx Processing Required" := FALSE;
        MODIFY;
        COMMIT;
      END;
    END;

    PROCEDURE OpenManifest@48(VAR CurrentManifestHeader@1000000000 : Record 14000712);
    BEGIN
      WITH CurrentManifestHeader DO BEGIN
        TESTFIELD(Posted,FALSE);
        TESTFIELD("FedEx Processing Required");

        LOCKTABLE;
        FIND;
        "FedEx Processing Required" := FALSE;
        MODIFY;
        COMMIT;
      END;
    END;

    LOCAL PROCEDURE CreateOnlineManifest@10(CurrentManifestHeader@1000000000 : Record 14000712;CurrentShippingAgentAccount@1000000001 : Record 14000788;ManifestOnly@1000000002 : Boolean) : Integer;
    VAR
      FedExManifest@1000000003 : Record 14000784;
      TransactionID@1000000004 : Code[40];
      Answer@1000000005 : Integer;
      SessionHandle@1000000006 : Integer;
      BufferPath@1000000007 : Text[250];
    BEGIN
      WITH CurrentShippingAgentAccount DO BEGIN
        SessionHandle := GetSession(0,TRUE);
        TransactionID := GetTransactionID;
      {  FedExGround.WebInit;
        FedExGround.InitProperties;
        GetGlobalShipperInfo;
        GetPackingStation;
        CarrierPackingStation.GetPackingStation(PackingStation);
        FedExManifest.INIT;
        FedExManifest."Manifest No." := CurrentManifestHeader."No.";
        FedExManifest."Transaction Type" := 107;
        FedExGround.propTransactionType('007');
        FedExManifest."Transaction ID" := TransactionID;
        FedExGround.propTransactionID(TransactionID);
        FedExManifest."Shipper Account" := "Account No.";
        FedExGround.propSenderFedExAccountNo("Account No.");
        FedExManifest."Meter Number" := FedExGlobalRegistration."Meter Number";
        FedExGround.propMeterNo(FedExManifest."Meter Number");
        FedExManifest.Carrier := FedExManifest.Carrier::"FedEx Ground";
        FedExGround.propCarrierCode('FDXG');
        FedExManifest."Manifest Date - Integer" := Date2Integer(WORKDATE);
        FedExGround.propManifestDate(Integer2Text(FedExManifest."Manifest Date - Integer"));
        EVALUATE(FedExManifest."Manifest Time - Integer",Time2Text(TIME));
        FedExGround.propManifestTime(Time2Text(TIME));
        FedExManifest."Manifest Only" := ManifestOnly;
        IF ManifestOnly THEN
          FedExGround.propManifestOnlyRequestFlag('Y');
        Window.OPEN(Text001);
        Answer := FedExGround.WebCloseShipment(SessionHandle);
        Window.CLOSE;
        FedExGround.SaveBuffer(BufferFileName);
        TestConnectionError(Answer);
        FedExManifest."Error Code" := FedExGround.propErrorCode;
        FedExManifest."Error Message" := FedExGround.propErrorMessage;
        IF FedExManifest."Error Code" <> '' THEN
          IF CheckErrorCode(FedExManifest."Error Code") <> '' THEN
            FedExManifest."Error Message" := CheckErrorCode(FedExManifest."Error Code");
        IF FedExGround.propManifestTotal <> '' THEN
          EVALUATE(FedExManifest."Manifest Total",FedExGround.propManifestTotal);
        FedExManifest."First Manifest Series Name" := FedExGround.GetPropManifestFileName(1) + '.txt';
        FedExManifest.INSERT;
        EndSession(SessionHandle,TRUE);
        BufferPath := CarrierPackingStation."FedEx Buffer Directory";
        IF BufferPath[STRLEN(BufferPath)] <> '\' THEN
          BufferPath := BufferPath + '\';
        FedExGround.CreateManifest(BufferPath);}
        CASE FedExManifest."Error Code" OF
          '0',' ':
            BEGIN
              MESSAGE(Text060,"Account No.");

              EXIT(
                CurrentManifestHeader.InsertLabelFile(
                  BufferPath + FedExManifest."First Manifest Series Name",
                  STRSUBSTNO(Text061,"Account No."),
                  12,'',PackingStation.Code,FALSE,PackingStation."Do Not Import Label File"));
            END;
          '9804':
            BEGIN
              MESSAGE(
                Text062,
                "Account No.",FedExManifest."Error Message");

              EXIT(0);
            END;
          ELSE
            ERROR(
              Text063,
              "Account No.",FedExManifest."Error Message");
        END;
      END;
    END;

    LOCAL PROCEDURE ReprintManifest@11(FedExManifest@1000000000 : Record 14000784);
    VAR
      BufferPath@1000000001 : Text[250];
    BEGIN
      WITH FedExManifest DO BEGIN
        GetPackingStation;
        BufferPath := CarrierPackingStation."FedEx Buffer Directory";
        IF BufferPath[STRLEN(BufferPath)] <> '\' THEN
          BufferPath := BufferPath + '\';
        BufferPath := BufferPath + "First Manifest Series Name";
        IF NOT EXISTS(BufferPath) THEN
          ERROR(Text064,BufferPath);
      //  FedExGround.ReprintManifest(BufferPath);
      END;
    END;

    LOCAL PROCEDURE CheckErrorCode@22(ErrorCode@1000000001 : Code[4]) FedExMessage@1000000000 : Text[150];
    BEGIN
      FedExMessage := '';
      CASE ErrorCode OF
        '1101':
          FedExMessage := Text065;
        '1102':
          FedExMessage := Text066;
        '1104':
          FedExMessage := Text067;
        '1106':
          FedExMessage := Text068;
        '1107':
          FedExMessage := Text069;
        '1108':
          FedExMessage := Text070;
        '1109':
          FedExMessage := Text071;
        '1200':
          FedExMessage := Text072;
        '1201':
          FedExMessage := Text073;
        '1202':
          FedExMessage := Text074;
        '1203':
          FedExMessage := Text075;
        '1204':
          FedExMessage := Text076;
        '1205':
          FedExMessage := Text077;
        '1206':
          FedExMessage := Text078;
        '1207':
          FedExMessage := Text079;
        '1208':
          FedExMessage := Text080;
        '1209':
          FedExMessage := Text081;
        '120A':
          FedExMessage := Text082;
        '120B':
          FedExMessage := Text083;
        '120C':
          FedExMessage := Text084;
        '120D':
          FedExMessage := Text085;
        '120E':
          FedExMessage :=
            Text086;
        '120F':
          FedExMessage := Text087;
        '1210':
          FedExMessage := Text088;
        '1211':
          FedExMessage := Text089;
        '1212':
          FedExMessage := Text090;
        '1213':
          FedExMessage := Text091;
        '1216':
          FedExMessage := Text092;
        '1217':
          FedExMessage := Text093;
        '1219':
          FedExMessage := Text094;
        '121A':
          FedExMessage := Text095;
        '121B':
          FedExMessage := Text096;
        '121C':
          FedExMessage := Text097;
        '121D':
          FedExMessage := Text098;
        '121E':
          FedExMessage := Text099;
        '121F':
          FedExMessage := Text100;
        '1220':
          FedExMessage := Text101;
        '1221':
          FedExMessage := Text102;
        '1222':
          FedExMessage := Text103;
        '1223':
          FedExMessage := Text104;
        '1224':
          FedExMessage := Text105;
        '1225':
          FedExMessage := Text106;
        '1226':
          FedExMessage := Text107;
        '1227':
          FedExMessage := Text108;
        '1228':
          FedExMessage := Text109;
        '1229':
          FedExMessage := Text110;
        '122A':
          FedExMessage := Text111;
        '122B':
          FedExMessage := Text112;
        '122C':
          FedExMessage := Text113;
        '122D':
          FedExMessage := Text114;
        '122F':
          FedExMessage := Text115;
        '1230':
          FedExMessage := Text116;
        '1231':
          FedExMessage := Text117;
        '1232':
          FedExMessage := Text118;
        '1233':
          FedExMessage := Text119;
        '1234':
          FedExMessage := Text120;
        '1235':
          FedExMessage := Text121;
        '1236':
          FedExMessage := Text122;
        '1237':
          FedExMessage := Text123;
        '1238':
          FedExMessage := Text124;
        '1239':
          FedExMessage := Text125;
        '123A':
          FedExMessage := Text126;
        '123B':
          FedExMessage := Text127;
        '123C':
          FedExMessage := Text128;
        '123D':
          FedExMessage := Text129;
        '123E':
          FedExMessage := Text130;
        '123F':
          FedExMessage := Text131;
        '1240':
          FedExMessage := Text132;
        '1241':
          FedExMessage := Text133;
        '1242':
          FedExMessage := Text134;
        '1243':
          FedExMessage := Text135;
        '1244':
          FedExMessage := Text136;
        '1245':
          FedExMessage := Text137;
        '1246':
          FedExMessage := Text138;
        '1247':
          FedExMessage := Text139;
        '1248':
          FedExMessage := Text140;
        '1249':
          FedExMessage := Text141;
        '124A':
          FedExMessage := Text142;
        '124B':
          FedExMessage := Text143;
        '124C':
          FedExMessage := Text144;
        '124D':
          FedExMessage := Text145;
        '124E':
          FedExMessage := Text146;
        '124F':
          FedExMessage := Text147;
        '1250':
          FedExMessage := Text148;
        '1251':
          FedExMessage := Text149;
        '1252':
          FedExMessage := Text150;
        '1253':
          FedExMessage := Text151;
        '1254':
          FedExMessage := Text152;
        '1255':
          FedExMessage := Text153;
        '1256':
          FedExMessage := Text154;
        '1300':
          FedExMessage := Text155;
        '1301':
          FedExMessage := Text156;
        '1302':
          FedExMessage := Text157;
        '1303':
          FedExMessage := Text158;
        '1311':
          FedExMessage := Text159;
        '1423':
          FedExMessage := Text160;
        '1450':
          FedExMessage := Text161;
        '1452':
          FedExMessage := Text162;
        '1555':
          FedExMessage := Text163;
        '1556':
          FedExMessage := Text164;
        '1700':
          FedExMessage := Text165;
        '1701':
          FedExMessage := Text166;
        '1702':
          FedExMessage := Text167;
        '1703':
          FedExMessage := Text168;
        '1704':
          FedExMessage := Text169;
        '1705':
          FedExMessage := Text170;
        '1706':
          FedExMessage := Text171;
        '1800':
          FedExMessage := Text172;
        '1801':
          FedExMessage := Text173;
        '1802':
          FedExMessage := Text174;
        '1803':
          FedExMessage := Text175;
        '1804':
          FedExMessage := Text176;
        '1806':
          FedExMessage := Text177;
        '1808':
          FedExMessage := Text178;
        '1F20':
          FedExMessage := Text179;
        '1F21':
          FedExMessage := Text180;
        '1F22':
          FedExMessage := Text181;
        '1F25':
          FedExMessage := Text182;
        '1F30':
          FedExMessage := Text183;
        '1F31':
          FedExMessage := Text184;
        '1F32':
          FedExMessage := Text185;
        '1F33':
          FedExMessage := Text186;
        '1F34':
          FedExMessage := Text187;
        '1F35':
          FedExMessage := Text188;
        '1F55':
          FedExMessage := Text189;
        '2504':
          FedExMessage := Text190;
        '2521':
          FedExMessage := Text191 +
          Text192;
        '4035':
          FedExMessage := Text193;
        '4036':
          FedExMessage := Text194;
        '4050':
          FedExMessage := Text195;
        '4051':
          FedExMessage := Text196;
        '4052':
          FedExMessage := Text197;
        '4053':
          FedExMessage := Text198;
        '4054':
          FedExMessage := Text199;
        '4055':
          FedExMessage := Text200;
        '4056':
          FedExMessage := Text201;
        '4057':
          FedExMessage := Text202;
        '4058':
          FedExMessage := Text203;
        '4059':
          FedExMessage := Text094;
        '4060':
          FedExMessage := Text204;
        '4061':
          FedExMessage := Text205;
        '4062':
          FedExMessage := Text206;
        '4063':
          FedExMessage := Text207;
        '4064':
          FedExMessage := Text208;
        '4065':
          FedExMessage := Text209;
        '4066':
          FedExMessage := Text209;
        '4067':
          FedExMessage := Text210;
        '4068':
          FedExMessage := Text211;
        '4069':
          FedExMessage := Text212;
        '4070':
          FedExMessage := Text213;
        '4071':
          FedExMessage := Text214;
        '4072':
          FedExMessage := Text215;
        '4073':
          FedExMessage := Text216;
        '4074':
          FedExMessage := Text217;
        '406A':
          FedExMessage := Text218;
        '406B':
          FedExMessage := Text219;
        '406C':
          FedExMessage := Text220;
        '5010':
          FedExMessage := Text221;
        '5011':
          FedExMessage := Text222;
        '5012':
          FedExMessage := Text223;
        '5013':
          FedExMessage := Text224;
        '5014':
          FedExMessage := Text225;
        '5015':
          FedExMessage := Text226;
        '5016':
          FedExMessage := Text227;
        '5017':
          FedExMessage := Text228;
        '5018':
          FedExMessage := Text229;
        '5019':
          FedExMessage := Text230;
        '5020':
          FedExMessage := Text231;
        '5021':
          FedExMessage := Text232;
        '5022':
          FedExMessage := Text216;
        '5023':
          FedExMessage := Text233;
        '5024':
          FedExMessage := Text234;
        '5025':
          FedExMessage := Text235;
        '5026':
          FedExMessage := Text236;
        '5027':
          FedExMessage := Text237;
        '5028':
          FedExMessage := Text238;
        '5029':
          FedExMessage := Text239;
        '5030':
          FedExMessage := Text240;
        '5031':
          FedExMessage := Text241;
        '5032':
          FedExMessage := Text242;
        '5033':
          FedExMessage := Text243;
        '5034':
          FedExMessage := Text244;
        '5035':
          FedExMessage := Text245;
        '5036':
          FedExMessage := Text246;
        '5037':
          FedExMessage := Text247;
        '5038':
          FedExMessage := Text248;
        '5039':
          FedExMessage := Text249;
        '5040':
          FedExMessage := Text250;
        '5041':
          FedExMessage := Text251;
        '5042':
          FedExMessage := Text252;
        '5043':
          FedExMessage := Text253;
        '5044':
          FedExMessage := Text254;
        '5045':
          FedExMessage := Text255;
        '5046':
          FedExMessage := Text256;
        '5047':
          FedExMessage := Text257;
        '5048':
          FedExMessage := Text258;
        '5049':
          FedExMessage := Text259;
        '6001':
          FedExMessage := Text260;
        '6002':
          FedExMessage := Text261;
        '6003':
          FedExMessage := Text262;
        '6004':
          FedExMessage := Text263;
        '6005':
          FedExMessage := Text264;
        '6006':
          FedExMessage := Text265;
        '6007':
          FedExMessage := Text266;
        '6008':
          FedExMessage := Text267;
        '6009':
          FedExMessage := Text268;
        '6010':
          FedExMessage := Text269;
        '6011':
          FedExMessage := Text270;
        '6012':
          FedExMessage := Text271;
        '6013':
          FedExMessage := Text272;
        '6014':
          FedExMessage := Text273;
        '6015':
          FedExMessage := Text274;
        '6016':
          FedExMessage := Text275;
        '6017':
          FedExMessage := Text276;
        '6018':
          FedExMessage := Text277;
        '6019':
          FedExMessage := Text278;
        '6020':
          FedExMessage := Text279;
        '6021':
          FedExMessage := Text280;
        '6022':
          FedExMessage := Text281;
        '6023':
          FedExMessage := Text282;
        '6024':
          FedExMessage := Text283;
        '6025':
          FedExMessage := Text284;
        '6026':
          FedExMessage := Text285;
        '6027':
          FedExMessage := Text286;
        '6028':
          FedExMessage := Text287;
        '6029':
          FedExMessage := Text288;
        '6030':
          FedExMessage := Text289;
        '6031':
          FedExMessage := Text290;
        '6032':
          FedExMessage := Text291;
        '6033':
          FedExMessage := Text292;
        '6034':
          FedExMessage := Text293;
        '6035':
          FedExMessage := Text294;
        '6037':
          FedExMessage := Text295;
        '6038':
          FedExMessage := Text296;
        '6039':
          FedExMessage := Text297;
        '6040':
          FedExMessage := Text298;
        '6041':
          FedExMessage := Text299;
        '6042':
          FedExMessage := Text300;
        '6043':
          FedExMessage := Text301;
        '6044':
          FedExMessage := Text302;
        '6045':
          FedExMessage := Text303;
        '6046':
          FedExMessage := Text304;
        '6047':
          FedExMessage := Text305;
        '6048':
          FedExMessage := Text306;
        '6049':
          FedExMessage := Text307;
        '7001':
          FedExMessage := Text308;
        '7002':
          FedExMessage := Text309;
        '7003':
          FedExMessage := Text310;
        '7004':
          FedExMessage := Text311;
        '7005':
          FedExMessage := Text312;
        '7006':
          FedExMessage := Text313;
        '7007':
          FedExMessage := Text314;
        '7008':
          FedExMessage := Text315;
        '7009':
          FedExMessage := Text316;
        '7010':
          FedExMessage := Text239;
        '7011':
          FedExMessage := Text317;
        '7012':
          FedExMessage := Text318;
        '7013':
          FedExMessage :=
            Text319;
        '7014':
          FedExMessage := Text320;
        '7015':
          FedExMessage := Text321;
        '7016':
          FedExMessage := Text322;
        '7017':
          FedExMessage := Text323;
        '7018':
          FedExMessage := Text324;
        '7019':
          FedExMessage := Text325;
        '7020':
          FedExMessage := Text326;
        '7021':
          FedExMessage := Text327;
        '7022':
          FedExMessage := Text328;
        '7023':
          FedExMessage := Text329;
        '7024':
          FedExMessage := Text330;
        '7025':
          FedExMessage := Text331;
        '7026':
          FedExMessage := Text332;
        '7027':
          FedExMessage := Text333;
        '7028':
          FedExMessage := Text334;
        '7029':
          FedExMessage := Text335;
        '7030':
          FedExMessage := Text336;
        '7031':
          FedExMessage := Text337;
        '7032':
          FedExMessage := Text338;
        '7033':
          FedExMessage := Text339;
        '7034':
          FedExMessage := Text340;
        '7035':
          FedExMessage := Text341;
        '7036':
          FedExMessage := Text342;
        '7037':
          FedExMessage := Text343;
        '7038':
          FedExMessage := Text344;
        '7039':
          FedExMessage := Text345;
        '7040':
          FedExMessage := Text346;
        '7041':
          FedExMessage := Text347;
        '7042':
          FedExMessage := Text348;
        '7043':
          FedExMessage := Text349;
        '7044':
          FedExMessage := Text350;
        '7045':
          FedExMessage := Text351;
        '7046':
          FedExMessage := Text352;
        '7047':
          FedExMessage := Text353;
        '7048':
          FedExMessage := Text354;
        '7049':
          FedExMessage := Text355;
        '7050':
          FedExMessage := Text356;
        '7051':
          FedExMessage := Text357;
        '7099':
          FedExMessage := Text358;
        '8001':
          FedExMessage := Text359;
        '8002':
          FedExMessage := Text360;
        '8003':
          FedExMessage := Text361;
        '8004':
          FedExMessage := Text362;
        '8005':
          FedExMessage := Text363;
        '8006':
          FedExMessage := Text364;
        '8007':
          FedExMessage := Text365;
        '8008':
          FedExMessage := Text366;
        '8009':
          FedExMessage := Text367;
        '800B':
          FedExMessage := Text368;
        '800C':
          FedExMessage := Text075;
        '800D':
          FedExMessage := Text369;
        '800E':
          FedExMessage := Text370;
        '800F':
          FedExMessage := Text371;
        '8010':
          FedExMessage := Text372;
        '8011':
          FedExMessage := Text373;
        '8012':
          FedExMessage := Text374;
        '8013':
          FedExMessage := Text375;
        '8014':
          FedExMessage := Text376;
        '8015':
          FedExMessage := Text377;
        '8016':
          FedExMessage := Text378;
        '8017':
          FedExMessage := Text379;
        '8018':
          FedExMessage := Text380;
        '8019':
          FedExMessage := Text381;
        '801A':
          FedExMessage := Text382;
        '801B':
          FedExMessage := Text383;
        '801C':
          FedExMessage := Text384;
        '801D':
          FedExMessage := Text385;
        '801E':
          FedExMessage := Text386;
        '801F':
          FedExMessage := Text387;
        '8020':
          FedExMessage := Text240;
        '8021':
          FedExMessage := Text388;
        '8022':
          FedExMessage := Text389;
        '8023':
          FedExMessage := Text390;
        '8024':
          FedExMessage := Text360;
        '8025':
          FedExMessage := Text391;
        '8026':
          FedExMessage := Text392;
        '8027':
          FedExMessage := Text393;
        '8028':
          FedExMessage := Text394;
        '8029':
          FedExMessage := Text395;
        '8030':
          FedExMessage := Text396;
        '803A':
          FedExMessage := Text397;
        '803B':
          FedExMessage := Text398;
        '803C':
          FedExMessage := Text399;
        '803D':
          FedExMessage := Text400;
        '8100':
          FedExMessage := Text401;
        '8300':
          FedExMessage := Text155;
        '8301':
          FedExMessage := Text402;
        '8302':
          FedExMessage := Text403;
        '8995':
          FedExMessage := Text404;
        '8996':
          FedExMessage := Text405;
        '8997':
          FedExMessage := Text406;
        '8998':
          FedExMessage := Text407;
        '8999':
          FedExMessage := Text408;
        '9901':
          FedExMessage := Text409;
        '9902':
          FedExMessage := Text410;
        '9999':
          FedExMessage := Text411;
        'F001':
          FedExMessage := Text412;
        'F002':
          FedExMessage := Text413;
        'F003':
          FedExMessage := Text414;
        'F004':
          FedExMessage := Text415;
        'F005':
          FedExMessage := Text416;
        'F006':
          FedExMessage := Text417;
        'F007':
          FedExMessage := Text418;
        'F008':
          FedExMessage := Text419;
        'F009':
          FedExMessage := Text420;
        'F00A':
          FedExMessage := Text421;
        'F00B':
          FedExMessage := Text422;
        'F00C':
          FedExMessage := Text423;
        'F00D':
          FedExMessage := Text424;
        'F00E':
          FedExMessage := Text425;
        'F00F':
          FedExMessage := Text426;
        'F010':
          FedExMessage := Text427;
        'F011':
          FedExMessage := Text428;
        'F012':
          FedExMessage := Text429;
        'F013':
          FedExMessage := Text430;
        'F014':
          FedExMessage := Text431;
        'F015':
          FedExMessage := Text432;
        'F016':
          FedExMessage := Text433;
        'F017':
          FedExMessage := Text434;
        'F01C':
          FedExMessage := Text435;
        'F01D':
          FedExMessage := Text436;
        'F01E':
          FedExMessage := Text437;
        'F01F':
          FedExMessage := Text438;
        'F020':
          FedExMessage := Text439;
        'F021':
          FedExMessage := Text355;
        'F022':
          FedExMessage := Text440;
        'F023':
          FedExMessage := Text441;
        'F024':
          FedExMessage := Text442;
        'F025':
          FedExMessage := Text443;
        'F026':
          FedExMessage := Text444;
        'F027':
          FedExMessage := Text445;
        'F028':
          FedExMessage := Text446;
        'F029':
          FedExMessage := Text447;
        'F02A':
          FedExMessage := Text448;
        'F02B':
          FedExMessage := Text449;
        'F02C':
          FedExMessage := Text450;
        'F02D':
          FedExMessage := Text451;
        'F02E':
          FedExMessage := Text452;
        'F02F':
          FedExMessage := Text453;
        'F030':
          FedExMessage := Text454;
        'F031':
          FedExMessage := Text455;
        'F032':
          FedExMessage := Text456;
        'F033':
          FedExMessage := Text457;
        'F034':
          FedExMessage := Text458;
        'F035':
          FedExMessage := Text459;
        'F036':
          FedExMessage := Text460;
        'F037':
          FedExMessage := Text461;
        'F038':
          FedExMessage := Text462;
        'F039':
          FedExMessage := Text463;
        'F03A':
          FedExMessage := Text464;
        'F03B':
          FedExMessage :=
            Text465;
        'F03C':
          FedExMessage := Text466;
        'F03D':
          FedExMessage := Text467;
        'F03E':
          FedExMessage := Text468;
        'F03F':
          FedExMessage := Text469;
        'F040':
          FedExMessage := Text470;
        'F490':
          FedExMessage := Text471;
        'F491':
          FedExMessage := Text472;
        'F492':
          FedExMessage := Text473;
        'F493':
          FedExMessage := Text474;
        'F494':
          FedExMessage := Text475;
        'F500':
          FedExMessage := Text476;
        'F501':
          FedExMessage := Text477;
        'F502':
          FedExMessage := Text478;
        'F503':
          FedExMessage := Text479;
        'F510':
          FedExMessage := Text480;
        'F511':
          FedExMessage := Text481;
        'F512':
          FedExMessage := Text482;
        'F513':
          FedExMessage := Text483;
        'F600':
          FedExMessage := Text484;
        'F800':
          FedExMessage := Text485;
        'F801':
          FedExMessage := Text486;
        'F802':
          FedExMessage := Text487;
        'F803':
          FedExMessage := Text488;
        'F804':
          FedExMessage := Text489;
        'F805':
          FedExMessage := Text490;
        'F806':
          FedExMessage := Text491;
        'F807':
          FedExMessage := Text492;
        'F808':
          FedExMessage := Text493;
        'F809':
          FedExMessage := Text494;
        'F80A':
          FedExMessage := Text495;
        'F80B':
          FedExMessage := Text496;
        'F80C':
          FedExMessage := Text497;
        'F80D':
          FedExMessage := Text498;
        'F80E':
          FedExMessage := Text499;
        'F80F':
          FedExMessage := Text500;
        'F810':
          FedExMessage := Text501;
        'F811':
          FedExMessage := Text502;
        'F812':
          FedExMessage := Text503;
        'F813':
          FedExMessage := Text504;
        'F814':
          FedExMessage := Text505;
        'F815':
          FedExMessage := Text506;
        'F816':
          FedExMessage := Text507;
        'F817':
          FedExMessage := Text508;
        'F818':
          FedExMessage := Text509;
        'F819':
          FedExMessage := Text510;
        'F81A':
          FedExMessage :=
            Text511 +
            Text512;
        'F81B':
          FedExMessage := Text513;
        'F820':
          FedExMessage := Text514;
        'F821':
          FedExMessage := Text515;
        'F822':
          FedExMessage := Text516;
        'F823':
          FedExMessage := Text517;
        'F824':
          FedExMessage := Text518;
        'F825':
          FedExMessage := Text519;
        'F826':
          FedExMessage := Text520;
        'F827':
          FedExMessage := Text521;
        'F828':
          FedExMessage := Text522;
        'F829':
          FedExMessage := Text523;
        'F830':
          FedExMessage := Text524;
        'F831':
          FedExMessage := Text525;
        'F832':
          FedExMessage := Text526;
        'F833':
          FedExMessage := Text527;
        'F834':
          FedExMessage := Text528;
        'F835':
          FedExMessage := Text529;
        'F836':
          FedExMessage := Text530;
        'F837':
          FedExMessage := Text531;
        'F838':
          FedExMessage := Text532;
        'F839':
          FedExMessage := Text533;
        'F83A':
          FedExMessage := Text534;
        'F83B':
          FedExMessage := Text535;
        'F83C':
          FedExMessage := Text536;
        'F83D':
          FedExMessage := Text537;
        'F83E':
          FedExMessage := Text538;
        'F83F':
          FedExMessage := Text539;
        'F840':
          FedExMessage := Text540;
        'F841':
          FedExMessage := Text541;
        'F842':
          FedExMessage := Text542;
        'F843':
          FedExMessage := Text543;
        'F844':
          FedExMessage := Text544;
        'F845':
          FedExMessage := Text545;
        'F846':
          FedExMessage := Text546;
        'F847':
          FedExMessage := Text547;
        'F848':
          FedExMessage := Text548;
        'F900':
          FedExMessage := Text549;
        'F901':
          FedExMessage := Text550;
        'FA01':
          FedExMessage := Text551;
        'FA02':
          FedExMessage := Text552;
        'FE00':
          FedExMessage := Text553;
        'FE01':
          FedExMessage := Text554;
        'FE02':
          FedExMessage := Text555;
        'FE03':
          FedExMessage := Text556;
        'FE04':
          FedExMessage := Text557;
        'FE05':
          FedExMessage := Text558;
        'FE06':
          FedExMessage := Text553;
        'FE07':
          FedExMessage := Text559;
        'FE08':
          FedExMessage := Text560;
        'FE09':
          FedExMessage := Text561;
        'FE10':
          FedExMessage := Text562;
        'FE11':
          FedExMessage := Text563;
        'FE12':
          FedExMessage := Text564;
        'FE13':
          FedExMessage := Text565;
        'FE14':
          FedExMessage := Text566;
        'FE15':
          FedExMessage := Text567;
        'FE16':
          FedExMessage := Text568;
        'FE17':
          FedExMessage := Text569;
        'FE18':
          FedExMessage := Text570;
        'FE19':
          FedExMessage := Text571;
        'FE1A':
          FedExMessage :=
            Text572 +
            Text573;
        'FE1B':
          FedExMessage := Text574;
        'FF01':
          FedExMessage := Text575;
        'FF02':
          FedExMessage := Text576;
        'FF03':
          FedExMessage := Text577;
        'FF04':
          FedExMessage := Text578;
        'FF05':
          FedExMessage := Text579;
        'FF06':
          FedExMessage :=
            Text580;
        'FF07':
          FedExMessage :=
            Text581;
        'FF08':
          FedExMessage :=
            Text582;
        'FF09':
          FedExMessage :=
            Text583 +
            Text584
      ;
        'FF0A':
          FedExMessage :=
            Text583 +
            Text585;
        'FF0B':
          FedExMessage :=
            Text583 +
            Text586;
        'FF0C':
          FedExMessage :=
            Text583 +
            Text587;
        'FF10':
          FedExMessage := Text588;
        'FF11':
          FedExMessage := Text589;
        'FF12':
          FedExMessage := Text590;
        'FF13':
          FedExMessage := Text591;
        'FF14':
          FedExMessage := Text592;
        'FF15':
          FedExMessage :=
            Text593;
        'FF16':
          FedExMessage :=
            Text594;
        'FF17':
          FedExMessage :=
            Text595;
        'FF30':
          FedExMessage := Text596;
      END;
    END;

    LOCAL PROCEDURE FixPhoneNo@35(OriginalPhone@1000000001 : Text[30]) ReturnPhone@1000000000 : Text[30];
    VAR
      i@1000000003 : Integer;
    BEGIN
      FOR i := 1 TO STRLEN(OriginalPhone) DO BEGIN
        IF (OriginalPhone[i] >= 48) AND (OriginalPhone[i] <= 57) THEN
          ReturnPhone := ReturnPhone + STRSUBSTNO('%1',OriginalPhone[i]);
      END;
    END;

    LOCAL PROCEDURE FixZIPCode@34(ZIPCodeText@1000000000 : Text[30]) : Text[9];
    BEGIN
      EXIT(COPYSTR(DELCHR(ZIPCodeText,'=',' -'),1,9));
    END;

    LOCAL PROCEDURE FixState@19(StateText@1000000000 : Text[30]) : Text[2];
    BEGIN
      EXIT(COPYSTR(DELCHR(StateText,'>',' '),1,2));
    END;

    LOCAL PROCEDURE FixUnitOfMeasure@44(UnitOfMeasureText@1000000000 : Text[30]) : Text[3];
    BEGIN
      EXIT(COPYSTR(UnitOfMeasureText,1,3));
    END;

    LOCAL PROCEDURE ShowBrowserLabel@23();
    VAR
      Answer@1000000000 : Integer;
    BEGIN
      GetPackingStation;
      CarrierPackingStation.GetPackingStation(PackingStation);
      {
      FedEx.LoadBuffer(BufferFileName);
      Window.OPEN(Text001);
      Answer := FedEx.PrintBrowserLabel(CarrierPackingStation."FedEx Buffer Directory");}
      Window.CLOSE;
    END;

    LOCAL PROCEDURE ReformatTextLabel@24(CurrentPackage@1000000000 : Record 14000701;LabelName@1000000001 : Text[250];CODLabel@1000000002 : Boolean);
    VAR
      CompanyInfo@1000000003 : Record 79;
      FedExLabelReplace@1240030003 : Record 14000790;
      FedExLabelReplaceTmp@1240030004 : TEMPORARY Record 14000790;
      TextFile@1000000004 : File;
      TempTextFile@1000000005 : File;
      TempLabelName@1000000006 : Text[250];
      LabelSearch@1000000007 : ARRAY [5] OF Text[250];
      LabelReplace@1000000008 : ARRAY [5] OF Text[250];
      TextLine@1000000009 : Text[250];
      PhoneNo@1000000014 : Text[30];
      Contact@1000000015 : Text[100];
      Company@1000000016 : Text[100];
      Address1@1000000017 : Text[100];
      Address2@1000000018 : Text[100];
      City@1000000019 : Text[100];
      State@1000000020 : Text[30];
      ZIPCode@1000000021 : Text[30];
      Quote@1000000022 : Text[10];
      LinePos@1000000023 : Integer;
      i@1000000024 : Integer;
      Changed@1000000025 : Boolean;
      ItemLabelInfo@1240030000 : ARRAY [10,8] OF Text[50];
      TempText@1240030001 : Text[250];
      SkipLine@1240030002 : Boolean;
    BEGIN
      WITH CurrentPackage DO BEGIN
        IF NOT EXISTS(LabelName) THEN
          EXIT;

        GetPackingStation;
        CarrierPackingStation.GetPackingStation(PackingStation);
        GetShippingAgentService("Shipping Agent Code","Shipping Agent Service","World Wide Service");
        Changed := FALSE;
        Quote := '"';
        LabelSearch[1] := 'q819';
        LabelReplace[1] := 'q800';
        IF CarrierPackingStation."FedEx Print From" =
           CarrierPackingStation."FedEx Print From"::Top
        THEN BEGIN
          LabelSearch[3] := 'ZT';
          LabelReplace[3] := 'ZB';
         END ELSE BEGIN
          LabelSearch[3] := 'ZB';
          LabelReplace[3] := 'ZT';
        END;

        // Insert Defaults
        FedExLabelReplace.RESET;
        IF NOT FedExLabelReplace.FIND('-') THEN
          FedExLabelReplace.InsertDefaultLabelReplaces;

        // Change From Addresses
        IF NOT CODLabel THEN BEGIN
          IF "Blind Shipment" OR "Double Blind Shipment" THEN BEGIN
            Contact := "Blind Ship-from Contact";
            Company := "Blind Ship-from Name";
            Address1 := "Blind Ship-from Address";
            Address2 := "Blind Ship-from Address 2";
            City := "Blind Ship-from City";
            State := FixState("Blind Ship-from State");
            ZIPCode := FixZIPCode("Blind Ship-from ZIP Code");
            PhoneNo := FixPhoneNo("Blind Ship-from Phone No.");
          END ELSE BEGIN
            CompanyInfo.GET;
            Contact := '';
            Company := CompanyInfo.Name;
            Address1 := CompanyInfo."COD Address 1";
            Address2 := CompanyInfo."COD Address 2";
            City := CompanyInfo."COD City";
            State := FixState(CompanyInfo."COD State");
            ZIPCode := FixZIPCode(CompanyInfo."COD Zip Code");
            PhoneNo := FixPhoneNo(CompanyInfo."COD Phone No.");
          END;

          FedExLabelReplace.RESET;
          FedExLabelReplace.SETFILTER(
            Version,'%1|%2',
            FedExLabelReplace.Version::All,FedExLabelReplace.Version::"6.21.001");
          FedExLabelReplace.SETRANGE(Active,TRUE);
          IF "Blind Shipment" OR "Double Blind Shipment" THEN
            IF CurrentPackage."Total Packages" > 1 THEN
              FedExLabelReplace.SETFILTER(
                Usage,'%1|%2|%3',
                FedExLabelReplace.Usage::" ",FedExLabelReplace.Usage::"Blind Ship",
                FedExLabelReplace.Usage::"Package No.")
            ELSE
              FedExLabelReplace.SETFILTER(
                Usage,'%1|%2',
                FedExLabelReplace.Usage::" ",FedExLabelReplace.Usage::"Blind Ship")
          ELSE
            IF CurrentPackage."Total Packages" > 1 THEN
              FedExLabelReplace.SETFILTER(
                Usage,'%1|%2',
                FedExLabelReplace.Usage::" ",FedExLabelReplace.Usage::"Package No.")
            ELSE
              FedExLabelReplace.SETRANGE(Usage,FedExLabelReplace.Usage::" ");

          IF ShippingAgentService."Transport Method Type" =
             ShippingAgentService."Transport Method Type"::Ground
          THEN BEGIN
            CASE CarrierPackingStation."FedEx Label Media Type" OF
              CarrierPackingStation."FedEx Label Media Type"::"4X6 with Trailing Doc Tab":
                FedExLabelReplace.SETFILTER(
                  "Service Type",'%1|%2',
                  FedExLabelReplace."Service Type"::"Ground with Doc Tab",
                  FedExLabelReplace."Service Type"::Ground);
              CarrierPackingStation."FedEx Label Media Type"::"4X6 W/O Doc Tab":
                FedExLabelReplace.SETFILTER(
                  "Service Type",'%1|%2',
                  FedExLabelReplace."Service Type"::"Ground W/O Doc Tab",
                  FedExLabelReplace."Service Type"::Ground);
            END;
          END ELSE
            IF "World Wide Service" THEN
              FedExLabelReplace.SETRANGE(
                "Service Type",FedExLabelReplace."Service Type"::"World Wide")
            ELSE
              FedExLabelReplace.SETRANGE(
                "Service Type",FedExLabelReplace."Service Type"::Express);

          IF FedExLabelReplace.FIND('-') THEN
            REPEAT
              FedExLabelReplaceTmp := FedExLabelReplace;
              FedExLabelReplaceTmp.INSERT;
            UNTIL FedExLabelReplace.NEXT = 0;
        END;

        TempLabelName := LabelName + '.tmp.txt';
        TempTextFile.TEXTMODE(TRUE);
        TempTextFile.WRITEMODE(TRUE);
        TempTextFile.CREATE(TempLabelName);

        TextFile.TEXTMODE(TRUE);
        TextFile.WRITEMODE(TRUE);
        IF EXISTS(LabelName + '.org.txt') THEN
          TextFile.OPEN(LabelName + '.org.txt')
        ELSE
          TextFile.OPEN(LabelName);

        REPEAT
          TextFile.READ(TextLine);

          FOR i := 1 TO ARRAYLEN(LabelSearch) DO
            IF LabelSearch[i] <> '' THEN
              IF STRPOS(TextLine,LabelSearch[i]) <> 0 THEN
                TextLine := LabelReplace[i];

          IF FedExLabelReplaceTmp.FIND('-') THEN
            REPEAT
              IF STRPOS(TextLine,FedExLabelReplaceTmp."Search String") = 1 THEN BEGIN
                TextLine := FedExLabelReplaceTmp."Search String";

                CASE FedExLabelReplaceTmp."Additional Data" OF
                  FedExLabelReplaceTmp."Additional Data"::Company:
                    TextLine := TextLine + Company + '"';
                  FedExLabelReplaceTmp."Additional Data"::Address1:
                    TextLine := TextLine + Address1 + '"';
                  FedExLabelReplaceTmp."Additional Data"::Address2:
                    TextLine := TextLine + Address2 + '"';
                  FedExLabelReplaceTmp."Additional Data"::City:
                    TextLine := TextLine + City + '"';
                  FedExLabelReplaceTmp."Additional Data"::State:
                    TextLine := TextLine + State + '"';
                  FedExLabelReplaceTmp."Additional Data"::"ZIP Code":
                    TextLine := TextLine + ZIPCode + '"';
                  FedExLabelReplaceTmp."Additional Data"::"City State":
                    TextLine := TextLine + City + ' ' + State + '"';
                  FedExLabelReplaceTmp."Additional Data"::"City State ZIP":
                    TextLine := TextLine + City + ' ' + State + ' ' + ZIPCode + '"';
                  FedExLabelReplaceTmp."Additional Data"::"City State ZIP (US)":
                    TextLine := TextLine + City + ' ' + State + ' ' + ZIPCode + ' (US)"';
                  FedExLabelReplaceTmp."Additional Data"::Phone:
                    TextLine := TextLine + PhoneNo + '"';
                  FedExLabelReplaceTmp."Additional Data"::Contact:
                    TextLine := TextLine + Contact + '"';
                  FedExLabelReplaceTmp."Additional Data"::Blank:
                    TextLine := TextLine + '"';
                  FedExLabelReplaceTmp."Additional Data"::"ORIGIN ID: MULA + Phone":
                    TextLine := TextLine + 'ORIGIN ID: MULA  ' + PhoneNo + '"';
                  FedExLabelReplaceTmp."Additional Data"::"Space + Phone":
                    TextLine := TextLine + ' ' + PhoneNo + '"';
                  FedExLabelReplaceTmp."Additional Data"::"Package No.":
                    TextLine := TextLine + FORMAT("Package No.") + '"';
                  FedExLabelReplaceTmp."Additional Data"::"Total Packages":
                    TextLine := TextLine + FORMAT("Total Packages") + '"';
                  FedExLabelReplaceTmp."Additional Data"::"Package No./Total Packages":
                    TextLine := TextLine + FORMAT("Package No.") + '/' + FORMAT("Total Packages") + '"';
                  ELSE
                    TextLine := TextLine + '"';
                END;
              END;
            UNTIL FedExLabelReplaceTmp.NEXT = 0;

          IF CarrierPackingStation."FedEx Add Item Info. on Label" THEN BEGIN
            SkipLine := FALSE;

            IF TextLine <> '' THEN
              CASE COPYSTR(TextLine,1,1) OF
                'A':
                  BEGIN
                    LinePos := STRPOS(TextLine,',');
                    IF LinePos > 0 THEN BEGIN
                      TempText := COPYSTR(TextLine,LinePos + 1);
                      LinePos := STRPOS(TempText,',');
                      IF LinePos > 0 THEN BEGIN
                        TempText := COPYSTR(TempText,1,LinePos - 1);
                        IF EVALUATE(LinePos,TempText) THEN
                          SkipLine := LinePos > 1200;
                      END;
                    END;
                  END;
                'P':
                  BEGIN
                    Shipping.GetItemLabelInfo(CurrentPackage,ItemLabelInfo);
                    Shipping.DirectPrintOrionLabelInfo(TempTextFile,ItemLabelInfo);
                  END;
              END;

            IF NOT SkipLine THEN
              TempTextFile.WRITE(TextLine);
          END ELSE
            TempTextFile.WRITE(TextLine);
        UNTIL TextFile.POS >= TextFile.LEN;
        TextFile.CLOSE;
        TempTextFile.CLOSE;
      END;

      IF NOT EXISTS(LabelName + '.org.txt') THEN
        COPY(LabelName,LabelName + '.org.txt');
      ERASE(LabelName);
      COPY(TempLabelName,LabelName);
      ERASE(TempLabelName);
    END;

    LOCAL PROCEDURE GetPackingStation@51();
    BEGIN
      IF PackingStation.Code = '' THEN
        PackingStation.GetPackingStation;
    END;

    LOCAL PROCEDURE GetShippingSetup@33();
    BEGIN
      IF NOT ShippingSetupRetrieved THEN BEGIN
        ShippingSetup.GET;
        ShippingSetupRetrieved := TRUE;
      END;
    END;

    LOCAL PROCEDURE GetShippingAgent@45(ShippingAgentCode@1000000000 : Code[10]);
    BEGIN
      IF (ShippingAgent.Code <> ShippingAgentCode) OR
         (ShippingAgentCode = '')
      THEN
        ShippingAgent.GET(ShippingAgentCode);
    END;

    LOCAL PROCEDURE GetShippingAgentService@15(ShippingAgentCode@1000000000 : Code[10];ShippingAgentServiceCode@1000000001 : Code[30];WorldWideService@1000000002 : Boolean);
    BEGIN
      IF (ShippingAgentService.Code <> ShippingAgentCode) OR
         (ShippingAgentService."World Wide Service" <> WorldWideService) OR
         (ShippingAgentService.Code <> ShippingAgentServiceCode) OR
         (ShippingAgentServiceCode = '')
      THEN
        ShippingAgentService.GET(ShippingAgentCode,ShippingAgentServiceCode,WorldWideService);
    END;

    LOCAL PROCEDURE Date2Integer@25(CalcDate@1000000000 : Date) : Integer;
    BEGIN
      EXIT(DATE2DMY(CalcDate,3) * 10000 + DATE2DMY(CalcDate,2) * 100 + DATE2DMY(CalcDate,1));
    END;

    LOCAL PROCEDURE Time2Text@37(CalcTime@1000000000 : Time) : Text[30];
    VAR
      TempText@1000000001 : Text[30];
    BEGIN
      TempText := FORMAT(CalcTime,0,'<Hours24,2><Minutes,2><Seconds,2>');
      IF TempText[1] = ' ' THEN
        TempText := '0' + COPYSTR(TempText,2,STRLEN(TempText));
      EXIT(TempText);
    END;

    LOCAL PROCEDURE Decimal2Text@36(CalcDecimal@1000000000 : Decimal;DecimalToShow@1000000001 : Integer) : Text[30];
    VAR
      TempText@1000000002 : Text[30];
      ThousandChar@1000000003 : Text[1];
    BEGIN
      ThousandChar := COPYSTR(FORMAT(1000.1),2,1);
      TempText := FORMAT(CalcDecimal);
      TempText := DELCHR(TempText,'=',ThousandChar);
      TempText := CONVERTSTR(TempText,',','.');

      IF DecimalToShow <> 0 THEN BEGIN
        IF STRPOS(TempText,'.') = 0 THEN
          TempText := TempText + '.000000'
        ELSE
          TempText := TempText + '00000';
        TempText := COPYSTR(TempText,1,STRPOS(TempText,'.') + DecimalToShow);

        IF (STRLEN(TempText) - STRPOS(TempText,'.') <> DecimalToShow) OR (STRPOS(TempText,'.') = 0) THEN
          ERROR(Text597,CalcDecimal,TempText,DecimalToShow);
      END;

      EXIT(TempText);
    END;

    LOCAL PROCEDURE Text2Decimal@29(CalcText@1000000000 : Text[30]) : Decimal;
    VAR
      TempDecimal@1000000001 : Decimal;
    BEGIN
      IF CalcText = '' THEN
        EXIT(0);

      EVALUATE(TempDecimal,CalcText);
      EXIT(TempDecimal);
    END;

    LOCAL PROCEDURE Integer2Text@38(CalcInteger@1000000000 : Integer) : Text[30];
    VAR
      TempText@1000000001 : Text[30];
      ThousandChar@1000000002 : Text[1];
    BEGIN
      ThousandChar := COPYSTR(FORMAT(1000.1),2,1);
      TempText := FORMAT(CalcInteger);
      TempText := DELCHR(TempText,'=',ThousandChar);
      TempText := CONVERTSTR(TempText,',','.');
      EXIT(TempText);
    END;

    LOCAL PROCEDURE Text2Integer@41(CalcText@1000000000 : Text[30]) : Integer;
    VAR
      TempInteger@1000000001 : Integer;
    BEGIN
      IF CalcText = '' THEN
        EXIT(0);

      EVALUATE(TempInteger,CalcText);
      EXIT(TempInteger);
    END;

    LOCAL PROCEDURE Boolean2YN@40(CalcBoolean@1000000000 : Boolean) : Text[1];
    BEGIN
      IF CalcBoolean THEN
        EXIT('Y')
      ELSE
        EXIT('N');
    END;

    LOCAL PROCEDURE YN2Boolean@39(CalcText@1000000000 : Text[30]) : Boolean;
    BEGIN
      EXIT(CalcText = 'Y');
    END;

    LOCAL PROCEDURE GetFedExCountryCode@27(CountryCode@1000000000 : Code[10]) : Code[10];
    VAR
      Country@1000000001 : Record 9;
    BEGIN
      IF CountryCode <> '' THEN BEGIN
        Country.GET(CountryCode);
        Country.TESTFIELD(FedEx);
        Country.TESTFIELD("ISO 2 char Country Code");
        EXIT(Country."ISO 2 char Country Code");
      END ELSE
        EXIT('US');
    END;

    LOCAL PROCEDURE TestAndTransferToThirdParty@60(VAR CurrentPackage@1000000000 : Record 14000701;FedExOptionPage@1000000001 : Record 14000781;CurrentShippingAgentService@1000000002 : Record 14000708);
    BEGIN
      WITH CurrentPackage DO BEGIN
        IF "Shipping Payment Type" <> "Shipping Payment Type"::Prepaid THEN
          TransferToThirdPartyCost(CurrentShippingAgentService."Markup on Zero Shipping Cost")
        ELSE
          ClearThirdPartyCost;
      END;
    END;

    LOCAL PROCEDURE TestAndTransferToThirdPartyRS@61(CurrentRateShopHeader@1000000000 : Record 14000741;VAR CurrentRateShopLine@1000000001 : Record 14000742;FedExOptionPage@1000000002 : Record 14000781;CurrentShippingAgentService@1000000003 : Record 14000708);
    BEGIN
      WITH CurrentRateShopLine DO BEGIN
        IF CurrentRateShopHeader."Shipping Payment Type" <>
           CurrentRateShopHeader."Shipping Payment Type"::Prepaid
        THEN
          TransferToThirdPartyCost(
            CurrentRateShopHeader,CurrentShippingAgentService."Markup on Zero Shipping Cost")
        ELSE
          ClearThirdPartyCost;
      END;
    END;

    LOCAL PROCEDURE TestWEBAPI@17(CurrentShippingAgentAccount@1240030000 : Record 14000788);
    VAR
      InputFile@1240030001 : File;
      FileName@1240030002 : Text[250];
      InputLine@1240030003 : Text[250];
    BEGIN
      IF CurrentShippingAgentAccount."Test Status" =
         CurrentShippingAgentAccount."Test Status"::"No Testing"
      THEN
        EXIT;

      //FileName := ENVIRON('windir');
      IF FileName = '' THEN BEGIN
        //FileName := ENVIRON('SystemRoot');
        IF FileName = '' THEN
          ERROR(Text598);
      END;
      FileName := FileName + '\webapi.ini';

      InputFile.TEXTMODE(TRUE);
      InputFile.WRITEMODE(FALSE);
      IF NOT InputFile.OPEN(FileName) THEN
        ERROR(Text599,FileName);

      WHILE InputFile.READ(InputLine) > 0 DO
        IF STRLEN(InputLine) > 8 THEN
          IF COPYSTR(InputLine,1,8) = 'FDXHOST=' THEN BEGIN
            IF CurrentShippingAgentAccount."Test Status" =
               CurrentShippingAgentAccount."Test Status"::Live
            THEN
              IF InputLine = 'FDXHOST=www.fedex.com' THEN
                EXIT;

            IF CurrentShippingAgentAccount."Test Status" =
               CurrentShippingAgentAccount."Test Status"::Beta
            THEN
              IF InputLine = 'FDXHOST=wwwbeta.fedex.com' THEN
                EXIT;

            ERROR(Text600,InputLine);
          END;

      ERROR(Text601,InputFile);
    END;

    PROCEDURE TrackPackage@1240030001(CurrentPackage@1240030000 : Record 14000701);
    VAR
      Country@1240030010 : Record 9;
    BEGIN
      WITH CurrentPackage DO BEGIN
        ShippingAgent.GET("Shipping Agent Code");

        Country.INIT;
        IF "Ship-to Country Code" <> '' THEN
          Country.GET("Ship-to Country Code");

        HYPERLINK(
          STRSUBSTNO(
            ShippingAgent."Internet Address","External Tracking No.",Country.Code,
            "Pickup Date",ShippingAgent."Account No."));
      END;
    END;

    PROCEDURE CheckName@1240030019(ShippingAgent@1240030010 : Record 291;FromType@1240030006 : 'Package,Document,Master Data';VAR Name@1240030001 : Text[100];VAR Name2@1240030002 : Text[100];VAR Contact@1240030005 : Text[100];NameCaption@1240030009 : Text[100];Name2Caption@1240030008 : Text[100];ContactCaption@1240030000 : Text[100]);
    VAR
      LongNameType@1240030004 : Integer;
    BEGIN
      LongNameType := NameAndAddressMgt.GetLongNameType(ShippingAgent,FromType);

      NameAndAddressMgt.CheckCorrectTextLen(Name,LongNameType,35,NameCaption);
      NameAndAddressMgt.CheckCorrectTextLen(Name2,LongNameType,35,Name2Caption);
      NameAndAddressMgt.CheckCorrectTextLen(Contact,LongNameType,35,ContactCaption);
    END;

    PROCEDURE CheckAddress@1240030000(ShippingAgent@1240030010 : Record 291;FromType@1240030016 : 'Package,Document,Master Data';VAR Address@1240030012 : Text[100];VAR Address2@1240030011 : Text[100];VAR City@1240030009 : Text[100];VAR PostCode@1240030008 : Code[100];VAR State@1240030007 : Text[100];VAR Country@1240030006 : Code[100];AddressCaption@1240030005 : Text[100];Address2Caption@1240030004 : Text[100];CityCaption@1240030003 : Text[100];PostCodeCaption@1240030002 : Text[100];StateCaption@1240030001 : Text[100];CountryCaption@1240030000 : Text[100]);
    VAR
      TempText@1240030013 : Text[100];
      LongAddressType@1240030015 : Integer;
    BEGIN
      LongAddressType := NameAndAddressMgt.GetLongAddressType(ShippingAgent,FromType);

      NameAndAddressMgt.CheckCorrectTextLen(Address,LongAddressType,35,AddressCaption);
      NameAndAddressMgt.CheckCorrectTextLen(Address2,LongAddressType,35,Address2Caption);
      NameAndAddressMgt.CheckCorrectTextLen(City,LongAddressType,35,CityCaption);
      TempText := PostCode;
      NameAndAddressMgt.CheckCorrectTextLen(TempText,LongAddressType,10,PostCodeCaption);
      PostCode := TempText;
      NameAndAddressMgt.CheckCorrectTextLen(State,LongAddressType,2,StateCaption);
    END;

    BEGIN
    {
      Retired with the introduction of webservices
      SE0.60.12 - commented out code referencing Hold At Location to enable the compiling of the object with the new
                  updates.
    }
    END.
  }
}

