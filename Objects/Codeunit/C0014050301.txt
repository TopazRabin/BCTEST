OBJECT Codeunit 14050301 EDI Job Queue
{
  OBJECT-PROPERTIES
  {
    Date=02/25/19;
    Time=12:00:00 PM;
    Version List=SE0.61;
  }
  PROPERTIES
  {
    TableNo=472;
    OnRun=VAR
            ProcessReceiveDocumentJob@1240020000 : Codeunit 14050304;
          BEGIN
            CLEAR(CmdArray);
            CmdCount := 0;
            StringCharCount := 1;
            CmdCharCount := 1;
            Command := '*';
            REPEAT
              IF "Parameter String"[StringCharCount] = '/' THEN BEGIN
                IF Command <> '*' THEN
                  CmdArray[CmdCount] := Command;
                CmdCount := CmdCount + 1;
                CmdCharCount := 1;
                Command := '';
                StringCharCount := StringCharCount + 1;
              END ELSE BEGIN
                Command[CmdCharCount] := "Parameter String"[StringCharCount];
                StringCharCount := StringCharCount + 1;
                CmdCharCount := CmdCharCount + 1;
              END;
            UNTIL ("Parameter String"[StringCharCount] = Char);

            CmdCount := 1;
            REPEAT
              CmdArray[CmdCount] := UPPERCASE(CmdArray[CmdCount]);
              CmdCount := CmdCount + 1;
            UNTIL CmdArray[CmdCount] = '';

            CmdCount := 1;

            REPEAT
              EDIJob.RESET;
              EDIJob.SETRANGE(Code,CmdArray[CmdCount]);
              IF EDIJob.FIND('-') THEN BEGIN
                EDIJobRoutine.RESET;
                EDIJobRoutine.SETRANGE("Job Code",CmdArray[CmdCount]);
                EDIJobRoutine.SETRANGE(Inactive,FALSE);
                IF EDIJobRoutine.FIND('-') THEN
                  REPEAT
                    EDIJobRoutine2.RESET;
                    EDIJobRoutine2.SETRANGE("Job Code",EDIJobRoutine."Job Code");
                    EDIJobRoutine2.SETRANGE("Line No.",EDIJobRoutine."Line No.");
                    EDIJobRoutine2.FIND('-');
                    CASE EDIJobRoutine.Routine OF
                      'SENDINVOICE':
                        REPORT.RUN(REPORT::"Send E.D.I. Sales Invoice Job",FALSE,FALSE,EDIJobRoutine2);
                      'SENDPOACK':
                        REPORT.RUN(REPORT::"Send Purch. Order Ack. Job",FALSE,FALSE,EDIJobRoutine2);
                      'SENDPURCHORDER':
                        REPORT.RUN(REPORT::"Send Purchase Order Job",FALSE,FALSE);
                      'SENDASN':
                        REPORT.RUN(REPORT::"Send Advanced Ship Notice Job",FALSE,FALSE,EDIJobRoutine2);
                      'SENDWHSESHIPORDER':
                        REPORT.RUN(REPORT::"Send Warehouse Sales Adv. Job",FALSE,FALSE,EDIJobRoutine2);
                      'SENDWHSEPURCHADVICE':
                        REPORT.RUN(REPORT::"Send Whse. Purch. Adv. Job",FALSE,FALSE);
                      'RECEIVEEDI':
                        CODEUNIT.RUN(CODEUNIT::"E.D.I. Receive All Job Queue",EDIJobRoutine2);
                      'EXPORTALLSENDDOCS':
                        REPORT.RUN(REPORT::"Export E.D.I. Send Docs. Job",FALSE,FALSE,EDIJobRoutine2);
                      'SENDBSN':
                        REPORT.RUN(REPORT::"Send Ship and Bill Notice Job",FALSE,FALSE,EDIJobRoutine2);
                      'SENDSHIPMENTADVICE':
                        REPORT.RUN(REPORT::"Send E.D.I. Shipment Adv. Job",FALSE,FALSE,EDIJobRoutine2);
                      'SENDORDERSTATUS':
                        REPORT.RUN(REPORT::"Send Sales Order Status Job",FALSE,FALSE);
                      'SENDSALESCRMEMO':
                        REPORT.RUN(REPORT::"Send Sales Cr. Memo Job",FALSE,FALSE,EDIJobRoutine2);
                      'SENDROUTINGREQUEST':
                        REPORT.RUN(REPORT::"Send Routing Request Job",FALSE,FALSE,EDIJobRoutine2);
                      'SENDSALESRETURNRECEIPT':
                        REPORT.RUN(REPORT::"Send Sales Return Receipt Job",FALSE,FALSE,EDIJobRoutine2);
                      'SENDPURCHRETURNSHIPMENT':
                        REPORT.RUN(REPORT::"Send Purchase Return Ship Job",FALSE,FALSE,EDIJobRoutine2);
                      'SENDTRANSFERORDER':
                        REPORT.RUN(REPORT::"Send E.D.I. Transfer Order Job",FALSE,FALSE);
                      'SENDELECTRONICBOL':
                        REPORT.RUN(REPORT::"Send E.D.I. Electronic BOL Job",FALSE,FALSE,EDIJobRoutine2);
                      'SENDTRANSFERSHIPMENT':
                        REPORT.RUN(REPORT::"Send E.D.I. Transfer Ship Job",FALSE,FALSE);
                      'SENDPURCHPMTADVICE':
                        REPORT.RUN(REPORT::"Send E.D.I. Purch PmtAdviceJob",FALSE,FALSE,EDIJobRoutine2);
                      'SENDADVANCEORDERSTATUS':
                        REPORT.RUN(REPORT::"Send Advance Order Status Job",FALSE,FALSE,EDIJobRoutine2);
                      'SENDADVPOACK':
                        REPORT.RUN(REPORT::"Send Advance P.O. Ack. Job",FALSE,FALSE,EDIJobRoutine2);
                      'SENDORDERCHANGESTATUS':
                        REPORT.RUN(REPORT::"Send Order Change Status Job",FALSE,FALSE,EDIJobRoutine2);
                      'CREATEINVENTORYADVICE':
                        REPORT.RUN(REPORT::"Create E.D.I. Invt. Advice Job",FALSE,FALSE,EDIJobRoutine2);
                      'CREATESALESPRICECATALOG':
                        REPORT.RUN(REPORT::"Create E.D.I. Price CatalogJob",FALSE,FALSE,EDIJobRoutine2);
                      'SENDINVTADVICE':
                        REPORT.RUN(REPORT::"Send E.D.I. Invt. Advice Job",FALSE,FALSE,EDIJobRoutine2);
                      'SENDSALESPRICECATALOG':
                        REPORT.RUN(REPORT::"Send E.D.I. Price Catalog Job",FALSE,FALSE,EDIJobRoutine2);
                      'SENDSHIPCANCELLATION':
                        REPORT.RUN(REPORT::"Send E.D.I.ShipCancellationJob",FALSE,FALSE,EDIJobRoutine2);
                      'PROCESSPOCHANGE':
                        REPORT.RUN(REPORT::"Process E.D.I. P.O. Change Job",FALSE,FALSE,EDIJobRoutine2);
                      'PROCESSRECEIVEDOC':
                        ProcessReceiveDocumentJob.RUN(EDIJobRoutine2);
                      'SENDRESPONSETOQUOTE':
                        REPORT.RUN(REPORT::"Send E.D.I. Quote Response Job",FALSE,FALSE,EDIJobRoutine2);
                      'SENDTPZWHDropShip':
                        REPORT.RUN(REPORT::"Send Warehouse Sales Adv. Job",FALSE,FALSE,EDIJobRoutine2); //TPZEDI

                      END;
                  UNTIL EDIJobRoutine.NEXT = 0;
              END;
              CmdCount := CmdCount + 1;
            UNTIL CmdArray[CmdCount] = '';
            COMMIT;
          END;

  }
  CODE
  {
    VAR
      EDIJob@1240020007 : Record 14050304;
      EDIJobRoutine@1240020008 : Record 14050305;
      EDIJobRoutine2@1240020010 : Record 14050305;
      CmdArray@1240020000 : ARRAY [20] OF Text[100];
      CmdCount@1240020001 : Integer;
      Char@1240020002 : Char;
      CmdCharCount@1240020003 : Integer;
      Command@1240020004 : Text[100];
      StringCharCount@1240020006 : Integer;

    BEGIN
    {
      The job queue commands are defined in the E.D.I. Job table.
      The job queue command should be started and terminated by /
      Example:  /JOBONE/
    }
    END.
  }
}

