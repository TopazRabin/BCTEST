OBJECT Codeunit 50026 Purge Whse. Receipt Job
{
  OBJECT-PROPERTIES
  {
    Date=07/01/20;
    Time=12:00:00 AM;
    Modified=Yes;
    Version List=TPZ000.00.00;
  }
  PROPERTIES
  {
    OnRun=VAR
            ReceiveLine@1000000003 : Record 14000602;
            WhseRcptLine@1000000002 : Record 7317;
            WhseRcptHeader@1000000001 : Record 7316;
            AllowToDelete@1000000000 : Boolean;
          BEGIN
            ReceiveLine.SETCURRENTKEY("Source Type","Source Subtype","Source ID","No.","Variant Code",Type,"Location Code");
            IF WhseRcptHeader.FINDSET THEN
            REPEAT
              AllowToDelete := TRUE;
              WhseRcptLine.SETRANGE("No.", WhseRcptHeader."No.");
              IF WhseRcptLine.FINDSET THEN
              REPEAT
                ReceiveLine.SETRANGE("Source Type", WhseRcptLine."Source Type"-1);
                ReceiveLine.SETRANGE("Source ID", WhseRcptLine."Source No.");
                IF ReceiveLine.ISEMPTY = FALSE THEN
                  AllowToDelete := FALSE;
              UNTIL (AllowToDelete = FALSE) OR (WhseRcptLine.NEXT = 0);

              IF AllowToDelete THEN BEGIN
                WhseRcptHeader.DELETE;
                WhseRcptLine.RESET;
                WhseRcptLine.SETRANGE("No.", WhseRcptHeader."No.");
                WhseRcptLine.DELETEALL;
              END;
            UNTIL WhseRcptHeader.NEXT = 0;
          END;

  }
  CODE
  {

    BEGIN
    END.
  }
}

