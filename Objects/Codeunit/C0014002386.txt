OBJECT Codeunit 14002386 Load E.D.I. Cross Ref. Options
{
  OBJECT-PROPERTIES
  {
    Date=09/13/16;
    Time=12:00:00 PM;
    Version List=SE0.60.12;
  }
  PROPERTIES
  {
    OnRun=BEGIN
            CreateCrossReferenceOptions(TRUE);
          END;

  }
  CODE
  {
    VAR
      Object@1000 : Record 2000000001;
      Field@1001 : Record 2000000041;
      CrossRefOptionSetup@1002 : Record 14000375;
      SalesHeader@1003 : Record 36;
      PurchaseHeader@1012 : Record 38;
      BillofLading@1013 : Record 14000822;
      EDIInventoryAdviceHeader@1014 : Record 14002413;
      TransferHeader@1015 : Record 5740;
      EDIPmtRemitAdviceLine@1240020000 : Record 14050903;
      TableRef@1004 : RecordRef;
      FieldValueRef@1005 : FieldRef;
      ObjectFitler@1007 : Text[250];
      Option@1006 : Integer;
      i@1008 : Integer;
      OptionLoaded@1009 : Boolean;
      TotalOptions@1010 : Integer;
      CrossRefOptionString@1011 : Text[250];
      Text001@1016 : TextConst 'ENU=E.D.I. General Cross Reference option fields loaded.';

    PROCEDURE CreateCrossReferenceOptions@1240020000(DisplayMessage@1240020000 : Boolean);
    BEGIN
      CrossRefOptionSetup.RESET;
      CrossRefOptionSetup.DELETEALL;
      Object.RESET;
      Object.SETRANGE(Type,Object.Type::Table);
      Object.SETRANGE("Company Name",'');
      Object.SETFILTER(
        ID,
        '36|38|5740|14000822|14002413|14050903');
      Object.FIND('-');
        REPEAT
          Field.RESET;
          Field.SETRANGE(TableNo,Object.ID);
          Field.SETRANGE(Type,Field.Type::Option);
          IF Field.FIND('-') THEN
            REPEAT
              OptionLoaded := FALSE;
              CrossRefOptionSetup.INIT;
              CrossRefOptionSetup."Table No." := Field.TableNo;
              CrossRefOptionSetup."Table Name" := Field.TableName;
              CrossRefOptionSetup."Field Name" := Field.FieldName;
              TotalOptions := 0;

              CASE Field.TableNo OF
                DATABASE::"Sales Header":
                  CASE Field."No." OF
                    SalesHeader.FIELDNO("Shipping Payment Type"):
                      BEGIN
                        OptionLoaded := TRUE;
                        OptionLoaded := TRUE;
                        TableRef.OPEN(DATABASE::"Sales Header");
                        FieldValueRef := TableRef.FIELD(14000716);
                        CrossRefOptionString := FieldValueRef.OPTIONSTRING;

                        FOR i := 1 TO STRLEN(CrossRefOptionString) DO BEGIN
                          IF CrossRefOptionString[i] = ',' THEN
                            TotalOptions := TotalOptions + 1;
                        END;
                        TotalOptions := TotalOptions + 1;

                        FOR i := 1 TO TotalOptions DO BEGIN
                          Option := i - 1;
                          CrossRefOptionSetup.Option := Option;
                          CrossRefOptionSetup."Field No." := Field."No.";
                          SalesHeader."Shipping Payment Type" := Option;
                          CrossRefOptionSetup."Option String" := FORMAT(SalesHeader."Shipping Payment Type");
                          CrossRefOptionSetup.INSERT;
                        END;
                        TableRef.CLOSE;
                      END;
                    SalesHeader.FIELDNO("Shipping Advice"):
                      BEGIN
                        OptionLoaded := TRUE;
                        TableRef.OPEN(DATABASE::"Sales Header");
                        FieldValueRef := TableRef.FIELD(5750);
                        CrossRefOptionString := FieldValueRef.OPTIONSTRING;

                        FOR i := 1 TO STRLEN(CrossRefOptionString) DO BEGIN
                          IF CrossRefOptionString[i] = ',' THEN
                            TotalOptions := TotalOptions + 1;
                        END;
                        TotalOptions := TotalOptions + 1;

                        FOR i := 1 TO TotalOptions DO BEGIN
                          Option := i - 1;
                          CrossRefOptionSetup.Option := Option;
                          CrossRefOptionSetup."Field No." := Field."No.";
                          SalesHeader."Shipping Advice" := Option;
                          CrossRefOptionSetup."Option String" := FORMAT(SalesHeader."Shipping Advice");
                          CrossRefOptionSetup.INSERT;
                        END;
                        TableRef.CLOSE;
                      END;
                    SalesHeader.FIELDNO("Applies-to Doc. Type"):
                      BEGIN
                        OptionLoaded := TRUE;
                        TableRef.OPEN(DATABASE::"Sales Header");
                        FieldValueRef := TableRef.FIELD(52);
                        CrossRefOptionString := FieldValueRef.OPTIONSTRING;

                        FOR i := 1 TO STRLEN(CrossRefOptionString) DO BEGIN
                          IF CrossRefOptionString[i] = ',' THEN
                            TotalOptions := TotalOptions + 1;
                        END;
                        TotalOptions := TotalOptions + 1;

                        FOR i := 1 TO TotalOptions DO BEGIN
                          Option := i - 1;
                          CrossRefOptionSetup.Option := Option;
                          CrossRefOptionSetup."Field No." := Field."No.";
                          SalesHeader."Applies-to Doc. Type" := Option;
                          CrossRefOptionSetup."Option String" := FORMAT(SalesHeader."Applies-to Doc. Type");
                          CrossRefOptionSetup.INSERT;
                        END;
                        TableRef.CLOSE;
                      END;
                  END;
                DATABASE::"Purchase Header":
                  CASE Field."No." OF
                    PurchaseHeader.FIELDNO("Shipping Payment Type"):
                      BEGIN
                        OptionLoaded := TRUE;
                        OptionLoaded := TRUE;
                        TableRef.OPEN(DATABASE::"Purchase Header");
                        FieldValueRef := TableRef.FIELD(14000711);
                        CrossRefOptionString := FieldValueRef.OPTIONSTRING;

                        FOR i := 1 TO STRLEN(CrossRefOptionString) DO BEGIN
                          IF CrossRefOptionString[i] = ',' THEN
                            TotalOptions := TotalOptions + 1;
                        END;
                        TotalOptions := TotalOptions + 1;

                        FOR i := 1 TO TotalOptions DO BEGIN
                          Option := i - 1;
                          CrossRefOptionSetup.Option := Option;
                          CrossRefOptionSetup."Field No." := Field."No.";
                          PurchaseHeader."Shipping Payment Type" := Option;
                          CrossRefOptionSetup."Option String" := FORMAT(PurchaseHeader."Shipping Payment Type");
                          CrossRefOptionSetup.INSERT;
                        END;
                        TableRef.CLOSE;
                     END;
                    PurchaseHeader.FIELDNO("Applies-to Doc. Type"):
                      BEGIN
                        OptionLoaded := TRUE;
                        OptionLoaded := TRUE;
                        TableRef.OPEN(DATABASE::"Purchase Header");
                        FieldValueRef := TableRef.FIELD(52);
                        CrossRefOptionString := FieldValueRef.OPTIONSTRING;

                        FOR i := 1 TO STRLEN(CrossRefOptionString) DO BEGIN
                          IF CrossRefOptionString[i] = ',' THEN
                            TotalOptions := TotalOptions + 1;
                        END;
                        TotalOptions := TotalOptions + 1;

                        FOR i := 1 TO TotalOptions DO BEGIN
                          Option := i - 1;
                          CrossRefOptionSetup.Option := Option;
                          CrossRefOptionSetup."Field No." := Field."No.";
                          PurchaseHeader."Applies-to Doc. Type" := Option;
                          CrossRefOptionSetup."Option String" := FORMAT(PurchaseHeader."Applies-to Doc. Type");
                          CrossRefOptionSetup.INSERT;
                        END;
                        TableRef.CLOSE;
                      END;
                  END;
                DATABASE::"Bill of Lading":
                  CASE Field."No." OF
                    BillofLading.FIELDNO("Shipping Payment Type"):
                      BEGIN
                        OptionLoaded := TRUE;
                        OptionLoaded := TRUE;
                        TableRef.OPEN(DATABASE::"Bill of Lading");
                        FieldValueRef := TableRef.FIELD(97);
                        CrossRefOptionString := FieldValueRef.OPTIONSTRING;

                        FOR i := 1 TO STRLEN(CrossRefOptionString) DO BEGIN
                          IF CrossRefOptionString[i] = ',' THEN
                            TotalOptions := TotalOptions + 1;
                        END;
                        TotalOptions := TotalOptions + 1;

                        FOR i := 1 TO TotalOptions DO BEGIN
                          Option := i - 1;
                          CrossRefOptionSetup.Option := Option;
                          CrossRefOptionSetup."Field No." := Field."No.";
                          BillofLading."Shipping Payment Type" := Option;
                          CrossRefOptionSetup."Option String" := FORMAT(BillofLading."Shipping Payment Type");
                          CrossRefOptionSetup.INSERT;
                        END;
                        TableRef.CLOSE;
                      END;
                  END;
                DATABASE::"E.D.I. Inventory Advice Header":
                  CASE Field."No." OF
                    EDIInventoryAdviceHeader.FIELDNO("Transaction Purpose Code"):
                      BEGIN
                        OptionLoaded := TRUE;
                        OptionLoaded := TRUE;
                        TableRef.OPEN(DATABASE::"E.D.I. Inventory Advice Header");
                        FieldValueRef := TableRef.FIELD(12);
                        CrossRefOptionString := FieldValueRef.OPTIONSTRING;

                        FOR i := 1 TO STRLEN(CrossRefOptionString) DO BEGIN
                          IF CrossRefOptionString[i] = ',' THEN
                            TotalOptions := TotalOptions + 1;
                        END;
                        TotalOptions := TotalOptions + 1;

                        FOR i := 1 TO TotalOptions DO BEGIN
                          Option := i - 1;
                          CrossRefOptionSetup.Option := Option;
                          CrossRefOptionSetup."Field No." := Field."No.";
                          EDIInventoryAdviceHeader."Transaction Purpose Code" := Option;
                          CrossRefOptionSetup."Option String" :=
                            FORMAT(EDIInventoryAdviceHeader."Transaction Purpose Code");
                          CrossRefOptionSetup.INSERT;
                        END;
                        TableRef.CLOSE;
                      END;
                  END;
                DATABASE::"Transfer Header":
                  CASE Field."No." OF
                    TransferHeader.FIELDNO("Shipping Payment Type"):
                      BEGIN
                        OptionLoaded := TRUE;
                        OptionLoaded := TRUE;
                        TableRef.OPEN(DATABASE::"Transfer Header");
                        FieldValueRef := TableRef.FIELD(14000708);
                        CrossRefOptionString := FieldValueRef.OPTIONSTRING;

                        FOR i := 1 TO STRLEN(CrossRefOptionString) DO BEGIN
                          IF CrossRefOptionString[i] = ',' THEN
                            TotalOptions := TotalOptions + 1;
                        END;
                        TotalOptions := TotalOptions + 1;

                        FOR i := 1 TO TotalOptions DO BEGIN
                          Option := i - 1;
                          CrossRefOptionSetup.Option := Option;
                          CrossRefOptionSetup."Field No." := Field."No.";
                          TransferHeader."Shipping Payment Type" := Option;
                          CrossRefOptionSetup."Option String" := FORMAT(TransferHeader."Shipping Payment Type");
                          CrossRefOptionSetup.INSERT;
                        END;
                        TableRef.CLOSE;
                      END;
                  END;
                DATABASE::"E.D.I. Pmt. Remit Advice Line":
                  CASE Field."No." OF
                    EDIPmtRemitAdviceLine.FIELDNO("Journal Applies-to Doc. Type"):
                      BEGIN
                        OptionLoaded := TRUE;
                        OptionLoaded := TRUE;
                        TableRef.OPEN(DATABASE::"E.D.I. Pmt. Remit Advice Line");
                        FieldValueRef := TableRef.FIELD(21);
                        CrossRefOptionString := FieldValueRef.OPTIONSTRING;

                        FOR i := 1 TO STRLEN(CrossRefOptionString) DO BEGIN
                          IF CrossRefOptionString[i] = ',' THEN
                            TotalOptions := TotalOptions + 1;
                        END;
                        TotalOptions := TotalOptions + 1;

                        FOR i := 1 TO TotalOptions DO BEGIN
                          Option := i - 1;
                          CrossRefOptionSetup.Option := Option;
                          CrossRefOptionSetup."Field No." := Field."No.";
                          EDIPmtRemitAdviceLine."Journal Applies-to Doc. Type" := Option;
                          CrossRefOptionSetup."Option String" :=
                            FORMAT(EDIPmtRemitAdviceLine."Journal Applies-to Doc. Type");
                          CrossRefOptionSetup.INSERT;
                        END;
                        TableRef.CLOSE;
                      END;
                  END;
               END;
            UNTIL Field.NEXT = 0;
        UNTIL Object.NEXT = 0;
      IF DisplayMessage THEN
        MESSAGE(Text001);
    END;

    BEGIN
    END.
  }
}

