OBJECT Codeunit 14123652 ES Autostart Recording
{
  OBJECT-PROPERTIES
  {
    Date=02/18/11;
    Time=12:00:00 PM;
    Version List=ES1.00.64;
  }
  PROPERTIES
  {
    OnRun=BEGIN
            AutostartRecording;
          END;

  }
  CODE
  {

    PROCEDURE AutostartRecording@1240520008();
    VAR
      ESLoginSetup@1240520008 : Record 14123540;
      ESRecording@1240520009 : Record 14123651;
      ESSecuritySetup@1240520011 : Record 14123521;
      ESRecordPermissionsAuto@1240520010 : Page 14123661;
    BEGIN
      IF NOT GUIALLOWED OR ISSERVICETIER THEN
        EXIT;

      IF NOT ESSecuritySetup.READPERMISSION THEN
        EXIT;

      IF NOT ESLoginSetup.READPERMISSION THEN
        EXIT;

      IF NOT ESSecuritySetup.GET THEN
        EXIT;

      IF NOT ESLoginSetup.GET(USERID) THEN
        EXIT;

      IF NOT ESLoginSetup."Autostart Recording" THEN
        EXIT;

      IF ESLoginSetup."Autostart Recording Code" = '' THEN BEGIN
        ESRecording.INIT;
        ESRecording.INSERT(TRUE);

        COMMIT;
      END ELSE
        ESRecording.GET(ESLoginSetup."Autostart Recording Code");

      CLEAR(ESRecordPermissionsAuto);
      ESRecordPermissionsAuto.LOOKUPMODE(TRUE);
      ESRecordPermissionsAuto.InitValues(ESRecording);
      ESRecordPermissionsAuto.RUN;
    END;

    BEGIN
    END.
  }
}

