OBJECT Codeunit 50041 LastSalesPriceUpdate
{
  OBJECT-PROPERTIES
  {
    Date=07/01/20;
    Time=12:00:00 AM;
    Modified=Yes;
    Version List=TPZ000.00.00;
  }
  PROPERTIES
  {
    OnRun=BEGIN
            //<TPZ1934>
            UpdateLastSalePrice('1000','1000-1');
            //</TPZ1934>
          END;

  }
  CODE
  {

    PROCEDURE UpdateLastSalePrice@1000000001(FromItemNo@1000000000 : Code[20];ToItemNo@1000000001 : Code[20]);
    VAR
      LastSalesPrice@1000000002 : Record 50004;
      FromLastSalesPrice@1000000003 : Record 50004;
      ToLastSalesPrice@1000000004 : Record 50004;
    BEGIN
      //<TPZ1934>
      IF FromItemNo ='' THEN
        ERROR('From Item should not be blank..!');
      IF ToItemNo ='' THEN
        ERROR('To Item should not be blank..!');

      LastSalesPrice.RESET;
      LastSalesPrice.SETRANGE("Item No.",FromItemNo);
      IF LastSalesPrice.FINDSET THEN BEGIN
        REPEAT
          FromLastSalesPrice.RESET;
          IF FromLastSalesPrice.GET(LastSalesPrice."Document Type",LastSalesPrice."Document No.",LastSalesPrice."Sell-to Customer No.",
              LastSalesPrice."Item No.",LastSalesPrice."Unit of Measure Code") THEN BEGIN

            ToLastSalesPrice.INIT;
            ToLastSalesPrice.TRANSFERFIELDS(LastSalesPrice);
            ToLastSalesPrice."Item No." := ToItemNo;
            ToLastSalesPrice."Old Item No." := FromItemNo;
            ToLastSalesPrice.INSERT;
            FromLastSalesPrice.DELETE(TRUE);
          END;
        UNTIL LastSalesPrice.NEXT=0;
      END;
      //</TPZ1934>
    END;

    BEGIN
    {
      2017-08-23 TPZ1934 DKUMAR
        Merge E & Non-E Items Last Sales Prices
    }
    END.
  }
}

