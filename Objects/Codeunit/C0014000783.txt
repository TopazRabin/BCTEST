OBJECT Codeunit 14000783 FedEx Transaction Select
{
  OBJECT-PROPERTIES
  {
    Date=06/28/17;
    Time=12:00:00 PM;
    Version List=SE0.60;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {
    VAR
      ShippingSetup@1240030000 : Record 14000707;
      FedEx621001@1240030001 : Codeunit 14000781;
      FedEx680003@1240030002 : Codeunit 14000782;
      FedExWS@1240030004 : Codeunit 14000787;
      ShippingSetupRetrieved@1240030003 : Boolean;

    PROCEDURE GlobalRegistrationRequest@1(VAR CurrentFedExGlobalRegistration@1240030000 : Record 14000786);
    BEGIN
      GetShippingSetup;

      CASE ShippingSetup."FedEx API Version" OF
        ShippingSetup."FedEx API Version"::"6.21.001":
          FedEx621001.GlobalRegistrationRequest(CurrentFedExGlobalRegistration);
        ShippingSetup."FedEx API Version"::"6.80.003":
          FedEx680003.GlobalRegistrationRequest(CurrentFedExGlobalRegistration);
        ShippingSetup."FedEx API Version"::"Web Services":
          FedExWS.GlobalRegistrationRequest(CurrentFedExGlobalRegistration);
      END;
    END;

    PROCEDURE GetShippingCharge@12(VAR CurrentPackage@1240030000 : Record 14000701;GiveNoError@1240030001 : Boolean);
    BEGIN
      GetShippingSetup;

      CASE ShippingSetup."FedEx API Version" OF
        ShippingSetup."FedEx API Version"::"6.21.001":
          FedEx621001.GetShippingCharge(CurrentPackage,GiveNoError);
        ShippingSetup."FedEx API Version"::"6.80.003":
          FedEx680003.GetShippingCharge(CurrentPackage,GiveNoError);
        ShippingSetup."FedEx API Version"::"Web Services":
          FedExWS.GetShippingCharge(CurrentPackage,GiveNoError);
      END
    END;

    PROCEDURE RateShop@14(RateShopHeader@1240030000 : Record 14000741;VAR RateShopLine@1240030001 : Record 14000742;CurrentShippingAgentService@1240030002 : Record 14000708);
    BEGIN
      GetShippingSetup;

      CASE ShippingSetup."FedEx API Version" OF
        ShippingSetup."FedEx API Version"::"6.21.001":
          FedEx621001.RateShop(RateShopHeader,RateShopLine,CurrentShippingAgentService);
        ShippingSetup."FedEx API Version"::"6.80.003":
          FedEx680003.RateShop(RateShopHeader,RateShopLine,CurrentShippingAgentService);
        ShippingSetup."FedEx API Version"::"Web Services":
          FedExWS.RateShop(RateShopHeader,RateShopLine,CurrentShippingAgentService);
      END
    END;

    PROCEDURE ClosePackage@7(VAR CurrentPackage@1240030000 : Record 14000701;VAR MultiDocPackageTmp@1240030001 : Record 14000701;CurrentShippingAgent@1240030002 : Record 291;PrintLabel@1240030003 : Boolean);
    VAR
      FedExOptionPage@1240020000 : Record 14000781;
      FedExOptionPageExt@1240020001 : Record 14000793;
    BEGIN
      GetShippingSetup;
      FedExOptionPage.GET(FedExOptionPage.Type::Package,CurrentPackage."No.",0,0);
      FedExOptionPageExt.GET(FedExOptionPageExt.Type::Package,CurrentPackage."No.",0,0);

      CASE ShippingSetup."FedEx API Version" OF
        ShippingSetup."FedEx API Version"::"6.21.001":
          FedEx621001.ClosePackage(CurrentPackage,MultiDocPackageTmp,CurrentShippingAgent,PrintLabel);
        ShippingSetup."FedEx API Version"::"6.80.003":
          FedEx680003.ClosePackage(CurrentPackage,MultiDocPackageTmp,CurrentShippingAgent,PrintLabel);
        ShippingSetup."FedEx API Version"::"Web Services":
          BEGIN
            FedExWS.ClosePackage(CurrentPackage,MultiDocPackageTmp,CurrentShippingAgent,PrintLabel);
            IF FedExOptionPage."Ship and Return Label" THEN BEGIN
              FedExWS.CreateReturnLabelPackage(CurrentPackage,FedExOptionPage,
                FedExOptionPageExt,MultiDocPackageTmp,CurrentShippingAgent,PrintLabel);
              FedExWS.ClosePackage(CurrentPackage,MultiDocPackageTmp,CurrentShippingAgent,PrintLabel);
            END;
          END;
      END
    END;

    PROCEDURE OpenPackage@16(VAR CurrentPackage@1240030000 : Record 14000701);
    BEGIN
      GetShippingSetup;

      CASE ShippingSetup."FedEx API Version" OF
        ShippingSetup."FedEx API Version"::"6.21.001":
          FedEx621001.OpenPackage(CurrentPackage);
        ShippingSetup."FedEx API Version"::"6.80.003":
          FedEx680003.OpenPackage(CurrentPackage);
        ShippingSetup."FedEx API Version"::"Web Services":
          FedExWS.OpenPackage(CurrentPackage);
      END
    END;

    PROCEDURE ReOpenPostedPackage@50(VAR CurrentPostedPackage@1240030000 : Record 14000704);
    BEGIN
      GetShippingSetup;

      CASE ShippingSetup."FedEx API Version" OF
        ShippingSetup."FedEx API Version"::"6.21.001":
          FedEx621001.ReOpenPostedPackage(CurrentPostedPackage);
        ShippingSetup."FedEx API Version"::"6.80.003":
          FedEx680003.ReOpenPostedPackage(CurrentPostedPackage);
        ShippingSetup."FedEx API Version"::"Web Services":
          FedExWS.ReOpenPostedPackage(CurrentPostedPackage);
      END
    END;

    PROCEDURE PrintPackageLabel@20(VAR CurrentPackage@1240030000 : Record 14000701);
    BEGIN
      GetShippingSetup;

      CASE ShippingSetup."FedEx API Version" OF
        ShippingSetup."FedEx API Version"::"6.21.001":
          FedEx621001.PrintPackageLabel(CurrentPackage);
        ShippingSetup."FedEx API Version"::"6.80.003":
          FedEx680003.PrintPackageLabel(CurrentPackage);
        ShippingSetup."FedEx API Version"::"Web Services":
          FedExWS.PrintPackageLabel(CurrentPackage);
      END
    END;

    PROCEDURE RePrintPostedPackageLabel@21(VAR CurrentPostedPackage@1240030000 : Record 14000704);
    BEGIN
      GetShippingSetup;

      CASE ShippingSetup."FedEx API Version" OF
        ShippingSetup."FedEx API Version"::"6.21.001":
          FedEx621001.RePrintPostedPackageLabel(CurrentPostedPackage);
        ShippingSetup."FedEx API Version"::"6.80.003":
          FedEx680003.RePrintPostedPackageLabel(CurrentPostedPackage);
        ShippingSetup."FedEx API Version"::"Web Services":
          FedExWS.RePrintPostedPackageLabel(CurrentPostedPackage);
      END
    END;

    PROCEDURE CreateManifest@49(CurrentShippingAgentAccount@1240030000 : Record 14000788);
    BEGIN
      GetShippingSetup;

      CASE ShippingSetup."FedEx API Version" OF
        ShippingSetup."FedEx API Version"::"6.21.001":
          FedEx621001.CreateManifest(CurrentShippingAgentAccount);
        ShippingSetup."FedEx API Version"::"6.80.003":
          FedEx680003.CreateManifest(CurrentShippingAgentAccount);
        ShippingSetup."FedEx API Version"::"Web Services":
          FedExWS.CreateManifest(CurrentShippingAgentAccount);
      END
    END;

    PROCEDURE CloseManifest@47(VAR CurrentManifestHeader@1240030000 : Record 14000712);
    BEGIN
      GetShippingSetup;

      CASE ShippingSetup."FedEx API Version" OF
        ShippingSetup."FedEx API Version"::"6.21.001":
          FedEx621001.CloseManifest(CurrentManifestHeader);
        ShippingSetup."FedEx API Version"::"6.80.003":
          FedEx680003.CloseManifest(CurrentManifestHeader);
        ShippingSetup."FedEx API Version"::"Web Services":
          FedExWS.CloseManifest(CurrentManifestHeader);
      END
    END;

    PROCEDURE OpenManifest@48(VAR CurrentManifestHeader@1240030000 : Record 14000712);
    BEGIN
      GetShippingSetup;

      CASE ShippingSetup."FedEx API Version" OF
        ShippingSetup."FedEx API Version"::"6.21.001":
          FedEx621001.OpenManifest(CurrentManifestHeader);
        ShippingSetup."FedEx API Version"::"6.80.003":
          FedEx680003.OpenManifest(CurrentManifestHeader);
        ShippingSetup."FedEx API Version"::"Web Services":
          FedExWS.OpenManifest(CurrentManifestHeader);
      END
    END;

    LOCAL PROCEDURE GetShippingSetup@33();
    BEGIN
      IF NOT ShippingSetupRetrieved THEN BEGIN
        ShippingSetup.GET;
        ShippingSetupRetrieved := TRUE;
      END;
    END;

    PROCEDURE TrackPackage@1240030001(CurrentPackage@1240030000 : Record 14000701);
    BEGIN
      GetShippingSetup;

      CASE ShippingSetup."FedEx API Version" OF
        ShippingSetup."FedEx API Version"::"6.21.001":
          FedEx621001.TrackPackage(CurrentPackage);
        ShippingSetup."FedEx API Version"::"6.80.003":
          FedEx680003.TrackPackage(CurrentPackage);
        ShippingSetup."FedEx API Version"::"Web Services":
          FedExWS.TrackPackage(CurrentPackage);
      END
    END;

    PROCEDURE CheckName@1240030019(ShippingAgent@1240030010 : Record 291;FromType@1240030004 : 'Package,Document,Master Data';VAR Name@1240030001 : Text[100];VAR Name2@1240030002 : Text[100];VAR Contact@1240030005 : Text[100];NameCaption@1240030009 : Text[100];Name2Caption@1240030008 : Text[100];ContactCaption@1240030000 : Text[100]);
    BEGIN
      CASE ShippingSetup."FedEx API Version" OF
        ShippingSetup."FedEx API Version"::"6.21.001":
          FedEx621001.CheckName(
            ShippingAgent,FromType,Name,Name2,Contact,
            NameCaption,Name2Caption,ContactCaption);
        ShippingSetup."FedEx API Version"::"6.80.003":
          FedEx680003.CheckName(
            ShippingAgent,FromType,Name,Name2,Contact,
            NameCaption,Name2Caption,ContactCaption);
        ShippingSetup."FedEx API Version"::"Web Services":
          FedExWS.CheckName(
            ShippingAgent,FromType,Name,Name2,Contact,
            NameCaption,Name2Caption,ContactCaption);
      END
    END;

    PROCEDURE CheckAddress@1240030000(ShippingAgent@1240030010 : Record 291;FromType@1240030014 : 'Package,Document,Master Data';VAR Address@1240030012 : Text[100];VAR Address2@1240030011 : Text[100];VAR City@1240030009 : Text[100];VAR PostCode@1240030008 : Code[100];VAR State@1240030007 : Text[100];VAR Country@1240030006 : Code[100];AddressCaption@1240030005 : Text[100];Address2Caption@1240030004 : Text[100];CityCaption@1240030003 : Text[100];PostCodeCaption@1240030002 : Text[100];StateCaption@1240030001 : Text[100];CountryCaption@1240030000 : Text[100]);
    BEGIN
      CASE ShippingSetup."FedEx API Version" OF
        ShippingSetup."FedEx API Version"::"6.21.001":
          FedEx621001.CheckAddress(
            ShippingAgent,FromType,Address,Address2,City,PostCode,State,Country,
            AddressCaption,Address2Caption,CityCaption,PostCodeCaption,StateCaption,CountryCaption);
        ShippingSetup."FedEx API Version"::"6.80.003":
          FedEx680003.CheckAddress(
            ShippingAgent,FromType,Address,Address2,City,PostCode,State,Country,
            AddressCaption,Address2Caption,CityCaption,PostCodeCaption,StateCaption,CountryCaption);
        ShippingSetup."FedEx API Version"::"Web Services":
          FedExWS.CheckAddress(
            ShippingAgent,FromType,Address,Address2,City,PostCode,State,Country,
            AddressCaption,Address2Caption,CityCaption,PostCodeCaption,StateCaption,CountryCaption);
      END
    END;

    BEGIN
    END.
  }
}

