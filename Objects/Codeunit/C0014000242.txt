OBJECT Codeunit 14000242 EShip Shipment Header - Edit
{
  OBJECT-PROPERTIES
  {
    Date=07/13/20;
    Time=12:00:00 PM;
    Version List=SE0.62;
  }
  PROPERTIES
  {
    Permissions=TableData 110=m,
                TableData 112=m,
                TableData 120=m,
                TableData 122=m,
                TableData 124=m,
                TableData 5744=m,
                TableData 6650=m;
    OnRun=BEGIN
          END;

  }
  CODE
  {
    VAR
      SalesShptHeader@1240020000 : Record 110;

    PROCEDURE SalesInvoiceHeaderEdit@14000701(SalesInvoiceHeader@14000700 : Record 112);
    VAR
      SalesInvoiceHeader2@14000701 : Record 112;
    BEGIN
      SalesInvoiceHeader2 := SalesInvoiceHeader;
      SalesInvoiceHeader2.LOCKTABLE;
      SalesInvoiceHeader2.FIND;

      SalesInvoiceHeader2."E-Mail Invoice Notice Handled" :=
        SalesInvoiceHeader."E-Mail Invoice Notice Handled";
      SalesInvoiceHeader2."Invoice for Bill of Lading No." :=
        SalesInvoiceHeader."Invoice for Bill of Lading No.";
      SalesInvoiceHeader2."Invoice for Shipment No." :=
        SalesInvoiceHeader."Invoice for Shipment No.";

      SalesInvoiceHeader2.MODIFY;
      SalesInvoiceHeader := SalesInvoiceHeader2;
    END;

    PROCEDURE BillOfLadingSalesShipmentHdr@14000702(CurrentSalesShipmentHeader@14000700 : Record 110;BillOfLadingNo@14000701 : Code[20]);
    VAR
      PostedPackage@14000702 : Record 14000704;
      BillOfLadingLine@14000703 : Record 14000823;
    BEGIN
      SalesShptHeader.GET(CurrentSalesShipmentHeader."No.");
      SalesShptHeader.VALIDATE("Bill of Lading No.",BillOfLadingNo);
      SalesShptHeader.MODIFY;

      BillOfLadingLine.LOCKTABLE;

      PostedPackage.RESET;
      PostedPackage.SETCURRENTKEY("Source Type","Source Subtype","Posted Source ID");
      PostedPackage.SETRANGE("Source Type",DATABASE::"Sales Header");
      PostedPackage.SETRANGE("Posted Source ID",CurrentSalesShipmentHeader."No.");
      PostedPackage.MODIFYALL(
        "Used on Bill of Lading No.",BillOfLadingNo,TRUE);
    END;

    PROCEDURE PurchaseReceiptHeaderEdit@14000703(PurchReceiptHeader@14000700 : Record 120);
    VAR
      PurchReceiptHeader2@14000701 : Record 120;
    BEGIN
      PurchReceiptHeader2 := PurchReceiptHeader;
      PurchReceiptHeader2.LOCKTABLE;
      PurchReceiptHeader2.FIND;

      PurchReceiptHeader2."E-Mail Receipt Notice Handled" :=
        PurchReceiptHeader."E-Mail Receipt Notice Handled";

      PurchReceiptHeader2.MODIFY;
      PurchReceiptHeader := PurchReceiptHeader2;
    END;

    PROCEDURE PurchaseInvoiceHeaderEdit@14000704(PurchInvoiceHeader@14000700 : Record 122);
    VAR
      PurchInvoiceHeader2@14000701 : Record 122;
    BEGIN
      PurchInvoiceHeader2 := PurchInvoiceHeader;
      PurchInvoiceHeader2.LOCKTABLE;
      PurchInvoiceHeader2.FIND;

      PurchInvoiceHeader2."E-Mail Invoice Notice Handled" :=
        PurchInvoiceHeader."E-Mail Invoice Notice Handled";

      PurchInvoiceHeader2.MODIFY;
      PurchInvoiceHeader := PurchInvoiceHeader2;
    END;

    PROCEDURE BillOfLadingPurchCrMemo@14000705(CurrentPurchCrMemoHeader@14000700 : Record 124;BillOfLadingNo@14000701 : Code[20]);
    VAR
      PurchCrMemoHeader@14000702 : Record 124;
      PostedPackage@14000703 : Record 14000704;
      BillOfLadingLine@14000704 : Record 14000823;
    BEGIN
      PurchCrMemoHeader.GET(CurrentPurchCrMemoHeader."No.");
      PurchCrMemoHeader.VALIDATE("Bill of Lading No.",BillOfLadingNo);
      PurchCrMemoHeader.MODIFY;

      BillOfLadingLine.LOCKTABLE;

      PostedPackage.RESET;
      PostedPackage.SETCURRENTKEY("Source Type","Source Subtype","Posted Source ID");
      PostedPackage.SETRANGE("Source Type",DATABASE::"Purchase Header");
      PostedPackage.SETRANGE("Posted Source ID",CurrentPurchCrMemoHeader."No.");
      PostedPackage.MODIFYALL(
        "Used on Bill of Lading No.",BillOfLadingNo,TRUE);
    END;

    PROCEDURE BillOfLadingReturnShipment@14000706(CurrentReturnShipmentHeader@14000700 : Record 6650;BillOfLadingNo@14000701 : Code[20]);
    VAR
      ReturnShipmentHeader@14000702 : Record 6650;
      PostedPackage@14000703 : Record 14000704;
      BillOfLadingLine@14000704 : Record 14000823;
    BEGIN
      ReturnShipmentHeader.GET(CurrentReturnShipmentHeader."No.");
      ReturnShipmentHeader.VALIDATE("Bill of Lading No.",BillOfLadingNo);
      ReturnShipmentHeader.MODIFY;

      BillOfLadingLine.LOCKTABLE;

      PostedPackage.RESET;
      PostedPackage.SETCURRENTKEY("Source Type","Source Subtype","Posted Source ID");
      PostedPackage.SETRANGE("Source Type",DATABASE::"Purchase Header");
      PostedPackage.SETRANGE("Posted Source ID",CurrentReturnShipmentHeader."No.");
      PostedPackage.MODIFYALL(
        "Used on Bill of Lading No.",BillOfLadingNo,TRUE);
    END;

    PROCEDURE BillOfLadingTransferShipment@14000707(CurrentTransferShipmentHeader@14000700 : Record 5744;BillOfLadingNo@14000701 : Code[20]);
    VAR
      TransferShipmentHeader@14000702 : Record 5744;
      PostedPackage@14000703 : Record 14000704;
      BillOfLadingLine@14000704 : Record 14000823;
    BEGIN
      TransferShipmentHeader.GET(CurrentTransferShipmentHeader."No.");
      TransferShipmentHeader.VALIDATE("Bill of Lading No.",BillOfLadingNo);
      TransferShipmentHeader.MODIFY;

      BillOfLadingLine.LOCKTABLE;

      PostedPackage.RESET;
      PostedPackage.SETCURRENTKEY("Source Type","Source Subtype","Posted Source ID");
      PostedPackage.SETRANGE("Source Type",DATABASE::"Transfer Header");
      PostedPackage.SETRANGE("Posted Source ID",CurrentTransferShipmentHeader."No.");
      PostedPackage.MODIFYALL(
        "Used on Bill of Lading No.",BillOfLadingNo,TRUE);
    END;

    BEGIN
    {
      Codeunit for E-Ship Shipment Header Edit functions formerly in codeunit 391 - Shipment Header - Edit
      Created on 09/01/16 at 3:35:26 PM
      Permissions updated to equal that of codeunit 391 7/25/17.
    }
    END.
  }
}

