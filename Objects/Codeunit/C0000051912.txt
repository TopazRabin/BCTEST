OBJECT Codeunit 51912 Codeunit5777EventSubscriber
{
  OBJECT-PROPERTIES
  {
    Date=07/01/20;
    Time=12:00:00 AM;
    Modified=Yes;
    Version List=NAVEVENT;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {
    VAR
      Text000@1000000002 : TextConst 'ENU="must not be changed when a %1 for this %2 exists: ";ESM="no debe cambiarse cuando existe %1 para este %2. ";FRC="ne peut pas �tre modifi�(e) lorsqu''il existe un(e) %1 pour ce/cette %2 : ";ENC="must not be changed when a %1 for this %2 exists: "';
      Text001@1000000001 : TextConst 'ENU=The %1 cannot be deleted when a related %2 exists.;ESM=El %1 no se puede eliminar porque existe un %2 relacionado.;FRC=Impossible de supprimer le %1 lorsqu''il existe un %2 reli�.;ENC=The %1 cannot be deleted when a related %2 exists.';
      Text002@1000000000 : TextConst 'ENU=You cannot post consumption for order no. %1 because a quantity of %2 remains to be picked.;ESM=No puede realizar el registro para el pedido n� %1 porque permanece una cantidad de %2 para preparar.;FRC=Vous ne pouvez pas reporter la consommation pour la commande n� %1 car il reste une quantit� de %2 � pr�lever.;ENC=You cannot post consumption for order no. %1 because a quantity of %2 remains to be picked.';
      TableCaptionValue@1000000003 : Text[100];

    PROCEDURE SalesLineBufferVerifyChange@1000000001(VAR NewSalesLine@1000 : Record 50006;VAR OldSalesLine@1001 : Record 50006);
    VAR
      WhseValidateSourceLine@1000000000 : Codeunit 5777;
    BEGIN
      WITH NewSalesLine DO
        IF WhseValidateSourceLine.WhseLinesExist(
             DATABASE::"Sales Line",
             "Document Type",
             "Document No.",
             "Line No.",
             0,
             Quantity)
        THEN BEGIN
          IF Type <> OldSalesLine.Type THEN
            FIELDERROR(
              Type,
              STRSUBSTNO(Text000,
                TableCaptionValue,
                TABLECAPTION));

          IF "No." <> OldSalesLine."No." THEN
            FIELDERROR(
              "No.",
              STRSUBSTNO(Text000,
                TableCaptionValue,
                TABLECAPTION));

          IF "Variant Code" <> OldSalesLine."Variant Code" THEN
            FIELDERROR(
              "Variant Code",
              STRSUBSTNO(Text000,
                TableCaptionValue,
                TABLECAPTION));

          IF "Location Code" <> OldSalesLine."Location Code" THEN
            FIELDERROR(
              "Location Code",
              STRSUBSTNO(Text000,
                TableCaptionValue,
                TABLECAPTION));

          IF "Unit of Measure Code" <> OldSalesLine."Unit of Measure Code" THEN
            FIELDERROR(
              "Unit of Measure Code",
              STRSUBSTNO(Text000,
                TableCaptionValue,
                TABLECAPTION));

          IF "Drop Shipment" <> OldSalesLine."Drop Shipment" THEN
            FIELDERROR(
              "Drop Shipment",
              STRSUBSTNO(Text000,
                TableCaptionValue,
                TABLECAPTION));

          IF "Purchase Order No." <> OldSalesLine."Purchase Order No." THEN
            FIELDERROR(
              "Purchase Order No.",
              STRSUBSTNO(Text000,
                TableCaptionValue,
                TABLECAPTION));

          IF "Purch. Order Line No." <> OldSalesLine."Purch. Order Line No." THEN
            FIELDERROR(
              "Purch. Order Line No.",
              STRSUBSTNO(Text000,
                TableCaptionValue,
                TABLECAPTION));

          IF "Job No." <> OldSalesLine."Job No." THEN
            FIELDERROR(
              "Job No.",
              STRSUBSTNO(Text000,
                TableCaptionValue,
                TABLECAPTION));
          //TM BEG 070215 - Comment out to allow changing qty.
          {
          IF Quantity <> OldSalesLine.Quantity THEN
            FIELDERROR(
              Quantity,
              STRSUBSTNO(Text000,
                TableCaptionValue,
                TABLECAPTION));
          IF "Qty. to Ship" <> OldSalesLine."Qty. to Ship" THEN
            FIELDERROR(
              "Qty. to Ship",
              STRSUBSTNO(Text000,
                TableCaptionValue,
                TABLECAPTION));
          }
          //TM END 070215

          IF "Qty. to Assemble to Order" <> OldSalesLine."Qty. to Assemble to Order" THEN
            FIELDERROR(
              "Qty. to Assemble to Order",
              STRSUBSTNO(Text000,
                TableCaptionValue,
                TABLECAPTION));

          IF "Shipment Date" <> OldSalesLine."Shipment Date" THEN
            FIELDERROR(
              "Shipment Date",
              STRSUBSTNO(Text000,
                TableCaptionValue,
                TABLECAPTION));
        END;
    END;

    BEGIN
    {
      2020-05-26  TPZ2830  PSHUKLA
    }
    END.
  }
}

