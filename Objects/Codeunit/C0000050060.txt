OBJECT Codeunit 50060 Transfer Custom Quote
{
  OBJECT-PROPERTIES
  {
    Date=07/01/20;
    Time=12:00:00 AM;
    Modified=Yes;
    Version List=TPZ000.00.00;
  }
  PROPERTIES
  {
    TableNo=50005;
    OnRun=BEGIN
            IF NOT CONFIRM('Do you want to create custom quote to sales quote') THEN
              EXIT;
            SalesReceivablesSetup.GET;
            NoSeriesCode  := NoSeriesManagement.GetNextNo(SalesReceivablesSetup."Quote Nos.",WORKDATE,TRUE);

            SalesHeader.INIT;
            SalesHeader.TRANSFERFIELDS(Rec);
            SalesHeader."No." := NoSeriesCode;
            SalesHeader.INSERT;

            SalesLineBuffer.RESET;
            SalesLineBuffer.SETRANGE("Document No.","No.");
            IF SalesLineBuffer.FINDSET THEN
              REPEAT
                SalesLine.INIT;
                SalesLine.TRANSFERFIELDS(SalesLineBuffer);
                SalesLine."Document No." := NoSeriesCode;
                SalesLine.INSERT;
                UNTIL SalesLineBuffer.NEXT = 0;
            MESSAGE('Sales quote %1 has been created',NoSeriesCode);
          END;

  }
  CODE
  {
    VAR
      SalesHeader@1000000000 : Record 36;
      SalesLine@1000000001 : Record 37;
      SalesLineBuffer@1000000002 : Record 50006;
      SalesReceivablesSetup@1000000003 : Record 311;
      NoSeriesManagement@1000000004 : Codeunit 396;
      NoSeriesCode@1000000005 : Code[20];
      NoSeries@1000000006 : Record 308;

    BEGIN
    {
      2019-01-17 TPZ2417 AKUMAR
      Created new object.
    }
    END.
  }
}

