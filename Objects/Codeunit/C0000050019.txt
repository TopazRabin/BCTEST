OBJECT Codeunit 50019 Create VBC- Temp
{
  OBJECT-PROPERTIES
  {
    Date=07/01/20;
    Time=12:00:00 AM;
    Modified=Yes;
    Version List=UBP-TEMP;
  }
  PROPERTIES
  {
    OnRun=VAR
            PUC@1000000000 : Record 14000555;
            VendBuyingCalendar@1000000001 : Record 14000563;
            Vendor@1000000002 : Record 23;
            LeadTimeDays@1000000003 : Integer;
            LeadTimeDate@1000000004 : Date;
            InvMgtSetup@1000000005 : Record 14000551;
          BEGIN
            // Creating Vendor Buying Calendar
            PUC.SETRANGE("Replenishment Source Type", PUC."Replenishment Source Type"::Vendor);
            PUC.SETFILTER("Replenishment Source Code", '<>%1', PUC."Replenishment Source Code");
            IF PUC.FIND('-') THEN BEGIN
              REPEAT
                 IF NOT VendBuyingCalendar.GET(PUC."Replenishment Source Code",PUC."Location Code") THEN BEGIN
                   IF Vendor.GET(PUC."Replenishment Source Code") THEN BEGIN
                      VendBuyingCalendar.INIT;
                      VendBuyingCalendar."Vendor No." := PUC."Replenishment Source Code";
                      VendBuyingCalendar."Location Code" := PUC."Location Code";
                      VendBuyingCalendar."Line Buy Vendor" := TRUE;
                      InvMgtSetup.GET;
                      VendBuyingCalendar."Frozen Review Cycle (Days)" := InvMgtSetup."Def. Vend. Review Cycle (Days)";
                      VendBuyingCalendar."Review Cycle (Days)" := VendBuyingCalendar."Frozen Review Cycle (Days)";
                      IF (FORMAT(Vendor."Lead Time Calculation") <> '') THEN BEGIN
                        LeadTimeDate := CALCDATE(Vendor."Lead Time Calculation", WORKDATE);
                        VendBuyingCalendar."Frozen Lead Time (Days)" := LeadTimeDate - WORKDATE;
                        VendBuyingCalendar.INSERT;
                      END;
                   END;
                 END;
              UNTIL PUC.NEXT = 0;
            END;
          END;

  }
  CODE
  {

    BEGIN
    END.
  }
}

