OBJECT Codeunit 14050303 E.D.I. Process P.O. Change Job
{
  OBJECT-PROPERTIES
  {
    Date=03/06/15;
    Time=12:00:00 PM;
    Version List=SE0.60.06;
  }
  PROPERTIES
  {
    TableNo=14002358;
    OnRun=BEGIN
            EDIRecDocHdr.GET("Internal Doc. No.");
              WITH EDIRecDocHdr DO BEGIN
                CASE "EDI Document No." OF
                  '850','860','875','876','ORDERS','ORDCHG':
                    CASE "PO Change Purpose Code" OF
                      '06','07','6','7','22','23','29':
                        ERROR(Text001,"PO Change Purpose Code");
                      '01','02','03','04','05','1','2','3','4','5','17','20','21','36','R':
                        BEGIN
                          EDIDocument.GET(
                            "Trade Partner No.","Navision Document","EDI Document No.","EDI Version",
                            EDIDocument.Type::Import);
                          IF SalesDocumentChange.EvaluateChange(EDIRecDocHdr,EDIDocument) THEN
                            COMMIT;
                        END;
                    END;
                END;
              END;
          END;

  }
  CODE
  {
    VAR
      EDIRecDocHdr@1240020001 : Record 14002358;
      EDIDocument@1240020003 : Record 14002353;
      SalesDocumentChange@1240020002 : Codeunit 14002408;
      Text001@1240020004 : TextConst 'ENU=Transaction Set Purpose Code %1 not currently supported.';

    BEGIN
    END.
  }
}

