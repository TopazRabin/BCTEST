OBJECT Codeunit 51861 Page144EventSubscriber
{
  OBJECT-PROPERTIES
  {
    Date=07/01/20;
    Time=12:00:00 AM;
    Modified=Yes;
    Version List=NAVEVENT,TPZ2829;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {

    [EventSubscriber(Page,144,OnBeforeActionEvent,Action1000000002)]
    PROCEDURE Pg144_ChangeLogEntries_OnAction@1000000021(VAR Rec@1000000000 : Record 114);
    VAR
      ChangeLogEntry@1000000001 : Record 405;
    BEGIN

      WITH Rec DO BEGIN
        // <TPZ129>
        ChangeLogEntry.RESET;
        ChangeLogEntry.SETRANGE("Table No.",DATABASE::"Sales Header");
        IF "Return Order No." <> '' THEN BEGIN
          ChangeLogEntry.SETRANGE("Primary Key Field 1 Value",'5');
          ChangeLogEntry.SETRANGE("Primary Key Field 2 Value","Return Order No.");
        END ELSE BEGIN
          ChangeLogEntry.SETRANGE("Primary Key Field 1 Value",'3');
          ChangeLogEntry.SETRANGE("Primary Key Field 2 Value","No.");
        END;
        PAGE.RUNMODAL(PAGE::"Change Log Entries",ChangeLogEntry);
        // </TPZ129>
      END;
    END;

    [EventSubscriber(Page,144,OnBeforeActionEvent,"E-Mail")]
    PROCEDURE Pg144_Email_OnAction@1000000024(VAR Rec@1000000000 : Record 114);
    VAR
      EMailMgt@1000000001 : Codeunit 14000903;
    BEGIN
      //SHAIL
      Rec.TESTFIELD("E-Mail Cr. Memo Notice Handled",FALSE);

      EMailMgt.SendSalesCrMemoNotice(Rec,TRUE,FALSE);
      //SHAIL
    END;

    BEGIN
    END.
  }
}

