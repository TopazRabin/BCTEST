OBJECT Codeunit 51953 Page459EventSubscriber
{
  OBJECT-PROPERTIES
  {
    Date=07/01/20;
    Time=12:00:00 AM;
    Modified=Yes;
    Version List=NAVEVENT,TPZ2829;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {

    [EventSubscriber(Page,459,OnBeforeActionEvent,Action1000000016)]
    LOCAL PROCEDURE Pg459_Import_OnAction@1000000000(VAR Rec@1000000000 : Record 311);
    VAR
      TempBlob@1000000003 : Record 99008535;
      FileMgt@1000000002 : Codeunit 419;
      AppTemplateExists@1000000001 : Boolean;
      Text002@1000000005 : TextConst 'ENU=Do you want to replace the existing %1?;ESM=¨Desea sustituir la %1 existente?;FRC=Souhaitez-vous remplacer le %1 existantÿ?;ENC=Do you want to replace the existing %1?';
    BEGIN
      WITH Rec DO BEGIN
        CALCFIELDS("ASN E-Mail Template");
        IF "ASN E-Mail Template".HASVALUE THEN
          AppTemplateExists := TRUE;

        IF FileMgt.BLOBImport(TempBlob,'*.HTM') = '' THEN
          EXIT;

        "ASN E-Mail Template" := TempBlob.Blob;

        IF AppTemplateExists THEN
          IF NOT CONFIRM(Text002,FALSE,FIELDCAPTION("ASN E-Mail Template")) THEN
            EXIT;

        //CurrPage.SAVERECORD;
      END;
    END;

    [EventSubscriber(Page,459,OnBeforeActionEvent,Action1000000015)]
    LOCAL PROCEDURE Pg459_Export_OnAction@1000000001(VAR Rec@1000000000 : Record 311);
    VAR
      TempBlob@1000000003 : Record 99008535;
      FileMgt@1000000002 : Codeunit 419;
    BEGIN
      WITH Rec DO BEGIN
        CALCFIELDS("ASN E-Mail Template");
        IF "ASN E-Mail Template".HASVALUE THEN BEGIN
          TempBlob.Blob := "ASN E-Mail Template";
          FileMgt.BLOBExport(TempBlob,'*.HTM',TRUE);
        END;
      END;
    END;

    [EventSubscriber(Page,459,OnBeforeActionEvent,Action1000000014)]
    LOCAL PROCEDURE Pg459_Delete_OnAction@1000000002(VAR Rec@1000000000 : Record 311);
    VAR
      Text003@1000000004 : TextConst 'ENU=Do you want to delete the template %1?;ESM=¨Desea eliminar la plantilla %1?;FRC=D‚sirez-vous supprimer le modŠle %1?;ENC=Do you want to delete the template %1?';
    BEGIN
      WITH Rec DO BEGIN
        CALCFIELDS("ASN E-Mail Template");
        IF "ASN E-Mail Template".HASVALUE THEN
         IF CONFIRM(Text003,FALSE,FIELDCAPTION("ASN E-Mail Template")) THEN BEGIN
          CLEAR("ASN E-Mail Template");
          //CurrPage.SAVERECORD;
         END;

      END;
    END;

    BEGIN
    END.
  }
}

