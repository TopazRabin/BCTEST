OBJECT Codeunit 50030 WMDM Print Ext. Template1
{
  OBJECT-PROPERTIES
  {
    Date=11/02/16;
    Time=10:48:32 PM;
    Version List=WMDM1.7.1605;
  }
  PROPERTIES
  {
    TableNo=23044511;
    OnRun=BEGIN
            //<IW author="R.Letts" date="10/10/2014" issue="TFS1519" >
            // this is needed to work around a NAV 2013 R2 issue with records in codeunits started from a session.
            Rec.CHANGECOMPANY();
            //</IW>


            trecEventParams.COPY(Rec, TRUE);  //make Rec data global

            CASE getEvent OF
              123: examplePrintFunction;
              456: examplePrintFunction;
            END;
          END;

  }
  CODE
  {
    VAR
      trecEventParams@1000000000 : TEMPORARY Record 23044511;
      cuWMDMPrintMgmt@1000000001 : Codeunit 23044525;
      cuWMDMCommon@1000000002 : Codeunit 23044501;

    LOCAL PROCEDURE examplePrintFunction@1000000001();
    BEGIN
      //
      // get whatever variables are required to run the report
      // E.g.
      //   lcodSomeValue := trecEventParams.getValue('');
      //

      //
      // initialize/run the report
      //
      //cuWMDMCommon.setPrinterSelection('printer name', REPORT::"");
      //lrpt.initReport();
      //lrpt.SETTABLEVIEW(lrecTable);
      //lrpt.SHOWREQUESTFORM(FALSE);
      //lrpt.RUNMODAL();

      //
      // or
      //cuWMDMCommon.setPrinterSelection('printer name', REPORT::"");
      //REPORT.RUNMODAL(REPORT::"",FALSE,FALSE,lrecTable);

      // or

      //
      // If you want to use the WMDM framework for controlling the printer the following code example might help
      //
      //lrecSalesHeader.SETRANGE("Order No.",trecEventParams.getDocumentNo());
      //lrefRecRef.GETTABLE(lrecSalesHeader);
      //cuWMDMPrintMgmt.printReport( lrefRecRef, recPDAConfig.Code, REPORT::"Sales Order", recPDAConfig."Regular Printer Name");
    END;

    BEGIN
    {
      ************************
      Copyright Notice
      This objects content is copyright of Insight Works 2011.  All rights reserved.
      Any redistribution or reproduction of part or all of the contents in any form is prohibited.
      ************************


      <IW>
        <REVISION author="R.Trudeau" date="05/12/2016" version="IW16.05" issue="">
          Extensibility codeunit template for priting.
          Provides a standard simplified entry point for extending the WMDM printing.
          This codeunit should be called from the extensibility codeunit when printing.
        </REVISION>
      </IW>
    }
    END.
  }
}

