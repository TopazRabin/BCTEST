OBJECT Codeunit 51779 Page136EventSubscriber
{
  OBJECT-PROPERTIES
  {
    Date=07/01/20;
    Time=12:00:00 AM;
    Modified=Yes;
    Version List=TPZ000.00.00;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {

    [EventSubscriber(Page,136,OnBeforeActionEvent,Action1000000004)]
    LOCAL PROCEDURE Pg136_ChangeLogEntries_OnAction@1170000001(VAR Rec@1170000000 : Record 120);
    VAR
      ChangeLogEntry@1170000001 : Record 405;
    BEGIN
      WITH Rec DO BEGIN
          // <TPZ129>
        ChangeLogEntry.RESET;
        ChangeLogEntry.SETRANGE("Table No.",DATABASE::"Purch. Rcpt. Header");
        ChangeLogEntry.SETRANGE("Primary Key Field 1 Value","No.");
        PAGE.RUNMODAL(PAGE::"Change Log Entries",ChangeLogEntry);
        // </TPZ129>
      END;
    END;

    [EventSubscriber(Page,136,OnBeforeActionEvent,Action1000000007)]
    LOCAL PROCEDURE Pg136_Invoice_OnAction@1170000003(VAR Rec@1170000000 : Record 120);
    VAR
      PurchHeader@1170000001 : Record 38;
      Text50000@1170000002 : TextConst 'ENU="Do you want to invoice purchase receipt? "';
      Table120EventSubscriber@1000000000 : Codeunit 51755;
    BEGIN
      WITH Rec DO BEGIN
          // <TPZ1056>
        IF NOT CONFIRM(Text50000,TRUE) THEN
          EXIT;

        Table120EventSubscriber.Tb120_UpdatePurchOrderQtytoInv(Rec);

        PurchHeader.RESET;
        PurchHeader.SETRANGE("No.","Order No.");
        PAGE.RUNMODAL(PAGE::"Purchase Order",PurchHeader);
        // </TPZ1056>
      END;
    END;

    [EventSubscriber(Page,136,OnBeforeActionEvent,Action14000604)]
    LOCAL PROCEDURE "Pg136_E-&MailReceipt_Invoice"@1170000006(VAR Rec@1170000000 : Record 120);
    VAR
      EMailMgt@1170000001 : Codeunit 14000903;
    BEGIN
      WITH Rec DO BEGIN
        TESTFIELD("E-Mail Receipt Notice Handled",FALSE);
        EMailMgt.SendPurchaseReceiptNotice(Rec,TRUE,FALSE);
      END;
    END;

    BEGIN
    END.
  }
}

