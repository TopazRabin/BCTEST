OBJECT Codeunit 51748 Page21EventSubscriber
{
  OBJECT-PROPERTIES
  {
    Date=01/08/21;
    Time=[ 5:13:18 AM];
    Modified=Yes;
    Version List=NAVEVENT;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {

    [EventSubscriber(Page,21,OnAfterActionEvent,Contact)]
    PROCEDURE Pg21_ContactAction@1000000010(VAR Rec@1000000001 : Record 18);
    VAR
      Cont@1000000000 : Record 5050;
      ContMSg@1000000002 : TextConst 'ENU=No contact associated with this account %1, please create a contact through the contact feeder.';
    BEGIN
      //TPZ2830
      //<TPZ2596>
      //ShowContact; //<TPZ2596> Commented old Code
      Cont.RESET;
      Cont.SETRANGE("Customer No.",Rec."No.");
      IF NOT Cont. FINDFIRST THEN
        MESSAGE(ContMSg,Rec."No.");

      PAGE.RUN(PAGE::"Contact List",Cont);
      //</TPZ2596>
    END;

    [EventSubscriber(Page,21,OnAfterActionEvent,"Un-Posted Sales History")]
    PROCEDURE "Pg21_Un-PostedSalesHistory"@1000000011(VAR Rec@1000000000 : Record 18);
    VAR
      UnpostedSalesHist@1000000003 : Page 50025;
    BEGIN
      //TPZ2830
      //TOP220 KT ABCSI Customer Sales History 03312015
      CLEAR(UnpostedSalesHist);
      UnpostedSalesHist.SetCustomer(Rec."No.");
      UnpostedSalesHist.FilterSubPages;
      UnpostedSalesHist.ACTIVATE;
      UnpostedSalesHist.RUN;
      //TOP220 KT ABCSI Customer Sales History 03312015
    END;

    [EventSubscriber(Page,21,OnAfterActionEvent,"Posted Sales History")]
    PROCEDURE Pg21_PostedSalesHistory@1000000012(VAR Rec@1000000000 : Record 18);
    VAR
      PostedSalesHist@1000000002 : Page 50026;
    BEGIN
      //TPZ2830
      //TOP220 KT ABCSI Customer Sales History 03312015
      CLEAR(PostedSalesHist);
      PostedSalesHist.SetCustomer(Rec."No.");
      PostedSalesHist.FilterSubPages;
      PostedSalesHist.ACTIVATE;
      PostedSalesHist.RUN;
      //TOP220 KT ABCSI Customer Sales History 03312015
    END;

    [EventSubscriber(Page,21,OnAfterActionEvent,"Archived Sales History")]
    PROCEDURE Pg21_ArchivedSalesHistory@1000000013(VAR Rec@1000000000 : Record 18);
    VAR
      ArchSalesHist@1000000001 : Page 50027;
    BEGIN
      //TPZ2830
      //TOP220 KT ABCSI Customer Sales History 03312015
      CLEAR(ArchSalesHist);
      ArchSalesHist.SetCustomer(Rec."No.");
      ArchSalesHist.FilterSubPages;
      ArchSalesHist.ACTIVATE;
      ArchSalesHist.RUN;
      //TOP220 KT ABCSI Customer Sales History 03312015
    END;

    [EventSubscriber(Page,21,OnAfterActionEvent,Action1000000051)]
    PROCEDURE Pg21_Action1000000051ChangeLogEntry@1000000015(VAR Rec@1000000000 : Record 18);
    VAR
      ChangeLogEntry@1000000002 : Record 405;
      ChangeLogMgt@1000000001 : Codeunit 423;
      CUSubscriber@1000000003 : Codeunit 51876;
    BEGIN
      //TPZ2830
      //<TPZ1728>
      //ChangeLogMgt.OpenSSRSReport(DATABASE::Customer, Rec."No.", '','');//<TPZ2829> Event Conversion
      CUSubscriber.CU423_OpenSSRSReport(DATABASE::Customer, Rec."No.", '','');//<TPZ2829> Event Conversion
      {EXIT;
      //</TPZ1728>

      // <TPZ129>
      ChangeLogEntry.RESET;
      ChangeLogEntry.SETRANGE("Table No.",DATABASE::Customer);
      ChangeLogEntry.SETRANGE("Primary Key Field 1 Value",Rec."No.");
      PAGE.RUNMODAL(PAGE::"Change Log Entries",ChangeLogEntry);
      // </TPZ129>
      }
    END;

    [EventSubscriber(Page,21,OnAfterActionEvent,Action1000000150)]
    PROCEDURE Pg21_Action1000000017ItemAvailPrice@1000000020(VAR Rec@1000000000 : Record 18);
    VAR
      ItemCustAvailPage@1000000001 : Page 50048;
      ItemRec@1000000002 : Record 27;
    BEGIN
      //TPZ2830
      //TOP100B KT ABCSI Item Cust. Avail. & Price 03192015
      CLEAR(ItemCustAvailPage);
      ItemCustAvailPage.SetRecords(ItemRec,Rec,TRUE);
      ItemCustAvailPage.UpdateQuantities;
      ItemCustAvailPage.ACTIVATE;
      ItemCustAvailPage.RUN;
      //TOP100B KT ABCSI Item Cust. Avail. & Price 03192015
    END;

    [EventSubscriber(Page,21,OnAfterActionEvent,"Customer Price Book")]
    PROCEDURE Pg21_CustomerPriceBook@1000000017(VAR Rec@1000000000 : Record 18);
    VAR
      CustPriceBook@1000000001 : Report 51014;
    BEGIN
      //TPZ2830
      // <TPZ614>
      CustPriceBook.SetParameters(Rec."No.");
      CustPriceBook.RUN;
      // </TPZ614>
    END;

    [EventSubscriber(Page,21,OnAfterActionEvent,"Enhanced Cust.Price Book")]
    PROCEDURE Pg21_EnhancedCustPriceBook@1000000018(VAR Rec@1000000000 : Record 18);
    VAR
      CustPriceBook@1000000001 : Report 51133;
    BEGIN
      //TPZ2830
      // <TPZ614>
      CustPriceBook.SetParameters(Rec."No.");
      CustPriceBook.RUN;
      // </TPZ614>
    END;

    [EventSubscriber(Page,21,OnAfterActionEvent,"Customer Group Prices")]
    PROCEDURE Pg21_CustomerGroupPrices@1000000021(VAR Rec@1000000000 : Record 18);
    VAR
      CustomerPriceGroup@1000000001 : Report 51017;
    BEGIN
      //TPZ2830
      // <TPZ1598>
      CustomerPriceGroup.SetParameters(Rec."No.");
      CustomerPriceGroup.RUN;
      // </TPZ1598>
    END;

    [EventSubscriber(Page,21,OnAfterActionEvent,"Lighting Price List")]
    PROCEDURE Pg21_LightingPriceList@1000000019(VAR Rec@1000000000 : Record 18);
    VAR
      LightingPricebook@1000000001 : Report 51122;
    BEGIN
      //TPZ2830
      //<TPZ2467>
      CLEAR(LightingPricebook);
      LightingPricebook.SetMasterFileds(Rec."No.");
      LightingPricebook.RUN;
      //</TPZ2467>
    END;

    [EventSubscriber(Page,21,OnAfterActionEvent,"Item Sales by Customer Details")]
    PROCEDURE Pg21_ItemSalesbyCustomerDetails@1000000023(VAR Rec@1000000000 : Record 18);
    VAR
      ItemSalesbyCustomerDetails@1000000001 : Report 51100;
    BEGIN
      //TPZ2830
      //<TPZ1570>
      CLEAR(ItemSalesbyCustomerDetails);
      ItemSalesbyCustomerDetails.SetMasterFileds(Rec."No.");
      ItemSalesbyCustomerDetails.RUN;
      //</TPZ1570>
    END;

    BEGIN
    {
      2020-05-21  TPZ2830  PSHUKLA
    }
    END.
  }
}

