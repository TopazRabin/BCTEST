OBJECT Codeunit 51888 Page381EventSubscriber
{
  OBJECT-PROPERTIES
  {
    Date=07/01/20;
    Time=12:00:00 AM;
    Modified=Yes;
    Version List=TPZ000.00.00;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {

    PROCEDURE Pg381_CalcExtDocTotal@1000000000(Rec@1170000000 : Record 271) : Decimal;
    VAR
      ExtDocTotal@1000000000 : Decimal;
      BankAccLedgerEntries@1000000001 : Record 271;
    BEGIN
      //<TPZ2332>
      WITH Rec DO BEGIN
        ExtDocTotal:=0;
        IF "External Document No." <>'' THEN BEGIN
          BankAccLedgerEntries.RESET;
          BankAccLedgerEntries.SETCURRENTKEY("Bank Account No.",Open);
          BankAccLedgerEntries.SETRANGE("Bank Account No.","Bank Account No.");
          BankAccLedgerEntries.SETRANGE(Open,TRUE);
          BankAccLedgerEntries.SETFILTER("Statement Status",'%1|%2|%3',0,1,2);
          BankAccLedgerEntries.SETRANGE("External Document No.","External Document No.");
          //BankAccLedgerEntries.SETRANGE("Document No.","Document No.");
          IF BankAccLedgerEntries.FINDSET THEN BEGIN
            REPEAT
              ExtDocTotal := ExtDocTotal + BankAccLedgerEntries.Amount;
            UNTIL BankAccLedgerEntries.NEXT = 0;
          END;
          EXIT(ExtDocTotal);
        END;
        //</TPZ2332>
      END;
    END;

    BEGIN
    END.
  }
}

