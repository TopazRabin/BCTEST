OBJECT Codeunit 51728 Table7320EventSubscriber
{
  OBJECT-PROPERTIES
  {
    Date=07/29/21;
    Time=12:57:12 PM;
    Modified=Yes;
    Version List=NAVEVENT;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {

    [EventSubscriber(Table,7320,OnBeforeWhseShptLineDelete)]
    PROCEDURE Tb7320_DeleteWarehouseShipmentLines@1000000017(VAR WarehouseShipmentLine@1000000000 : Record 7321);
    VAR
      TPZWhseValidationMgt@1000000001 : Codeunit 50037;
    BEGIN
      //<TPZ2036>
      TPZWhseValidationMgt.ValidateDeleteWhseShptLine(WarehouseShipmentLine);
      //</TPZ2036>
    END;

    [EventSubscriber(Table,7320,OnBeforeDeleteEvent)]
    LOCAL PROCEDURE TB7320_OnDelete@1000000000(VAR Rec@1000000000 : Record 7320;RunTrigger@1000000001 : Boolean);
    VAR
      WarehouseRequest@1000000002 : Record 5765;
      WarehouseShipmentLine@1000000003 : Record 7321;
    BEGIN
      //TPZ3291
      WarehouseShipmentLine.RESET;
      WarehouseShipmentLine.SETRANGE("No.",Rec."No.");
      IF WarehouseShipmentLine.FINDFIRST THEN BEGIN
        WarehouseRequest.SETRANGE("Source No.",WarehouseShipmentLine."Source No.");
        IF WarehouseRequest.FINDFIRST THEN
          WarehouseRequest.MODIFYALL("Activity Status",WarehouseRequest."Activity Status"::" ");
      END;

    END;

    BEGIN
    {
      2020-05-06  TPZ2830  PSHUKLA
      001 TPZ3291 PKS 07272021 Added event to change warehouse request activity stats if warehuse shipment got deleted.
    }
    END.
  }
}

