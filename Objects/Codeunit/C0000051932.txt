OBJECT Codeunit 51932 Codeunit5773EventSubscriber
{
  OBJECT-PROPERTIES
  {
    Date=08/11/20;
    Time=[ 1:22:26 PM];
    Modified=Yes;
    Version List=NAVEVENT,3014;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {

    [EventSubscriber(Codeunit,5773,OnBeforeCreateWhseRequest)]
    LOCAL PROCEDURE CU5773_OnRelease@1000000001(VAR WarehouseRequest@1000000000 : Record 5765;TransferHeader@1000000001 : Record 5740);
    VAR
      OldWhseRqst@1000000003 : Record 5765;
      TransferLineLoc@1000000002 : Record 5741;
    BEGIN
      WITH TransferHeader DO BEGIN
        //TM BEG 061115
        OldWhseRqst.SETCURRENTKEY("Source Type","Source No.");
        OldWhseRqst.SETRANGE("Source Type", DATABASE::"Transfer Line");
        OldWhseRqst.SETRANGE("Source No.",TransferHeader."No.");
        IF OldWhseRqst.FINDFIRST THEN BEGIN
          WarehouseRequest."Activity Status" := OldWhseRqst."Activity Status";
        END;

        WarehouseRequest."E-Ship Agent Service" := "E-Ship Agent Service";
        WarehouseRequest."Sell-to/Transfer-to No." := "Transfer-to Code";
        WarehouseRequest."Sell-to/Transfer-to Name" := "Transfer-to Name";
        WarehouseRequest."Division Code" := "Shortcut Dimension 5 Code";
        //TM END 061115
        //-->TPZ2781 PSHUKLA
        TransferLineLoc.RESET;
        TransferLineLoc.SETRANGE("Document No.","No.");
        TransferLineLoc.SETFILTER("Item No.",'<>%1','');
        IF TransferLineLoc.FINDSET THEN
          WarehouseRequest."Number of Lines" := TransferLineLoc.COUNT;
        WarehouseRequest."Shipping Method" := "Shipping Agent Code";
        WarehouseRequest."Pick Type" := WarehouseRequest."Pick Type"::"TO";
        //<--
        WarehouseRequest."Order Date" := TransferHeader."Creation Date"; //TPZ3014
      END;
    END;

    BEGIN
    {
      001 TPZ2830 PKS 07232020 Created new object
      TPZ3014  PKS  12222020  Added code to flow order date
    }
    END.
  }
}

