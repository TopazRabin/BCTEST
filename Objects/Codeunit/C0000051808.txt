OBJECT Codeunit 51808 Page47EventSubscriber
{
  OBJECT-PROPERTIES
  {
    Date=07/01/20;
    Time=12:00:00 AM;
    Modified=Yes;
    Version List=NAVEVENT,TPZ2829;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {
    VAR
      Table37EventSubscribers@1000000000 : Codeunit 50077;
      Table36EventSubscribers@1000000001 : Codeunit 50078;

    [EventSubscriber(Codeunit,51809,Pg47_OnOpenPage)]
    PROCEDURE Pg47_OnOpenPage@1000000023(VAR Sender@1000000000 : Codeunit 51809;VAR Rec@1000000001 : Record 37;VAR CommHdlgVisible@1000000002 : Boolean);
    VAR
      UserMgt@1000000003 : Codeunit 5700;
    BEGIN
      // <TPZ858>
      CommHdlgVisible := UserMgt.GetCommHdlgAdmin(USERID);
      // </TPZ858>
    END;

    [EventSubscriber(Codeunit,51809,Pg47_OnAfterGetRecord)]
    PROCEDURE Pg47_OnAfterGetRecord@1000000026(VAR Sender@1000000000 : Codeunit 51809;VAR Rec@1000000001 : Record 37;VAR StyleTxt@1000000002 : Text);
    VAR
      ItemCostMgmt@1000000003 : Codeunit 5804;
    BEGIN

      StyleTxt := Table37EventSubscribers.Tb37_SetStyle(Rec);  //TOP230 KT ABCSI CRP 2 Fixes 05012015
      Table37EventSubscribers.Tb37_GetLastSalesPrice(Rec); //TOP180 KT ABCSI Customer Pricing - Hot Sheets 04142015
    END;

    [EventSubscriber(Codeunit,51809,Pg47_OnNewRecord)]
    PROCEDURE Pg47_OnNewRecord@1000000025(VAR Sender@1000000000 : Codeunit 51809;VAR Rec@1000000001 : Record 37;VAR StyleTxt@1000000002 : Text);
    BEGIN

      StyleTxt := Table37EventSubscribers.Tb37_SetStyle(Rec); //TOP230 KT ABCSI CRP 2 Fixes 05012015
    END;

    [EventSubscriber(Page,47,OnAfterGetCurrRecordEvent)]
    PROCEDURE Pg47_OnAfterGetCurrentRecord@1000000027(VAR Rec@1000000000 : Record 37);
    BEGIN

      Table37EventSubscribers.Tb37_GetLastSalesPrice(Rec); //TOP180 KT ABCSI Customer Pricing - Hot Sheets 04142015
    END;

    [EventSubscriber(Page,47,OnBeforeActionEvent,Action1000000024)]
    PROCEDURE Pg47_ChangeLogEntries_OnAction@1000000028(VAR Rec@1000000000 : Record 37);
    VAR
      ChangeLogEntry@1000000003 : Record 405;
      Number@1000000002 : Integer;
      ChangeLogMgt@1000000001 : Codeunit 423;
    BEGIN
      WITH Rec DO BEGIN
        //<TPZ1728>
        Number := "Document Type";
        //ChangeLogMgt.OpenSSRSReport(DATABASE::"Sales Line", FORMAT(Number), "Document No.", FORMAT("Line No."));
        EXIT;
        //</TPZ1728>


        // <TPZ129>
        Number := "Document Type";
        ChangeLogEntry.RESET;
        ChangeLogEntry.SETRANGE("Table No.",DATABASE::"Sales Line");
        ChangeLogEntry.SETRANGE("Primary Key Field 1 Value",FORMAT(Number));
        ChangeLogEntry.SETRANGE("Primary Key Field 2 Value","Document No.");
        ChangeLogEntry.SETRANGE("Primary Key Field 3 Value",FORMAT("Line No."));
        PAGE.RUNMODAL(PAGE::"Change Log Entries",ChangeLogEntry);
        // </TPZ129>
      END;
    END;

    BEGIN
    END.
  }
}

