OBJECT Codeunit 50037 TPZ Whse. Validation Mgt
{
  OBJECT-PROPERTIES
  {
    Date=10/01/20;
    Time=[ 5:38:58 PM];
    Modified=Yes;
    Version List=TPZ000.00.00;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {

    PROCEDURE ValidateDeleteWhseShptLine@1000000001(VAR WhseShptLine@1000000000 : Record 7321);
    VAR
      PackageLine@1000000001 : Record 14000702;
    BEGIN
      PackageLine.SETCURRENTKEY("Source Type","Source Subtype","Source ID","No.","Variant Code",Type,"Location Code");
      PackageLine.SETRANGE("Source Type", WhseShptLine."Source Type" - 1);
      PackageLine.SETRANGE("Source Subtype", WhseShptLine."Source Subtype");
      PackageLine.SETRANGE("Source ID", WhseShptLine."Source No.");
      IF PackageLine.ISEMPTY = FALSE THEN
        IF PackageLine.FINDFIRST THEN
        ERROR('Package %1 already exists and linked to %2', PackageLine."Package No.", PackageLine."Source ID");

    END;

    BEGIN
    END.
  }
}

