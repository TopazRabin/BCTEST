OBJECT Codeunit 14002366 E.D.I. Funct. Ack. Send All
{
  OBJECT-PROPERTIES
  {
    Date=10/20/14;
    Time=12:00:00 PM;
    Version List=SE0.60.03;
  }
  PROPERTIES
  {
    OnRun=BEGIN
            EDISetup.GET;
            EDIRecDocHdr.RESET;
            EDIRecDocHdr.SETCURRENTKEY("Funct. Ack. Required","Funct. Ack. Sent");
            EDIRecDocHdr.SETRANGE("Funct. Ack. Required",TRUE);
            EDIRecDocHdr.SETRANGE("Funct. Ack. Sent",FALSE);
            EDIRecDocHdr.SETFILTER("Navision Document",'<>%1','I_FUNCTACK');
            IF EDIRecDocHdr.FIND('-') THEN BEGIN
              IF GUIALLOWED THEN
                ProgWindow.OPEN(
                  Text001 +
                  Text002 +
                  Text003 +
                  Text004 +
                  Text005);
                  Count := 0;
                REPEAT
                  Count := Count + 1;
                  IF GUIALLOWED THEN BEGIN
                    ProgWindow.UPDATE(1,EDIRecDocHdr."Trade Partner No.");
                    ProgWindow.UPDATE(2,EDIRecDocHdr."Group Control No.");
                    ProgWindow.UPDATE(3,EDIRecDocHdr."Navision Document");
                    ProgWindow.UPDATE(4,Count);
                  END;
                Stat := EDIFunctAckSend.RUN(EDIRecDocHdr);
              UNTIL EDIRecDocHdr.NEXT = 0;
              IF GUIALLOWED THEN
                ProgWindow.CLOSE;
            END;

            IF EDISetup."Auto Export Send Doc." THEN BEGIN
              EDISendDocHdr.SETCURRENTKEY("Trade Partner No.","Navision Document","Sent Date");
              EDISendDocHdr.SETRANGE("Navision Document",'E_FUNCTACK');
              EDISendDocHdr.SETRANGE("Sent Date",0D);
              IF EDISendDocHdr.FIND('-') THEN
                REPEAT
                  EDIDocument.SETRANGE("Trade Partner No.",EDISendDocHdr."Trade Partner No.");
                  EDIDocument.SETRANGE("Navision Document",EDISendDocHdr."Navision Document");
                  EDIDocument.SETFILTER(Status,'<>%1',EDIDocument.Status::Inactive);
                  IF EDIDocument.FIND('-') THEN
                    Stat := EDISend.RUN(EDIDocument);
                UNTIL EDISendDocHdr.NEXT = 0;
            END;
          END;

  }
  CODE
  {
    VAR
      EDISetup@1240030000 : Record 14002367;
      EDIDocument@1240030001 : Record 14002353;
      EDIRecDocHdr@1240030002 : Record 14002358;
      EDISendDocHdr@1240030003 : Record 14002369;
      EDIFunctAckSend@1240030004 : Codeunit 14002361;
      EDISend@1240030005 : Codeunit 14002356;
      ProgWindow@1240030006 : Dialog;
      Count@1240030007 : Integer;
      Stat@1240030008 : Boolean;
      Text001@1001 : TextConst 'ENU=Sending Functional Acknowledgements\';
      Text002@1002 : TextConst 'ENU=Trading Partner   #1##################\';
      Text003@1003 : TextConst 'ENU=Group Control No. #2##################\';
      Text004@1004 : TextConst 'ENU=EDI Navision Doc. #3##################\';
      Text005@1005 : TextConst 'ENU=Count             #4########';

    BEGIN
    END.
  }
}

