OBJECT Codeunit 23044505 IWX Line-Reserve
{
  OBJECT-PROPERTIES
  {
    Date=01/31/19;
    Time=[ 9:37:29 AM];
    Version List=IWX2.4.7684.0;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {
    VAR
      cuIWXResMgmt@1000000000 : Codeunit 23044506;

    PROCEDURE AddRemoveTransferResNumber2@1000000003(VAR precTransLine@1000000004 : Record 5741;poptDirection@1000000003 : 'Outbound,Inbound';psSerialNumber@1000000001 : Text;psLotNumber@1000000006 : Text;pdChangeQty@1000000007 : Decimal);
    VAR
      lrecTrackingSpecification@1000000005 : Record 336;
      ldtAvailabilityDate@1000000002 : Date;
    BEGIN
      InitTransTrackingSpecification(precTransLine,lrecTrackingSpecification,ldtAvailabilityDate,poptDirection);
      cuIWXResMgmt.SetSource(lrecTrackingSpecification,ldtAvailabilityDate);

      psSerialNumber := UPPERCASE(psSerialNumber);
      psLotNumber := UPPERCASE(psLotNumber);
      cuIWXResMgmt.handleReservation(psSerialNumber, psLotNumber, lrecTrackingSpecification, pdChangeQty);
    END;

    LOCAL PROCEDURE InitTransTrackingSpecification@8(VAR TransLine@1000 : Record 5741;VAR TrackingSpecification@1001 : Record 336;VAR AvalabilityDate@1002 : Date;Direction@1003 : 'Outbound,Inbound');
    VAR
      TransferLocation@1004 : Code[10];
    BEGIN
      TrackingSpecification."Source Type" := DATABASE::"Transfer Line";
      WITH TransLine DO BEGIN
        TrackingSpecification."Item No." := "Item No.";
        TrackingSpecification.Description := Description;
        TrackingSpecification."Variant Code" := "Variant Code";
        TrackingSpecification."Source Subtype" := Direction;
        TrackingSpecification."Source ID" := "Document No.";
        TrackingSpecification."Source Batch Name" := '';
        TrackingSpecification."Source Prod. Order Line" := "Derived From Line No.";
        TrackingSpecification."Source Ref. No." := "Line No.";
        TrackingSpecification."Quantity (Base)" := "Quantity (Base)";
        TrackingSpecification."Qty. to Invoice (Base)" := "Quantity (Base)";
        TrackingSpecification."Qty. to Invoice" := Quantity;
        TrackingSpecification."Quantity Invoiced (Base)" := 0;
        TrackingSpecification."Qty. per Unit of Measure" := "Qty. per Unit of Measure";
        TrackingSpecification."Location Code" := TransferLocation;
        CASE Direction OF
          Direction::Outbound:
            BEGIN
              TrackingSpecification."Location Code" := "Transfer-from Code";
              TrackingSpecification."Bin Code" := "Transfer-from Bin Code";
              TrackingSpecification."Qty. to Handle (Base)" := "Qty. to Ship (Base)";
              TrackingSpecification."Qty. to Handle" := "Qty. to Ship";
              TrackingSpecification."Quantity Handled (Base)" := "Qty. Shipped (Base)";
              AvalabilityDate := "Shipment Date";
            END;
          Direction::Inbound:
            BEGIN
              TrackingSpecification."Location Code" := "Transfer-to Code";
              TrackingSpecification."Bin Code" := "Transfer-To Bin Code";
              TrackingSpecification."Qty. to Handle (Base)" := "Qty. to Receive (Base)";
              TrackingSpecification."Qty. to Handle" := "Qty. to Receive";
              TrackingSpecification."Quantity Handled (Base)" := "Qty. Received (Base)";
              AvalabilityDate := "Receipt Date";
            END;
        END;
      END;
    END;

    BEGIN
    {
      ************************
      Copyright Notice
      This objects content is copyright of Insight Works 2011.  All rights reserved.
      Any redistribution or reproduction of part or all of the contents in any form is prohibited.
      ************************

      Legacy for Transfer Order shipping item tracking.
    }
    END.
  }
}

