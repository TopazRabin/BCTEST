OBJECT Codeunit 51919 Codeunit5763EventSubscriber
{
  OBJECT-PROPERTIES
  {
    Date=07/01/20;
    Time=12:00:00 AM;
    Modified=Yes;
    Version List=NAVEVENT;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {
    VAR
      CurrencyFactor@1000000000 : Decimal;
      PricesInCurrency@1000000001 : Boolean;
      Item@1000000002 : Record 27;
      TempSalesPrice@1000000003 : TEMPORARY Record 7002;
      FoundSalesPrice@1000000004 : Boolean;
      ResFindUnitPrice@1000000005 : Codeunit 221;
      ResPrice@1000000006 : Record 201;
      Currency@1000000007 : Record 4;
      Batch@1000000008 : Boolean;
      ExchRateDate@1000000009 : Date;
      GLSetup@1000000010 : Record 98;
      PricesInclVAT@1000000020 : Boolean;
      VATCalcType@1000000019 : 'Normal VAT,Reverse Charge VAT,Full VAT,Sales Tax';
      VATBusPostingGr@1000000018 : Code[10];
      QtyPerUOM@1000000017 : Decimal;
      HideResUnitPriceMessage@1000000012 : Boolean;
      DateCaption@1000000011 : Text[30];
      VATPerCent@1000000013 : Decimal;
      Qty@1000000014 : Decimal;
      LineDiscPerCent@1000000015 : Decimal;
      AllowLineDisc@1000000021 : Boolean;
      AllowInvDisc@1000000016 : Boolean;
      Text000@1000000025 : TextConst 'ENU=%1 is less than %2 in the %3.;ESM=%1 es menor que %2 en el %3.;FRC=%1 est inf�rieur � %2 dans le %3.;ENC=%1 is less than %2 in the %3.';
      Text010@1000000024 : TextConst 'ENU=Prices including Tax cannot be calculated when %1 is %2.;ESM=No se pueden calcular precios IVA incluido cuando %1 es %2.;FRC=Impossible de calculer les prix incluant la TVA lorsque %1 est %2.;ENC=Prices including Tax cannot be calculated when %1 is %2.';
      Text018@1000000023 : TextConst 'ENU=%1 %2 is greater than %3 and was adjusted to %4.;ESM=%1 %2 es mayor que %3 y fue ajustado a %4.;FRC=%1 %2 est sup�rieur � %3 et a �t� rajust� � %4.;ENC=%1 %2 is greater than %3 and was adjusted to %4.';
      Text001@1000000022 : TextConst 'ENU=The %1 in the %2 must be same as in the %3.;ESM=El %1 en el %2 debe ser el mismo que en el %3.;FRC=Le %1 dans le %2 doit �tre le m�me que dans le %3.;ENC=The %1 in the %2 must be same as in the %3.';

    [EventSubscriber(Codeunit,51918,CU5763_OnCode)]
    LOCAL PROCEDURE CU5763_OnCode@1000000000(VAR Sender@1000000000 : Codeunit 51918;WarehouseShipmentLine@1000000001 : Record 7321);
    VAR
      TransferHeaderArch@1000000002 : Record 5740;
      Codeunit5063EventSubscriber@1000000003 : Codeunit 51951;
    BEGIN
      //<TPZ2466>
      TransferHeaderArch.SETRANGE("No.",WarehouseShipmentLine."Source No.");
      IF TransferHeaderArch.FINDFIRST THEN
        Codeunit5063EventSubscriber.CU5063_ArchiveTransferDocument(TransferHeaderArch);
      //</TPZ2466>
    END;

    [EventSubscriber(Codeunit,51918,CU5763_OnCode_1)]
    LOCAL PROCEDURE CU5763_OnCode_1@1000000001(VAR Sender@1000000000 : Codeunit 51918;WarehouseShipmentLine@1000000001 : Record 7321);
    VAR
      WhseRequest@1000000002 : Record 5765;
      OutWhseReqMgt@1000000003 : Codeunit 14002863;
    BEGIN
      //TM BEG 061615
      WITH WarehouseShipmentLine DO BEGIN
        WhseRequest.SETCURRENTKEY("Source Type","Source Subtype","Source No.");
        WhseRequest.SETRANGE("Location Code", "Location Code");
        WhseRequest.SETRANGE("Source Subtype", "Source Subtype");
        WhseRequest.SETRANGE("Source Type", "Source Type");
        WhseRequest.SETRANGE("Source No.", "Source No.");
        IF WhseRequest.FINDFIRST THEN BEGIN
          OutWhseReqMgt.SetWhseActivStatusToShipped(WhseRequest);
          WhseRequest.MODIFY;
        END;
      END;
        //TM END 061615
    END;

    [EventSubscriber(Codeunit,51918,CU5763_PostSourceDocument)]
    PROCEDURE CU5763_PostSourceDocument@1000000003(VAR Sender@1000000000 : Codeunit 51918;VAR SalesPost@1000000001 : Codeunit 80);
    BEGIN
      SalesPost.SetBatch(Batch);
    END;

    [EventSubscriber(Codeunit,51918,CU5763_HandleSalesLine)]
    LOCAL PROCEDURE CU5763_HandleSalesLine@1000000004(VAR Sender@1000000000 : Codeunit 51918;VAR ModifySalesLine@1000000001 : Boolean;SalesLine@1000000002 : Record 37);
    BEGIN
      IF SalesLine.Type = SalesLine.Type::Resource THEN
        ModifySalesLine := FALSE;
    END;

    PROCEDURE SetBatch@1000000002(NewBatch@1000000000 : Boolean);
    BEGIN
      // <TPZ143>
      Batch := NewBatch;
      // </TPZ143>
    END;

    BEGIN
    {
      2020-05-27  TPZ2830  PSHUKLA
    }
    END.
  }
}

