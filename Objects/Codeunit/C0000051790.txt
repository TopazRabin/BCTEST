OBJECT Codeunit 51790 Table753EventSubscriber
{
  OBJECT-PROPERTIES
  {
    Date=07/01/20;
    Time=12:00:00 AM;
    Modified=Yes;
    Version List=NAVEVENT,TPZ2829;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {

    [EventSubscriber(Codeunit,51791,Tab_753_ItemNo_OnValidate)]
    PROCEDURE "Tb753_ItemNo._OnValidate"@1000000029(VAR Sender@1000000000 : Codeunit 51791;VAR Rec@1000000001 : Record 753;VAR Item@1000000002 : Record 27);
    BEGIN
      WITH Rec DO BEGIN
        CASE "Entry Type" OF
        "Entry Type"::Purchase:
          //TOP050 KT ABCSI Modification to Item Cards 01222015
          BEGIN
            "Alt. UOM Code" := Item."Alt. Purch. Unit of Measure";
          END;
          //TOP050 KT ABCSI Modification to Item Cards 01222015
        "Entry Type"::Sale:
           //TOP050 KT ABCSI Modification to Item Cards 01222015
          BEGIN
            "Alt. UOM Code" := Item."Alt. Sales Unit of Measure";
          END;
        ELSE BEGIN //TOP050 KT ABCSI Modification to Item Cards 01222015
          "Alt. UOM Code" := Item."Alt. Base Unit of Measure";
        END;
        //TOP050 KT ABCSI Modification to Item Cards 01222015
       END;
      END;
    END;

    [EventSubscriber(Codeunit,51791,Tab_753_ItemNo_OnValidate_1)]
    PROCEDURE Tb753_ItemNo_OnValidate_1@1000000031(VAR Sender@1000000000 : Codeunit 51791;VAR Rec@1000000001 : Record 753);
    BEGIN
      WITH Rec DO BEGIN
        VALIDATE("Alt. UOM Code");
      END;
    END;

    PROCEDURE Tb753_CalcAltUOMQty@1000000035(VAR rec@1000000000 : Record 753;Qty@14000700 : Decimal) : Decimal;
    BEGIN
      WITH rec DO BEGIN
        //TOP050 KT ABCSI Modification to Item Cards 01212015
        IF "Qty. per Alt. UOM" <> 0 THEN BEGIN
          IF "Qty. per Alt. UOM" <> "Qty. per Unit of Measure" THEN BEGIN
            IF "Qty. per Alt. UOM" > "Qty. per Unit of Measure" THEN
              EXIT(ROUND(Qty / "Qty. per Alt. UOM",0.00001))
            ELSE
              EXIT(ROUND(Qty * "Qty. per Unit of Measure",0.00001));
          END ELSE
            EXIT(Qty);
        END ELSE
          EXIT(0);
        //TOP050 KT ABCSI Modification to Item Cards 01212015
      END;
    END;

    PROCEDURE Tb753_CalcQtyFromAltUOMQty@1000000034(VAR rec@1000000000 : Record 753;Qty@1000000001 : Decimal) : Decimal;
    BEGIN
      WITH rec DO BEGIN
        //TOP050 KT ABCSI Modification to Item Cards 01212015
        IF "Qty. per Alt. UOM" <> 0 THEN BEGIN
          IF "Qty. per Alt. UOM" <> "Qty. per Unit of Measure" THEN BEGIN
            IF "Qty. per Alt. UOM" > "Qty. per Unit of Measure" THEN
              EXIT(ROUND(Qty * "Qty. per Alt. UOM",0.00001))
            ELSE
              EXIT(ROUND(Qty / "Qty. per Unit of Measure",0.00001));
          END ELSE
            EXIT(Qty);
        END ELSE
          EXIT(0);
        //TOP050 KT ABCSI Modification to Item Cards 01212015
      END;
    END;

    PROCEDURE Tb753_CalcAltUOMUnitCost@1000000033(VAR rec@1000000000 : Record 753;LocalUnitCost@1000000001 : Decimal) : Decimal;
    BEGIN
      WITH rec DO BEGIN
      //TOP050 KT ABCSI Modification to Item Cards 01212015
      IF "Qty. per Alt. UOM" <> 0 THEN BEGIN
        IF "Qty. per Alt. UOM" <> "Qty. per Unit of Measure" THEN BEGIN
          IF "Qty. per Alt. UOM" > "Qty. per Unit of Measure" THEN
            EXIT(ROUND(LocalUnitCost * "Qty. per Alt. UOM",0.00001))
          ELSE
            EXIT(ROUND(LocalUnitCost / "Qty. per Unit of Measure",0.00001));
        END ELSE
          EXIT(LocalUnitCost);
      END ELSE
        EXIT(0);
      //TOP050 KT ABCSI Modification to Item Cards 01212015
      END;
    END;

    PROCEDURE Tb753_CalcUnitCostFromAltUOMUnitCost@1000000032(VAR rec@1000000000 : Record 753;LocalUnitCost@1000000001 : Decimal) : Decimal;
    BEGIN
      WITH rec DO BEGIN
      //TOP050 KT ABCSI Modification to Item Cards 01212015
        IF "Qty. per Alt. UOM" <> 0 THEN BEGIN
          IF "Qty. per Alt. UOM" <> "Qty. per Unit of Measure" THEN BEGIN
            IF "Qty. per Alt. UOM" > "Qty. per Unit of Measure" THEN
              EXIT(ROUND(LocalUnitCost / "Qty. per Alt. UOM",0.00001))
            ELSE
              EXIT(ROUND(LocalUnitCost / "Qty. per Unit of Measure",0.00001));
          END ELSE
            EXIT(LocalUnitCost);
        END ELSE
          EXIT(0);
        //TOP050 KT ABCSI Modification to Item Cards 01212015
      END;
    END;

    BEGIN
    END.
  }
}

