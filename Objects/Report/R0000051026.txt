OBJECT Report 51026 Insert My Notification
{
  OBJECT-PROPERTIES
  {
    Date=07/01/20;
    Time=12:00:00 AM;
    Modified=Yes;
    Version List=TPZ000.00.00;
  }
  PROPERTIES
  {
    ProcessingOnly=Yes;
    OnPostReport=BEGIN

                   MESSAGE('Successfully Completed');
                 END;

  }
  DATASET
  {
    { 1000000000;;DataItem;                  ;
               DataItemTable=Table2000000120;
               DataItemTableView=SORTING(User Name);
               OnPreDataItem=BEGIN

                               I[1]:='{2712ad06-c48b-4c20-820e-347a60c9ad00}';
                               I[2]:='{c80feeda-802c-4879-b826-34a10fb77087}';
                               I[3]:='{612a2701-4bbb-4c5b-b4c0-629d96b60644}';
                               I[4]:='{f76d6004-5ec5-4dea-b14d-71b2aeb53acf}';
                               I[5]:='{ec8348cb-07c1-499a-9b70-b3b081a33c99}';
                               I[6]:='{0c6ed8f1-7408-4352-8dd1-b9f17332607d}';

                               J[1] := 27;
                               J[2] := 18;
                               J[3] := 0;
                               J[4] := 0;
                               J[5] := 18;
                               J[6] := 0;

                               K[1] := 'Item availability is low.';
                               K[2] := 'Customer exceeds credit limit.';
                               K[3] := 'Warn about unposted documents.';
                               K[4] := 'Confirm posting outside the fiscal year.';
                               K[5] := 'Customer has overdue balance.';
                               K[6] := 'Confirm after posting documents.';

                               L[1] := 'QUERYPOSTONCLOSE';
                               L[2] := 'SHOWPOSTEDCONFIRMATIONMESSAGE';
                               L[3] := 'POSTINGOUTSIDEFISCALYEARNOTALLOWED';
                             END;

               OnAfterGetRecord=BEGIN
                                  UserPers.RESET;
                                  IF UserPers.GET(User."User Security ID") THEN BEGIN
                                    IF UserPers."Profile ID" = 'MFR REP - SALES' THEN BEGIN
                                      FOR M := 1 TO 6 DO BEGIN
                                        MyNotification.RESET;
                                        MyNotification.SETFILTER("User Id","User Name");
                                        MyNotification.SETFILTER("Notification Id",I[M]);
                                        IF NOT MyNotification.FINDFIRST THEN
                                          BEGIN
                                              InsertMyNotification;
                                              InsertUserpreferance;
                                          END;
                                      END;
                                    END ELSE
                                      CurrReport.SKIP;
                                  END;
                                END;

               ReqFilterFields=User Name }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      MyNotification@1000000000 : Record 1518;
      MynotPage@1000000001 : Page 1518;
      I@1000000002 : ARRAY [7] OF Text[100];
      J@1000000003 : ARRAY [7] OF Integer;
      K@1000000004 : ARRAY [7] OF Text[100];
      L@1000000008 : ARRAY [5] OF Text[100];
      M@1000000005 : Integer;
      N@1000000007 : Integer;
      UserPreference@1000000006 : Record 1306;
      UserPers@1000000009 : Record 2000000073;

    LOCAL PROCEDURE InsertMyNotification@1000000001();
    BEGIN
      //FOR M := 1 TO 6 DO BEGIN
        MyNotification.INIT;
        MyNotification."User Id" := User."User Name";
        MyNotification."Notification Id" := I[M];
        MyNotification."Apply to Table Id" := J[M];
        IF M <> 3 THEN
          MyNotification.Enabled := TRUE
        ELSE
          MyNotification.Enabled := FALSE;

        MyNotification.Name := K[M];
        MyNotification.INSERT;
      //END;
    END;

    LOCAL PROCEDURE InsertUserpreferance@1000000002();
    BEGIN
      UserPreference.RESET;
      UserPreference.SETRANGE("User ID",User."User Name");
      UserPreference.SETRANGE("Instruction Code",'QUERYPOSTONCLOSE');
      IF NOT UserPreference.FINDFIRST THEN BEGIN
        UserPreference.INIT  ;
        UserPreference."User ID" := User."User Name";
        UserPreference."Instruction Code" := 'QUERYPOSTONCLOSE';
        UserPreference.INSERT;
      END;
    END;

    BEGIN
    END.
  }
  RDLDATA
  {
  }
}

