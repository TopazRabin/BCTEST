OBJECT Report 50044 Fix EDI Order for Xref
{
  OBJECT-PROPERTIES
  {
    Date=07/01/20;
    Time=12:00:00 AM;
    Modified=Yes;
    Version List=TPZ000.00.00;
  }
  PROPERTIES
  {
    ProcessingOnly=Yes;
  }
  DATASET
  {
    { 1000000003;;DataItem;                  ;
               DataItemTable=Table36;
               OnAfterGetRecord=BEGIN
                                  CustomerRec.GET("Sell-to Customer No.");
                                  "EDI Trade Partner" := CustomerRec."EDI Trade Partner";

                                  EDICustXRefRec.RESET;
                                  EDICustXRefRec.SETCURRENTKEY("Trade Partner No.","Navision Sell To Code","Navision Ship To Code","Effective Date");
                                  EDICustXRefRec.SETRANGE("Trade Partner No.", CustomerRec."EDI Trade Partner");
                                  EDICustXRefRec.SETRANGE("Navision Sell To Code",CustomerRec."No.");
                                  EDICustXRefRec.SETRANGE("Navision Ship To Code","Sales Header"."Ship-to Code");
                                  IF EDICustXRefRec.FINDFIRST THEN BEGIN
                                    "EDI Invoice" := TRUE;
                                    "EDI Sell-to Code"  := EDICustXRefRec."EDI Sell To Code";
                                    "EDI Ship-to Code"  := EDICustXRefRec."EDI Ship To Code";
                                    MODIFY;
                                  END;
                                END;

               ReqFilterFields=EDI Trade Partner,Document Type,No. }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
      { 1000000000;;Container;
                  Name=Options;
                  ContainerType=ContentArea }

      { 1000000001;1;Field  ;
                  CaptionML=ENU=Execute 1st Step;
                  SourceExpr=FirstStep }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      EDICustXRefRec@1000000000 : Record 14002362;
      CustomerRec@1000000001 : Record 18;
      FirstStep@1000000002 : Boolean;

    BEGIN
    END.
  }
  RDLDATA
  {
  }
}

