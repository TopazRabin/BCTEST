OBJECT Report 51143 First Receipt Items
{
  OBJECT-PROPERTIES
  {
    Date=07/20/20;
    Time=12:00:00 AM;
    Modified=Yes;
    Version List=TPZ000.00.00,001;
  }
  PROPERTIES
  {
  }
  DATASET
  {
    { 1000000000;;DataItem;                  ;
               DataItemTable=Table27;
               OnPreDataItem=BEGIN
                               DateFilter := TODAY;
                             END;

               OnAfterGetRecord=BEGIN
                                  BinCode := '';
                                  LocCode := '';

                                  InsertFirstRcptAtrribute;

                                  ILE.RESET;
                                  ILE.SETRANGE("Item No.","No.");
                                  ILE.SETFILTER("Entry Type",'%1|%2',ILE."Entry Type"::Purchase,ILE."Entry Type"::Transfer);
                                  //>>001 TPZ2904
                                  //Comment Out older code starting tag
                                  //ILE.SETFILTER("Location Code",'1|25|30|76');
                                  //Comment Out older code End tag
                                  ILE.SETFILTER("Location Code",'1|25|30|76|80');
                                  //<<001 TPZ2904
                                  ILE.SETFILTER("Posting Date",'=%1',DateFilter);
                                  ILE.SETFILTER(Quantity,'>0');
                                  IF ILE.FINDFIRST THEN BEGIN
                                    ItemLedgerEntry.RESET;
                                    ItemLedgerEntry.SETRANGE("Item No.","No.");
                                    ItemLedgerEntry.SETFILTER("Entry Type",'%1|%2',ItemLedgerEntry."Entry Type"::Purchase,ItemLedgerEntry."Entry Type"::Transfer);
                                    //>>001 TPZ2904
                                    //Comment Out older code starting tag
                                    //ItemLedgerEntry.SETFILTER("Location Code",'1|25|30|76');
                                    //Comment Out older code End tag
                                    ItemLedgerEntry.SETFILTER("Location Code",'1|25|30|76|80');
                                    //<<001 TPZ2904
                                    ItemLedgerEntry.SETFILTER("Posting Date",'<%1',DateFilter);
                                    ItemLedgerEntry.SETFILTER(Quantity,'>0');
                                    IF ItemLedgerEntry.FINDFIRST THEN
                                      CurrReport.SKIP
                                      ELSE BEGIN
                                      WarehouseEntry.RESET;
                                      //WarehouseEntry.SETFILTER("Whse. Document Type",'%1|%2',WarehouseEntry."Whse. Document Type"::Receipt);
                                      WarehouseEntry.SETRANGE("Reference No.",ILE."Document No.");
                                      WarehouseEntry.SETRANGE("Registering Date",ILE."Posting Date");
                                      IF WarehouseEntry.FINDFIRST THEN
                                        BinCode := WarehouseEntry."Bin Code";
                                      LocCode := ILE."Location Code";
                                      END;
                                  END ELSE CurrReport.SKIP;
                                END;

               ReqFilterFields=No. }

    { 1000000001;1;Column;No_Item            ;
               SourceExpr=Item."No." }

    { 1000000002;1;Column;Description_Item   ;
               SourceExpr=Item.Description }

    { 1000000003;1;Column;BinCode            ;
               SourceExpr=BinCode }

    { 1000000004;1;Column;LocCode            ;
               SourceExpr=LocCode }

    { 1000000005;1;Column;DateFilter         ;
               SourceExpr=DateFilter }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
      { 1000000000;;Container;
                  Name=ContentArea;
                  ContainerType=ContentArea }

      { 1000000001;1;Group  ;
                  GroupType=Group }

      { 1000000002;2;Field  ;
                  SourceExpr=DateFilter }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      DefaultDimension@1000000000 : Record 352;
      ItemLedgerEntry@1000000001 : Record 32;
      DateFilter@1000000002 : Date;
      WarehouseEntry@1000000003 : Record 7312;
      ILE@1000000004 : Record 32;
      BinCode@1000000005 : Code[20];
      LocCode@1000000006 : Code[20];
      ItemAttributeValueSelection@1000000007 : TEMPORARY Record 7504;
      ItemAttributeValue@1000000009 : Record 7501;
      ItemAttributeValueMapping@1000000008 : Record 7505;
      FirstReceiptDate@1000000010 : Date;
      ILEFistRcpt@1000000011 : Record 32;
      ItemAttributeValueMapping1@1000000012 : Record 7505;

    LOCAL PROCEDURE InsertFirstRcptAtrribute@1000000002();
    BEGIN
      FirstReceiptDate := 0D;
      CLEAR(ItemAttributeValueSelection);
      ItemAttributeValueSelection.DELETEALL;
      ILEFistRcpt.RESET;
      ILEFistRcpt.SETCURRENTKEY("Item No.","Posting Date");
      ILEFistRcpt.SETRANGE("Item No.",Item."No.");
      ILEFistRcpt.SETFILTER("Entry Type",'%1|%2',ILE."Entry Type"::Purchase,ILE."Entry Type"::Transfer);
      //>>001 TPZ2904
      //Comment Out older code starting tag
      //ILEFistRcpt.SETFILTER("Location Code",'1|25|30|76');
      //Comment Out older code End tag
      ILEFistRcpt.SETFILTER("Location Code",'1|25|30|76|80');
      //<<001 TPZ2904
      ILEFistRcpt.SETFILTER(Quantity,'>0');
      IF ILEFistRcpt.FINDFIRST THEN
        FirstReceiptDate := ILEFistRcpt."Posting Date";
      IF FirstReceiptDate <> 0D THEN BEGIN
        WITH ItemAttributeValueSelection DO BEGIN
          ItemAttributeValueSelection.INIT;
          ItemAttributeValueSelection.VALIDATE("Attribute Name",'First Receipt Date');

          IF NOT FindAttributeValue(ItemAttributeValue) THEN
            InsertItemAttributeValue(ItemAttributeValue,ItemAttributeValueSelection);

      //    IF ItemAttributeValue.GET(ItemAttributeValue."Attribute ID",ItemAttributeValue.ID) THEN BEGIN
      //      ItemAttributeValueMapping.RESET;
      //      ItemAttributeValueMapping.INIT;
      //      ItemAttributeValueMapping."Table ID" := DATABASE::Item;
      //      ItemAttributeValueMapping."No." := Item."No.";
      //      ItemAttributeValueMapping."Item Attribute ID" := ItemAttributeValue."Attribute ID";
      //      ItemAttributeValueMapping."Item Attribute Value ID" := ItemAttributeValue.ID;
      //      ItemAttributeValueMapping.INSERT;
      //    END;

          ItemAttributeValueSelection.VALIDATE(Value,FORMAT(FirstReceiptDate));

          ItemAttributeValueSelection.INSERT;
          IF NOT ItemAttributeValueSelection.FindAttributeValue(ItemAttributeValue) THEN
            ItemAttributeValueSelection.InsertItemAttributeValue(ItemAttributeValue,ItemAttributeValueSelection);

          ItemAttributeValueMapping1.RESET;
          ItemAttributeValueMapping1.SETRANGE("Table ID",DATABASE::Item);
          ItemAttributeValueMapping1.SETRANGE("No.",Item."No.");
          ItemAttributeValueMapping1.SETRANGE("Item Attribute ID",ItemAttributeValue."Attribute ID");
          IF ItemAttributeValueMapping1.FINDFIRST THEN BEGIN
            ItemAttributeValueMapping1."Item Attribute Value ID" := ItemAttributeValue.ID;
            ItemAttributeValueMapping1.MODIFY;
          END ELSE
          IF ItemAttributeValue.GET(ItemAttributeValue."Attribute ID",ItemAttributeValue.ID) THEN BEGIN
            ItemAttributeValueMapping.RESET;
            ItemAttributeValueMapping.INIT;
            ItemAttributeValueMapping."Table ID" := DATABASE::Item;
            ItemAttributeValueMapping."No." := Item."No.";
            ItemAttributeValueMapping."Item Attribute ID" := ItemAttributeValue."Attribute ID";
            ItemAttributeValueMapping."Item Attribute Value ID" := ItemAttributeValue.ID;
            ItemAttributeValueMapping.INSERT;
          END;
        END;
      END;
    END;

    BEGIN
    {
      001 TPZ2904 UTK 07202020 - Code added for Location 80.
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner" xmlns:cl="http://schemas.microsoft.com/sqlserver/reporting/2010/01/componentdefinition" xmlns="http://schemas.microsoft.com/sqlserver/reporting/2010/01/reportdefinition">
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
      <rd:DataSourceID>e5fe3c34-0c89-43ac-817d-3b3d5738dbb4</rd:DataSourceID>
    </DataSource>
  </DataSources>
  <DataSets>
    <DataSet Name="DataSet_Result">
      <Query>
        <DataSourceName>DataSource</DataSourceName>
        <CommandText />
      </Query>
      <Fields>
        <Field Name="No_Item">
          <DataField>No_Item</DataField>
        </Field>
        <Field Name="Description_Item">
          <DataField>Description_Item</DataField>
        </Field>
        <Field Name="BinCode">
          <DataField>BinCode</DataField>
        </Field>
        <Field Name="LocCode">
          <DataField>LocCode</DataField>
        </Field>
        <Field Name="DateFilter">
          <DataField>DateFilter</DataField>
        </Field>
      </Fields>
      <rd:DataSetInfo>
        <rd:DataSetName>DataSet</rd:DataSetName>
        <rd:SchemaPath>Report.xsd</rd:SchemaPath>
        <rd:TableName>Result</rd:TableName>
      </rd:DataSetInfo>
    </DataSet>
  </DataSets>
  <ReportSections>
    <ReportSection>
      <Body>
        <ReportItems>
          <Tablix Name="Tablix1">
            <TablixBody>
              <TablixColumns>
                <TablixColumn>
                  <Width>1in</Width>
                </TablixColumn>
                <TablixColumn>
                  <Width>1.59375in</Width>
                </TablixColumn>
                <TablixColumn>
                  <Width>3.375in</Width>
                </TablixColumn>
                <TablixColumn>
                  <Width>1in</Width>
                </TablixColumn>
                <TablixColumn>
                  <Width>1in</Width>
                </TablixColumn>
              </TablixColumns>
              <TablixRows>
                <TablixRow>
                  <Height>0.22in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox1">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">Posting Date</Value>
                                  <Style>
                                    <FontSize>9pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox1</rd:DefaultName>
                          <Style>
                            <Border>
                              <Color>LightGrey</Color>
                              <Style>Solid</Style>
                            </Border>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox3">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">Item No.</Value>
                                  <Style>
                                    <FontSize>9pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox3</rd:DefaultName>
                          <Style>
                            <Border>
                              <Color>LightGrey</Color>
                              <Style>Solid</Style>
                            </Border>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox5">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">Description </Value>
                                  <Style>
                                    <FontSize>9pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox5</rd:DefaultName>
                          <Style>
                            <Border>
                              <Color>LightGrey</Color>
                              <Style>Solid</Style>
                            </Border>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox7">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">Location Code </Value>
                                  <Style>
                                    <FontSize>9pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontSize>9pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox7</rd:DefaultName>
                          <Style>
                            <Border>
                              <Color>LightGrey</Color>
                              <Style>Solid</Style>
                            </Border>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox9">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">Bin Code</Value>
                                  <Style>
                                    <FontSize>9pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox9</rd:DefaultName>
                          <Style>
                            <Border>
                              <Color>LightGrey</Color>
                              <Style>Solid</Style>
                            </Border>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.22in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="DateFilter">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">=Fields!DateFilter.Value</Value>
                                  <Style>
                                    <FontSize>9pt</FontSize>
                                    <Format>MM/dd/yyyy</Format>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>DateFilter</rd:DefaultName>
                          <Style>
                            <Border>
                              <Color>LightGrey</Color>
                              <Style>Solid</Style>
                            </Border>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="No_Item">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">=Fields!No_Item.Value</Value>
                                  <Style>
                                    <FontSize>9pt</FontSize>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>No_Item</rd:DefaultName>
                          <Style>
                            <Border>
                              <Color>LightGrey</Color>
                              <Style>Solid</Style>
                            </Border>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Description_Item">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">=Fields!Description_Item.Value</Value>
                                  <Style>
                                    <FontSize>9pt</FontSize>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Description_Item</rd:DefaultName>
                          <Style>
                            <Border>
                              <Color>LightGrey</Color>
                              <Style>Solid</Style>
                            </Border>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="LocCode">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">=Fields!LocCode.Value</Value>
                                  <Style>
                                    <FontSize>9pt</FontSize>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>LocCode</rd:DefaultName>
                          <Style>
                            <Border>
                              <Color>LightGrey</Color>
                              <Style>Solid</Style>
                            </Border>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="BinCode">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">=Fields!BinCode.Value</Value>
                                  <Style>
                                    <FontSize>9pt</FontSize>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>BinCode</rd:DefaultName>
                          <Style>
                            <Border>
                              <Color>LightGrey</Color>
                              <Style>Solid</Style>
                            </Border>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                  </TablixCells>
                </TablixRow>
              </TablixRows>
            </TablixBody>
            <TablixColumnHierarchy>
              <TablixMembers>
                <TablixMember />
                <TablixMember />
                <TablixMember />
                <TablixMember />
                <TablixMember />
              </TablixMembers>
            </TablixColumnHierarchy>
            <TablixRowHierarchy>
              <TablixMembers>
                <TablixMember>
                  <KeepWithGroup>After</KeepWithGroup>
                </TablixMember>
                <TablixMember>
                  <Group Name="Details" />
                </TablixMember>
              </TablixMembers>
            </TablixRowHierarchy>
            <DataSetName>DataSet_Result</DataSetName>
            <Height>0.44in</Height>
            <Width>7.96875in</Width>
            <Style>
              <Border>
                <Style>None</Style>
              </Border>
            </Style>
          </Tablix>
        </ReportItems>
        <Height>0.44in</Height>
        <Style />
      </Body>
      <Width>7.96875in</Width>
      <Page>
        <Style />
      </Page>
    </ReportSection>
  </ReportSections>
  <Code>Public Function BlankZero(ByVal Value As Decimal)
    if Value = 0 then
        Return ""
    end if
    Return Value
End Function

Public Function BlankPos(ByVal Value As Decimal)
    if Value &gt; 0 then
        Return ""
    end if
    Return Value
End Function

Public Function BlankZeroAndPos(ByVal Value As Decimal)
    if Value &gt;= 0 then
        Return ""
    end if
    Return Value
End Function

Public Function BlankNeg(ByVal Value As Decimal)
    if Value &lt; 0 then
        Return ""
    end if
    Return Value
End Function

Public Function BlankNegAndZero(ByVal Value As Decimal)
    if Value &lt;= 0 then
        Return ""
    end if
    Return Value
End Function
</Code>
  <Language>=User!Language</Language>
  <ConsumeContainerWhitespace>true</ConsumeContainerWhitespace>
  <rd:ReportUnitType>Inch</rd:ReportUnitType>
  <rd:ReportID>0eeb6585-38ae-40f1-885b-8d50088d51b4</rd:ReportID>
</Report>
    END_OF_RDLDATA
  }
}

