OBJECT Report 14002666 DP Open Period and Day End
{
  OBJECT-PROPERTIES
  {
    Date=11/01/20;
    Time=12:00:00 PM;
    Version List=UBP3.03;
  }
  PROPERTIES
  {
    CaptionML=ENU=Open Period and Day End;
    ProcessingOnly=Yes;
    OnInitReport=BEGIN
                   PeriodEndUpdate := TRUE;
                 END;

  }
  DATASET
  {
    { 3728;    ;DataItem;                    ;
               DataItemTable=Table14000553;
               DataItemTableView=SORTING(Location Code,Starting Date,Period End Closed)
                                 ORDER(Ascending);
               OnPreDataItem=BEGIN
                               IF StartingDate = 0D THEN
                                 ERROR(Text001);

                               "Location Inventory Period".SETFILTER("Starting Date", '%1..', StartingDate);

                               CASE TRUE OF
                                 PeriodEndUpdate AND DayEndUpdate:
                                   IF NOT CONFIRM(STRSUBSTNO(Text002,"Location Inventory Period".GETFILTERS),FALSE) THEN
                                     ERROR(Text003);

                                 PeriodEndUpdate:
                                   IF NOT CONFIRM(STRSUBSTNO(Text002,"Location Inventory Period".GETFILTERS),FALSE) THEN
                                     ERROR(Text003);

                                 DayEndUpdate: ERROR(Text005);
                               END;
                             END;

               OnAfterGetRecord=BEGIN
                                  IF PeriodEndUpdate THEN
                                    IF "Location Inventory Period"."Period End Closed" THEN
                                      "Location Inventory Period".OpenPeriodEnd;

                                  IF DayEndUpdate THEN
                                    IF "Location Inventory Period"."Day End Closed" THEN
                                      "Location Inventory Period".OpenDayEnd;
                                END;

               ReqFilterFields=Location Code }

    { 1240030000;1;Column;Location_Inventory_Period__Location_Code_;
               SourceExpr="Location Code" }

    { 1240030004;1;Column;Location_Inventory_Period__Starting_Date_;
               SourceExpr="Starting Date" }

    { 1240030010;1;Column;Location_Inventory_Period__Ending_Date_;
               SourceExpr="Ending Date" }

    { 1240030001;1;Column;Location_Inventory_Period__Location_Code_Caption;
               SourceExpr=FIELDCAPTION("Location Code") }

    { 1240030005;1;Column;Location_Inventory_Period__Starting_Date_Caption;
               SourceExpr=FIELDCAPTION("Starting Date") }

    { 1240030011;1;Column;Location_Inventory_Period__Ending_Date_Caption;
               SourceExpr=FIELDCAPTION("Ending Date") }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      OnInit=BEGIN
               PeriodEndUpdate := TRUE;
             END;

    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=ENU=Options }

      { 1240030002;2;Field  ;
                  CaptionML=ENU=Reopen Period Processing;
                  ApplicationArea=#All;
                  SourceExpr=PeriodEndUpdate }

      { 1240020000;2;Field  ;
                  CaptionML=ENU=Reopen Daily Processing;
                  SourceExpr=DayEndUpdate;
                  OnValidate=BEGIN
                               IF DayEndUpdate THEN
                                 PeriodEndUpdate := TRUE;
                             END;
                              }

      { 1240020001;2;Field  ;
                  Name=Starting Date;
                  SourceExpr=StartingDate;
                  OnValidate=VAR
                               UBP@1240020000 : Codeunit 14000564;
                             BEGIN
                               IF StartingDate > 0D THEN
                                 UBP.CheckForecastPeriodStartDate(StartingDate);
                             END;

                  OnLookup=VAR
                             UBP@1240020000 : Codeunit 14000564;
                           BEGIN
                             StartingDate := UBP.RunForecastPeriodPageForStartDate();
                           END;
                            }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      PeriodEndUpdate@1240030000 : Boolean;
      Text001@1240020000 : TextConst 'ENU=You must enter a Period Starting Date filter.';
      Text002@1240020001 : TextConst 'ENU=Period End and Day End will be opened for all inventory periods according to this filter: %1\Re-opening Day End processing will cause the Usage Ledger Entry to be deleted for those periods.';
      Text004@1240020003 : TextConst 'ENU=Period End will be opened for all inventory periods according to this filter: %1';
      Text003@1240020002 : TextConst 'ENU=No operation performed.';
      DayEndUpdate@1240020005 : Boolean;
      Text005@1240020006 : TextConst 'ENU="Day End cannot be opened without also opening period end.  "';
      StartingDate@1240020007 : Date;

    BEGIN
    END.
  }
  RDLDATA
  {
  }
}

