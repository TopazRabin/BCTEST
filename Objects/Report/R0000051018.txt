OBJECT Report 51018 Update RecordLink Info
{
  OBJECT-PROPERTIES
  {
    Date=09/29/20;
    Time=10:32:15 AM;
    Modified=Yes;
    Version List=TPZ000.00.00;
  }
  PROPERTIES
  {
    ProcessingOnly=Yes;
    OnInitReport=BEGIN

                   Window.OPEN('Processing Item No. #1################');
                 END;

    OnPostReport=BEGIN
                   Window.CLOSE;
                 END;

  }
  DATASET
  {
    { 1000000000;;DataItem;                  ;
               DataItemTable=Table27;
               OnPreDataItem=BEGIN
                               ItemRecCopy.RESET;
                               ItemRecCopy.DELETEALL;

                               RecRefItem.OPEN(DATABASE::Item);
                             END;

               OnAfterGetRecord=BEGIN
                                  RecRefItem.GETTABLE(Item);
                                  RecordLinkRec.SETCURRENTKEY(RecordLinkRec.Company);
                                  RecordLinkRec.SETRANGE(RecordLinkRec.Company,COMPANYNAME);

                                  RecordLinkRec.SETCURRENTKEY(RecordLinkRec."Record ID");
                                  RecordLinkRec.SETRANGE(RecordLinkRec."Record ID",RecRefItem.RECORDID);
                                  Window.UPDATE(1,"No.");
                                  IF RecordLinkRec.FINDFIRST THEN BEGIN
                                    ItemRecCopy.INIT;
                                    ItemRecCopy.TRANSFERFIELDS(Item);
                                    //ItemRecCopy."Record Link Exists" := TRUE;
                                    //ItemRecCopy."Record Link Desc." := FORMAT(RecRefItem.RECORDID);
                                    //ItemRecCopy."Link Address 1" := RecordLinkRec.URL1;

                                  END ELSE BEGIN
                                    ItemRecCopy.INIT;
                                    ItemRecCopy.TRANSFERFIELDS(Item);
                                    //ItemRecCopy."Record Link Exists" := FALSE;
                                    //ItemRecCopy."Record Link Desc." := 'No Cut Sheet Link';
                                  END;
                                  ItemRecCopy.INSERT;
                                END;
                                 }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      RecordLinkRec@1000000001 : Record 2000000068;
      RecRefItem@1000000000 : RecordRef;
      ItemRecCopy@1000000002 : Record 50014;
      Window@1000000003 : Dialog;

    BEGIN
    {
      NameDataTypeSubtype
      lRecRecordLinkRecordRecord Link
      lRecRefItemRecordRef
      lRecItemRecordItem
      ..

      lRecRefItem.OPEN( DATABASE::Item);
      lRecItem.GET("No.");
      lRecRefItem.GETTABLE( lRecItem );



      lRecRecordLink.SETCURRENTKEY(Company);
      lRecRecordLink.SETRANGE(Company,COMPANYNAME);

      lRecRecordLink.SETCURRENTKEY("Record ID");
      lRecRecordLink.SETRANGE("Record ID",lRecRefItem.RECORDID);

      MESSAGE(FORMAT(lRecRefItem.RECORDID));

      IF lRecRecordLink.FINDFIRST THEN
      gBoolAttachmentPresence := TRUE
      ELSE
      gBoolAttachmentPresence := FALSE;


      lRecRefItem.CLOSE;
    }
    END.
  }
  RDLDATA
  {
  }
}

