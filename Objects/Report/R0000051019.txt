OBJECT Report 51019 Change Job Queue Status
{
  OBJECT-PROPERTIES
  {
    Date=07/01/20;
    Time=12:00:00 AM;
    Modified=Yes;
    Version List=TPZ000.00.00;
  }
  PROPERTIES
  {
    ProcessingOnly=Yes;
    OnPostReport=BEGIN
                   MESSAGE('Batch Job Process Completed....!');
                 END;

  }
  DATASET
  {
    { 1000000000;;DataItem;                  ;
               DataItemTable=Table472;
               OnPreDataItem=BEGIN
                               JObQCatFilter := "Job Queue Entry".GETFILTER("Job Queue Entry"."Job Queue Category Code");
                               //IF JObQCatFilter = '' THEN
                                 //  ERROR('Please Enter Job Queue Category Filter');
                             END;

               OnAfterGetRecord=BEGIN
                                  IF JobQStatus = JobQStatus :: "Set Status to Ready" THEN
                                  BEGIN
                                    "Job Queue Entry".VALIDATE("Earliest Start Date/Time",  CURRENTDATETIME);
                                    //ERROR('%1', "Earliest Start Date/Time");
                                    "Job Queue Entry".MODIFY;
                                    "Job Queue Entry".SetStatus(Status::Ready);
                                  END ELSE IF JobQStatus = JobQStatus :: "Set on Hold" THEN
                                  BEGIN
                                    "Job Queue Entry".SetStatus(Status::"On Hold");
                                  END ELSE IF JobQStatus = JobQStatus :: Restart THEN
                                  BEGIN
                                    "Job Queue Entry".Restart;
                                  END;
                                  IF JobQStatus = JobQStatus ::"Clear Earlier Start Date" THEN
                                  BEGIN
                                    "Job Queue Entry"."Earliest Start Date/Time" := 0DT;
                                    "Job Queue Entry".MODIFY;
                                  END;
                                  IF JobQStatus = JobQStatus ::"Update Earlier Start DateTime" THEN
                                  BEGIN
                                    IF EarlierStartDateTime <> 0DT THEN BEGIN
                                      "Job Queue Entry"."Earliest Start Date/Time" := EarlierStartDateTime;
                                      "Job Queue Entry".MODIFY;
                                    END ELSE
                                      ERROR('Earlier Start Date-Time must have ABS value to update Earlier Start Date/Time in job queue entries');
                                  END;
                                END;

               ReqFilterFields=Job Queue Category Code }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
      { 1000000003;;Container;
                  ContainerType=ContentArea }

      { 1000000002;1;Group  ;
                  CaptionML=ENU=Options;
                  GroupType=Group }

      { 1000000001;2;Field  ;
                  CaptionML=ENU=Job Queue Status;
                  SourceExpr=JobQStatus }

      { 1000000000;2;Field  ;
                  CaptionML=ENU=Earlier Start Date-Time;
                  SourceExpr=EarlierStartDateTime }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      JobQStatus@1000000000 : ' ,Set Status to Ready,Set on Hold,Restart,Clear Earlier Start Date,Update Earlier Start DateTime';
      JObQCatFilter@1000000001 : Text;
      EarlierStartDateTime@1000000002 : DateTime;

    BEGIN
    END.
  }
  RDLDATA
  {
  }
}

