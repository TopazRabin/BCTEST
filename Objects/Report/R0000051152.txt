OBJECT Report 51152 Export Purchase Price
{
  OBJECT-PROPERTIES
  {
    Date=07/01/20;
    Time=12:00:00 AM;
    Modified=Yes;
    Version List=TPZ000.00.00;
  }
  PROPERTIES
  {
    CaptionML=ENU=Export Purchase Price;
    ProcessingOnly=Yes;
  }
  DATASET
  {
    { 1000000001;0;DataItem;                 ;
               DataItemTable=Table7012;
               OnPreDataItem=BEGIN
                               TempExcelBuffer.DELETEALL;
                               CLEAR(TempExcelBuffer);
                               RowNo := 1;
                               EnterCell(RowNo,1,FIELDCAPTION("Vendor No."),TRUE,FALSE,FALSE,'',1);
                               EnterCell(RowNo,2,FIELDCAPTION("Item No."),TRUE,FALSE,FALSE,'',1);
                               EnterCell(RowNo,3,FIELDCAPTION("Direct Unit Cost"),TRUE,FALSE,FALSE,'',1);
                             END;

               OnAfterGetRecord=BEGIN
                                  RowNo := RowNo + 1;
                                  EnterCell(RowNo,1,"Vendor No.",FALSE,FALSE,FALSE,'',1);
                                  EnterCell(RowNo,2,"Item No.",FALSE,FALSE,FALSE,'',1);
                                  EnterCell(RowNo,3,FORMAT("Direct Unit Cost"),FALSE,FALSE,FALSE,'',1);
                                END;

               OnPostDataItem=BEGIN
                                //<TPZ2767>
                                IF RunInBatchMode THEN BEGIN
                                  CreateBookAndSaveExcel(ExportFileName,'Vendor Purchase Price','Vendor Purchase Price',COMPANYNAME,USERID);
                                END ELSE BEGIN//</TPZ2767>
                                  TempExcelBuffer.CreateBook('','Vendor Purchase Price');
                                  TempExcelBuffer.WriteSheet('',COMPANYNAME,USERID);
                                  TempExcelBuffer.CloseBook;
                                  TempExcelBuffer.OpenExcel;
                                  TempExcelBuffer.GiveUserControl;
                                END;//<TPZ2767>
                              END;

               ReqFilterFields=Vendor No.,Item No. }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      SalesLine@1000000006 : Record 37;
      TempExcelBuffer@1000000000 : TEMPORARY Record 370;
      Language@1000000002 : Record 8;
      Window@1000000003 : Dialog;
      TotalRecNo@1000000005 : Integer;
      RowNo@1000000001 : Integer;
      Text51000@1000000004 : TextConst 'ENU=Exporting Data...\\;ESM=Analizar Datos...\\;FRC=Analyse des donn‚es...\\;ENC=Analysing Data...\\';
      RunInBatchMode@1000000008 : Boolean;
      ExportFileName@1000000007 : Text;

    LOCAL PROCEDURE EnterCell@2(RowNo@1000 : Integer;ColumnNo@1001 : Integer;CellValue@1002 : Text[50];Bold@1003 : Boolean;Italic@1004 : Boolean;UnderLine@1005 : Boolean;NumberFormat@1000000000 : Text[30];CellType@1000000001 : 'Number,Text,Date,Time');
    BEGIN
      TempExcelBuffer.INIT;
      TempExcelBuffer.VALIDATE("Row No.",RowNo);
      TempExcelBuffer.VALIDATE("Column No.",ColumnNo);
      TempExcelBuffer."Cell Value as Text" := CellValue;
      TempExcelBuffer.Formula := '';
      TempExcelBuffer.Bold := Bold;
      TempExcelBuffer.Italic := Italic;
      TempExcelBuffer.Underline := UnderLine;
      TempExcelBuffer.NumberFormat := NumberFormat;
      TempExcelBuffer."Cell Type" := CellType;
      TempExcelBuffer.INSERT;
    END;

    PROCEDURE SetDeFaultExportParam@1000000000();
    VAR
      DateFormatStr@1000000000 : Text;
      ReportUser@1000000001 : Record 50015;
      ExportPurchasePrice@1000000002 : Report 51152;
    BEGIN
      //<TPZ2767>
      RunInBatchMode := TRUE;
      ReportUser.GET(FORMAT(COPYSTR(ExportPurchasePrice.OBJECTID(FALSE),8,15)));
      ExportFileName :=  ReportUser."File Path"+ExportPurchasePrice.OBJECTID(TRUE)+FORMAT(WORKDATE,0,5)+'.xlsx';
      //</TPZ2767>
    END;

    PROCEDURE CreateBookAndSaveExcel@1000000043(FileName@1000000000 : Text;SheetName@1000000001 : Text[250];ReportHeader@1000000002 : Text;CompanyName2@1000000004 : Text;UserId2@1000000005 : Text);
    BEGIN
      //<TPZ2767>
      TempExcelBuffer.CreateBook('','Vendor Purchase Price');
      TempExcelBuffer.WriteSheet('Vendor Purchase Price','Vendor Purchase Price',COMPANYNAME);
      TempExcelBuffer.CloseBook;
      TempExcelBuffer.MoveBookInServer(FileName);
      //</TPZ2767>
    END;

    BEGIN
    {
      02-12-2020 UCHOUHAN TPZ2767
        Added new function and code for automated export Vendor Price.
    }
    END.
  }
  RDLDATA
  {
  }
}

