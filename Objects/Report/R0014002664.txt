OBJECT Report 14002664 Exp. Forc. Sum. Excel
{
  OBJECT-PROPERTIES
  {
    Date=03/01/20;
    Time=12:00:00 PM;
    Version List=UBP3.02;
  }
  PROPERTIES
  {
    CaptionML=ENU=Export Forecast Sum. to Excel;
    ProcessingOnly=Yes;
    OnPreReport=BEGIN
                  First := TRUE;
                END;

    OnPostReport=BEGIN
                   AFPExcelCreate.Complete(STRSUBSTNO(Text000,"Forecast Summary View"."Forecast Summary Code"));
                 END;

  }
  DATASET
  {
    { 1525;    ;DataItem;                    ;
               DataItemTable=Table14000585;
               ReqFilterFields=Forecast Summary Code }

    { 9343;1   ;DataItem;                    ;
               DataItemTable=Table14000586;
               OnPreDataItem=BEGIN
                               IF GUIALLOWED THEN BEGIN
                                 ProgWindow.OPEN(
                                   Text004 + '\' +
                                   Text005 + ' #1############################################');
                               END;
                             END;

               OnAfterGetRecord=VAR
                                  i@1240020000 : Integer;
                                BEGIN
                                  IF GUIALLOWED THEN
                                    ProgWindow.UPDATE(1,"Forecast Summary"."Summary Code");

                                  IF First THEN
                                    Bold := TRUE
                                  ELSE
                                    Bold := FALSE;
                                  IF First THEN BEGIN
                                    CLEAR(AFPExcelCreate);
                                    AFPExcelCreate.CreateBook;
                                    AFPExcelCreate.AddNewSheet(STRSUBSTNO(Text000,"Forecast Summary View"."Forecast Summary Code"));
                                    AFPExcelCreate.EnterIntoNextColumn(Text001,TRUE,TRUE,Bold,20);
                                    AFPExcelCreate.EnterIntoNextColumn(Text002,FALSE,FALSE,Bold,10);
                                    AFPExcelCreate.EnterIntoNextColumn(Text003,FALSE,FALSE,Bold,12);
                                    AFPExcelCreate.EnterIntoNextRow("Forecast Summary"."Summary Code",TRUE,FALSE,Bold,20);
                                    AFPExcelCreate.EnterIntoNextColumn(FORMAT("Forecast Summary".Level),FALSE,FALSE,Bold,10);
                                    AFPExcelCreate.EnterIntoNextColumn(FORMAT("Forecast Summary View"."Forecast Unit"),FALSE,FALSE,Bold,10);
                                    First := FALSE;
                                  END ELSE BEGIN
                                    AFPExcelCreate.EnterIntoNextRow("Forecast Summary"."Summary Code",TRUE,FALSE,Bold,20);
                                    AFPExcelCreate.EnterIntoNextColumn(FORMAT("Forecast Summary".Level),FALSE,FALSE,Bold,10);
                                    AFPExcelCreate.EnterIntoNextColumn(FORMAT("Forecast Summary View"."Forecast Unit"),FALSE,FALSE,Bold,10);
                                  END;

                                  FOR i := 1 TO "Forecast Summary View"."Forecast Periods" DO BEGIN
                                    ExpForcSummaryPeriod(i);
                                  END;
                                END;

               OnPostDataItem=BEGIN
                                IF GUIALLOWED THEN
                                  ProgWindow.CLOSE;
                              END;

               DataItemLink=Forecast View Code=FIELD(Forecast Summary Code) }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      AFPExcelCreate@1240030000 : Codeunit 14000587;
      Text000@1240030001 : TextConst 'ENU=Forecast Summary %1';
      Text001@1240030002 : TextConst 'ENU=Summary Code';
      Text002@1240030003 : TextConst 'ENU=Level';
      Text003@1240030004 : TextConst 'ENU=Forecast Unit';
      ProgWindow@1240020000 : Dialog;
      Bold@1240030006 : Boolean;
      First@1240030005 : Boolean;
      Text004@1240020001 : TextConst 'ENU=Export Forecast Summary';
      Text005@1240020002 : TextConst 'ENU=Summary Code';

    LOCAL PROCEDURE ExpForcSummaryPeriod@1240020000(VAR CurrPeriod@1240020000 : Integer);
    BEGIN
      CASE CurrPeriod OF
        1: AFPExcelCreate.EnterIntoNextColumn("Forecast Summary"."Period 1",FALSE,FALSE,Bold,10);
        2: AFPExcelCreate.EnterIntoNextColumn("Forecast Summary"."Period 2",FALSE,FALSE,Bold,10);
        3: AFPExcelCreate.EnterIntoNextColumn("Forecast Summary"."Period 3",FALSE,FALSE,Bold,10);
        4: AFPExcelCreate.EnterIntoNextColumn("Forecast Summary"."Period 4",FALSE,FALSE,Bold,10);
        5: AFPExcelCreate.EnterIntoNextColumn("Forecast Summary"."Period 5",FALSE,FALSE,Bold,10);
        6: AFPExcelCreate.EnterIntoNextColumn("Forecast Summary"."Period 6",FALSE,FALSE,Bold,10);
        7: AFPExcelCreate.EnterIntoNextColumn("Forecast Summary"."Period 7",FALSE,FALSE,Bold,10);
        8: AFPExcelCreate.EnterIntoNextColumn("Forecast Summary"."Period 8",FALSE,FALSE,Bold,10);
        9: AFPExcelCreate.EnterIntoNextColumn("Forecast Summary"."Period 9",FALSE,FALSE,Bold,10);
        10: AFPExcelCreate.EnterIntoNextColumn("Forecast Summary"."Period 10",FALSE,FALSE,Bold,10);
        11: AFPExcelCreate.EnterIntoNextColumn("Forecast Summary"."Period 11",FALSE,FALSE,Bold,10);
        12: AFPExcelCreate.EnterIntoNextColumn("Forecast Summary"."Period 12",FALSE,FALSE,Bold,10);
        13: AFPExcelCreate.EnterIntoNextColumn("Forecast Summary"."Period 13",FALSE,FALSE,Bold,10);
        14: AFPExcelCreate.EnterIntoNextColumn("Forecast Summary"."Period 14",FALSE,FALSE,Bold,10);
        15: AFPExcelCreate.EnterIntoNextColumn("Forecast Summary"."Period 15",FALSE,FALSE,Bold,10);
      END;
    END;

    BEGIN
    END.
  }
  RDLDATA
  {
  }
}

