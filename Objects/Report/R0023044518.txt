OBJECT Report 23044518 WHI Pre-Import Upgrade
{
  OBJECT-PROPERTIES
  {
    Date=10/03/19;
    Time=[ 3:56:02 PM];
    Version List=WHI2.4.7684.0;
  }
  PROPERTIES
  {
    ProcessingOnly=Yes;
    OnPostReport=BEGIN
                   MESSAGE(tcComplete);
                 END;

  }
  DATASET
  {
    { 1000000000;;DataItem;                  ;
               DataItemTable=Table2000000006;
               OnAfterGetRecord=BEGIN
                                  updateColumns;
                                END;
                                 }

    { 1000000001;1;DataItem;                 ;
               DataItemTable=Table23044504;
               OnPreDataItem=BEGIN
                               CHANGECOMPANY(Company.Name);
                             END;

               OnAfterGetRecord=VAR
                                  recRef@1000000000 : RecordRef;
                                BEGIN
                                  rrRecRef.GETTABLE("WMDM PDA Configuration");

                                  // 1.6 Changes
                                  clearMaxCountLines;
                                  clearEnforceBOM;

                                  // 1.7 Changes
                                  clearTrackActivity;

                                  clearQuantityBehavior;
                                  clearForceReceiptItemScan;
                                  clearForceShipmentItemScan;
                                  clearNewLineInventoryMove;

                                  // 1.8 Changes
                                  clearReceiptQuantityValidation;
                                  clearPOSQuantity;
                                  clearPOSPrompt;
                                  clearMovementOption;
                                END;
                                 }

    { 1000000002;1;DataItem;                 ;
               DataItemTable=Table23044502;
               OnPreDataItem=BEGIN
                               CHANGECOMPANY(Company.Name);
                             END;

               OnAfterGetRecord=BEGIN
                                  // 1.7 Changes
                                  clearTrackActivity;
                                  clearAssignLotWhseBehavior;
                                END;
                                 }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      tcComplete@1000000000 : TextConst 'ENU=The pre-upgrade is complete.;ESM=La previa a la actualizaci¢n se ha completado.;FRC=La pr‚- mise … niveau est termin‚e.;ENC=The pre-upgrade is complete.';
      rrRecRef@1000000001 : RecordRef;
      frCurrentField@1000000002 : FieldRef;

    PROCEDURE getFieldByName@1000000007(psFieldName@1000000001 : Text[100]) : Boolean;
    VAR
      liFieldIndex@1000000003 : Integer;
    BEGIN
      psFieldName := LOWERCASE(psFieldName);
      FOR liFieldIndex:= 1 TO rrRecRef.FIELDCOUNT DO BEGIN
        frCurrentField := rrRecRef.FIELDINDEX(liFieldIndex);
        IF( LOWERCASE(frCurrentField.NAME) = psFieldName ) THEN
          EXIT(TRUE);
      END;

      EXIT(FALSE);
    END;

    PROCEDURE clearMaxCountLines@1000000003();
    BEGIN
      // in 1.6 "Max Count Lines" was removed.
      IF( getFieldByName('Max Count Lines') ) THEN BEGIN
        frCurrentField.VALIDATE(0);
        rrRecRef.MODIFY;
      END;
    END;

    PROCEDURE clearEnforceBOM@1000000005();
    BEGIN
      // in 1.6 "Enforce BOM" was converted to an option.  Note: Not saving existing settings
      IF( getFieldByName('Enforce BOM') ) THEN BEGIN
        IF( FORMAT(frCurrentField.TYPE) = 'Boolean' ) THEN BEGIN
          frCurrentField.VALIDATE(FALSE);
          rrRecRef.MODIFY;
        END;
      END;
    END;

    PROCEDURE clearTrackActivity@1000000000();
    BEGIN
      // in 1.7 the "Track Activities" field was removed
      IF( getFieldByName('Track PDA Activities') ) THEN BEGIN
        frCurrentField.VALIDATE(FALSE);
        rrRecRef.MODIFY;
      END;
    END;

    PROCEDURE clearQuantityBehavior@1000000001();
    BEGIN
      // in 1.7 the "Quantity Behavior" field was removed
      IF( getFieldByName('Quantity Behavior') ) THEN BEGIN
        frCurrentField.VALIDATE(0);
        rrRecRef.MODIFY;
      END;
    END;

    PROCEDURE clearForceReceiptItemScan@1000000002();
    BEGIN
      // in 1.7 the "Force Item Scan on Receipt" field was removed
      IF( getFieldByName('Force Item Scan on Receipt') ) THEN BEGIN
        frCurrentField.VALIDATE(FALSE);
        rrRecRef.MODIFY;
      END;
    END;

    PROCEDURE clearForceShipmentItemScan@1000000004();
    BEGIN
      // in 1.7 the "Force Item Scan on Shipment" field was removed
      IF( getFieldByName('Force Item Scan on Shipment') ) THEN BEGIN
        frCurrentField.VALIDATE(FALSE);
        rrRecRef.MODIFY;
      END;
    END;

    PROCEDURE clearAssignLotWhseBehavior@1000000006();
    BEGIN
      // in 1.7 the "Assign Lot Whse Behavior" field was removed
      IF( getFieldByName('Assign Lot Whse Behavior') ) THEN BEGIN
        frCurrentField.VALIDATE(0);
        rrRecRef.MODIFY;
      END;
    END;

    PROCEDURE clearNewLineInventoryMove@1000000008();
    BEGIN
      // in 1.7 the "Allow New Line on Inv. Move" field was removed
      IF( getFieldByName('Allow New Line on Inv. Move') ) THEN BEGIN
        frCurrentField.VALIDATE(FALSE);
        rrRecRef.MODIFY;
      END;
    END;

    PROCEDURE updateColumns@1000000009();
    VAR
      lrecColumns@1000000000 : Record 23044512;
    BEGIN
      // in 1.7 the 'Quantity' column for event 10001 was changed to a calculated column '-1'
      lrecColumns.SETRANGE("Event",10001);
      lrecColumns.SETRANGE("Table No.",7302);
      lrecColumns.SETRANGE("Field No.",26);
      IF( lrecColumns.FINDFIRST ) THEN
        lrecColumns.DELETE;
    END;

    PROCEDURE clearReceiptQuantityValidation@1000000010();
    BEGIN
      // in 1.8 removed Receipt Quantity Validation field
      IF( getFieldByName('Receipt Quantity Validation') ) THEN BEGIN
        frCurrentField.VALIDATE(0);
        rrRecRef.MODIFY;
      END;
    END;

    PROCEDURE clearPOSQuantity@1000000012();
    BEGIN
      // in 1.8 POS Default Qty. field was removed
      IF( getFieldByName('POS Default Qty.') ) THEN BEGIN
        frCurrentField.VALIDATE(0);
        rrRecRef.MODIFY;
      END;
    END;

    PROCEDURE clearPOSPrompt@1000000016();
    BEGIN
      // in 1.8 POS Prompt Qty. field was removed
      IF( getFieldByName('POS Prompt Qty.') ) THEN BEGIN
        frCurrentField.VALIDATE(FALSE);
        rrRecRef.MODIFY;
      END;
    END;

    PROCEDURE clearMovementOption@1000000011();
    BEGIN
      // in 1.8 Movement Option field was removed
      IF( getFieldByName('Movement Option') ) THEN BEGIN
        frCurrentField.VALIDATE(0);
        rrRecRef.MODIFY;
      END;
    END;

    BEGIN
    {
      ************************
      Copyright Notice
      This objects content is copyright of Insight Works 2011.  All rights reserved.
      Any redistribution or reproduction of part or all of the contents in any form is prohibited.
      ************************
    }
    END.
  }
  RDLDATA
  {
  }
}

