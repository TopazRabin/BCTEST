OBJECT Report 51150 Update Customers Data Cleanup
{
  OBJECT-PROPERTIES
  {
    Date=07/01/20;
    Time=12:00:00 AM;
    Modified=Yes;
    Version List=TPZ000.00.00;
  }
  PROPERTIES
  {
    ProcessingOnly=Yes;
  }
  DATASET
  {
    { 1000000000;;DataItem;                  ;
               DataItemTable=Table18;
               OnPreDataItem=BEGIN
                               ProgressWindow.OPEN(Text50001);
                             END;

               OnAfterGetRecord=BEGIN
                                  IF (Customer."Shipping Agent Code"<>'LOCAL') OR (Customer."Shipping Payment Type"<>Customer."Shipping Payment Type"::Prepaid) THEN BEGIN
                                    ProgressWindow.UPDATE(1,Customer."No.");
                                    IF (Customer."Shipping Agent Code"<>'LOCAL') THEN
                                      Customer.VALIDATE("Shipping Agent Code",'');
                                    IF Customer."Shipping Payment Type"<>Customer."Shipping Payment Type"::Prepaid THEN
                                      Customer.VALIDATE("Shipping Payment Type",Customer."Shipping Payment Type"::Prepaid);
                                    Customer.MODIFY(TRUE);
                                  END;
                                END;

               OnPostDataItem=BEGIN
                                ProgressWindow.CLOSE;
                              END;
                               }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      ProgressWindow@1000000000 : Dialog;
      Text50001@1000000001 : TextConst 'ENU=Updating Customer No #1#######';

    BEGIN
    END.
  }
  RDLDATA
  {
  }
}

