OBJECT Report 14050307 Receive All E.D.I. Docs. Job
{
  OBJECT-PROPERTIES
  {
    Date=11/11/13;
    Time=12:00:00 PM;
    Version List=SE0.60;
  }
  PROPERTIES
  {
    CaptionML=ENU=Receive All E.D.I. Documents Job;
    ProcessingOnly=Yes;
    OnInitReport=BEGIN
                   TotalFileCount := 0;
                   TotalErrorFileCount := 0;
                 END;

    OnPreReport=BEGIN
                  EDISetup.GET;

                  CLEAR(EDIFileProcessing);
                  TotalErrorFileCount := EDIFileProcessing.ProcessFileSplit(TRUE);

                  CompanyInformation.GET;
                END;

    UseRequestPage=No;
  }
  DATASET
  {
    { 1529;    ;DataItem;                    ;
               DataItemTable=Table14002360;
               ReqFilterFields=No. }

    { 1534;1   ;DataItem;                    ;
               DataItemTable=Table14002353;
               DataItemTableView=SORTING(Trade Partner No.,Navision Document,EDI Document No.,Version,Type)
                                 ORDER(Ascending)
                                 WHERE(Status=FILTER(<>Inactive),
                                       Type=CONST(Import));
               OnPreDataItem=BEGIN
                               FileCount := 0;
                             END;

               OnAfterGetRecord=BEGIN
                                  CLEAR(EDIFileProcessing);
                                  TotalFileCount :=
                                    EDIFileProcessing.ProcessEDIFile("E.D.I. Document",TRUE) +
                                    TotalFileCount;
                                  TotalErrorFileCount := EDIFileProcessing.GetErrorCount + TotalErrorFileCount;
                                  FileCount := EDIFileProcessing.GetFileCount;
                                END;

               OnPostDataItem=BEGIN
                                EDIFileProcessing.SendAcknowledgement("E.D.I. Document");
                              END;

               ReqFilterFields=Navision Document,EDI Document No.;
               DataItemLink=Trade Partner No.=FIELD(No.) }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      CompanyInformation@1240030000 : Record 79;
      EDISetup@1240020008 : Record 14002367;
      EDIFileProcessing@1240020021 : Codeunit 14002389;
      FileCount@1240020003 : Integer;
      TotalFileCount@1240020004 : Integer;
      TotalErrorFileCount@1240020019 : Integer;

    BEGIN
    END.
  }
  RDLDATA
  {
  }
}

