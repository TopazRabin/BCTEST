OBJECT Report 14123801 ES Create New User
{
  OBJECT-PROPERTIES
  {
    Date=09/01/17;
    Time=12:00:00 PM;
    Version List=ES1.41.40;
  }
  PROPERTIES
  {
    CaptionML=ENU=Create New User;
    ProcessingOnly=Yes;
  }
  DATASET
  {
    { 4544;    ;DataItem;                    ;
               DataItemTable=Table14123805;
               OnPreDataItem=BEGIN
                               IF GETFILTER("User ID") = '' THEN
                                 ERROR(Text001,FIELDCAPTION("User ID"));

                               LoginMgt.ValidateUserID(NewUserID);
                             END;

               OnAfterGetRecord=BEGIN
                                  IF NOT ESUserSecuritySetup.GET(NewUserID,"Source Table ID") THEN BEGIN
                                    ESUserSecuritySetup.INIT;
                                    ESUserSecuritySetup.VALIDATE("User ID",NewUserID);
                                    ESUserSecuritySetup.VALIDATE("Source Table ID","Source Table ID");
                                    IF SameAsUserID = '' THEN BEGIN
                                      ESUserSecuritySetup.VALIDATE("Field Level Security Code","Field Level Security Code");
                                      ESUserSecuritySetup.VALIDATE("Data Security Code","Data Security Code");
                                    END ELSE
                                      ESUserSecuritySetup.VALIDATE("Security as User ID",SameAsUserID);
                                    ESUserSecuritySetup.INSERT(TRUE);

                                    NewRecords := NewRecords + 1;
                                  END ELSE
                                    ExistingRecords := ExistingRecords + 1;
                                END;

               OnPostDataItem=BEGIN
                                MESSAGE(Text002,NewRecords,ExistingRecords);
                              END;

               ReqFilterFields=User ID,Source Table ID,Field Level Security Code,Data Security Code }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      SaveValues=Yes;
    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=ENU=Options }

      { 1240520008;2;Field  ;
                  CaptionML=ENU=New User ID;
                  SourceExpr=NewUserID;
                  OnLookup=BEGIN
                             LoginMgt.LookupUserID(NewUserID);
                           END;
                            }

      { 1240520010;2;Field  ;
                  CaptionML=ENU=Security as User ID;
                  SourceExpr=SameAsUserID;
                  TableRelation="ES User Security Setup" }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      ESUserSecuritySetup@1240520013 : Record 14123805;
      LoginMgt@1240520010 : Codeunit 418;
      NewUserID@1240520008 : Code[50];
      SameAsUserID@1240520009 : Code[50];
      NewRecords@1240520011 : Integer;
      ExistingRecords@1240520012 : Integer;
      Text001@1001 : TextConst 'ENU=%1 must be filtered.';
      Text002@1002 : TextConst 'ENU=%1 new records, %2 already exists.';

    BEGIN
    END.
  }
  RDLDATA
  {
  }
}

