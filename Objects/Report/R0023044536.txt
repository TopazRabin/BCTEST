OBJECT Report 23044536 WHI Sample Item 6x4 Label
{
  OBJECT-PROPERTIES
  {
    Date=10/03/19;
    Time=[ 3:59:23 PM];
    Version List=WHI2.4.7684.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=WHI Sample Item 6x4 Label;
               ESM=WHI Muestra la etiqueta de tema 6 x 4;
               FRC=WHI Exemple d'‚tiquette point 6 x 4;
               ENC=WHI Sample Item 6x4 Label];
  }
  DATASET
  {
    { 1000000007;;DataItem;diItemLedgerEntry ;
               DataItemTable=Table32;
               DataItemTableView=SORTING(Entry No.)
                                 ORDER(Descending);
               OnPreDataItem=BEGIN
                               //The 'Entry No.' is being set on the RecordRef in the PrintDirectly function in CU 23044525
                               // This will clear that filter
                               diItemLedgerEntry.SETRANGE("Entry No.");
                             END;

               OnAfterGetRecord=BEGIN
                                  //GUIALLOWED check to see if the request is being made from the device or from NAV CLient
                                  // since the device uses Item Ledger Entries
                                  IF GUIALLOWED THEN
                                    CurrReport.BREAK
                                  ELSE BEGIN
                                    addLedgerItemLabel(diItemLedgerEntry);
                                  END;
                                END;
                                 }

    { 1000000006;;DataItem;diItem            ;
               DataItemTable=Table27;
               OnAfterGetRecord=BEGIN
                                  //If it is GUIALLOWED, then the request was made from NAV, otherwise no more processing needed
                                  IF NOT GUIALLOWED THEN
                                    CurrReport.BREAK;

                                  //If no specific filters were set on the request form of the report in NAV for the Item Ledger Entry
                                  // section, then only print one item label with no lot tracking information on it
                                  IF NOT diItemLedgerEntryClient.HASFILTER THEN
                                    addBaseItemLabel(diItem);
                                END;

               ReqFilterFields=No. }

    { 1000000005;1;DataItem;diItemLedgerEntryClient;
               DataItemTable=Table32;
               DataItemTableView=ORDER(Descending)
                                 WHERE(Open=CONST(Yes));
               OnAfterGetRecord=BEGIN
                                  addLedgerItemLabel(diItemLedgerEntryClient);
                                END;

               ReqFilterFields=Location Code,Lot No.,Serial No.;
               DataItemLink=Item No.=FIELD(No.) }

    { 1000000004;;DataItem;Integer           ;
               DataItemTable=Table2000000026;
               DataItemTableView=SORTING(Number);
               OnPreDataItem=BEGIN
                               trecItemTracingBuffer.RESET;
                               SETRANGE(Number, 1, trecItemTracingBuffer.COUNT);
                             END;

               OnAfterGetRecord=BEGIN
                                  IF Number = 1 THEN
                                    trecItemTracingBuffer.FIND('-')
                                  ELSE
                                    trecItemTracingBuffer.NEXT;
                                END;
                                 }

    { 1000000003;1;Column;trecItemTracingBuffer_ItemNo;
               SourceExpr=trecItemTracingBuffer."Item No." }

    { 1000000002;1;Column;trecItemTracingBuffer_LotNo;
               SourceExpr=trecItemTracingBuffer."Lot No." }

    { 1000000000;1;Column;trecItemTracingBuffer_SerialNo;
               SourceExpr=trecItemTracingBuffer."Serial No." }

    { 1000000001;1;Column;trecItemTracingBuffer_Description;
               SourceExpr=trecItemTracingBuffer."Item Description" }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      trecItemTracingBuffer@1000000002 : TEMPORARY Record 6520;
      recItem@1000000001 : Record 27;
      iCount@1000000000 : Integer;

    PROCEDURE addLedgerItemLabel@1000000016(precItemLedgerEntry@1000000000 : Record 32);
    BEGIN
      //Function to add Item Ledger Entry and Item Tracking information

      //Checks for duplicates.  Also, if the base item function was called, then no more items will be
      // added and only one label will be printed.
      trecItemTracingBuffer.RESET;
      trecItemTracingBuffer.SETRANGE("Item No.", precItemLedgerEntry."Item No.");
      trecItemTracingBuffer.SETRANGE("Lot No.", precItemLedgerEntry."Lot No.");
      trecItemTracingBuffer.SETRANGE("Serial No.", precItemLedgerEntry."Serial No.");
      IF trecItemTracingBuffer.FINDFIRST THEN
        EXIT;

      //If it makes it here don't want to have labels that do not also show the item tracking info
      // so take the first 'base' label that would have been inserted since there was no filters set
      // on the request page, and change that to a label with the first set of item tracking info.
      trecItemTracingBuffer.RESET;
      trecItemTracingBuffer.SETRANGE("Item No.", precItemLedgerEntry."Item No.");
      trecItemTracingBuffer.SETFILTER("Lot No.", '%1','');
      trecItemTracingBuffer.SETFILTER("Serial No.", '%1','');
      IF trecItemTracingBuffer.FINDFIRST THEN BEGIN
        trecItemTracingBuffer."Lot No." := precItemLedgerEntry."Lot No.";
        trecItemTracingBuffer."Serial No." := precItemLedgerEntry."Serial No.";
        trecItemTracingBuffer.MODIFY;
      END
      //Continue with the rest of the item ledger entries
      ELSE BEGIN
        trecItemTracingBuffer.INIT;
        trecItemTracingBuffer."Item No." := precItemLedgerEntry."Item No.";
        trecItemTracingBuffer."Lot No." := precItemLedgerEntry."Lot No.";
        trecItemTracingBuffer."Serial No." := precItemLedgerEntry."Serial No.";
        recItem.SETRANGE("No.", precItemLedgerEntry."Item No.");
        IF recItem.FINDFIRST THEN
          trecItemTracingBuffer."Item Description" := recItem.Description
        ELSE
          trecItemTracingBuffer."Item Description" := 'N/A';
        trecItemTracingBuffer."Line No." := iCount;
        trecItemTracingBuffer.INSERT;
        iCount := iCount + 1;
      END;
    END;

    PROCEDURE addBaseItemLabel@1000000021(precItem@1000000000 : Record 27);
    BEGIN
      //Function to only add Item number and description information

      trecItemTracingBuffer.SETRANGE("Item No.", precItem."No.");
      trecItemTracingBuffer.INIT;
      trecItemTracingBuffer."Item No." := precItem."No.";
      trecItemTracingBuffer."Item Description" := precItem.Description;
      trecItemTracingBuffer."Line No." := iCount;
      trecItemTracingBuffer.INSERT;
      iCount := iCount + 1;
    END;

    BEGIN
    {
      ************************
      Copyright Notice
      This objects content is copyright of Insight Works 2011.  All rights reserved.
      Any redistribution or reproduction of part or all of the contents in any form is prohibited.
      ************************
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2016/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
    </DataSource>
  </DataSources>
  <DataSets>
    <DataSet Name="DataSet_Result">
      <Query>
        <DataSourceName>DataSource</DataSourceName>
        <CommandText />
      </Query>
      <Fields>
        <Field Name="trecItemTracingBuffer_ItemNo">
          <DataField>trecItemTracingBuffer_ItemNo</DataField>
        </Field>
        <Field Name="trecItemTracingBuffer_LotNo">
          <DataField>trecItemTracingBuffer_LotNo</DataField>
        </Field>
        <Field Name="trecItemTracingBuffer_SerialNo">
          <DataField>trecItemTracingBuffer_SerialNo</DataField>
        </Field>
        <Field Name="trecItemTracingBuffer_Description">
          <DataField>trecItemTracingBuffer_Description</DataField>
        </Field>
      </Fields>
    </DataSet>
  </DataSets>
  <ReportSections>
    <ReportSection>
      <Body>
        <ReportItems>
          <Tablix Name="Tablix1">
            <TablixBody>
              <TablixColumns>
                <TablixColumn>
                  <Width>6in</Width>
                </TablixColumn>
              </TablixColumns>
              <TablixRows>
                <TablixRow>
                  <Height>4in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Rectangle Name="Rectangle2">
                          <ReportItems>
                            <Textbox Name="Textbox18">
                              <KeepTogether>true</KeepTogether>
                              <Paragraphs>
                                <Paragraph>
                                  <TextRuns>
                                    <TextRun>
                                      <Value>="Item:  " + Fields!trecItemTracingBuffer_ItemNo.Value</Value>
                                      <Style>
                                        <FontSize>=iif(len(Fields!trecItemTracingBuffer_ItemNo.Value) &gt; 12, "24pt", "28pt")</FontSize>
                                      </Style>
                                    </TextRun>
                                  </TextRuns>
                                  <Style>
                                    <TextAlign>Center</TextAlign>
                                  </Style>
                                </Paragraph>
                              </Paragraphs>
                              <rd:DefaultName>Textbox18</rd:DefaultName>
                              <Top>1.91945in</Top>
                              <Left>0.20417in</Left>
                              <Height>0.45834in</Height>
                              <Width>5.54167in</Width>
                              <Style>
                                <Border>
                                  <Style>None</Style>
                                </Border>
                              </Style>
                            </Textbox>
                            <Textbox Name="Textbox19">
                              <KeepTogether>true</KeepTogether>
                              <Paragraphs>
                                <Paragraph>
                                  <TextRuns>
                                    <TextRun>
                                      <Value>=Fields!trecItemTracingBuffer_Description.Value</Value>
                                      <Style>
                                        <FontSize>=iif(len(Fields!trecItemTracingBuffer_Description.Value) &gt; 30, "18pt", "28pt")</FontSize>
                                      </Style>
                                    </TextRun>
                                  </TextRuns>
                                  <Style>
                                    <TextAlign>Center</TextAlign>
                                  </Style>
                                </Paragraph>
                              </Paragraphs>
                              <rd:DefaultName>Textbox19</rd:DefaultName>
                              <Top>0.2979in</Top>
                              <Left>0.20417in</Left>
                              <Height>0.59375in</Height>
                              <Width>5.54167in</Width>
                              <ZIndex>1</ZIndex>
                              <Style>
                                <Border>
                                  <Style>None</Style>
                                </Border>
                              </Style>
                            </Textbox>
                            <Textbox Name="Textbox21">
                              <KeepTogether>true</KeepTogether>
                              <Paragraphs>
                                <Paragraph>
                                  <TextRuns>
                                    <TextRun>
                                      <Value>=iif(Fields!trecItemTracingBuffer_SerialNo.Value &lt;&gt; "", "S/N: " + Fields!trecItemTracingBuffer_SerialNo.Value, iif(Fields!trecItemTracingBuffer_LotNo.Value &lt;&gt; "", "Lot #: " + Fields!trecItemTracingBuffer_LotNo.Value, ""))</Value>
                                      <Style>
                                        <FontSize>18pt</FontSize>
                                      </Style>
                                    </TextRun>
                                  </TextRuns>
                                  <Style>
                                    <TextAlign>Center</TextAlign>
                                  </Style>
                                </Paragraph>
                              </Paragraphs>
                              <rd:DefaultName>Textbox21</rd:DefaultName>
                              <Top>3.33263in</Top>
                              <Left>0.20417in</Left>
                              <Height>0.34375in</Height>
                              <Width>5.54167in</Width>
                              <ZIndex>2</ZIndex>
                              <Style>
                                <Border>
                                  <Style>None</Style>
                                </Border>
                              </Style>
                            </Textbox>
                            <Textbox Name="Textbox24">
                              <KeepTogether>true</KeepTogether>
                              <Paragraphs>
                                <Paragraph>
                                  <TextRuns>
                                    <TextRun>
                                      <Value>="*" + Fields!trecItemTracingBuffer_ItemNo.Value + "*"</Value>
                                      <Style>
                                        <FontFamily>Free 3 of 9</FontFamily>
                                        <FontSize>42pt</FontSize>
                                      </Style>
                                    </TextRun>
                                  </TextRuns>
                                  <Style>
                                    <TextAlign>Center</TextAlign>
                                  </Style>
                                </Paragraph>
                              </Paragraphs>
                              <rd:DefaultName>Textbox24</rd:DefaultName>
                              <Top>1.25971in</Top>
                              <Left>0.20417in</Left>
                              <Height>0.64585in</Height>
                              <Width>5.54167in</Width>
                              <ZIndex>3</ZIndex>
                              <Style>
                                <Border>
                                  <Style>None</Style>
                                </Border>
                              </Style>
                            </Textbox>
                            <Textbox Name="Textbox25">
                              <KeepTogether>true</KeepTogether>
                              <Paragraphs>
                                <Paragraph>
                                  <TextRuns>
                                    <TextRun>
                                      <Value>=iif(Fields!trecItemTracingBuffer_SerialNo.Value &lt;&gt; "", "*" + Fields!trecItemTracingBuffer_SerialNo.Value + "*", "*" + Fields!trecItemTracingBuffer_LotNo.Value + "*")</Value>
                                      <Style>
                                        <FontFamily>Free 3 of 9</FontFamily>
                                        <FontSize>42pt</FontSize>
                                      </Style>
                                    </TextRun>
                                  </TextRuns>
                                  <Style>
                                    <TextAlign>Center</TextAlign>
                                  </Style>
                                </Paragraph>
                              </Paragraphs>
                              <rd:DefaultName>Textbox24</rd:DefaultName>
                              <Top>2.70068in</Top>
                              <Left>0.20417in</Left>
                              <Height>0.5764in</Height>
                              <Width>5.54167in</Width>
                              <ZIndex>4</ZIndex>
                              <Visibility>
                                <Hidden>=iif(Fields!trecItemTracingBuffer_SerialNo.Value = "", iif(Fields!trecItemTracingBuffer_LotNo.Value = "", TRUE, FALSE), FALSE)</Hidden>
                              </Visibility>
                              <Style>
                                <Border>
                                  <Style>None</Style>
                                </Border>
                              </Style>
                            </Textbox>
                          </ReportItems>
                          <ZIndex>1</ZIndex>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                          </Style>
                        </Rectangle>
                      </CellContents>
                    </TablixCell>
                  </TablixCells>
                </TablixRow>
              </TablixRows>
            </TablixBody>
            <TablixColumnHierarchy>
              <TablixMembers>
                <TablixMember />
              </TablixMembers>
            </TablixColumnHierarchy>
            <TablixRowHierarchy>
              <TablixMembers>
                <TablixMember>
                  <Group Name="Details" />
                  <KeepTogether>true</KeepTogether>
                </TablixMember>
              </TablixMembers>
            </TablixRowHierarchy>
            <Height>4in</Height>
            <Width>6in</Width>
            <Style>
              <Border>
                <Style>None</Style>
              </Border>
            </Style>
          </Tablix>
        </ReportItems>
        <Height>4in</Height>
        <Style>
          <Border>
            <Style>None</Style>
            <Width>0.25pt</Width>
          </Border>
        </Style>
      </Body>
      <Width>6in</Width>
      <Page>
        <PageHeight>4in</PageHeight>
        <PageWidth>6in</PageWidth>
        <Style />
      </Page>
    </ReportSection>
  </ReportSections>
  <Code>Public Function BlankZero(ByVal Value As Decimal)
    if Value = 0 then
        Return ""
    end if
    Return Value
End Function

Public Function BlankPos(ByVal Value As Decimal)
    if Value &gt; 0 then
        Return ""
    end if
    Return Value
End Function

Public Function BlankZeroAndPos(ByVal Value As Decimal)
    if Value &gt;= 0 then
        Return ""
    end if
    Return Value
End Function

Public Function BlankNeg(ByVal Value As Decimal)
    if Value &lt; 0 then
        Return ""
    end if
    Return Value
End Function

Public Function BlankNegAndZero(ByVal Value As Decimal)
    if Value &lt;= 0 then
        Return ""
    end if
    Return Value
End Function
</Code>
  <Language>=User!Language</Language>
  <ConsumeContainerWhitespace>true</ConsumeContainerWhitespace>
  <rd:ReportUnitType>Inch</rd:ReportUnitType>
</Report>
    END_OF_RDLDATA
  }
}

