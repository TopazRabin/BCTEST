OBJECT Report 14002610 Export Worksheet Tran. 2013
{
  OBJECT-PROPERTIES
  {
    Date=12/15/17;
    Time=12:00:00 PM;
    Version List=UBP2.97;
  }
  PROPERTIES
  {
    CaptionML=ENU=Export Worksheet Tran.;
    ProcessingOnly=Yes;
    OnPreReport=BEGIN
                  CLEAR(ExportColForecast);
                END;

    OnPostReport=BEGIN
                   IF SkippedCust <> 0 THEN
                     MESSAGE(Text001,SkippedCust);
                 END;

  }
  DATASET
  {
    { 6836;    ;DataItem;                    ;
               DataItemTable=Table18;
               ReqFilterFields=No.,Salesperson Code }

    { 9233;1   ;DataItem;                    ;
               DataItemTable=Table14002601;
               DataItemTableView=SORTING(Customer No.)
                                 ORDER(Descending);
               OnAfterGetRecord=BEGIN
                                  ColForecastLine.RESET;
                                  ColForecastLine.SETRANGE("Customer No.","Forecast Customer"."Customer No.");
                                  ColForecastLine.SETRANGE(Type,ColForecastLine.Type::Forecast);
                                  IF ColForecastLine.ISEMPTY THEN BEGIN
                                    SkippedCust := SkippedCust + 1;
                                    CurrReport.SKIP;
                                  END;
                                  ExportColForecast.ByCustomer("Forecast Customer");
                                END;

               DataItemLink=Customer No.=FIELD(No.) }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      ColForecastLine@1240030004 : Record 14002605;
      ExportColForecast@1240030000 : Codeunit 14002604;
      FileNamePrefix@1240030001 : Text[100];
      Text000@1240030002 : TextConst 'ENU=You must enter a File Name';
      ForecastFound@1240030003 : Boolean;
      SkippedCust@1240030005 : Integer;
      Text001@1240030006 : TextConst 'ENU=%1 Forecast Customer(s) skipped because no collaborative forecast exists.';

    BEGIN
    END.
  }
  RDLDATA
  {
  }
}

