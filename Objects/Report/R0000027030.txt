OBJECT Report 27030 Create DIOT Report
{
  OBJECT-PROPERTIES
  {
    Date=10/26/19;
    Time=12:00:00 PM;
    Version List=NAVNA11.00.00.37606;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Create DIOT Report;
               ESM=Crear reporte de DIOT;
               FRC=Cr‚er un rapport DIOT;
               ENC=Create DIOT Report];
    ProcessingOnly=Yes;
    OnInitReport=BEGIN
                   IF NOT DIOTDataManagement.GetInstallationComplete THEN BEGIN
                     IF DIOTDataManagement.ConfirmProcess(RunAssistedSetupMsg,FALSE) THEN
                       PAGE.RUN(PAGE::"DIOT Setup Wizard");
                     CurrReport.QUIT;
                   END;
                 END;

    OnPreReport=BEGIN
                  IF StartingDate = 0D THEN
                    ERROR(BlankStartingDateErr);
                  IF EndingDate = 0D THEN
                    ERROR(BlankEndingDateErr);
                END;

    OnPostReport=BEGIN
                   DIOTDataManagement.CollectDIOTDataSet(TempDIOTReportBuffer,TempDIOTReportVendorBuffer,TempErrorMessage,StartingDate,EndingDate);
                   IF TempErrorMessage.HasErrors(FALSE) THEN
                     TempErrorMessage.ShowErrors
                   ELSE
                     DIOTDataManagement.WriteDIOTFile(TempDIOTReportBuffer,TempDIOTReportVendorBuffer);
                 END;

  }
  DATASET
  {
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
      { 1310000; ;Container ;
                  ContainerType=ContentArea }

      { 1310001;1;Group     ;
                  CaptionML=[ENU=Report Dates;
                             ESM=Fechas de reporte;
                             FRC=Dates de rapport;
                             ENC=Report Dates];
                  GroupType=Group }

      { 1310002;2;Field     ;
                  Name=StartingDate;
                  CaptionML=[ENU=Starting Date;
                             ESM=Fecha inicial;
                             FRC=Date d‚but;
                             ENC=Starting Date];
                  ToolTipML=[ENU=Specifies starting Date for the report;
                             ESM=Especifica la fecha inicial del reporte;
                             FRC=Sp‚cifie la date d‚but du rapport;
                             ENC=Specifies starting Date for the report];
                  ApplicationArea=#Basic, #Suite;
                  SourceExpr=StartingDate }

      { 1310003;2;Field     ;
                  Name=EndingDate;
                  CaptionML=[ENU=Ending Date;
                             ESM=Fecha final;
                             FRC=Date fin;
                             ENC=Ending Date];
                  ToolTipML=[ENU=Specifies ending Date for the report;
                             ESM=Especifica la fecha final del reporte;
                             FRC=Sp‚cifie la date fin du rapport.;
                             ENC=Specifies ending Date for the report];
                  ApplicationArea=#Basic, #Suite;
                  SourceExpr=EndingDate;
                  OnValidate=BEGIN
                               IF EndingDate < StartingDate THEN
                                 ERROR(EndingDateBeforeStartinDateErr);
                             END;
                              }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      TempDIOTReportBuffer@1310000 : TEMPORARY Record 27042;
      TempDIOTReportVendorBuffer@1310001 : TEMPORARY Record 27043;
      TempErrorMessage@1310002 : TEMPORARY Record 700;
      DIOTDataManagement@1310003 : Codeunit 27021;
      StartingDate@1310004 : Date;
      EndingDate@1310005 : Date;
      BlankStartingDateErr@1310006 : TextConst 'ENU=Please provide a starting date.;ESM=Especifique una fecha inicial.;FRC=Veuillez indiquer une date d‚but.;ENC=Please provide a starting date.';
      BlankEndingDateErr@1310007 : TextConst 'ENU=Please provide an ending date.;ESM=Indique una fecha final.;FRC=Veuillez indiquer une date fin.;ENC=Please provide an ending date.';
      EndingDateBeforeStartinDateErr@1310008 : TextConst 'ENU=Ending date cannot be before starting date.;ESM=La fecha final no debe ser anterior a la inicial.;FRC=La date fin ne peut pas ˆtre ant‚rieure … la date d‚but.;ENC=Ending date cannot be before starting date.';
      RunAssistedSetupMsg@1310009 : TextConst 'ENU=You must complete Assisted Setup for DIOT before running this report. \\ Do you want to open assisted setup now?;ESM=Debe completar la instalaci¢n asistida para el DIOT antes de ejecutar este reporte. \\ ¨Desea abrir el programa de instalaci¢n asistido ahora?;FRC=Vous devez terminer la configuration assist‚e de la d‚claration DIOT avant d''ex‚cuter ce rapport. \\Souhaitez-vous ouvrir la configuration assist‚e maintenant?;ENC=You must complete Assisted Setup for DIOT before running this report. \\ Do you want to open assisted setup now?';

    BEGIN
    END.
  }
  RDLDATA
  {
  }
}

