OBJECT Report 50076 Copy Sales Prices
{
  OBJECT-PROPERTIES
  {
    Date=07/01/20;
    Time=12:00:00 AM;
    Modified=Yes;
    Version List=TPZ000.00.00;
  }
  PROPERTIES
  {
    ProcessingOnly=Yes;
    OnPreReport=BEGIN
                  IF FromCustomer = '' THEN
                    ERROR('From Customer Account No. must not be blank..!');
                  IF GlobalToAccount = '' THEN
                    ERROR('To Customer Account No. must not be blank..!');
                END;

  }
  DATASET
  {
    { 1000000000;;DataItem;                  ;
               DataItemTable=Table7002;
               OnPreDataItem=BEGIN
                               "Sales Price".SETRANGE("Sales Code",FromCustomer);
                             END;

               OnAfterGetRecord=BEGIN
                                  SalesPriceInsert.RESET;
                                  IF NOT SalesPriceInsert.GET("Item No.","Sales Type",GlobalToAccount,"Starting Date","Currency Code","Variant Code","Unit of Measure Code","Minimum Quantity") THEN BEGIN
                                    SalesPriceInsert.INIT;
                                    SalesPriceInsert.TRANSFERFIELDS("Sales Price");
                                    SalesPriceInsert."Sales Code" := GlobalToAccount;
                                    SalesPriceInsert."Modified Date" := TODAY;
                                    SalesPriceInsert."Modified Time" := TIME;
                                    SalesPriceInsert."User ID" := USERID;
                                    SalesPriceInsert.INSERT;
                                  END;
                                END;

               OnPostDataItem=BEGIN
                                MESSAGE('Process Completed..!');
                              END;
                               }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
      { 1000000002;0;Container;
                  ContainerType=ContentArea }

      { 1000000000;1;Group  ;
                  CaptionML=[ENU=Options;
                             ESM=Opciones;
                             FRC=Options;
                             ENC=Options] }

      { 1000000001;2;Field  ;
                  Name=From Customer;
                  SourceExpr=FromCustomer;
                  OnValidate=BEGIN
                               IF FromCustomer = GlobalToAccount THEN
                                 ERROR('From Customer Account No. must not be equal to To Customer Account No...!');
                             END;

                  OnLookup=VAR
                             DimensionValue@1000000000 : Record 349;
                             DimensionValueList@1000000001 : Page 560;
                           BEGIN
                             Customer.RESET;
                             CLEAR(CustomerList);
                             CustomerList.SETRECORD(Customer);
                             CustomerList.SETTABLEVIEW(Customer);
                             CustomerList.LOOKUPMODE(TRUE);
                             IF CustomerList.RUNMODAL = ACTION::LookupOK THEN BEGIN
                               CustomerList.GETRECORD(Customer);
                               FromCustomer := Customer."No.";
                             END;
                             IF FromCustomer = GlobalToAccount THEN
                               ERROR('From Customer Account No. must not be equal to To Customer Account No...!');
                           END;
                            }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      Customer@1000000000 : Record 18;
      CustomerList@1000000001 : Page 22;
      FromCustomer@1000000002 : Code[20];
      GlobalToAccount@1000000003 : Code[20];
      SalesPriceInsert@1000000004 : Record 7002;

    PROCEDURE SetCusFilter@1000000000(LocalToAccount@1000000000 : Code[20]);
    BEGIN
      GlobalToAccount := LocalToAccount;
    END;

    BEGIN
    {
      2017-12-19 TPZ2076 DKUMAR
        Copy Customer sales price from one account to the other.
    }
    END.
  }
  RDLDATA
  {
  }
}

