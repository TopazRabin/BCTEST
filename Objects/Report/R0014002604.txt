OBJECT Report 14002604 Create Worksheet Tran.
{
  OBJECT-PROPERTIES
  {
    Date=08/19/11;
    Time=12:00:00 PM;
    Version List=UBP2.84;
  }
  PROPERTIES
  {
    CaptionML=ENU=Create Worksheet Tran.;
    ProcessingOnly=Yes;
    OnPreReport=BEGIN
                  CollaborativeForecastSetup.GET;
                END;

  }
  DATASET
  {
    { 6836;    ;DataItem;                    ;
               DataItemTable=Table18;
               PrintOnlyIfDetail=Yes;
               ReqFilterFields=No.,Salesperson Code }

    { 9233;1   ;DataItem;                    ;
               DataItemTable=Table14002601;
               DataItemTableView=SORTING(Customer No.)
                                 ORDER(Ascending);
               PrintOnlyIfDetail=Yes;
               OnAfterGetRecord=BEGIN
                                  ForecastProcess.ForecastByCustomer("Forecast Customer");

                                  CollaborativeForecastLine.RESET;
                                  CollaborativeForecastLine.SETRANGE("Customer No.","Forecast Customer"."Customer No.");
                                  CollaborativeForecastLine.DELETEALL;

                                  First := TRUE;
                                END;

               DataItemLink=Customer No.=FIELD(No.) }

    { 3043;2   ;DataItem;                    ;
               DataItemTable=Table14002602;
               DataItemTableView=SORTING(Customer No.,Location Code,Item No.,Variant Code)
                                 ORDER(Ascending);
               OnAfterGetRecord=BEGIN
                                  IF First = TRUE THEN BEGIN
                                    First := FALSE;
                                    LocInvPeriod.RESET;
                                    LocInvPeriod.SETRANGE("Location Code","Forecast Customer Item"."Location Code");
                                    LocInvPeriod.SETRANGE("Period End Closed",TRUE);
                                    IF LocInvPeriod.FIND('+') THEN BEGIN
                                      LastClosedPeriodDate := LocInvPeriod."Starting Date";
                                      Periods := 0;
                                      ForecastInvPeriod.RESET;
                                      ForecastInvPeriod.SETRANGE(Type,ForecastInvPeriod.Type::Calculate);
                                      ForecastInvPeriod.SETFILTER("Starting Date",'%1..',LocInvPeriod."Ending Date");
                                      IF ForecastInvPeriod.FIND('-') THEN BEGIN
                                        StartingDate := ForecastInvPeriod."Starting Date";
                                        REPEAT
                                          Periods := Periods + 1;
                                          CollaborativeForecastLine."Customer No." := "Forecast Customer Item"."Customer No.";
                                          CollaborativeForecastLine."Location Code" := "Forecast Customer Item"."Location Code";
                                          CollaborativeForecastLine."Item No." := '';
                                          CollaborativeForecastLine.Variant := '';
                                          CollaborativeForecastLine.Type := CollaborativeForecastLine.Type::Title;
                                          CASE Periods OF
                                            1:  CollaborativeForecastLine."Period 1" := FORMAT(ForecastInvPeriod."Starting Date");
                                            2:  CollaborativeForecastLine."Period 2" := FORMAT(ForecastInvPeriod."Starting Date");
                                            3:  CollaborativeForecastLine."Period 3" := FORMAT(ForecastInvPeriod."Starting Date");
                                            4:  CollaborativeForecastLine."Period 4" := FORMAT(ForecastInvPeriod."Starting Date");
                                            5:  CollaborativeForecastLine."Period 5" := FORMAT(ForecastInvPeriod."Starting Date");
                                            6:  CollaborativeForecastLine."Period 6" := FORMAT(ForecastInvPeriod."Starting Date");
                                            7:  CollaborativeForecastLine."Period 7" := FORMAT(ForecastInvPeriod."Starting Date");
                                            8:  CollaborativeForecastLine."Period 8" := FORMAT(ForecastInvPeriod."Starting Date");
                                            9:  CollaborativeForecastLine."Period 9" := FORMAT(ForecastInvPeriod."Starting Date");
                                            10: CollaborativeForecastLine."Period 10" := FORMAT(ForecastInvPeriod."Starting Date");
                                            11: CollaborativeForecastLine."Period 11" := FORMAT(ForecastInvPeriod."Starting Date");
                                            12: CollaborativeForecastLine."Period 12" := FORMAT(ForecastInvPeriod."Starting Date");
                                            13: CollaborativeForecastLine."Period 13" := FORMAT(ForecastInvPeriod."Starting Date");
                                            14: CollaborativeForecastLine."Period 14" := FORMAT(ForecastInvPeriod."Starting Date");
                                            15: CollaborativeForecastLine."Period 15" := FORMAT(ForecastInvPeriod."Starting Date");
                                            16: CollaborativeForecastLine."Period 16" := FORMAT(ForecastInvPeriod."Starting Date");
                                            17: CollaborativeForecastLine."Period 17" := FORMAT(ForecastInvPeriod."Starting Date");
                                            18: CollaborativeForecastLine."Period 18" := FORMAT(ForecastInvPeriod."Starting Date");
                                            19: CollaborativeForecastLine."Period 19" := FORMAT(ForecastInvPeriod."Starting Date");
                                            20: CollaborativeForecastLine."Period 20" := FORMAT(ForecastInvPeriod."Starting Date");
                                            21: CollaborativeForecastLine."Period 21" := FORMAT(ForecastInvPeriod."Starting Date");
                                            22: CollaborativeForecastLine."Period 22" := FORMAT(ForecastInvPeriod."Starting Date");
                                            23: CollaborativeForecastLine."Period 23" := FORMAT(ForecastInvPeriod."Starting Date");
                                            24: CollaborativeForecastLine."Period 24" := FORMAT(ForecastInvPeriod."Starting Date");
                                            25: CollaborativeForecastLine."Period 25" := FORMAT(ForecastInvPeriod."Starting Date");
                                            26: CollaborativeForecastLine."Period 26" := FORMAT(ForecastInvPeriod."Starting Date");
                                            27: CollaborativeForecastLine."Period 27" := FORMAT(ForecastInvPeriod."Starting Date");
                                            28: CollaborativeForecastLine."Period 28" := FORMAT(ForecastInvPeriod."Starting Date");
                                            29: CollaborativeForecastLine."Period 29" := FORMAT(ForecastInvPeriod."Starting Date");
                                            30: CollaborativeForecastLine."Period 30" := FORMAT(ForecastInvPeriod."Starting Date");
                                            31: CollaborativeForecastLine."Period 31" := FORMAT(ForecastInvPeriod."Starting Date");
                                            32: CollaborativeForecastLine."Period 32" := FORMAT(ForecastInvPeriod."Starting Date");
                                            33: CollaborativeForecastLine."Period 33" := FORMAT(ForecastInvPeriod."Starting Date");
                                            34: CollaborativeForecastLine."Period 34" := FORMAT(ForecastInvPeriod."Starting Date");
                                            35: CollaborativeForecastLine."Period 35" := FORMAT(ForecastInvPeriod."Starting Date");
                                            36: CollaborativeForecastLine."Period 36" := FORMAT(ForecastInvPeriod."Starting Date");
                                            37: CollaborativeForecastLine."Period 37" := FORMAT(ForecastInvPeriod."Starting Date");
                                            38: CollaborativeForecastLine."Period 38" := FORMAT(ForecastInvPeriod."Starting Date");
                                            39: CollaborativeForecastLine."Period 39" := FORMAT(ForecastInvPeriod."Starting Date");
                                            40: CollaborativeForecastLine."Period 40" := FORMAT(ForecastInvPeriod."Starting Date");
                                            41: CollaborativeForecastLine."Period 41" := FORMAT(ForecastInvPeriod."Starting Date");
                                            42: CollaborativeForecastLine."Period 42" := FORMAT(ForecastInvPeriod."Starting Date");
                                            43: CollaborativeForecastLine."Period 43" := FORMAT(ForecastInvPeriod."Starting Date");
                                            44: CollaborativeForecastLine."Period 44" := FORMAT(ForecastInvPeriod."Starting Date");
                                            45: CollaborativeForecastLine."Period 45" := FORMAT(ForecastInvPeriod."Starting Date");
                                            46: CollaborativeForecastLine."Period 46" := FORMAT(ForecastInvPeriod."Starting Date");
                                            47: CollaborativeForecastLine."Period 47" := FORMAT(ForecastInvPeriod."Starting Date");
                                            48: CollaborativeForecastLine."Period 48" := FORMAT(ForecastInvPeriod."Starting Date");
                                            49: CollaborativeForecastLine."Period 49" := FORMAT(ForecastInvPeriod."Starting Date");
                                            50: CollaborativeForecastLine."Period 50" := FORMAT(ForecastInvPeriod."Starting Date");
                                            51: CollaborativeForecastLine."Period 51" := FORMAT(ForecastInvPeriod."Starting Date");
                                            52: CollaborativeForecastLine."Period 52" := FORMAT(ForecastInvPeriod."Starting Date");
                                          END;
                                        UNTIL (ForecastInvPeriod.NEXT = 0) OR
                                              (Periods = CollaborativeForecastSetup."Forecast Periods");
                                      END;
                                    END;
                                    CollaborativeForecastLine."Starting Date" := StartingDate;
                                    CollaborativeForecastLine.INSERT;
                                  END;
                                  ProcUnit.GET(
                                    "Forecast Customer Item"."Location Code",
                                    "Forecast Customer Item"."Item No.",
                                    "Forecast Customer Item"."Variant Code");
                                  ProcUnit.CALCFIELDS(Description);
                                  Forecast.CalcForecast(
                                    ProcUnit,CollaborativeForecastSetup."Forecast Periods","Forecast Customer"."Customer No.",TRUE,TRUE);
                                  CollaborativeForecastLine.INIT;
                                  CollaborativeForecastLine."Customer No." := "Forecast Customer Item"."Customer No.";
                                  CollaborativeForecastLine."Location Code" := "Forecast Customer Item"."Location Code";
                                  CollaborativeForecastLine."Item No." := "Forecast Customer Item"."Item No.";
                                  CollaborativeForecastLine.Variant := "Forecast Customer Item"."Variant Code";
                                  CollaborativeForecastLine.Type := CollaborativeForecastLine.Type::Forecast;
                                  CollaborativeForecastLine.Description := ProcUnit.Description;
                                  CollaborativeForecastLine."Starting Date" := StartingDate;

                                  Periods := 0;
                                  REPEAT
                                    Periods := Periods + 1;
                                    CASE Periods OF
                                      1:  CollaborativeForecastLine."Period 1" := FORMAT(ROUND(Forecast.GetPeriodForecastUsage(1),1.0));
                                      2:  CollaborativeForecastLine."Period 2" := FORMAT(ROUND(Forecast.GetPeriodForecastUsage(2),1.0));
                                      3:  CollaborativeForecastLine."Period 3" := FORMAT(ROUND(Forecast.GetPeriodForecastUsage(3),1.0));
                                      4:  CollaborativeForecastLine."Period 4" := FORMAT(ROUND(Forecast.GetPeriodForecastUsage(4),1.0));
                                      5:  CollaborativeForecastLine."Period 5" := FORMAT(ROUND(Forecast.GetPeriodForecastUsage(5),1.0));
                                      6:  CollaborativeForecastLine."Period 6" := FORMAT(ROUND(Forecast.GetPeriodForecastUsage(6),1.0));
                                      7:  CollaborativeForecastLine."Period 7" := FORMAT(ROUND(Forecast.GetPeriodForecastUsage(7),1.0));
                                      8:  CollaborativeForecastLine."Period 8" := FORMAT(ROUND(Forecast.GetPeriodForecastUsage(8),1.0));
                                      9:  CollaborativeForecastLine."Period 9" := FORMAT(ROUND(Forecast.GetPeriodForecastUsage(9),1.0));
                                      10: CollaborativeForecastLine."Period 10" := FORMAT(ROUND(Forecast.GetPeriodForecastUsage(10),1.0));
                                      11: CollaborativeForecastLine."Period 11" := FORMAT(ROUND(Forecast.GetPeriodForecastUsage(11),1.0));
                                      12: CollaborativeForecastLine."Period 12" := FORMAT(ROUND(Forecast.GetPeriodForecastUsage(12),1.0));
                                      13: CollaborativeForecastLine."Period 13" := FORMAT(ROUND(Forecast.GetPeriodForecastUsage(13),1.0));
                                      14: CollaborativeForecastLine."Period 14" := FORMAT(ROUND(Forecast.GetPeriodForecastUsage(14),1.0));
                                      15: CollaborativeForecastLine."Period 15" := FORMAT(ROUND(Forecast.GetPeriodForecastUsage(15),1.0));
                                      16: CollaborativeForecastLine."Period 16" := FORMAT(ROUND(Forecast.GetPeriodForecastUsage(16),1.0));
                                      17: CollaborativeForecastLine."Period 17" := FORMAT(ROUND(Forecast.GetPeriodForecastUsage(17),1.0));
                                      18: CollaborativeForecastLine."Period 18" := FORMAT(ROUND(Forecast.GetPeriodForecastUsage(18),1.0));
                                      19: CollaborativeForecastLine."Period 19" := FORMAT(ROUND(Forecast.GetPeriodForecastUsage(19),1.0));
                                      20: CollaborativeForecastLine."Period 20" := FORMAT(ROUND(Forecast.GetPeriodForecastUsage(20),1.0));
                                      21: CollaborativeForecastLine."Period 21" := FORMAT(ROUND(Forecast.GetPeriodForecastUsage(21),1.0));
                                      22: CollaborativeForecastLine."Period 22" := FORMAT(ROUND(Forecast.GetPeriodForecastUsage(22),1.0));
                                      23: CollaborativeForecastLine."Period 23" := FORMAT(ROUND(Forecast.GetPeriodForecastUsage(23),1.0));
                                      24: CollaborativeForecastLine."Period 24" := FORMAT(ROUND(Forecast.GetPeriodForecastUsage(24),1.0));
                                      25: CollaborativeForecastLine."Period 25" := FORMAT(ROUND(Forecast.GetPeriodForecastUsage(25),1.0));
                                      26: CollaborativeForecastLine."Period 26" := FORMAT(ROUND(Forecast.GetPeriodForecastUsage(26),1.0));
                                      27: CollaborativeForecastLine."Period 27" := FORMAT(ROUND(Forecast.GetPeriodForecastUsage(27),1.0));
                                      28: CollaborativeForecastLine."Period 28" := FORMAT(ROUND(Forecast.GetPeriodForecastUsage(28),1.0));
                                      29: CollaborativeForecastLine."Period 29" := FORMAT(ROUND(Forecast.GetPeriodForecastUsage(29),1.0));
                                      30: CollaborativeForecastLine."Period 30" := FORMAT(ROUND(Forecast.GetPeriodForecastUsage(30),1.0));
                                      31: CollaborativeForecastLine."Period 31" := FORMAT(ROUND(Forecast.GetPeriodForecastUsage(31),1.0));
                                      32: CollaborativeForecastLine."Period 32" := FORMAT(ROUND(Forecast.GetPeriodForecastUsage(32),1.0));
                                      33: CollaborativeForecastLine."Period 33" := FORMAT(ROUND(Forecast.GetPeriodForecastUsage(33),1.0));
                                      34: CollaborativeForecastLine."Period 34" := FORMAT(ROUND(Forecast.GetPeriodForecastUsage(34),1.0));
                                      35: CollaborativeForecastLine."Period 35" := FORMAT(ROUND(Forecast.GetPeriodForecastUsage(35),1.0));
                                      36: CollaborativeForecastLine."Period 36" := FORMAT(ROUND(Forecast.GetPeriodForecastUsage(36),1.0));
                                      37: CollaborativeForecastLine."Period 37" := FORMAT(ROUND(Forecast.GetPeriodForecastUsage(37),1.0));
                                      38: CollaborativeForecastLine."Period 38" := FORMAT(ROUND(Forecast.GetPeriodForecastUsage(38),1.0));
                                      39: CollaborativeForecastLine."Period 39" := FORMAT(ROUND(Forecast.GetPeriodForecastUsage(39),1.0));
                                      40: CollaborativeForecastLine."Period 40" := FORMAT(ROUND(Forecast.GetPeriodForecastUsage(40),1.0));
                                      41: CollaborativeForecastLine."Period 41" := FORMAT(ROUND(Forecast.GetPeriodForecastUsage(41),1.0));
                                      42: CollaborativeForecastLine."Period 42" := FORMAT(ROUND(Forecast.GetPeriodForecastUsage(42),1.0));
                                      43: CollaborativeForecastLine."Period 43" := FORMAT(ROUND(Forecast.GetPeriodForecastUsage(43),1.0));
                                      44: CollaborativeForecastLine."Period 44" := FORMAT(ROUND(Forecast.GetPeriodForecastUsage(44),1.0));
                                      45: CollaborativeForecastLine."Period 45" := FORMAT(ROUND(Forecast.GetPeriodForecastUsage(45),1.0));
                                      46: CollaborativeForecastLine."Period 46" := FORMAT(ROUND(Forecast.GetPeriodForecastUsage(46),1.0));
                                      47: CollaborativeForecastLine."Period 47" := FORMAT(ROUND(Forecast.GetPeriodForecastUsage(47),1.0));
                                      48: CollaborativeForecastLine."Period 48" := FORMAT(ROUND(Forecast.GetPeriodForecastUsage(48),1.0));
                                      49: CollaborativeForecastLine."Period 49" := FORMAT(ROUND(Forecast.GetPeriodForecastUsage(49),1.0));
                                      50: CollaborativeForecastLine."Period 50" := FORMAT(ROUND(Forecast.GetPeriodForecastUsage(50),1.0));
                                      51: CollaborativeForecastLine."Period 51" := FORMAT(ROUND(Forecast.GetPeriodForecastUsage(51),1.0));
                                      52: CollaborativeForecastLine."Period 52" := FORMAT(ROUND(Forecast.GetPeriodForecastUsage(52),1.0));
                                    END;
                                  UNTIL Periods = CollaborativeForecastSetup."Forecast Periods";

                                  CollaborativeForecastLine.INSERT;
                                END;

               DataItemLink=Customer No.=FIELD(Customer No.) }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      CollaborativeForecastLine@1240030002 : Record 14002605;
      CollaborativeForecastSetup@1240030011 : Record 14002607;
      LocInvPeriod@1240030005 : Record 14000553;
      ProcUnit@1240030004 : Record 14000555;
      ForecastInvPeriod@1240030000 : Record 14000552;
      Forecast@1240030003 : Codeunit 14000567;
      ForecastProcess@1240030010 : Codeunit 14002602;
      First@1240030007 : Boolean;
      Periods@1240030006 : Integer;
      LastClosedPeriodDate@1240030008 : Date;
      StartingDate@1240030009 : Date;

    BEGIN
    END.
  }
  RDLDATA
  {
  }
}

