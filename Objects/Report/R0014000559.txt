OBJECT Report 14000559 Create Suggested Orders
{
  OBJECT-PROPERTIES
  {
    Date=03/01/20;
    Time=12:00:00 PM;
    Version List=UBP3.02;
  }
  PROPERTIES
  {
    CaptionML=ENU=Create Suggested Orders;
    ProcessingOnly=Yes;
  }
  DATASET
  {
    { 5730;    ;DataItem;                    ;
               DataItemTable=Table14000563;
               DataItemTableView=SORTING(Vendor No.,Procurement Group Code)
                                 ORDER(Ascending)
                                 WHERE(Line Buy Vendor=CONST(Yes));
               OnAfterGetRecord=VAR
                                  DocNumber@1240020000 : Code[20];
                                BEGIN
                                  IF "Vendor Buying Calendar"."Procurement Group Code" = '' THEN BEGIN
                                    IF "Vendor Buying Calendar"."Division Code" <> '' THEN
                                      DocNumber := "Vendor Buying Calendar"."Location Code" + "Vendor Buying Calendar"."Division Code"
                                    ELSE
                                    DocNumber := "Vendor Buying Calendar"."Location Code";
                                    IF SugOrderHeader.GET(
                                       "Vendor Buying Calendar"."Vendor No.", DocNumber) THEN
                                      SugOrderHeader.DELETE(TRUE);
                                  END ELSE BEGIN
                                    DocNumber := "Vendor Buying Calendar"."Procurement Group Code";
                                    IF (PrevVendBuyingCalendar."Vendor No." <> "Vendor Buying Calendar"."Vendor No.") OR
                                       (PrevVendBuyingCalendar."Procurement Group Code" <> "Vendor Buying Calendar"."Procurement Group Code") THEN
                                      IF SugOrderHeader.GET(
                                         "Vendor Buying Calendar"."Vendor No.",DocNumber) THEN
                                        SugOrderHeader.DELETE(TRUE);
                                  END;
                                  PrevVendBuyingCalendar.COPY("Vendor Buying Calendar");
                                  COMMIT;

                                  VendorBuyingCalendar.GET("Vendor Buying Calendar"."Vendor No.","Vendor Buying Calendar"."Location Code", "Vendor Buying Calendar"."Division Code");
                                  VendorBuyingCalendar."Doc. No. Filter" := DocNumber;
                                  VendorBuyingCalendar."Order Create  Error" := TRUE;
                                  VendorBuyingCalendar."Order Create Date" := CURRENTDATETIME;
                                  VendorBuyingCalendar.MODIFY(FALSE);
                                  COMMIT;
                                  CLEAR(CreateSuggestedOrder);
                                  CreateSuggestedOrder.RUN("Vendor Buying Calendar");
                                  VendorBuyingCalendar.GET("Vendor Buying Calendar"."Vendor No.","Vendor Buying Calendar"."Location Code", "Vendor Buying Calendar"."Division Code");
                                  VendorBuyingCalendar."Order Create  Error" := FALSE;
                                  VendorBuyingCalendar."Order Create Date" := CURRENTDATETIME;
                                  VendorBuyingCalendar.MODIFY(FALSE);
                                END;

               ReqFilterFields=Location Code,Vendor No.,Division Code,Procurement Group Code,Next Review Date }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      SugOrderHeader@14000500 : Record 14000565;
      PrevVendBuyingCalendar@14000502 : Record 14000563;
      VendorBuyingCalendar@1240030000 : Record 14000563;
      CreateSuggestedOrder@14000503 : Codeunit 14000559;

    BEGIN
    END.
  }
  RDLDATA
  {
  }
}

