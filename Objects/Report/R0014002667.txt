OBJECT Report 14002667 Delete Usage Ledger Entries
{
  OBJECT-PROPERTIES
  {
    Date=11/01/20;
    Time=12:00:00 PM;
    Version List=UBP3.03;
  }
  PROPERTIES
  {
    CaptionML=ENU=Delete Usage Ledger Entries;
    ProcessingOnly=Yes;
  }
  DATASET
  {
    { 3728;    ;DataItem;                    ;
               DataItemTable=Table14000556;
               DataItemTableView=SORTING(Entry No.);
               OnPreDataItem=BEGIN
                               IF "Usage Ledger Entry".GETFILTERS = '' THEN BEGIN
                                 IF NOT CONFIRM(Text001,FALSE) THEN
                                   ERROR(Text003);
                               END ELSE BEGIN
                                 IF NOT CONFIRM(STRSUBSTNO(Text002,"Usage Ledger Entry".GETFILTERS),FALSE) THEN
                                   ERROR(Text003);
                               END;
                             END;

               OnAfterGetRecord=VAR
                                  ULE@1240020000 : Record 14000556;
                                BEGIN
                                  ULE.GET("Usage Ledger Entry"."Entry No.");
                                  ULE.DELETE(TRUE);
                                  counter += 1;
                                END;

               OnPostDataItem=VAR
                                LogEntryNo@1240020000 : Integer;
                              BEGIN
                                InvMgt.CreateLogEntry('', STRSUBSTNO(Text004, counter, USERID), LogEntryNo);
                                InvMgt.CloseLogEntry(LogEntryNo, COPYSTR(STRSUBSTNO(Text005, "Usage Ledger Entry".GETFILTERS), 1, 250));
                              END;

               ReqFilterFields=Location Code,Entry No. }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      Text001@1240020006 : TextConst 'ENU=All entries will be removed.\Warning.\Consider your usage will need to be recreated and your periods will need to be re-closed once entries are removed.\Are you sure you want to continue?';
      Text002@1240020001 : TextConst 'ENU=Entries will be removed according to the provided filters %1.\Warning.\The system uses the last entry number for each location to determine the next starting entry.  Entries removed will not be recreated if larger entry numbers remain.  \Consider your periods will need to be re-closed or procurement units reforecast once entries are removed.\Are you sure you want to continue?';
      Text003@1240020002 : TextConst 'ENU=No operation performed.';
      InvMgt@1240020000 : Codeunit 14000553;
      counter@1240020003 : Integer;
      Text004@1240020004 : TextConst 'ENU=%1 Usage Ledger Entries removed by %2.';
      Text005@1240020005 : TextConst 'ENU=Filters:  %1';

    BEGIN
    END.
  }
  RDLDATA
  {
  }
}

