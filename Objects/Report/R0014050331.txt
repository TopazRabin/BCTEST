OBJECT Report 14050331 Process E.D.I. P.O. Change Job
{
  OBJECT-PROPERTIES
  {
    Date=03/06/15;
    Time=12:00:00 PM;
    Version List=SE0.60.06;
  }
  PROPERTIES
  {
    CaptionML=ENU=Process E.D.I. P.O. Change Job;
    ProcessingOnly=Yes;
    OnPreReport=BEGIN
                  CompanyInformation.GET;
                  EDISetup.GET;
                END;

    UseRequestPage=No;
  }
  DATASET
  {
    { 2284;    ;DataItem;                    ;
               DataItemTable=Table14050305 }

    { 1676;    ;DataItem;                    ;
               DataItemTable=Table14002358;
               DataItemTableView=SORTING(Enable PO Change,PO Change Updated,Evaluate PO Change,Trade Partner No.,Navision Document,EDI Document No.,Company Name)
                                 ORDER(Ascending)
                                 WHERE(Enable PO Change=CONST(Yes),
                                       PO Change Updated=CONST(No),
                                       Evaluate PO Change=CONST(Yes),
                                       Data Error=CONST(No),
                                       Navision Document=FILTER(I_SLSORD));
               OnPreDataItem=BEGIN
                               SETFILTER("Trade Partner No.","E.D.I. Job Routine"."Trade Partner Filter");
                               SETFILTER("Navision Document","E.D.I. Job Routine"."EDI Document No. Filter");
                               SETFILTER("Company Name","E.D.I. Job Routine"."Company Filter");
                             END;

               OnAfterGetRecord=BEGIN
                                  EDIRecDocHdr.GET("Internal Doc. No.");
                                  EDIRecDocHdr."Data Error" := TRUE;
                                  EDIRecDocHdr."Error Message Text" := '';
                                  EDIRecDocHdr.MODIFY;

                                  COMMIT;

                                  CLEARLASTERROR;
                                  CLEAR(EDIProcessPOChangeJob);
                                  IF NOT EDIProcessPOChangeJob.RUN("E.D.I. Receive Document Hdr.") THEN BEGIN
                                    EDIRecDocHdr.GET("Internal Doc. No.");
                                    EDIRecDocHdr."Error Message Text" := COPYSTR(GETLASTERRORTEXT,1,250);
                                    EDIRecDocHdr.MODIFY;
                                    COMMIT;

                                    IF EDISetup."Receive Document Error" THEN BEGIN
                                      CLEAR(CreateEDIAlert);
                                      CreateEDIAlert.CreateAlertRecDocError("Internal Doc. No.",1,FALSE);
                                    END;
                                  END;

                                  COMMIT;
                                END;
                                 }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      CompanyInformation@1240030000 : Record 79;
      EDISetup@1240030001 : Record 14002367;
      EDIRecDocHdr@1240020003 : Record 14002358;
      EDIProcessPOChangeJob@1240020001 : Codeunit 14050303;
      CreateEDIAlert@1240020000 : Codeunit 14000375;

    BEGIN
    END.
  }
  RDLDATA
  {
  }
}

