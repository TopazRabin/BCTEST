OBJECT Report 14000558 Replace Calc. Inv. Periods
{
  OBJECT-PROPERTIES
  {
    Date=03/01/20;
    Time=12:00:00 PM;
    Version List=UBP3.02;
  }
  PROPERTIES
  {
    CaptionML=ENU=Replace Calc. Inv. Periods;
    ProcessingOnly=Yes;
    OnPreReport=BEGIN
                  IF (CalcPeriodLength = '') OR
                     (CalcStartDate = 0D)
                  THEN
                    ERROR(Text001);

                  IF CONFIRM(Text002,FALSE) THEN BEGIN
                    CalcInvPeriod.RESET;
                    CalcInvPeriod.SETRANGE(Type,CalcInvPeriod.Type::Calculate);
                    CalcInvPeriod.DELETEALL;
                    COMMIT;
                  END ELSE
                    EXIT;

                  InvPeriod.RESET;
                  InvPeriod.SETRANGE(Type,InvPeriod.Type::" ");
                  InvPeriod.FIND('-');
                  IF (CalcStartDate < InvPeriod."Starting Date") OR
                     (CalcStartDate > InvPeriod."Ending Date") THEN
                    ERROR(Text004,CalcStartDate,InvPeriod."Starting Date",InvPeriod."Ending Date");
                  InvPeriod.FIND('+');
                  REPEAT
                    CalcInvPeriod.Type := CalcInvPeriod.Type::Calculate;
                    CalcInvPeriod."Starting Date" := CalcStartDate;
                    CalcInvPeriod."Ending Date" := CALCDATE(CalcPeriodLength,CalcStartDate);
                    CalcInvPeriod."Ending Date" := CALCDATE('<-1D>',CalcInvPeriod."Ending Date");
                    CalcStartDate := CALCDATE('<+1D>',CalcInvPeriod."Ending Date");
                    IF CalcInvPeriod.INSERT THEN;
                  UNTIL CalcInvPeriod."Ending Date" >= InvPeriod."Ending Date";

                  InvMgtSetup.GET;
                  IF EVALUATE(InvMgtSetup."Calculation Period Length", CalcPeriodLength) THEN
                    InvMgtSetup.MODIFY(FALSE);
                END;

  }
  DATASET
  {
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      SaveValues=Yes;
    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=ENU=Options }

      { 1240030003;2;Field  ;
                  CaptionML=ENU=Calc. Starting Date;
                  SourceExpr=CalcStartDate }

      { 1240030000;2;Field  ;
                  CaptionML=ENU=Calc. Period Length;
                  SourceExpr=CalcPeriodLength }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      InvPeriod@14000500 : Record 14000552;
      CalcInvPeriod@1240030002 : Record 14000552;
      CalcStartDate@1240030000 : Date;
      CalcPeriodLength@1240030001 : Code[20];
      Text001@1240030003 : TextConst 'ENU=Start Date and Period Length must be specified.';
      Text002@1240030008 : TextConst 'ENU=Do you wish to replace all Calculate Periods?';
      Text004@1240030004 : TextConst 'ENU=Calculate Start Date %1 must fall between %2 and %3';
      InvMgtSetup@1240020000 : Record 14000551;

    BEGIN
    END.
  }
  RDLDATA
  {
  }
}

