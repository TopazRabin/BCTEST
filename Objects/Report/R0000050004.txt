OBJECT Report 50004 SSD_WIP
{
  OBJECT-PROPERTIES
  {
    Date=09/29/20;
    Time=10:03:40 AM;
    Modified=Yes;
    Version List=TPZ000.00.00;
  }
  PROPERTIES
  {
    Permissions=TableData 112=rm;
    ProcessingOnly=Yes;
  }
  DATASET
  {
    { 1000000000;;DataItem;                  ;
               DataItemTable=Table50005;
               OnAfterGetRecord=BEGIN
                                  IF PostedSalesInvRec.GET("Bill-to Contact") THEN BEGIN
                                    CustRec.GET(PostedSalesInvRec."Sell-to Customer No.");
                                    IF CustRec."EDI Trade Partner" = '' THEN BEGIN
                                      PostedSalesInvRec."EDI Invoice" := FALSE;
                                      PostedSalesInvRec.MODIFY;
                                      CustRec.CALCFIELDS(CustRec."E-Mail List");
                                      IF CustRec."E-Mail List" THEN BEGIN
                                        IF PostedSalesInvRec."E-Mail Invoice Notice Handled" THEN
                                          "Customer Disc. Group" := 'E-mail - Handled'
                                        ELSE
                                          "Customer Disc. Group" := 'E-mail - Not Handled';
                                      END ELSE IF CustRec.Fax THEN
                                       "Customer Disc. Group" := 'FAX'
                                      ELSE IF CustRec.Mail THEN
                                        "Customer Disc. Group" := 'Mail'
                                      ELSE
                                        "Customer Disc. Group" := 'Other';
                                      "Posting Date" := PostedSalesInvRec."Posting Date";
                                      MODIFY;
                                      CurrReport.SKIP;
                                    END;
                                    //"Posting Date" := PostedSalesInvRec."Sell-to Customer No.";
                                    "Posting Date" := PostedSalesInvRec."Posting Date";
                                    "Shortcut Dimension 2 Code" := PostedSalesInvRec."Ship-to Code";
                                    "Posting Date" := PostedSalesInvRec."Posting Date";
                                    //"Sales Inv. TP No." := PostedSalesInvRec."EDI Trade Partner";
                                    CustLedgEntry.RESET;
                                    CustLedgEntry.SETCURRENTKEY("Document No.","Document Type","Customer No.");
                                    CustLedgEntry.SETRANGE(CustLedgEntry."Document Type",CustLedgEntry."Document Type"::Invoice);
                                    CustLedgEntry.SETRANGE(CustLedgEntry."Document No.", "Sales Header Buffer"."Bill-to Contact");
                                    IF CustLedgEntry.FINDFIRST THEN BEGIN
                                      CustLedgEntry.CALCFIELDS(CustLedgEntry."Original Amount",CustLedgEntry."Remaining Amount");
                                     //"Sales Header Buffer"."External Document No." := CustLedgEntry."Original Amount";
                                     "Sales Header Buffer"."External Document No." := CustLedgEntry."External Document No.";
                                     //"Sales Header Buffer".IsCreditDocType := CustLedgEntry."Remaining Amount";
                                     {
                                     IF CustLedgEntry.Open THEN
                                      "Sales Header Buffer".Amount := TRUE
                                     ELSE
                                      "Sales Header Buffer".Amount := FALSE;
                                      }
                                    END;
                                    EDISendDoc.SETCURRENTKEY("Navision Document","Document No.","Sent Date");
                                    EDISendDoc.SETRANGE(EDISendDoc."Navision Document",'E_SLSINV');
                                    EDISendDoc.SETRANGE(EDISendDoc."Document No.",PostedSalesInvRec."No.");
                                    IF EDISendDoc.FINDFIRST THEN BEGIN
                                      //IF "Sell-to_Ship_to Tmp"."Sell-to Code" = '' THEN
                                      //  "Sell-to_Ship_to Tmp"."Sell-to Code" := PostedSalesInvRec."Sell-to Customer No.";
                                     // IF "Sell-to_Ship_to Tmp"."Ship-to Code" = '' THEN
                                      //  "Sell-to_Ship_to Tmp"."Ship-to Code" := PostedSalesInvRec."Ship-to Code";
                                      //"Sales Header Buffer"."Prepayment %" := EDISendDoc."Sent Date";
                                      //"Sales Header Buffer"."Prepmt. Payment Discount %" := EDISendDoc."Sent Time";
                                      //"Sales Header Buffer"."TP No." := EDISendDoc."Trade Partner No.";
                                      //"Sales Header Buffer"."Job Queue Status" := EDISendDoc."Transaction Set Control No.";
                                      IF EDISendDoc."Sent Date" <> 0D THEN
                                        "Sales Header Buffer".Status := 1
                                      ELSE BEGIN
                                        "Sales Header Buffer".Status := 0;
                                        IF ( "Sales Header Buffer".Amount = 0) THEN BEGIN
                                        //   (NOT "Sales Header Buffer".Status) THEN BEGIN
                                         { PostedSalesInvRec."EDI Invoice" := FALSE;
                                          PostedSalesInvRec."EDI Order" := FALSE;
                                          PostedSalesInvRec."EDI Trade Partner" := '';
                                          PostedSalesInvRec."EDI Sell-to Code" := '';
                                          PostedSalesInvRec."EDI Ship-to Code" := '';
                                          PostedSalesInvRec.MODIFY;}
                                        END ELSE BEGIN
                                         EDISendDoc.CALCFIELDS(EDISendDoc."Data Error");
                                          IF EDISendDoc."Data Error" THEN BEGIN
                                            EDISendDocField.RESET;
                                            EDISendDocField.SETRANGE(EDISendDocField."No.",EDISendDoc."No.");
                                            EDISendDocField.SETRANGE(EDISendDocField."Navision Document",EDISendDoc."Navision Document");
                                            EDISendDocField.SETFILTER(EDISendDocField.Segment,'%1|%2', 'N1-BT','N1-ST');
                                            EDISendDocField.SETRANGE(EDISendDocField.Element,'04');
                                            EDISendDocField.SETRANGE(EDISendDocField."NAV Table No.",112);
                                            EDISendDocField.SETFILTER(EDISendDocField."NAV Field No.",'%1|%2', 14000367,14000368);
                                            IF EDISendDocField.FINDSET(TRUE,FALSE) THEN BEGIN
                                              EDICustCrossRef.RESET;
                                              EDICustCrossRef.SETCURRENTKEY("Trade Partner No.","EDI Sell To Code","EDI Ship To Code");
                                              EDICustCrossRef.SETRANGE(EDICustCrossRef."Trade Partner No.",EDISendDocField."Trade Partner No.");
                                              EDICustCrossRef.SETRANGE(EDICustCrossRef."Navision Sell To Code",PostedSalesInvRec."Sell-to Customer No.");
                                              EDICustCrossRef.SETRANGE(EDICustCrossRef."Navision Ship To Code",PostedSalesInvRec."Ship-to Code"); // SC 10252017

                                              IF EDICustCrossRef.FINDFIRST THEN BEGIN
                                                REPEAT
                                                  EDISendDocField."Field Text Value" := EDICustCrossRef."EDI Sell To Code";
                                                  EDISendDocField."Data Error" := FALSE;
                                                  EDISendDocField.MODIFY;
                                                UNTIL(EDISendDocField.NEXT=0);
                                              PostedSalesInvRec."EDI Sell-to Code" := EDICustCrossRef."EDI Sell To Code";
                                              PostedSalesInvRec."EDI Ship-to Code" := EDICustCrossRef."EDI Ship To Code";
                                              PostedSalesInvRec.MODIFY;
                                              END;
                                            END;
                                          END;
                                        END;
                                      END;
                                    END ELSE BEGIN
                                    {
                                      IF (NOT "Sales Header Buffer".Amount) AND
                                         (NOT PostedSalesInvRec."EDI Invoice Generated") THEN BEGIN
                                       { PostedSalesInvRec."EDI Invoice" := FALSE;
                                        PostedSalesInvRec."EDI Order" := FALSE;
                                        PostedSalesInvRec."EDI Trade Partner" := '';
                                        PostedSalesInvRec."EDI Sell-to Code" := '';
                                        PostedSalesInvRec."EDI Ship-to Code" := '';
                                        PostedSalesInvRec.MODIFY;}
                                      END;
                                      }
                                    END;
                                    //"Sales Header Buffer"."Work Description" := PostedSalesInvRec."Shipping Agent Code";
                                    {
                                    IF (("Sales Header Buffer"."TP No." = '') AND
                                        (CustRec."EDI Trade Partner" <> '')) THEN
                                      "Sales Header Buffer"."TP No." := CustRec."EDI Trade Partner";
                                      }
                                    //"Sales Header Buffer"."Work Description" := PostedSalesInvRec."Shipping Agent Code";
                                    "Sales Header Buffer"."Package Tracking No." := PostedSalesInvRec."Package Tracking No.";
                                    "Sales Header Buffer"."Location Code" := PostedSalesInvRec."Location Code";
                                    "Sales Header Buffer"."Warehouse Release No." := PostedSalesInvRec."Warehouse Release No.";
                                    "Sales Header Buffer"."CSR Code" := PostedSalesInvRec."CSR Code";
                                     //"Sales Header Buffer"."Division Code" := PostedSalesInvRec."Shortcut Dimension 5 Code";
                                     //"Sales Header Buffer"."Buying Group Code" := CustRec."Buying Group Code";
                                  END ELSE BEGIN
                                    "Customer Disc. Group" := 'No Invoice Found';
                                  END;
                                  MODIFY;
                                END;
                                 }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      PostedSalesInvRec@1000000000 : Record 112;
      CustLedgEntry@1000000001 : Record 21;
      EDISendDoc@1000000002 : Record 14002369;
      CustRec@1000000003 : Record 18;
      ShipToAddrRec@1000000004 : Record 222;
      EDICustCrossRef@1000000005 : Record 14002362;
      EDISendDocField@1000000006 : Record 14002370;

    BEGIN
    END.
  }
  RDLDATA
  {
  }
}

