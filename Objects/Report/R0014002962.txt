OBJECT Report 14002962 License Plate Cleanup
{
  OBJECT-PROPERTIES
  {
    Date=01/01/13;
    Time=12:00:00 PM;
    Version List=RF1.40.02;
  }
  PROPERTIES
  {
    ProcessingOnly=Yes;
  }
  DATASET
  {
    { 2147;    ;DataItem;LicensePlateEntry   ;
               DataItemTable=Table14002964;
               DataItemTableView=SORTING(Location,Bin,Pallet,Box,Item,Variant Code,Unit of Measure,Lot No.,Serial No.)
                                 ORDER(Ascending);
               OnPreDataItem=BEGIN
                               IF NOT CONFIRM(Text001,FALSE) THEN EXIT;

                               IF DeleteDate > WORKDATE THEN
                                 DeleteDate := WORKDATE;

                               Window.OPEN(Text002 + '#1#######' + ' '+Text003+ '#2#######');

                               Window.UPDATE(2,LicensePlateEntry.COUNT);
                               LicensePlateEntry2.SETCURRENTKEY(Location,Bin,Pallet,Box,Item,"Variant Code",
                                                                "Unit of Measure","Lot No.","Serial No.");
                             END;

               OnAfterGetRecord=VAR
                                  PalletBinContent@1240020000 : Record 14002963;
                                BEGIN
                                  Counter := Counter + 1;
                                  Window.UPDATE(1,Counter);

                                  IF (LicensePlateEntry."Entry Date" > DeleteDate) OR
                                     (LicensePlateEntry.Item = '') OR
                                     (LicensePlateEntry.Pallet = '')
                                  THEN CurrReport.SKIP;

                                  PalletBinContent.RESET;
                                  PalletBinContent.SETRANGE(Location,LicensePlateEntry.Location);
                                  PalletBinContent.SETFILTER("Pallet No.",LicensePlateEntry.Pallet);
                                  IF LicensePlateEntry.Box <> '' THEN
                                    PalletBinContent.SETRANGE("Box No.",LicensePlateEntry.Box);
                                  PalletBinContent.SETFILTER("Item No.",'<>%1','');

                                  IF PalletBinContent.ISEMPTY THEN BEGIN
                                    LicensePlateEntry2.SETRANGE(Location,LicensePlateEntry.Location);
                                    LicensePlateEntry2.SETRANGE(Pallet,LicensePlateEntry.Pallet);
                                    IF LicensePlateEntry.Box <> '' THEN
                                      LicensePlateEntry2.SETRANGE(Box,LicensePlateEntry.Box);
                                    LicensePlateEntry2.LOCKTABLE(TRUE);
                                    LicensePlateEntry2.DELETEALL;
                                    COMMIT;
                                  END;
                                END;

               OnPostDataItem=BEGIN
                                Window.CLOSE;
                              END;
                               }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      LicensePlateEntry2@1240020000 : Record 14002964;
      Text001@1240020001 : TextConst 'ENU=Are you sure you want to compress the License Plate Entry table? Data will be deleted without a chance for recovery.';
      DeleteDate@1240020002 : Date;
      Window@1240020003 : Dialog;
      Text002@1240020004 : TextConst 'ENU=Line No';
      Text003@1240020005 : TextConst 'ENU=From';
      Counter@1240020006 : Integer;

    BEGIN
    END.
  }
  RDLDATA
  {
  }
}

