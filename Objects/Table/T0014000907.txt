OBJECT Table 14000907 E-Mail Rule
{
  OBJECT-PROPERTIES
  {
    Date=09/24/20;
    Time=[ 5:44:10 AM];
    Modified=Yes;
    Version List=SE0.50.32;
  }
  PROPERTIES
  {
    OnDelete=BEGIN
               EMailCommentLine.RESET;
               EMailCommentLine.SETRANGE("Table ID",DATABASE::"E-Mail Attachment");
               EMailCommentLine.SETRANGE(Code,Code);
               EMailCommentLine.DELETEALL;
             END;

    CaptionML=ENU=E-Mail Rule;
    LookupPageID=Page14000916;
    DrillDownPageID=Page14000916;
  }
  FIELDS
  {
    { 1   ;   ;Code                ;Code10        ;CaptionML=ENU=Code }
    { 11  ;   ;Description         ;Text30        ;CaptionML=ENU=Description }
    { 12  ;   ;Comment             ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist("E-Mail Comment Line" WHERE (Table ID=CONST(14000907),
                                                                                                  Code=FIELD(Code)));
                                                   CaptionML=ENU=Comment;
                                                   Editable=No }
    { 21  ;   ;Sales Shipment E-Mail Code;Code10  ;TableRelation="E-Mail Header" WHERE (E-Mail Usage=CONST(Sales Shipment));
                                                   OnValidate=BEGIN
                                                                IF "Sales Shipment E-Mail Code" = '' THEN
                                                                  "Sales Shipment E-Mail Default" := "Sales Shipment E-Mail Default"::" ";
                                                              END;

                                                   CaptionML=ENU=Sales Shipment E-Mail Code }
    { 22  ;   ;Sales Invoice E-Mail Code;Code10   ;TableRelation="E-Mail Header" WHERE (E-Mail Usage=CONST(Sales Invoice));
                                                   OnValidate=BEGIN
                                                                IF "Sales Invoice E-Mail Code" = '' THEN
                                                                  "Sales Invoice E-Mail Default" := "Sales Invoice E-Mail Default"::" ";
                                                              END;

                                                   CaptionML=ENU=Sales Invoice E-Mail Code }
    { 23  ;   ;Sales Order Conf. E-Mail Code;Code10;
                                                   TableRelation="E-Mail Header" WHERE (E-Mail Usage=CONST(Sales Order));
                                                   OnValidate=BEGIN
                                                                IF "Sales Order Conf. E-Mail Code" = '' THEN
                                                                  "Sales Order Conf. E-Mail Def." := "Sales Order Conf. E-Mail Def."::" ";
                                                              END;

                                                   CaptionML=ENU=Sales Order Conf. E-Mail Code }
    { 24  ;   ;Bill of Lading E-Mail Code;Code10  ;TableRelation="E-Mail Header" WHERE (E-Mail Usage=CONST(Bill of Lading));
                                                   OnValidate=BEGIN
                                                                IF "Bill of Lading E-Mail Code" = '' THEN
                                                                  "Bill of Lading E-Mail Default" := "Bill of Lading E-Mail Default"::" ";
                                                              END;

                                                   CaptionML=ENU=Bill of Lading E-Mail Code }
    { 25  ;   ;Customer Statement E-Mail Code;Code10;
                                                   TableRelation="E-Mail Header" WHERE (E-Mail Usage=CONST(Customer Statement));
                                                   OnValidate=BEGIN
                                                                IF "Customer Statement E-Mail Code" = '' THEN
                                                                  "Customer Statement E-Mail Def." := "Customer Statement E-Mail Def."::" ";
                                                              END;

                                                   CaptionML=ENU=Customer Statement E-Mail Code }
    { 26  ;   ;Sales Quote Conf. E-Mail Code;Code10;
                                                   TableRelation="E-Mail Header" WHERE (E-Mail Usage=CONST(Sales Order));
                                                   OnValidate=BEGIN
                                                                IF "Sales Quote Conf. E-Mail Code" = '' THEN
                                                                  "Sales Quote Conf. E-Mail Def." := "Sales Quote Conf. E-Mail Def."::" ";
                                                              END;

                                                   CaptionML=ENU=Sales Quote Conf. E-Mail Code }
    { 27  ;   ;Sales Invoice Conf E-Mail Code;Code10;
                                                   TableRelation="E-Mail Header" WHERE (E-Mail Usage=CONST(Sales Order));
                                                   OnValidate=BEGIN
                                                                IF "Sales Invoice Conf E-Mail Code" = '' THEN
                                                                  "Sales Invoice Conf E-Mail Def." := "Sales Invoice Conf E-Mail Def."::" ";
                                                              END;

                                                   CaptionML=ENU=Sales Invoice Conf E-Mail Code }
    { 28  ;   ;Sales Cr Memo Conf E-Mail Code;Code10;
                                                   TableRelation="E-Mail Header" WHERE (E-Mail Usage=CONST(Sales Order));
                                                   OnValidate=BEGIN
                                                                IF "Sales Cr Memo Conf E-Mail Code" = '' THEN
                                                                  "Sales Cr Memo Conf E-Mail Def." := "Sales Cr Memo Conf E-Mail Def."::" ";
                                                              END;

                                                   CaptionML=ENU=Sales Cr Memo Conf E-Mail Code }
    { 29  ;   ;Sales Bl. Ord Conf E-Mail Code;Code10;
                                                   TableRelation="E-Mail Header" WHERE (E-Mail Usage=CONST(Sales Order));
                                                   OnValidate=BEGIN
                                                                IF "Sales Bl. Ord Conf E-Mail Code" = '' THEN
                                                                  "Sales Bl. Ord Conf E-Mail Def." := "Sales Bl. Ord Conf E-Mail Def."::" ";
                                                              END;

                                                   CaptionML=ENU=Sales Bl. Ord Conf E-Mail Code }
    { 30  ;   ;Sales Ret Ord Conf E-Mail Code;Code10;
                                                   TableRelation="E-Mail Header" WHERE (E-Mail Usage=CONST(Sales Order));
                                                   OnValidate=BEGIN
                                                                IF "Sales Ret Ord Conf E-Mail Code" = '' THEN
                                                                  "Sales Ret Ord Conf E-Mail Def." := "Sales Ret Ord Conf E-Mail Def."::" ";
                                                              END;

                                                   CaptionML=ENU=Sales Ret Ord Conf E-Mail Code }
    { 31  ;   ;Purch. Quote Conf. E-Mail Code;Code10;
                                                   TableRelation="E-Mail Header" WHERE (E-Mail Usage=CONST(Purchase));
                                                   OnValidate=BEGIN
                                                                IF "Purch. Quote Conf. E-Mail Code" = '' THEN
                                                                  "Purch. Quote Conf. E-Mail Def." := "Purch. Quote Conf. E-Mail Def."::" ";
                                                              END;

                                                   CaptionML=ENU=Purch. Quote Conf. E-Mail Code }
    { 32  ;   ;Purch Bl. Ord Conf E-Mail Code;Code10;
                                                   TableRelation="E-Mail Header" WHERE (E-Mail Usage=CONST(Purchase));
                                                   OnValidate=BEGIN
                                                                IF "Purch Bl. Ord Conf E-Mail Code" = '' THEN
                                                                  "Purch Bl. Ord Conf E-Mail Def." := "Purch Bl. Ord Conf E-Mail Def."::" ";
                                                              END;

                                                   CaptionML=ENU=Purch Bl. Ord Conf E-Mail Code }
    { 33  ;   ;Purch. Order Conf. E-Mail Code;Code10;
                                                   TableRelation="E-Mail Header" WHERE (E-Mail Usage=CONST(Purchase));
                                                   OnValidate=BEGIN
                                                                IF "Purch. Order Conf. E-Mail Code" = '' THEN
                                                                  "Purch. Order Conf. E-Mail Def." := "Purch. Order Conf. E-Mail Def."::" ";
                                                              END;

                                                   CaptionML=ENU=Purch. Order Conf. E-Mail Code }
    { 34  ;   ;Purch Invoice Conf E-Mail Code;Code10;
                                                   TableRelation="E-Mail Header" WHERE (E-Mail Usage=CONST(Purchase));
                                                   OnValidate=BEGIN
                                                                IF "Purch Invoice Conf E-Mail Code" = '' THEN
                                                                  "Purch Invoice Conf E-Mail Def." := "Purch Invoice Conf E-Mail Def."::" ";
                                                              END;

                                                   CaptionML=ENU=Purch Invoice Conf E-Mail Code }
    { 35  ;   ;Purch Cr Memo Conf E-Mail Code;Code10;
                                                   TableRelation="E-Mail Header" WHERE (E-Mail Usage=CONST(Purchase));
                                                   OnValidate=BEGIN
                                                                IF "Purch Cr Memo Conf E-Mail Code" = '' THEN
                                                                  "Purch Cr Memo Conf E-Mail Def." := "Purch Cr Memo Conf E-Mail Def."::" ";
                                                              END;

                                                   CaptionML=ENU=Purch Cr Memo Conf E-Mail Code }
    { 36  ;   ;Purch Ret Ord Conf E-Mail Code;Code10;
                                                   TableRelation="E-Mail Header" WHERE (E-Mail Usage=CONST(Purchase));
                                                   OnValidate=BEGIN
                                                                IF "Purch Ret Ord Conf E-Mail Code" = '' THEN
                                                                  "Purch Ret Ord Conf E-Mail Def." := "Purch Ret Ord Conf E-Mail Def."::" ";
                                                              END;

                                                   CaptionML=ENU=Purch Ret Ord Conf E-Mail Code }
    { 41  ;   ;Issued Reminder E-Mail Code;Code10 ;TableRelation="E-Mail Header" WHERE (E-Mail Usage=CONST(Issued Reminder));
                                                   OnValidate=BEGIN
                                                                IF "Issued Reminder E-Mail Code" = '' THEN
                                                                  "Issued Reminder E-Mail Default" := "Issued Reminder E-Mail Default"::" ";
                                                              END;

                                                   CaptionML=ENU=Issued Reminder E-Mail Code }
    { 42  ;   ;Issued Fin Ch Memo E-Mail Code;Code10;
                                                   TableRelation="E-Mail Header" WHERE (E-Mail Usage=CONST(Issued Fin. Charge Memo));
                                                   OnValidate=BEGIN
                                                                IF "Issued Fin Ch Memo E-Mail Code" = '' THEN
                                                                  "Issued Fin Ch Memo E-Mail Def." := "Issued Fin Ch Memo E-Mail Def."::" ";
                                                              END;

                                                   CaptionML=ENU=Issued Fin Ch Memo E-Mail Code }
    { 43  ;   ;Purchase Receipt E-Mail Code;Code10;TableRelation="E-Mail Header" WHERE (E-Mail Usage=CONST(Purchase Receipt));
                                                   OnValidate=BEGIN
                                                                IF "Purchase Receipt E-Mail Code" = '' THEN
                                                                  "Purchase Receipt E-Mail Def." := "Purchase Receipt E-Mail Def."::" ";
                                                              END;

                                                   CaptionML=ENU=Purchase Receipt E-Mail Code }
    { 44  ;   ;Purchase Invoice E-Mail Code;Code10;TableRelation="E-Mail Header" WHERE (E-Mail Usage=CONST(Purchase Invoice));
                                                   OnValidate=BEGIN
                                                                IF "Purchase Invoice E-Mail Code" = '' THEN
                                                                  "Purchase Invoice E-Mail Def." := "Purchase Invoice E-Mail Def."::" ";
                                                              END;

                                                   CaptionML=ENU=Purchase Invoice E-Mail Code }
    { 61  ;   ;Sales Shipment E-Mail Default;Option;
                                                   OnValidate=BEGIN
                                                                TESTFIELD("Sales Shipment E-Mail Code");
                                                              END;

                                                   CaptionML=ENU=Sales Shipment E-Mail Default;
                                                   OptionCaptionML=ENU=" ,To,CC,BCC";
                                                   OptionString=[ ,To,CC,BCC] }
    { 62  ;   ;Sales Invoice E-Mail Default;Option;OnValidate=BEGIN
                                                                TESTFIELD("Sales Invoice E-Mail Code");
                                                              END;

                                                   CaptionML=ENU=Sales Invoice E-Mail Default;
                                                   OptionCaptionML=ENU=" ,To,CC,BCC";
                                                   OptionString=[ ,To,CC,BCC] }
    { 63  ;   ;Sales Order Conf. E-Mail Def.;Option;
                                                   OnValidate=BEGIN
                                                                TESTFIELD("Sales Order Conf. E-Mail Code");
                                                              END;

                                                   CaptionML=ENU=Sales Order Conf. E-Mail Def.;
                                                   OptionCaptionML=ENU=" ,To,CC,BCC";
                                                   OptionString=[ ,To,CC,BCC] }
    { 64  ;   ;Bill of Lading E-Mail Default;Option;
                                                   OnValidate=BEGIN
                                                                TESTFIELD("Bill of Lading E-Mail Code");
                                                              END;

                                                   CaptionML=ENU=Bill of Lading E-Mail Default;
                                                   OptionCaptionML=ENU=" ,To,CC,BCC";
                                                   OptionString=[ ,To,CC,BCC] }
    { 65  ;   ;Customer Statement E-Mail Def.;Option;
                                                   OnValidate=BEGIN
                                                                TESTFIELD("Customer Statement E-Mail Code");
                                                              END;

                                                   CaptionML=ENU=Customer Statement E-Mail Def.;
                                                   OptionCaptionML=ENU=" ,To,CC,BCC";
                                                   OptionString=[ ,To,CC,BCC] }
    { 66  ;   ;Sales Quote Conf. E-Mail Def.;Option;
                                                   OnValidate=BEGIN
                                                                TESTFIELD("Sales Quote Conf. E-Mail Code");
                                                              END;

                                                   CaptionML=ENU=Sales Quote Conf. E-Mail Def.;
                                                   OptionCaptionML=ENU=" ,To,CC,BCC";
                                                   OptionString=[ ,To,CC,BCC] }
    { 67  ;   ;Sales Invoice Conf E-Mail Def.;Option;
                                                   OnValidate=BEGIN
                                                                TESTFIELD("Sales Invoice Conf E-Mail Code");
                                                              END;

                                                   CaptionML=ENU=Sales Invoice Conf E-Mail Def.;
                                                   OptionCaptionML=ENU=" ,To,CC,BCC";
                                                   OptionString=[ ,To,CC,BCC] }
    { 68  ;   ;Sales Cr Memo Conf E-Mail Def.;Option;
                                                   OnValidate=BEGIN
                                                                TESTFIELD("Sales Cr Memo Conf E-Mail Code");
                                                              END;

                                                   CaptionML=ENU=Sales Cr Memo Conf E-Mail Def.;
                                                   OptionCaptionML=ENU=" ,To,CC,BCC";
                                                   OptionString=[ ,To,CC,BCC] }
    { 69  ;   ;Sales Bl. Ord Conf E-Mail Def.;Option;
                                                   OnValidate=BEGIN
                                                                TESTFIELD("Sales Bl. Ord Conf E-Mail Code");
                                                              END;

                                                   CaptionML=ENU=Sales Bl. Ord Conf E-Mail Def.;
                                                   OptionCaptionML=ENU=" ,To,CC,BCC";
                                                   OptionString=[ ,To,CC,BCC] }
    { 70  ;   ;Sales Ret Ord Conf E-Mail Def.;Option;
                                                   OnValidate=BEGIN
                                                                TESTFIELD("Sales Ret Ord Conf E-Mail Code");
                                                              END;

                                                   CaptionML=ENU=Sales Ret Ord Conf E-Mail Def.;
                                                   OptionCaptionML=ENU=" ,To,CC,BCC";
                                                   OptionString=[ ,To,CC,BCC] }
    { 71  ;   ;Purch. Quote Conf. E-Mail Def.;Option;
                                                   OnValidate=BEGIN
                                                                TESTFIELD("Purch. Quote Conf. E-Mail Code");
                                                              END;

                                                   CaptionML=ENU=Purch. Quote Conf. E-Mail Def.;
                                                   OptionCaptionML=ENU=" ,To,CC,BCC";
                                                   OptionString=[ ,To,CC,BCC] }
    { 72  ;   ;Purch Bl. Ord Conf E-Mail Def.;Option;
                                                   OnValidate=BEGIN
                                                                TESTFIELD("Purch Bl. Ord Conf E-Mail Code");
                                                              END;

                                                   CaptionML=ENU=Purch Bl. Ord Conf E-Mail Def.;
                                                   OptionCaptionML=ENU=" ,To,CC,BCC";
                                                   OptionString=[ ,To,CC,BCC] }
    { 73  ;   ;Purch. Order Conf. E-Mail Def.;Option;
                                                   OnValidate=BEGIN
                                                                TESTFIELD("Purch. Order Conf. E-Mail Code");
                                                              END;

                                                   CaptionML=ENU=Purch. Order Conf. E-Mail Def.;
                                                   OptionCaptionML=ENU=" ,To,CC,BCC";
                                                   OptionString=[ ,To,CC,BCC] }
    { 74  ;   ;Purch Invoice Conf E-Mail Def.;Option;
                                                   OnValidate=BEGIN
                                                                TESTFIELD("Purch Invoice Conf E-Mail Code");
                                                              END;

                                                   CaptionML=ENU=Purch Invoice Conf E-Mail Def.;
                                                   OptionCaptionML=ENU=" ,To,CC,BCC";
                                                   OptionString=[ ,To,CC,BCC] }
    { 75  ;   ;Purch Cr Memo Conf E-Mail Def.;Option;
                                                   OnValidate=BEGIN
                                                                TESTFIELD("Purch Cr Memo Conf E-Mail Code");
                                                              END;

                                                   CaptionML=ENU=Purch Cr Memo Conf E-Mail Def.;
                                                   OptionCaptionML=ENU=" ,To,CC,BCC";
                                                   OptionString=[ ,To,CC,BCC] }
    { 76  ;   ;Purch Ret Ord Conf E-Mail Def.;Option;
                                                   OnValidate=BEGIN
                                                                TESTFIELD("Purch Ret Ord Conf E-Mail Code");
                                                              END;

                                                   CaptionML=ENU=Purch Ret Ord Conf E-Mail Def.;
                                                   OptionCaptionML=ENU=" ,To,CC,BCC";
                                                   OptionString=[ ,To,CC,BCC] }
    { 81  ;   ;Issued Reminder E-Mail Default;Option;
                                                   OnValidate=BEGIN
                                                                TESTFIELD("Issued Reminder E-Mail Code");
                                                              END;

                                                   CaptionML=ENU=Issued Reminder E-Mail Default;
                                                   OptionCaptionML=ENU=" ,To,CC,BCC";
                                                   OptionString=[ ,To,CC,BCC] }
    { 82  ;   ;Issued Fin Ch Memo E-Mail Def.;Option;
                                                   OnValidate=BEGIN
                                                                TESTFIELD("Issued Fin Ch Memo E-Mail Code");
                                                              END;

                                                   CaptionML=ENU=Issued Fin Ch Memo E-Mail Def.;
                                                   OptionCaptionML=ENU=" ,To,CC,BCC";
                                                   OptionString=[ ,To,CC,BCC] }
    { 83  ;   ;Purchase Receipt E-Mail Def.;Option;OnValidate=BEGIN
                                                                TESTFIELD("Purchase Receipt E-Mail Code");
                                                              END;

                                                   CaptionML=ENU=Purchase Receipt E-Mail Def.;
                                                   OptionCaptionML=ENU=" ,To,CC,BCC";
                                                   OptionString=[ ,To,CC,BCC] }
    { 84  ;   ;Purchase Invoice E-Mail Def.;Option;OnValidate=BEGIN
                                                                TESTFIELD("Purchase Invoice E-Mail Code");
                                                              END;

                                                   CaptionML=ENU=Purchase Invoice E-Mail Def.;
                                                   OptionCaptionML=ENU=" ,To,CC,BCC";
                                                   OptionString=[ ,To,CC,BCC] }
    { 50000;  ;Proforma Invoice E-Mail Code;Code10;TableRelation="E-Mail Header" WHERE (E-Mail Usage=CONST(Purchase));
                                                   OnValidate=BEGIN
                                                                TESTFIELD("Proforma Invoice E-Mail Code"); //TPZ1956
                                                              END;

                                                   CaptionML=ENU=Purch Invoice Conf E-Mail Code;
                                                   Description=TPZ1956 }
    { 50010;  ;Proforma Invoice E-Mail Def.;Option;OptionCaptionML=ENU=" ,To,CC,BCC";
                                                   OptionString=[ ,To,CC,BCC];
                                                   Description=TPZ1956 }
    { 51020;  ;Sales Credit Memo E-Mail Code;Code10;
                                                   TableRelation="E-Mail Header" WHERE (E-Mail Usage=CONST(Sales Credit Memo));
                                                   OnValidate=BEGIN
                                                                // <TPZ143>
                                                                IF "Sales Credit Memo E-Mail Code" = '' THEN
                                                                  "Sales Credit Memo E-Mail Def." := "Sales Credit Memo E-Mail Def."::" ";
                                                                // </TPZ143>
                                                              END;

                                                   CaptionML=ENU=Sales Credit Memo E-Mail Code }
    { 51021;  ;Sales Credit Memo E-Mail Def.;Option;
                                                   OnValidate=BEGIN
                                                                // <TPZ143>
                                                                TESTFIELD("Sales Credit Memo E-Mail Code");
                                                                // </TPZ143>
                                                              END;

                                                   CaptionML=ENU=Sales Credit Memo E-Mail Def.;
                                                   OptionCaptionML=ENU=" ,To,CC,BCC";
                                                   OptionString=[ ,To,CC,BCC] }
    { 51700;  ;Mfr. Rep. Stm. E-Mail Code;Code10  ;TableRelation="E-Mail Header" WHERE (E-Mail Usage=CONST(Mfr. Rep. Statement));
                                                   OnValidate=BEGIN
                                                                // <TPZ92>
                                                                IF "Mfr. Rep. Stm. E-Mail Code" = '' THEN
                                                                  "Mfr. Rep. Stm. E-Mail Def." := "Mfr. Rep. Stm. E-Mail Def.":: " ";
                                                                // </TPZ92>
                                                              END;

                                                   CaptionML=ENU=Mfr. Rep. Stm. E-Mail Code }
    { 51701;  ;Loc. Hdlg. Stm. E-Mail Code;Code10 ;TableRelation="E-Mail Header" WHERE (E-Mail Usage=CONST(Location Hdlg. Statement));
                                                   OnValidate=BEGIN
                                                                // <TPZ92>
                                                                IF "Loc. Hdlg. Stm. E-Mail Code" = '' THEN
                                                                  "Loc. Hdlg. Stm. E-Mai Def." := "Loc. Hdlg. Stm. E-Mai Def."::" ";
                                                                // </TPZ92>
                                                              END;

                                                   CaptionML=ENU=Loc. Hdlg. Stm. E-Mail Code }
    { 51702;  ;Mfr. Rep. Stm. E-Mail Def.;Option  ;OnValidate=BEGIN
                                                                // <TPZ92>
                                                                TESTFIELD("Mfr. Rep. Stm. E-Mail Code");
                                                                // </TPZ92>
                                                              END;

                                                   CaptionML=ENU=Mfr. Rep. Stm. E-Mail Def.;
                                                   OptionCaptionML=ENU=" ,To,CC,BCC";
                                                   OptionString=[ ,To,CC,BCC] }
    { 51703;  ;Loc. Hdlg. Stm. E-Mai Def.;Option  ;OnValidate=BEGIN
                                                                // <TPZ92>
                                                                TESTFIELD("Loc. Hdlg. Stm. E-Mail Code");
                                                                // </TPZ92>
                                                              END;

                                                   CaptionML=ENU=Loc. Hdlg. Stm. E-Mai Def.;
                                                   OptionCaptionML=ENU=" ,To,CC,BCC";
                                                   OptionString=[ ,To,CC,BCC] }
  }
  KEYS
  {
    {    ;Code                                    ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      EMailCommentLine@1000000000 : Record 14000910;
      EMailComment@1000000001 : Page 14000921;

    PROCEDURE LookupComment@2();
    BEGIN
      EMailCommentLine.RESET;
      EMailCommentLine.SETRANGE("Table ID",DATABASE::"E-Mail Attachment");
      EMailCommentLine.SETRANGE(Code,Code);
      CLEAR(EMailComment);
      EMailComment.SETTABLEVIEW(EMailCommentLine);
      EMailComment.RUNMODAL;
    END;

    PROCEDURE GetEMailRule@1(Type@1240030000 : 'Customer,Vendor';No@1240030001 : Code[20];ShipToCode@1240030002 : Code[20]) : Boolean;
    VAR
      Customer@1240030003 : Record 18;
      ShipToAddress@1240030004 : Record 222;
      Vendor@1240030005 : Record 23;
      OrderAddress@1240030006 : Record 224;
      EMailSetup@1240030007 : Record 14000905;
      EMailRuleFound@1240030008 : Boolean;
    BEGIN
      CASE Type OF
        Type::Customer:
          BEGIN
            IF ShipToCode <> '' THEN BEGIN
              IF ShipToAddress.GET(No,ShipToCode) THEN
                EMailRuleFound := GET(ShipToAddress."E-Mail Rule Code");
              IF NOT EMailRuleFound THEN
                IF Customer.GET(No) THEN
                  IF Customer."Use E-Mail Rule for ShipToAddr" THEN
                    EMailRuleFound := GET(Customer."E-Mail Rule Code");
            END ELSE
              IF Customer.GET(No) THEN
                EMailRuleFound := GET(Customer."E-Mail Rule Code");
          END;
        Type::Vendor:
          BEGIN
            IF ShipToCode <> '' THEN BEGIN
              IF OrderAddress.GET(No,ShipToCode) THEN
                EMailRuleFound := GET(OrderAddress."E-Mail Rule Code");
              IF NOT EMailRuleFound THEN
                IF Vendor.GET(No) THEN
                  IF Vendor."Use E-Mail Rule for Order Addr" THEN
                    EMailRuleFound := GET(Vendor."E-Mail Rule Code");
            END ELSE
              IF Vendor.GET(No) THEN
                EMailRuleFound := GET(Vendor."E-Mail Rule Code");
          END;
      END;

      IF NOT EMailRuleFound THEN BEGIN
        EMailSetup.GET;
        EMailRuleFound := GET(EMailSetup."Default E-Mail Rule");
      END;

      EXIT(EMailRuleFound);
    END;

    BEGIN
    {
      2015-06-11 TPZ92 TAKHMETO
        Mfr. Rep. Stm. E-Mail Code, Loc. Hdlg. Stm. E-Mail Code
        Mfr. Rep. Stm. E-Mail Def., Loc. Hdlg. Stm. E-Mail Def. fields have been created
      2015-08-25 TPZ143 TAKHMETO
        Sales Credit Memo E-Mail Code, Sales Credit Memo E-Mail Def. fields have been created
      20170824 TPZ1956 CJOSIC - Schedule International Orders for Overnight Posting (20170717)
    }
    END.
  }
}

