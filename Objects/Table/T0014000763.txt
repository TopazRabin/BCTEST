OBJECT Table 14000763 UPS Shipping Zone Chart
{
  OBJECT-PROPERTIES
  {
    Date=06/28/17;
    Time=12:00:00 PM;
    Version List=SE0.60.13;
  }
  PROPERTIES
  {
    DataPerCompany=No;
    CaptionML=ENU=UPS Shipping Zone Chart;
  }
  FIELDS
  {
    { 1   ;   ;Service Indicator   ;Text2         ;CaptionML=ENU=Service Indicator }
    { 2   ;   ;Line No.            ;Integer       ;CaptionML=ENU=Line No. }
    { 11  ;   ;From Min. Code      ;Code5         ;CaptionML=ENU=From Min. Code }
    { 12  ;   ;From Max. Code      ;Code5         ;CaptionML=ENU=From Max. Code }
    { 13  ;   ;To Min. Code        ;Code5         ;CaptionML=ENU=To Min. Code }
    { 14  ;   ;To Max. Code        ;Code5         ;CaptionML=ENU=To Max. Code }
    { 15  ;   ;From State          ;Code2         ;CaptionML=ENU=From State }
    { 16  ;   ;To Country Code     ;Code2         ;CaptionML=ENU=To Country Code }
    { 21  ;   ;Zone                ;Code10        ;OnValidate=BEGIN
                                                                UPSShippingZone.RESET;
                                                                UPSShippingZone.SETRANGE("Service Indicator","Service Indicator");
                                                                UPSShippingZone.SETRANGE(Zone,Zone);
                                                                IF NOT UPSShippingZone.FIND('-') THEN BEGIN
                                                                  UPSShippingZone.INIT;
                                                                  UPSShippingZone."Service Indicator" := "Service Indicator";
                                                                  UPSShippingZone.Zone := Zone;
                                                                  UPSShippingZone.INSERT;
                                                                END;
                                                              END;

                                                   CaptionML=ENU=Zone }
    { 22  ;   ;EAS                 ;Boolean       ;CaptionML=ENU=EAS }
  }
  KEYS
  {
    {    ;Service Indicator,Line No.              ;Clustered=Yes }
    {    ;Service Indicator,From Min. Code,From Max. Code,To Min. Code,To Max. Code }
    {    ;Service Indicator,Zone                   }
    {    ;Service Indicator,From Min. Code,From Max. Code,To Country Code }
    {    ;Service Indicator,From State             }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      UPSShippingZone@1000000001 : Record 14000766;

    PROCEDURE GetStateRateFilesLoaded@1240020004() : Text[150];
    VAR
      UPSZones@1240020000 : Record 14000763;
      States@1240020001 : Text[150];
      State@1240020002 : Text[30];
    BEGIN
      States := '';
      State := '';

      CLEAR(UPSZones);
      UPSZones.SETCURRENTKEY("Service Indicator","From State");
      IF UPSZones.FIND('-') THEN
        REPEAT
          IF State <> UPSZones."From State" THEN BEGIN
            State := UPSZones."From State";
            IF STRPOS(States,UPSZones."From State") = 0 THEN
              States := States + UPSZones."From State" + ', ';
          END;
        UNTIL UPSZones.NEXT = 0;

      IF COPYSTR(States,STRLEN(States)-1,1) = ',' THEN
        States := COPYSTR(States,1,STRLEN(States)-2);

      EXIT(States);
    END;

    BEGIN
    END.
  }
}

