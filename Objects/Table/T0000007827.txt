OBJECT Table 7827 MS-QBO Failed Syncs
{
  OBJECT-PROPERTIES
  {
    Date=11/22/17;
    Time=12:00:00 PM;
    Version List=NAVW111.00;
  }
  PROPERTIES
  {
    CaptionML=[ENU=MS-QBO Failed Syncs;
               ESM=Error de sincronizaci¢n de MS-QBO;
               FRC=chec synchronisation MS-QBO;
               ENC=MS-QBO Failed Syncs];
  }
  FIELDS
  {
    { 1   ;   ;Type                ;Option        ;CaptionML=[ENU=Type;
                                                              ESM=Tipo;
                                                              FRC=Type;
                                                              ENC=Type];
                                                   OptionCaptionML=[ENU=Customer,Item,SalesInvoice;
                                                                    ESM=Cliente,Producto,Factura venta;
                                                                    FRC=Client,Articles,SalesInvoice;
                                                                    ENC=Customer,Item,SalesInvoice];
                                                   OptionString=Customer,Item,SalesInvoice }
    { 2   ;   ;No.                 ;Code20        ;CaptionML=[ENU=No.;
                                                              ESM=N.§;
                                                              FRC=Nø;
                                                              ENC=No.] }
    { 3   ;   ;Short Error         ;Text250       ;CaptionML=[ENU=Short Error;
                                                              ESM=Error corto;
                                                              FRC=Erreur courte;
                                                              ENC=Short Error] }
    { 4   ;   ;Detailed Error      ;BLOB          ;CaptionML=[ENU=Detailed Error;
                                                              ESM=Error detallado;
                                                              FRC=Erreur d‚taill‚e;
                                                              ENC=Detailed Error] }
  }
  KEYS
  {
    {    ;Type,No.                                ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    PROCEDURE Log@1(RecordIdToLog@1000 : RecordID;ErrorMessage@1001 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.String");
    BEGIN
      INIT;
      SetKeyFields(RecordIdToLog);
      WriteError(ErrorMessage);
      INSERT;
    END;

    LOCAL PROCEDURE WriteError@4(ErrorMessage@1000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.String");
    VAR
      TypeHelper@1002 : Codeunit 10;
      RecordRef@1001 : RecordRef;
      FieldRef@1003 : FieldRef;
    BEGIN
      IF ErrorMessage.Length > 250 THEN
        "Short Error" := ErrorMessage.Substring(0,250)
      ELSE
        "Short Error" := ErrorMessage;
      RecordRef.GETTABLE(Rec);
      FieldRef := RecordRef.FIELD(FIELDNO("Detailed Error"));
      TypeHelper.WriteBlob(FieldRef,FORMAT(ErrorMessage));
      RecordRef.SETTABLE(Rec);
    END;

    PROCEDURE Clear@3(RecordIdToClear@1000 : RecordID);
    BEGIN
      SetKeyFields(RecordIdToClear);

      SETRANGE(Type,Type);
      SETRANGE("No.","No.");
      DELETEALL;
      RESET;
    END;

    PROCEDURE FoundFromRecordId@2(RecordIdToSearch@1001 : RecordID) : Boolean;
    VAR
      MSQBOFailedSyncs@1000 : Record 7827;
    BEGIN
      SetKeyFields(RecordIdToSearch);
      EXIT(MSQBOFailedSyncs.FoundFromKeyValues(Type,"No."));
    END;

    PROCEDURE FoundFromKeyValues@8(TypeParam@1000 : Option;NumberParam@1001 : Code[20]) Result : Boolean;
    BEGIN
      SETRANGE(Type,TypeParam);
      SETRANGE("No.",NumberParam);
      Result := FINDFIRST;
      RESET;
    END;

    LOCAL PROCEDURE SetKeyFields@5(RecordIdToGetKeyValuesFrom@1000 : RecordID);
    VAR
      Item@1004 : Record 27;
      Customer@1003 : Record 18;
      SalesInvoiceHeader@1002 : Record 112;
      RecordRef@1001 : RecordRef;
    BEGIN
      RecordRef.OPEN(RecordIdToGetKeyValuesFrom.TABLENO);
      RecordRef.GET(RecordIdToGetKeyValuesFrom);
      CASE RecordIdToGetKeyValuesFrom.TABLENO OF
        DATABASE::Item:
          BEGIN
            Type := Type::Item;
            RecordRef.SETTABLE(Item);
            "No." := Item."No.";
          END;
        DATABASE::Customer:
          BEGIN
            Type := Type::Customer;
            RecordRef.SETTABLE(Customer);
            "No." := Customer."No.";
          END;
        DATABASE::"Sales Invoice Header":
          BEGIN
            Type := Type::SalesInvoice;
            RecordRef.SETTABLE(SalesInvoiceHeader);
            "No." := SalesInvoiceHeader."No.";
          END;
      END;
    END;

    BEGIN
    END.
  }
}

