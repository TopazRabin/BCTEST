OBJECT Table 14000586 Forecast Summary
{
  OBJECT-PROPERTIES
  {
    Date=05/05/12;
    Time=12:00:00 PM;
    Version List=UBP2.88;
  }
  PROPERTIES
  {
    OnModify=BEGIN
               IF NOT Summary THEN
                 TESTFIELD(Summary);
               IF ForSummaryView."Forecast Summary Code" <> "Forecast View Code" THEN
                 ForSummaryView.GET("Forecast View Code");

               IF ForSummaryView."View Only Summary" THEN
                 ERROR(Text004);

               IF ForSummaryView."Re-Calculate Required" THEN
                 ERROR(Text003);

               IF ForSummaryView."Sporadic Forecast Method" <>
                 ForSummaryView."Sporadic Forecast Method"::Zero
               THEN
                 ERROR(Text006);

               ForSummaryOrig.RESET;
               ForSummaryOrig.SETCURRENTKEY("Forecast View Code",Level);
               ForSummaryOrig.SETRANGE("Forecast View Code","Forecast View Code");
               ForSummaryOrig.SETFILTER(Level,'<>%1',Level);
               IF ForSummaryOrig.FIND('-') THEN
                 ERROR(Text002);

               ForSummaryOrig.RESET;
               IF NOT ForSummaryOrig.GET(
                 "Forecast View Code","Summary Code 1","Summary Code 2","Summary Code 3",
                 "Summary Code 4","Summary Code 5","Summary Code 6")
               THEN BEGIN
                 ForSummaryOrig.TRANSFERFIELDS(xRec);
                 ForSummaryOrig.INSERT;
               END;
             END;

    CaptionML=ENU=Forecast Summary;
  }
  FIELDS
  {
    { 1   ;   ;Forecast View Code  ;Code10        ;TableRelation="Forecast Summary View"."Forecast Summary Code";
                                                   CaptionML=ENU=Forecast View Code;
                                                   Editable=No }
    { 2   ;   ;Summary Code 1      ;Code20        ;CaptionML=ENU=Summary Code 1;
                                                   Editable=No }
    { 3   ;   ;Summary Code 2      ;Code20        ;CaptionML=ENU=Summary Code 2;
                                                   Editable=No }
    { 4   ;   ;Summary Code 3      ;Code20        ;CaptionML=ENU=Summary Code 3;
                                                   Editable=No }
    { 5   ;   ;Summary Code 4      ;Code20        ;CaptionML=ENU=Summary Code 4;
                                                   Editable=No }
    { 6   ;   ;Summary Code 5      ;Code20        ;CaptionML=ENU=Summary Code 5;
                                                   Editable=No }
    { 7   ;   ;Summary Code 6      ;Code20        ;CaptionML=ENU=Summary Code 6;
                                                   Editable=No }
    { 8   ;   ;Summary             ;Boolean       ;CaptionML=ENU=Summary }
    { 11  ;   ;FF Units            ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Forecast Summary Entry".Units WHERE (Forecast View Code=FIELD(Forecast View Code),
                                                                                                         Summary Code 1=FIELD(Summary Code 1 Filter),
                                                                                                         Summary Code 2=FIELD(Summary Code 2 Filter),
                                                                                                         Summary Code 3=FIELD(Summary Code 3 Filter),
                                                                                                         Summary Code 4=FIELD(Summary Code 4 Filter),
                                                                                                         Summary Code 5=FIELD(Summary Code 5 Filter),
                                                                                                         Summary Code 6=FIELD(Summary Code 6 Filter),
                                                                                                         Starting Date=FIELD(Date Filter)));
                                                   CaptionML=ENU=FF Units }
    { 12  ;   ;FF Cost (LCY)       ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Forecast Summary Entry"."Cost (LCY)" WHERE (Forecast View Code=FIELD(Forecast View Code),
                                                                                                                Summary Code 1=FIELD(Summary Code 1 Filter),
                                                                                                                Summary Code 2=FIELD(Summary Code 2 Filter),
                                                                                                                Summary Code 3=FIELD(Summary Code 3 Filter),
                                                                                                                Summary Code 4=FIELD(Summary Code 4 Filter),
                                                                                                                Summary Code 5=FIELD(Summary Code 5 Filter),
                                                                                                                Summary Code 6=FIELD(Summary Code 6 Filter),
                                                                                                                Starting Date=FIELD(Date Filter)));
                                                   CaptionML=ENU=FF Cost (LCY);
                                                   Editable=No }
    { 13  ;   ;FF Price (LCY)      ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Forecast Summary Entry"."Price (LCY)" WHERE (Forecast View Code=FIELD(Forecast View Code),
                                                                                                                 Summary Code 1=FIELD(Summary Code 1 Filter),
                                                                                                                 Summary Code 2=FIELD(Summary Code 2 Filter),
                                                                                                                 Summary Code 3=FIELD(Summary Code 3 Filter),
                                                                                                                 Summary Code 4=FIELD(Summary Code 4 Filter),
                                                                                                                 Summary Code 5=FIELD(Summary Code 5 Filter),
                                                                                                                 Summary Code 6=FIELD(Summary Code 6 Filter),
                                                                                                                 Starting Date=FIELD(Date Filter)));
                                                   CaptionML=ENU=FF Price (LCY) }
    { 14  ;   ;FF Weight           ;Decimal       ;CaptionML=ENU=FF Weight }
    { 15  ;   ;FF Volume           ;Decimal       ;CaptionML=ENU=FF Volume }
    { 16  ;   ;Date Filter         ;Date          ;FieldClass=FlowFilter;
                                                   CaptionML=ENU=Date Filter }
    { 17  ;   ;Summary Code 1 Filter;Code20       ;FieldClass=FlowFilter;
                                                   CaptionML=ENU=Summary Code 1 Filter }
    { 18  ;   ;Summary Code 2 Filter;Code20       ;FieldClass=FlowFilter;
                                                   CaptionML=ENU=Summary Code 2 Filter }
    { 19  ;   ;Summary Code 3 Filter;Code20       ;FieldClass=FlowFilter;
                                                   CaptionML=ENU=Summary Code 3 Filter }
    { 20  ;   ;Summary Code 4 Filter;Code20       ;FieldClass=FlowFilter;
                                                   CaptionML=ENU=Summary Code 4 Filter }
    { 21  ;   ;Summary Code 5 Filter;Code20       ;FieldClass=FlowFilter;
                                                   CaptionML=ENU=Summary Code 5 Filter }
    { 22  ;   ;Summary Code 6 Filter;Code20       ;FieldClass=FlowFilter;
                                                   CaptionML=ENU=Summary Code 6 Filter }
    { 23  ;   ;Period 1 Starting Date;Date        ;CaptionML=ENU=Period 1 Starting Date }
    { 24  ;   ;Summary Code        ;Text250       ;CaptionML=ENU=Summary Code;
                                                   Editable=No }
    { 25  ;   ;Level               ;Integer       ;CaptionML=ENU=Level;
                                                   Editable=No }
    { 26  ;   ;Forecast Unit       ;Option        ;CaptionML=ENU=Forecast Unit;
                                                   OptionCaptionML=ENU=Cost,Price,Quantity;
                                                   OptionString=Cost,Price,Quantity }
    { 27  ;   ;Summary Adj. Pending;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Forecast Summary Original" WHERE (Forecast View Code=FIELD(Forecast View Code),
                                                                                                        Summary Code 1=FIELD(Summary Code 1),
                                                                                                        Summary Code 2=FIELD(Summary Code 2),
                                                                                                        Summary Code 3=FIELD(Summary Code 3),
                                                                                                        Summary Code 4=FIELD(Summary Code 4),
                                                                                                        Summary Code 5=FIELD(Summary Code 5),
                                                                                                        Summary Code 6=FIELD(Summary Code 6)));
                                                   CaptionML=ENU=Summary Adj. Pending;
                                                   Editable=No }
    { 28  ;   ;Forecast Adj. Pending;Boolean      ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Forecast Summary Entry" WHERE (Forecast View Code=FIELD(Forecast View Code),
                                                                                                     Summary Code 1=FIELD(Summary Code 1),
                                                                                                     Summary Code 2=FIELD(Summary Code 2),
                                                                                                     Summary Code 3=FIELD(Summary Code 3),
                                                                                                     Summary Code 4=FIELD(Summary Code 4),
                                                                                                     Summary Code 5=FIELD(Summary Code 5),
                                                                                                     Summary Code 6=FIELD(Summary Code 6),
                                                                                                     Adjust Pending=CONST(Yes)));
                                                   CaptionML=ENU=Forecast Adj. Pending;
                                                   Editable=No }
    { 29  ;   ;Item Review Pending ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Forecast Summary Entry" WHERE (Forecast View Code=FIELD(Forecast View Code),
                                                                                                     Summary Code 1=FIELD(Summary Code 1),
                                                                                                     Summary Code 2=FIELD(Summary Code 2),
                                                                                                     Summary Code 3=FIELD(Summary Code 3),
                                                                                                     Summary Code 4=FIELD(Summary Code 4),
                                                                                                     Summary Code 5=FIELD(Summary Code 5),
                                                                                                     Summary Code 6=FIELD(Summary Code 6),
                                                                                                     Review Pending=CONST(Yes)));
                                                   CaptionML=ENU=Item Review Pending;
                                                   Editable=No }
    { 40  ;   ;Period 1            ;Text30        ;OnValidate=BEGIN
                                                                AdjFields(1);
                                                              END;

                                                   CaptionML=ENU=Period 1 }
    { 41  ;   ;Period 2            ;Text30        ;OnValidate=BEGIN
                                                                AdjFields(2);
                                                              END;

                                                   CaptionML=ENU=Period 2 }
    { 42  ;   ;Period 3            ;Text30        ;OnValidate=BEGIN
                                                                AdjFields(3);
                                                              END;

                                                   CaptionML=ENU=Period 3 }
    { 43  ;   ;Period 4            ;Text30        ;OnValidate=BEGIN
                                                                AdjFields(4);
                                                              END;

                                                   CaptionML=ENU=Period 4 }
    { 44  ;   ;Period 5            ;Text30        ;OnValidate=BEGIN
                                                                AdjFields(5);
                                                              END;

                                                   CaptionML=ENU=Period 5 }
    { 45  ;   ;Period 6            ;Text30        ;OnValidate=BEGIN
                                                                AdjFields(6);
                                                              END;

                                                   CaptionML=ENU=Period 6 }
    { 46  ;   ;Period 7            ;Text30        ;OnValidate=BEGIN
                                                                AdjFields(7);
                                                              END;

                                                   CaptionML=ENU=Period 7 }
    { 47  ;   ;Period 8            ;Text30        ;OnValidate=BEGIN
                                                                AdjFields(8);
                                                              END;

                                                   CaptionML=ENU=Period 8 }
    { 48  ;   ;Period 9            ;Text30        ;OnValidate=BEGIN
                                                                AdjFields(9);
                                                              END;

                                                   CaptionML=ENU=Period 9 }
    { 49  ;   ;Period 10           ;Text30        ;OnValidate=BEGIN
                                                                AdjFields(10);
                                                              END;

                                                   CaptionML=ENU=Period 10 }
    { 50  ;   ;Period 11           ;Text30        ;OnValidate=BEGIN
                                                                AdjFields(11);
                                                              END;

                                                   CaptionML=ENU=Period 11 }
    { 51  ;   ;Period 12           ;Text30        ;OnValidate=BEGIN
                                                                AdjFields(12);
                                                              END;

                                                   CaptionML=ENU=Period 12 }
    { 52  ;   ;Period 13           ;Text30        ;OnValidate=BEGIN
                                                                AdjFields(13);
                                                              END;

                                                   CaptionML=ENU=Period 13 }
    { 53  ;   ;Period 14           ;Text30        ;OnValidate=BEGIN
                                                                AdjFields(14);
                                                              END;

                                                   CaptionML=ENU=Period 14 }
    { 54  ;   ;Period 15           ;Text30        ;OnValidate=BEGIN
                                                                AdjFields(15);
                                                              END;

                                                   CaptionML=ENU=Period 15 }
    { 55  ;   ;Period 1 Qty.       ;Decimal       ;CaptionML=ENU=Period 1 Qty. }
    { 56  ;   ;Period 2 Qty.       ;Decimal       ;CaptionML=ENU=Period 2 Qty. }
    { 57  ;   ;Period 3 Qty.       ;Decimal       ;CaptionML=ENU=Period 3 Qty. }
    { 58  ;   ;Period 4 Qty.       ;Decimal       ;CaptionML=ENU=Period 4 Qty. }
    { 59  ;   ;Period 5 Qty.       ;Decimal       ;CaptionML=ENU=Period 5 Qty. }
    { 60  ;   ;Period 6 Qty.       ;Decimal       ;CaptionML=ENU=Period 6 Qty. }
    { 61  ;   ;Period 7 Qty.       ;Decimal       ;CaptionML=ENU=Period 7 Qty. }
    { 62  ;   ;Period 8 Qty.       ;Decimal       ;CaptionML=ENU=Period 8 Qty. }
    { 63  ;   ;Period 9 Qty.       ;Decimal       ;CaptionML=ENU=Period 9 Qty. }
    { 64  ;   ;Period 10 Qty.      ;Decimal       ;CaptionML=ENU=Period 10 Qty. }
    { 65  ;   ;Period 11 Qty.      ;Decimal       ;CaptionML=ENU=Period 11 Qty. }
    { 66  ;   ;Period 12 Qty.      ;Decimal       ;CaptionML=ENU=Period 12 Qty. }
    { 67  ;   ;Period 13 Qty.      ;Decimal       ;CaptionML=ENU=Period 13 Qty. }
    { 68  ;   ;Period 14 Qty.      ;Decimal       ;CaptionML=ENU=Period 14 Qty. }
    { 69  ;   ;Period 15 Qty.      ;Decimal       ;CaptionML=ENU=Period 15 Qty. }
    { 70  ;   ;Period 1 Cost       ;Decimal       ;CaptionML=ENU=Period 1 Cost }
    { 71  ;   ;Period 2 Cost       ;Decimal       ;CaptionML=ENU=Period 2 Cost }
    { 72  ;   ;Period 3 Cost       ;Decimal       ;CaptionML=ENU=Period 3 Cost }
    { 73  ;   ;Period 4 Cost       ;Decimal       ;CaptionML=ENU=Period 4 Cost }
    { 74  ;   ;Period 5 Cost       ;Decimal       ;CaptionML=ENU=Period 5 Cost }
    { 75  ;   ;Period 6 Cost       ;Decimal       ;CaptionML=ENU=Period 6 Cost }
    { 76  ;   ;Period 7 Cost       ;Decimal       ;CaptionML=ENU=Period 7 Cost }
    { 77  ;   ;Period 8 Cost       ;Decimal       ;CaptionML=ENU=Period 8 Cost }
    { 78  ;   ;Period 9 Cost       ;Decimal       ;CaptionML=ENU=Period 9 Cost }
    { 79  ;   ;Period 10 Cost      ;Decimal       ;CaptionML=ENU=Period 10 Cost }
    { 80  ;   ;Period 11 Cost      ;Decimal       ;CaptionML=ENU=Period 11 Cost }
    { 81  ;   ;Period 12 Cost      ;Decimal       ;CaptionML=ENU=Period 12 Cost }
    { 82  ;   ;Period 13 Cost      ;Decimal       ;CaptionML=ENU=Period 13 Cost }
    { 83  ;   ;Period 14 Cost      ;Decimal       ;CaptionML=ENU=Period 14 Cost }
    { 84  ;   ;Period 15 Cost      ;Decimal       ;CaptionML=ENU=Period 15 Cost }
    { 85  ;   ;Period 1 Price      ;Decimal       ;CaptionML=ENU=Period 1 Price }
    { 86  ;   ;Period 2 Price      ;Decimal       ;CaptionML=ENU=Period 2 Price }
    { 87  ;   ;Period 3 Price      ;Decimal       ;CaptionML=ENU=Period 3 Price }
    { 88  ;   ;Period 4 Price      ;Decimal       ;CaptionML=ENU=Period 4 Price }
    { 89  ;   ;Period 5 Price      ;Decimal       ;CaptionML=ENU=Period 5 Price }
    { 90  ;   ;Period 6 Price      ;Decimal       ;CaptionML=ENU=Period 6 Price }
    { 91  ;   ;Period 7 Price      ;Decimal       ;CaptionML=ENU=Period 7 Price }
    { 92  ;   ;Period 8 Price      ;Decimal       ;CaptionML=ENU=Period 8 Price }
    { 93  ;   ;Period 9 Price      ;Decimal       ;CaptionML=ENU=Period 9 Price }
    { 94  ;   ;Period 10 Price     ;Decimal       ;CaptionML=ENU=Period 10 Price }
    { 95  ;   ;Period 11 Price     ;Decimal       ;CaptionML=ENU=Period 11 Price }
    { 96  ;   ;Period 12 Price     ;Decimal       ;CaptionML=ENU=Period 12 Price }
    { 97  ;   ;Period 13 Price     ;Decimal       ;CaptionML=ENU=Period 13 Price }
    { 98  ;   ;Period 14 Price     ;Decimal       ;CaptionML=ENU=Period 14 Price }
    { 99  ;   ;Period 15 Price     ;Decimal       ;CaptionML=ENU=Period 15 Price }
  }
  KEYS
  {
    {    ;Forecast View Code,Summary Code 1,Summary Code 2,Summary Code 3,Summary Code 4,Summary Code 5,Summary Code 6,Summary;
                                                   Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      ForSummaryView@1240030006 : Record 14000585;
      ForSummaryOrig@1240030000 : Record 14000588;
      ForSummaryEntry@1240030010 : Record 14000587;
      NewValue@1240030002 : Decimal;
      OldValue@1240030003 : Decimal;
      PercentAdj@1240030001 : Decimal;
      Text001@1240030004 : TextConst 'ENU=All adjustments must be of the same Forecast Unit.  An adjustment already exists for Forecast Unit: %1.';
      Text002@1240030005 : TextConst 'ENU=All adjustments must be for the same level.';
      Text003@1240030007 : TextConst 'ENU=A Re-Calculate of the Forecast Summary is required due to a previous Roll-Back of a forecast update.';
      Text004@1240030008 : TextConst 'ENU=This is a View Only Summany and it can not be used to create Summary Adjustments.';
      ItemLevel@1240030009 : Boolean;
      Text005@1240030011 : TextConst 'ENU=You can only adjust a Zero forecast when the Forecast Unit is Quantity.';
      Text006@1240020000 : TextConst 'ENU=A Summary with a Sporadic Forecast Method of Average Usage can not be used to create Summary Adjustments.';

    PROCEDURE ShowSummaryEntries@1240030000(CurrPeriod@1240030001 : Integer);
    VAR
      ForInvPeriod@1240030002 : Record 14000552;
      ForSumEnt@1240030000 : Record 14000587;
      Finished@1240030003 : Boolean;
      PeriodCount@1240030004 : Integer;
    BEGIN
      ForInvPeriod.RESET;
      ForInvPeriod.SETFILTER("Starting Date",'>=%1',"Period 1 Starting Date");
      ForInvPeriod.FIND('-');

      Finished := FALSE;
      PeriodCount := 0;
      REPEAT
        PeriodCount := PeriodCount + 1;
        IF PeriodCount = CurrPeriod THEN
          Finished := TRUE
        ELSE
          ForInvPeriod.NEXT;
      UNTIL Finished;

      ForSumEnt.RESET;
      ForSumEnt.SETRANGE("Forecast View Code","Forecast View Code");
      IF "Summary Code 1" <> '' THEN
        ForSumEnt.SETRANGE("Summary Code 1","Summary Code 1");
      IF "Summary Code 2" <> '' THEN
        ForSumEnt.SETRANGE("Summary Code 2","Summary Code 2");
      IF "Summary Code 3" <> '' THEN
        ForSumEnt.SETRANGE("Summary Code 3","Summary Code 3");
      IF "Summary Code 4" <> '' THEN
        ForSumEnt.SETRANGE("Summary Code 4","Summary Code 4");
      IF "Summary Code 5" <> '' THEN
        ForSumEnt.SETRANGE("Summary Code 5","Summary Code 5");
      IF "Summary Code 6" <> '' THEN
        ForSumEnt.SETRANGE("Summary Code 6","Summary Code 6");
      ForSumEnt.SETRANGE("Starting Date",ForInvPeriod."Starting Date");
      PAGE.RUNMODAL(PAGE::"Forecast Summary Entries",ForSumEnt);
    END;

    PROCEDURE AdjFields@1240030001(CurrPeriod@1240030000 : Integer);
    BEGIN
      IF NOT Summary THEN
        TESTFIELD(Summary);

      ForSummaryOrig.RESET;
      ForSummaryOrig.SETRANGE("Forecast View Code","Forecast View Code");
      IF ForSummaryOrig.FIND('-') THEN BEGIN
        IF "Forecast Unit" <> ForSummaryOrig."Forecast Unit" THEN
          ERROR(Text001,ForSummaryOrig."Forecast Unit");
      END;

      IF ForSummaryView."Forecast Summary Code" <> "Forecast View Code" THEN
        ForSummaryView.GET("Forecast View Code");
      ItemLevel := FALSE;
      CASE Level OF
        1:
          IF ForSummaryView."Summary Code 1 Type" = ForSummaryView."Summary Code 1 Type"::Item THEN
            ItemLevel := TRUE;
        2:
          IF ForSummaryView."Summary Code 2 Type" = ForSummaryView."Summary Code 2 Type"::Item THEN
            ItemLevel := TRUE;
        3:
          IF ForSummaryView."Summary Code 3 Type" = ForSummaryView."Summary Code 3 Type"::Item THEN
            ItemLevel := TRUE;
        4:
          IF ForSummaryView."Summary Code 4 Type" = ForSummaryView."Summary Code 4 Type"::Item THEN
            ItemLevel := TRUE;
        5:
          IF ForSummaryView."Summary Code 5 Type" = ForSummaryView."Summary Code 5 Type"::Item THEN
            ItemLevel := TRUE;
        6:
          IF ForSummaryView."Summary Code 6 Type" = ForSummaryView."Summary Code 6 Type"::Item THEN
            ItemLevel := TRUE;
      END;
      IF ItemLevel THEN BEGIN
        ForSummaryEntry.RESET;
        ForSummaryEntry.SETRANGE("Forecast View Code","Forecast View Code");
        ForSummaryEntry.SETRANGE("Summary Code 1","Summary Code 1");
        ForSummaryEntry.SETRANGE("Summary Code 2","Summary Code 2");
        ForSummaryEntry.SETRANGE("Summary Code 3","Summary Code 3");
        ForSummaryEntry.SETRANGE("Summary Code 4","Summary Code 4");
        ForSummaryEntry.SETRANGE("Summary Code 5","Summary Code 5");
        ForSummaryEntry.SETRANGE("Summary Code 6","Summary Code 6");
        ForSummaryEntry.SETRANGE("Starting Date","Period 1 Starting Date");
        ForSummaryEntry.FIND('-');
      END;

      CASE CurrPeriod OF
        1:
          BEGIN
            EVALUATE(NewValue,"Period 1");
            EVALUATE(OldValue,xRec."Period 1");
            GetAdjust(NewValue,OldValue,"Period 1 Qty.","Period 1 Cost","Period 1 Price");
          END;
        2:
          BEGIN
            EVALUATE(NewValue,"Period 2");
            EVALUATE(OldValue,xRec."Period 2");
            GetAdjust(NewValue,OldValue,"Period 2 Qty.","Period 2 Cost","Period 2 Price");
          END;
        3:
          BEGIN
            EVALUATE(NewValue,"Period 3");
            EVALUATE(OldValue,xRec."Period 3");
            GetAdjust(NewValue,OldValue,"Period 3 Qty.","Period 3 Cost","Period 3 Price");
          END;
        4:
          BEGIN
            EVALUATE(NewValue,"Period 4");
            EVALUATE(OldValue,xRec."Period 4");
            GetAdjust(NewValue,OldValue,"Period 4 Qty.","Period 4 Cost","Period 4 Price");
          END;
        5:
          BEGIN
            EVALUATE(NewValue,"Period 5");
            EVALUATE(OldValue,xRec."Period 5");
            GetAdjust(NewValue,OldValue,"Period 5 Qty.","Period 5 Cost","Period 5 Price");
          END;
        6:
          BEGIN
            EVALUATE(NewValue,"Period 6");
            EVALUATE(OldValue,xRec."Period 6");
            GetAdjust(NewValue,OldValue,"Period 6 Qty.","Period 6 Cost","Period 6 Price");
          END;
        7:
          BEGIN
            EVALUATE(NewValue,"Period 7");
            EVALUATE(OldValue,xRec."Period 7");
            GetAdjust(NewValue,OldValue,"Period 7 Qty.","Period 7 Cost","Period 7 Price");
          END;
        8:
          BEGIN
            EVALUATE(NewValue,"Period 8");
            EVALUATE(OldValue,xRec."Period 8");
            GetAdjust(NewValue,OldValue,"Period 8 Qty.","Period 8 Cost","Period 8 Price");
          END;
        9:
          BEGIN
            EVALUATE(NewValue,"Period 9");
            EVALUATE(OldValue,xRec."Period 9");
            GetAdjust(NewValue,OldValue,"Period 9 Qty.","Period 9 Cost","Period 9 Price");
          END;
        10:
          BEGIN
            EVALUATE(NewValue,"Period 10");
            EVALUATE(OldValue,xRec."Period 10");
            GetAdjust(NewValue,OldValue,"Period 10 Qty.","Period 10 Cost","Period 10 Price");
          END;
        11:
          BEGIN
            EVALUATE(NewValue,"Period 11");
            EVALUATE(OldValue,xRec."Period 11");
            GetAdjust(NewValue,OldValue,"Period 11 Qty.","Period 11 Cost","Period 11 Price");
          END;
        12:
          BEGIN
            EVALUATE(NewValue,"Period 12");
            EVALUATE(OldValue,xRec."Period 12");
            GetAdjust(NewValue,OldValue,"Period 12 Qty.","Period 12 Cost","Period 12 Price");
          END;
        13:
          BEGIN
            EVALUATE(NewValue,"Period 13");
            EVALUATE(OldValue,xRec."Period 13");
            GetAdjust(NewValue,OldValue,"Period 13 Qty.","Period 13 Cost","Period 13 Price");
          END;
        14:
          BEGIN
            EVALUATE(NewValue,"Period 14");
            EVALUATE(OldValue,xRec."Period 14");
            GetAdjust(NewValue,OldValue,"Period 14 Qty.","Period 14 Cost","Period 14 Price");
          END;
        15:
          BEGIN
            EVALUATE(NewValue,"Period 15");
            EVALUATE(OldValue,xRec."Period 15");
            GetAdjust(NewValue,OldValue,"Period 15 Qty.","Period 15 Cost","Period 15 Price");
          END;
      END;
    END;

    PROCEDURE GetAdjust@1240030002(CurrNewValue@1240030000 : Decimal;CurrOldValue@1240030001 : Decimal;VAR CurrQty@1240030002 : Decimal;VAR CurrCost@1240030003 : Decimal;VAR CurrPrice@1240030004 : Decimal);
    BEGIN
      IF ItemLevel AND (CurrOldValue = 0) AND (CurrNewValue <> 0) THEN BEGIN
        IF ForSummaryView."Forecast Unit" <> ForSummaryView."Forecast Unit"::Quantity THEN
          ERROR(Text005);
        CurrQty := CurrNewValue;
        CurrCost := ROUND(CurrNewValue * ForSummaryEntry."Unit Cost (LCY)",1.0);
        CurrPrice := ROUND(CurrNewValue * ForSummaryEntry."Unit Price (LCY)",1.0);
      END ELSE BEGIN
        PercentAdj := (CurrNewValue - CurrOldValue) / CurrOldValue;
        CurrQty := CurrQty + ROUND(CurrQty * PercentAdj,1.0);
        CurrCost := CurrCost + ROUND(CurrCost * PercentAdj,1.0);
        CurrPrice := CurrPrice + ROUND(CurrPrice * PercentAdj,1.0);
      END;
    END;

    BEGIN
    END.
  }
}

