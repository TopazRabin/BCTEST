OBJECT Table 14000825 Bill of Lading Summary Line
{
  OBJECT-PROPERTIES
  {
    Date=03/05/18;
    Time=12:00:00 PM;
    Version List=SE0.60.19;
  }
  PROPERTIES
  {
    CaptionML=ENU=Bill of Lading Summary Line;
  }
  FIELDS
  {
    { 1   ;   ;Bill of Lading No.  ;Code20        ;TableRelation="Bill of Lading";
                                                   CaptionML=ENU=Bill of Lading No. }
    { 2   ;   ;Bill of Lading Type ;Option        ;CaptionML=ENU=Bill of Lading Type;
                                                   OptionCaptionML=ENU=Standard,ASN (EDI),ASN (Base),Package Summary;
                                                   OptionString=Standard,ASN (EDI),ASN (Base),Package Summary }
    { 3   ;   ;Line No.            ;Integer       ;CaptionML=ENU=Line No. }
    { 11  ;   ;Parent Line No.     ;Integer       ;CaptionML=ENU=Parent Line No. }
    { 12  ;   ;Level               ;Integer       ;CaptionML=ENU=Level }
    { 13  ;   ;Type                ;Option        ;CaptionML=ENU=Type;
                                                   OptionCaptionML=ENU=Bill of Lading,Order,Shipment,Package,Item,Purchase Order,Tare,Item (ASN),Package (Item),Std. Pack. (UOM);
                                                   OptionString=Bill of Lading,Order,Shipment,Package,Item,Purchase Order,Tare,Item (ASN),Package (Item),Std. Pack. (UOM) }
    { 14  ;   ;No.                 ;Code35        ;TestTableRelation=No;
                                                   CaptionML=ENU=No. }
    { 15  ;   ;Description         ;Text50        ;CaptionML=ENU=Description }
    { 16  ;   ;Type Description    ;Text100       ;OnLookup=BEGIN
                                                              LookupTypeDescription;
                                                            END;

                                                   CaptionML=ENU=Type Description }
    { 17  ;   ;Source Type         ;Integer       ;CaptionML=ENU=Source Type }
    { 18  ;   ;Source Subtype      ;Option        ;CaptionML=ENU=Source Subtype;
                                                   OptionCaptionML=ENU=0,1,2,3,4,5,6,7,8,9,10;
                                                   OptionString=0,1,2,3,4,5,6,7,8,9,10 }
    { 19  ;   ;Source ID           ;Code20        ;CaptionML=ENU=Source ID }
    { 20  ;   ;Posted Source ID    ;Code20        ;CaptionML=ENU=Posted Source ID }
    { 23  ;   ;Package No.         ;Code20        ;CaptionML=ENU=Package No. }
    { 24  ;   ;Package Line Line No.;Integer      ;CaptionML=ENU=Package Line Line No. }
    { 25  ;   ;Package Line Type   ;Option        ;CaptionML=ENU=Package Line Type;
                                                   OptionCaptionML=ENU=" ,Account (G/L),Item,Resource,,,,,,,Package";
                                                   OptionString=[ ,Account (G/L),Item,Resource,,,,,,,Package] }
    { 26  ;   ;Package Line No.    ;Code20        ;CaptionML=ENU=Package Line No. }
    { 27  ;   ;Package Line Variant Code;Code10   ;CaptionML=ENU=Package Line Variant Code }
    { 28  ;   ;Package Line Unit of Measure;Code10;CaptionML=ENU=Package Line Unit of Measure }
    { 29  ;   ;Package Line Quantity;Decimal      ;CaptionML=ENU=Package Line Quantity;
                                                   DecimalPlaces=0:5 }
    { 30  ;   ;Package Line Quantity (Base);Decimal;
                                                   CaptionML=ENU=Package Line Quantity (Base);
                                                   DecimalPlaces=0:5 }
    { 31  ;   ;UCC No.             ;Code30        ;CaptionML=ENU=UCC No. }
    { 33  ;   ;External Tracking No.;Code30       ;CaptionML=ENU=External Tracking No. }
    { 34  ;   ;External Document No.;Code35       ;CaptionML=ENU=External Document No. }
    { 35  ;   ;First Level Package No.;Code20     ;TableRelation="Posted Package";
                                                   CaptionML=ENU=First Level Package No. }
    { 36  ;   ;Second Level Package No.;Code20    ;TableRelation="Posted Package";
                                                   CaptionML=ENU=Second Level Package No. }
    { 37  ;   ;First Level Line No.;Integer       ;TableRelation="Bill of Lading Summary Line"."Line No." WHERE (Bill of Lading No.=FIELD(Bill of Lading No.),
                                                                                                                 Bill of Lading Type=FIELD(Bill of Lading Type));
                                                   CaptionML=ENU=First Level Line No. }
    { 38  ;   ;Second Level Line No.;Integer      ;TableRelation="Bill of Lading Summary Line"."Line No." WHERE (Bill of Lading No.=FIELD(Bill of Lading No.),
                                                                                                                 Bill of Lading Type=FIELD(Bill of Lading Type));
                                                   CaptionML=ENU=Second Level Line No. }
    { 39  ;   ;Package Contains Only Packages;Boolean;
                                                   CaptionML=ENU=Package Contains Only Packages }
    { 40  ;   ;UCC No. (Print)     ;Code30        ;CaptionML=ENU=UCC No. (Print) }
    { 44  ;   ;ASN Comment         ;Text250       ;CaptionML=ENU=ASN Comment }
    { 45  ;   ;Multi Package Line Quantity;Decimal;CaptionML=ENU=Multi Package Line Quantity;
                                                   DecimalPlaces=0:5 }
    { 46  ;   ;Multi Package Line Qty. (Base);Decimal;
                                                   CaptionML=ENU=Multi Package Line Qty. (Base);
                                                   DecimalPlaces=0:5 }
    { 47  ;   ;Multi Document      ;Boolean       ;CaptionML=ENU=Multi Document }
    { 48  ;   ;Prioritized Sorting ;Integer       ;CaptionML=ENU=Prioritized Sorting }
    { 51  ;   ;Weight              ;Decimal       ;CaptionML=ENU=Weight;
                                                   DecimalPlaces=0:5;
                                                   BlankZero=Yes }
    { 52  ;   ;Volume              ;Decimal       ;CaptionML=ENU=Volume;
                                                   DecimalPlaces=0:5;
                                                   BlankZero=Yes }
    { 53  ;   ;Value               ;Decimal       ;CaptionML=ENU=Value;
                                                   DecimalPlaces=2:2;
                                                   BlankZero=Yes }
    { 54  ;   ;EDI Level ID        ;Code35        ;CaptionML=ENU=EDI Level ID }
    { 55  ;   ;No. of Packages with Packages;Integer;
                                                   CaptionML=ENU=No. of Packages with Packages }
    { 56  ;   ;No. of Packages with Items;Integer ;CaptionML=ENU=No. of Packages with Items }
    { 57  ;   ;Bill of Lading in BOL;Boolean      ;CaptionML=ENU=Bill of Lading in BOL }
    { 61  ;   ;Item UPC/EAN Number ;Code20        ;CaptionML=ENU=Item UPC/EAN Number }
    { 62  ;   ;Item UPC/EAN Number (Print);Code50 ;CaptionML=ENU=Item UPC/EAN Number (Print) }
    { 63  ;   ;Std. Pack UPC/EAN Number;Code20    ;CaptionML=ENU=Std. Pack UPC/EAN Number }
    { 64  ;   ;Std. Pack UPC/EAN No. (Print);Code50;
                                                   CaptionML=ENU=Std. Pack UPC/EAN No. (Print) }
    { 65  ;   ;One Unit of Measure Code;Code10    ;CaptionML=ENU=One Unit of Measure Code }
    { 66  ;   ;RF-ID (Hex)         ;Code50        ;CaptionML=ENU=RF-ID (Hex) }
    { 71  ;   ;Custom Value 1      ;Code20        ;CaptionML=ENU=Custom Value 1 }
    { 72  ;   ;Custom Value 2      ;Code20        ;CaptionML=ENU=Custom Value 2 }
    { 73  ;   ;Custom Value 3      ;Code20        ;CaptionML=ENU=Custom Value 3 }
    { 74  ;   ;Custom Value 4      ;Code20        ;CaptionML=ENU=Custom Value 4 }
    { 75  ;   ;Custom Value 5      ;Code20        ;CaptionML=ENU=Custom Value 5 }
    { 81  ;   ;Third Level Package No.;Code20     ;TableRelation="Posted Package";
                                                   CaptionML=ENU=Third Level Package No. }
    { 82  ;   ;Third Level Line No.;Integer       ;TableRelation="Bill of Lading Summary Line"."Line No." WHERE (Bill of Lading No.=FIELD(Bill of Lading No.),
                                                                                                                 Bill of Lading Type=FIELD(Bill of Lading Type));
                                                   CaptionML=ENU=Third Level Line No. }
    { 83  ;   ;Fourth Level Package No.;Code20    ;TableRelation="Posted Package";
                                                   CaptionML=ENU=Fourth Level Package No. }
    { 84  ;   ;Fourth Level Line No.;Integer      ;TableRelation="Bill of Lading Summary Line"."Line No." WHERE (Bill of Lading No.=FIELD(Bill of Lading No.),
                                                                                                                 Bill of Lading Type=FIELD(Bill of Lading Type));
                                                   CaptionML=ENU=Fourth Level Line No. }
    { 85  ;   ;Fifth Level Package No.;Code20     ;TableRelation="Posted Package";
                                                   CaptionML=ENU=Fifth Level Package No. }
    { 86  ;   ;Fifth Level Line No.;Integer       ;TableRelation="Bill of Lading Summary Line"."Line No." WHERE (Bill of Lading No.=FIELD(Bill of Lading No.),
                                                                                                                 Bill of Lading Type=FIELD(Bill of Lading Type));
                                                   CaptionML=ENU=Fifth Level Line No. }
    { 87  ;   ;Advanced Line No.   ;Integer       ;CaptionML=ENU=Advanced Line No. }
    { 88  ;   ;Advanced Parent Line No.;Integer   ;CaptionML=ENU=Advanced Parent Line No. }
    { 91  ;   ;Summarized Quantity ;Decimal       ;CaptionML=ENU=Summarized Quantity;
                                                   DecimalPlaces=0:5 }
    { 92  ;   ;Summarized Quantity (Base);Decimal ;CaptionML=ENU=Summarized Quantity (Base);
                                                   DecimalPlaces=0:5 }
    { 93  ;   ;Zero ASN Line       ;Boolean       ;CaptionML=ENU=Zero ASN Line }
    { 94  ;   ;Override ASN Summary Type;Option   ;CaptionML=ENU=Override ASN Summary Type;
                                                   OptionCaptionML=ENU=" ,Shipment-Order-Item,Shipment-Order-Package-Item,Shipment-Order-Tare-Package-Item,Shipment-Order-Item-Package,Shipment-Package-Order-Item,Prioritized,,,,,Custom 1,Custom 2,Custom 3";
                                                   OptionString=[ ,Shipment-Order-Item,Shipment-Order-Package-Item,Shipment-Order-Tare-Package-Item,Shipment-Order-Item-Package,Shipment-Package-Order-Item,Prioritized,,,,,Custom 1,Custom 2,Custom 3] }
    { 95  ;   ;Override ASN Summary;Boolean       ;CaptionML=ENU=Override ASN Summary }
  }
  KEYS
  {
    {    ;Bill of Lading No.,Bill of Lading Type,Line No.;
                                                   Clustered=Yes }
    {    ;Bill of Lading No.,Bill of Lading Type,Parent Line No.;
                                                   MaintainSQLIndex=No }
    {    ;Bill of Lading No.,Bill of Lading Type,External Document No.;
                                                   MaintainSQLIndex=No }
    {    ;Bill of Lading No.,Bill of Lading Type,External Document No.,Type,No.,Package Line Variant Code;
                                                   MaintainSQLIndex=No }
    {    ;Bill of Lading No.,Bill of Lading Type,External Document No.,Source Type,Source Subtype,Source ID;
                                                   MaintainSQLIndex=No }
    {    ;Bill of Lading No.,Bill of Lading Type,External Document No.,Source Type,Source Subtype,Source ID,Type,No.,Package Line Variant Code;
                                                   MaintainSQLIndex=No }
    {    ;Bill of Lading No.,Bill of Lading Type,First Level Package No.;
                                                   MaintainSQLIndex=No }
    {    ;Bill of Lading No.,Bill of Lading Type,Prioritized Sorting }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      BillOfLading@1000000000 : Record 14000822;
      BillOfLadingSummaryLine@1000000004 : Record 14000825;
      SalesHeader@1000000001 : Record 36;
      SalesShipmentHeader@1000000002 : Record 110;
      PostedPackage@1000000003 : Record 14000704;
      Text001@1001 : TextConst 'ENU=No lookup for this type.';
      Text002@1240030001 : TextConst 'ENU=External Document No. %1 do not have a unique invoice.';
      Text003@1240030000 : TextConst 'ENU=External Document No. %1 do not have an invoice.';

    PROCEDURE LookupTypeDescription@1();
    BEGIN
      CASE Type OF
        Type::"Bill of Lading":
          BEGIN
            TESTFIELD("Bill of Lading No.");
            BillOfLading.GET("Bill of Lading No.");
            PAGE.RUNMODAL(PAGE::"Bill of Lading",BillOfLading);
          END;
        Type::Order:
          BEGIN
            TESTFIELD("Source ID");
            SalesHeader.GET("Source Subtype","Source ID");
            PAGE.RUNMODAL(PAGE::"Sales Order",SalesHeader);
          END;
        Type::Shipment:
          BEGIN
            TESTFIELD("Posted Source ID");
            SalesShipmentHeader.GET("Posted Source ID");
            PAGE.RUNMODAL(PAGE::"Posted Sales Shipment",SalesShipmentHeader);
          END;
        Type::Package,Type::Item,Type::Tare:
          BEGIN
            TESTFIELD("Package No.");
            PostedPackage.GET("Package No.");
            IF PostedPackage.Miscellaneous THEN
              PAGE.RUNMODAL(PAGE::"Posted Miscellaneous Package",PostedPackage)
            ELSE
              PAGE.RUNMODAL(PAGE::"Posted Package",PostedPackage);
          END;
        Type::"Purchase Order":
          ERROR(Text001);
      END;
    END;

    PROCEDURE CombineShipments@3();
    BEGIN
      BillOfLading.GET("Bill of Lading No.");

      SalesShipmentHeader.RESET;
      SalesShipmentHeader.SETRANGE("Bill of Lading No.","Bill of Lading No.");
      SalesShipmentHeader.SETRANGE("External Document No.","External Document No.");
      IF BillOfLading."Ship-to Code" <> '' THEN
        SalesShipmentHeader.SETRANGE("Ship-to Code",BillOfLading."Ship-to Code");

      REPORT.RUN(REPORT::"Combine Shipments",TRUE,TRUE,SalesShipmentHeader);
    END;

    PROCEDURE EditASNValues@2();
    BEGIN
      BillOfLading.GET("Bill of Lading No.");
      BillOfLading.TESTFIELD(Released,TRUE);
      BillOfLading.TESTFIELD("Summary Released",TRUE);
      BillOfLading.TESTFIELD("EDI ASN Generated",FALSE);

      BillOfLadingSummaryLine.RESET;
      BillOfLadingSummaryLine.FILTERGROUP(2);
      BillOfLadingSummaryLine.SETRANGE("Bill of Lading No.","Bill of Lading No.");
      BillOfLadingSummaryLine.SETRANGE("Bill of Lading Type","Bill of Lading Type");
      BillOfLadingSummaryLine.SETRANGE("Line No.","Line No.");
      BillOfLadingSummaryLine.FILTERGROUP(0);

      PAGE.RUNMODAL(PAGE::"Bill of Lad. Sum. Line - Edit",BillOfLadingSummaryLine);
    END;

    PROCEDURE FindInvoiceNo@1240030001();
    VAR
      SalesInvoiceHeader@1000000000 : Record 112;
      BillOfLadingSummaryLine2@1000000001 : Record 14000825;
    BEGIN
      BillOfLadingSummaryLine.RESET;
      BillOfLadingSummaryLine.SETRANGE("Bill of Lading No.","Bill of Lading No.");
      BillOfLadingSummaryLine.SETRANGE(
        "Bill of Lading Type",
        BillOfLadingSummaryLine."Bill of Lading Type"::"ASN (EDI)");
      BillOfLadingSummaryLine.SETRANGE(Type,BillOfLadingSummaryLine.Type::"Purchase Order");
      BillOfLadingSummaryLine.SETRANGE("Custom Value 1",'');
      IF BillOfLadingSummaryLine.FIND('-') THEN
        REPEAT
          SalesInvoiceHeader.RESET;
          SalesInvoiceHeader.SETCURRENTKEY("Invoice for Bill of Lading No.");
          SalesInvoiceHeader.SETRANGE("Invoice for Bill of Lading No.","Bill of Lading No.");
          SalesInvoiceHeader.SETRANGE(
            "External Document No.",BillOfLadingSummaryLine."External Document No.");
          IF SalesInvoiceHeader.FIND('-') THEN BEGIN
            IF SalesInvoiceHeader.NEXT = 0 THEN BEGIN
              BillOfLadingSummaryLine2 := BillOfLadingSummaryLine;
              BillOfLadingSummaryLine2."Custom Value 1" := SalesInvoiceHeader."No.";
              BillOfLadingSummaryLine2.MODIFY;
            END ELSE
              MESSAGE(
                Text002,
                BillOfLadingSummaryLine."External Document No.");
          END ELSE
            MESSAGE(
              Text003,
              BillOfLadingSummaryLine."External Document No.");
        UNTIL BillOfLadingSummaryLine.NEXT = 0;
    END;

    PROCEDURE EditCustomValues@1240030000();
    BEGIN
      BillOfLading.GET("Bill of Lading No.");
      BillOfLading.TESTFIELD(Released,TRUE);
      BillOfLading.TESTFIELD("Summary Released",TRUE);
      BillOfLading.TESTFIELD("EDI ASN Generated",FALSE);

      BillOfLadingSummaryLine.RESET;
      BillOfLadingSummaryLine.FILTERGROUP(2);
      BillOfLadingSummaryLine.SETRANGE("Bill of Lading No.","Bill of Lading No.");
      BillOfLadingSummaryLine.SETRANGE("Bill of Lading Type","Bill of Lading Type");
      BillOfLadingSummaryLine.SETRANGE("Line No.","Line No.");
      BillOfLadingSummaryLine.FILTERGROUP(0);

      PAGE.RUNMODAL(PAGE::"Bill of Lad. Sum. Line - Edit",BillOfLadingSummaryLine);
    END;

    BEGIN
    END.
  }
}

