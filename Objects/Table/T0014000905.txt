OBJECT Table 14000905 E-Mail Setup
{
  OBJECT-PROPERTIES
  {
    Date=07/13/20;
    Time=12:00:00 PM;
    Version List=SE0.62;
  }
  PROPERTIES
  {
    OnInsert=BEGIN
               SalesSetup.GET;
               SalesSetup.TESTFIELD("Enable E-Mail");
             END;

    CaptionML=ENU=E-Mail Setup;
  }
  FIELDS
  {
    { 1   ;   ;Code                ;Code10        ;CaptionML=ENU=Code }
    { 11  ;   ;Object File Name    ;Text250       ;InitValue=c:\temp\newobj.txt;
                                                   CaptionML=ENU=Object File Name }
    { 12  ;   ;E-Mail Buffer Directory;Text250    ;CaptionML=ENU=E-Mail Buffer Directory }
    { 13  ;   ;Comment             ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist("E-Mail Comment Line" WHERE (Table ID=CONST(14000905),
                                                                                                  Code=FIELD(Code)));
                                                   CaptionML=ENU=Comment;
                                                   Editable=No }
    { 14  ;   ;Max Record No.      ;Integer       ;InitValue=2;
                                                   CaptionML=ENU=Max Record No.;
                                                   MinValue=0;
                                                   MaxValue=20 }
    { 15  ;   ;Default E-Mail Rule ;Code10        ;TableRelation="E-Mail Rule";
                                                   CaptionML=ENU=Default E-Mail Rule }
    { 16  ;   ;Manual Send E-Mail Action;Option   ;CaptionML=ENU=Manual Send E-Mail Action;
                                                   OptionCaptionML=ENU=" ,Enter If none Exist,Always Show E-Mail List";
                                                   OptionString=[ ,Enter If none Exist,Always Show E-Mail List] }
    { 17  ;   ;Show Error on Manual Sending;Boolean;
                                                   CaptionML=ENU=Show Error on Manual Sending }
    { 18  ;   ;Allow List Ent. Modify on Send;Boolean;
                                                   CaptionML=ENU=Allow List Ent. Modify on Send }
    { 19  ;   ;Allow List Ent. Delete on Send;Boolean;
                                                   CaptionML=ENU=Allow List Ent. Delete on Send }
    { 20  ;   ;Default E-Mail User Rule;Code10    ;TableRelation="E-Mail User Rule";
                                                   CaptionML=ENU=Default E-Mail User Rule }
    { 21  ;   ;Sales Shipment E-Mail;Boolean      ;OnValidate=BEGIN
                                                                IF NOT "Sales Shipment E-Mail" THEN
                                                                  "Automatic Sales Shpmt. E-Mail" := FALSE;
                                                              END;

                                                   CaptionML=ENU=Sales Shipment E-Mail }
    { 22  ;   ;Sales Invoice E-Mail;Boolean       ;OnValidate=BEGIN
                                                                IF NOT "Sales Invoice E-Mail" THEN
                                                                  "Automatic Sales Invoice E-Mail" := FALSE;
                                                              END;

                                                   CaptionML=ENU=Sales Invoice E-Mail }
    { 23  ;   ;Sales Order Conf. E-Mail;Boolean   ;CaptionML=ENU=Sales Order Conf. E-Mail }
    { 24  ;   ;Automatic Sales Shpmt. E-Mail;Boolean;
                                                   OnValidate=BEGIN
                                                                TESTFIELD("Sales Shipment E-Mail");
                                                              END;

                                                   CaptionML=ENU=Automatic Sales Shpmt. E-Mail }
    { 25  ;   ;Automatic Sales Invoice E-Mail;Boolean;
                                                   OnValidate=BEGIN
                                                                TESTFIELD("Sales Invoice E-Mail");
                                                              END;

                                                   CaptionML=ENU=Automatic Sales Invoice E-Mail }
    { 26  ;   ;Automatic Sales Confirm E-Mail;Boolean;
                                                   CaptionML=ENU=Automatic Sales Confirm E-Mail }
    { 27  ;   ;Bill of Lading E-Mail;Boolean      ;CaptionML=ENU=Bill of Lading E-Mail }
    { 28  ;   ;Automatic Bill of Lad. E-Mail;Boolean;
                                                   OnValidate=BEGIN
                                                                TESTFIELD("Bill of Lading E-Mail");
                                                              END;

                                                   CaptionML=ENU=Automatic Bill of Lad. E-Mail }
    { 29  ;   ;Customer Statement E-Mail;Boolean  ;CaptionML=ENU=Customer Statement E-Mail }
    { 30  ;   ;Automatic Cust. Stat. E-Mail;Boolean;
                                                   CaptionML=ENU=Automatic Cust. Stat. E-Mail }
    { 31  ;   ;Sales Quote Conf. E-Mail;Boolean   ;CaptionML=ENU=Sales Quote Conf. E-Mail }
    { 32  ;   ;Sales Invoice Conf. E-Mail;Boolean ;CaptionML=ENU=Sales Invoice Conf. E-Mail }
    { 33  ;   ;Sales Credit Memo Conf. E-Mail;Boolean;
                                                   CaptionML=ENU=Sales Credit Memo Conf. E-Mail }
    { 34  ;   ;Sales Bl. Order Conf. E-Mail;Boolean;
                                                   CaptionML=ENU=Sales Bl. Order Conf. E-Mail }
    { 35  ;   ;Sales Ret. Order Conf. E-Mail;Boolean;
                                                   CaptionML=ENU=Sales Ret. Order Conf. E-Mail }
    { 41  ;   ;Purchase Quote Conf. E-Mail;Boolean;CaptionML=ENU=Purchase Quote Conf. E-Mail }
    { 42  ;   ;Purch. Bl. Order Conf. E-Mail;Boolean;
                                                   CaptionML=ENU=Purch. Bl. Order Conf. E-Mail }
    { 43  ;   ;Purchase Order Conf. E-Mail;Boolean;CaptionML=ENU=Purchase Order Conf. E-Mail }
    { 44  ;   ;Purchase Invoice Conf. E-Mail;Boolean;
                                                   CaptionML=ENU=Purchase Invoice Conf. E-Mail }
    { 45  ;   ;Purchase Cr. Memo Conf. E-Mail;Boolean;
                                                   CaptionML=ENU=Purchase Cr. Memo Conf. E-Mail }
    { 46  ;   ;Automatic Purch. Conf. E-Mail;Boolean;
                                                   CaptionML=ENU=Automatic Purch. Conf. E-Mail }
    { 47  ;   ;Purch. Ret. Order Conf. E-Mail;Boolean;
                                                   CaptionML=ENU=Purch. Ret. Order Conf. E-Mail }
    { 51  ;   ;Issued Reminder E-Mail;Boolean     ;CaptionML=ENU=Issued Reminder E-Mail }
    { 52  ;   ;Automatic Issued Rem. E-Mail;Boolean;
                                                   OnValidate=BEGIN
                                                                TESTFIELD("Issued Reminder E-Mail");
                                                              END;

                                                   CaptionML=ENU=Automatic Issued Rem. E-Mail }
    { 53  ;   ;Issued Fin.Charge Memo E-Mail;Boolean;
                                                   CaptionML=ENU=Issued Fin.Charge Memo E-Mail }
    { 54  ;   ;Aut. Issued Fin Ch Memo E-Mail;Boolean;
                                                   OnValidate=BEGIN
                                                                TESTFIELD("Issued Fin.Charge Memo E-Mail");
                                                              END;

                                                   CaptionML=ENU=Aut. Issued Fin Ch Memo E-Mail }
    { 55  ;   ;Purchase Receipt E-Mail;Boolean    ;CaptionML=ENU=Purchase Receipt E-Mail }
    { 56  ;   ;Automatic Purch. Rcpt. E-Mail;Boolean;
                                                   OnValidate=BEGIN
                                                                TESTFIELD("Purchase Receipt E-Mail");
                                                              END;

                                                   CaptionML=ENU=Automatic Purch. Rcpt. E-Mail }
    { 57  ;   ;Purchase Invoice E-Mail;Boolean    ;CaptionML=ENU=Purchase Invoice E-Mail }
    { 58  ;   ;Automatic Purch. Inv. E-Mail;Boolean;
                                                   OnValidate=BEGIN
                                                                TESTFIELD("Purchase Invoice E-Mail");
                                                              END;

                                                   CaptionML=ENU=Automatic Purch. Inv. E-Mail }
    { 71  ;   ;E-Mail Integration Type;Option     ;CaptionML=ENU=E-Mail Integration Type;
                                                   OptionCaptionML=ENU=" ,SMTP,Outlook";
                                                   OptionString=[ ,SMTP,Outlook] }
    { 72  ;   ;SMTP Server         ;Text250       ;CaptionML=ENU=SMTP Server }
    { 73  ;   ;SMTP Authentication ;Option        ;OnValidate=BEGIN
                                                                IF "SMTP Authentication" <> "SMTP Authentication"::Basic THEN BEGIN
                                                                  "SMTP User ID" := '';
                                                                  "SMTP Password" := '';
                                                                END;
                                                              END;

                                                   CaptionML=ENU=SMTP Authentication;
                                                   OptionCaptionML=ENU=Anonymous,NTLM,Basic;
                                                   OptionString=Anonymous,NTLM,Basic }
    { 74  ;   ;SMTP User ID        ;Text50        ;OnValidate=BEGIN
                                                                TESTFIELD("SMTP Authentication","SMTP Authentication"::Basic);
                                                              END;

                                                   CaptionML=ENU=SMTP User ID }
    { 75  ;   ;SMTP Password       ;Text30        ;OnValidate=BEGIN
                                                                TESTFIELD("SMTP Authentication","SMTP Authentication"::Basic);
                                                              END;

                                                   CaptionML=ENU=SMTP Password }
    { 76  ;   ;SMTP Server Port    ;Integer       ;InitValue=25;
                                                   CaptionML=ENU=SMTP Server Port }
    { 77  ;   ;SMTP Secure Connection;Option      ;InitValue=True;
                                                   CaptionML=ENU=SMTP Secure Connection;
                                                   OptionCaptionML=ENU=True,False;
                                                   OptionString=True,False }
    { 51000;  ;From Name           ;Text30        ;CaptionML=ENU=From Name }
    { 51001;  ;From Address        ;Text80        ;CaptionML=ENU=From Address }
    { 51003;  ;Qualty Return Conf. E-Mail;Text80  ;Description=TPZ118 }
    { 51020;  ;Sales Credit Memo E-Mail;Boolean   ;CaptionML=ENU=Sales Credit Memo E-Mail }
    { 51021;  ;Automatic Sales Cr. M. E-Mail;Boolean;
                                                   CaptionML=ENU=Automatic Sales Cr. M. E-Mail }
    { 51700;  ;Mfr. Rep. Statement E-Mail;Boolean ;CaptionML=ENU=Mfr. Rep. Statement E-Mail }
    { 51701;  ;Loc. Hdlg. Statement E-Mail;Boolean;CaptionML=ENU=Loc. Hdlg. Statement E-Mai }
    { 60000;  ;Enbl. Sls.Inv. Off. 365 E-mail;Boolean }
    { 60001;  ;Sales Invoice Off. 365 E-mail;Text80 }
    { 60002;  ;Enbl. Sls.CM. Off. 365 E-mail;Boolean }
    { 60003;  ;Sales CM Off. 365 E-mail;Text80     }
    { 60004;  ;Enbl. Cu. Sta. Off. 365 E-mail;Boolean }
    { 60005;  ;Cust. Stat. Off. 365 E-mail;Text80  }
    { 60006;  ;SMTP Server  Off. 365;Text250       }
    { 60007;  ;SMTP  Authentication Off. 365;Option;
                                                   OptionString=Anonymous,NTLM,Basic }
    { 60008;  ;SMTP User ID Off. 365;Text50        }
    { 60009;  ;SMTP Password Off. 365;Text30       }
    { 60010;  ;SMTP Server Port Off. 365;Integer   }
    { 60011;  ;SMTP Secure Conn. Off. 365;Option  ;OptionString=True,False }
    { 60012;  ;SMTP Off. 365 Enable;Boolean        }
    { 60013;  ;SO Off. 365 Conf. E-Mail;Text80    ;DataClassification=ToBeClassified;
                                                   Description=TPZ2430 }
    { 60014;  ;SPS ASN Off.365 E-Mail;Text80      ;DataClassification=ToBeClassified;
                                                   Description=TPZ2430 }
    { 60015;  ;SRO Off. 365 Conf. E-Mail;Text80   ;DataClassification=ToBeClassified;
                                                   Description=TPZ2430 }
    { 60016;  ;SQ Off. 365 Conf. E-Mail;Text80    ;DataClassification=ToBeClassified;
                                                   Description=TPZ2430 }
    { 60017;  ;BOL Off. 365 E-Mail ;Text80        ;DataClassification=ToBeClassified;
                                                   Description=TPZ2430 }
  }
  KEYS
  {
    {    ;Code                                    ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      SalesSetup@1000000000 : Record 311;
      Text015@1240030003 : TextConst 'ENU=The objects to Utilities has not been downloaded and installed in the database. Please contact your System Administrator';

    PROCEDURE OpenUtilitySetup@12();
    VAR
      Object@1240030000 : Record 2000000001;
    BEGIN
      IF NOT Object.GET(Object.Type::Page,'',14100351) THEN
        ERROR(Text015);

      PAGE.RUN(14100351);
    END;

    PROCEDURE ExportOnlineHelp@6();
    VAR
      Object@1240030000 : Record 2000000001;
    BEGIN
      IF NOT Object.GET(Object.Type::Codeunit,'',14100351) THEN
        ERROR(Text015);

      CODEUNIT.RUN(14100351);
    END;

    PROCEDURE AboutEMail@9();
    VAR
      Object@1240030000 : Record 2000000001;
      ApplicationManagement@1240030001 : Codeunit 1;
      SEVersion@1240020001 : Codeunit 37031003;
      HighestVersion@1240030002 : Text[250];
      OSVersionText@1240030003 : Text[250];
      ReleaseVersion@1240020000 : Text[250];
    BEGIN
      HighestVersion := '';
      ReleaseVersion := SEVersion.GetSEVersion;

      Object.RESET;
      Object.SETFILTER("Version List",'SE0*');
      IF Object.FIND('-') THEN
        REPEAT
          IF Object."Version List" > HighestVersion THEN
            HighestVersion := Object."Version List";
        UNTIL Object.NEXT = 0;

      IF NOT ISSERVICETIER THEN
        OSVersionText := OSVERSION;

      MESSAGE(
        '%1\\' + '%2\\' + 'Version (%3)(E-Ship 3.17 (%5))\\' + '%4',
        COMPANYNAME,SERIALNUMBER,ApplicationManagement.ApplicationVersion,
        OSVersionText,HighestVersion + ' (' + ReleaseVersion +')');
    END;

    PROCEDURE ChangeFilenameToPDF@1240030000(VAR SaveFileName@1240030000 : Text[1000]);
    BEGIN
      IF STRLEN(SaveFileName) > 5 THEN
        IF UPPERCASE(COPYSTR(SaveFileName,STRLEN(SaveFileName) - 3)) = '.HTM' THEN
          SaveFileName := COPYSTR(SaveFileName,1,STRLEN(SaveFileName) - 3) + 'pdf';
        IF UPPERCASE(COPYSTR(SaveFileName,STRLEN(SaveFileName) - 4)) = '.HTML' THEN
          SaveFileName := COPYSTR(SaveFileName,1,STRLEN(SaveFileName) - 4) + 'pdf';
    END;

    PROCEDURE ChangeFilenameToEXCEL@1000000000(VAR SaveFileName@1240030000 : Text[1000]);
    BEGIN
      //TPZ1261
      IF STRLEN(SaveFileName) > 5 THEN
        IF UPPERCASE(COPYSTR(SaveFileName,STRLEN(SaveFileName) - 3)) = '.HTM' THEN
          SaveFileName := COPYSTR(SaveFileName,1,STRLEN(SaveFileName) - 3) + 'xlsx';
        IF UPPERCASE(COPYSTR(SaveFileName,STRLEN(SaveFileName) - 4)) = '.HTML' THEN
          SaveFileName := COPYSTR(SaveFileName,1,STRLEN(SaveFileName) - 4) + 'xlsx';
    END;

    BEGIN
    {
      2015-06-11 TPZ92 TAKHMETO
        Mfr. Rep. Statement E-Mail, Loc. Hdlg. Statement E-Mail fields have been created
      2015-07-30 TOP859 TAKHMETO
        From Name and From Address fields have been created
      2015-08-25 TPZ143 TAKHMETO
        Sales Credit Memo and Automatic Sales Cr. M. E-Mail fields have been created
      2016-08-21 TPZ118 EBAGIM
        "Qualty Return Conf. E-Mail" Field was added
      2017-01-04 TPZ1261 EBAGIM
        ChangeFilenameToEXCEL Function added
      2017-03-05 TPZ1788 SDESAI
        Added new Fields (60000-60012) for Office 365 SMTP
      2019-01-18 TPZ2430 SNAGPAL
        Move outbound emails to O365 smtp server.
    }
    END.
  }
}

