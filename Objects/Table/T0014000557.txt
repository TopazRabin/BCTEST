OBJECT Table 14000557 Item Usage
{
  OBJECT-PROPERTIES
  {
    Date=08/31/18;
    Time=12:00:00 PM;
    Version List=UBP2.99.01;
  }
  PROPERTIES
  {
    Permissions=TableData 32=r;
    DataCaptionFields=Location Code,Item No.,Variant Code,Starting Date;
    CaptionML=ENU=Item Usage;
    LookupPageID=Page14000564;
    DrillDownPageID=Page14000564;
  }
  FIELDS
  {
    { 1   ;   ;Entry No.           ;Integer       ;CaptionML=ENU=Entry No. }
    { 11  ;   ;Location Code       ;Code10        ;TableRelation=Location.Code;
                                                   CaptionML=ENU=Location Code }
    { 12  ;   ;Item No.            ;Code50        ;TableRelation=Item.No.;
                                                   CaptionML=ENU=Item No. }
    { 13  ;   ;Variant Code        ;Code10        ;TableRelation="Item Variant".Code WHERE (Item No.=FIELD(Item No.));
                                                   CaptionML=ENU=Variant Code }
    { 14  ;   ;Starting Date       ;Date          ;TableRelation="Location Inventory Period"."Starting Date" WHERE (Location Code=FIELD(Location Code));
                                                   CaptionML=ENU=Starting Date }
    { 15  ;   ;Ending Date         ;Date          ;CaptionML=ENU=Ending Date }
    { 16  ;   ;Usage Quantity      ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=-Sum("Usage Ledger Entry".Quantity WHERE (Location Code=FIELD(Location Filter),
                                                                                                         Item No.=FIELD(Item No.),
                                                                                                         Variant Code=FIELD(Variant Code),
                                                                                                         Usage Date=FIELD(Date Filter),
                                                                                                         Entry Type=FILTER(<>Transfer),
                                                                                                         Source No.=FIELD(Source No. Filter)));
                                                   CaptionML=ENU=Usage Quantity;
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 17  ;   ;Adjustment Quantity ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Item Usage Adjustment"."Adjustment Quantity" WHERE (Location Code=FIELD(Location Filter),
                                                                                                                        Item No.=FIELD(Item No.),
                                                                                                                        Variant Code=FIELD(Variant Code),
                                                                                                                        Starting Date=FIELD(Date Filter)));
                                                   CaptionML=ENU=Adjustment Quantity;
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 18  ;   ;Exclude Usage Quantity;Decimal     ;FieldClass=FlowField;
                                                   CalcFormula=-Sum("Usage Ledger Entry".Quantity WHERE (Location Code=FIELD(Location Filter),
                                                                                                         Item No.=FIELD(Item No.),
                                                                                                         Variant Code=FIELD(Variant Code),
                                                                                                         Exclude from Usage=CONST(Yes),
                                                                                                         Usage Date=FIELD(Date Filter),
                                                                                                         Source No.=FIELD(Source No. Filter)));
                                                   CaptionML=ENU=Exclude Usage Quantity;
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 19  ;   ;Transfer Usage      ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=-Sum("Usage Ledger Entry".Quantity WHERE (Location Code=FIELD(Location Filter),
                                                                                                         Item No.=FIELD(Item No.),
                                                                                                         Variant Code=FIELD(Variant Code),
                                                                                                         Entry Type=CONST(Transfer),
                                                                                                         Usage Date=FIELD(Date Filter),
                                                                                                         Transfer Out=CONST(Yes),
                                                                                                         Replenishment Path Transfer=CONST(Yes),
                                                                                                         Source No.=FIELD(Source No. Filter)));
                                                   CaptionML=ENU=Transfer Usage;
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 20  ;   ;Drop Ship Usage Quantity;Decimal   ;FieldClass=FlowField;
                                                   CalcFormula=-Sum("Usage Ledger Entry".Quantity WHERE (Location Code=FIELD(Location Filter),
                                                                                                         Item No.=FIELD(Item No.),
                                                                                                         Variant Code=FIELD(Variant Code),
                                                                                                         Usage Date=FIELD(Date Filter),
                                                                                                         Drop Shipment=CONST(Yes),
                                                                                                         Exclude from Usage=CONST(No),
                                                                                                         Source No.=FIELD(Source No. Filter)));
                                                   CaptionML=ENU=Drop Ship Usage Quantity;
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 21  ;   ;Stockout Days       ;Integer       ;CaptionML=ENU=Consecutive Stockout Days }
    { 22  ;   ;Total Stockout Days ;Integer       ;CaptionML=ENU=Total Stockout Days }
    { 23  ;   ;Adjusted Usage      ;Decimal       ;CaptionML=ENU=Adjusted Usage;
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 24  ;   ;Period End Adjusted Usage;Decimal  ;CaptionML=ENU=Period End Adjusted Usage;
                                                   DecimalPlaces=0:5 }
    { 25  ;   ;Include Drop Ship Usage;Boolean    ;CaptionML=ENU=Include Drop Ship Usage;
                                                   Editable=No }
    { 29  ;   ;Annual Adjusted Usage;Decimal      ;CaptionML=ENU=Annual Adjusted Usage;
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 30  ;   ;Annualized COGS     ;Decimal       ;CaptionML=ENU=Annualized COGS;
                                                   DecimalPlaces=2:2;
                                                   AutoFormatType=1 }
    { 31  ;   ;Nonstock Unit       ;Boolean       ;CaptionML=ENU=Nonstock Unit }
    { 32  ;   ;Item Class Ranking  ;Integer       ;CaptionML=ENU=Item Class Ranking;
                                                   Editable=No }
    { 33  ;   ;Item Class Description;Text30      ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Item Class".Description WHERE (Ranking=FIELD(Item Class Ranking)));
                                                   CaptionML=ENU=Item Class Description;
                                                   Editable=No }
    { 34  ;   ;Date Filter         ;Date          ;FieldClass=FlowFilter;
                                                   CaptionML=ENU=Date Filter }
    { 35  ;   ;First Shipment      ;Boolean       ;CaptionML=ENU=First Shipment }
    { 36  ;   ;Periods to Average  ;Integer       ;CaptionML=ENU=Periods to Average }
    { 37  ;   ;Average Usage       ;Decimal       ;CaptionML=ENU=Average Usage;
                                                   DecimalPlaces=0:5 }
    { 38  ;   ;Average Usage Per Day;Decimal      ;CaptionML=ENU=Average Usage Per Day;
                                                   DecimalPlaces=0:5 }
    { 39  ;   ;Average Transfer Usage;Decimal     ;CaptionML=ENU=Average Transfer Usage;
                                                   DecimalPlaces=0:5 }
    { 40  ;   ;Average Transfer Usage Per Day;Decimal;
                                                   CaptionML=ENU=Average Transfer Usage Per Day;
                                                   DecimalPlaces=0:5 }
    { 42  ;   ;Stockout Date       ;Date          ;CaptionML=ENU=Stockout Date }
    { 43  ;   ;Date Last Out of Stock;Date        ;CaptionML=ENU=Date Last Out of Stock }
    { 44  ;   ;Daily Usage Rate    ;Decimal       ;CaptionML=ENU=Daily Usage Rate;
                                                   DecimalPlaces=0:5 }
    { 45  ;   ;No. of Times Out of Stock;Integer  ;CaptionML=ENU=No. of Times Out of Stock }
    { 46  ;   ;Average Days Out of Stock;Decimal  ;CaptionML=ENU=Average Days Out of Stock;
                                                   DecimalPlaces=0:5 }
    { 47  ;   ;Total Usage to Average;Decimal     ;CaptionML=ENU=Total Usage to Average;
                                                   DecimalPlaces=0:5 }
    { 48  ;   ;First Seasonal Usage;Boolean       ;CaptionML=ENU=First Seasonal Usage }
    { 49  ;   ;Update Adjustments  ;Boolean       ;CaptionML=ENU=Update Adjustments }
    { 53  ;   ;Open Review         ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Usage Review Line" WHERE (Location Code=FIELD(Location Code),
                                                                                                Item No.=FIELD(Item No.),
                                                                                                Variant Code=FIELD(Variant Code),
                                                                                                Reviewed=CONST(No)));
                                                   CaptionML=ENU=Open Review;
                                                   Editable=No }
    { 54  ;   ;Closed Review       ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Usage Review Line" WHERE (Location Code=FIELD(Location Code),
                                                                                                Item No.=FIELD(Item No.),
                                                                                                Variant Code=FIELD(Variant Code),
                                                                                                Reviewed=CONST(Yes)));
                                                   CaptionML=ENU=Closed Review;
                                                   Editable=No }
    { 55  ;   ;New Item Months Supply;Integer     ;CaptionML=ENU=New Item Months Supply;
                                                   Editable=No }
    { 56  ;   ;New Item Expiration Date;Date      ;CaptionML=ENU=New Item Expiration Date;
                                                   Editable=No }
    { 57  ;   ;Adj. After Close    ;Boolean       ;CaptionML=ENU=Adj. After Close;
                                                   Editable=No }
    { 58  ;   ;Calc. Lead Time (Days);Integer     ;CaptionML=ENU=Calc. Lead Time (Days) }
    { 59  ;   ;Calc. Safety Allowance %;Decimal   ;CaptionML=ENU=Calc. Safety Allowance %;
                                                   DecimalPlaces=0:5 }
    { 60  ;   ;Calc. Average Usage Per Day;Decimal;CaptionML=ENU=Calc. Average Usage Per Day;
                                                   DecimalPlaces=0:5 }
    { 61  ;   ;Order Point         ;Decimal       ;CaptionML=ENU=Order Point;
                                                   DecimalPlaces=0:5 }
    { 62  ;   ;Safety Allowance Qty.;Decimal      ;CaptionML=ENU=Safety Allowance Qty.;
                                                   DecimalPlaces=0:5 }
    { 63  ;   ;Line Point          ;Decimal       ;CaptionML=ENU=Line Point;
                                                   DecimalPlaces=0:5 }
    { 64  ;   ;Ave. Daily Inventory Amount;Decimal;CaptionML=ENU=Ave. Daily Inventory Amount;
                                                   DecimalPlaces=2:2 }
    { 65  ;   ;Ave. Daily Inventory Qty.;Decimal  ;CaptionML=ENU=Ave. Daily Inventory Qty.;
                                                   DecimalPlaces=0:5 }
    { 66  ;   ;Total Daily Inventory Qty.;Decimal ;CaptionML=ENU=Total Daily Inventory Qty.;
                                                   DecimalPlaces=0:5 }
    { 67  ;   ;Annual Inventory Turns;Decimal     ;CaptionML=ENU=Annual Inventory Turns;
                                                   DecimalPlaces=0:2 }
    { 68  ;   ;Period Actual Usage Trend %;Decimal;CaptionML=ENU=Period Actual Usage Trend %;
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 69  ;   ;Forecast Horizon Period;Integer    ;CaptionML=ENU=Forecast Horizon Period;
                                                   Editable=No }
    { 70  ;   ;Re-For. Formula     ;Code20        ;TableRelation=Formula.Code;
                                                   CaptionML=ENU=Re-For. Formula;
                                                   Editable=No }
    { 71  ;   ;Re-For. Non Seasonal Trend %;Decimal;
                                                   CaptionML=ENU=Re-For. Non Seasonal Trend %;
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 72  ;   ;Re-For. Usage       ;Decimal       ;CaptionML=ENU=Re-For. Usage;
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 73  ;   ;Re-For. Usage Per Day;Decimal      ;CaptionML=ENU=Re-For. Usage Per Day;
                                                   DecimalPlaces=0:5 }
    { 74  ;   ;Re-For. Median Error %;Decimal     ;CaptionML=ENU=Re-For. Median Error %;
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 75  ;   ;Re-For. Seasonal Trend %;Decimal   ;CaptionML=ENU=Re-For. Seasonal Trend %;
                                                   DecimalPlaces=0:5 }
    { 76  ;   ;Forecast Usage      ;Decimal       ;CaptionML=ENU=Forecast Usage;
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 77  ;   ;Forecast Usage Per Day;Decimal     ;CaptionML=ENU=Forecast Usage Per Day;
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 78  ;   ;Prev. Forecast Usage;Decimal       ;CaptionML=ENU=Prev. Forecast Usage;
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 79  ;   ;Prev. Forecast Usage Per Day;Decimal;
                                                   CaptionML=ENU=Prev. Forecast Usage Per Day;
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 80  ;   ;Prev. Forecast Formula;Code20      ;TableRelation=Formula.Code;
                                                   CaptionML=ENU=Prev. Forecast Formula;
                                                   Editable=No }
    { 90  ;   ;Forecast Cust. Actual Usage;Decimal;FieldClass=FlowField;
                                                   CalcFormula=-Sum("Usage Ledger Entry".Quantity WHERE (Entry Type=CONST(Sale),
                                                                                                         Location Code=FIELD(Location Filter),
                                                                                                         Item No.=FIELD(Item No.),
                                                                                                         Variant Code=FIELD(Variant Code),
                                                                                                         Usage Date=FIELD(Date Filter),
                                                                                                         Forecast Customer=CONST(Yes),
                                                                                                         Exclude from Usage=CONST(No)));
                                                   CaptionML=ENU=Forecast Cust. Actual Usage;
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 91  ;   ;Customer Forecast   ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Forecast Entry".Quantity WHERE (Location Code=FIELD(Location Filter),
                                                                                                    Item No.=FIELD(Item No.),
                                                                                                    Variant Code=FIELD(Variant Code),
                                                                                                    Starting Date=FIELD(Date Filter),
                                                                                                    Released=CONST(Yes)));
                                                   CaptionML=ENU=Customer Forecast;
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 92  ;   ;Forecast Cust. Usage to Ave.;Decimal;
                                                   CaptionML=ENU=Forecast Cust. Usage to Ave.;
                                                   DecimalPlaces=0:5 }
    { 93  ;   ;Forecast Cust. Average Usage;Decimal;
                                                   CaptionML=ENU=Forecast Cust. Average Usage;
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 94  ;   ;Net Usage to Average;Decimal       ;CaptionML=ENU=Net Usage to Average;
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 95  ;   ;Net Average Usage   ;Decimal       ;CaptionML=ENU=Net Average Usage;
                                                   DecimalPlaces=0:1;
                                                   Editable=No }
    { 96  ;   ;Net Period End Usage;Decimal       ;CaptionML=ENU=Net Period End Usage;
                                                   DecimalPlaces=0:5 }
    { 97  ;   ;Contribution %      ;Decimal       ;CaptionML=ENU=Contribution %;
                                                   DecimalPlaces=0:5 }
    { 98  ;   ;Ranking Code        ;Code10        ;CaptionML=ENU=Ranking Code }
    { 99  ;   ;Status              ;Option        ;CaptionML=ENU=Status;
                                                   OptionCaptionML=ENU=" ,New,L.T. Formula Req.,Seasonal,Sporadic,Reoccuring";
                                                   OptionString=[ ,New,L.T. Formula Req.,Seasonal,Sporadic,Reoccuring] }
    { 100 ;   ;Periods With Sales  ;Integer       ;CaptionML=ENU=Periods With Sales }
    { 101 ;   ;Sporadic Ave. Usage Qty.;Decimal   ;CaptionML=ENU=Sporadic Ave. Usage Qty.;
                                                   DecimalPlaces=0:5 }
    { 102 ;   ;Sporadic Target Stock Level;Decimal;CaptionML=ENU=Sporadic Target Stock Level;
                                                   DecimalPlaces=0:5 }
    { 103 ;   ;Source No. Filter   ;Code20        ;FieldClass=FlowFilter;
                                                   CaptionML=ENU=Source No. Filter;
                                                   Editable=No }
    { 104 ;   ;Source No.          ;Code20        ;CaptionML=ENU=Source No. }
    { 105 ;   ;Mean Deviation Units;Decimal       ;CaptionML=ENU=Mean Deviation Units;
                                                   DecimalPlaces=0:2 }
    { 106 ;   ;Forecast Days       ;Decimal       ;CaptionML=ENU=Forecast Days }
    { 200 ;   ;Net Trend %         ;Decimal       ;CaptionML=ENU=Net Trend %;
                                                   DecimalPlaces=0:5 }
    { 201 ;   ;Unit                ;Decimal       ;CaptionML=ENU=Unit }
    { 202 ;   ;Annual Usage Hits   ;Decimal       ;CaptionML=ENU=Annual Usage Hits;
                                                   Editable=No }
    { 203 ;   ;Usage Hits          ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Usage Ledger Entry"."Usage Hit" WHERE (Location Code=FIELD(Location Filter),
                                                                                                           Item No.=FIELD(Item No.),
                                                                                                           Variant Code=FIELD(Variant Code),
                                                                                                           Usage Date=FIELD(Date Filter),
                                                                                                           Source No.=FIELD(Source No. Filter),
                                                                                                           Exclude from Usage=CONST(No)));
                                                   CaptionML=ENU=Usage Hits;
                                                   DecimalPlaces=0:0;
                                                   Editable=No }
    { 204 ;   ;Item Description    ;Text50        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Item.Description WHERE (No.=FIELD(Item No.)));
                                                   CaptionML=ENU=Item Description;
                                                   Editable=No }
    { 205 ;   ;Variant Description ;Text50        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Item Variant".Description WHERE (Item No.=FIELD(Item No.),
                                                                                                        Code=FIELD(Variant Code)));
                                                   CaptionML=ENU=Variant Description;
                                                   Editable=No }
    { 206 ;   ;Location Filter     ;Code10        ;FieldClass=FlowFilter;
                                                   CaptionML=ENU=Location Filter;
                                                   Editable=No }
    { 207 ;   ;Average Turns       ;Decimal       ;CaptionML=ENU=Average Turns;
                                                   Editable=No }
    { 208 ;   ;Average Inventory Value;Decimal    ;CaptionML=ENU=Average Inventory Value;
                                                   Editable=No }
    { 209 ;   ;Loc. Annualized COGS;Decimal       ;CaptionML=ENU=Loc. Annualized COGS;
                                                   Editable=No }
    { 210 ;   ;Loc. Ave. Inventory Value;Decimal  ;CaptionML=ENU=Loc. Ave. Inventory Value;
                                                   Editable=No }
    { 211 ;   ;Loc. Ave. Turns     ;Decimal       ;CaptionML=ENU=Loc. Ave. Turns;
                                                   Editable=No }
    { 212 ;   ;Loc. Annual Adjusted Usage;Decimal ;CaptionML=ENU=Loc. Annual Adjusted Usage;
                                                   Editable=No }
    { 213 ;   ;Sporadic Median Usage Qty.;Decimal ;CaptionML=ENU=Sporadic Median Usage Qty.;
                                                   Editable=No }
    { 214 ;   ;Average Order Qty.  ;Decimal       ;CaptionML=ENU=Average Order Qty.;
                                                   DecimalPlaces=0:5 }
    { 215 ;   ;Single Loc. Per. End Adj. Usg.;Decimal;
                                                   CaptionML=ENU=Single Loc. Per. End Adj. Usg.;
                                                   DecimalPlaces=0:5 }
    { 216 ;   ;Single Loc. Avg Usage Per Day;Decimal;
                                                   CaptionML=ENU=Single Loc. Avg Usage Per Day;
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
  }
  KEYS
  {
    {    ;Entry No.                               ;Clustered=Yes }
    {    ;Location Code,Item No.,Variant Code,Starting Date,Ending Date;
                                                   SumIndexFields=Adjusted Usage }
    {    ;Location Code,Starting Date,Item No.,Variant Code;
                                                   MaintainSQLIndex=No;
                                                   MaintainSIFTIndex=No }
    {    ;Item No.,Location Code,Variant Code,Starting Date,Ending Date }
    {    ;Location Code,Starting Date,Annualized COGS;
                                                   SumIndexFields=Annualized COGS }
    {    ;Annual Inventory Turns                  ;MaintainSQLIndex=No;
                                                   MaintainSIFTIndex=No }
    {    ;Re-For. Formula,Location Code,Starting Date;
                                                   SumIndexFields=Unit;
                                                   MaintainSQLIndex=No;
                                                   MaintainSIFTIndex=No }
    {    ;Location Code,Starting Date,Annual Usage Hits;
                                                   SumIndexFields=Annual Usage Hits }
    {    ;Source No.                              ;MaintainSQLIndex=No;
                                                   MaintainSIFTIndex=No }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      InvMgtSetup@1240030002 : Record 14000551;
      Text000@1240030001 : TextConst 'ENU=Remove %1 Cloned Usage Entries?';
      ProcUnit@1240030003 : Record 14000555;
      UsageLedgerEntry@1240030000 : Record 14000556;

    PROCEDURE AdjustedUsage@1() AdjUsage@14000500 : Decimal;
    VAR
      ProcUnit@1240030000 : Record 14000555;
    BEGIN
      AdjUsage :=
        ("Usage Quantity" - "Exclude Usage Quantity") + "Adjustment Quantity" + "Transfer Usage";

      IF ProcUnit.GET("Location Code","Item No.","Variant Code") THEN
        IF NOT ProcUnit."Include Drop Ship Usage" THEN
          AdjUsage := AdjUsage - "Drop Ship Usage Quantity";
    END;

    PROCEDURE DrillDown@1240030000(FieldNumber@1240030000 : Integer;ShowActualUsage@1240030005 : Boolean);
    VAR
      ItemUsageAdjustment@1240030001 : Record 14000558;
      ProcUnit@1240030002 : Record 14000555;
      UsageLedgerEntry@1240030003 : Record 14000556;
      UBP@1240030004 : Codeunit 14000564;
    BEGIN
      ProcUnit."Location Code" := "Location Code";
      ProcUnit."Item No." := "Item No.";
      ProcUnit."Variant Code" := "Variant Code";

      UsageLedgerEntry.SETCURRENTKEY(
        "Location Code","Item No.","Variant Code","Entry Type","Exclude from Usage",
        "Drop Shipment",Nonstock,"Usage Date","Transfer Out","Replenishment Path Transfer",
        "Source No.");
      IF ShowActualUsage THEN
        UsageLedgerEntry.SETFILTER("Location Code","Location Code")
      ELSE
        UsageLedgerEntry.SETFILTER(
          "Location Code",UBP.GetUsageLocationFilter(
            ProcUnit."Location Code",ProcUnit."Item No.",ProcUnit."Variant Code",ShowActualUsage));
      UsageLedgerEntry.SETRANGE("Item No.","Item No.");
      UsageLedgerEntry.SETRANGE("Variant Code","Variant Code");

      CASE FieldNumber OF
        FIELDNO("Usage Hits"):
          BEGIN
            UsageLedgerEntry.SETFILTER("Entry Type",'<>%1',UsageLedgerEntry."Entry Type"::Transfer);
            UsageLedgerEntry.SETFILTER("Usage Date",'%1..%2',"Starting Date","Ending Date");
            UsageLedgerEntry.SETRANGE("Exclude from Usage",FALSE);
            PAGE.RUNMODAL(0,UsageLedgerEntry);
          END;
        FIELDNO("Usage Quantity"):
          BEGIN
            UsageLedgerEntry.SETFILTER("Entry Type",'<>%1',UsageLedgerEntry."Entry Type"::Transfer);
            UsageLedgerEntry.SETFILTER("Usage Date",'%1..%2',"Starting Date","Ending Date");
            PAGE.RUNMODAL(0,UsageLedgerEntry);
          END;
        FIELDNO("Adjustment Quantity"):
          BEGIN
            ItemUsageAdjustment.SETFILTER(
              "Location Code",UBP.GetUsageLocationFilter(
                ProcUnit."Location Code",ProcUnit."Item No.",ProcUnit."Variant Code",FALSE));
            ItemUsageAdjustment.SETRANGE("Item No.","Item No.");
            ItemUsageAdjustment.SETRANGE("Variant Code","Variant Code");
            ItemUsageAdjustment.SETFILTER("Starting Date",'%1..%2',"Starting Date","Ending Date");
            PAGE.RUNMODAL(0,ItemUsageAdjustment);
          END;
        FIELDNO("Exclude Usage Quantity"):
          BEGIN
            UsageLedgerEntry.SETRANGE("Exclude from Usage",TRUE);
            UsageLedgerEntry.SETFILTER("Usage Date",'%1..%2',"Starting Date","Ending Date");
            UsageLedgerEntry.SETFILTER("Source No.","Source No. Filter");
            PAGE.RUNMODAL(0,UsageLedgerEntry);
          END;
        FIELDNO("Transfer Usage"):
          BEGIN
            UsageLedgerEntry.SETRANGE("Entry Type",UsageLedgerEntry."Entry Type"::Transfer);
            UsageLedgerEntry.SETFILTER("Usage Date",'%1..%2',"Starting Date","Ending Date");
            UsageLedgerEntry.SETRANGE("Transfer Out",TRUE);
            UsageLedgerEntry.SETRANGE("Replenishment Path Transfer",TRUE);
            UsageLedgerEntry.SETFILTER("Source No.","Source No. Filter");
            PAGE.RUNMODAL(0,UsageLedgerEntry);
          END;
        FIELDNO("Drop Ship Usage Quantity"):
          BEGIN
            UsageLedgerEntry.SETFILTER("Usage Date",'%1..%2',"Starting Date","Ending Date");
            UsageLedgerEntry.SETRANGE("Drop Shipment",TRUE);
            UsageLedgerEntry.SETRANGE("Exclude from Usage",FALSE);
            UsageLedgerEntry.SETFILTER("Source No.","Source No. Filter");
            PAGE.RUNMODAL(0,UsageLedgerEntry);
          END;
      END;
    END;

    PROCEDURE RemoveClonedUsage@1240030001();
    BEGIN
      InvMgtSetup.GET;
      UsageLedgerEntry.RESET;
      UsageLedgerEntry.SETCURRENTKEY("Item No.","Location Code","Variant Code");
      UsageLedgerEntry.SETRANGE("Item No.","Item No.");
      UsageLedgerEntry.SETRANGE("Location Code","Location Code");
      UsageLedgerEntry.SETRANGE("Variant Code","Variant Code");
      UsageLedgerEntry.SETRANGE("Cloned Usage",TRUE);
      IF UsageLedgerEntry.FIND('-') THEN BEGIN
        UsageLedgerEntry.DELETEALL;
        ProcUnit.GET("Location Code","Item No.","Variant Code");
        ProcUnit."Change Reforecast Required" := TRUE;
        IF InvMgtSetup."Roll Up Via Repl. Path" THEN
          ProcUnit."Reforecast Item" := TRUE;
        ProcUnit.MODIFY;
      END;
    END;

    BEGIN
    END.
  }
}

