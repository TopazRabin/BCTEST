OBJECT Table 14002377 E.D.I. Send Doc. Hdr. Archive
{
  OBJECT-PROPERTIES
  {
    Date=02/25/19;
    Time=12:00:00 PM;
    Version List=SE0.61;
  }
  PROPERTIES
  {
    OnDelete=BEGIN
               SendDocumentFldArchive.RESET;
               SendDocumentFldArchive.SETRANGE("No.","No.");
               SendDocumentFldArchive.DELETEALL;
             END;

    CaptionML=ENU=E.D.I. Send Doc. Hdr. Archive;
    LookupPageID=Page14002393;
    DrillDownPageID=Page14002393;
  }
  FIELDS
  {
    { 1   ;   ;Internal Doc No.    ;Code10        ;CaptionML=ENU=Internal Doc No.;
                                                   Editable=No }
    { 2   ;   ;Navision Document   ;Code10        ;TableRelation="E.D.I. Navision Available Doc.".Document;
                                                   CaptionML=ENU=Navision Document;
                                                   Editable=No }
    { 3   ;   ;Document No.        ;Code20        ;OnLookup=VAR
                                                              SalesHeader@1240020014 : Record 36;
                                                              PurchaseHeader@1240020013 : Record 38;
                                                              SalesInvoiceHeader@1240020012 : Record 112;
                                                              SalesShipmentHeader@1240020011 : Record 110;
                                                              OrderStatusHeader@1240020010 : Record 14002400;
                                                              InventoryAdviceHeader@1240020009 : Record 14002413;
                                                              BillOfLading@1240020008 : Record 14000822;
                                                              TransferHeader@1240020007 : Record 5740;
                                                              TransferShipmentHdr@1240020006 : Record 5744;
                                                              RoutingRequestHeader@1240020005 : Record 14002402;
                                                              EDIPurchasePaymentAdvice@1240020004 : Record 14050801;
                                                              ReturnShipmentHeader@1240020003 : Record 6650;
                                                              ReturnReceiptHeader@1240020002 : Record 6660;
                                                              SalesCrMemoHeader@1240020001 : Record 114;
                                                              EDIReceiveDocumentHdr@1240020000 : Record 14002358;
                                                            BEGIN
                                                              EDISetup.GET;

                                                              CASE "Navision Document" OF
                                                                'E_SLSWSA','E_SLSPOA':
                                                                  BEGIN
                                                                    SalesHeader.RESET;
                                                                    SalesHeader.SETRANGE("Document Type",SalesHeader."Document Type"::Order);
                                                                    SalesHeader.SETRANGE("No.","Document No.");
                                                                    IF SalesHeader.FIND('-') THEN
                                                                      SalesHeader.SETRANGE("No.")
                                                                    ELSE
                                                                      SalesHeader.SETRANGE("No.");
                                                                    IF EDISetup.ListView THEN
                                                                      PAGE.RUN(PAGE::"Sales List",SalesHeader,SalesHeader."No.")
                                                                    ELSE
                                                                      PAGE.RUN(PAGE::"Sales Order",SalesHeader);
                                                                  END;
                                                                'E_SLSINV':
                                                                  BEGIN
                                                                    SalesInvoiceHeader.RESET;
                                                                    SalesInvoiceHeader.SETRANGE("No.","Document No.");
                                                                    IF SalesInvoiceHeader.FIND('-') THEN
                                                                      SalesInvoiceHeader.SETRANGE("No.")
                                                                    ELSE
                                                                      SalesInvoiceHeader.SETRANGE("No.");
                                                                    IF EDISetup.ListView THEN
                                                                      PAGE.RUN(PAGE::"Posted Sales Invoices",SalesInvoiceHeader,SalesInvoiceHeader."No.")
                                                                    ELSE
                                                                      PAGE.RUN(PAGE::"Posted Sales Invoice",SalesInvoiceHeader);
                                                                  END;
                                                                'E_FUNCTACK':
                                                                  BEGIN
                                                                    EDIReceiveDocumentHdr.RESET;
                                                                    EDIReceiveDocumentHdr.SETRANGE("Internal Doc. No.","Internal Doc No.");
                                                                    EDIReceiveDocumentHdr.SETRANGE("Group Control No.","Document No.");
                                                                    IF EDIReceiveDocumentHdr.FIND('-') THEN BEGIN
                                                                      EDIReceiveDocumentHdr.SETRANGE("Internal Doc. No.");
                                                                      EDIReceiveDocumentHdr.SETRANGE("Group Control No.");
                                                                    END ELSE BEGIN
                                                                      EDIReceiveDocumentHdr.SETRANGE("Internal Doc. No.");
                                                                      EDIReceiveDocumentHdr.SETRANGE("Group Control No.");
                                                                    END;
                                                                    IF EDISetup.ListView THEN
                                                                      PAGE.RUN(
                                                                        PAGE::"E.D.I. Receive Document List",
                                                                        EDIReceiveDocumentHdr,EDIReceiveDocumentHdr."Internal Doc. No.")
                                                                    ELSE
                                                                      PAGE.RUN(PAGE::"E.D.I. Receive Document",EDIReceiveDocumentHdr);
                                                                  END;
                                                                'E_PURORD','E_PURWSA':
                                                                  BEGIN
                                                                    PurchaseHeader.RESET;
                                                                    PurchaseHeader.SETRANGE("Document Type",PurchaseHeader."Document Type"::Order);
                                                                    PurchaseHeader.SETRANGE("No.","Document No.");
                                                                    IF PurchaseHeader.FIND('-') THEN
                                                                      PurchaseHeader.SETRANGE("No.")
                                                                    ELSE
                                                                      PurchaseHeader.SETRANGE("No.");
                                                                    IF EDISetup.ListView THEN
                                                                      PAGE.RUN(PAGE::"Purchase List",PurchaseHeader,PurchaseHeader."No.")
                                                                    ELSE
                                                                      PAGE.RUN(PAGE::"Purchase Order",PurchaseHeader);
                                                                  END;
                                                                'E_SLSASN','E_SLSBSN','E_EMCBOL':
                                                                  BEGIN
                                                                    BillOfLading.RESET;
                                                                    BillOfLading.SETRANGE("No.","Document No.");
                                                                    IF BillOfLading.FIND('-') THEN
                                                                      BillOfLading.SETRANGE("No.")
                                                                    ELSE
                                                                      BillOfLading.SETRANGE("No.");
                                                                    IF EDISetup.ListView THEN BEGIN
                                                                      IF BillOfLading.Posted THEN
                                                                        PAGE.RUN(PAGE::"Posted Bill of Ladings",BillOfLading,BillOfLading."No.")
                                                                      ELSE
                                                                        PAGE.RUN(PAGE::"Bill of Ladings",BillOfLading,BillOfLading."No.");
                                                                    END ELSE BEGIN
                                                                      IF BillOfLading.Posted THEN
                                                                        PAGE.RUN(PAGE::"Posted Bill of Lading",BillOfLading)
                                                                      ELSE
                                                                        PAGE.RUN(PAGE::"Bill of Lading",BillOfLading);
                                                                    END;
                                                                  END;
                                                                'E_SHPADV','E_WHSESHP':
                                                                  BEGIN
                                                                    SalesShipmentHeader.RESET;
                                                                    SalesShipmentHeader.SETRANGE("No.","Document No.");
                                                                    IF SalesShipmentHeader.FIND('-') THEN
                                                                      SalesShipmentHeader.SETRANGE("No.")
                                                                    ELSE
                                                                      SalesShipmentHeader.SETRANGE("No.");
                                                                    IF EDISetup.ListView THEN
                                                                      PAGE.RUN(PAGE::"Posted Sales Shipments",SalesShipmentHeader,SalesShipmentHeader."No.")
                                                                    ELSE
                                                                      PAGE.RUN(PAGE::"Posted Sales Shipment",SalesShipmentHeader);
                                                                  END;
                                                                'E_ROUTEREQ':
                                                                  BEGIN
                                                                    RoutingRequestHeader.RESET;
                                                                    RoutingRequestHeader.SETRANGE("No.","Document No.");
                                                                    IF RoutingRequestHeader.FIND('-') THEN
                                                                      RoutingRequestHeader.SETRANGE("No.")
                                                                    ELSE
                                                                      RoutingRequestHeader.SETRANGE("No.");
                                                                    IF EDISetup.ListView THEN
                                                                      PAGE.RUN(PAGE::"Routing Request List",RoutingRequestHeader,RoutingRequestHeader."No.")
                                                                    ELSE
                                                                      PAGE.RUN(PAGE::"Routing Request",RoutingRequestHeader);
                                                                  END;
                                                                'E_SLSSTA','E_ADVPOA','E_SLSPOC':
                                                                  BEGIN
                                                                    OrderStatusHeader.RESET;
                                                                    OrderStatusHeader.SETRANGE("Internal Doc. No.","Internal Doc No.");
                                                                    IF "Navision Document" = 'E_SLSSTA' THEN BEGIN
                                                                      OrderStatusHeader.SETRANGE("Document Type",OrderStatusHeader."Document Type"::" ");
                                                                      IF EDISetup.ListView THEN
                                                                        PAGE.RUN(PAGE::"Order Status List",OrderStatusHeader)
                                                                      ELSE
                                                                        PAGE.RUN(PAGE::"Order Status",OrderStatusHeader);
                                                                    END;
                                                                    IF "Navision Document" = 'E_ADVPOA' THEN BEGIN
                                                                      OrderStatusHeader.SETRANGE(
                                                                        "Document Type",OrderStatusHeader."Document Type"::"Advance P.O. Ack.");
                                                                      IF EDISetup.ListView THEN
                                                                        PAGE.RUN(PAGE::"E.D.I. Advance P.O. Ack. List",OrderStatusHeader)
                                                                      ELSE
                                                                        PAGE.RUN(PAGE::"E.D.I. Advance P.O. Ack.",OrderStatusHeader);
                                                                    END;
                                                                    IF "Navision Document" = 'E_SLSPOC' THEN BEGIN
                                                                      OrderStatusHeader.SETRANGE(
                                                                        "Document Type",OrderStatusHeader."Document Type"::"Advance P.O. Ack.");
                                                                      IF EDISetup.ListView THEN
                                                                        PAGE.RUN(PAGE::"E.D.I. Order Change Stat. List",OrderStatusHeader)
                                                                      ELSE
                                                                        PAGE.RUN(PAGE::"E.D.I. Order Change Status",OrderStatusHeader);
                                                                    END;
                                                                  END;
                                                                'E_SLSCRM':
                                                                  BEGIN
                                                                    SalesCrMemoHeader.RESET;
                                                                    SalesCrMemoHeader.SETRANGE("No.","Document No.");
                                                                    IF SalesCrMemoHeader.FIND('-') THEN
                                                                      SalesCrMemoHeader.SETRANGE("No.")
                                                                    ELSE
                                                                      SalesCrMemoHeader.SETRANGE("No.");
                                                                    IF EDISetup.ListView THEN
                                                                      PAGE.RUN(PAGE::"Posted Sales Credit Memos",SalesCrMemoHeader,SalesCrMemoHeader."No.")
                                                                    ELSE
                                                                      PAGE.RUN(PAGE::"Posted Sales Credit Memo",SalesCrMemoHeader);
                                                                  END;
                                                                'E_TFRORD':
                                                                  BEGIN
                                                                    TransferHeader.RESET;
                                                                    TransferHeader.SETRANGE("No.","Document No.");
                                                                    IF TransferHeader.FIND('-') THEN
                                                                      TransferHeader.SETRANGE("No.")
                                                                    ELSE
                                                                      TransferHeader.SETRANGE("No.");
                                                                    IF EDISetup.ListView THEN
                                                                      PAGE.RUN(PAGE::"Transfer Orders",TransferHeader,TransferHeader."No.")
                                                                    ELSE
                                                                      PAGE.RUN(PAGE::"Transfer Order",TransferHeader);
                                                                  END;
                                                                'E_SLSRMA':
                                                                  BEGIN
                                                                    ReturnReceiptHeader.RESET;
                                                                    ReturnReceiptHeader.SETRANGE("No.","Document No.");
                                                                    IF ReturnReceiptHeader.FIND('-') THEN
                                                                      ReturnReceiptHeader.SETRANGE("No.")
                                                                    ELSE
                                                                      ReturnReceiptHeader.SETRANGE("No.");
                                                                    IF EDISetup.ListView THEN
                                                                      PAGE.RUN(PAGE::"Posted Return Receipts",ReturnReceiptHeader,ReturnReceiptHeader."No.")
                                                                    ELSE
                                                                      PAGE.RUN(PAGE::"Posted Return Receipt",ReturnReceiptHeader);
                                                                  END;
                                                                'E_PURRMA':
                                                                  BEGIN
                                                                    ReturnShipmentHeader.RESET;
                                                                    ReturnShipmentHeader.SETRANGE("No.","Document No.");
                                                                    IF ReturnShipmentHeader.FIND('-') THEN
                                                                      ReturnShipmentHeader.SETRANGE("No.")
                                                                    ELSE
                                                                      ReturnShipmentHeader.SETRANGE("No.");
                                                                    IF EDISetup.ListView THEN
                                                                      PAGE.RUN(PAGE::"Posted Return Shipments",ReturnShipmentHeader,ReturnShipmentHeader."No.")
                                                                    ELSE
                                                                      PAGE.RUN(PAGE::"Posted Return Shipment",ReturnShipmentHeader);
                                                                  END;
                                                                'E_PURPRA':
                                                                  BEGIN
                                                                    EDIPurchasePaymentAdvice.RESET;
                                                                    EDIPurchasePaymentAdvice.SETRANGE("No.","Document No.");
                                                                    IF EDIPurchasePaymentAdvice.FIND('-') THEN
                                                                      EDIPurchasePaymentAdvice.SETRANGE("No.")
                                                                    ELSE
                                                                      EDIPurchasePaymentAdvice.SETRANGE("No.");
                                                                    IF EDISetup.ListView THEN BEGIN
                                                                      IF EDIPurchasePaymentAdvice.Posted THEN
                                                                        PAGE.RUN(
                                                                          PAGE::"E.D.I. Posted Purch. Pmt. List",
                                                                            EDIPurchasePaymentAdvice,EDIPurchasePaymentAdvice."No.")
                                                                        ELSE
                                                                          PAGE.RUN(
                                                                            PAGE::"E.D.I. Purch. Payment Advices",
                                                                              EDIPurchasePaymentAdvice,EDIPurchasePaymentAdvice."No.");
                                                                    END ELSE BEGIN
                                                                      IF EDIPurchasePaymentAdvice.Posted THEN
                                                                        PAGE.RUN(PAGE::"E.D.I. Posted PurchPmtAdvice",EDIPurchasePaymentAdvice)
                                                                      ELSE
                                                                        PAGE.RUN(PAGE::"E.D.I. Purchase Payment Advice",EDIPurchasePaymentAdvice);
                                                                    END;
                                                                  END;
                                                                'E_TFRSHP':
                                                                  BEGIN
                                                                    TransferShipmentHdr.RESET;
                                                                    TransferShipmentHdr.SETRANGE("No.","Document No.");
                                                                    IF TransferShipmentHdr.FIND('-') THEN
                                                                      TransferShipmentHdr.SETRANGE("No.")
                                                                    ELSE
                                                                      TransferShipmentHdr.SETRANGE("No.");
                                                                    IF EDISetup.ListView THEN
                                                                      PAGE.RUN(PAGE::"Posted Transfer Shipments",TransferShipmentHdr,TransferShipmentHdr."No.")
                                                                    ELSE
                                                                      PAGE.RUN(PAGE::"Posted Transfer Shipment",TransferShipmentHdr);
                                                                  END;
                                                                'E_INVADV':
                                                                  BEGIN
                                                                    InventoryAdviceHeader.RESET;
                                                                    InventoryAdviceHeader.SETRANGE("No.","Document No.");
                                                                    InventoryAdviceHeader.SETRANGE(Type,InventoryAdviceHeader.Type::"  ");
                                                                    IF InventoryAdviceHeader.FIND('-') THEN
                                                                      InventoryAdviceHeader.SETRANGE("No.")
                                                                    ELSE
                                                                      InventoryAdviceHeader.SETRANGE("No.");
                                                                    IF EDISetup.ListView THEN BEGIN
                                                                      IF InventoryAdviceHeader.Posted THEN
                                                                        PAGE.RUN(
                                                                          PAGE::"E.D.I. Posted Invt Advice List",
                                                                            InventoryAdviceHeader,InventoryAdviceHeader."No.")
                                                                      ELSE
                                                                        PAGE.RUN(
                                                                          PAGE::"E.D.I. Inventory Advice List",
                                                                            InventoryAdviceHeader,InventoryAdviceHeader."No.");
                                                                    END ELSE BEGIN
                                                                      IF InventoryAdviceHeader.Posted THEN
                                                                        PAGE.RUN(PAGE::"E.D.I. Posted Inventory Advice",InventoryAdviceHeader)
                                                                      ELSE
                                                                       PAGE.RUN(PAGE::"E.D.I. Inventory Advice",InventoryAdviceHeader);
                                                                    END;
                                                                  END;
                                                                'E_PRICAT':
                                                                  BEGIN
                                                                    InventoryAdviceHeader.RESET;
                                                                    InventoryAdviceHeader.SETRANGE("No.","Document No.");
                                                                    InventoryAdviceHeader.SETRANGE(Type,InventoryAdviceHeader.Type::"Price Catalog");
                                                                    IF InventoryAdviceHeader.FIND('-') THEN
                                                                      InventoryAdviceHeader.SETRANGE("No.")
                                                                    ELSE
                                                                      InventoryAdviceHeader.SETRANGE("No.");
                                                                    IF EDISetup.ListView THEN BEGIN
                                                                      IF InventoryAdviceHeader.Posted THEN
                                                                        PAGE.RUN(
                                                                          PAGE::"E.D.I. PostedPriceCatalog List",InventoryAdviceHeader,InventoryAdviceHeader."No.")
                                                                      ELSE
                                                                        PAGE.RUN(
                                                                          PAGE::"E.D.I. Price Catalog List",InventoryAdviceHeader,InventoryAdviceHeader."No.")
                                                                    END ELSE BEGIN
                                                                      IF InventoryAdviceHeader.Posted THEN
                                                                        PAGE.RUN(PAGE::"E.D.I. Posted Price Catalog",InventoryAdviceHeader)
                                                                      ELSE
                                                                        PAGE.RUN(PAGE::"E.D.I. Price Catalog",InventoryAdviceHeader);
                                                                    END;
                                                                  END;
                                                              END;
                                                            END;

                                                   CaptionML=ENU=Document No.;
                                                   Editable=No }
    { 4   ;   ;Version             ;Integer       ;CaptionML=ENU=Version;
                                                   Editable=No }
    { 5   ;   ;No.                 ;Code10        ;CaptionML=ENU=No. }
    { 11  ;   ;Trade Partner No.   ;Code20        ;TableRelation="E.D.I. Trade Partner".No.;
                                                   CaptionML=ENU=Trade Partner No.;
                                                   Editable=No }
    { 12  ;   ;EDI Document No.    ;Code30        ;CaptionML=ENU=EDI Document No.;
                                                   Editable=No }
    { 13  ;   ;EDI Version         ;Code12        ;CaptionML=ENU=EDI Version;
                                                   Editable=No }
    { 14  ;   ;EDI Template Name   ;Code10        ;TableRelation="E.D.I. Template";
                                                   CaptionML=ENU=EDI Template Name;
                                                   Editable=No }
    { 15  ;   ;Interchange Control No.;Text30     ;CaptionML=ENU=Interchange Control No.;
                                                   Editable=No }
    { 16  ;   ;Group Control No.   ;Text30        ;CaptionML=ENU=Group Control No.;
                                                   Editable=No }
    { 17  ;   ;Transaction Set Control No.;Text30 ;CaptionML=ENU=Transaction Set Control No.;
                                                   Editable=No }
    { 18  ;   ;EDI Trade Partner Name;Text40      ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("E.D.I. Trade Partner".Name WHERE (No.=FIELD(Trade Partner No.)));
                                                   CaptionML=ENU=EDI Trade Partner Name;
                                                   Editable=No }
    { 19  ;   ;Funct. Ack. Required;Boolean       ;CaptionML=ENU=Funct. Ack. Required;
                                                   Editable=No }
    { 20  ;   ;Funct. Group Ack. Status;Option    ;CaptionML=ENU=Funct. Group Ack. Status;
                                                   OptionCaptionML=ENU=" ,Accepted,Accepted Errors,Part Accepted,Rejected";
                                                   OptionString=[ ,Accepted,Accepted Errors,Part Accepted,Rejected];
                                                   Editable=No }
    { 21  ;   ;Tran. Set Funct. Ack. Status;Option;CaptionML=ENU=Tran. Set Funct. Ack. Status;
                                                   OptionCaptionML=ENU=" ,Accepted,Accepted Errors,Part Accepted,Rejected";
                                                   OptionString=[ ,Accepted,Accepted Errors,Part Accepted,Rejected];
                                                   Editable=No }
    { 22  ;   ;Data Error          ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist("E.D.I. Send Document Field" WHERE (No.=FIELD(Navision Document),
                                                                                                         Version=FIELD(Version),
                                                                                                         Data Error=CONST(Yes)));
                                                   CaptionML=ENU=Data Error;
                                                   Editable=No }
    { 23  ;   ;Created Date        ;Date          ;CaptionML=ENU=Created Date;
                                                   Editable=No }
    { 24  ;   ;Created Time        ;Time          ;CaptionML=ENU=Created Time;
                                                   Editable=No }
    { 25  ;   ;Sent Date           ;Date          ;CaptionML=ENU=Sent Date;
                                                   Editable=No }
    { 26  ;   ;Sent Time           ;Time          ;CaptionML=ENU=Sent Time;
                                                   Editable=No }
    { 27  ;   ;Document Sent       ;Boolean       ;CaptionML=ENU=Document Sent }
    { 28  ;   ;Funct. Ack. Internal Doc. No.;Code10;
                                                   CaptionML=ENU=Funct. Ack. Internal Doc. No. }
    { 29  ;   ;Archive Version No. ;Integer       ;CaptionML=ENU=Archive Version No.;
                                                   Editable=No }
    { 30  ;   ;Time Archived       ;Time          ;CaptionML=ENU=Time Archived;
                                                   Editable=No }
    { 31  ;   ;Date Archived       ;Date          ;CaptionML=ENU=Date Archived;
                                                   Editable=No }
    { 32  ;   ;Archived By         ;Code50        ;CaptionML=ENU=Archived By;
                                                   Editable=No }
    { 33  ;   ;Interface File Name ;Text250       ;CaptionML=ENU=Interface File Name;
                                                   Editable=No }
    { 34  ;   ;File Name           ;Text250       ;CaptionML=ENU=File Name;
                                                   Editable=No }
    { 35  ;   ;Outbox Archive Directory;Text250   ;CaptionML=ENU=Outbox Archive Directory;
                                                   Editable=No }
    { 36  ;   ;External Document No.;Code50       ;CaptionML=ENU=External Document No. }
    { 300 ;   ;XML Document        ;Boolean       ;CaptionML=ENU=XML Document }
    { 301 ;   ;cXML Payload ID     ;Text100       ;CaptionML=ENU=cXML Payload ID;
                                                   Editable=No }
    { 302 ;   ;Response Code       ;Code10        ;CaptionML=ENU=Response Code;
                                                   Editable=No }
    { 303 ;   ;Response Status     ;Option        ;CaptionML=ENU=Response Status;
                                                   OptionCaptionML=ENU=" ,Accepted,Accepted Errors,Part Accepted,Rejected";
                                                   OptionString=[ ,Accepted,Accepted Errors,Part Accepted,Rejected];
                                                   Editable=No }
    { 304 ;   ;Response Description;Text50        ;CaptionML=ENU=Response Description;
                                                   Editable=No }
    { 305 ;   ;Response ID         ;Text100       ;CaptionML=ENU=Response ID;
                                                   Editable=No }
    { 306 ;   ;Response DTD URL    ;Text100       ;CaptionML=ENU=Response DTD URL }
    { 307 ;   ;cXML Response Payload ID;Text100   ;CaptionML=ENU=cXML Response Payload ID }
    { 308 ;   ;Reference ID        ;Text30        ;CaptionML=ENU=Reference ID }
    { 309 ;   ;Reference Type      ;Text20        ;CaptionML=ENU=Reference Type }
    { 310 ;   ;Export Control No.  ;Code30        ;CaptionML=ENU=Export Control No. }
    { 50000;  ;Shortcut Dimension 5 Code;Code20   ;TableRelation="Dimension Value".Code WHERE (Dimension Value ID=FILTER(3208..3211));
                                                   OnValidate=VAR
                                                                DimVal@1000000001 : Record 349;
                                                                SLines@1000000000 : Record 37;
                                                              BEGIN
                                                              END;

                                                   CaptionML=[ENU=Shortcut Dimension 5 Code;
                                                              ESM=Cï¿½d. dim. acceso dir. 2;
                                                              FRC=Code raccourci de dimension 2;
                                                              ENC=Shortcut Dimension 2 Code];
                                                   Description=TPZEDI;
                                                   CaptionClass='1,2,5' }
  }
  KEYS
  {
    {    ;No.                                     ;Clustered=Yes }
    {    ;Internal Doc No.,Navision Document,Document No.,Version }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      SalesInvoiceHdr@1240030000 : Record 112;
      SendDocumentFldArchive@1240030001 : Record 14002378;
      EDISetup@1240020001 : Record 14002367;
      EDITemplate@1240020003 : Record 14002350;
      EDISetupRetrieved@1240020000 : Boolean;
      Text001@1240020002 : TextConst 'ENU=File path not found.';

    PROCEDURE GetEDISetup@1240030006();
    BEGIN
      IF NOT EDISetupRetrieved THEN BEGIN
        EDISetup.GET;
        EDISetupRetrieved := TRUE;
      END;
    END;

    PROCEDURE ViewTextEDIDocument@1240030001();
    VAR
      EDIDocument@1240020001 : Record 14002353;
      FileName@1240020003 : Text[250];
      BeginPos@1240020002 : Integer;
      ToFolder@1240020005 : Text[250];
      ToFilter@1240020004 : Text[250];
      ToFile@1240020000 : Text[250];
    BEGIN
      ToFolder := 'C:\';
      ToFilter := 'Text file(*.txt)|*.edi';
      FileName := '';
      IF "Outbox Archive Directory" = '' THEN BEGIN
        EDITemplate.GET("EDI Template Name");
        EDIDocument.SETRANGE("Trade Partner No.","Trade Partner No.");
        EDIDocument.SETFILTER(
          Status,'%1|%2',EDIDocument.Status::Test,EDIDocument.Status::Production);
        EDIDocument.SETRANGE(Type,EDIDocument.Type::Export);
        EDIDocument.SETRANGE("Navision Document","Navision Document");
        EDIDocument.SETRANGE("EDI Document No.","EDI Document No.");
        IF EDIDocument.FIND('-') THEN BEGIN
          BeginPos := STRPOS("Interface File Name",EDIDocument."Interface File");
          IF BeginPos <> 0 THEN
            FileName :=
              EDITemplate."Outbox Archive Directory" + '\' + COPYSTR("Interface File Name",BeginPos);
          IF "File Name" = '' THEN BEGIN
            ToFile := FileName;
            DOWNLOAD(FileName,'Open file',ToFolder,ToFilter,ToFile);
          END ELSE BEGIN
            FileName := EDITemplate."Outbox Archive Directory" + '\' + "File Name";
            ToFile := FileName;
            DOWNLOAD(FileName,'Open file',ToFolder,ToFilter,ToFile);
          END;
        END ELSE
          ERROR(Text001);
      END ELSE BEGIN
        FileName := EDITemplate."Outbox Archive Directory" + '\' + "File Name";
        ToFile := FileName;
        DOWNLOAD(FileName,'Open file',ToFolder,ToFilter,ToFile);
      END;
    END;

    BEGIN
    END.
  }
}

