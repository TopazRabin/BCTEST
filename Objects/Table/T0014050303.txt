OBJECT Table 14050303 E.D.I. Outbound Log
{
  OBJECT-PROPERTIES
  {
    Date=07/07/17;
    Time=12:00:00 PM;
    Version List=SE0.60.14;
  }
  PROPERTIES
  {
    CaptionML=ENU=E.D.I. Outbound Log;
    DrillDownPageID=Page14050338;
  }
  FIELDS
  {
    { 1   ;   ;Entry No.           ;Integer       ;CaptionML=ENU=Entry No. }
    { 2   ;   ;Error               ;Boolean       ;CaptionML=ENU=Error }
    { 3   ;   ;Date                ;Date          ;CaptionML=ENU=Date;
                                                   Editable=No }
    { 4   ;   ;Trade Partner       ;Code20        ;TableRelation="E.D.I. Trade Partner";
                                                   CaptionML=ENU=Trade Partner;
                                                   Editable=No }
    { 11  ;   ;Error Text Message  ;Text250       ;CaptionML=ENU=Error Text Message;
                                                   Editable=No }
    { 12  ;   ;Process             ;Text250       ;CaptionML=ENU=Process;
                                                   Editable=No }
    { 13  ;   ;Start Time          ;Time          ;CaptionML=ENU=Start Time;
                                                   Editable=No }
    { 14  ;   ;End Time            ;Time          ;CaptionML=ENU=End Time;
                                                   Editable=No }
    { 15  ;   ;UserID              ;Code60        ;CaptionML=ENU=UserID;
                                                   Editable=No }
    { 18  ;   ;Document Type       ;Code40        ;CaptionML=ENU=Document Type;
                                                   Editable=No }
    { 19  ;   ;Document No.        ;Code20        ;OnLookup=VAR
                                                              SalesHeader@1240020014 : Record 36;
                                                              PurchaseHeader@1240020013 : Record 38;
                                                              SalesInvoiceHeader@1240020012 : Record 112;
                                                              SalesShipmentHeader@1240020011 : Record 110;
                                                              OrderStatusHeader@1240020010 : Record 14002400;
                                                              InventoryAdviceHeader@1240020009 : Record 14002413;
                                                              BillOfLading@1240020008 : Record 14000822;
                                                              TransferHeader@1240020007 : Record 5740;
                                                              TransferShipmentHdr@1240020006 : Record 5744;
                                                              RoutingRequestHeader@1240020005 : Record 14002402;
                                                              EDIPurchasePaymentAdvice@1240020004 : Record 14050801;
                                                              ReturnShipmentHeader@1240020003 : Record 6650;
                                                              ReturnReceiptHeader@1240020002 : Record 6660;
                                                              SalesCrMemoHeader@1240020001 : Record 114;
                                                            BEGIN
                                                              EDISetup.GET;

                                                              IF "Document Type" = 'SEND DOCUMENT' THEN
                                                                EXIT;

                                                              CASE "Navision Document" OF
                                                                'E_SLSWSA','E_SLSPOA':
                                                                  BEGIN
                                                                    SalesHeader.RESET;
                                                                    SalesHeader.SETRANGE("Document Type",SalesHeader."Document Type"::Order);
                                                                    SalesHeader.SETRANGE("No.","Document No.");
                                                                    IF EDISetup.ListView THEN
                                                                      PAGE.RUN(PAGE::"Sales Order List",SalesHeader)
                                                                    ELSE
                                                                      PAGE.RUN(PAGE::"Sales Order",SalesHeader);
                                                                  END;
                                                                'E_SLSINV':
                                                                  BEGIN
                                                                    SalesInvoiceHeader.RESET;
                                                                    SalesInvoiceHeader.SETRANGE("No.","Document No.");
                                                                    IF EDISetup.ListView THEN
                                                                      PAGE.RUN(PAGE::"Posted Sales Invoices",SalesInvoiceHeader)
                                                                    ELSE
                                                                      PAGE.RUN(PAGE::"Posted Sales Invoice",SalesInvoiceHeader);
                                                                  END;
                                                                'E_PURORD','E_PURWSA':
                                                                  BEGIN
                                                                    PurchaseHeader.RESET;
                                                                    PurchaseHeader.SETRANGE("Document Type",PurchaseHeader."Document Type"::Order);
                                                                    PurchaseHeader.SETRANGE("No.","Document No.");
                                                                    IF EDISetup.ListView THEN
                                                                      PAGE.RUN(PAGE::"Purchase Order List",PurchaseHeader)
                                                                    ELSE
                                                                      PAGE.RUN(PAGE::"Purchase Order",PurchaseHeader);
                                                                  END;
                                                                'E_SLSASN','E_SLSBSN','E_EMCBOL':
                                                                  BEGIN
                                                                    BillOfLading.RESET;
                                                                    BillOfLading.SETRANGE("No.","Document No.");
                                                                    IF EDISetup.ListView THEN
                                                                      PAGE.RUN(PAGE::"Bill of Ladings",BillOfLading)
                                                                    ELSE
                                                                      PAGE.RUN(PAGE::"Bill of Lading",BillOfLading);
                                                                  END;
                                                                'E_SHPADV','E_WHSESHP':
                                                                  BEGIN
                                                                    SalesShipmentHeader.RESET;
                                                                    SalesShipmentHeader.SETRANGE("No.","Document No.");
                                                                    IF EDISetup.ListView THEN
                                                                      PAGE.RUN(PAGE::"Posted Sales Shipments",SalesShipmentHeader)
                                                                    ELSE
                                                                      PAGE.RUN(PAGE::"Posted Sales Shipment",SalesShipmentHeader);
                                                                  END;
                                                                'E_ROUTEREQ':
                                                                  BEGIN
                                                                    RoutingRequestHeader.RESET;
                                                                    RoutingRequestHeader.SETRANGE("No.","Document No.");
                                                                    IF EDISetup.ListView THEN
                                                                      PAGE.RUN(PAGE::"Routing Request List",RoutingRequestHeader)
                                                                    ELSE
                                                                      PAGE.RUN(PAGE::"Routing Request",RoutingRequestHeader);
                                                                  END;
                                                                'E_SLSSTA','E_ADVPOA','E_SLSPOC':
                                                                  BEGIN
                                                                    OrderStatusHeader.RESET;
                                                                    OrderStatusHeader.SETRANGE("Internal Doc. No.","Document No.");
                                                                    IF "Navision Document" = 'E_SLSSTA' THEN BEGIN
                                                                      OrderStatusHeader.SETRANGE("Document Type",OrderStatusHeader."Document Type"::" ");
                                                                      IF EDISetup.ListView THEN
                                                                        PAGE.RUN(PAGE::"Order Status List",OrderStatusHeader)
                                                                      ELSE
                                                                        PAGE.RUN(PAGE::"Order Status",OrderStatusHeader);
                                                                    END;
                                                                    IF "Navision Document" = 'E_ADVPOA' THEN BEGIN
                                                                      OrderStatusHeader.SETRANGE(
                                                                        "Document Type",OrderStatusHeader."Document Type"::"Advance P.O. Ack.");
                                                                      IF EDISetup.ListView THEN
                                                                        PAGE.RUN(PAGE::"E.D.I. Advance P.O. Ack. List",OrderStatusHeader)
                                                                      ELSE
                                                                        PAGE.RUN(PAGE::"E.D.I. Advance P.O. Ack.",OrderStatusHeader);
                                                                    END;
                                                                    IF "Navision Document" = 'E_SLSPOC' THEN BEGIN
                                                                      OrderStatusHeader.SETRANGE(
                                                                        "Document Type",OrderStatusHeader."Document Type"::"Advance P.O. Ack.");
                                                                      IF EDISetup.ListView THEN
                                                                        PAGE.RUN(PAGE::"E.D.I. Order Change Stat. List",OrderStatusHeader)
                                                                      ELSE
                                                                        PAGE.RUN(PAGE::"E.D.I. Order Change Status",OrderStatusHeader);
                                                                    END;
                                                                  END;
                                                                'E_SLSCRM':
                                                                  BEGIN
                                                                    SalesCrMemoHeader.RESET;
                                                                    SalesCrMemoHeader.SETRANGE("No.","Document No.");
                                                                    IF EDISetup.ListView THEN
                                                                      PAGE.RUN(PAGE::"Posted Sales Credit Memos",SalesCrMemoHeader)
                                                                    ELSE
                                                                      PAGE.RUN(PAGE::"Posted Sales Credit Memo",SalesCrMemoHeader);
                                                                  END;
                                                                'E_TFRORD':
                                                                  BEGIN
                                                                    TransferHeader.RESET;
                                                                    TransferHeader.SETRANGE("No.","Document No.");
                                                                    IF EDISetup.ListView THEN
                                                                      PAGE.RUN(PAGE::"Transfer Orders",TransferHeader)
                                                                    ELSE
                                                                      PAGE.RUN(PAGE::"Transfer Order",TransferHeader);
                                                                  END;
                                                                'E_SLSRMA':
                                                                  BEGIN
                                                                    ReturnReceiptHeader.RESET;
                                                                    ReturnReceiptHeader.SETRANGE("No.","Document No.");
                                                                    IF EDISetup.ListView THEN
                                                                      PAGE.RUN(PAGE::"Posted Return Receipts",ReturnReceiptHeader)
                                                                    ELSE
                                                                      PAGE.RUN(PAGE::"Posted Return Receipt",ReturnReceiptHeader);
                                                                  END;
                                                                'E_PURRMA':
                                                                  BEGIN
                                                                    ReturnShipmentHeader.RESET;
                                                                    ReturnShipmentHeader.SETRANGE("No.","Document No.");
                                                                    IF EDISetup.ListView THEN
                                                                      PAGE.RUN(PAGE::"Posted Return Shipments",ReturnShipmentHeader)
                                                                    ELSE
                                                                      PAGE.RUN(PAGE::"Posted Return Shipment",ReturnShipmentHeader);
                                                                  END;
                                                                'E_PURPRA':
                                                                  BEGIN
                                                                    EDIPurchasePaymentAdvice.RESET;
                                                                    EDIPurchasePaymentAdvice.SETRANGE("No.","Document No.");
                                                                    IF EDIPurchasePaymentAdvice.FIND('-') THEN
                                                                      EDIPurchasePaymentAdvice.SETRANGE("No.")
                                                                    ELSE
                                                                      EDIPurchasePaymentAdvice.SETRANGE("No.");
                                                                    IF EDISetup.ListView THEN BEGIN
                                                                      IF EDIPurchasePaymentAdvice.Posted THEN
                                                                        PAGE.RUN(
                                                                          PAGE::"E.D.I. Posted Purch. Pmt. List",
                                                                            EDIPurchasePaymentAdvice,EDIPurchasePaymentAdvice."No.")
                                                                        ELSE
                                                                          PAGE.RUN(
                                                                            PAGE::"E.D.I. Purch. Payment Advices",
                                                                              EDIPurchasePaymentAdvice,EDIPurchasePaymentAdvice."No.");
                                                                    END ELSE BEGIN
                                                                      IF EDIPurchasePaymentAdvice.Posted THEN
                                                                        PAGE.RUN(PAGE::"E.D.I. Posted PurchPmtAdvice",EDIPurchasePaymentAdvice)
                                                                      ELSE
                                                                        PAGE.RUN(PAGE::"E.D.I. Purchase Payment Advice",EDIPurchasePaymentAdvice);
                                                                    END;
                                                                  END;
                                                                'E_TFRSHP':
                                                                  BEGIN
                                                                    TransferShipmentHdr.RESET;
                                                                    TransferShipmentHdr.SETRANGE("No.","Document No.");
                                                                    IF EDISetup.ListView THEN
                                                                      PAGE.RUN(PAGE::"Posted Transfer Shipments",TransferShipmentHdr)
                                                                    ELSE
                                                                      PAGE.RUN(PAGE::"Posted Transfer Shipment",TransferShipmentHdr);
                                                                  END;
                                                                'E_INVADV':
                                                                  BEGIN
                                                                    InventoryAdviceHeader.RESET;
                                                                    InventoryAdviceHeader.SETRANGE("No.","Document No.");
                                                                    InventoryAdviceHeader.SETRANGE(Posted,FALSE);
                                                                    InventoryAdviceHeader.SETRANGE(Type,InventoryAdviceHeader.Type::"  ");
                                                                    IF InventoryAdviceHeader.FIND('-') THEN BEGIN
                                                                      IF EDISetup.ListView THEN
                                                                        PAGE.RUN(PAGE::"E.D.I. Inventory Advice List",InventoryAdviceHeader)
                                                                      ELSE
                                                                        PAGE.RUN(PAGE::"E.D.I. Inventory Advice",InventoryAdviceHeader);
                                                                    END ELSE BEGIN
                                                                     InventoryAdviceHeader.SETRANGE(Posted,TRUE);
                                                                      IF EDISetup.ListView THEN
                                                                        PAGE.RUN(PAGE::"E.D.I. Posted Invt Advice List",InventoryAdviceHeader)
                                                                      ELSE
                                                                        PAGE.RUN(PAGE::"E.D.I. Posted Inventory Advice",InventoryAdviceHeader);
                                                                    END;
                                                                  END;
                                                                'E_PRICAT':
                                                                  BEGIN
                                                                    InventoryAdviceHeader.RESET;
                                                                    InventoryAdviceHeader.SETRANGE("No.","Document No.");
                                                                    InventoryAdviceHeader.SETRANGE(Posted,FALSE);
                                                                    InventoryAdviceHeader.SETRANGE(Type,InventoryAdviceHeader.Type::"Price Catalog");
                                                                    IF InventoryAdviceHeader.FIND('-') THEN BEGIN
                                                                      IF EDISetup.ListView THEN
                                                                        PAGE.RUN(PAGE::"E.D.I. Price Catalog List",InventoryAdviceHeader)
                                                                      ELSE
                                                                        PAGE.RUN(PAGE::"E.D.I. Price Catalog",InventoryAdviceHeader);
                                                                    END ELSE BEGIN
                                                                     InventoryAdviceHeader.SETRANGE(Posted,TRUE);
                                                                      IF EDISetup.ListView THEN
                                                                        PAGE.RUN(PAGE::"E.D.I. PostedPriceCatalog List",InventoryAdviceHeader)
                                                                      ELSE
                                                                        PAGE.RUN(PAGE::"E.D.I. Posted Price Catalog",InventoryAdviceHeader);
                                                                    END;
                                                                  END;
                                                              END;
                                                            END;

                                                   CaptionML=ENU=Document No.;
                                                   Editable=No }
    { 20  ;   ;EDI Document No.    ;Code30        ;CaptionML=ENU=EDI Document No.;
                                                   Editable=No }
    { 21  ;   ;Navision Document   ;Code10        ;CaptionML=ENU=Navision Document;
                                                   Editable=No }
    { 50001;  ;Original Date       ;Date          ;Editable=No }
  }
  KEYS
  {
    {    ;Entry No.                               ;Clustered=Yes }
    {    ;Error,Trade Partner,Document Type,Document No. }
    {    ;Date,Trade Partner                       }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      EDISetup@1240020000 : Record 14002367;
      EDISetupRetrieved@1240020001 : Boolean;

    PROCEDURE GetEDISetup@1240020001();
    BEGIN
      IF NOT EDISetupRetrieved THEN BEGIN
        EDISetup.GET;
        EDISetupRetrieved := TRUE;
      END;
    END;

    PROCEDURE ViewTradePartner@1240020000();
    VAR
      EDITradePartner@1240020000 : Record 14002360;
    BEGIN
      GetEDISetup();

      EDITradePartner.RESET;
      EDITradePartner.SETRANGE("No.",UserID);
        IF EDISetup.ListView THEN
          PAGE.RUN(PAGE::"E.D.I. Trade Partner List",EDITradePartner)
        ELSE
          PAGE.RUN(PAGE::"E.D.I. Trade Partner",EDITradePartner);
    END;

    BEGIN
    {
      TPZ2324 UCHOUHAN 05-29-2018
        Add new Field "Original Date"
    }
    END.
  }
}

