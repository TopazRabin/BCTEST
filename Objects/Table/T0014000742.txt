OBJECT Table 14000742 Rate Shop Line
{
  OBJECT-PROPERTIES
  {
    Date=06/28/17;
    Time=12:00:00 PM;
    Version List=SE0.60.13.02;
  }
  PROPERTIES
  {
    CaptionML=ENU=Rate Shop Line;
  }
  FIELDS
  {
    { 1   ;   ;Rate Shop No.       ;Code20        ;TableRelation="Rate Shop Header";
                                                   CaptionML=ENU=Rate Shop No. }
    { 2   ;   ;Shipping Agent Code ;Code10        ;TableRelation="Shipping Agent".Code;
                                                   CaptionML=ENU=Shipping Agent Code }
    { 3   ;   ;World Wide Service  ;Boolean       ;CaptionML=ENU=World Wide Service }
    { 4   ;   ;Shipping Agent Service;Code30      ;TableRelation="E-Ship Agent Service".Code WHERE (Shipping Agent Code=FIELD(Shipping Agent Code));
                                                   CaptionML=ENU=Shipping Agent Service }
    { 5   ;   ;Zone                ;Code10        ;CaptionML=ENU=Zone }
    { 6   ;   ;Hundred Weight Rate ;Boolean       ;CaptionML=ENU=Hundred Weight Rate }
    { 11  ;   ;Total Amount        ;Decimal       ;CaptionML=ENU=Total Amount;
                                                   BlankZero=Yes }
    { 12  ;   ;Order Amount        ;Decimal       ;CaptionML=ENU=Order Amount;
                                                   BlankZero=Yes }
    { 13  ;   ;Shipping Charge     ;Decimal       ;CaptionML=ENU=Shipping Charge;
                                                   BlankZero=Yes }
    { 14  ;   ;Service Description ;Text100       ;CaptionML=ENU=Service Description }
    { 15  ;   ;Service Error Message;Text150      ;CaptionML=ENU=Service Error Message }
    { 16  ;   ;Base Charge         ;Decimal       ;CaptionML=ENU=Base Charge;
                                                   BlankZero=Yes }
    { 17  ;   ;Surcharge           ;Decimal       ;CaptionML=ENU=Surcharge;
                                                   BlankZero=Yes }
    { 18  ;   ;Markup              ;Decimal       ;CaptionML=ENU=Markup;
                                                   BlankZero=Yes }
    { 19  ;   ;Accessorial Charge  ;Decimal       ;CaptionML=ENU=Accessorial Charge;
                                                   BlankZero=Yes }
    { 20  ;   ;Discount Amount     ;Decimal       ;CaptionML=ENU=Discount Amount;
                                                   BlankZero=Yes }
    { 21  ;   ;Rebate Amount       ;Decimal       ;CaptionML=ENU=Rebate Amount;
                                                   BlankZero=Yes }
    { 22  ;   ;Sorting             ;Integer       ;CaptionML=ENU=Sorting;
                                                   Editable=No }
    { 23  ;   ;Shipping Cost       ;Decimal       ;CaptionML=ENU=Shipping Cost;
                                                   BlankZero=Yes;
                                                   Editable=No }
    { 24  ;   ;Insure Through Shipping Agent;Boolean;
                                                   CaptionML=ENU=Insure Through Shipping Agent }
    { 31  ;   ;Third Party Shipping Charge;Decimal;CaptionML=ENU=Third Party Shipping Charge;
                                                   BlankZero=Yes;
                                                   Editable=No }
    { 32  ;   ;Third Party Accessorial Charge;Decimal;
                                                   CaptionML=ENU=Third Party Accessorial Charge;
                                                   BlankZero=Yes;
                                                   Editable=No }
    { 33  ;   ;Third Party Surcharge;Decimal      ;CaptionML=ENU=Third Party Surcharge;
                                                   BlankZero=Yes;
                                                   Editable=No }
    { 34  ;   ;Third Party Markup  ;Decimal       ;CaptionML=ENU=Third Party Markup;
                                                   BlankZero=Yes;
                                                   Editable=No }
    { 35  ;   ;Third Party Base Charge;Decimal    ;CaptionML=ENU=Third Party Base Charge;
                                                   BlankZero=Yes;
                                                   Editable=No }
    { 36  ;   ;Third Party Rebate Amount;Decimal  ;CaptionML=ENU=Third Party Rebate Amount;
                                                   BlankZero=Yes;
                                                   Editable=No }
    { 37  ;   ;Third Party Discount Amount;Decimal;CaptionML=ENU=Third Party Discount Amount;
                                                   BlankZero=Yes;
                                                   Editable=No }
    { 38  ;   ;Third Party Shipping Cost;Decimal  ;CaptionML=ENU=Third Party Shipping Cost;
                                                   DecimalPlaces=2:2;
                                                   BlankZero=Yes;
                                                   Editable=No }
    { 50  ;   ;Transit Time        ;Text50         }
  }
  KEYS
  {
    {    ;Rate Shop No.,Shipping Agent Code,Shipping Agent Service,Zone,Hundred Weight Rate;
                                                   Clustered=Yes }
    {    ;Rate Shop No.,Sorting,Shipping Agent Code,World Wide Service,Shipping Agent Service;
                                                   MaintainSQLIndex=No }
    {    ;Rate Shop No.,Shipping Charge           ;MaintainSQLIndex=No }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      RateShopHeader@1000000000 : Record 14000741;
      SalesHeader@1000000001 : Record 36;
      BillOfLading@1000000003 : Record 14000822;
      Shipping@1000000004 : Codeunit 14000701;
      BillOfLadingMgt@1000000005 : Codeunit 14000821;
      Text001@1001 : TextConst 'ENU=Do you wish to quote %1 %2 for a rate of %3?';
      Text002@1002 : TextConst 'ENU=Do you want to distribute the Cost to the Documents?';
      Text003@1003 : TextConst 'ENU=Only shipping on Sales Orders and Bill of Lading can be quoted.';

    PROCEDURE QuoteLine@1();
    BEGIN
      RateShopHeader.GET("Rate Shop No.");
      CASE TRUE OF
        (RateShopHeader."Source Type" = DATABASE::"Sales Header") AND
        (RateShopHeader."Source Subtype" IN
         [SalesHeader."Document Type"::Quote,SalesHeader."Document Type"::Order,
          SalesHeader."Document Type"::Invoice]):
          BEGIN
            IF NOT CONFIRM(
              Text001,TRUE,
              "Shipping Agent Code","Shipping Agent Service","Shipping Charge")
            THEN
              EXIT;

            RateShopHeader.GET("Rate Shop No.");
            RateShopHeader.TESTFIELD("Source ID");
            SalesHeader.GET(RateShopHeader."Source Subtype",RateShopHeader."Source ID");
            Shipping.WriteShipChargeRateShop(SalesHeader,Rec,TRUE);
          END;
        RateShopHeader."Bill of Lading No." <> '':
          BEGIN
            IF NOT CONFIRM(
                     Text001,TRUE,
                     "Shipping Agent Code","Shipping Agent Service","Shipping Charge")
            THEN
              EXIT;

            BillOfLading.GET(RateShopHeader."Bill of Lading No.");
            BillOfLading.TESTFIELD(Released,FALSE);
            BillOfLading.VALIDATE("Shipping Agent Code","Shipping Agent Code");
            BillOfLading.VALIDATE("Shipping Agent Service","Shipping Agent Service");
            BillOfLading."Shipping Charge" := "Shipping Charge";
            BillOfLading."Shipping Cost" := "Shipping Cost";
            BillOfLading.MODIFY;
            COMMIT;

            IF CONFIRM(Text002,TRUE) THEN
              BillOfLadingMgt.DistributeShippingCharge(BillOfLading);
          END;
        ELSE
          ERROR(Text003);
      END;
    END;

    PROCEDURE MultiplyCharges@2(NoOfPackages@1000000000 : Integer);
    BEGIN
      "Shipping Charge" := "Shipping Charge" * NoOfPackages;
      "Base Charge" := "Base Charge" * NoOfPackages;
      Surcharge := Surcharge * NoOfPackages;
      Markup := Markup * NoOfPackages;
      "Accessorial Charge" := "Accessorial Charge" * NoOfPackages;
      "Discount Amount" := "Discount Amount" * NoOfPackages;
      "Rebate Amount" := "Rebate Amount" * NoOfPackages;
      "Shipping Cost" := "Shipping Cost" * NoOfPackages;

      "Third Party Shipping Charge" := "Third Party Shipping Charge" * NoOfPackages;
      "Third Party Base Charge" := "Third Party Base Charge" * NoOfPackages;
      "Third Party Surcharge" := "Third Party Surcharge" * NoOfPackages;
      "Third Party Markup" := "Third Party Markup" * NoOfPackages;
      "Third Party Accessorial Charge" := "Third Party Accessorial Charge" * NoOfPackages;
      "Third Party Discount Amount" := "Third Party Discount Amount" * NoOfPackages;
      "Third Party Rebate Amount" := "Third Party Rebate Amount" * NoOfPackages;
      "Third Party Shipping Cost" := "Third Party Shipping Cost" * NoOfPackages;
    END;

    PROCEDURE DivideCharges@4(NoOfPackages@1000000000 : Integer);
    BEGIN
      "Shipping Charge" := "Shipping Charge" / NoOfPackages;
      "Base Charge" := "Base Charge" / NoOfPackages;
      Surcharge := Surcharge / NoOfPackages;
      Markup := Markup / NoOfPackages;
      "Accessorial Charge" := "Accessorial Charge" / NoOfPackages;
      "Discount Amount" := "Discount Amount" / NoOfPackages;
      "Rebate Amount" := "Rebate Amount" / NoOfPackages;
      "Shipping Cost" := "Shipping Cost" / NoOfPackages;

      "Third Party Shipping Charge" := "Third Party Shipping Charge" / NoOfPackages;
      "Third Party Base Charge" := "Third Party Base Charge" / NoOfPackages;
      "Third Party Surcharge" := "Third Party Surcharge" / NoOfPackages;
      "Third Party Markup" := "Third Party Markup" / NoOfPackages;
      "Third Party Accessorial Charge" := "Third Party Accessorial Charge" / NoOfPackages;
      "Third Party Discount Amount" := "Third Party Discount Amount" / NoOfPackages;
      "Third Party Rebate Amount" := "Third Party Rebate Amount" / NoOfPackages;
      "Third Party Shipping Cost" := "Third Party Shipping Cost" / NoOfPackages;
    END;

    PROCEDURE AddCharges@3(RateShopLine2@1000000000 : Record 14000742);
    BEGIN
      "Shipping Charge" := "Shipping Charge" + RateShopLine2."Shipping Charge";
      "Base Charge" := "Base Charge" + RateShopLine2."Base Charge";
      Surcharge := Surcharge + RateShopLine2.Surcharge;
      Markup := Markup + RateShopLine2.Markup;
      "Accessorial Charge" := "Accessorial Charge" + RateShopLine2."Accessorial Charge";
      "Discount Amount" := "Discount Amount" + RateShopLine2."Discount Amount";
      "Rebate Amount" := "Rebate Amount" + RateShopLine2."Rebate Amount";
      "Shipping Cost" := "Shipping Cost" + RateShopLine2."Shipping Cost";

      "Third Party Shipping Charge" :=
        "Third Party Shipping Charge" + RateShopLine2."Third Party Shipping Charge";
      "Third Party Base Charge" := "Third Party Base Charge" + RateShopLine2."Third Party Base Charge";
      "Third Party Surcharge" := "Third Party Surcharge" + RateShopLine2."Third Party Surcharge";
      "Third Party Markup" := "Third Party Markup" + RateShopLine2."Third Party Markup";
      "Third Party Accessorial Charge" :=
        "Third Party Accessorial Charge" + RateShopLine2."Third Party Accessorial Charge";
      "Third Party Discount Amount" :=
        "Third Party Discount Amount" + RateShopLine2."Third Party Discount Amount";
      "Third Party Rebate Amount" :=
        "Third Party Rebate Amount" + RateShopLine2."Third Party Rebate Amount";
      "Third Party Shipping Cost" :=
        "Third Party Shipping Cost" + RateShopLine2."Third Party Shipping Cost";
    END;

    PROCEDURE ClearThirdPartyCost@35();
    BEGIN
      "Third Party Shipping Charge" := 0;
      "Third Party Accessorial Charge" := 0;
      "Third Party Surcharge" := 0;
      "Third Party Markup" := 0;
      "Third Party Base Charge" := 0;
      "Third Party Rebate Amount" := 0;
      "Third Party Discount Amount" := 0;
      "Third Party Shipping Cost" := 0;
    END;

    PROCEDURE TransferToThirdPartyCost@31(CurrentRateShopHeader@1000000000 : Record 14000741;MarkupOnZeroShippingCost@1000000001 : Boolean);
    BEGIN
      "Third Party Accessorial Charge" := "Accessorial Charge";
      "Third Party Surcharge" := Surcharge;
      "Third Party Base Charge" := "Base Charge";
      "Third Party Rebate Amount" := "Rebate Amount";
      "Third Party Discount Amount" := "Discount Amount";
      "Third Party Shipping Cost" := "Shipping Cost";
      "Third Party Markup" := Markup;
      "Third Party Shipping Charge" := "Shipping Charge";

      "Accessorial Charge" := 0;
      Surcharge := 0;
      "Base Charge" := 0;
      "Rebate Amount" := 0;
      "Discount Amount" := 0;
      "Shipping Cost" := 0;
      IF NOT MarkupOnZeroShippingCost THEN
        Markup := 0;
      "Shipping Charge" := "Shipping Cost" + Markup + CurrentRateShopHeader."Additional Shipping Charge";
    END;

    BEGIN
    END.
  }
}

