OBJECT Table 50019 Contact Feeder Entry
{
  OBJECT-PROPERTIES
  {
    Date=07/21/21;
    Time=[ 3:40:19 AM];
    Modified=Yes;
    Version List=TOP190,004;
  }
  PROPERTIES
  {
    DataCaptionFields=Entry No.;
    OnInsert=BEGIN

               IF "Line No." <> 0 THEN BEGIN
                 ContFeederEntry.RESET;
                 IF ContFeederEntry.GET("Entry No.",0) THEN BEGIN
                   //<TOP2256>
                   Type := ContFeederEntry.Type;
                   IF Type = Type :: Prospect THEN
                    IF "Line No." > 0 THEN
                      ERROR('Only one Line is allowed in Prospect Contact');
                   //</TOP2256>
                   "Customer No."  := ContFeederEntry."Customer No.";
                   "Customer Name" := ContFeederEntry."Customer Name";
                   "Customer Name 2"  := ContFeederEntry."Customer Name 2";
                   "Customer Address" := ContFeederEntry."Customer Address";
                   "Customer Address 2" := ContFeederEntry."Customer Address 2";
                   "Customer City"      := ContFeederEntry."Customer City";
                   "Customer Contact"   := ContFeederEntry."Customer Contact";
                   "Customer Post Code" := ContFeederEntry."Customer Post Code";
                   "Customer County"    := ContFeederEntry."Customer County";
                   "Sell-to Country/Region Code" := ContFeederEntry."Sell-to Country/Region Code";
                   "RSM Code"          := ContFeederEntry."RSM Code";
                   "Shortcut Dimension 5 Code"    := ContFeederEntry."Shortcut Dimension 5 Code";
                   "ISR Code"          := ContFeederEntry."ISR Code";
                   "OSR Code"          := ContFeederEntry."OSR Code";
                   "CSR Code"          := ContFeederEntry."CSR Code";
                 END;
               END;

               "User ID" := USERID;
               "Date Created" := TODAY;
             END;

    LookupPageID=Page50073;
    DrillDownPageID=Page50073;
  }
  FIELDS
  {
    { 1   ;   ;Entry No.           ;Integer       ;AutoIncrement=Yes;
                                                   Editable=No }
    { 2   ;   ;Customer No.        ;Code20        ;TableRelation=Customer;
                                                   OnValidate=VAR
                                                                CustDivisionError@1000000001 : TextConst 'ENU=Customer Division is not setup for customer %1';
                                                                Text0001@1000000000 : TextConst 'ENU=The Customer %1 is Blocked for Type %2';
                                                                CustomerDiv@1000000002 : Record 50007;
                                                              BEGIN
                                                                GetCust;
                                                                GetCustDivision;
                                                              END;

                                                   CaptionML=[ENU=Customer No.;
                                                              ESM=Venta a-N§ cliente;
                                                              FRC=Nø client (d‚biteur);
                                                              ENC=Sell-to Customer No.] }
    { 3   ;   ;Customer Name       ;Text50        ;OnValidate=VAR
                                                                Customer@1000 : Record 18;
                                                              BEGIN
                                                              END;

                                                   CaptionML=[ENU=Customer Name;
                                                              ESM=Venta a-Nombre;
                                                              FRC=Nom du client (d‚biteur);
                                                              ENC=Sell-to Customer Name];
                                                   Editable=No }
    { 4   ;   ;Customer Name 2     ;Text50        ;CaptionML=[ENU=Customer Name 2;
                                                              ESM=Venta a-Nombre 2;
                                                              FRC=Nom 2 du client (d‚biteur);
                                                              ENC=Sell-to Customer Name 2];
                                                   Editable=No }
    { 5   ;   ;Customer Address    ;Text50        ;CaptionML=[ENU=Customer Address;
                                                              ESM=Venta a-Direcci¢n;
                                                              FRC=Adresse (d‚biteur);
                                                              ENC=Sell-to Address];
                                                   Editable=No }
    { 6   ;   ;Customer Address 2  ;Text50        ;CaptionML=[ENU=Customer Address 2;
                                                              ESM=Venta a-Colonia;
                                                              FRC=Adresse 2 (d‚biteur);
                                                              ENC=Sell-to Address 2];
                                                   Editable=No }
    { 7   ;   ;Customer City       ;Text30        ;TableRelation=IF (Sell-to Country/Region Code=CONST()) "Post Code".City
                                                                 ELSE IF (Sell-to Country/Region Code=FILTER(<>'')) "Post Code".City WHERE (Country/Region Code=FIELD(Sell-to Country/Region Code));
                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Customer City;
                                                              ESM=Venta a-Municipio/Ciudad;
                                                              FRC=Ville (d‚biteur);
                                                              ENC=Sell-to City];
                                                   Editable=No }
    { 8   ;   ;Customer Contact    ;Text50        ;OnLookup=VAR
                                                              Contact@1001 : Record 5050;
                                                            BEGIN
                                                            END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Customer Contact;
                                                              ESM=Venta a-Atenci¢n;
                                                              FRC=Contact (d‚biteur);
                                                              ENC=Sell-to Contact];
                                                   Editable=No }
    { 10  ;   ;Customer Post Code  ;Code20        ;TableRelation=IF (Sell-to Country/Region Code=CONST()) "Post Code"
                                                                 ELSE IF (Sell-to Country/Region Code=FILTER(<>'')) "Post Code" WHERE (Country/Region Code=FIELD(Sell-to Country/Region Code));
                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Customer ZIP Code;
                                                              ESM=Venta a-C.P.;
                                                              FRC=Code postal (d‚biteur);
                                                              ENC=Sell-to Postal/ZIP Code];
                                                   Editable=No }
    { 11  ;   ;Customer County     ;Text30        ;TableRelation=County.Code WHERE (Country/Region Code=FIELD(Sell-to Country/Region Code));
                                                   CaptionML=[ENU=Customer State;
                                                              ESM=Venta a-Provincia;
                                                              FRC=Comt‚ (d‚biteur);
                                                              ENC=Sell-to Province/State];
                                                   Editable=No }
    { 12  ;   ;Sell-to Country/Region Code;Code10 ;TableRelation=Country/Region;
                                                   CaptionML=[ENU=Customer Country/Region Code;
                                                              ESM=Venta a-C¢d. pa¡s/regi¢n;
                                                              FRC=Code pays/r‚gion (d‚biteur);
                                                              ENC=Sell-to Country/Region Code];
                                                   Editable=No }
    { 13  ;   ;Shortcut Dimension 5 Code;Code20   ;TableRelation=IF (Type=CONST(Customer)) "Customer Division"."Shortcut Dimension 5 Code" WHERE (Customer No.=FIELD(Customer No.))
                                                                 ELSE IF (Type=CONST(Prospect)) "Dimension Value".Code WHERE (Dimension Code=CONST(DIVISION));
                                                   OnValidate=VAR
                                                                DimVal@1000000001 : Record 349;
                                                                SLines@1000000000 : Record 37;
                                                              BEGIN
                                                                GetCustDivision;
                                                              END;

                                                   CaptionML=[ENU=Division Code;
                                                              ESM=C¢d. dim. acceso dir. 2;
                                                              FRC=Code raccourci de dimension 2;
                                                              ENC=Shortcut Dimension 2 Code];
                                                   Description=TOP140;
                                                   CaptionClass='1,2,5' }
    { 14  ;   ;RSM Code            ;Code10        ;TableRelation=Salesperson/Purchaser;
                                                   CaptionML=[ENU=RSM Code;
                                                              ENC=RSM Code];
                                                   Description=TOP110;
                                                   Editable=No }
    { 15  ;   ;ISR Code            ;Code10        ;TableRelation=Salesperson/Purchaser;
                                                   CaptionML=ENU=ISR Code;
                                                   Editable=No }
    { 16  ;   ;OSR Code            ;Code10        ;TableRelation=Salesperson/Purchaser;
                                                   CaptionML=ENU=OSR Code;
                                                   Editable=No }
    { 17  ;   ;CSR Code            ;Code10        ;TableRelation=Salesperson/Purchaser;
                                                   CaptionML=ENU=CSR Code;
                                                   Editable=No }
    { 18  ;   ;Job Responsibility  ;Text50        ;TableRelation="Job Responsibility".Description;
                                                   OnValidate=BEGIN
                                                                //<TPZ3262>
                                                                IF ("Job Responsibility" <> xRec."Job Responsibility") AND ("Job Responsibility" <>'') THEN BEGIN
                                                                  Pos := 0;
                                                                  Pos := STRPOS("Job Responsibility",'Prospect');
                                                                  IF (Pos <> 0) AND (Type = Type :: Customer) THEN
                                                                    ERROR(Text50000)
                                                                  ELSE IF (Pos = 0) AND (Type = Type :: Prospect) THEN
                                                                    ERROR(Text50001);
                                                                END;
                                                                //</TPZ3262>
                                                              END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No }
    { 19  ;   ;Job Title           ;Text30         }
    { 20  ;   ;First Name          ;Text30         }
    { 21  ;   ;Last Name           ;Text30         }
    { 22  ;   ;E-Mail Address      ;Text80        ;Description=TOP2250 }
    { 23  ;   ;Phone Number        ;Text30         }
    { 24  ;   ;Mobile Phone Number ;Text30         }
    { 25  ;   ;Address             ;Text50         }
    { 26  ;   ;Address2            ;Text50         }
    { 27  ;   ;City                ;Text50        ;TableRelation=IF (Country/Region Code=CONST()) "Post Code".City
                                                                 ELSE IF (Country/Region Code=FILTER(<>'')) "Post Code".City WHERE (Country/Region Code=FIELD(Country/Region Code));
                                                   OnValidate=BEGIN
                                                                PostCode.ValidateCity(City,"Post Code",County,"Country/Region Code",(CurrFieldNo <> 0) AND GUIALLOWED);
                                                              END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No }
    { 28  ;   ;County              ;Text30        ;TableRelation=County.Code WHERE (Country/Region Code=FIELD(Country/Region Code));
                                                   CaptionML=[ENU=State;
                                                              ESM=Provincia;
                                                              FRC=Comt‚;
                                                              ENC=Province/State] }
    { 29  ;   ;Post Code           ;Code20        ;TableRelation=IF (Country/Region Code=CONST()) "Post Code"
                                                                 ELSE IF (Country/Region Code=FILTER(<>'')) "Post Code" WHERE (Country/Region Code=FIELD(Country/Region Code));
                                                   OnValidate=BEGIN
                                                                PostCode.ValidatePostCode(City,"Post Code",County,"Country/Region Code",(CurrFieldNo <> 0) AND GUIALLOWED);
                                                              END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=ZIP Code;
                                                              ESM=C.P.;
                                                              FRC=Code postal;
                                                              ENC=Postal/ZIP Code] }
    { 30  ;   ;User ID             ;Code50        ;TableRelation=User."User Name";
                                                   TestTableRelation=No;
                                                   CaptionML=ENU=User ID;
                                                   Editable=No }
    { 31  ;   ;Date Created        ;Date          ;CaptionML=ENU=Date Created;
                                                   Editable=Yes }
    { 32  ;   ;Line No.            ;Integer        }
    { 33  ;   ;Country/Region Code ;Code10        ;TableRelation=Country/Region;
                                                   CaptionML=[ENU=Country/Region Code;
                                                              ESM=Venta a-C¢d. pa¡s/regi¢n;
                                                              FRC=Code pays/r‚gion (d‚biteur);
                                                              ENC=Sell-to Country/Region Code];
                                                   Editable=Yes }
    { 34  ;   ;Ship-to Code        ;Code10        ;TableRelation="Ship-to Address".Code WHERE (Customer No.=FIELD(Customer No.));
                                                   OnValidate=VAR
                                                                ShipToAddr@1000 : Record 222;
                                                                SellToCustTemplate@1020000 : Record 5105;
                                                              BEGIN
                                                                //<<TOP2244>>
                                                                IF  "Ship-to Code" <> '' THEN BEGIN
                                                                    ShipToAddr.GET("Customer No.","Ship-to Code");
                                                                    ShipToAddr.TESTFIELD(Blocked,FALSE);
                                                                    Address := ShipToAddr.Address;
                                                                    Address2 := ShipToAddr."Address 2";
                                                                    City := ShipToAddr.City;
                                                                    "Post Code" := ShipToAddr."Post Code";
                                                                    County := ShipToAddr.County;
                                                                    "E-Mail Address" := ShipToAddr."E-Mail";
                                                                    VALIDATE("Country/Region Code",ShipToAddr."Country/Region Code");
                                                                    "Phone Number" := ShipToAddr."Phone No.";
                                                                END ELSE BEGIN
                                                                    Address := '';
                                                                    Address2 := '';
                                                                    City := '';
                                                                    "Post Code" := '';
                                                                    County := '';
                                                                    "E-Mail Address" := '';
                                                                    VALIDATE("Country/Region Code",'');
                                                                    "Phone Number" := '';
                                                                END;
                                                                //<</TOP2244>>
                                                              END;

                                                   CaptionML=[ENU=Ship-to Code;
                                                              ESM=C¢d. direcci¢n env¡o cliente;
                                                              FRC=Code de livraison;
                                                              ENC=Ship-to Code];
                                                   Description=TOP2244 }
    { 35  ;   ;Synched             ;Boolean       ;Description=TOP2255;
                                                   Editable=No }
    { 36  ;   ;Type                ;Option        ;OnValidate=BEGIN
                                                                //<TPZ3262>
                                                                IF (Type <> xRec.Type) AND("Job Responsibility" <> '') THEN BEGIN
                                                                  Pos := 0;
                                                                  Pos := STRPOS("Job Responsibility",'Prospect');
                                                                  IF (Pos <> 0) AND (Type = Type :: Customer) THEN
                                                                    ERROR(Text50000)
                                                                  ELSE IF (Pos = 0) AND (Type = Type :: Prospect) THEN
                                                                    ERROR(Text50001);
                                                                END;
                                                                //</TPZ3262>
                                                              END;

                                                   OptionCaptionML=ENU=Customer,Prospect;
                                                   OptionString=Customer,Prospect;
                                                   Description=TOP2256 }
    { 37  ;   ;Contact No.         ;Code20        ;TableRelation=Contact;
                                                   CaptionML=[ENU=Contact No.;
                                                              ESM=Buscar n§ contacto;
                                                              FRC=S‚lection nø contact;
                                                              ENC=Lookup Contact No.];
                                                   Description=TOP2255;
                                                   Editable=No }
    { 38  ;   ;Email Exist as Customer;Boolean    ;Description=TOP2347;
                                                   Editable=No }
    { 39  ;   ;Email Exist as Prospect;Boolean    ;Description=TOP2347;
                                                   Editable=No }
    { 40  ;   ;Ship-to Name        ;Text50        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Ship-to Address".Name WHERE (Customer No.=FIELD(Customer No.),
                                                                                                    Code=FIELD(Ship-to Code)));
                                                   CaptionML=[ENU=Ship-to Name;
                                                              ESM=Env¡o a-Nombre;
                                                              FRC=Nom du destinataire;
                                                              ENC=Ship-to Name];
                                                   Description=TOP2358;
                                                   Editable=No }
    { 41  ;   ;Prospect Company Name;Text50       ;DataClassification=ToBeClassified;
                                                   Description=TPZ3170 }
    { 42  ;   ;Pricing             ;Boolean       ;DataClassification=ToBeClassified;
                                                   Description=TPZ3221 }
    { 43  ;   ;Marketing           ;Boolean       ;DataClassification=ToBeClassified;
                                                   Description=TPZ3221 }
  }
  KEYS
  {
    {    ;Entry No.,Line No.                      ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      ContFeederEntry@1000000000 : Record 50019;
      PostCode@1000000001 : Record 225;
      Text50000@1000000003 : TextConst 'ENU=Customer Type contact must not have Prospect job responsibility, Please select type Prospect for prospect Job Responsibilty.';
      Text50001@1000000002 : TextConst 'ENU=Prospect Type contact must have Prospect job responsibility, Please select type contact for other Job Responsibilties.';
      Pos@1000000004 : Integer;

    LOCAL PROCEDURE GetCust@2();
    VAR
      Customer@1000000000 : Record 18;
    BEGIN

      IF Customer. GET("Customer No.") THEN BEGIN
        "Customer Name"   := Customer.Name;
        "Customer Name 2" := Customer."Name 2";
        "Customer Address" := Customer.Address;
        "Customer Address 2" := Customer."Address 2";
        "Customer City"      := Customer.City;
        "Customer Contact"   := Customer.Contact;
        "Customer Post Code" := Customer."Post Code";
        "Customer County"    := Customer.County;
        "Sell-to Country/Region Code" := Customer."Country/Region Code" ;
        "RSM Code"          := Customer."RSM Code" ;
      END;
    END;

    LOCAL PROCEDURE GetCustDivision@1000000000();
    VAR
      CustDivision@1000000000 : Record 50007;
    BEGIN
      IF ("Customer No." <> '') AND ("Shortcut Dimension 5 Code" <> '') THEN BEGIN
          IF CustDivision.GET("Customer No.","Shortcut Dimension 5 Code")THEN BEGIN
           "ISR Code" := CustDivision."ISR Code";
           "OSR Code" := CustDivision."Salesperson Code";
           "CSR Code" := CustDivision."CSR Code";
          END;
      END;
    END;

    BEGIN
    {
      TOP2238 UChouhan 03-08-2018
        - Developed for Contact Management Feeder

      TOP2244 UChouhan 03-13-2018
        - Added ship to code field and update ship to address.

      TOP2250 UChouhan 03-21-2018
        - Extend the size of E-mail Address field from 30 to 80.

      TOP2255 UChouhan 03-29-2018
        - Added fied Synched.

      TOP2256 UChouhan 03-29-2018
        - Added fied Type
        - Update Type data.
        - Error code for more than one line in case of prospect contact.

      TOP2255 UChouhan 03-29-2018
        - Added fied Contact No.
      TOP2347 UCHOUHAN  06-20-2018
        - Added two new fields Email Exist as Customer and Email Exist as Customer.

      TOP2358 UCHOUHAN  06-28-2018
        - Added new field Ship To Name.
      001 TPZ3000 RPS 12092020 - Stop contact sync for missing division setup - Changed the Table Relation of Shortcut Dimension 5 Code
      002 TPZ3170 UTK 05212002 - Added new field Prospect Company Name & added added Prospect condition in table relatation of Shortcut Dimension 5 Code
      003 TPZ3221 UTK 06302021 - Added 2 new boolean fields Marketing and Pricing.
      004 TPZ3262 UTK 07212021 - Code for validation Prospect Job Resp for on only Prospect type.
    }
    END.
  }
}

