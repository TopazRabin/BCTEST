OBJECT Table 50005 Sales Header Buffer
{
  OBJECT-PROPERTIES
  {
    Date=11/06/20;
    Time=[ 7:39:00 AM];
    Modified=Yes;
    Version List=TPZ000.00.00;
  }
  PROPERTIES
  {
    DataCaptionFields=No.,Sell-to Customer Name;
    OnInsert=BEGIN
               InitInsert;
               InsertMode := TRUE;

               // <TPZ834>
               "Assigned User ID" := USERID;
               // </TPZ834>

               FromOnInsert := TRUE; //TOP020 KT ABCSI Sales Orders by Division Code 09012015
               IF GETFILTER("Sell-to Customer No.") <> '' THEN
                 IF GETRANGEMIN("Sell-to Customer No.") = GETRANGEMAX("Sell-to Customer No.") THEN
                   VALIDATE("Sell-to Customer No.",GETRANGEMIN("Sell-to Customer No."));

               IF GETFILTER("Sell-to Contact No.") <> '' THEN
                 IF GETRANGEMIN("Sell-to Contact No.") = GETRANGEMAX("Sell-to Contact No.") THEN
                   VALIDATE("Sell-to Contact No.",GETRANGEMIN("Sell-to Contact No."));

               "Doc. No. Occurrence" := ArchiveManagement.GetNextOccurrenceNo(DATABASE::"Sales Header Buffer","Document Type","No.");
               FromOnInsert := FALSE; //TOP020 KT ABCSI Sales Orders by Division Code 09012015

               //SetSellToCustomerFromFilter; EB 2017 commant out  =

               IF GetFilterContNo <> '' THEN
                 VALIDATE("Sell-to Contact No.",GetFilterContNo);

               "Doc. No. Occurrence" := ArchiveManagement.GetNextOccurrenceNo(DATABASE::"Sales Header Buffer","Document Type","No.");
             END;

    OnModify=BEGIN
               UpdateCustomerAddress;
             END;

    OnDelete=VAR
               PostSalesDelete@1003 : Codeunit 363;
               SalesTaxDifference@1020000 : Record 10012;
               ApprovalMgt@1000000000 : Codeunit 1535;
               ApprovalEntry@1000000001 : Record 454;
             BEGIN
               IF NOT UserSetupMgt.CheckRespCenter(0,"Responsibility Center") THEN
                 ERROR(
                   Text022,
                   RespCenter.TABLECAPTION,UserSetupMgt.GetSalesFilter);
               //<TPZ2447>
               {
               PostSalesDelete.DeleteHeader(
                 Rec,SalesShptHeader,SalesInvHeader,SalesCrMemoHeader,ReturnRcptHeader,
                 SalesInvHeaderPrepmt,SalesCrMemoHeaderPrepmt);
               UpdateOpportunity;
               }
               //</TPZ2447>
               VALIDATE("Applies-to ID",'');
               VALIDATE("Incoming Document Entry No.",0);

               // >> Shipping
               IF "Document Type" IN ["Document Type"::Order,"Document Type"::Invoice] THEN BEGIN
                 Package.RESET;
                 Package.SETCURRENTKEY("Source Type","Source Subtype","Source ID");
                 Package.SETRANGE("Source Type",DATABASE::"Sales Header Buffer");
                 Package.SETRANGE("Source Subtype","Document Type");
                 Package.SETRANGE("Source ID","No.");
                 Package.DELETEALL(TRUE);
               END;

               //<TPZ1931>
               IF NOT SkipDeleteReceiveHeaderGlobal THEN BEGIN
                 IF "Document Type" IN ["Document Type"::"Credit Memo","Document Type"::"Return Order"] THEN BEGIN
                   ReceiveHeader.RESET;
                   ReceiveHeader.SETCURRENTKEY("Source Type","Source Subtype","Source ID");
                   ReceiveHeader.SETRANGE("Source Type",DATABASE::"Sales Header Buffer");
                   ReceiveHeader.SETRANGE("Source Subtype","Document Type");
                   ReceiveHeader.SETRANGE("Source ID","No.");
                   ReceiveHeader.DELETEALL(TRUE);
                 END;
               END;
               //</TPZ1931>
               DeleteShippingAgentOptionPage;
               // << Shipping

               // >> EDI
               DeleteEDIDiscounts;
               // << EDI


               //ApprovalMgt.DeleteApprovalEntry(DATABASE::"Sales Header Buffer","Document Type","No.");
               ApprovalEntry.SETRANGE("Table ID",DATABASE::"Sales Header Buffer");
               ApprovalEntry.SETRANGE("Document Type","Document Type");
               ApprovalEntry.SETRANGE("Document No.","No.");
               ApprovalMgt.DeleteApprovalCommentLine(DATABASE::"Sales Header Buffer","Document Type","No.");
               IF ApprovalEntry.FINDFIRST THEN
                 ApprovalEntry.DELETEALL;

               SalesLine.RESET;
               SalesLine.LOCKTABLE;

               WhseRequest.SETRANGE("Source Type",DATABASE::"Sales Line Quote Buffer");
               WhseRequest.SETRANGE("Source Subtype","Document Type");
               WhseRequest.SETRANGE("Source No.","No.");
               IF NOT WhseRequest.ISEMPTY THEN
                 WhseRequest.DELETEALL(TRUE);

               SalesLine.SETRANGE("Document Type","Document Type");
               SalesLine.SETRANGE("Document No.","No.");
               SalesLine.SETRANGE(Type,SalesLine.Type::"Charge (Item)");

               DeleteSalesLines;
               SalesLine.SETRANGE(Type);
               DeleteSalesLines;

               SalesCommentLine.SETRANGE("Document Type","Document Type");
               SalesCommentLine.SETRANGE("No.","No.");
               SalesCommentLine.DELETEALL;

               IF "Tax Area Code" <> '' THEN BEGIN
                 SalesTaxDifference.RESET;
                 SalesTaxDifference.SETRANGE("Document Product Area",SalesTaxDifference."Document Product Area"::Sales);
                 SalesTaxDifference.SETRANGE("Document Type","Document Type");
                 SalesTaxDifference.SETRANGE("Document No.","No.");
                 SalesTaxDifference.DELETEALL;
               END;

               IF (SalesShptHeader."No." <> '') OR
                  (SalesInvHeader."No." <> '') OR
                  (SalesCrMemoHeader."No." <> '') OR
                  (ReturnRcptHeader."No." <> '') OR
                  (SalesInvHeaderPrepmt."No." <> '') OR
                  (SalesCrMemoHeaderPrepmt."No." <> '')
               THEN
                 MESSAGE(PostedDocsToPrintCreatedMsg);
             END;

    OnRename=BEGIN
               ERROR(Text003,TABLECAPTION);
             END;

    CaptionML=[ENU=Sales Header Buffer;
               ESM=Cab. venta;
               FRC=En-tˆte de ventes;
               ENC=Sales Header];
    LookupPageID=Page51008;
    DrillDownPageID=Page51008;
  }
  FIELDS
  {
    { 1   ;   ;Document Type       ;Option        ;CaptionML=[ENU=Document Type;
                                                              ESM=Tipo documento;
                                                              FRC=Type de document;
                                                              ENC=Document Type];
                                                   OptionCaptionML=[ENU=Quote,Order,Invoice,Credit Memo,Blanket Order,Return Order;
                                                                    ESM=Cotizaci¢n,Pedido,Factura,Nota cr‚dito,Pedido abierto,Devoluci¢n;
                                                                    FRC=Devis,Commande,Facture,Note de cr‚dit,Commande permanente,Retour;
                                                                    ENC=Quote,Order,Invoice,Credit Memo,Blanket Order,Return Order];
                                                   OptionString=Quote,Order,Invoice,Credit Memo,Blanket Order,Return Order }
    { 2   ;   ;Sell-to Customer No.;Code20        ;TableRelation=Customer;
                                                   OnValidate=VAR
                                                                CustDivisionError@1000000001 : TextConst 'ENU=Customer Division is not setup for customer %1';
                                                                Text0001@1000000000 : TextConst 'ENU=The Customer %1 is Blocked for Type %2';
                                                                CustomerDiv@1000000002 : Record 50007;
                                                              BEGIN
                                                                //CheckCreditLimitIfLineNotInsertedYet;
                                                                TESTFIELD(Status,Status::Open);
                                                                IF ("Sell-to Customer No." <> xRec."Sell-to Customer No.") AND
                                                                   (xRec."Sell-to Customer No." <> '')
                                                                THEN BEGIN
                                                                  IF ("Opportunity No." <> '') AND ("Document Type" IN ["Document Type"::Quote,"Document Type"::Order]) THEN
                                                                    ERROR(
                                                                      Text062,
                                                                      FIELDCAPTION("Sell-to Customer No."),
                                                                      FIELDCAPTION("Opportunity No."),
                                                                      "Opportunity No.",
                                                                      "Document Type");
                                                                  IF HideValidationDialog OR NOT GUIALLOWED THEN
                                                                    Confirmed := TRUE
                                                                  ELSE
                                                                    Confirmed := CONFIRM(ConfirmChangeQst,FALSE,SellToCustomerTxt);
                                                                  IF Confirmed THEN BEGIN
                                                                    SalesLine.SETRANGE("Document Type","Document Type");
                                                                    SalesLine.SETRANGE("Document No.","No.");
                                                                    IF "Sell-to Customer No." = '' THEN BEGIN
                                                                      IF SalesLine.FINDFIRST THEN
                                                                        ERROR(
                                                                          Text005,
                                                                          FIELDCAPTION("Sell-to Customer No."));
                                                                      INIT;
                                                                      SalesSetup.GET;
                                                                      "No. Series" := xRec."No. Series";
                                                                      InitRecord;
                                                                      InitNoSeries;
                                                                      EXIT;
                                                                    END;

                                                                    CheckShipmentInfo(SalesLine,FALSE);
                                                                    CheckPrepmtInfo(SalesLine);
                                                                    CheckReturnInfo(SalesLine,FALSE);

                                                                    SalesLine.RESET;
                                                                  END ELSE BEGIN
                                                                    Rec := xRec;
                                                                    EXIT;
                                                                  END;
                                                                END;

                                                                IF ("Document Type" = "Document Type"::Order) AND
                                                                   (xRec."Sell-to Customer No." <> "Sell-to Customer No.")
                                                                THEN BEGIN
                                                                  SalesLine.SETRANGE("Document Type",SalesLine."Document Type"::Order);
                                                                  SalesLine.SETRANGE("Document No.","No.");
                                                                  SalesLine.SETFILTER("Purch. Order Line No.",'<>0');
                                                                  IF NOT SalesLine.ISEMPTY THEN
                                                                    ERROR(
                                                                      Text006,
                                                                      FIELDCAPTION("Sell-to Customer No."));
                                                                  SalesLine.RESET;
                                                                END;

                                                                GetCust("Sell-to Customer No.");
                                                                //<TPZ1666>
                                                                IF ((Cust.Blocked = Cust.Blocked::Ship) AND ("Document Type" IN ["Document Type"::Quote, "Document Type"::Order]))THEN BEGIN //EB TPZ1666
                                                                    MESSAGE(Text0001,"Sell-to Customer No.",Cust.Blocked);
                                                                    SkipCustBlock:=TRUE;
                                                                END;
                                                                //<TPZ1666>

                                                                //<TPZ9131>
                                                                IF NOT SkipCustBlock THEN
                                                                //<TPZ9131>

                                                                Cust.CheckBlockedCustOnDocs(Cust,"Document Type",FALSE,FALSE);
                                                                GLSetup.GET;
                                                                IF GLSetup."VAT in Use" THEN
                                                                  Cust.TESTFIELD("Gen. Bus. Posting Group");
                                                                "Sell-to Customer Template Code" := '';
                                                                "Sell-to Customer Name" := Cust.Name;
                                                                "Sell-to Customer Name 2" := Cust."Name 2";
                                                                CopySellToCustomerAddressFieldsFromCustomer(Cust);
                                                                IF NOT SkipSellToContact THEN
                                                                  "Sell-to Contact" := Cust.Contact;
                                                                "Gen. Bus. Posting Group" := Cust."Gen. Bus. Posting Group";
                                                                "VAT Bus. Posting Group" := Cust."VAT Bus. Posting Group";
                                                                "Tax Area Code" := Cust."Tax Area Code";
                                                                "Tax Liable" := Cust."Tax Liable";
                                                                "Tax Exemption No." := Cust."Tax Exemption No.";
                                                                "VAT Registration No." := Cust."VAT Registration No.";
                                                                "VAT Country/Region Code" := Cust."Country/Region Code";
                                                                "Shipping Advice" := Cust."Shipping Advice";
                                                                //<TPZ9018> 2016-16-03 EBAGIM
                                                                "RSM Code" := Cust."RSM Code";
                                                                //<TPZ9018>
                                                                "Responsibility Center" := UserSetupMgt.GetRespCenter(0,Cust."Responsibility Center");

                                                                IF NOT "Topaz WH Billing" THEN  //<TPZEDI>
                                                                VALIDATE("Location Code",UserSetupMgt.GetLocation(0,Cust."Location Code","Responsibility Center"));


                                                                //TOP170 KT ABCSI Sales Order Updates 04022015
                                                                "Customer Comments" := Cust."Customer Comments";
                                                                "Finance Comments" := Cust."Finance Comments";
                                                                "Shipping Comments" := Cust."Shipping Comments";
                                                                //TOP170 KT ABCSI Sales Order Updates 04022015
                                                                IF "Sell-to Customer No." = xRec."Sell-to Customer No." THEN
                                                                  IF ShippedSalesLinesExist OR ReturnReceiptExist THEN BEGIN
                                                                    TESTFIELD("VAT Bus. Posting Group",xRec."VAT Bus. Posting Group");
                                                                    TESTFIELD("Gen. Bus. Posting Group",xRec."Gen. Bus. Posting Group");
                                                                  END;

                                                                "Sell-to IC Partner Code" := Cust."IC Partner Code";
                                                                "Send IC Document" := ("Sell-to IC Partner Code" <> '') AND ("IC Direction" = "IC Direction"::Outgoing);

                                                                //>> Shipping
                                                                "External Sell-to No." := Cust."External No.";
                                                                //<< Shipping
                                                                // <TPZ162>
                                                                Mail := Cust.Mail;
                                                                Fax := Cust.Fax;
                                                                // </TPZ162>
                                                                IF Cust."Bill-to Customer No." <> '' THEN
                                                                  VALIDATE("Bill-to Customer No.",Cust."Bill-to Customer No.")
                                                                ELSE BEGIN
                                                                  IF "Bill-to Customer No." = "Sell-to Customer No." THEN
                                                                    SkipBillToContact := TRUE;
                                                                  VALIDATE("Bill-to Customer No.","Sell-to Customer No.");
                                                                  SkipBillToContact := FALSE;
                                                                END;

                                                                IF (RunFromEDI OR "Topaz WH Billing") THEN //TPZEDI
                                                                VALIDATE("Ship-to Code",'');

                                                                GetShippingTime(FIELDNO("Sell-to Customer No."));

                                                                // >> EDI
                                                                // <TPZ848>
                                                                IF ("Document Type" IN ["Document Type"::Quote,"Document Type"::Order,"Document Type"::Invoice]) THEN
                                                                // </TPZ848>
                                                                  CASE Cust."EDI Invoice" OF
                                                                    Cust."EDI Invoice"::Always:
                                                                      BEGIN
                                                                        "EDI Order" := TRUE;
                                                                        "EDI Invoice" := TRUE;
                                                                        // <TPZ848>
                                                                        IF EDITradePrtnrDivExcp.GET(Cust."EDI Trade Partner","Shortcut Dimension 5 Code") AND
                                                                           EDITradePrtnrDivExcp.Exclude
                                                                        THEN BEGIN
                                                                          "EDI Order" := FALSE;
                                                                          "EDI Invoice" := FALSE;
                                                                        END;
                                                                        // </TPZ848>
                                                                      END;
                                                                    Cust."EDI Invoice"::Never:
                                                                      BEGIN
                                                                      "EDI Order" := FALSE;
                                                                        "EDI Invoice" := FALSE;
                                                                      END;
                                                                  END;
                                                                // << EDI

                                                                // >> Shipping
                                                                GetCust("Sell-to Customer No.");
                                                                IF Cust."Default Ship-for Code" <> '' THEN
                                                                  VALIDATE("Ship-for Code",Cust."Default Ship-for Code");
                                                                // << Shipping

                                                                IF (xRec."Sell-to Customer No." <> "Sell-to Customer No.") OR
                                                                   (xRec."Currency Code" <> "Currency Code") OR
                                                                   (xRec."Gen. Bus. Posting Group" <> "Gen. Bus. Posting Group") OR
                                                                   (xRec."VAT Bus. Posting Group" <> "VAT Bus. Posting Group")
                                                                THEN
                                                                  RecreateSalesLines(SellToCustomerTxt);

                                                                IF NOT SkipSellToContact THEN
                                                                  UpdateSellToCont("Sell-to Customer No.");
                                                                //<TPZ1409>
                                                                CustomerDiv.SETRANGE("Customer No.","Sell-to Customer No.");
                                                                IF NOT CustomerDiv.FINDFIRST THEN
                                                                   ERROR(CustDivisionError,"Sell-to Customer No.");
                                                                //<TPZ1409>
                                                              END;

                                                   CaptionML=[ENU=Sell-to Customer No.;
                                                              ESM=Venta a-N§ cliente;
                                                              FRC=Nø client (d‚biteur);
                                                              ENC=Sell-to Customer No.] }
    { 3   ;   ;No.                 ;Code20        ;OnValidate=BEGIN
                                                                IF "No." <> xRec."No." THEN BEGIN
                                                                  SalesSetup.GET;
                                                                  {
                                                                   // <TPZ1280>
                                                                  IF NOT SkipManualNoTest THEN
                                                                    NoSeriesMgt.TestManual(GetNoSeriesCode);
                                                                  // </TPZ1280>
                                                                  }
                                                                  "No. Series" := '';
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=No.;
                                                              ESM=N§;
                                                              FRC=Nø;
                                                              ENC=No.] }
    { 4   ;   ;Bill-to Customer No.;Code20        ;TableRelation=Customer;
                                                   OnValidate=VAR
                                                                Text0001@1000000000 : TextConst 'ENU=The Customer %1 is Blocked for Type %2';
                                                              BEGIN
                                                                TESTFIELD(Status,Status::Open);
                                                                BilltoCustomerNoChanged := xRec."Bill-to Customer No." <> "Bill-to Customer No.";
                                                                IF BilltoCustomerNoChanged THEN
                                                                  IF xRec."Bill-to Customer No." = '' THEN
                                                                    InitRecord
                                                                  ELSE BEGIN
                                                                    IF HideValidationDialog OR NOT GUIALLOWED THEN
                                                                      Confirmed := TRUE
                                                                    ELSE
                                                                      Confirmed := CONFIRM(ConfirmChangeQst,FALSE,BillToCustomerTxt);
                                                                    IF Confirmed THEN BEGIN
                                                                      SalesLine.SETRANGE("Document Type","Document Type");
                                                                      SalesLine.SETRANGE("Document No.","No.");

                                                                      CheckShipmentInfo(SalesLine,TRUE);
                                                                      CheckPrepmtInfo(SalesLine);
                                                                      CheckReturnInfo(SalesLine,TRUE);

                                                                      SalesLine.RESET;
                                                                    END ELSE
                                                                      "Bill-to Customer No." := xRec."Bill-to Customer No.";
                                                                  END;

                                                                GetCust("Bill-to Customer No.");

                                                                //<TPZ1666>
                                                                IF ((Cust.Blocked = Cust.Blocked::Ship) AND ("Document Type" IN ["Document Type"::Quote, "Document Type"::Order]))THEN BEGIN //EB TPZ1666
                                                                    IF "Bill-to Customer No."<>"Sell-to Customer No." THEN
                                                                    MESSAGE(Text0001,"No.",Cust.Blocked);
                                                                    SkipCustBlock:=TRUE;
                                                                END;
                                                                //<TPZ1666>

                                                                //<TPZ9131>
                                                                IF NOT SkipCustBlock THEN
                                                                //<TPZ9131>
                                                                Cust.CheckBlockedCustOnDocs(Cust,"Document Type",FALSE,FALSE);//EB Match Function placment to 2013
                                                                Cust.TESTFIELD("Customer Posting Group");
                                                                CheckCrLimit;
                                                                "Bill-to Customer Template Code" := '';
                                                                "Bill-to Name" := Cust.Name;
                                                                "Bill-to Name 2" := Cust."Name 2";
                                                                CopyBillToCustomerAddressFieldsFromCustomer(Cust);
                                                                IF NOT SkipBillToContact THEN
                                                                  "Bill-to Contact" := Cust.Contact;
                                                                "Non Divisional" := Cust."Non Divisional"; //TOP130 KT ABCSI Item List Sort and Filter by Status 04092015

                                                                // <TPZ848>
                                                                CheckEDIOrder;
                                                                // </TPZ848>

                                                                //TOP020 KT ABCSI Sales Orders by Division Code 01272015
                                                                IF UserSetup.GET(USERID) THEN BEGIN
                                                                  IF UserSetup."Shortcut Dimension 5 Code" <> '' THEN BEGIN
                                                                    // <TPZ721>
                                                                    IF CustomerDivision.GET("Sell-to Customer No.",UserSetup."Shortcut Dimension 5 Code") THEN
                                                                    // </TPZ721>
                                                                      VALIDATE("Shortcut Dimension 5 Code",UserSetup."Shortcut Dimension 5 Code")
                                                                    ELSE BEGIN
                                                                      IF NOT HideValidationDialog AND GUIALLOWED THEN
                                                                        MESSAGE(ab001);
                                                                    END
                                                                  END ELSE BEGIN
                                                                    IF NOT HideValidationDialog AND GUIALLOWED THEN
                                                                      MESSAGE(ab001);
                                                                  END;
                                                                END;
                                                                //TOP020 KT ABCSI Sales Orders by Division Code 01272015

                                                                //TOP140 KT ABCSI Modification to Payment Terms 12302014
                                                                SalesSetup.GET;
                                                                IF SalesSetup."Payment Terms by Division" THEN BEGIN
                                                                  IF "Shortcut Dimension 5 Code" <> '' THEN BEGIN
                                                                    IF CustomerDivision.GET("Bill-to Customer No.","Shortcut Dimension 5 Code") THEN BEGIN
                                                                      CustomerDivision.TESTFIELD("Payment Terms Code");
                                                                      "Payment Terms Code" := CustomerDivision."Payment Terms Code"
                                                                    END ELSE
                                                                      "Payment Terms Code" := Cust."Payment Terms Code";
                                                                  END ELSE
                                                                    "Payment Terms Code" := Cust."Payment Terms Code";
                                                                END ELSE
                                                                  "Payment Terms Code" := Cust."Payment Terms Code";
                                                                //TOP140 KT ABCSI Modification to Payment Terms 12302014



                                                                "Prepmt. Payment Terms Code" := Cust."Payment Terms Code";

                                                                //<TPZ1948>
                                                                {
                                                                IF "Document Type" = "Document Type"::"Credit Memo" THEN BEGIN
                                                                  "Payment Method Code" := '';
                                                                  IF PaymentTerms.GET("Payment Terms Code") THEN
                                                                    IF PaymentTerms."Calc. Pmt. Disc. on Cr. Memos" THEN
                                                                      "Payment Method Code" := Cust."Payment Method Code"
                                                                END ELSE
                                                                 }
                                                                  "Payment Method Code" := Cust."Payment Method Code";
                                                                 //</TPZ1948>
                                                                GLSetup.GET;
                                                                IF GLSetup."Bill-to/Sell-to VAT Calc." = GLSetup."Bill-to/Sell-to VAT Calc."::"Bill-to/Pay-to No." THEN BEGIN
                                                                  "VAT Bus. Posting Group" := Cust."VAT Bus. Posting Group";
                                                                  "VAT Country/Region Code" := Cust."Country/Region Code";
                                                                  "VAT Registration No." := Cust."VAT Registration No.";
                                                                  "Gen. Bus. Posting Group" := Cust."Gen. Bus. Posting Group";
                                                                END;
                                                                "Customer Posting Group" := Cust."Customer Posting Group";
                                                                "Currency Code" := Cust."Currency Code";
                                                                "Customer Price Group" := Cust."Customer Price Group";
                                                                "Prices Including VAT" := Cust."Prices Including VAT";
                                                                "Allow Line Disc." := Cust."Allow Line Disc.";
                                                                "Invoice Disc. Code" := Cust."Invoice Disc. Code";
                                                                "Customer Disc. Group" := Cust."Customer Disc. Group";
                                                                "Language Code" := Cust."Language Code";
                                                                "Salesperson Code" := Cust."Salesperson Code";
                                                                "Combine Shipments" := Cust."Combine Shipments";
                                                                Reserve := Cust.Reserve;
                                                                IF "Document Type" = "Document Type"::Order THEN
                                                                  "Prepayment %" := Cust."Prepayment %";
                                                                // <TPZ162>
                                                                Mail := Cust.Mail;
                                                                Fax := Cust.Fax;
                                                                // </TPZ162>
                                                                IF NOT BilltoCustomerNoChanged THEN BEGIN
                                                                  IF ShippedSalesLinesExist THEN BEGIN
                                                                    TESTFIELD("Customer Disc. Group",xRec."Customer Disc. Group");
                                                                    TESTFIELD("Currency Code",xRec."Currency Code");
                                                                  END;
                                                                END;

                                                                CreateDim(
                                                                  DATABASE::Customer,"Bill-to Customer No.",
                                                                  DATABASE::"Salesperson/Purchaser","Salesperson Code",
                                                                  DATABASE::Campaign,"Campaign No.",
                                                                  DATABASE::"Responsibility Center","Responsibility Center",
                                                                  DATABASE::"Customer Template","Bill-to Customer Template Code");

                                                                VALIDATE("Payment Terms Code");
                                                                VALIDATE("Prepmt. Payment Terms Code");
                                                                VALIDATE("Payment Method Code");
                                                                VALIDATE("Currency Code");
                                                                VALIDATE("Prepayment %");

                                                                //TOP020 KT ABCSI Sales Orders by Division 02042015
                                                                IF "Shortcut Dimension 5 Code" <> '' THEN
                                                                  VALIDATE("Shortcut Dimension 5 Code");
                                                                //TOP020 KT ABCSI Sales Orders by Division 02042015

                                                                IF (xRec."Sell-to Customer No." = "Sell-to Customer No.") AND
                                                                   BilltoCustomerNoChanged
                                                                THEN BEGIN
                                                                  RecreateSalesLines(BillToCustomerTxt);
                                                                  BilltoCustomerNoChanged := FALSE;
                                                                END;
                                                                IF NOT SkipBillToContact THEN
                                                                  UpdateBillToCont("Bill-to Customer No.");

                                                                "Bill-to IC Partner Code" := Cust."IC Partner Code";
                                                                "Send IC Document" := ("Bill-to IC Partner Code" <> '') AND ("IC Direction" = "IC Direction"::Outgoing);
                                                              END;

                                                   CaptionML=[ENU=Bill-to Customer No.;
                                                              ESM=Factura-a N§ cliente;
                                                              FRC=N§ client factur‚;
                                                              ENC=Bill-to Customer No.];
                                                   NotBlank=Yes }
    { 5   ;   ;Bill-to Name        ;Text50        ;TableRelation=Customer;
                                                   OnValidate=VAR
                                                                Customer@1000 : Record 18;
                                                              BEGIN
                                                                VALIDATE("Bill-to Customer No.",Customer.GetCustNo("Bill-to Name"));
                                                              END;

                                                   ValidateTableRelation=No;
                                                   CaptionML=[ENU=Name;
                                                              ESM=Fact. a-Nombre;
                                                              FRC=Nom client factur‚;
                                                              ENC=Name] }
    { 6   ;   ;Bill-to Name 2      ;Text50        ;CaptionML=[ENU=Name 2;
                                                              ESM=Fact. a-Nombre 2;
                                                              FRC=Nom client factur‚ 2;
                                                              ENC=Name 2] }
    { 7   ;   ;Bill-to Address     ;Text50        ;CaptionML=[ENU=Address;
                                                              ESM=Fact. a-Direcci¢n;
                                                              FRC=Adresse facturation;
                                                              ENC=Address] }
    { 8   ;   ;Bill-to Address 2   ;Text50        ;CaptionML=[ENU=Address 2;
                                                              ESM=Fact. a-Colonia;
                                                              FRC=Adresse de facturation 2;
                                                              ENC=Address 2] }
    { 9   ;   ;Bill-to City        ;Text30        ;TableRelation=IF (Bill-to Country/Region Code=CONST()) "Post Code".City
                                                                 ELSE IF (Bill-to Country/Region Code=FILTER(<>'')) "Post Code".City WHERE (Country/Region Code=FIELD(Bill-to Country/Region Code));
                                                   OnValidate=BEGIN
                                                                PostCode.ValidateCity(
                                                                  "Bill-to City","Bill-to Post Code","Bill-to County","Bill-to Country/Region Code",(CurrFieldNo <> 0) AND GUIALLOWED);
                                                              END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=City;
                                                              ESM=Fact. a-Municipio/Ciudad;
                                                              FRC=Ville facturation;
                                                              ENC=City] }
    { 10  ;   ;Bill-to Contact     ;Text50        ;OnLookup=VAR
                                                              Contact@1001 : Record 5050;
                                                            BEGIN
                                                              LookupContact("Bill-to Customer No.","Bill-to Contact No.",Contact);
                                                              IF PAGE.RUNMODAL(0,Contact) = ACTION::LookupOK THEN
                                                                VALIDATE("Bill-to Contact No.",Contact."No.");
                                                            END;

                                                   CaptionML=[ENU=Contact;
                                                              ESM=Fact. a-Atenci¢n;
                                                              FRC=Contact facturation;
                                                              ENC=Contact] }
    { 11  ;   ;Your Reference      ;Text35        ;CaptionML=[ENU=Your Reference;
                                                              ESM=Su/Ntra. ref.;
                                                              FRC=Votre r‚f‚rence;
                                                              ENC=Your Reference] }
    { 12  ;   ;Ship-to Code        ;Code10        ;TableRelation="Ship-to Address".Code WHERE (Customer No.=FIELD(Sell-to Customer No.));
                                                   OnValidate=VAR
                                                                ShipToAddr@1000 : Record 222;
                                                                SellToCustTemplate@1020000 : Record 5105;
                                                              BEGIN
                                                                IF ("Document Type" = "Document Type"::Order) AND
                                                                   (xRec."Ship-to Code" <> "Ship-to Code")
                                                                THEN BEGIN
                                                                  SalesLine.SETRANGE("Document Type",SalesLine."Document Type"::Order);
                                                                  SalesLine.SETRANGE("Document No.","No.");
                                                                  SalesLine.SETFILTER("Purch. Order Line No.",'<>0');
                                                                  IF NOT SalesLine.ISEMPTY THEN
                                                                    ERROR(
                                                                      Text006,
                                                                      FIELDCAPTION("Ship-to Code"));
                                                                  SalesLine.RESET;
                                                                END;

                                                                IF NOT IsCreditDocType THEN
                                                                  IF "Ship-to Code" <> '' THEN BEGIN
                                                                    IF xRec."Ship-to Code" <> '' THEN
                                                                      BEGIN
                                                                      GetCust("Sell-to Customer No.");
                                                                      IF Cust."Location Code" <> '' THEN
                                                                        VALIDATE("Location Code",Cust."Location Code");
                                                                      "Tax Area Code" := Cust."Tax Area Code";
                                                                    END;
                                                                    ShipToAddr.GET("Sell-to Customer No.","Ship-to Code");
                                                                     // <TPZ208>
                                                                    ShipToAddr.TESTFIELD(Blocked,FALSE);
                                                                    // </TPZ208>
                                                                    "Ship-to Name" := ShipToAddr.Name;
                                                                    "Ship-to Name 2" := ShipToAddr."Name 2";
                                                                    "Ship-to Address" := ShipToAddr.Address;
                                                                    "Ship-to Address 2" := ShipToAddr."Address 2";
                                                                    "Ship-to City" := ShipToAddr.City;
                                                                    "Ship-to Post Code" := ShipToAddr."Post Code";
                                                                    "Ship-to County" := ShipToAddr.County;
                                                                    "E-Mail (ASN)" := ShipToAddr."E-Mail"; //TOP060 KT ABCSI ASN Via Email 04172015
                                                                    VALIDATE("Ship-to Country/Region Code",ShipToAddr."Country/Region Code");
                                                                    "Ship-to Contact" := ShipToAddr.Contact;
                                                                      // <TPZ460>
                                                                    "Ship-to Phone No." := ShipToAddr."Phone No.";
                                                                    // </TPZ460>
                                                                    // <TPZ848>
                                                                    "EDI Ship-to Code" := '';
                                                                    // </TPZ848>
                                                                    "Shipment Method Code" := ShipToAddr."Shipment Method Code";

                                                                // <TPZ717>
                                                                    IF ShipToAddrDivision.GET("Sell-to Customer No.","Ship-to Code","Shortcut Dimension 5 Code") THEN BEGIN
                                                                      IF ShipToAddrDivision."Location Code" <> '' THEN
                                                                        VALIDATE("Location Code",ShipToAddrDivision."Location Code");
                                                                    END ELSE BEGIN
                                                                      IF ShipToAddr."Location Code" <> '' THEN
                                                                        VALIDATE("Location Code",ShipToAddr."Location Code");
                                                                    END;
                                                                    // </TPZ717>

                                                                  // >> Shipping
                                                                  // "Shipping Agent Code" := ShipToAddr."Shipping Agent Code";
                                                                  // <TPZ717>
                                                                    IF ShipToAddrDivision.GET("Sell-to Customer No.","Ship-to Code","Shortcut Dimension 5 Code") THEN BEGIN
                                                                      // <TPZ1342>
                                                                      "Shipping Advice" := ShipToAddrDivision."Shipping Advice";
                                                                      // </TPZ1342>
                                                                  IF ShipToAddrDivision."Shipping Agent Code" <> '' THEN BEGIN
                                                                    VALIDATE("Shipping Agent Code",ShipToAddrDivision."Shipping Agent Code");
                                                                    IF ShipToAddrDivision."E-Ship Agent Service" <> '' THEN
                                                                      VALIDATE("E-Ship Agent Service",ShipToAddrDivision."E-Ship Agent Service");
                                                                  END;
                                                                  "Shipping Payment Type" := ShipToAddrDivision."Shipping Payment Type";
                                                                  END ELSE BEGIN
                                                                      // <TPZ1342,TPZ1516>

                                                                      IF CustomerDivision.GET("Sell-to Customer No.","Shortcut Dimension 5 Code") THEN BEGIN
                                                                        "Shipping Advice" := CustomerDivision."Shipping Advice";
                                                                        "Shipping Payment Type" := CustomerDivision."Shipping Payment Type";
                                                                      END ELSE BEGIN
                                                                        "Shipping Advice" := Cust."Shipping Advice";
                                                                        "Shipping Payment Type" := Cust."Shipping Payment Type";
                                                                      END;
                                                                      // </TPZ1342,TPZ1516>

                                                                      IF ShipToAddr."Shipping Agent Code" <> '' THEN BEGIN
                                                                        VALIDATE("Shipping Agent Code",ShipToAddr."Shipping Agent Code");
                                                                        IF ShipToAddr."E-Ship Agent Service" <> '' THEN
                                                                          VALIDATE("E-Ship Agent Service",ShipToAddr."E-Ship Agent Service");
                                                                      END;
                                                                      // <TPZ1516>
                                                                      //"Shipping Payment Type" := ShipToAddr."Shipping Payment Type";
                                                                      // </TPZ1516>
                                                                    END;
                                                                    // <TPZ717>
                                                                  "Shipping Insurance" := ShipToAddr."Shipping Insurance";
                                                                  IF "Shipping Payment Type" = "Shipping Payment Type"::Prepaid THEN
                                                                    VALIDATE("Third Party Ship. Account No.",'')
                                                                  ELSE
                                                                    IF ShippingAccount.GetPrimaryShippingAccountNo(
                                                                         "Shipping Agent Code",ShippingAccount."Ship-to Type"::Customer,
                                                                         "Sell-to Customer No.","Ship-to Code")
                                                                    THEN
                                                                      VALIDATE("Third Party Ship. Account No.",ShippingAccount."Account No.");
                                                                  IF NOT "Free Freight" THEN BEGIN
                                                                   // <TPZ717>
                                                                      IF ShipToAddrDivision.GET("Sell-to Customer No.","Ship-to Code","Shortcut Dimension 5 Code") THEN
                                                                        "Free Freight" := ShipToAddrDivision."Free Freight"
                                                                      ELSE
                                                                        "Free Freight" := ShipToAddr."Free Freight";
                                                                      // </TPZ717>
                                                                    "No Free Freight Lines on Order" := ShipToAddr."No Free Freight Lines on Order";
                                                                  END;
                                                                  "Residential Delivery" := ShipToAddr."Residential Delivery";
                                                                  "Blind Shipment" := ShipToAddr."Blind Shipment";
                                                                  "Double Blind Shipment" := ShipToAddr."Double Blind Shipment";
                                                                  VALIDATE("Double Blind Ship-from Cust No",ShipToAddr."Double Blind Ship-from Cust No");
                                                                  "External Ship-to No." := ShipToAddr."External No.";
                                                                  // << Shipping

                                                                    "Shipping Agent Service Code" := ShipToAddr."Shipping Agent Service Code";
                                                                    IF ShipToAddr."Tax Area Code" <> '' THEN
                                                                      "Tax Area Code" := ShipToAddr."Tax Area Code";
                                                                    "Tax Liable" := ShipToAddr."Tax Liable";
                                                                  END ELSE
                                                                    IF "Sell-to Customer No." <> '' THEN BEGIN
                                                                      GetCust("Sell-to Customer No.");
                                                                      "Ship-to Name" := Cust.Name;
                                                                      "Ship-to Name 2" := Cust."Name 2";
                                                                      CopyShipToCustomerAddressFieldsFromCustomer(Cust);
                                                                       "E-Mail (ASN)" := Cust."E-Mail"; //TOP060 KT ABCSI ASN Via Email 04172015
                                                                      "Ship-to Contact" := Cust.Contact;
                                                                      // <TPZ460>
                                                                      "Ship-to Phone No." := Cust."Phone No.";
                                                                      // </TPZ460>
                                                                      "Shipment Method Code" := Cust."Shipment Method Code";
                                                                      IF NOT SellToCustTemplate.GET("Sell-to Customer Template Code") THEN BEGIN
                                                                        "Tax Area Code" := Cust."Tax Area Code";
                                                                        "Tax Liable" := Cust."Tax Liable";
                                                                      END;
                                                                      IF Cust."Location Code" <> '' THEN
                                                                        VALIDATE("Location Code",Cust."Location Code");

                                                                    // >> Shipping
                                                                    // "Shipping Agent Code" := Cust."Shipping Agent Code";
                                                                    "Residential Delivery" := Cust."Residential Delivery";
                                                                    // <TPZ1342,TPZ1516>
                                                                     IF CustomerDivision.GET("Sell-to Customer No.","Shortcut Dimension 5 Code") THEN BEGIN
                                                                      "Shipping Advice" := CustomerDivision."Shipping Advice";
                                                                      "Shipping Payment Type" := CustomerDivision."Shipping Payment Type";
                                                                    END ELSE BEGIN
                                                                      "Shipping Advice" := Cust."Shipping Advice";
                                                                      "Shipping Payment Type" := Cust."Shipping Payment Type";
                                                                    END;
                                                                    // </TPZ1342,TPZ1516>
                                                                    IF Cust."Shipping Agent Code" <> '' THEN BEGIN
                                                                      VALIDATE("Shipping Agent Code",Cust."Shipping Agent Code");
                                                                      IF Cust."E-Ship Agent Service" <> '' THEN
                                                                        VALIDATE("E-Ship Agent Service",Cust."E-Ship Agent Service");
                                                                    END;
                                                                     // <TPZ1516>
                                                                    //"Shipping Payment Type" := Cust."Shipping Payment Type";
                                                                    // <TPZ1516>
                                                                    "Shipping Insurance" := Cust."Shipping Insurance";
                                                                    IF "Shipping Payment Type" = "Shipping Payment Type"::Prepaid THEN
                                                                      VALIDATE("Third Party Ship. Account No.",'')
                                                                    ELSE
                                                                      IF ShippingAccount.GetPrimaryShippingAccountNo(
                                                                           "Shipping Agent Code",ShippingAccount."Ship-to Type"::Customer,
                                                                           "Sell-to Customer No.","Ship-to Code")
                                                                      THEN
                                                                        VALIDATE("Third Party Ship. Account No.",ShippingAccount."Account No.");
                                                                    IF NOT "Free Freight" THEN BEGIN
                                                                      "Free Freight" := Cust."Free Freight";
                                                                      "No Free Freight Lines on Order" := Cust."No Free Freight Lines on Order";
                                                                    END;
                                                                    "Residential Delivery" := Cust."Residential Delivery";
                                                                    "Blind Shipment" := Cust."Blind Shipment";
                                                                    "Double Blind Shipment" := Cust."Double Blind Shipment";
                                                                    VALIDATE("Double Blind Ship-from Cust No",Cust."Double Blind Ship-from Cust No");
                                                                    "External Ship-to No." := Cust."External No.";
                                                                    // << Shipping

                                                                      "Shipping Agent Service Code" := Cust."Shipping Agent Service Code";
                                                                    END;

                                                                GetShippingTime(FIELDNO("Ship-to Code"));

                                                                IF (xRec."Sell-to Customer No." = "Sell-to Customer No.") AND
                                                                   (xRec."Ship-to Code" <> "Ship-to Code")
                                                                THEN
                                                                  IF (xRec."VAT Country/Region Code" <> "VAT Country/Region Code") OR
                                                                     (xRec."Tax Area Code" <> "Tax Area Code")
                                                                  THEN
                                                                    RecreateSalesLines(FIELDCAPTION("Ship-to Code"))
                                                                  ELSE BEGIN
                                                                    IF xRec."Shipping Agent Code" <> "Shipping Agent Code" THEN
                                                                      MessageIfSalesLinesExist(FIELDCAPTION("Shipping Agent Code"));
                                                                    IF xRec."Shipping Agent Service Code" <> "Shipping Agent Service Code" THEN
                                                                      MessageIfSalesLinesExist(FIELDCAPTION("Shipping Agent Service Code"));
                                                                    IF xRec."Tax Liable" <> "Tax Liable" THEN
                                                                      VALIDATE("Tax Liable");
                                                                  END;

                                                                // <TPZ848>
                                                                //IF NOT RunFromEDI AND
                                                                IF ("EDI Order") AND
                                                                   ("Document Type" IN ["Document Type"::Quote,"Document Type"::Order,"Document Type"::Invoice])
                                                                THEN
                                                                  //EDIIntegration.EDIShipToCodeValidate(Rec);
                                                                // <TPZ848>
                                                              END;

                                                   CaptionML=[ENU=Ship-to Code;
                                                              ESM=C¢d. direcci¢n env¡o cliente;
                                                              FRC=Code de livraison;
                                                              ENC=Ship-to Code] }
    { 13  ;   ;Ship-to Name        ;Text50        ;CaptionML=[ENU=Ship-to Name;
                                                              ESM=Env¡o a-Nombre;
                                                              FRC=Nom du destinataire;
                                                              ENC=Ship-to Name] }
    { 14  ;   ;Ship-to Name 2      ;Text50        ;CaptionML=[ENU=Ship-to Name 2;
                                                              ESM=Env¡o a-Nombre 2;
                                                              FRC=Nom du destinataire 2;
                                                              ENC=Ship-to Name 2] }
    { 15  ;   ;Ship-to Address     ;Text50        ;CaptionML=[ENU=Ship-to Address;
                                                              ESM=Direcci¢n de env¡o;
                                                              FRC=Adresse (destinataire);
                                                              ENC=Ship-to Address] }
    { 16  ;   ;Ship-to Address 2   ;Text50        ;CaptionML=[ENU=Ship-to Address 2;
                                                              ESM=Env¡o a-Colonia 2;
                                                              FRC=Adresse de livraison 2;
                                                              ENC=Ship-to Address 2] }
    { 17  ;   ;Ship-to City        ;Text30        ;TableRelation=IF (Ship-to Country/Region Code=CONST()) "Post Code".City
                                                                 ELSE IF (Ship-to Country/Region Code=FILTER(<>'')) "Post Code".City WHERE (Country/Region Code=FIELD(Ship-to Country/Region Code));
                                                   OnValidate=BEGIN
                                                                PostCode.ValidateCity(
                                                                  "Ship-to City","Ship-to Post Code","Ship-to County","Ship-to Country/Region Code",(CurrFieldNo <> 0) AND GUIALLOWED);
                                                              END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Ship-to City;
                                                              ESM=Env¡o a-Municipio/Ciudad;
                                                              FRC=Ville (destinataire);
                                                              ENC=Ship-to City] }
    { 18  ;   ;Ship-to Contact     ;Text50        ;CaptionML=[ENU=Ship-to Contact;
                                                              ESM=Env¡o a-Atenci¢n;
                                                              FRC=Contact destinataire;
                                                              ENC=Ship-to Contact] }
    { 19  ;   ;Order Date          ;Date          ;OnValidate=BEGIN
                                                                IF ("Document Type" IN ["Document Type"::Quote,"Document Type"::Order]) AND
                                                                   NOT ("Order Date" = xRec."Order Date")
                                                                THEN
                                                                  PriceMessageIfSalesLinesExist(FIELDCAPTION("Order Date"));
                                                              END;

                                                   AccessByPermission=TableData 110=R;
                                                   CaptionML=[ENU=Order Date;
                                                              ESM=Fecha pedido;
                                                              FRC=Date commande;
                                                              ENC=Order Date] }
    { 20  ;   ;Posting Date        ;Date          ;OnValidate=BEGIN
                                                                TestNoSeriesDate(
                                                                  "Posting No.","Posting No. Series",
                                                                  FIELDCAPTION("Posting No."),FIELDCAPTION("Posting No. Series"));
                                                                TestNoSeriesDate(
                                                                  "Prepayment No.","Prepayment No. Series",
                                                                  FIELDCAPTION("Prepayment No."),FIELDCAPTION("Prepayment No. Series"));
                                                                TestNoSeriesDate(
                                                                  "Prepmt. Cr. Memo No.","Prepmt. Cr. Memo No. Series",
                                                                  FIELDCAPTION("Prepmt. Cr. Memo No."),FIELDCAPTION("Prepmt. Cr. Memo No. Series"));

                                                                IF "Incoming Document Entry No." = 0 THEN
                                                                  VALIDATE("Document Date","Posting Date");

                                                                IF ("Document Type" IN ["Document Type"::Invoice,"Document Type"::"Credit Memo"]) AND
                                                                   NOT ("Posting Date" = xRec."Posting Date")
                                                                THEN
                                                                  PriceMessageIfSalesLinesExist(FIELDCAPTION("Posting Date"));

                                                                IF "Currency Code" <> '' THEN BEGIN
                                                                  UpdateCurrencyFactor;
                                                                  IF "Currency Factor" <> xRec."Currency Factor" THEN
                                                                    ConfirmUpdateCurrencyFactor;
                                                                END;

                                                                IF "Posting Date" <> xRec."Posting Date" THEN
                                                                  IF DeferralHeadersExist THEN
                                                                    ConfirmUpdateDeferralDate;
                                                                SynchronizeAsmHeader;
                                                              END;

                                                   CaptionML=[ENU=Posting Date;
                                                              ESM=Fecha registro;
                                                              FRC=Date de report;
                                                              ENC=Posting Date] }
    { 21  ;   ;Shipment Date       ;Date          ;OnValidate=BEGIN
                                                                UpdateSalesLines(FIELDCAPTION("Shipment Date"),CurrFieldNo <> 0);
                                                              END;

                                                   CaptionML=[ENU=Shipment Date;
                                                              ESM=Fecha env¡o;
                                                              FRC=Date de livraison;
                                                              ENC=Shipment Date] }
    { 22  ;   ;Posting Description ;Text50        ;CaptionML=[ENU=Posting Description;
                                                              ESM=Texto de registro;
                                                              FRC=Description du report;
                                                              ENC=Posting Description] }
    { 23  ;   ;Payment Terms Code  ;Code10        ;TableRelation="Payment Terms";
                                                   OnValidate=BEGIN
                                                                IF ("Payment Terms Code" <> '') AND ("Document Date" <> 0D) THEN BEGIN
                                                                  PaymentTerms.GET("Payment Terms Code");
                                                                  IF IsCreditDocType AND NOT PaymentTerms."Calc. Pmt. Disc. on Cr. Memos" THEN BEGIN
                                                                    VALIDATE("Due Date","Document Date");
                                                                    VALIDATE("Pmt. Discount Date",0D);
                                                                    VALIDATE("Payment Discount %",0);
                                                                  END ELSE BEGIN
                                                                     // <TPZ1029>
                                                                    PaymentTermDayRange.RESET;
                                                                    PaymentTermDayRange.SETRANGE(Code,PaymentTerms.Code);
                                                                    PaymentTermDayRange.SETFILTER("From Day",'<=%1',DATE2DMY("Document Date",1));
                                                                    PaymentTermDayRange.SETFILTER("To Day",'>=%1',DATE2DMY("Document Date",1));
                                                                    IF PaymentTermDayRange.FINDFIRST THEN BEGIN
                                                                      "Due Date" := CALCDATE(PaymentTermDayRange."Due Date Calculation","Document Date");
                                                                      "Due Date" := CALCDATE(PaymentTerms."Due Date Calculation","Due Date");
                                                                      "Pmt. Discount Date" := CALCDATE(PaymentTermDayRange."Discount Date Calculation","Document Date");
                                                                      "Pmt. Discount Date" := CALCDATE(PaymentTerms."Discount Date Calculation","Pmt. Discount Date");
                                                                    END ELSE BEGIN
                                                                      "Due Date" := CALCDATE(PaymentTerms."Due Date Calculation","Document Date");
                                                                      "Pmt. Discount Date" := CALCDATE(PaymentTerms."Discount Date Calculation","Document Date");
                                                                    END;
                                                                    // <TPZ1029>
                                                                  IF NOT UpdateDocumentDate THEN
                                                                      VALIDATE("Payment Discount %",PaymentTerms."Discount %")
                                                                  END;
                                                                END ELSE BEGIN
                                                                  VALIDATE("Due Date","Document Date");
                                                                  IF NOT UpdateDocumentDate THEN BEGIN
                                                                    VALIDATE("Pmt. Discount Date",0D);
                                                                    VALIDATE("Payment Discount %",0);
                                                                  END;
                                                                END;
                                                                IF xRec."Payment Terms Code" <> '' THEN //TOP190 DM ABCSI Data Migration 02102015
                                                                IF xRec."Payment Terms Code" = "Prepmt. Payment Terms Code" THEN BEGIN
                                                                  IF xRec."Prepayment Due Date" = 0D THEN
                                                                    "Prepayment Due Date" := CALCDATE(PaymentTerms."Due Date Calculation","Document Date");
                                                                  VALIDATE("Prepmt. Payment Terms Code","Payment Terms Code");
                                                                END;
                                                                // >> Shipping
                                                                IF PaymentTerms.GET("Payment Terms Code") THEN BEGIN
                                                                  "COD Payment" := PaymentTerms."COD Payment";
                                                                  "COD Cashiers Check" := PaymentTerms."COD Cashiers Check";
                                                                END ELSE BEGIN
                                                                  "COD Payment" := FALSE;
                                                                  "COD Cashiers Check" := FALSE;
                                                                END;

                                                                // << Shipping
                                                              END;

                                                   CaptionML=[ENU=Payment Terms Code;
                                                              ESM=C¢d. t‚rminos pago;
                                                              FRC=Code modalit‚s de paiement;
                                                              ENC=Payment Terms Code] }
    { 24  ;   ;Due Date            ;Date          ;CaptionML=[ENU=Due Date;
                                                              ESM=Fecha vencimiento;
                                                              FRC=Date d'‚ch‚ance;
                                                              ENC=Due Date] }
    { 25  ;   ;Payment Discount %  ;Decimal       ;OnValidate=BEGIN
                                                                IF NOT (CurrFieldNo IN [0,FIELDNO("Posting Date"),FIELDNO("Document Date")]) THEN
                                                                  TESTFIELD(Status,Status::Open);
                                                                GLSetup.GET;
                                                                IF "Payment Discount %" < GLSetup."VAT Tolerance %" THEN
                                                                  "VAT Base Discount %" := "Payment Discount %"
                                                                ELSE
                                                                  "VAT Base Discount %" := GLSetup."VAT Tolerance %";
                                                                VALIDATE("VAT Base Discount %");
                                                              END;

                                                   CaptionML=[ENU=Payment Discount %;
                                                              ESM=% Dto. P.P.;
                                                              FRC=% escompte de paiement;
                                                              ENC=Payment Discount %];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0;
                                                   MaxValue=100 }
    { 26  ;   ;Pmt. Discount Date  ;Date          ;CaptionML=[ENU=Pmt. Discount Date;
                                                              ESM=Fecha dto. P.P.;
                                                              FRC=Date escompte de paiement;
                                                              ENC=Pmt. Discount Date] }
    { 27  ;   ;Shipment Method Code;Code10        ;TableRelation="Shipment Method";
                                                   OnValidate=BEGIN
                                                                TESTFIELD(Status,Status::Open);
                                                              END;

                                                   CaptionML=[ENU=Shipment Method Code;
                                                              ESM=C¢d. m‚todo de env¡o;
                                                              FRC=Code m‚thode de livraison;
                                                              ENC=Shipment Method Code] }
    { 28  ;   ;Location Code       ;Code10        ;TableRelation=Location WHERE (Use As In-Transit=CONST(No));
                                                   OnValidate=BEGIN
                                                                TESTFIELD(Status,Status::Open);
                                                                IF ("Location Code" <> xRec."Location Code") AND
                                                                   (xRec."Sell-to Customer No." = "Sell-to Customer No.")
                                                                THEN
                                                                  MessageIfSalesLinesExist(FIELDCAPTION("Location Code"));

                                                                UpdateShipToAddress;
                                                                UpdateOutboundWhseHandlingTime;

                                                                // <TPZ92>
                                                                GetLocationDivHdlgPct("Location Code","Shortcut Dimension 5 Code");
                                                                "Location Hdlg. %" := LocationDivHdlgPct."Handling %";
                                                                // </TPZ92>
                                                              END;

                                                   CaptionML=[ENU=Location Code;
                                                              ESM=C¢d. almac‚n;
                                                              FRC=Code d'emplacement;
                                                              ENC=Location Code] }
    { 29  ;   ;Shortcut Dimension 1 Code;Code20   ;TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(1));
                                                   OnValidate=BEGIN
                                                                ValidateShortcutDimCode(1,"Shortcut Dimension 1 Code");
                                                              END;

                                                   CaptionML=[ENU=Shortcut Dimension 1 Code;
                                                              ESM=C¢d. dim. acceso dir. 1;
                                                              FRC=Code raccourci de dimension 1;
                                                              ENC=Shortcut Dimension 1 Code];
                                                   CaptionClass='1,2,1' }
    { 30  ;   ;Shortcut Dimension 2 Code;Code20   ;TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(2));
                                                   OnValidate=BEGIN
                                                                ValidateShortcutDimCode(2,"Shortcut Dimension 2 Code");
                                                              END;

                                                   CaptionML=[ENU=Shortcut Dimension 2 Code;
                                                              ESM=C¢d. dim. acceso dir. 2;
                                                              FRC=Code raccourci de dimension 2;
                                                              ENC=Shortcut Dimension 2 Code];
                                                   CaptionClass='1,2,2' }
    { 31  ;   ;Customer Posting Group;Code10      ;TableRelation="Customer Posting Group";
                                                   CaptionML=[ENU=Customer Posting Group;
                                                              ESM=Grupo contable cliente;
                                                              FRC=ParamŠtre report client;
                                                              ENC=Customer Posting Group];
                                                   Editable=No }
    { 32  ;   ;Currency Code       ;Code10        ;TableRelation=Currency;
                                                   OnValidate=BEGIN
                                                                IF NOT (CurrFieldNo IN [0,FIELDNO("Posting Date")]) OR ("Currency Code" <> xRec."Currency Code") THEN
                                                                  TESTFIELD(Status,Status::Open);
                                                                IF (CurrFieldNo <> FIELDNO("Currency Code")) AND ("Currency Code" = xRec."Currency Code") THEN
                                                                  UpdateCurrencyFactor
                                                                ELSE
                                                                  IF "Currency Code" <> xRec."Currency Code" THEN BEGIN
                                                                    UpdateCurrencyFactor;
                                                                    RecreateSalesLines(FIELDCAPTION("Currency Code"));
                                                                  END ELSE
                                                                    IF "Currency Code" <> '' THEN BEGIN
                                                                      UpdateCurrencyFactor;
                                                                      IF "Currency Factor" <> xRec."Currency Factor" THEN
                                                                        ConfirmUpdateCurrencyFactor;
                                                                    END;
                                                              END;

                                                   CaptionML=[ENU=Currency Code;
                                                              ESM=C¢d. divisa;
                                                              FRC=Code devise;
                                                              ENC=Currency Code] }
    { 33  ;   ;Currency Factor     ;Decimal       ;OnValidate=BEGIN
                                                                IF "Currency Factor" <> xRec."Currency Factor" THEN
                                                                  UpdateSalesLines(FIELDCAPTION("Currency Factor"),FALSE);
                                                              END;

                                                   CaptionML=[ENU=Currency Factor;
                                                              ESM=Factor divisa;
                                                              FRC=Facteur devise;
                                                              ENC=Currency Factor];
                                                   DecimalPlaces=0:15;
                                                   MinValue=0;
                                                   Editable=No }
    { 34  ;   ;Customer Price Group;Code10        ;TableRelation="Customer Price Group";
                                                   OnValidate=BEGIN
                                                                MessageIfSalesLinesExist(FIELDCAPTION("Customer Price Group"));
                                                              END;

                                                   CaptionML=[ENU=Customer Price Group;
                                                              ESM=Grupo precio cliente;
                                                              FRC=Groupe de prix du client;
                                                              ENC=Customer Price Group] }
    { 35  ;   ;Prices Including VAT;Boolean       ;OnValidate=VAR
                                                                SalesLine@1000 : Record 50006;
                                                                Currency@1001 : Record 4;
                                                                RecalculatePrice@1002 : Boolean;
                                                              BEGIN
                                                                TESTFIELD(Status,Status::Open);

                                                                IF "Prices Including VAT" <> xRec."Prices Including VAT" THEN BEGIN
                                                                  SalesLine.SETRANGE("Document Type","Document Type");
                                                                  SalesLine.SETRANGE("Document No.","No.");
                                                                  SalesLine.SETFILTER("Job Contract Entry No.",'<>%1',0);
                                                                  IF SalesLine.FIND('-') THEN BEGIN
                                                                    SalesLine.TESTFIELD("Job No.",'');
                                                                    SalesLine.TESTFIELD("Job Contract Entry No.",0);
                                                                  END;

                                                                  SalesLine.RESET;
                                                                  SalesLine.SETRANGE("Document Type","Document Type");
                                                                  SalesLine.SETRANGE("Document No.","No.");
                                                                  SalesLine.SETFILTER("Unit Price",'<>%1',0);
                                                                  SalesLine.SETFILTER("VAT %",'<>%1',0);
                                                                  IF SalesLine.FINDFIRST THEN BEGIN
                                                                    RecalculatePrice :=
                                                                      CONFIRM(
                                                                        STRSUBSTNO(
                                                                          Text024,
                                                                          FIELDCAPTION("Prices Including VAT"),SalesLine.FIELDCAPTION("Unit Price")),
                                                                        TRUE);
                                                                    SalesLine.SetSalesHeader(Rec);

                                                                    IF RecalculatePrice AND "Prices Including VAT" THEN
                                                                      SalesLine.MODIFYALL(Amount,0,TRUE);

                                                                    IF "Currency Code" = '' THEN
                                                                      Currency.InitRoundingPrecision
                                                                    ELSE
                                                                      Currency.GET("Currency Code");
                                                                    SalesLine.LOCKTABLE;
                                                                    LOCKTABLE;
                                                                    SalesLine.FINDSET;
                                                                    REPEAT
                                                                      SalesLine.TESTFIELD("Quantity Invoiced",0);
                                                                      SalesLine.TESTFIELD("Prepmt. Amt. Inv.",0);
                                                                      IF NOT RecalculatePrice THEN BEGIN
                                                                        SalesLine."VAT Difference" := 0;
                                                                        SalesLine.UpdateAmounts;
                                                                      END ELSE
                                                                        IF "Prices Including VAT" THEN BEGIN
                                                                          SalesLine."Unit Price" :=
                                                                            ROUND(
                                                                              SalesLine."Unit Price" * (1 + (SalesLine."VAT %" / 100)),
                                                                              Currency."Unit-Amount Rounding Precision");
                                                                          IF SalesLine.Quantity <> 0 THEN BEGIN
                                                                            SalesLine."Line Discount Amount" :=
                                                                              ROUND(
                                                                                SalesLine.Quantity * SalesLine."Unit Price" * SalesLine."Line Discount %" / 100,
                                                                                Currency."Amount Rounding Precision");
                                                                            SalesLine.VALIDATE("Inv. Discount Amount",
                                                                              ROUND(
                                                                                SalesLine."Inv. Discount Amount" * (1 + (SalesLine."VAT %" / 100)),
                                                                                Currency."Amount Rounding Precision"));
                                                                          END;
                                                                        END ELSE BEGIN
                                                                          SalesLine."Unit Price" :=
                                                                            ROUND(
                                                                              SalesLine."Unit Price" / (1 + (SalesLine."VAT %" / 100)),
                                                                              Currency."Unit-Amount Rounding Precision");
                                                                          IF SalesLine.Quantity <> 0 THEN BEGIN
                                                                            SalesLine."Line Discount Amount" :=
                                                                              ROUND(
                                                                                SalesLine.Quantity * SalesLine."Unit Price" * SalesLine."Line Discount %" / 100,
                                                                                Currency."Amount Rounding Precision");
                                                                            SalesLine.VALIDATE("Inv. Discount Amount",
                                                                              ROUND(
                                                                                SalesLine."Inv. Discount Amount" / (1 + (SalesLine."VAT %" / 100)),
                                                                                Currency."Amount Rounding Precision"));
                                                                          END;
                                                                        END;
                                                                      SalesLine.MODIFY;
                                                                    UNTIL SalesLine.NEXT = 0;
                                                                  END;
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Prices Including Tax;
                                                              ESM=Precios IVA incluido;
                                                              FRC=Prix incluant la TVA;
                                                              ENC=Prices Including Tax] }
    { 37  ;   ;Invoice Disc. Code  ;Code20        ;OnValidate=BEGIN
                                                                TESTFIELD(Status,Status::Open);
                                                                MessageIfSalesLinesExist(FIELDCAPTION("Invoice Disc. Code"));
                                                              END;

                                                   AccessByPermission=TableData 19=R;
                                                   CaptionML=[ENU=Invoice Disc. Code;
                                                              ESM=C¢d. dto. factura;
                                                              FRC=Code escompte facture;
                                                              ENC=Invoice Disc. Code] }
    { 40  ;   ;Customer Disc. Group;Code20        ;TableRelation="Customer Discount Group";
                                                   OnValidate=BEGIN
                                                                TESTFIELD(Status,Status::Open);
                                                                MessageIfSalesLinesExist(FIELDCAPTION("Customer Disc. Group"));
                                                              END;

                                                   CaptionML=[ENU=Customer Multiplier Group;
                                                              ESM=Grupo dto. cliente;
                                                              FRC=Groupe d'escompte du client;
                                                              ENC=Customer Disc. Group] }
    { 41  ;   ;Language Code       ;Code10        ;TableRelation=Language;
                                                   OnValidate=BEGIN
                                                                MessageIfSalesLinesExist(FIELDCAPTION("Language Code"));
                                                              END;

                                                   CaptionML=[ENU=Language Code;
                                                              ESM=C¢d. idioma;
                                                              FRC=Code langue;
                                                              ENC=Language Code] }
    { 43  ;   ;Salesperson Code    ;Code10        ;TableRelation=Salesperson/Purchaser;
                                                   OnValidate=VAR
                                                                ApprovalEntry@1001 : Record 454;
                                                              BEGIN
                                                                ApprovalEntry.SETRANGE("Table ID",DATABASE::"Sales Header Buffer");
                                                                ApprovalEntry.SETRANGE("Document Type","Document Type");
                                                                ApprovalEntry.SETRANGE("Document No.","No.");
                                                                ApprovalEntry.SETFILTER(Status,'%1|%2',ApprovalEntry.Status::Created,ApprovalEntry.Status::Open);
                                                                IF NOT ApprovalEntry.ISEMPTY THEN
                                                                  ERROR(Text053,FIELDCAPTION("Salesperson Code"));

                                                                CreateDim(
                                                                  DATABASE::"Salesperson/Purchaser","Salesperson Code",
                                                                  DATABASE::Customer,"Bill-to Customer No.",
                                                                  DATABASE::Campaign,"Campaign No.",
                                                                  DATABASE::"Responsibility Center","Responsibility Center",
                                                                  DATABASE::"Customer Template","Bill-to Customer Template Code");

                                                                // <TPZ572>
                                                                //TOP020 KT ABCSI Sales Orders by Division 02042015
                                                                // IF "Shortcut Dimension 5 Code" <> '' THEN
                                                                //   VALIDATE("Shortcut Dimension 5 Code");
                                                                //TOP020 KT ABCSI Sales Orders by Division 02042015
                                                                ValidateShortcutDimCode(5,"Shortcut Dimension 5 Code");
                                                                // </TPZ572>
                                                              END;

                                                   CaptionML=[ENU=OSR Code;
                                                              ESM=C¢d. vendedor;
                                                              FRC=Code repr‚sentant;
                                                              ENC=Salesperson Code] }
    { 45  ;   ;Order Class         ;Code10        ;CaptionML=[ENU=Order Class;
                                                              ESM=Clase pedido;
                                                              FRC=Classe commande;
                                                              ENC=Order Class] }
    { 46  ;   ;Comment             ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Sales Comment Line" WHERE (Document Type=FIELD(Document Type),
                                                                                                 No.=FIELD(No.),
                                                                                                 Document Line No.=CONST(0)));
                                                   CaptionML=[ENU=Comment;
                                                              ESM=Comentario;
                                                              FRC=Commentaire;
                                                              ENC=Comment];
                                                   Editable=No }
    { 47  ;   ;No. Printed         ;Integer       ;CaptionML=[ENU=No. Printed;
                                                              ESM=N§ copias impresas;
                                                              FRC=Nombre impressions;
                                                              ENC=No. Printed];
                                                   Editable=No }
    { 51  ;   ;On Hold             ;Code3         ;CaptionML=[ENU=On Hold;
                                                              ESM=Esperar;
                                                              FRC=En attente;
                                                              ENC=On Hold] }
    { 52  ;   ;Applies-to Doc. Type;Option        ;CaptionML=[ENU=Applies-to Doc. Type;
                                                              ESM=Liq. por tipo documento;
                                                              FRC=Type document affect‚ …;
                                                              ENC=Applies-to Doc. Type];
                                                   OptionCaptionML=[ENU=" ,Payment,Invoice,Credit Memo,Finance Charge Memo,Reminder,Refund";
                                                                    ESM=" ,Pago,Factura,Nota cr‚dito,Docs. inter‚s,Recordatorio,Reembolso";
                                                                    FRC=" ,Paiement,Facture,Note de cr‚dit,Note de frais financiers,Rappel,Remboursement";
                                                                    ENC=" ,Payment,Invoice,Credit Memo,Finance Charge Memo,Reminder,Refund"];
                                                   OptionString=[ ,Payment,Invoice,Credit Memo,Finance Charge Memo,Reminder,Refund] }
    { 53  ;   ;Applies-to Doc. No. ;Code20        ;OnValidate=BEGIN
                                                                IF "Applies-to Doc. No." <> '' THEN
                                                                  TESTFIELD("Bal. Account No.",'');

                                                                IF ("Applies-to Doc. No." <> xRec."Applies-to Doc. No.") AND (xRec."Applies-to Doc. No." <> '') AND
                                                                   ("Applies-to Doc. No." <> '')
                                                                THEN BEGIN
                                                                  SetAmountToApply("Applies-to Doc. No.","Bill-to Customer No.");
                                                                  SetAmountToApply(xRec."Applies-to Doc. No.","Bill-to Customer No.");
                                                                END ELSE
                                                                  IF ("Applies-to Doc. No." <> xRec."Applies-to Doc. No.") AND (xRec."Applies-to Doc. No." = '') THEN
                                                                    SetAmountToApply("Applies-to Doc. No.","Bill-to Customer No.")
                                                                  ELSE
                                                                    IF ("Applies-to Doc. No." <> xRec."Applies-to Doc. No.") AND ("Applies-to Doc. No." = '') THEN
                                                                      SetAmountToApply(xRec."Applies-to Doc. No.","Bill-to Customer No.");
                                                              END;

                                                   OnLookup=VAR
                                                              GenJnlLine@1000 : Record 81;
                                                              GenJnlApply@1002 : Codeunit 225;
                                                              ApplyCustEntries@1001 : Page 232;
                                                            BEGIN
                                                              TESTFIELD("Bal. Account No.",'');
                                                              CustLedgEntry.SETCURRENTKEY("Customer No.",Open,Positive,"Due Date");
                                                              CustLedgEntry.SETRANGE("Customer No.","Bill-to Customer No.");
                                                              CustLedgEntry.SETRANGE(Open,TRUE);
                                                              IF "Applies-to Doc. No." <> '' THEN BEGIN
                                                                CustLedgEntry.SETRANGE("Document Type","Applies-to Doc. Type");
                                                                CustLedgEntry.SETRANGE("Document No.","Applies-to Doc. No.");
                                                                IF CustLedgEntry.FINDFIRST THEN;
                                                                CustLedgEntry.SETRANGE("Document Type");
                                                                CustLedgEntry.SETRANGE("Document No.");
                                                              END ELSE
                                                                IF "Applies-to Doc. Type" <> 0 THEN BEGIN
                                                                  CustLedgEntry.SETRANGE("Document Type","Applies-to Doc. Type");
                                                                  IF CustLedgEntry.FINDFIRST THEN;
                                                                  CustLedgEntry.SETRANGE("Document Type");
                                                                END ELSE
                                                                  IF Amount <> 0 THEN BEGIN
                                                                    CustLedgEntry.SETRANGE(Positive,Amount < 0);
                                                                    IF CustLedgEntry.FINDFIRST THEN;
                                                                    CustLedgEntry.SETRANGE(Positive);
                                                                  END;

                                                              //ApplyCustEntries.SetSales(Rec,CustLedgEntry,SalesHeader.FIELDNO("Applies-to Doc. No."));
                                                              ApplyCustEntries.SETTABLEVIEW(CustLedgEntry);
                                                              ApplyCustEntries.SETRECORD(CustLedgEntry);
                                                              ApplyCustEntries.LOOKUPMODE(TRUE);
                                                              IF ApplyCustEntries.RUNMODAL = ACTION::LookupOK THEN BEGIN
                                                                ApplyCustEntries.GetCustLedgEntry(CustLedgEntry);
                                                                GenJnlApply.CheckAgainstApplnCurrency(
                                                                  "Currency Code",CustLedgEntry."Currency Code",GenJnlLine."Account Type"::Customer,TRUE);
                                                                "Applies-to Doc. Type" := CustLedgEntry."Document Type";
                                                                "Applies-to Doc. No." := CustLedgEntry."Document No.";
                                                              END;
                                                              CLEAR(ApplyCustEntries);
                                                            END;

                                                   CaptionML=[ENU=Applies-to Doc. No.;
                                                              ESM=Liq. por n§ documento;
                                                              FRC=Nø doc. affect‚ …;
                                                              ENC=Applies-to Doc. No.] }
    { 55  ;   ;Bal. Account No.    ;Code20        ;TableRelation=IF (Bal. Account Type=CONST(G/L Account)) "G/L Account"
                                                                 ELSE IF (Bal. Account Type=CONST(Bank Account)) "Bank Account";
                                                   OnValidate=BEGIN
                                                                IF "Bal. Account No." <> '' THEN
                                                                  CASE "Bal. Account Type" OF
                                                                    "Bal. Account Type"::"G/L Account":
                                                                      BEGIN
                                                                        GLAcc.GET("Bal. Account No.");
                                                                        GLAcc.CheckGLAcc;
                                                                        GLAcc.TESTFIELD("Direct Posting",TRUE);
                                                                      END;
                                                                    "Bal. Account Type"::"Bank Account":
                                                                      BEGIN
                                                                        BankAcc.GET("Bal. Account No.");
                                                                        BankAcc.TESTFIELD(Blocked,FALSE);
                                                                        BankAcc.TESTFIELD("Currency Code","Currency Code");
                                                                      END;
                                                                  END;
                                                              END;

                                                   CaptionML=[ENU=Bal. Account No.;
                                                              ESM=Cta. contrapartida;
                                                              FRC=Nø compte contr“le;
                                                              ENC=Bal. Account No.] }
    { 56  ;   ;Recalculate Invoice Disc.;Boolean  ;CaptionML=[ENU=Recalculate Invoice Disc.;
                                                              ESM=Recalcular dto. en la factura;
                                                              FRC=Recalculer remise facture;
                                                              ENC=Recalculate Invoice Disc.];
                                                   Editable=No }
    { 57  ;   ;Ship                ;Boolean       ;CaptionML=[ENU=Ship;
                                                              ESM=Env¡o;
                                                              FRC=Livrer;
                                                              ENC=Ship];
                                                   Editable=No }
    { 58  ;   ;Invoice             ;Boolean       ;CaptionML=[ENU=Invoice;
                                                              ESM=Factura;
                                                              FRC=Facture;
                                                              ENC=Invoice] }
    { 59  ;   ;Print Posted Documents;Boolean     ;CaptionML=[ENU=Print Posted Documents;
                                                              ESM=Imprimir documentos registrados;
                                                              FRC=Imprimer les documents report‚s;
                                                              ENC=Print Posted Documents] }
    { 60  ;   ;Amount              ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Sales Line Quote Buffer".Amount WHERE (Document Type=FIELD(Document Type),
                                                                                                           Document No.=FIELD(No.)));
                                                   CaptionML=[ENU=Amount;
                                                              ESM=Importe;
                                                              FRC=Montant;
                                                              ENC=Amount];
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 61  ;   ;Amount Including VAT;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Sales Line Quote Buffer"."Amount Including VAT" WHERE (Document Type=FIELD(Document Type),
                                                                                                                           Document No.=FIELD(No.)));
                                                   CaptionML=[ENU=Amount Including Tax;
                                                              ESM=Importe IVA incl.;
                                                              FRC=Montant avec TVA;
                                                              ENC=Amount Including Tax];
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 62  ;   ;Shipping No.        ;Code20        ;CaptionML=[ENU=Shipping No.;
                                                              ESM=N§ env¡o venta;
                                                              FRC=Nø livraison;
                                                              ENC=Shipping No.] }
    { 63  ;   ;Posting No.         ;Code20        ;CaptionML=[ENU=Posting No.;
                                                              ESM=N§ sig. factura;
                                                              FRC=Nø report;
                                                              ENC=Posting No.] }
    { 64  ;   ;Last Shipping No.   ;Code20        ;TableRelation="Sales Shipment Header";
                                                   CaptionML=[ENU=Last Shipping No.;
                                                              ESM=élt. n§ env¡o venta;
                                                              FRC=Nø dern. bon de livraison;
                                                              ENC=Last Shipping No.];
                                                   Editable=No }
    { 65  ;   ;Last Posting No.    ;Code20        ;TableRelation="Sales Invoice Header";
                                                   CaptionML=[ENU=Last Posting No.;
                                                              ESM=élt. n§ factura;
                                                              FRC=Nø dernier report;
                                                              ENC=Last Posting No.];
                                                   Editable=No }
    { 66  ;   ;Prepayment No.      ;Code20        ;CaptionML=[ENU=Prepayment No.;
                                                              ESM=N§ anticipo;
                                                              FRC=Nø paiement anticip‚;
                                                              ENC=Prepayment No.] }
    { 67  ;   ;Last Prepayment No. ;Code20        ;TableRelation="Sales Invoice Header";
                                                   CaptionML=[ENU=Last Prepayment No.;
                                                              ESM=N§ £ltimo anticipo;
                                                              FRC=Dernier nø de paiement anticip‚;
                                                              ENC=Last Prepayment No.] }
    { 68  ;   ;Prepmt. Cr. Memo No.;Code20        ;CaptionML=[ENU=Prepmt. Cr. Memo No.;
                                                              ESM=N§ nota cr‚dito anticipo;
                                                              FRC=Nø note de cr‚dit pour paiement anticip‚;
                                                              ENC=Prepmt. Cr. Memo No.] }
    { 69  ;   ;Last Prepmt. Cr. Memo No.;Code20   ;TableRelation="Sales Cr.Memo Header";
                                                   CaptionML=[ENU=Last Prepmt. Cr. Memo No.;
                                                              ESM=N§ £ltima nota cr‚dito anticipo;
                                                              FRC=Dernier nø note de cr‚dit pour paiement anticip‚;
                                                              ENC=Last Prepmt. Cr. Memo No.] }
    { 70  ;   ;VAT Registration No.;Text20        ;CaptionML=[ENU=Tax Registration No.;
                                                              ESM=RFC/Curp;
                                                              FRC=Nø identification TPS/TVH;
                                                              ENC=GST/HST Registration No.] }
    { 71  ;   ;Combine Shipments   ;Boolean       ;CaptionML=[ENU=Combine Shipments;
                                                              ESM=Fact. autom tica;
                                                              FRC=Combiner les livraisons;
                                                              ENC=Combine Shipments] }
    { 73  ;   ;Reason Code         ;Code10        ;TableRelation=IF (Document Type=CONST(Order)) "Reason Code" WHERE (Order Type=CONST(Order))
                                                                 ELSE IF (Document Type=CONST(Quote)) "Reason Code" WHERE (Order Type=CONST(Quote));
                                                   OnValidate=BEGIN
                                                                //TOP030B KT ABCSI Lost Opportunities 03092015
                                                                TESTFIELD(Status,Status::Open);
                                                                //TOP230 KT ABCSI CRP 2 Fixes 06052015
                                                                IF ReasonCode.GET("Reason Code") AND (ReasonCode.Type = ReasonCode.Type::"Lost Opportunity") THEN
                                                                  "Lost Opportunity Description" := ReasonCode.Description
                                                                ELSE
                                                                  "Lost Opportunity Description" := '';
                                                                //TOP230 KT ABCSI CRP 2 Fixes 06052015
                                                                UpdateSalesLines(FIELDCAPTION("Reason Code"),FALSE);
                                                                UpdateLostOpportunity;
                                                                //TOP030B KT ABCSI Lost Opportunities 03092015
                                                              END;

                                                   CaptionML=[ENU=Reason Code;
                                                              ESM=C¢d. auditor¡a;
                                                              FRC=Code motif;
                                                              ENC=Reason Code] }
    { 74  ;   ;Gen. Bus. Posting Group;Code10     ;TableRelation="Gen. Business Posting Group";
                                                   OnValidate=BEGIN
                                                                TESTFIELD(Status,Status::Open);
                                                                IF xRec."Gen. Bus. Posting Group" <> "Gen. Bus. Posting Group" THEN BEGIN
                                                                  IF GenBusPostingGrp.ValidateVatBusPostingGroup(GenBusPostingGrp,"Gen. Bus. Posting Group") THEN
                                                                    "VAT Bus. Posting Group" := GenBusPostingGrp."Def. VAT Bus. Posting Group";
                                                                  RecreateSalesLines(FIELDCAPTION("Gen. Bus. Posting Group"));
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Gen. Bus. Posting Group;
                                                              ESM=Grupo contable negocio;
                                                              FRC=Groupe de report de march‚;
                                                              ENC=Gen. Bus. Posting Group] }
    { 75  ;   ;EU 3-Party Trade    ;Boolean       ;CaptionML=[ENU=EU 3-Party Trade;
                                                              ESM=Op. triangular;
                                                              FRC=Trans. tripartite UE;
                                                              ENC=EU 3-Party Trade] }
    { 76  ;   ;Transaction Type    ;Code10        ;TableRelation="Transaction Type";
                                                   OnValidate=BEGIN
                                                                UpdateSalesLines(FIELDCAPTION("Transaction Type"),FALSE);
                                                              END;

                                                   CaptionML=[ENU=Transaction Type;
                                                              ESM=Naturaleza transacci¢n;
                                                              FRC=Type de transaction;
                                                              ENC=Transaction Type] }
    { 77  ;   ;Transport Method    ;Code10        ;TableRelation="Transport Method";
                                                   OnValidate=BEGIN
                                                                UpdateSalesLines(FIELDCAPTION("Transport Method"),FALSE);
                                                              END;

                                                   CaptionML=[ENU=Transport Method;
                                                              ESM=Modo transporte;
                                                              FRC=Mode de transport;
                                                              ENC=Transport Method] }
    { 78  ;   ;VAT Country/Region Code;Code10     ;TableRelation=Country/Region;
                                                   CaptionML=[ENU=Tax Country/Region Code;
                                                              ESM=C¢d. IVA pa¡s/regi¢n;
                                                              FRC=Code pays/r‚gion TVA;
                                                              ENC=VAT Country/Region Code] }
    { 79  ;   ;Sell-to Customer Name;Text50       ;OnValidate=VAR
                                                                Customer@1000 : Record 18;
                                                              BEGIN
                                                                VALIDATE("Sell-to Customer No.",Customer.GetCustNo("Sell-to Customer Name"));
                                                              END;

                                                   CaptionML=[ENU=Sell-to Customer Name;
                                                              ESM=Venta a-Nombre;
                                                              FRC=Nom du client (d‚biteur);
                                                              ENC=Sell-to Customer Name] }
    { 80  ;   ;Sell-to Customer Name 2;Text50     ;CaptionML=[ENU=Sell-to Customer Name 2;
                                                              ESM=Venta a-Nombre 2;
                                                              FRC=Nom 2 du client (d‚biteur);
                                                              ENC=Sell-to Customer Name 2] }
    { 81  ;   ;Sell-to Address     ;Text50        ;OnValidate=BEGIN
                                                                UpdateShipToAddressFromSellToAddress(FIELDNO("Ship-to Address"));
                                                              END;

                                                   CaptionML=[ENU=Sell-to Address;
                                                              ESM=Venta a-Direcci¢n;
                                                              FRC=Adresse (d‚biteur);
                                                              ENC=Sell-to Address] }
    { 82  ;   ;Sell-to Address 2   ;Text50        ;OnValidate=BEGIN
                                                                UpdateShipToAddressFromSellToAddress(FIELDNO("Ship-to Address 2"));
                                                              END;

                                                   CaptionML=[ENU=Sell-to Address 2;
                                                              ESM=Venta a-Colonia;
                                                              FRC=Adresse 2 (d‚biteur);
                                                              ENC=Sell-to Address 2] }
    { 83  ;   ;Sell-to City        ;Text30        ;TableRelation=IF (Sell-to Country/Region Code=CONST()) "Post Code".City
                                                                 ELSE IF (Sell-to Country/Region Code=FILTER(<>'')) "Post Code".City WHERE (Country/Region Code=FIELD(Sell-to Country/Region Code));
                                                   OnValidate=BEGIN
                                                                PostCode.ValidateCity(
                                                                  "Sell-to City","Sell-to Post Code","Sell-to County","Sell-to Country/Region Code",(CurrFieldNo <> 0) AND GUIALLOWED);
                                                                UpdateShipToAddressFromSellToAddress(FIELDNO("Ship-to City"));
                                                              END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Sell-to City;
                                                              ESM=Venta a-Municipio/Ciudad;
                                                              FRC=Ville (d‚biteur);
                                                              ENC=Sell-to City] }
    { 84  ;   ;Sell-to Contact     ;Text50        ;OnLookup=VAR
                                                              Contact@1001 : Record 5050;
                                                            BEGIN
                                                              //<TPZ2143>
                                                              {
                                                              LookupContact("Sell-to Customer No.","Sell-to Contact No.",Contact);
                                                              IF PAGE.RUNMODAL(0,Contact) = ACTION::LookupOK THEN
                                                                VALIDATE("Sell-to Contact No.",Contact."No.");
                                                              }
                                                              //</TPZ2143>
                                                            END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Sell-to Contact;
                                                              ESM=Venta a-Atenci¢n;
                                                              FRC=Contact (d‚biteur);
                                                              ENC=Sell-to Contact] }
    { 85  ;   ;Bill-to Post Code   ;Code20        ;TableRelation="Post Code";
                                                   OnValidate=BEGIN
                                                                PostCode.ValidatePostCode(
                                                                  "Bill-to City","Bill-to Post Code","Bill-to County","Bill-to Country/Region Code",(CurrFieldNo <> 0) AND GUIALLOWED);
                                                              END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=ZIP Code;
                                                              ESM=Fact. a-C.P.;
                                                              FRC=Code postal de facturation;
                                                              ENC=Postal/ZIP Code] }
    { 86  ;   ;Bill-to County      ;Text30        ;CaptionML=[ENU=State;
                                                              ESM=Fact. a-Provincia;
                                                              FRC=Comt‚ de facturation;
                                                              ENC=Province/State] }
    { 87  ;   ;Bill-to Country/Region Code;Code10 ;TableRelation=Country/Region;
                                                   CaptionML=[ENU=Country/Region Code;
                                                              ESM=Fact. a-C¢d. pa¡s/regi¢n;
                                                              FRC=Code pays/r‚gion (facturation);
                                                              ENC=Country/Region Code] }
    { 88  ;   ;Sell-to Post Code   ;Code20        ;TableRelation=IF (Sell-to Country/Region Code=CONST()) "Post Code"
                                                                 ELSE IF (Sell-to Country/Region Code=FILTER(<>'')) "Post Code" WHERE (Country/Region Code=FIELD(Sell-to Country/Region Code));
                                                   OnValidate=BEGIN
                                                                PostCode.ValidatePostCode(
                                                                  "Sell-to City","Sell-to Post Code","Sell-to County","Sell-to Country/Region Code",(CurrFieldNo <> 0) AND GUIALLOWED);
                                                                UpdateShipToAddressFromSellToAddress(FIELDNO("Ship-to Post Code"));
                                                              END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Sell-to ZIP Code;
                                                              ESM=Venta a-C.P.;
                                                              FRC=Code postal (d‚biteur);
                                                              ENC=Sell-to Postal/ZIP Code] }
    { 89  ;   ;Sell-to County      ;Text30        ;TableRelation=County.Code WHERE (Country/Region Code=FIELD(Sell-to Country/Region Code));
                                                   OnValidate=BEGIN
                                                                UpdateShipToAddressFromSellToAddress(FIELDNO("Ship-to County"));
                                                              END;

                                                   CaptionML=[ENU=Sell-to State;
                                                              ESM=Venta a-Provincia;
                                                              FRC=Comt‚ (d‚biteur);
                                                              ENC=Sell-to Province/State] }
    { 90  ;   ;Sell-to Country/Region Code;Code10 ;TableRelation=Country/Region;
                                                   OnValidate=BEGIN
                                                                UpdateShipToAddressFromSellToAddress(FIELDNO("Ship-to Country/Region Code"));
                                                                VALIDATE("Ship-to Country/Region Code");
                                                              END;

                                                   CaptionML=[ENU=Sell-to Country/Region Code;
                                                              ESM=Venta a-C¢d. pa¡s/regi¢n;
                                                              FRC=Code pays/r‚gion (d‚biteur);
                                                              ENC=Sell-to Country/Region Code] }
    { 91  ;   ;Ship-to Post Code   ;Code20        ;TableRelation=IF (Ship-to Country/Region Code=CONST()) "Post Code"
                                                                 ELSE IF (Ship-to Country/Region Code=FILTER(<>'')) "Post Code" WHERE (Country/Region Code=FIELD(Ship-to Country/Region Code));
                                                   OnValidate=BEGIN
                                                                PostCode.ValidatePostCode(
                                                                  "Ship-to City","Ship-to Post Code","Ship-to County","Ship-to Country/Region Code",(CurrFieldNo <> 0) AND GUIALLOWED);
                                                              END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Ship-to ZIP Code;
                                                              ESM=Env¡o a-C.P.;
                                                              FRC=Code postal destinataire;
                                                              ENC=Ship-to Postal/ZIP Code] }
    { 92  ;   ;Ship-to County      ;Text30        ;TableRelation=County.Code WHERE (Country/Region Code=FIELD(Ship-to Country/Region Code));
                                                   CaptionML=[ENU=Ship-to State;
                                                              ESM=Env¡o a-Provincia;
                                                              FRC=Comt‚ destinataire;
                                                              ENC=Ship-to Province/State] }
    { 93  ;   ;Ship-to Country/Region Code;Code10 ;TableRelation=Country/Region;
                                                   OnValidate=BEGIN
                                                                // >> Shipping
                                                                IF "Ship-to Country/Region Code" <> xRec."Ship-to Country/Region Code" THEN
                                                                  IF "Shipping Agent Code" <> '' THEN BEGIN
                                                                    xRec."Shipping Agent Code" := '';
                                                                    VALIDATE("Shipping Agent Code");
                                                                  END;
                                                                // << Shipping
                                                              END;

                                                   CaptionML=[ENU=Ship-to Country/Region Code;
                                                              ESM=C¢d. pa¡s/regi¢n direcci¢n de env¡o;
                                                              FRC=Code pays/r‚gion (destinataire);
                                                              ENC=Ship-to Country/Region Code] }
    { 94  ;   ;Bal. Account Type   ;Option        ;CaptionML=[ENU=Bal. Account Type;
                                                              ESM=Tipo contrapartida;
                                                              FRC=Type compte contr“le;
                                                              ENC=Bal. Account Type];
                                                   OptionCaptionML=[ENU=G/L Account,Bank Account;
                                                                    ESM=Cuenta,Banco;
                                                                    FRC=Compte GL,Compte bancaire;
                                                                    ENC=G/L Account,Bank Account];
                                                   OptionString=G/L Account,Bank Account }
    { 97  ;   ;Exit Point          ;Code10        ;TableRelation="Entry/Exit Point";
                                                   OnValidate=BEGIN
                                                                UpdateSalesLines(FIELDCAPTION("Exit Point"),FALSE);
                                                              END;

                                                   CaptionML=[ENU=Exit Point;
                                                              ESM=Puerto/Aerop. carga;
                                                              FRC=Pays destination;
                                                              ENC=Exit Point] }
    { 98  ;   ;Correction          ;Boolean       ;CaptionML=[ENU=Correction;
                                                              ESM=Correcci¢n;
                                                              FRC=Correction;
                                                              ENC=Correction] }
    { 99  ;   ;Document Date       ;Date          ;OnValidate=BEGIN
                                                                IF xRec."Document Date" <> "Document Date" THEN
                                                                  UpdateDocumentDate := TRUE;
                                                                VALIDATE("Payment Terms Code");
                                                                VALIDATE("Prepmt. Payment Terms Code");
                                                              END;

                                                   CaptionML=[ENU=Document Date;
                                                              ESM=Fecha emisi¢n documento;
                                                              FRC=Date document;
                                                              ENC=Document Date] }
    { 100 ;   ;External Document No.;Code35       ;OnValidate=VAR
                                                                LocSalesHeader@1000000001 : Record 50005;
                                                                LocSalesInvHeader@1000000000 : Record 112;
                                                              BEGIN
                                                                // <TOP450>
                                                                SalesSetup.GET;
                                                                IF NOT SalesSetup."Dupl. Ext. Doc. No. Warning" THEN
                                                                  EXIT;
                                                                IF ("Document Type" = "Document Type"::Order) AND
                                                                   ("Sell-to Customer No." <> '') AND
                                                                   ("External Document No." <> '') AND
                                                                   (CurrFieldNo = FIELDNO("External Document No."))
                                                                THEN BEGIN
                                                                  LocSalesHeader.RESET;
                                                                  LocSalesHeader.SETRANGE("Document Type","Document Type"::Order);
                                                                  LocSalesHeader.SETFILTER("No.",'<>%1',"No.");
                                                                  LocSalesHeader.SETRANGE("Sell-to Customer No.","Sell-to Customer No.");
                                                                  LocSalesHeader.SETRANGE("External Document No.","External Document No.");
                                                                  IF LocSalesHeader.FINDFIRST THEN
                                                                    IF NOT
                                                                         CONFIRM(
                                                                           Text51002,
                                                                           FALSE,
                                                                           FIELDCAPTION("External Document No."),
                                                                           "External Document No.",
                                                                           LocSalesHeader."No.",
                                                                           "Sell-to Customer No.")
                                                                    THEN
                                                                      ERROR('');
                                                                  LocSalesInvHeader.RESET;
                                                                  LocSalesInvHeader.SETRANGE("Sell-to Customer No.","Sell-to Customer No.");
                                                                  LocSalesInvHeader.SETRANGE("External Document No.","External Document No.");
                                                                  IF LocSalesInvHeader.FINDFIRST THEN
                                                                    IF NOT
                                                                         CONFIRM(
                                                                           Text51003,
                                                                           FALSE,
                                                                           FIELDCAPTION("External Document No."),
                                                                           "External Document No.",
                                                                           LocSalesInvHeader."No.",
                                                                           "Sell-to Customer No.")
                                                                    THEN
                                                                      ERROR('');
                                                                END;
                                                                // </TOP450>
                                                              END;

                                                   CaptionML=[ENU=Customer PO No.;
                                                              ESM=N§ documento externo;
                                                              FRC=Nø document externe;
                                                              ENC=External Document No.] }
    { 101 ;   ;Area                ;Code10        ;TableRelation=Area;
                                                   OnValidate=BEGIN
                                                                UpdateSalesLines(FIELDCAPTION(Area),FALSE);
                                                              END;

                                                   CaptionML=[ENU=Area;
                                                              ESM=C¢d. provincia;
                                                              FRC=Zone;
                                                              ENC=Area] }
    { 102 ;   ;Transaction Specification;Code10   ;TableRelation="Transaction Specification";
                                                   OnValidate=BEGIN
                                                                UpdateSalesLines(FIELDCAPTION("Transaction Specification"),FALSE);
                                                              END;

                                                   CaptionML=[ENU=Transaction Specification;
                                                              ESM=Especificaci¢n transacci¢n;
                                                              FRC=Sp‚cification transaction;
                                                              ENC=Transaction Specification] }
    { 104 ;   ;Payment Method Code ;Code10        ;TableRelation="Payment Method";
                                                   OnValidate=VAR
                                                                SEPADirectDebitMandate@1000 : Record 1230;
                                                              BEGIN
                                                                PaymentMethod.INIT;
                                                                IF "Payment Method Code" <> '' THEN
                                                                  PaymentMethod.GET("Payment Method Code");
                                                                IF PaymentMethod."Direct Debit" THEN BEGIN
                                                                  "Direct Debit Mandate ID" := SEPADirectDebitMandate.GetDefaultMandate("Bill-to Customer No.","Due Date");
                                                                  IF "Payment Terms Code" = '' THEN
                                                                    "Payment Terms Code" := PaymentMethod."Direct Debit Pmt. Terms Code";
                                                                END ELSE
                                                                  "Direct Debit Mandate ID" := '';
                                                                "Bal. Account Type" := PaymentMethod."Bal. Account Type";
                                                                "Bal. Account No." := PaymentMethod."Bal. Account No.";
                                                                IF "Bal. Account No." <> '' THEN BEGIN
                                                                  TESTFIELD("Applies-to Doc. No.",'');
                                                                  TESTFIELD("Applies-to ID",'');
                                                                  CLEAR("Payment Service Set ID");
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Payment Method Code;
                                                              ESM=C¢d. forma pago;
                                                              FRC=Code mode de paiement;
                                                              ENC=Payment Method Code] }
    { 105 ;   ;Shipping Agent Code ;Code10        ;TableRelation="Shipping Agent";
                                                   OnValidate=VAR
                                                                OWRMgt@1000000000 : Codeunit 14002863;
                                                              BEGIN
                                                                //<TPZ1556>
                                                                //TMEI BEG 070115 Allow to change agent for released order
                                                                //TESTFIELD(Status,Status::Open);
                                                                //</TPZ1556>
                                                                IF xRec."Shipping Agent Code" = "Shipping Agent Code" THEN
                                                                  EXIT;

                                                                "Shipping Agent Service Code" := '';
                                                                GetShippingTime(FIELDNO("Shipping Agent Code"));
                                                                UpdateSalesLines(FIELDCAPTION("Shipping Agent Code"),CurrFieldNo <> 0);
                                                                // >> Shipping
                                                                SalesSetup.GET;
                                                                IF ("Shipping Agent Code" <> xRec."Shipping Agent Code") AND
                                                                   (xRec."Shipping Agent Code" <> '') AND SalesSetup."Enable Shipping"
                                                                THEN BEGIN
                                                                  IF CurrFieldNo = FIELDNO("Shipping Agent Code") THEN BEGIN
                                                                    DeleteShippingAgentOptionPage;

                                                                    Package.RESET;
                                                                    Package.SETCURRENTKEY("Source Type","Source Subtype","Source ID");
                                                                    Package.SETRANGE("Source Type",DATABASE::"Sales Header Buffer");
                                                                    Package.SETRANGE("Source Subtype","Document Type");
                                                                    Package.SETRANGE("Source ID","No.");
                                                                    IF Package.FIND('-') THEN
                                                                      MESSAGE(Text14000701);
                                                                  END;

                                                                  VALIDATE("E-Ship Agent Service",'');
                                                                END;

                                                                IF ("Shipping Agent Code" <> '') AND SalesSetup."Enable Shipping" THEN BEGIN
                                                                  ShippingAgent.GET("Shipping Agent Code");
                                                                  "World Wide Service" :=
                                                                     EShipAgentService.WorldWideService(ShippingAgent,"Ship-to Country/Region Code");
                                                                  VALIDATE(
                                                                    "E-Ship Agent Service",
                                                                    EShipAgentService.DefaultShipAgentService(ShippingAgent,"Ship-to Country/Region Code"));
                                                                //<TPZ2447>
                                                                {
                                                                  IF CurrFieldNo = FIELDNO("Shipping Agent Code") THEN
                                                                    EShipAgentService.CheckNameAddressSalesHeader(Rec,"Shipping Agent Code");
                                                                END ELSE
                                                                  "World Wide Service" := FALSE;
                                                                }
                                                                //</TPZ2447>
                                                                IF "Shipping Agent Code" <> xRec."Shipping Agent Code" THEN
                                                                  IF "Shipping Payment Type" = "Shipping Payment Type"::Prepaid THEN
                                                                    VALIDATE("Third Party Ship. Account No.",'')
                                                                  ELSE
                                                                    IF ShippingAccount.GetPrimaryShippingAccountNo(
                                                                         "Shipping Agent Code",ShippingAccount."Ship-to Type"::Customer,
                                                                         "Sell-to Customer No.","Ship-to Code")
                                                                    THEN
                                                                      VALIDATE("Third Party Ship. Account No.",ShippingAccount."Account No.")
                                                                    ELSE
                                                                      VALIDATE("Third Party Ship. Account No.",'');
                                                                // << Shipping

                                                                // <TPZ1187>
                                                                //<TPZ2028>
                                                                {
                                                                IF ("Shipping Agent Code" <> xRec."Shipping Agent Code") AND
                                                                   ("Shipping Agent Code" <> '') AND
                                                                   SalesSetup."Enable Shipping"
                                                                THEN
                                                                  "Free Freight" := xRec."Free Freight";
                                                                }
                                                                //<TPZ2028>
                                                                // </TPZ1187>

                                                                //<TPZ1446>
                                                                IF ("Free Freight" = FALSE) AND ("Free Freight Reason Code" <> '') THEN
                                                                  "Free Freight Reason Code" := '';
                                                                //<TPZ1446>

                                                                //<TPZ1556>
                                                                //TM BEG 070115 Allow to change agent for released order
                                                                //IF Statusbefore = Status::Released THEN
                                                                //  ReleaseSO.RUN(Rec);
                                                                //TM END 070115

                                                                //OWRMgt.UpdateWRShippingAgentInfo(Rec);
                                                                ///TPZ1556>
                                                                END;
                                                              END;

                                                   AccessByPermission=TableData 5790=R;
                                                   CaptionML=[ENU=Shipping Agent Code;
                                                              ESM=C¢d. transportista;
                                                              FRC=Code agent de livraison;
                                                              ENC=Shipping Agent Code] }
    { 106 ;   ;Package Tracking No.;Text30        ;CaptionML=[ENU=Package Tracking No.;
                                                              ESM=N§ seguimiento bulto;
                                                              FRC=Nø de tra‡abilit‚;
                                                              ENC=Package Tracking No.] }
    { 107 ;   ;No. Series          ;Code10        ;TableRelation="No. Series";
                                                   CaptionML=[ENU=No. Series;
                                                              ESM=Nos. serie;
                                                              FRC=S‚ries de nø;
                                                              ENC=No. Series];
                                                   Editable=No }
    { 108 ;   ;Posting No. Series  ;Code10        ;TableRelation="No. Series";
                                                   OnValidate=BEGIN
                                                                IF "Posting No. Series" <> '' THEN BEGIN
                                                                  SalesSetup.GET;
                                                                  TestNoSeries;
                                                                  NoSeriesMgt.TestSeries(GetPostingNoSeriesCode,"Posting No. Series");
                                                                END;
                                                                TESTFIELD("Posting No.",'');
                                                              END;

                                                   OnLookup=BEGIN
                                                              WITH SalesHeader DO BEGIN
                                                                SalesHeader := Rec;
                                                                SalesSetup.GET;
                                                                TestNoSeries;
                                                                IF NoSeriesMgt.LookupSeries(GetPostingNoSeriesCode,"Posting No. Series") THEN
                                                                  VALIDATE("Posting No. Series");
                                                                Rec := SalesHeader;
                                                              END;
                                                            END;

                                                   CaptionML=[ENU=Posting No. Series;
                                                              ESM=N§ serie registro;
                                                              FRC=S‚ries de nø report;
                                                              ENC=Posting No. Series] }
    { 109 ;   ;Shipping No. Series ;Code10        ;TableRelation="No. Series";
                                                   OnValidate=BEGIN
                                                                IF "Shipping No. Series" <> '' THEN BEGIN
                                                                  SalesSetup.GET;
                                                                  SalesSetup.TESTFIELD("Posted Shipment Nos.");
                                                                  NoSeriesMgt.TestSeries(SalesSetup."Posted Shipment Nos.","Shipping No. Series");
                                                                END;
                                                                TESTFIELD("Shipping No.",'');
                                                              END;

                                                   OnLookup=BEGIN
                                                              WITH SalesHeader DO BEGIN
                                                                SalesHeader := Rec;
                                                                SalesSetup.GET;
                                                                SalesSetup.TESTFIELD("Posted Shipment Nos.");
                                                                IF NoSeriesMgt.LookupSeries(SalesSetup."Posted Shipment Nos.","Shipping No. Series") THEN
                                                                  VALIDATE("Shipping No. Series");
                                                                Rec := SalesHeader;
                                                              END;
                                                            END;

                                                   CaptionML=[ENU=Shipping No. Series;
                                                              ESM=N§  serie de env¡os;
                                                              FRC=S‚ries de nø livraison;
                                                              ENC=Shipping No. Series] }
    { 114 ;   ;Tax Area Code       ;Code20        ;TableRelation="Tax Area";
                                                   OnValidate=BEGIN
                                                                TESTFIELD(Status,Status::Open);
                                                                ValidateTaxAreaCode;
                                                                UpdateSalesLines(FIELDCAPTION("Tax Area Code"),FALSE);
                                                              END;

                                                   ValidateTableRelation=No;
                                                   CaptionML=[ENU=Tax Area Code;
                                                              ESM=C¢d.  rea impuesto;
                                                              FRC=Code de r‚gion fiscale;
                                                              ENC=Tax Area Code] }
    { 115 ;   ;Tax Liable          ;Boolean       ;OnValidate=BEGIN
                                                                TESTFIELD(Status,Status::Open);
                                                                UpdateSalesLines(FIELDCAPTION("Tax Liable"),FALSE);
                                                              END;

                                                   CaptionML=[ENU=Tax Liable;
                                                              ESM=Sujeto a impuesto;
                                                              FRC=Imposable;
                                                              ENC=Tax Liable] }
    { 116 ;   ;VAT Bus. Posting Group;Code10      ;TableRelation="VAT Business Posting Group";
                                                   OnValidate=BEGIN
                                                                TESTFIELD(Status,Status::Open);
                                                                IF xRec."VAT Bus. Posting Group" <> "VAT Bus. Posting Group" THEN
                                                                  RecreateSalesLines(FIELDCAPTION("VAT Bus. Posting Group"));
                                                              END;

                                                   CaptionML=[ENU=Tax Bus. Posting Group;
                                                              ESM=Grupo registro IVA neg.;
                                                              FRC=Groupe de reports de taxe sur la valeur ajout‚e de l'entreprise;
                                                              ENC=Tax Bus. Posting Group] }
    { 117 ;   ;Reserve             ;Option        ;InitValue=Optional;
                                                   AccessByPermission=TableData 27=R;
                                                   CaptionML=[ENU=Reserve;
                                                              ESM=Reserva;
                                                              FRC=R‚server;
                                                              ENC=Reserve];
                                                   OptionCaptionML=[ENU=Never,Optional,Always;
                                                                    ESM=Nunca,Opcional,Siempre;
                                                                    FRC=Jamais,Optionnel,Toujours;
                                                                    ENC=Never,Optional,Always];
                                                   OptionString=Never,Optional,Always }
    { 118 ;   ;Applies-to ID       ;Code50        ;OnValidate=VAR
                                                                TempCustLedgEntry@1000 : TEMPORARY Record 21;
                                                                CustEntrySetApplID@1001 : Codeunit 101;
                                                              BEGIN
                                                                IF "Applies-to ID" <> '' THEN
                                                                  TESTFIELD("Bal. Account No.",'');
                                                                IF ("Applies-to ID" <> xRec."Applies-to ID") AND (xRec."Applies-to ID" <> '') THEN BEGIN
                                                                  CustLedgEntry.SETCURRENTKEY("Customer No.",Open);
                                                                  CustLedgEntry.SETRANGE("Customer No.","Bill-to Customer No.");
                                                                  CustLedgEntry.SETRANGE(Open,TRUE);
                                                                  CustLedgEntry.SETRANGE("Applies-to ID",xRec."Applies-to ID");
                                                                  IF CustLedgEntry.FINDFIRST THEN
                                                                    CustEntrySetApplID.SetApplId(CustLedgEntry,TempCustLedgEntry,'');
                                                                  CustLedgEntry.RESET;
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Applies-to ID;
                                                              ESM=Liq. por id.;
                                                              FRC=Code affect‚ …;
                                                              ENC=Applies-to ID] }
    { 119 ;   ;VAT Base Discount % ;Decimal       ;OnValidate=BEGIN
                                                                // >> EDI
                                                                IF EDITemp THEN
                                                                  EXIT;
                                                                // << EDI

                                                                IF NOT (CurrFieldNo IN [0,FIELDNO("Posting Date"),FIELDNO("Document Date")]) THEN
                                                                  TESTFIELD(Status,Status::Open);
                                                                GLSetup.GET;
                                                                IF "VAT Base Discount %" > GLSetup."VAT Tolerance %" THEN
                                                                  ERROR(
                                                                    Text007,
                                                                    FIELDCAPTION("VAT Base Discount %"),
                                                                    GLSetup.FIELDCAPTION("VAT Tolerance %"),
                                                                    GLSetup.TABLECAPTION);

                                                                IF ("VAT Base Discount %" = xRec."VAT Base Discount %") AND
                                                                   (CurrFieldNo <> 0)
                                                                THEN
                                                                  EXIT;

                                                                SalesLine.SETRANGE("Document Type","Document Type");
                                                                SalesLine.SETRANGE("Document No.","No.");
                                                                SalesLine.SETFILTER(Type,'<>%1',SalesLine.Type::" ");
                                                                SalesLine.SETFILTER(Quantity,'<>0');
                                                                SalesLine.LOCKTABLE;
                                                                LOCKTABLE;
                                                                IF SalesLine.FINDSET THEN BEGIN
                                                                  MODIFY;
                                                                  REPEAT
                                                                    IF (SalesLine."Quantity Invoiced" <> SalesLine.Quantity) OR
                                                                       ("Shipping Advice" <> "Shipping Advice"::Partial) OR
                                                                       (SalesLine.Type <> SalesLine.Type::"Charge (Item)") OR
                                                                       (CurrFieldNo <> 0)
                                                                    THEN BEGIN
                                                                      SalesLine.UpdateAmounts;
                                                                      SalesLine.MODIFY;
                                                                    END;
                                                                  UNTIL SalesLine.NEXT = 0;
                                                                END;
                                                                SalesLine.RESET;
                                                              END;

                                                   CaptionML=[ENU=VAT Base Discount %;
                                                              ESM=% Dto. base IVA;
                                                              FRC=% escompte base TVA;
                                                              ENC=VAT Base Discount %];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0;
                                                   MaxValue=100 }
    { 120 ;   ;Status              ;Option        ;CaptionML=[ENU=Status;
                                                              ESM=Estado;
                                                              FRC=tat;
                                                              ENC=Status];
                                                   OptionCaptionML=[ENU=Open,Released,Pending Approval,Pending Prepayment;
                                                                    ESM=Abierto,Lanzado,Aprobaci¢n pendiente,Anticipo pendiente;
                                                                    FRC=Ouvert,Lib‚r‚,Approbation en attente,Paiement anticip‚ en attente;
                                                                    ENC=Open,Released,Pending Approval,Pending Prepayment];
                                                   OptionString=Open,Released,Pending Approval,Pending Prepayment;
                                                   Editable=No }
    { 121 ;   ;Invoice Discount Calculation;Option;CaptionML=[ENU=Invoice Discount Calculation;
                                                              ESM=C lculo descuento factura;
                                                              FRC=Calcul escompte facture;
                                                              ENC=Invoice Discount Calculation];
                                                   OptionCaptionML=[ENU=None,%,Amount;
                                                                    ESM=Ninguno,%,Importe;
                                                                    FRC=Aucun,%,Montant;
                                                                    ENC=None,%,Amount];
                                                   OptionString=None,%,Amount;
                                                   Editable=No }
    { 122 ;   ;Invoice Discount Value;Decimal     ;CaptionML=[ENU=Invoice Discount Value;
                                                              ESM=Valor descuento factura;
                                                              FRC=Valeur escompte facture;
                                                              ENC=Invoice Discount Value];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 123 ;   ;Send IC Document    ;Boolean       ;OnValidate=BEGIN
                                                                IF "Send IC Document" THEN BEGIN
                                                                  IF "Bill-to IC Partner Code" = '' THEN
                                                                    TESTFIELD("Sell-to IC Partner Code");
                                                                  TESTFIELD("IC Direction","IC Direction"::Outgoing);
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Send IC Document;
                                                              ESM=Enviar documento IC;
                                                              FRC=Envoyer document IC;
                                                              ENC=Send IC Document] }
    { 124 ;   ;IC Status           ;Option        ;CaptionML=[ENU=IC Status;
                                                              ESM=Estado socio IC;
                                                              FRC=tat IC;
                                                              ENC=IC Status];
                                                   OptionCaptionML=[ENU=New,Pending,Sent;
                                                                    ESM=Nuevo,Pendiente,Enviado;
                                                                    FRC=Nouveau,En attente,Envoy‚;
                                                                    ENC=New,Pending,Sent];
                                                   OptionString=New,Pending,Sent }
    { 125 ;   ;Sell-to IC Partner Code;Code20     ;TableRelation="IC Partner";
                                                   CaptionML=[ENU=Sell-to IC Partner Code;
                                                              ESM=C¢digo IC asociada de venta;
                                                              FRC=Code partenaire IC (d‚biteur);
                                                              ENC=Sell-to IC Partner Code];
                                                   Editable=No }
    { 126 ;   ;Bill-to IC Partner Code;Code20     ;TableRelation="IC Partner";
                                                   CaptionML=[ENU=IC Partner Code;
                                                              ESM=C¢digo IC asociada facturaci¢n;
                                                              FRC=Code de partenaire IC;
                                                              ENC=IC Partner Code];
                                                   Editable=No }
    { 129 ;   ;IC Direction        ;Option        ;OnValidate=BEGIN
                                                                IF "IC Direction" = "IC Direction"::Incoming THEN
                                                                  "Send IC Document" := FALSE;
                                                              END;

                                                   CaptionML=[ENU=IC Direction;
                                                              ESM=Direcci¢n env¡o IC;
                                                              FRC=Direction IC;
                                                              ENC=IC Direction];
                                                   OptionCaptionML=[ENU=Outgoing,Incoming;
                                                                    ESM=Saliente,Entrante;
                                                                    FRC=Sortant,Entrant;
                                                                    ENC=Outgoing,Incoming];
                                                   OptionString=Outgoing,Incoming }
    { 130 ;   ;Prepayment %        ;Decimal       ;OnValidate=BEGIN
                                                                IF xRec."Prepayment %" <> "Prepayment %" THEN
                                                                  UpdateSalesLines(FIELDCAPTION("Prepayment %"),CurrFieldNo <> 0);
                                                              END;

                                                   CaptionML=[ENU=Prepayment %;
                                                              ESM=% anticipo;
                                                              FRC=% paiement anticip‚;
                                                              ENC=Prepayment %];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0;
                                                   MaxValue=100 }
    { 131 ;   ;Prepayment No. Series;Code10       ;TableRelation="No. Series";
                                                   OnValidate=BEGIN
                                                                IF "Prepayment No. Series" <> '' THEN BEGIN
                                                                  SalesSetup.GET;
                                                                  SalesSetup.TESTFIELD("Posted Prepmt. Inv. Nos.");
                                                                  NoSeriesMgt.TestSeries(GetPostingPrepaymentNoSeriesCode,"Prepayment No. Series");
                                                                END;
                                                                TESTFIELD("Prepayment No.",'');
                                                              END;

                                                   OnLookup=BEGIN
                                                              WITH SalesHeader DO BEGIN
                                                                SalesHeader := Rec;
                                                                SalesSetup.GET;
                                                                SalesSetup.TESTFIELD("Posted Prepmt. Inv. Nos.");
                                                                IF NoSeriesMgt.LookupSeries(GetPostingPrepaymentNoSeriesCode,"Prepayment No. Series") THEN
                                                                  VALIDATE("Prepayment No. Series");
                                                                Rec := SalesHeader;
                                                              END;
                                                            END;

                                                   CaptionML=[ENU=Prepayment No. Series;
                                                              ESM=N§ serie anticipo;
                                                              FRC=Nø s‚rie de paiement anticip‚;
                                                              ENC=Prepayment No. Series] }
    { 132 ;   ;Compress Prepayment ;Boolean       ;InitValue=Yes;
                                                   CaptionML=[ENU=Compress Prepayment;
                                                              ESM=Compresi¢n anticipo;
                                                              FRC=Compression paiement anticip‚;
                                                              ENC=Compress Prepayment] }
    { 133 ;   ;Prepayment Due Date ;Date          ;CaptionML=[ENU=Prepayment Due Date;
                                                              ESM=Fecha vencimiento anticipo;
                                                              FRC=ch‚ance de paiement anticip‚;
                                                              ENC=Prepayment Due Date] }
    { 134 ;   ;Prepmt. Cr. Memo No. Series;Code10 ;TableRelation="No. Series";
                                                   OnValidate=BEGIN
                                                                IF "Prepmt. Cr. Memo No." <> '' THEN BEGIN
                                                                  SalesSetup.GET;
                                                                  SalesSetup.TESTFIELD("Posted Prepmt. Cr. Memo Nos.");
                                                                  NoSeriesMgt.TestSeries(GetPostingPrepaymentNoSeriesCode,"Prepmt. Cr. Memo No. Series");
                                                                END;
                                                                TESTFIELD("Prepmt. Cr. Memo No.",'');
                                                              END;

                                                   OnLookup=BEGIN
                                                              WITH SalesHeader DO BEGIN
                                                                SalesHeader := Rec;
                                                                SalesSetup.GET;
                                                                SalesSetup.TESTFIELD("Posted Prepmt. Cr. Memo Nos.");
                                                                IF NoSeriesMgt.LookupSeries(GetPostingPrepaymentNoSeriesCode,"Prepmt. Cr. Memo No. Series") THEN
                                                                  VALIDATE("Prepmt. Cr. Memo No. Series");
                                                                Rec := SalesHeader;
                                                              END;
                                                            END;

                                                   CaptionML=[ENU=Prepmt. Cr. Memo No. Series;
                                                              ESM=N§ serie nota cr‚dito anticipo;
                                                              FRC=Nø s‚rie de note de cr‚dit pour paiement anticip‚;
                                                              ENC=Prepmt. Cr. Memo No. Series] }
    { 135 ;   ;Prepmt. Posting Description;Text50 ;CaptionML=[ENU=Prepmt. Posting Description;
                                                              ESM=Texto registro anticipo;
                                                              FRC=Description du report de paiement anticip‚;
                                                              ENC=Prepmt. Posting Description] }
    { 138 ;   ;Prepmt. Pmt. Discount Date;Date    ;CaptionML=[ENU=Prepmt. Pmt. Discount Date;
                                                              ESM=Fecha dto. P.P. anticipo;
                                                              FRC=Date d'escompte de paiement anticip‚;
                                                              ENC=Prepmt. Pmt. Discount Date] }
    { 139 ;   ;Prepmt. Payment Terms Code;Code10  ;TableRelation="Payment Terms";
                                                   OnValidate=VAR
                                                                PaymentTerms@1000 : Record 3;
                                                              BEGIN
                                                                IF ("Prepmt. Payment Terms Code" <> '') AND ("Document Date" <> 0D) THEN BEGIN
                                                                  PaymentTerms.GET("Prepmt. Payment Terms Code");
                                                                  IF IsCreditDocType AND NOT PaymentTerms."Calc. Pmt. Disc. on Cr. Memos" THEN BEGIN
                                                                    VALIDATE("Prepayment Due Date","Document Date");
                                                                    VALIDATE("Prepmt. Pmt. Discount Date",0D);
                                                                    VALIDATE("Prepmt. Payment Discount %",0);
                                                                  END ELSE BEGIN
                                                                    "Prepayment Due Date" := CALCDATE(PaymentTerms."Due Date Calculation","Document Date");
                                                                    "Prepmt. Pmt. Discount Date" := CALCDATE(PaymentTerms."Discount Date Calculation","Document Date");
                                                                    IF NOT UpdateDocumentDate THEN
                                                                      VALIDATE("Prepmt. Payment Discount %",PaymentTerms."Discount %")
                                                                  END;
                                                                END ELSE BEGIN
                                                                  VALIDATE("Prepayment Due Date","Document Date");
                                                                  IF NOT UpdateDocumentDate THEN BEGIN
                                                                    VALIDATE("Prepmt. Pmt. Discount Date",0D);
                                                                    VALIDATE("Prepmt. Payment Discount %",0);
                                                                  END;
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Prepmt. Payment Terms Code;
                                                              ESM=C¢digo t‚rminos anticipo;
                                                              FRC=Code modal. rŠgl. paiem. antic.;
                                                              ENC=Prepmt. Payment Terms Code] }
    { 140 ;   ;Prepmt. Payment Discount %;Decimal ;OnValidate=BEGIN
                                                                IF NOT (CurrFieldNo IN [0,FIELDNO("Posting Date"),FIELDNO("Document Date")]) THEN
                                                                  TESTFIELD(Status,Status::Open);
                                                                GLSetup.GET;
                                                                IF "Payment Discount %" < GLSetup."VAT Tolerance %" THEN
                                                                  "VAT Base Discount %" := "Payment Discount %"
                                                                ELSE
                                                                  "VAT Base Discount %" := GLSetup."VAT Tolerance %";
                                                                VALIDATE("VAT Base Discount %");
                                                              END;

                                                   CaptionML=[ENU=Prepmt. Payment Discount %;
                                                              ESM=% descuento anticipo;
                                                              FRC=% escompte rŠgl. paiem. antic.;
                                                              ENC=Prepmt. Payment Discount %];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0;
                                                   MaxValue=100 }
    { 151 ;   ;Quote No.           ;Code20        ;CaptionML=[ENU=Quote No.;
                                                              ESM=N§ cotizaci¢n;
                                                              FRC=Nø devis;
                                                              ENC=Quote No.];
                                                   Editable=No }
    { 160 ;   ;Job Queue Status    ;Option        ;OnLookup=VAR
                                                              JobQueueEntry@1000 : Record 472;
                                                            BEGIN
                                                              IF "Job Queue Status" = "Job Queue Status"::" " THEN
                                                                EXIT;
                                                              JobQueueEntry.ShowStatusMsg("Job Queue Entry ID");
                                                            END;

                                                   CaptionML=[ENU=Job Queue Status;
                                                              ESM=Estado de cola de proyectos;
                                                              FRC=tat de la file d'attente des travaux;
                                                              ENC=Job Queue Status];
                                                   OptionCaptionML=[ENU=" ,Scheduled for Posting,Error,Posting";
                                                                    ESM=" ,Programado para registro,Error,Registro";
                                                                    FRC=" ,Planifi‚ pour le report,Erreur,Report";
                                                                    ENC=" ,Scheduled for Posting,Error,Posting"];
                                                   OptionString=[ ,Scheduled for Posting,Error,Posting];
                                                   Editable=No }
    { 161 ;   ;Job Queue Entry ID  ;GUID          ;CaptionML=[ENU=Job Queue Entry ID;
                                                              ESM=Id. mov. cola proyecto;
                                                              FRC=Code ‚criture file d'attente des travaux;
                                                              ENC=Job Queue Entry ID];
                                                   Editable=No }
    { 165 ;   ;Incoming Document Entry No.;Integer;TableRelation="Incoming Document";
                                                   OnValidate=VAR
                                                                IncomingDocument@1000 : Record 130;
                                                              BEGIN

                                                                //<TPZ2447>
                                                                {
                                                                IF "Incoming Document Entry No." = xRec."Incoming Document Entry No." THEN
                                                                  EXIT;
                                                                IF "Incoming Document Entry No." = 0 THEN
                                                                  IncomingDocument.RemoveReferenceToWorkingDocument(xRec."Incoming Document Entry No.")
                                                                ELSE
                                                                  IncomingDocument.SetSalesDoc(Rec);
                                                                }
                                                                //</TPZ2447>
                                                              END;

                                                   CaptionML=[ENU=Incoming Document Entry No.;
                                                              ESM=N§ mov. de documentos entrantes;
                                                              FRC=Nø de s‚quence du document entrant;
                                                              ENC=Incoming Document Entry No.] }
    { 200 ;   ;Work Description    ;BLOB          ;CaptionML=[ENU=Work Description;
                                                              ESM=Descripci¢n del trabajo;
                                                              FRC=Description du travail;
                                                              ENC=Work Description] }
    { 480 ;   ;Dimension Set ID    ;Integer       ;TableRelation="Dimension Set Entry";
                                                   OnLookup=BEGIN
                                                              ShowDocDim;
                                                            END;

                                                   CaptionML=[ENU=Dimension Set ID;
                                                              ESM=Id. grupo dimensiones;
                                                              FRC=Code ensemble de dimensions;
                                                              ENC=Dimension Set ID];
                                                   Editable=No }
    { 600 ;   ;Payment Service Set ID;Integer     ;CaptionML=[ENU=Payment Service Set ID;
                                                              ESM=Id. de conjunto de servicios de pago;
                                                              FRC=Code ensemble de services de paiement;
                                                              ENC=Payment Service Set ID] }
    { 1200;   ;Direct Debit Mandate ID;Code35     ;TableRelation="SEPA Direct Debit Mandate" WHERE (Customer No.=FIELD(Bill-to Customer No.),
                                                                                                    Closed=CONST(No),
                                                                                                    Blocked=CONST(No));
                                                   CaptionML=[ENU=Direct Debit Mandate ID;
                                                              ESM=Id. de orden de domiciliaci¢n de adeudo directo;
                                                              FRC=ID mandat de pr‚lŠvement;
                                                              ENC=Direct Debit Mandate ID] }
    { 1305;   ;Invoice Discount Amount;Decimal    ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Sales Line Quote Buffer"."Inv. Discount Amount" WHERE (Document No.=FIELD(No.),
                                                                                                                           Document Type=FIELD(Document Type)));
                                                   CaptionML=[ENU=Invoice Discount Amount;
                                                              ESM=Importe descuento factura;
                                                              FRC=Montant d'escompte de la facture;
                                                              ENC=Invoice Discount Amount];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 5043;   ;No. of Archived Versions;Integer   ;FieldClass=FlowField;
                                                   CalcFormula=Max("Sales Header Archive"."Version No." WHERE (Document Type=FIELD(Document Type),
                                                                                                               No.=FIELD(No.),
                                                                                                               Doc. No. Occurrence=FIELD(Doc. No. Occurrence)));
                                                   CaptionML=[ENU=No. of Archived Versions;
                                                              ESM=N§ de versiones archivadas;
                                                              FRC=Nbre versions archiv‚es;
                                                              ENC=No. of Archived Versions];
                                                   Editable=No }
    { 5048;   ;Doc. No. Occurrence ;Integer       ;CaptionML=[ENU=Doc. No. Occurrence;
                                                              ESM=Ocurrencia N§ doc.;
                                                              FRC=Occurrence nø doc.;
                                                              ENC=Doc. No. Occurrence] }
    { 5050;   ;Campaign No.        ;Code20        ;TableRelation=Campaign;
                                                   OnValidate=BEGIN
                                                                CreateDim(
                                                                  DATABASE::Campaign,"Campaign No.",
                                                                  DATABASE::Customer,"Bill-to Customer No.",
                                                                  DATABASE::"Salesperson/Purchaser","Salesperson Code",
                                                                  DATABASE::"Responsibility Center","Responsibility Center",
                                                                  DATABASE::"Customer Template","Bill-to Customer Template Code");

                                                                // <TPZ572>
                                                                //TOP020 KT ABCSI Sales Orders by Division 02042015
                                                                //IF "Shortcut Dimension 5 Code" <> '' THEN
                                                                //  VALIDATE("Shortcut Dimension 5 Code");
                                                                ValidateShortcutDimCode(5,"Shortcut Dimension 5 Code");
                                                                //TOP020 KT ABCSI Sales Orders by Division 02042015
                                                                // </TPZ572>
                                                              END;

                                                   CaptionML=[ENU=Campaign No.;
                                                              ESM=N§ campa¤a;
                                                              FRC=Nø promotion;
                                                              ENC=Campaign No.] }
    { 5051;   ;Sell-to Customer Template Code;Code10;
                                                   TableRelation="Customer Template";
                                                   OnValidate=VAR
                                                                SellToCustTemplate@1000 : Record 5105;
                                                              BEGIN
                                                                TESTFIELD("Document Type","Document Type"::Quote);
                                                                TESTFIELD(Status,Status::Open);

                                                                IF NOT InsertMode AND
                                                                   ("Sell-to Customer Template Code" <> xRec."Sell-to Customer Template Code") AND
                                                                   (xRec."Sell-to Customer Template Code" <> '')
                                                                THEN BEGIN
                                                                  IF HideValidationDialog THEN
                                                                    Confirmed := TRUE
                                                                  ELSE
                                                                    Confirmed := CONFIRM(ConfirmChangeQst,FALSE,FIELDCAPTION("Sell-to Customer Template Code"));
                                                                  IF Confirmed THEN BEGIN
                                                                    IF InitFromTemplate("Sell-to Customer Template Code",FIELDCAPTION("Sell-to Customer Template Code")) THEN
                                                                      EXIT
                                                                  END ELSE BEGIN
                                                                    "Sell-to Customer Template Code" := xRec."Sell-to Customer Template Code";
                                                                    EXIT;
                                                                  END;
                                                                END;

                                                                IF SellToCustTemplate.GET("Sell-to Customer Template Code") THEN BEGIN
                                                                  IF GLSetup."VAT in Use" THEN
                                                                    SellToCustTemplate.TESTFIELD("Gen. Bus. Posting Group");
                                                                  "Gen. Bus. Posting Group" := SellToCustTemplate."Gen. Bus. Posting Group";
                                                                  "VAT Bus. Posting Group" := SellToCustTemplate."VAT Bus. Posting Group";
                                                                  IF "Bill-to Customer No." = '' THEN
                                                                    VALIDATE("Bill-to Customer Template Code","Sell-to Customer Template Code");
                                                                END;

                                                                IF NOT InsertMode AND
                                                                   ((xRec."Sell-to Customer Template Code" <> "Sell-to Customer Template Code") OR
                                                                    (xRec."Currency Code" <> "Currency Code"))
                                                                THEN
                                                                  RecreateSalesLines(FIELDCAPTION("Sell-to Customer Template Code"));
                                                              END;

                                                   CaptionML=[ENU=Sell-to Customer Template Code;
                                                              ESM=Venta a-C¢d. plant. cliente;
                                                              FRC=Code modŠle d‚biteur;
                                                              ENC=Sell-to Customer Template Code] }
    { 5052;   ;Sell-to Contact No. ;Code20        ;TableRelation=Contact;
                                                   OnValidate=VAR
                                                                ContBusinessRelation@1004 : Record 5054;
                                                                Cont@1002 : Record 5050;
                                                                Opportunity@1000 : Record 5092;
                                                              BEGIN
                                                                TESTFIELD(Status,Status::Open);

                                                                IF ("Sell-to Contact No." <> xRec."Sell-to Contact No.") AND
                                                                   (xRec."Sell-to Contact No." <> '')
                                                                THEN BEGIN
                                                                  IF ("Sell-to Contact No." = '') AND ("Opportunity No." <> '') THEN
                                                                    ERROR(Text049,FIELDCAPTION("Sell-to Contact No."));
                                                                  IF HideValidationDialog OR NOT GUIALLOWED THEN
                                                                    Confirmed := TRUE
                                                                  ELSE
                                                                    Confirmed := CONFIRM(ConfirmChangeQst,FALSE,FIELDCAPTION("Sell-to Contact No."));
                                                                  IF Confirmed THEN BEGIN
                                                                    IF InitFromContact("Sell-to Contact No.","Sell-to Customer No.",FIELDCAPTION("Sell-to Contact No.")) THEN
                                                                      EXIT;
                                                                    IF "Opportunity No." <> '' THEN BEGIN
                                                                      Opportunity.GET("Opportunity No.");
                                                                      IF Opportunity."Contact No." <> "Sell-to Contact No." THEN BEGIN
                                                                        MODIFY;
                                                                        Opportunity.VALIDATE("Contact No.","Sell-to Contact No.");
                                                                        Opportunity.MODIFY;
                                                                      END
                                                                    END;
                                                                  END ELSE BEGIN
                                                                    Rec := xRec;
                                                                    EXIT;
                                                                  END;
                                                                END;

                                                                IF ("Sell-to Customer No." <> '') AND ("Sell-to Contact No." <> '') THEN BEGIN
                                                                  Cont.GET("Sell-to Contact No.");
                                                                  ContBusinessRelation.RESET;
                                                                  ContBusinessRelation.SETCURRENTKEY("Link to Table","No.");
                                                                  ContBusinessRelation.SETRANGE("Link to Table",ContBusinessRelation."Link to Table"::Customer);
                                                                  ContBusinessRelation.SETRANGE("No.","Sell-to Customer No.");
                                                                  IF ContBusinessRelation.FINDFIRST THEN
                                                                    IF ContBusinessRelation."Contact No." <> Cont."Company No." THEN
                                                                      ERROR(Text038,Cont."No.",Cont.Name,"Sell-to Customer No.");
                                                                END;

                                                                IF "Sell-to Contact No." <> '' THEN
                                                                  IF Cont.GET("Sell-to Contact No.") THEN
                                                                    IF ("Salesperson Code" = '') AND (Cont."Salesperson Code" <> '') THEN
                                                                      VALIDATE("Salesperson Code",Cont."Salesperson Code");

                                                                UpdateSellToCust("Sell-to Contact No.");
                                                              END;

                                                   OnLookup=VAR
                                                              Cont@1001 : Record 5050;
                                                              ContBusinessRelation@1000 : Record 5054;
                                                            BEGIN
                                                              IF "Sell-to Customer No." <> '' THEN
                                                                IF Cont.GET("Sell-to Contact No.") THEN
                                                                  Cont.SETRANGE("Company No.",Cont."Company No.")
                                                                ELSE BEGIN
                                                                  ContBusinessRelation.RESET;
                                                                  ContBusinessRelation.SETCURRENTKEY("Link to Table","No.");
                                                                  ContBusinessRelation.SETRANGE("Link to Table",ContBusinessRelation."Link to Table"::Customer);
                                                                  ContBusinessRelation.SETRANGE("No.","Sell-to Customer No.");
                                                                  IF ContBusinessRelation.FINDFIRST THEN
                                                                    Cont.SETRANGE("Company No.",ContBusinessRelation."Contact No.")
                                                                  ELSE
                                                                    Cont.SETRANGE("No.",'');
                                                                END;

                                                              IF "Sell-to Contact No." <> '' THEN
                                                                IF Cont.GET("Sell-to Contact No.") THEN ;
                                                              IF PAGE.RUNMODAL(0,Cont) = ACTION::LookupOK THEN BEGIN
                                                                xRec := Rec;
                                                                VALIDATE("Sell-to Contact No.",Cont."No.");
                                                              END;
                                                            END;

                                                   CaptionML=[ENU=Sell-to Contact No.;
                                                              ESM=Venta a-N§ contacto;
                                                              FRC=Nø contact d‚biteur;
                                                              ENC=Sell-to Contact No.] }
    { 5053;   ;Bill-to Contact No. ;Code20        ;TableRelation=Contact;
                                                   OnValidate=VAR
                                                                ContBusinessRelation@1004 : Record 5054;
                                                                Cont@1002 : Record 5050;
                                                              BEGIN
                                                                TESTFIELD(Status,Status::Open);

                                                                IF ("Bill-to Contact No." <> xRec."Bill-to Contact No.") AND
                                                                   (xRec."Bill-to Contact No." <> '')
                                                                THEN BEGIN
                                                                  IF HideValidationDialog THEN
                                                                    Confirmed := TRUE
                                                                  ELSE
                                                                    Confirmed := CONFIRM(ConfirmChangeQst,FALSE,FIELDCAPTION("Bill-to Contact No."));
                                                                  IF Confirmed THEN BEGIN
                                                                    IF InitFromContact("Bill-to Contact No.","Bill-to Customer No.",FIELDCAPTION("Bill-to Contact No.")) THEN
                                                                      EXIT;
                                                                  END ELSE BEGIN
                                                                    "Bill-to Contact No." := xRec."Bill-to Contact No.";
                                                                    EXIT;
                                                                  END;
                                                                END;

                                                                IF ("Bill-to Customer No." <> '') AND ("Bill-to Contact No." <> '') THEN BEGIN
                                                                  Cont.GET("Bill-to Contact No.");
                                                                  ContBusinessRelation.RESET;
                                                                  ContBusinessRelation.SETCURRENTKEY("Link to Table","No.");
                                                                  ContBusinessRelation.SETRANGE("Link to Table",ContBusinessRelation."Link to Table"::Customer);
                                                                  ContBusinessRelation.SETRANGE("No.","Bill-to Customer No.");
                                                                  IF ContBusinessRelation.FINDFIRST THEN
                                                                    IF ContBusinessRelation."Contact No." <> Cont."Company No." THEN
                                                                      ERROR(Text038,Cont."No.",Cont.Name,"Bill-to Customer No.");
                                                                END;

                                                                UpdateBillToCust("Bill-to Contact No.");
                                                              END;

                                                   OnLookup=VAR
                                                              Cont@1001 : Record 5050;
                                                              ContBusinessRelation@1000 : Record 5054;
                                                            BEGIN
                                                              IF "Bill-to Customer No." <> '' THEN
                                                                IF Cont.GET("Bill-to Contact No.") THEN
                                                                  Cont.SETRANGE("Company No.",Cont."Company No.")
                                                                ELSE BEGIN
                                                                  ContBusinessRelation.RESET;
                                                                  ContBusinessRelation.SETCURRENTKEY("Link to Table","No.");
                                                                  ContBusinessRelation.SETRANGE("Link to Table",ContBusinessRelation."Link to Table"::Customer);
                                                                  ContBusinessRelation.SETRANGE("No.","Bill-to Customer No.");
                                                                  IF ContBusinessRelation.FINDFIRST THEN
                                                                    Cont.SETRANGE("Company No.",ContBusinessRelation."Contact No.")
                                                                  ELSE
                                                                    Cont.SETRANGE("No.",'');
                                                                END;

                                                              IF "Bill-to Contact No." <> '' THEN
                                                                IF Cont.GET("Bill-to Contact No.") THEN ;
                                                              IF PAGE.RUNMODAL(0,Cont) = ACTION::LookupOK THEN BEGIN
                                                                xRec := Rec;
                                                                VALIDATE("Bill-to Contact No.",Cont."No.");
                                                              END;
                                                            END;

                                                   CaptionML=[ENU=Bill-to Contact No.;
                                                              ESM=Fact. a-N§ contacto;
                                                              FRC=Nø contact facturation;
                                                              ENC=Bill-to Contact No.] }
    { 5054;   ;Bill-to Customer Template Code;Code10;
                                                   TableRelation="Customer Template";
                                                   OnValidate=VAR
                                                                BillToCustTemplate@1001 : Record 5105;
                                                              BEGIN
                                                                TESTFIELD("Document Type","Document Type"::Quote);
                                                                TESTFIELD(Status,Status::Open);

                                                                IF NOT InsertMode AND
                                                                   ("Bill-to Customer Template Code" <> xRec."Bill-to Customer Template Code") AND
                                                                   (xRec."Bill-to Customer Template Code" <> '')
                                                                THEN BEGIN
                                                                  IF HideValidationDialog THEN
                                                                    Confirmed := TRUE
                                                                  ELSE
                                                                    Confirmed := CONFIRM(ConfirmChangeQst,FALSE,FIELDCAPTION("Bill-to Customer Template Code"));
                                                                  IF Confirmed THEN BEGIN
                                                                    IF InitFromTemplate("Bill-to Customer Template Code",FIELDCAPTION("Bill-to Customer Template Code")) THEN
                                                                      EXIT
                                                                  END ELSE BEGIN
                                                                    "Bill-to Customer Template Code" := xRec."Bill-to Customer Template Code";
                                                                    EXIT;
                                                                  END;
                                                                END;

                                                                VALIDATE("Ship-to Code",'');
                                                                IF BillToCustTemplate.GET("Bill-to Customer Template Code") THEN BEGIN
                                                                  BillToCustTemplate.TESTFIELD("Customer Posting Group");
                                                                  "Customer Posting Group" := BillToCustTemplate."Customer Posting Group";
                                                                  "Invoice Disc. Code" := BillToCustTemplate."Invoice Disc. Code";
                                                                  "Customer Price Group" := BillToCustTemplate."Customer Price Group";
                                                                  "Customer Disc. Group" := BillToCustTemplate."Customer Disc. Group";
                                                                  "Allow Line Disc." := BillToCustTemplate."Allow Line Disc.";
                                                                  "Tax Area Code" := BillToCustTemplate."Tax Area Code";
                                                                  "Tax Liable" := BillToCustTemplate."Tax Liable";
                                                                  VALIDATE("Payment Terms Code",BillToCustTemplate."Payment Terms Code");
                                                                  VALIDATE("Payment Method Code",BillToCustTemplate."Payment Method Code");
                                                                  "Shipment Method Code" := BillToCustTemplate."Shipment Method Code";
                                                                END;

                                                                CreateDim(
                                                                  DATABASE::"Customer Template","Bill-to Customer Template Code",
                                                                  DATABASE::"Salesperson/Purchaser","Salesperson Code",
                                                                  DATABASE::Customer,"Bill-to Customer No.",
                                                                  DATABASE::Campaign,"Campaign No.",
                                                                  DATABASE::"Responsibility Center","Responsibility Center");

                                                                IF NOT InsertMode AND
                                                                   (xRec."Sell-to Customer Template Code" = "Sell-to Customer Template Code") AND
                                                                   (xRec."Bill-to Customer Template Code" <> "Bill-to Customer Template Code")
                                                                THEN
                                                                  RecreateSalesLines(FIELDCAPTION("Bill-to Customer Template Code"));
                                                              END;

                                                   CaptionML=[ENU=Bill-to Customer Template Code;
                                                              ESM=Fact. a-C¢d. plant. cliente;
                                                              FRC=Code modŠle client factur‚;
                                                              ENC=Customer Template Code] }
    { 5055;   ;Opportunity No.     ;Code20        ;TableRelation=IF (Document Type=FILTER(<>Order)) Opportunity.No. WHERE (Contact No.=FIELD(Sell-to Contact No.),
                                                                                                                           Closed=CONST(No))
                                                                                                                           ELSE IF (Document Type=CONST(Order)) Opportunity.No. WHERE (Contact No.=FIELD(Sell-to Contact No.),
                                                                                                                                                                                       Sales Document No.=FIELD(No.),
                                                                                                                                                                                       Sales Document Type=CONST(Order));
                                                   OnValidate=BEGIN
                                                                LinkSalesDocWithOpportunity(xRec."Opportunity No.");
                                                              END;

                                                   CaptionML=[ENU=Opportunity No.;
                                                              ESM=N§ oportunidad;
                                                              FRC=Nø d'opportunit‚;
                                                              ENC=Opportunity No.] }
    { 5700;   ;Responsibility Center;Code10       ;TableRelation="Responsibility Center";
                                                   OnValidate=BEGIN
                                                                TESTFIELD(Status,Status::Open);
                                                                IF NOT UserSetupMgt.CheckRespCenter(0,"Responsibility Center") THEN
                                                                  ERROR(
                                                                    Text027,
                                                                    RespCenter.TABLECAPTION,UserSetupMgt.GetSalesFilter);

                                                                "Location Code" := UserSetupMgt.GetLocation(0,'',"Responsibility Center");
                                                                UpdateOutboundWhseHandlingTime;
                                                                UpdateShipToAddress;

                                                                CreateDim(
                                                                  DATABASE::"Responsibility Center","Responsibility Center",
                                                                  DATABASE::Customer,"Bill-to Customer No.",
                                                                  DATABASE::"Salesperson/Purchaser","Salesperson Code",
                                                                  DATABASE::Campaign,"Campaign No.",
                                                                  DATABASE::"Customer Template","Bill-to Customer Template Code");

                                                                IF xRec."Responsibility Center" <> "Responsibility Center" THEN BEGIN
                                                                  RecreateSalesLines(FIELDCAPTION("Responsibility Center"));
                                                                  "Assigned User ID" := '';
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Responsibility Center;
                                                              ESM=Centro responsabilidad;
                                                              FRC=Centre de gestion;
                                                              ENC=Responsibility Centre] }
    { 5750;   ;Shipping Advice     ;Option        ;OnValidate=BEGIN
                                                                TESTFIELD(Status,Status::Open);
                                                                IF InventoryPickConflict("Document Type","No.","Shipping Advice") THEN
                                                                  ERROR(Text066,FIELDCAPTION("Shipping Advice"),FORMAT("Shipping Advice"),TABLECAPTION);
                                                                IF WhseShpmntConflict("Document Type","No.","Shipping Advice") THEN
                                                                  ERROR(STRSUBSTNO(Text070,FIELDCAPTION("Shipping Advice"),FORMAT("Shipping Advice"),TABLECAPTION));
                                                                //<TPZ2447>
                                                                {
                                                                // >> EDI
                                                                IF NOT RunFromEDI THEN
                                                                // << EDI (Missing Indentation)
                                                                WhseSourceHeader.SalesHeaderVerifyChange(Rec,xRec);
                                                                }
                                                                //</TPZ2447>
                                                              END;

                                                   AccessByPermission=TableData 110=R;
                                                   CaptionML=[ENU=Shipping Advice;
                                                              ESM=Aviso env¡o;
                                                              FRC=Avis de livraison;
                                                              ENC=Shipping Advice];
                                                   OptionCaptionML=[ENU=Partial,Complete,No Back Order;
                                                                    ESM=Parcial,Completo;
                                                                    FRC=Partiel,Complet;
                                                                    ENC=Partial,Complete];
                                                   OptionString=Partial,Complete,No Back Order;
                                                   Description=TPZ815, TM 062615, Added option No Back Order }
    { 5751;   ;Shipped Not Invoiced;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Sales Line Quote Buffer" WHERE (Document Type=FIELD(Document Type),
                                                                                                      Document No.=FIELD(No.),
                                                                                                      Qty. Shipped Not Invoiced=FILTER(<>0)));
                                                   AccessByPermission=TableData 110=R;
                                                   CaptionML=[ENU=Shipped Not Invoiced;
                                                              ESM=Enviado no facturado;
                                                              FRC=Livr‚ non factur‚;
                                                              ENC=Shipped Not Invoiced];
                                                   Editable=No }
    { 5752;   ;Completely Shipped  ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Min("Sales Line Quote Buffer"."Completely Shipped" WHERE (Document Type=FIELD(Document Type),
                                                                                                                         Document No.=FIELD(No.),
                                                                                                                         Type=FILTER(<>' '),
                                                                                                                         Location Code=FIELD(Location Filter)));
                                                   CaptionML=[ENU=Completely Shipped;
                                                              ESM=Enviado completamente;
                                                              FRC=EntiŠrement livr‚e;
                                                              ENC=Completely Shipped];
                                                   Editable=No }
    { 5753;   ;Posting from Whse. Ref.;Integer    ;AccessByPermission=TableData 14=R;
                                                   CaptionML=[ENU=Posting from Whse. Ref.;
                                                              ESM=Regis. desde almac. ref.;
                                                              FRC=Validat. … partir r‚f. magasin;
                                                              ENC=Posting from Whse. Ref.] }
    { 5754;   ;Location Filter     ;Code10        ;FieldClass=FlowFilter;
                                                   TableRelation=Location;
                                                   CaptionML=[ENU=Location Filter;
                                                              ESM=Filtro almac‚n;
                                                              FRC=Filtre emplacement;
                                                              ENC=Location Filter] }
    { 5755;   ;Shipped             ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Sales Line Quote Buffer" WHERE (Document Type=FIELD(Document Type),
                                                                                                      Document No.=FIELD(No.),
                                                                                                      Qty. Shipped (Base)=FILTER(<>0)));
                                                   AccessByPermission=TableData 110=R;
                                                   CaptionML=[ENU=Shipped;
                                                              ESM=Enviado;
                                                              FRC=Exp‚di‚;
                                                              ENC=Shipped];
                                                   Editable=No }
    { 5790;   ;Requested Delivery Date;Date       ;OnValidate=BEGIN
                                                                TESTFIELD(Status,Status::Open);
                                                                IF "Promised Delivery Date" <> 0D THEN
                                                                  ERROR(
                                                                    Text028,
                                                                    FIELDCAPTION("Requested Delivery Date"),
                                                                    FIELDCAPTION("Promised Delivery Date"));

                                                                IF "Requested Delivery Date" <> xRec."Requested Delivery Date" THEN
                                                                  UpdateSalesLines(FIELDCAPTION("Requested Delivery Date"),CurrFieldNo <> 0);
                                                              END;

                                                   AccessByPermission=TableData 99000880=R;
                                                   CaptionML=[ENU=Requested Delivery Date;
                                                              ESM=Fecha entrega requerida;
                                                              FRC=Date livraison demand‚e;
                                                              ENC=Requested Delivery Date] }
    { 5791;   ;Promised Delivery Date;Date        ;OnValidate=BEGIN
                                                                TESTFIELD(Status,Status::Open);
                                                                IF "Promised Delivery Date" <> xRec."Promised Delivery Date" THEN
                                                                  UpdateSalesLines(FIELDCAPTION("Promised Delivery Date"),CurrFieldNo <> 0);
                                                              END;

                                                   AccessByPermission=TableData 99000880=R;
                                                   CaptionML=[ENU=Promised Delivery Date;
                                                              ESM=Fecha entrega prometida;
                                                              FRC=Date livraison confirm‚e;
                                                              ENC=Promised Delivery Date] }
    { 5792;   ;Shipping Time       ;DateFormula   ;OnValidate=BEGIN
                                                                TESTFIELD(Status,Status::Open);
                                                                IF "Shipping Time" <> xRec."Shipping Time" THEN
                                                                  UpdateSalesLines(FIELDCAPTION("Shipping Time"),CurrFieldNo <> 0);
                                                              END;

                                                   AccessByPermission=TableData 110=R;
                                                   CaptionML=[ENU=Shipping Time;
                                                              ESM=Tiempo env¡o;
                                                              FRC=D‚lai de livraison;
                                                              ENC=Shipping Time] }
    { 5793;   ;Outbound Whse. Handling Time;DateFormula;
                                                   OnValidate=BEGIN
                                                                TESTFIELD(Status,Status::Open);
                                                                IF ("Outbound Whse. Handling Time" <> xRec."Outbound Whse. Handling Time") AND
                                                                   (xRec."Sell-to Customer No." = "Sell-to Customer No.")
                                                                THEN
                                                                  UpdateSalesLines(FIELDCAPTION("Outbound Whse. Handling Time"),CurrFieldNo <> 0);
                                                              END;

                                                   AccessByPermission=TableData 7320=R;
                                                   CaptionML=[ENU=Outbound Whse. Handling Time;
                                                              ESM=Tiempo manip. alm. salida;
                                                              FRC=D‚lai d‚senlogement;
                                                              ENC=Outbound Whse. Handling Time] }
    { 5794;   ;Shipping Agent Service Code;Code10 ;TableRelation="Shipping Agent Services".Code WHERE (Shipping Agent Code=FIELD(Shipping Agent Code));
                                                   OnValidate=BEGIN
                                                                TESTFIELD(Status,Status::Open);
                                                                GetShippingTime(FIELDNO("Shipping Agent Service Code"));
                                                                UpdateSalesLines(FIELDCAPTION("Shipping Agent Service Code"),CurrFieldNo <> 0);
                                                              END;

                                                   CaptionML=[ENU=Shipping Agent Service Code;
                                                              ESM=C¢d. servicio transportista;
                                                              FRC=Code prestation agent de livraison;
                                                              ENC=Shipping Agent Service Code] }
    { 5795;   ;Late Order Shipping ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Sales Line Quote Buffer" WHERE (Document Type=FIELD(Document Type),
                                                                                                      Sell-to Customer No.=FIELD(Sell-to Customer No.),
                                                                                                      Document No.=FIELD(No.),
                                                                                                      Shipment Date=FIELD(Date Filter),
                                                                                                      Outstanding Quantity=FILTER(<>0)));
                                                   AccessByPermission=TableData 110=R;
                                                   CaptionML=[ENU=Late Order Shipping;
                                                              ESM=Env¡o retrasado;
                                                              FRC=Livraison en retard;
                                                              ENC=Late Order Shipping];
                                                   Editable=No }
    { 5796;   ;Date Filter         ;Date          ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=Date Filter;
                                                              ESM=Filtro fecha;
                                                              FRC=Filtre date;
                                                              ENC=Date Filter] }
    { 5800;   ;Receive             ;Boolean       ;CaptionML=[ENU=Receive;
                                                              ESM=Recepci¢n;
                                                              FRC=Recevoir;
                                                              ENC=Receive] }
    { 5801;   ;Return Receipt No.  ;Code20        ;CaptionML=[ENU=Return Receipt No.;
                                                              ESM=N§ recep. devol.;
                                                              FRC=Nø r‚ception retour;
                                                              ENC=Return Receipt No.] }
    { 5802;   ;Return Receipt No. Series;Code10   ;TableRelation="No. Series";
                                                   OnValidate=BEGIN
                                                                IF "Return Receipt No. Series" <> '' THEN BEGIN
                                                                  SalesSetup.GET;
                                                                  SalesSetup.TESTFIELD("Posted Return Receipt Nos.");
                                                                  NoSeriesMgt.TestSeries(SalesSetup."Posted Return Receipt Nos.","Return Receipt No. Series");
                                                                END;
                                                                TESTFIELD("Return Receipt No.",'');
                                                              END;

                                                   OnLookup=BEGIN
                                                              WITH SalesHeader DO BEGIN
                                                                SalesHeader := Rec;
                                                                SalesSetup.GET;
                                                                SalesSetup.TESTFIELD("Posted Return Receipt Nos.");
                                                                IF NoSeriesMgt.LookupSeries(SalesSetup."Posted Return Receipt Nos.","Return Receipt No. Series") THEN
                                                                  VALIDATE("Return Receipt No. Series");
                                                                Rec := SalesHeader;
                                                              END;
                                                            END;

                                                   CaptionML=[ENU=Return Receipt No. Series;
                                                              ESM=N§ serie recep. devol.;
                                                              FRC=Souche de nø r‚ception retour;
                                                              ENC=Return Receipt No. Series] }
    { 5803;   ;Last Return Receipt No.;Code20     ;TableRelation="Return Receipt Header";
                                                   CaptionML=[ENU=Last Return Receipt No.;
                                                              ESM=N§ £ltima recep. devol.;
                                                              FRC=Dernier nø r‚ception retour;
                                                              ENC=Last Return Receipt No.];
                                                   Editable=No }
    { 7001;   ;Allow Line Disc.    ;Boolean       ;OnValidate=BEGIN
                                                                TESTFIELD(Status,Status::Open);
                                                                MessageIfSalesLinesExist(FIELDCAPTION("Allow Line Disc."));
                                                              END;

                                                   CaptionML=[ENU=Allow Line Multiplier;
                                                              ESM=Permite dto. l¡nea;
                                                              FRC=Autoriser remise ligne;
                                                              ENC=Allow Line Disc.];
                                                   Description=TOP100A }
    { 7200;   ;Get Shipment Used   ;Boolean       ;CaptionML=[ENU=Get Shipment Used;
                                                              ESM=Obtener m‚todo de env¡o usado;
                                                              FRC=Extraire livraison utilis‚e;
                                                              ENC=Get Shipment Used];
                                                   Editable=No }
    { 9000;   ;Assigned User ID    ;Code50        ;TableRelation="User Setup";
                                                   OnValidate=BEGIN
                                                                IF NOT UserSetupMgt.CheckRespCenter2(0,"Responsibility Center","Assigned User ID") THEN
                                                                  ERROR(
                                                                    Text061,"Assigned User ID",
                                                                    RespCenter.TABLECAPTION,UserSetupMgt.GetSalesFilter2("Assigned User ID"));
                                                              END;

                                                   CaptionML=[ENU=Assigned User ID;
                                                              ESM=Id. usuario asignado;
                                                              FRC=Code utilisateur affect‚;
                                                              ENC=Assigned User ID] }
    { 10005;  ;Ship-to UPS Zone    ;Code2         ;CaptionML=[ENU=Ship-to UPS Zone;
                                                              ESM=Env¡o a-Zona UPS;
                                                              FRC=Zone de livraison UPS;
                                                              ENC=Ship-to UPS Zone] }
    { 10009;  ;Outstanding Amount ($);Decimal     ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Sales Line Quote Buffer"."Outstanding Amount (LCY)" WHERE (Document Type=FIELD(Document Type),
                                                                                                                               Document No.=FIELD(No.)));
                                                   CaptionML=[ENU=Outstanding Amount ($);
                                                              ESM=Importe pendiente ($);
                                                              FRC=Montant non pay‚ ($);
                                                              ENC=Outstanding Amount ($)];
                                                   Editable=No }
    { 10015;  ;Tax Exemption No.   ;Text30        ;CaptionML=[ENU=Tax Exemption No.;
                                                              ESM=N§ exenci¢n fisc.;
                                                              FRC=Nø d'exon‚ration fiscale;
                                                              ENC=Tax Exemption No.] }
    { 10018;  ;STE Transaction ID  ;Text20        ;CaptionML=[ENU=STE Transaction ID;
                                                              ESM=Id. transacci¢n STE;
                                                              FRC=ID de transaction STE;
                                                              ENC=STE Transaction ID];
                                                   Editable=No }
    { 12600;  ;Prepmt. Include Tax ;Boolean       ;OnValidate=VAR
                                                                GLSetup@1020000 : Record 98;
                                                              BEGIN
                                                                IF IsPrepmtInvoicePosted THEN
                                                                  ERROR(PrepmtInvoiceExistsErr,FIELDCAPTION("Prepmt. Include Tax"));
                                                                IF xRec."Prepmt. Include Tax" = "Prepmt. Include Tax" THEN
                                                                  EXIT;
                                                                IF NOT "Prepmt. Include Tax" THEN
                                                                  EXIT;
                                                                IF "Currency Code" = '' THEN
                                                                  EXIT;
                                                                GLSetup.GET;
                                                                IF GLSetup."LCY Code" = "Currency Code" THEN
                                                                  EXIT;
                                                                ERROR(PrepmtIncludeTaxErr,FIELDCAPTION("Prepmt. Include Tax"));
                                                              END;

                                                   CaptionML=[ENU=Prepmt. Include Tax;
                                                              ESM=Impuesto incluido anticipo;
                                                              FRC=Paiem. ant. avec taxe;
                                                              ENC=Prepmt. Include Tax] }
    { 50000;  ;Lost Opportunity    ;Boolean       ;Description=TOP030B }
    { 50001;  ;Lost Opportunity Description;Text50;Description=TOP230 }
    { 50002;  ;Lock Price          ;Boolean       ;Description=TOP010E }
    { 50005;  ;Lot Price           ;Boolean       ;Description=TOP030A }
    { 50006;  ;Back Order          ;Boolean       ;Description=TPZ815 }
    { 50010;  ;Document Needs Approval;Boolean    ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Approval Entry" WHERE (Table ID=CONST(50005),
                                                                                             Document Type=FIELD(Document Type),
                                                                                             Document No.=FIELD(No.),
                                                                                             Status=FILTER(Created|Open)));
                                                   Description=TOP150;
                                                   Editable=No }
    { 50029;  ;No. of Lost Opporunity Lines;Integer;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Count("Sales Line Quote Buffer" WHERE (Document Type=FIELD(Document Type),
                                                                                                      Document No.=FIELD(No.),
                                                                                                      Type=CONST(Item),
                                                                                                      Lost Opportunity=CONST(Yes)));
                                                   Description=TOP030B;
                                                   Editable=No }
    { 50030;  ;Non Divisional      ;Boolean       ;OnValidate=VAR
                                                                PrevTermCode@1000000000 : Code[20];
                                                                abcsi001@1000000001 : TextConst 'ENU=Payment Terms Code for all the Customer Divisions should be equal';
                                                              BEGIN
                                                              END;

                                                   Description=TOP130 }
    { 50035;  ;RSM Code            ;Code10        ;TableRelation=Salesperson/Purchaser;
                                                   CaptionML=[ENU=RSM Code;
                                                              ENC=RSM Code];
                                                   Description=TOP110 }
    { 50050;  ;E-Mail (ASN)        ;Text80        ;Description=TOP060 }
    { 50095;  ;Hard Copy PO Available;Boolean     ;Description=TOP170 }
    { 50096;  ;Quote Version No.   ;Integer       ;Description=TOP170 }
    { 50097;  ;Customer Comments   ;Text100       ;Description=TOP170 }
    { 50098;  ;Finance Comments    ;Text100       ;Description=TOP170 }
    { 50099;  ;Shipping Comments   ;Text100       ;Description=TOP170 }
    { 50100;  ;Mfr. Rep. Code      ;Code20        ;TableRelation="Mfr. Rep.";
                                                   OnValidate=BEGIN
                                                                // <TPZ572>
                                                                UpdateSalesLines(FIELDCAPTION("Mfr. Rep. Code"),FALSE);
                                                                // </TPZ572>
                                                                // <TPZ92>
                                                                IF GetMfrRepExcp("Mfr. Rep. Code","Shortcut Dimension 5 Code","Sell-to Customer No.") THEN
                                                                  VALIDATE("Mfr. Rep. Comm. %",MfrRepCommExcp."Commission %")
                                                                 ELSE BEGIN
                                                                  GetMfrRepDivComm("Mfr. Rep. Code","Shortcut Dimension 5 Code");
                                                                  VALIDATE("Mfr. Rep. Comm. %",MfrRepDivComm."Commission %");
                                                                END;
                                                                // </TPZ92>
                                                              END;

                                                   CaptionML=ENU=Mfr. Rep. Code }
    { 50101;  ;ISR Code            ;Code10        ;TableRelation=Salesperson/Purchaser;
                                                   OnValidate=BEGIN
                                                                // <TPZ572>
                                                                UpdateSalesLines(FIELDCAPTION("ISR Code"),FALSE);
                                                                // </TPZ572>
                                                              END;

                                                   CaptionML=ENU=ISR Code }
    { 50102;  ;CSR Code            ;Code10        ;TableRelation=Salesperson/Purchaser;
                                                   OnValidate=BEGIN
                                                                // <TPZ572>
                                                                UpdateSalesLines(FIELDCAPTION("CSR Code"),FALSE);
                                                                // </TPZ572>
                                                              END;

                                                   CaptionML=ENU=CSR Code }
    { 50103;  ;Job Name            ;Code30        ;Description=TPZ1576 //EB }
    { 50104;  ;Free Freight Override;Boolean      ;OnValidate=VAR
                                                                UserSetup@1000000000 : Record 91;
                                                                FreeFreightOverride@1000000001 : TextConst 'ENU=You must be an authorized user to check the Free Freight Override flag';
                                                              BEGIN
                                                                //<TPZ2033>
                                                                TESTFIELD(Status,Status::Open);
                                                                //</TPZ2033>
                                                              END;

                                                   Description=TPZ1608 //EB }
    { 50105;  ;Free Freight Override Reason;Option;OptionCaptionML=ENU=" ,New Customer,Samples,Shipping Mistake,Consolidate Order,Part of Larger Order,Local,Pickup,Left off Original Order,Order Entry Error,Replace Mdse From Carrier Damage,Good Will,Defective Replacements,Lost Shipment,Re-Ship For Shortage";
                                                   OptionString=[ ,New Customer,Samples,Shipping Mistake,Consolidate Order,Part of Larger Order,Local,Pickup,Left off Original Order,Order Entry Error,Replace Mdse From Carrier Damage,Good Will,Defective Replacements,Lost Shipment,Re-Ship For Shortage ];
                                                   Description=TPZ1608 //EB }
    { 50107;  ;E-Mail Invoice Notice Handled;Boolean;
                                                   CaptionML=ENU=E-Mail Invoice Notice Handled;
                                                   Description=TPZ1956 }
    { 50200;  ;Shortcut Dimension 5 Code;Code20   ;OnValidate=VAR
                                                                DimVal@1000000001 : Record 349;
                                                                SLines@1000000000 : Record 50006;
                                                              BEGIN
                                                                //TOP130 - Item List Sort and filter by Status and Division 06042015
                                                                GLSetup.GET;
                                                                IF NOT DimVal.GET(GLSetup."Shortcut Dimension 5 Code","Shortcut Dimension 5 Code") THEN
                                                                  FIELDERROR("Shortcut Dimension 5 Code",ab007);

                                                                IF ("Shortcut Dimension 5 Code" <> '') AND (xRec."Shortcut Dimension 5 Code" <> '') AND ("Shortcut Dimension 5 Code" <> xRec."Shortcut Dimension 5 Code") THEN BEGIN
                                                                  IF SalesLinesExist THEN
                                                                    IF CONFIRM(ab006,FALSE,FIELDCAPTION("Document Type"),"No.",FIELDCAPTION("Shortcut Dimension 5 Code"),"Shortcut Dimension 5 Code") THEN BEGIN
                                                                      SLines.RESET;
                                                                      SLines.SETRANGE("Document Type","Document Type");
                                                                      SLines.SETRANGE("Document No.","No.");
                                                                      SLines.DELETEALL(TRUE);
                                                                    END ELSE ERROR(ab008);
                                                                  END;
                                                                //TOP130 - Item List Sort and filter by Status and Division 06042015

                                                                ValidateShortcutDimCode(5,"Shortcut Dimension 5 Code");

                                                                //TOP020 KT ABCSI Sales Orders by Division Code 01272015
                                                                //IF CurrFieldNo = FIELDNO("Shortcut Dimension 5 Code") THEN BEGIN
                                                                IF NOT RunFromEDI THEN //TPZEDI
                                                                  IF UserSetup.GET(USERID) AND (UserSetup."Shortcut Dimension 5 Code" <> '') THEN BEGIN
                                                                    IF "Shortcut Dimension 5 Code" <> '' THEN BEGIN
                                                                      IF UserSetup."Shortcut Dimension 5 Code" <> "Shortcut Dimension 5 Code" THEN
                                                                        IF NOT HideValidationDialog AND GUIALLOWED THEN
                                                                          ERROR(ab004,FIELDCAPTION("Shortcut Dimension 5 Code"),"Shortcut Dimension 5 Code");
                                                                      // <TPZ721>
                                                                      IF "Sell-to Customer No." <> '' THEN BEGIN
                                                                        GetCust("Sell-to Customer No.");
                                                                        IF NOT CustomerDivision.GET("Sell-to Customer No.","Shortcut Dimension 5 Code") THEN
                                                                      // </TPZ721>
                                                                          IF NOT HideValidationDialog AND GUIALLOWED THEN
                                                                            ERROR(ab003,FIELDCAPTION("Shortcut Dimension 5 Code"),"Shortcut Dimension 5 Code");
                                                                      END ELSE
                                                                        IF NOT HideValidationDialog AND GUIALLOWED THEN
                                                                          // <TPZ721>
                                                                          ERROR(ab002,FIELDCAPTION("Sell-to Customer No."))
                                                                          // </TPZ721>
                                                                    END;
                                                                  END ELSE BEGIN
                                                                    IF "Shortcut Dimension 5 Code" <> '' THEN BEGIN
                                                                      // <TPZ721>
                                                                      IF "Sell-to Customer No." <> '' THEN BEGIN
                                                                        GetCust("Sell-to Customer No.");
                                                                        IF NOT CustomerDivision.GET("Sell-to Customer No.","Shortcut Dimension 5 Code") THEN
                                                                      // </TPZ721>
                                                                          IF NOT HideValidationDialog AND GUIALLOWED THEN
                                                                            ERROR(ab003,FIELDCAPTION("Shortcut Dimension 5 Code"),"Shortcut Dimension 5 Code");
                                                                      END ELSE
                                                                        IF NOT HideValidationDialog AND GUIALLOWED THEN
                                                                          // <TPZ721>
                                                                          ERROR(ab002,FIELDCAPTION("Sell-to Customer No."))
                                                                          // </TPZ721>
                                                                    END;
                                                                  END;
                                                                //TOP020 KT ABCSI Sales Orders by Division Code 01272015

                                                                // <TPZ572>
                                                                GetCust("Sell-to Customer No.");
                                                                IF CustomerDivision.GET("Sell-to Customer No.","Shortcut Dimension 5 Code") THEN BEGIN
                                                                  IF NOT "Topaz WH Billing" THEN //TPZEDI
                                                                    VALIDATE("Mfr. Rep. Code",CustomerDivision."Mfr. Rep. Code");
                                                                  VALIDATE("Salesperson Code",CustomerDivision."Salesperson Code");
                                                                  VALIDATE("ISR Code",CustomerDivision."ISR Code");
                                                                  VALIDATE("CSR Code",CustomerDivision."CSR Code");
                                                                  IF NOT "Topaz WH Billing" THEN
                                                                    VALIDATE("Location Code",CustomerDivision."Location Code");
                                                                  // <TPZ1342,TPZ1516>
                                                                  "Shipping Advice" := CustomerDivision."Shipping Advice";
                                                                  VALIDATE("Shipping Payment Type",CustomerDivision."Shipping Payment Type");
                                                                  // </TPZ1342,TPZ1516>
                                                                END ELSE BEGIN
                                                                  VALIDATE("Mfr. Rep. Code",'');
                                                                  VALIDATE("Salesperson Code",Cust."Salesperson Code");
                                                                  VALIDATE("ISR Code",'');
                                                                  VALIDATE("CSR Code",'');
                                                                  VALIDATE("Location Code",'');
                                                                  // <TPZ1342,TPZ1516>
                                                                  "Shipping Advice" := Cust."Shipping Advice";
                                                                  VALIDATE("Shipping Payment Type",Cust."Shipping Payment Type");
                                                                  // </TPZ1342,TPZ1516>
                                                                END;
                                                                // </TPZ572>

                                                                //TOP140 KT ABCSI Modification to Payment Terms 12302014
                                                                GetCust("Bill-to Customer No.");
                                                                SalesSetup.GET;
                                                                IF SalesSetup."Payment Terms by Division" THEN BEGIN
                                                                  IF "Shortcut Dimension 5 Code" <> '' THEN BEGIN
                                                                    IF CustomerDivision.GET("Bill-to Customer No.","Shortcut Dimension 5 Code") THEN BEGIN
                                                                      CustomerDivision.TESTFIELD("Payment Terms Code");
                                                                      VALIDATE("Payment Terms Code",CustomerDivision."Payment Terms Code");
                                                                    END ELSE
                                                                      VALIDATE("Payment Terms Code",Cust."Payment Terms Code");
                                                                  END ELSE
                                                                    VALIDATE("Payment Terms Code",Cust."Payment Terms Code");
                                                                END ELSE
                                                                  VALIDATE("Payment Terms Code",Cust."Payment Terms Code");
                                                                //TOP140 KT ABCSI Modification to Payment Terms 12302014

                                                                // <TPZ848>
                                                                CheckEDIOrder;
                                                                // </TPZ848>
                                                                //<TPZ1550>
                                                                IF ("Document Type"="Document Type"::Quote) AND (("Shortcut Dimension 5 Code"='E') OR ("Shortcut Dimension 5 Code"='P')) THEN //<TPZ2558>
                                                                    "Lock Price":=TRUE;
                                                                 //<\TPZ1550>
                                                              END;

                                                   OnLookup=BEGIN
                                                              LookupShortcutDimCode(5,"Shortcut Dimension 5 Code"); //TOP140 KT ABCSI Modification to Payment Terms 01222015
                                                              VALIDATE("Shortcut Dimension 5 Code"); //TOP020 KT ABCSI Sales Orders by Division Code 01272015
                                                            END;

                                                   CaptionML=[ENU=Shortcut Dimension 5 Code;
                                                              ESM=C¢d. dim. acceso dir. 2;
                                                              FRC=Code raccourci de dimension 2;
                                                              ENC=Shortcut Dimension 2 Code];
                                                   Description=TOP140;
                                                   CaptionClass='1,2,5' }
    { 51006;  ;Mail                ;Boolean       ;CaptionML=ENU=Mail }
    { 51007;  ;Fax                 ;Boolean       ;CaptionML=ENU=Fax }
    { 51016;  ;Price Adjustment    ;Boolean       ;CaptionML=ENU=Price Adjustment }
    { 51029;  ;Warehouse Release No.;Code20       ;OnValidate=VAR
                                                                LocSalesHeader@1000000001 : Record 50005;
                                                                LocSalesShptHeader@1000000002 : Record 110;
                                                                LocSalesInvHeader@1000000000 : Record 112;
                                                              BEGIN
                                                                // <TPZ159>
                                                                SalesSetup.GET;
                                                                IF NOT SalesSetup."Dupl. Whse. Rel. No. Warning" THEN
                                                                  EXIT;
                                                                IF ("Document Type" = "Document Type"::Order) AND
                                                                   ("Location Code" <> '') AND
                                                                   ("Warehouse Release No." <> '') AND
                                                                   (CurrFieldNo = FIELDNO("Warehouse Release No."))
                                                                THEN BEGIN
                                                                  LocSalesHeader.RESET;
                                                                  LocSalesHeader.SETRANGE("Document Type","Document Type"::Order);
                                                                  LocSalesHeader.SETFILTER("No.",'<>%1',"No.");
                                                                  LocSalesHeader.SETRANGE("Location Code","Location Code");
                                                                  LocSalesHeader.SETRANGE("Warehouse Release No.","Warehouse Release No.");
                                                                  IF LocSalesHeader.FINDFIRST THEN
                                                                    IF NOT
                                                                         CONFIRM(
                                                                           Text51004,
                                                                           FALSE,
                                                                           FIELDCAPTION("Warehouse Release No."),
                                                                           "Warehouse Release No.",
                                                                           LocSalesHeader."No.",
                                                                           FIELDCAPTION("Location Code"),
                                                                           "Location Code")
                                                                    THEN
                                                                      ERROR('');

                                                                  LocSalesShptHeader.RESET;
                                                                  LocSalesShptHeader.SETRANGE("Location Code","Location Code");
                                                                  LocSalesShptHeader.SETRANGE("Warehouse Release No.","Warehouse Release No.");
                                                                  IF LocSalesShptHeader.FINDFIRST THEN
                                                                    IF NOT
                                                                         CONFIRM(
                                                                           Text51005,
                                                                           FALSE,
                                                                           FIELDCAPTION("Warehouse Release No."),
                                                                           "Warehouse Release No.",
                                                                           LocSalesShptHeader."No.",
                                                                           FIELDCAPTION("Location Code"),
                                                                           "Location Code")
                                                                    THEN
                                                                      ERROR('');

                                                                  LocSalesInvHeader.RESET;
                                                                  LocSalesInvHeader.SETRANGE("Location Code","Location Code");
                                                                  LocSalesInvHeader.SETRANGE("Warehouse Release No.","Warehouse Release No.");
                                                                  IF LocSalesInvHeader.FINDFIRST THEN
                                                                    IF NOT
                                                                         CONFIRM(
                                                                           Text51006,
                                                                           FALSE,
                                                                           FIELDCAPTION("Warehouse Release No."),
                                                                           "Warehouse Release No.",
                                                                           LocSalesInvHeader."No.",
                                                                           FIELDCAPTION("Location Code"),
                                                                           "Location Code")
                                                                    THEN
                                                                      ERROR('');
                                                                END;
                                                                // </TPZ159>
                                                              END;

                                                   CaptionML=ENU=Warehouse Release No. }
    { 51056;  ;Return to Warehouse ;Boolean       ;OnValidate=VAR
                                                                Location2@1000000000 : Record 14;
                                                              BEGIN
                                                                // <TPZ461>
                                                                IF ("Document Type" = "Document Type"::"Return Order") AND
                                                                   "Return to Warehouse" AND
                                                                   Location2.GET("Location Code")
                                                                THEN BEGIN
                                                                  "Ship-to Name" := Location2.Name;
                                                                  "Ship-to Address" := Location2.Address;
                                                                  "Ship-to Address 2" := Location2."Address 2";
                                                                  "Ship-to City" := Location2.City;
                                                                  "Ship-to Contact" := Location2.Contact;
                                                                  "Ship-to Post Code" := Location2."Post Code";
                                                                  "Ship-to County" := Location2.County;
                                                                END;
                                                                // </TPZ461>
                                                              END;

                                                   CaptionML=ENU=Return to Warehouse }
    { 51077;  ;Internal Comment    ;Text30        ;CaptionML=ENU=Internal Comment }
    { 51409;  ;Free Freight Reason Code;Code10    ;TableRelation="Reason Code";
                                                   OnValidate=BEGIN
                                                                // <TPZ844>
                                                                IF "Free Freight Reason Code" <> '' THEN
                                                                  TESTFIELD("Free Freight",TRUE);
                                                                // </TPZ844>
                                                              END;

                                                   CaptionML=ENU=Free Freight Reason Code;
                                                   Editable=No }
    { 51477;  ;Warehouse Request Status;Option    ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Warehouse Request"."Activity Status" WHERE (Type=CONST(Outbound),
                                                                                                                   Location Code=FIELD(Location Code),
                                                                                                                   Source Type=CONST(50006),
                                                                                                                   Source Subtype=FIELD(Document Type),
                                                                                                                   Source No.=FIELD(No.)));
                                                   CaptionML=ENU=Warehouse Request Status;
                                                   OptionCaptionML=ENU=" ,Pick Created,Pick Registered,Packing,Packed,Shipped";
                                                   OptionString=[ ,Pick Created,Pick Registered,Packing,Packed,Shipped];
                                                   Editable=No }
    { 51480;  ;Ship-to Phone No.   ;Text30        ;CaptionML=ENU=Ship-to Phone No. }
    { 51700;  ;Mfr. Rep. Comm. %   ;Decimal       ;OnValidate=BEGIN
                                                                // <TPZ92>
                                                                UpdateSalesLines(FIELDCAPTION("Mfr. Rep. Comm. %"),FALSE);
                                                                // </TPZ92>
                                                              END;

                                                   CaptionML=ENU=Mfr. Rep. Comm. %;
                                                   DecimalPlaces=0:2;
                                                   MinValue=0;
                                                   MaxValue=100 }
    { 51701;  ;Mfr. Rep. Comm. Amount;Decimal     ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Sales Line Quote Buffer"."Mfr. Rep. Comm. Amount" WHERE (Document Type=FIELD(Document Type),
                                                                                                                             No.=FIELD(No.)));
                                                   CaptionML=ENU=Mfr. Rep. Comm. Amount;
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 51702;  ;Location Hdlg. %    ;Decimal       ;CaptionML=ENU=Location Hdlg. %;
                                                   DecimalPlaces=0:2;
                                                   MinValue=0;
                                                   MaxValue=100 }
    { 51703;  ;Location Hdlg. Amount;Decimal      ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Sales Line Quote Buffer"."Location Hdlg. Amount" WHERE (Document Type=FIELD(Document Type),
                                                                                                                            No.=FIELD(No.)));
                                                   CaptionML=ENU=Location Hdlg. Amount;
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 60000;  ;945 Processed       ;Boolean       ;CaptionML=ENU=EDI Stk.Rep.ShpConf. (945) Rcvd.;
                                                   Description=TPZEDI }
    { 60010;  ;940 Required        ;Boolean       ;Description=TPZEDI }
    { 60020;  ;Topaz WH Billing    ;Boolean       ;OnValidate=BEGIN
                                                                //TPZEDI
                                                              END;

                                                   Description=TPZEDI }
    { 60030;  ;TPZ WH TP No.       ;Code20        ;TableRelation="E.D.I. Trade Partner".No.;
                                                   Description=TPZEDI }
    { 65000;  ;Master Order No.    ;Code20        ;TableRelation="Sales Header Buffer".No. WHERE (Document Type=CONST(Order));
                                                   OnLookup=VAR
                                                              SalesInvHeader@1000000000 : Record 112;
                                                              SalesHeader@1000000001 : Record 50005;
                                                            BEGIN
                                                              IF (NOT SalesHeader.GET(SalesHeader."Document Type"::Order,"Master Order No."))
                                                                 AND SalesInvHeader.GET("Master Order No.") THEN
                                                                PAGE.RUNMODAL(PAGE::"Posted Sales Invoices",SalesInvHeader)
                                                              ELSE PAGE.RUNMODAL(PAGE::"Sales List",SalesHeader);
                                                            END;

                                                   CaptionML=ENU=Master Order No.;
                                                   Description=TOP010 }
    { 65010;  ;Original Free Freight Base;Decimal ;CaptionML=ENU=Original Free Freight Base;
                                                   BlankZero=Yes;
                                                   Description=TOP010 }
    { 65015;  ;Delivery Date       ;Date          ;Description=TPZ1927 }
    { 70551;  ;Exclude from Usage  ;Boolean       ;OnValidate=VAR
                                                                UBPEvents@1240020000 : Codeunit 14000599;
                                                              BEGIN
                                                                // UBP >>
                                                                //UBPEvents.SalesHeaderOnAfterValidateExcludeFromUsage(Rec, xRec, 0);
                                                                // UBP <<
                                                              END;

                                                   CaptionML=ENU=Exclude from Usage }
    { 11123321;;Webshop Document State;Option     ;CaptionML=ENU=Webshop Document State;
                                                   OptionString=Normal,Basket,Wish List,Edit Order }
    { 11123399;;Unique Webshop Document Id;GUID   ;CaptionML=ENU=Unique Webshop Document Id;
                                                   Editable=No }
    { 14000350;;EDI Order          ;Boolean       ;CaptionML=ENU=EDI Order }
    { 14000351;;EDI Internal Doc. No.;Code10      ;TableRelation="E.D.I. Receive Document Hdr.";
                                                   CaptionML=ENU=EDI Internal Doc. No.;
                                                   Editable=No }
    { 14000354;;EDI Ack. Generated ;Boolean       ;CaptionML=ENU=EDI Ack. Generated;
                                                   Editable=No }
    { 14000355;;EDI Ack. Gen. Date ;Date          ;CaptionML=ENU=EDI Ack. Gen. Date;
                                                   Editable=No }
    { 14000360;;EDI Released       ;Boolean       ;CaptionML=ENU=EDI Released }
    { 14000361;;EDI WHSE Shp. Gen  ;Boolean       ;CaptionML=ENU=EDI WHSE Shp. Gen;
                                                   Editable=No }
    { 14000362;;EDI WHSE Shp. Gen Date;Date       ;CaptionML=ENU=EDI WHSE Shp. Gen Date;
                                                   Editable=No }
    { 14000365;;EDI Expected Delivery Date;Date   ;CaptionML=ENU=EDI Expected Delivery Date }
    { 14000366;;EDI Trade Partner  ;Code20        ;OnValidate=BEGIN
                                                                {
                                                                EDIIntegration.TradePtnrValidateSalesHdr(Rec);
                                                                MODIFY;
                                                                }
                                                                IF "EDI Trade Partner" <> xRec."EDI Trade Partner" THEN BEGIN
                                                                  VALIDATE("EDI Sell-to Code",'');
                                                                  VALIDATE("EDI Ship-for Code",'');
                                                                  VALIDATE("EDI Ship-to Code",'');
                                                                  "External Sell-to No." := '';
                                                                  "External Ship-to No." := '';
                                                                  "External Ship-for No." := '';
                                                                END;
                                                              END;

                                                   OnLookup=BEGIN
                                                              //EDIIntegration.TradePtnrLookupSalesHdr(Rec);
                                                            END;

                                                   CaptionML=ENU=EDI Trade Partner }
    { 14000367;;EDI Sell-to Code   ;Code20        ;OnValidate=BEGIN
                                                                //EDIIntegration.SellToCodeValidate(Rec);
                                                              END;

                                                   OnLookup=BEGIN
                                                              //EDIIntegration.SellToCodeLookup(Rec);
                                                            END;

                                                   CaptionML=ENU=EDI Sell-to Code }
    { 14000368;;EDI Ship-to Code   ;Code20        ;OnValidate=BEGIN
                                                                //EDIIntegration.ShipToCodeValidate(Rec,CurrFieldNo);
                                                              END;

                                                   OnLookup=BEGIN
                                                              //EDIIntegration.ShipToCodeLookup(Rec);
                                                            END;

                                                   CaptionML=ENU=EDI Ship-to Code }
    { 14000369;;EDI Ship-for Code  ;Code20        ;OnValidate=BEGIN
                                                                //EDIIntegration.ShipForCodeValidate(Rec);
                                                              END;

                                                   OnLookup=BEGIN
                                                              //EDIIntegration.ShipForCodeLookup(Rec);
                                                            END;

                                                   CaptionML=ENU=EDI Ship-for Code }
    { 14000370;;Order Status Required;Boolean     ;CaptionML=ENU=Order Status Required }
    { 14000371;;Pricing Discrepancy;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Sales Line Quote Buffer" WHERE (Document Type=FIELD(Document Type),
                                                                                                      Document No.=FIELD(No.),
                                                                                                      EDI Price Discrepancy=CONST(Yes)));
                                                   CaptionML=ENU=Pricing Discrepancy;
                                                   Editable=No }
    { 14000372;;EDI Cancel After Date;Date        ;CaptionML=ENU=EDI Cancel After Date }
    { 14000373;;Shipment Release   ;Boolean       ;CaptionML=ENU=Shipment Release }
    { 14000374;;EDI Invoice        ;Boolean       ;CaptionML=ENU=EDI Invoice }
    { 14000375;;EDI Cancellation Request;Boolean  ;CaptionML=ENU=EDI Cancellation Request }
    { 14000376;;EDI Cancellation Date;Date        ;CaptionML=ENU=EDI Cancellation Date;
                                                   Editable=No }
    { 14000379;;EDI Cancellation Advice;Boolean   ;CaptionML=ENU=EDI Cancellation Advice }
    { 14000380;;EDI Cancellation Advice Date;Date ;CaptionML=ENU=EDI Cancellation Advice Date;
                                                   Editable=No }
    { 14000381;;EDI Cancellation Generated;Boolean;CaptionML=ENU=EDI Cancellation Advice Generated;
                                                   Editable=No }
    { 14000382;;EDI Transaction Date;Date         ;CaptionML=ENU=EDI Transaction Date;
                                                   Editable=No }
    { 14000383;;EDI Transaction Time;Time         ;CaptionML=ENU=EDI Transaction Time;
                                                   Editable=No }
    { 14000391;;EDI Response to Request Req.;Boolean;
                                                   CaptionML=ENU=EDI Response to Request Req. }
    { 14000392;;EDI Response Generated;Boolean    ;CaptionML=ENU=EDI Response Generated;
                                                   Editable=No }
    { 14000393;;EDI Response Generated Date;Date  ;CaptionML=ENU=EDI Response Generated Date;
                                                   Editable=No }
    { 14000394;;EDI Quote Change Request;Boolean  ;CaptionML=ENU=EDI Quote Change Request }
    { 14000395;;EDI Quote Change Processed;Boolean;CaptionML=ENU=EDI Quote Change Processed;
                                                   Editable=No }
    { 14000396;;EDI Quote Change ProcessedDate;Date;
                                                   CaptionML=ENU=EDI Quote Change Processed Date;
                                                   Editable=No }
    { 14000601;;Total Qty. Received (base);Decimal;FieldClass=FlowField;
                                                   CalcFormula=Sum("Receive Line"."Quantity (Base)" WHERE (Source Type=CONST(50005),
                                                                                                           Source Subtype=FIELD(Document Type),
                                                                                                           Source ID=FIELD(No.),
                                                                                                           Type=FILTER('Account (G/L)'..Item),
                                                                                                           Location Code=FIELD(Location Filter)));
                                                   CaptionML=ENU=Total Qty. Received (base);
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 14000602;;Total Outstanding Qty. (base);Decimal;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Sum("Sales Line Quote Buffer"."Outstanding Qty. (Base)" WHERE (Document Type=FIELD(Document Type),
                                                                                                                              Document No.=FIELD(No.),
                                                                                                                              Type=FILTER(Item),
                                                                                                                              Drop Shipment=CONST(No),
                                                                                                                              Pack=CONST(Yes),
                                                                                                                              Location Code=FIELD(Location Filter)));
                                                   CaptionML=ENU=Total Outstanding Qty. (base);
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 14000603;;Total Return Qty to Rec (base);Decimal;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Sum("Sales Line Quote Buffer"."Return Qty. to Receive (Base)" WHERE (Document Type=FIELD(Document Type),
                                                                                                                                    Document No.=FIELD(No.),
                                                                                                                                    Type=FILTER(Item),
                                                                                                                                    Drop Shipment=CONST(No),
                                                                                                                                    Pack=CONST(Yes),
                                                                                                                                    Location Code=FIELD(Location Filter)));
                                                   CaptionML=ENU=Total Return Qty to Rec (base);
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 14000604;;Receive Exists     ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist(Receive WHERE (Source Type=CONST(50005),
                                                                                    Source Subtype=FIELD(Document Type),
                                                                                    Source ID=FIELD(No.),
                                                                                    Location Code=FIELD(Location Filter)));
                                                   CaptionML=ENU=Receive Exists;
                                                   Editable=No }
    { 14000701;;E-Ship Agent Service;Code30       ;TableRelation="E-Ship Agent Service".Code WHERE (Shipping Agent Code=FIELD(Shipping Agent Code),
                                                                                                    World Wide Service=FIELD(World Wide Service));
                                                   OnValidate=BEGIN

                                                                IF "E-Ship Agent Service" <> '' THEN BEGIN
                                                                  TESTFIELD("Shipping Agent Code");
                                                                  ShippingAgent.GET("Shipping Agent Code");
                                                                  EShipAgentService.ValidateEShipAgentService(
                                                                    ShippingAgent,"E-Ship Agent Service","Ship-to Country/Region Code");

                                                                  IF EShipAgentService."Default Shipping Agent Service" <> '' THEN
                                                                    IF "Shipping Agent Service Code" <> EShipAgentService."Default Shipping Agent Service" THEN
                                                                      VALIDATE("Shipping Agent Service Code",EShipAgentService."Default Shipping Agent Service");
                                                                END;

                                                                //<TPZ1446>
                                                                IF ("Free Freight" = FALSE) AND ("Free Freight Reason Code" <> '') THEN
                                                                  "Free Freight Reason Code" := '';
                                                                //<TPZ1446>

                                                                IF ("E-Ship Agent Service" <> xRec."E-Ship Agent Service") AND
                                                                   (CurrFieldNo = FIELDNO("E-Ship Agent Service"))
                                                                THEN BEGIN
                                                                  DeleteShippingAgentOptionPage;

                                                                  Package.RESET;
                                                                  Package.SETCURRENTKEY("Source Type","Source Subtype","Source ID");
                                                                  Package.SETRANGE("Source Type",DATABASE::"Sales Header Buffer");
                                                                  Package.SETRANGE("Source Subtype","Document Type");
                                                                  Package.SETRANGE("Source ID","No.");
                                                                  IF Package.FIND('-') THEN
                                                                    MESSAGE(Text14000701);
                                                                END;
                                                              END;

                                                   OnLookup=BEGIN
                                                              TESTFIELD("Shipping Agent Code");
                                                              ShippingAgent.GET("Shipping Agent Code");
                                                              EShipAgentService.LookupEShipAgentService(
                                                                ShippingAgent,"E-Ship Agent Service","Ship-to Country/Region Code");
                                                              IF PAGE.RUNMODAL(0,EShipAgentService) = ACTION::LookupOK THEN
                                                                VALIDATE("E-Ship Agent Service",EShipAgentService.Code);
                                                            END;

                                                   CaptionML=ENU=E-Ship Agent Service }
    { 14000702;;Total Qty. To Ship (base);Decimal ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Sales Line Quote Buffer"."Qty. to Ship (Base)" WHERE (Document Type=FIELD(Document Type),
                                                                                                                          Document No.=FIELD(No.),
                                                                                                                          Pack=CONST(Yes),
                                                                                                                          Location Code=FIELD(Location Filter),
                                                                                                                          Drop Shipment=CONST(No)));
                                                   CaptionML=ENU=Total Qty. To Ship (base);
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 14000703;;Total Qty. Packed (base);Decimal  ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Package Line"."Quantity (Base)" WHERE (Source Type=CONST(50005),
                                                                                                           Source Subtype=FIELD(Document Type),
                                                                                                           Source ID=FIELD(No.),
                                                                                                           Type=FILTER('Account (G/L)'..Resource),
                                                                                                           Location Code=FIELD(Location Filter)));
                                                   CaptionML=ENU=Total Qty. Packed (base);
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 14000704;;Residential Delivery;Boolean      ;CaptionML=ENU=Residential Delivery }
    { 14000705;;Free Freight       ;Boolean       ;OnValidate=BEGIN
                                                                //<TPZ2033>
                                                                TESTFIELD(Status,Status::Open);
                                                                //</TPZ2033>

                                                                // <TPZ844>
                                                                IF NOT "Free Freight" THEN BEGIN
                                                                  "No Free Freight Lines on Order" := FALSE;
                                                                  "Free Freight Reason Code" := '';
                                                                END;
                                                                // </TPZ844>
                                                              END;

                                                   CaptionML=ENU=Free Freight }
    { 14000706;;COD Payment        ;Boolean       ;CaptionML=ENU=COD Payment;
                                                   BlankZero=Yes }
    { 14000709;;World Wide Service ;Boolean       ;CaptionML=ENU=World Wide Service;
                                                   Editable=No }
    { 14000710;;Blind Shipment     ;Boolean       ;OnValidate=BEGIN
                                                                IF "Blind Shipment" THEN
                                                                  "Double Blind Shipment" := FALSE;
                                                              END;

                                                   CaptionML=ENU=Blind Shipment }
    { 14000711;;Double Blind Shipment;Boolean     ;OnValidate=BEGIN
                                                                IF "Double Blind Shipment" THEN
                                                                  "Blind Shipment" := FALSE
                                                                ELSE
                                                                  "Double Blind Ship-from Cust No" := '';
                                                              END;

                                                   CaptionML=ENU=Double Blind Shipment }
    { 14000712;;Double Blind Ship-from Cust No;Code20;
                                                   TableRelation=Customer;
                                                   OnValidate=BEGIN
                                                                IF "Double Blind Ship-from Cust No" <> '' THEN
                                                                  TESTFIELD("Double Blind Shipment");
                                                              END;

                                                   CaptionML=ENU=Double Blind Ship-from Cust No }
    { 14000713;;No Free Freight Lines on Order;Boolean;
                                                   OnValidate=BEGIN
                                                                TESTFIELD("Free Freight");
                                                              END;

                                                   CaptionML=ENU=No Free Freight Lines on Order }
    { 14000714;;COD Cashiers Check ;Boolean       ;CaptionML=ENU=COD Cashiers Check;
                                                   Editable=No }
    { 14000715;;E-Ship Whse. Outst. Qty (Base);Decimal;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Sum("Warehouse Activity Line"."Qty. Outstanding (Base)" WHERE (Activity Type=FILTER(Pick),
                                                                                                                              Source Type=CONST(50006),
                                                                                                                              Source Subtype=FIELD(Document Type),
                                                                                                                              Source No.=FIELD(No.),
                                                                                                                              Action Type=FILTER(' '|Take),
                                                                                                                              Breakbulk No.=FILTER(0),
                                                                                                                              Location Code=FIELD(Location Filter)));
                                                   CaptionML=ENU=E-Ship Whse. Outst. Qty (Base);
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 14000716;;Shipping Payment Type;Option      ;OnValidate=BEGIN
                                                                IF "Shipping Payment Type" = "Shipping Payment Type"::Prepaid THEN
                                                                  VALIDATE("Third Party Ship. Account No.",'')
                                                                ELSE
                                                                  IF ShippingAccount.GetPrimaryShippingAccountNo(
                                                                       "Shipping Agent Code",ShippingAccount."Ship-to Type"::Customer,
                                                                       "Sell-to Customer No.","Ship-to Code")
                                                                  THEN
                                                                    VALIDATE("Third Party Ship. Account No.",ShippingAccount."Account No.");
                                                              END;

                                                   CaptionML=ENU=Shipping Payment Type;
                                                   OptionCaptionML=ENU=Prepaid,Third Party,Freight Collect,Consignee;
                                                   OptionString=Prepaid,Third Party,Freight Collect,Consignee }
    { 14000717;;Third Party Ship. Account No.;Code20;
                                                   OnValidate=BEGIN
                                                                IF "Third Party Ship. Account No." <> '' THEN BEGIN
                                                                //<TPZ1454> EBAGIM  2016-03-25
                                                                  TESTFIELD("Shipping Payment Type","Shipping Payment Type"::"Third Party");
                                                                //<TPZ1454> EBAGIM  2016-03-25

                                                                  ShippingAccount."Shipping Agent Code" := "Shipping Agent Code";
                                                                  ShippingAccount.TestShippingAccountNo("Third Party Ship. Account No.");
                                                                END;

                                                                IF ("Third Party Ship. Account No." <> '') AND
                                                                   ("Shipping Payment Type" <> "Shipping Payment Type"::Prepaid)
                                                                THEN BEGIN
                                                                  CLEAR(ShippingAccount);

                                                                  IF NOT ShippingAccount.GET(
                                                                           ShippingAccount."Ship-to Type"::Customer,
                                                                           "Sell-to Customer No.","Ship-to Code","Shipping Agent Code",
                                                                           "Third Party Ship. Account No.")
                                                                  THEN BEGIN
                                                                    ShippingAccount.RESET;
                                                                    ShippingAccount.SETCURRENTKEY("Shipping Agent Code","Account No.");
                                                                    ShippingAccount.SETRANGE("Shipping Agent Code","Shipping Agent Code");
                                                                    ShippingAccount.SETRANGE("Account No.","Third Party Ship. Account No.");
                                                                    IF NOT ShippingAccount.FIND('-') THEN
                                                                      ;
                                                                  END;

                                                                  IF (ShippingAccount."Account No." <> '') AND
                                                                     ("Shipping Payment Type" <> "Shipping Payment Type"::Prepaid)
                                                                  THEN
                                                                    "Shipping Insurance" := ShippingAccount."Shipping Insurance";
                                                                END;
                                                              END;

                                                   OnLookup=BEGIN
                                                              IF ShippingAccount.LookupThirdPartyAccountNo(
                                                                   "Shipping Agent Code",ShippingAccount."Ship-to Type"::Customer,
                                                                   "Sell-to Customer No.","Ship-to Code")
                                                              THEN
                                                                VALIDATE("Third Party Ship. Account No.",ShippingAccount.GetLookupAccountNo);
                                                            END;

                                                   CaptionML=ENU=Third Party Ship. Account No. }
    { 14000718;;Shipping Insurance ;Option        ;CaptionML=ENU=Shipping Insurance;
                                                   OptionCaptionML=ENU=" ,Never,Always";
                                                   OptionString=[ ,Never,Always] }
    { 14000719;;E-Ship Whse. Ship. Qty (Base);Decimal;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Sum("Warehouse Shipment Line"."Qty. to Ship (Base)" WHERE (Source Type=CONST(50006),
                                                                                                                          Source Subtype=FIELD(Document Type),
                                                                                                                          Source No.=FIELD(No.),
                                                                                                                          Location Code=FIELD(Location Filter)));
                                                   CaptionML=ENU=E-Ship Whse. Ship. Qty (Base);
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 14000720;;E-Ship Invt. Outst. Qty (Base);Decimal;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Sum("Warehouse Activity Line"."Qty. Outstanding (Base)" WHERE (Activity Type=FILTER(Invt. Pick),
                                                                                                                              Source Type=CONST(50006),
                                                                                                                              Source Subtype=FIELD(Document Type),
                                                                                                                              Source No.=FIELD(No.),
                                                                                                                              Action Type=FILTER(' '|Take),
                                                                                                                              Breakbulk No.=FILTER(0),
                                                                                                                              Location Code=FIELD(Location Filter)));
                                                   CaptionML=ENU=E-Ship Invt. Outst. Qty (Base);
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 14000722;;E-Ship Outst. Lines Exists;Boolean;FieldClass=FlowField;
                                                   CalcFormula=Exist("Sales Line Quote Buffer" WHERE (Document Type=FIELD(Document Type),
                                                                                                      Document No.=FIELD(No.),
                                                                                                      No.=FILTER(<>''),
                                                                                                      Outstanding Quantity=FILTER(<>0),
                                                                                                      Pack=CONST(Yes),
                                                                                                      Drop Shipment=CONST(No),
                                                                                                      Location Code=FIELD(Location Filter)));
                                                   CaptionML=ENU=E-Ship Outst. Lines Exists;
                                                   Editable=No }
    { 14000723;;Exists on Bill of Lading;Boolean  ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Bill of Lading Line" WHERE (Type=CONST(Order),
                                                                                                  No.=FIELD(No.),
                                                                                                  Closed=CONST(No),
                                                                                                  Location Code=FIELD(Location Filter),
                                                                                                  Source Type=CONST(50005),
                                                                                                  Source Subtype=FIELD(Document Type),
                                                                                                  Source ID=FIELD(No.)));
                                                   CaptionML=ENU=Exists on Bill of Lading;
                                                   Editable=No }
    { 14000724;;Package Exists     ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist(Package WHERE (Source Type=CONST(50005),
                                                                                    Source Subtype=FIELD(Document Type),
                                                                                    Source ID=FIELD(No.),
                                                                                    Location Code=FIELD(Location Filter)));
                                                   CaptionML=ENU=Package Exists;
                                                   Editable=No }
    { 14000725;;Warehouse Shipment Exists;Boolean ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Warehouse Shipment Line" WHERE (Source Type=FILTER(50006),
                                                                                                      Source Subtype=FIELD(Document Type),
                                                                                                      Source No.=FIELD(No.),
                                                                                                      Location Code=FIELD(Location Filter)));
                                                   CaptionML=ENU=Warehouse Shipment Exists;
                                                   Editable=No }
    { 14000726;;Inventory Pick Exists;Boolean     ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Warehouse Activity Line" WHERE (Activity Type=CONST(Invt. Pick),
                                                                                                      Source Type=FILTER(50006|25000),
                                                                                                      Source Subtype=FIELD(Document Type),
                                                                                                      Source No.=FIELD(No.),
                                                                                                      Location Code=FIELD(Location Filter)));
                                                   CaptionML=ENU=Inventory Pick Exists;
                                                   Editable=No }
    { 14000825;;Ship-for Code      ;Code20        ;TableRelation="Ship-to Address".Code WHERE (Customer No.=FIELD(Sell-to Customer No.));
                                                   OnValidate=VAR
                                                                ShipToAddr@14000351 : Record 222;
                                                              BEGIN
                                                                IF "Ship-for Code" <> '' THEN BEGIN
                                                                  ShipToAddr.GET("Sell-to Customer No.","Ship-for Code");
                                                                  "External Ship-for No." := ShipToAddr."External No.";
                                                                  IF ShipToAddr."Dist. Center Ship-to Code" <> '' THEN
                                                                    VALIDATE("Ship-to Code",ShipToAddr."Dist. Center Ship-to Code")
                                                                  ELSE
                                                                    VALIDATE("Ship-to Code","Ship-for Code");
                                                                END ELSE
                                                                  "External Ship-for No." := '';
                                                              END;

                                                   CaptionML=ENU=Ship-for Code }
    { 14000826;;External Sell-to No.;Code20       ;CaptionML=ENU=External Sell-to No. }
    { 14000827;;External Ship-to No.;Code20       ;CaptionML=ENU=External Ship-to No. }
    { 14000828;;External Ship-for No.;Code20      ;CaptionML=ENU=External Ship-for No. }
    { 14000829;;Invoice for Bill of Lading No.;Code20;
                                                   TableRelation="Bill of Lading";
                                                   CaptionML=ENU=Invoice for Bill of Lading No. }
    { 14000831;;Invoice for Shipment No.;Code20   ;TableRelation="Sales Shipment Header".No. WHERE (Order No.=FIELD(No.),
                                                                                                    Shipment Invoice No.=FILTER(''));
                                                   OnValidate=VAR
                                                                Shipping@14000700 : Codeunit 14000701;
                                                              BEGIN
                                                                IF "Invoice for Shipment No." <> '' THEN BEGIN
                                                                  TESTFIELD("Shipment Invoice Override",FALSE);

                                                                  SalesShptHeader.GET("Invoice for Shipment No.");
                                                                  SalesShptHeader.TESTFIELD("Shipment Invoice No.",'');

                                                                  IF SalesShptHeader."Bill of Lading No." <> '' THEN
                                                                    VALIDATE("Invoice for Bill of Lading No.",SalesShptHeader."Bill of Lading No.");

                                                                  //Shipping.SetShipmentInvoiceQty(Rec);
                                                                END;
                                                              END;

                                                   CaptionML=ENU=Invoice for Shipment No. }
    { 14000832;;Shipment Invoice Override;Boolean ;OnValidate=BEGIN
                                                                IF "Shipment Invoice Override" THEN
                                                                  TESTFIELD("Invoice for Shipment No.",'');
                                                              END;

                                                   CaptionML=ENU=Shipment Invoice Override }
    { 14000901;;E-Mail Confirmation Handled;Boolean;
                                                   CaptionML=ENU=E-Mail Confirmation Handled }
    { 23044500;;WMDM POS           ;Boolean       ;CaptionML=[ENU=WMDM POS;
                                                              ESM=WMDM POS;
                                                              FRC=WMDM POS;
                                                              ENC=WMDM POS];
                                                   Description=WMDM - if true PDA will allow line creation }
  }
  KEYS
  {
    {    ;Document Type,No.                       ;Clustered=Yes }
    {    ;No.,Document Type                        }
    {    ;Document Type,Sell-to Customer No.       }
    {    ;Document Type,Bill-to Customer No.       }
    {    ;Document Type,Combine Shipments,Bill-to Customer No.,Currency Code,EU 3-Party Trade,Dimension Set ID }
    {    ;Sell-to Customer No.,External Document No. }
    {    ;Document Type,Sell-to Contact No.        }
    {    ;Bill-to Contact No.                      }
    {    ;Incoming Document Entry No.              }
    {    ;Document Date                            }
    {    ;EDI Order,EDI Trade Partner,EDI Internal Doc. No.;
                                                   KeyGroups=SE-EDI }
    {    ;Document Type,EDI Trade Partner,External Document No.,Sell-to Customer No.,Ship-to Code;
                                                   KeyGroups=SE-EDI }
    {    ;Order Date                               }
    {    ;Sell-to Contact                          }
    {    ;Bill-to Name                             }
    {    ;Ship-to Name                             }
    {    ;Status                                   }
  }
  FIELDGROUPS
  {
    { 1   ;Brick               ;No.,Sell-to Customer Name,Amount,Sell-to Contact,Amount Including VAT }
  }
  CODE
  {
    VAR
      Text003@1003 : TextConst 'ENU=You cannot rename a %1.;ESM=No se puede cambiar el nombre a %1.;FRC=Vous ne pouvez pas renommer un %1.;ENC=You cannot rename a %1.';
      ConfirmChangeQst@1004 : TextConst '@@@="%1 = a Field Caption like Currency Code";ENU=Do you want to change %1?;ESM=¨Confirma que desea cambiar %1?;FRC=D‚sirez-vous modifier %1?;ENC=Do you want to change %1?';
      Text005@1005 : TextConst 'ENU=You cannot reset %1 because the document still has one or more lines.;ESM=No se puede modificar el cliente %1 ya que el documento tiene una o m s l¡neas.;FRC=Impossible de remettre %1 … z‚ro parce que le document a toujours une ou plusieurs lignes.;ENC=You cannot reset %1 because the document still has one or more lines.';
      Text006@1006 : TextConst 'ENU=You cannot change %1 because the order is associated with one or more purchase orders.;ESM=No se puede cambiar %1 porque el pedido est  asociado a pedidos de compra.;FRC=Vous ne pouvez changer %1 parce que la commande est associ‚e … un ou plusieurs bon(s) de commande.;ENC=You cannot change %1 because the order is associated with one or more purchase orders.';
      Text007@1007 : TextConst 'ENU=%1 cannot be greater than %2 in the %3 table.;ESM=En la tabla %3, %1 no puede ser mayor que %2.;FRC=%1 ne peut ˆtre plus grand que %2 dans la table %3.;ENC=%1 cannot be greater than %2 in the %3 table.';
      Text009@1009 : TextConst 'ENU=Deleting this document will cause a gap in the number series for shipments. An empty shipment %1 will be created to fill this gap in the number series.\\Do you want to continue?;ESM=Si elimina el documento, se provocar  una discontinuidad en la numeraci¢n de la serie de remisiones. Un env¡o dev. vac¡o %1 se crear  para llenar este error en las series num‚ricas.\\¨Desea continuar?;FRC=La suppression de ce document va engendrer un ‚cart dans la s‚rie de num‚ros livraison. Une livraison vide %1 va ˆtre cr‚‚e pour ‚viter un ‚cart dans la s‚rie de num‚ros.\\Voulez-vous continuerÿ?;ENC=Deleting this document will cause a gap in the number series for shipments. An empty shipment %1 will be created to fill this gap in the number series.\\Do you want to continue?';
      Text012@1012 : TextConst 'ENU=Deleting this document will cause a gap in the number series for posted invoices. An empty posted invoice %1 will be created to fill this gap in the number series.\\Do you want to continue?;ESM=Si elimina el documento se provocar  una discontinuidad en la numeraci¢n de la serie de facturas registradas. Se crear  una factura registrada en blanco %1 para completar este error en las series num‚ricas.\\¨Desea continuar?;FRC=La suppression de ce document va engendrer un ‚cart dans la s‚rie de num‚ros des factures report‚es. Une facture report‚e vide %1 va ˆtre cr‚‚e pour ‚viter un ‚cart dans la s‚rie de num‚ros.\\Voulez-vous continuerÿ?;ENC=Deleting this document will cause a gap in the number series for posted invoices. An empty posted invoice %1 will be created to fill this gap in the number series.\\Do you want to continue?';
      Text014@1014 : TextConst 'ENU=Deleting this document will cause a gap in the number series for posted credit memos. An empty posted credit memo %1 will be created to fill this gap in the number series.\\Do you want to continue?;ESM=Si elimina el documento, se provocar  una discontinuidad en la numeraci¢n de la serie de notas de cr‚dito registradas. Se crear  un nota cr‚dito regis. en blanco %1 para completar este error en las series num‚ricas.\\¨Desea continuar?;FRC=La suppression de ce document va engendrer un ‚cart dans la s‚rie de num‚ros d''avoirs report‚s. Un avoir report‚ vide %1 va ˆtre cr‚‚ pour ‚viter un ‚cart dans la s‚rie de num‚ros.\\Voulez-vous continuerÿ?;ENC=Deleting this document will cause a gap in the number series for posted credit memos. An empty posted credit memo %1 will be created to fill this gap in the number series.\\Do you want to continue?';
      Text015@1015 : TextConst 'ENU=If you change %1, the existing sales lines will be deleted and new sales lines based on the new information on the header will be created.\\Do you want to change %1?;ESM=Si cambia %1, se eliminar n las l¡ns. venta actuales y se crear n nuevas l¡ns. venta bas ndose en informaci¢n de la cabecera.\\¨Desea cambiar %1?;FRC=Si vous modifiez %1, les lignes vente existantes seront supprim‚es et de nouvelles lignes vente bas‚es sur les nouvelles informations sur l''en-tˆte seront cr‚‚es.\\Voulez-vous modifier %1ÿ?;ENC=If you change %1, the existing sales lines will be deleted and new sales lines based on the new information on the header will be created.\\Do you want to change %1?';
      Text017@1017 : TextConst 'ENU=You must delete the existing sales lines before you can change %1.;ESM=Se deben eliminar las l¡neas de venta existentes antes de cambiar %1.;FRC=Vous devez supprimer les lignes de ventes existantes avant de pouvoir changer %1.;ENC=You must delete the existing sales lines before you can change %1.';
      Text018@1018 : TextConst 'ENU=You have changed %1 on the sales header, but it has not been changed on the existing sales lines.\;ESM=Se ha modificado %1 en cab. ventas, pero no se ha modificado en las l¡neas de venta.\;FRC=Vous avez chang‚ %1 dans l''en-tˆte des ventes, mais vous ne l''avez pas chang‚ dans les lignes de ventes existantes.\;ENC=You have changed %1 on the sales header, but it has not been changed on the existing sales lines.\';
      Text019@1019 : TextConst 'ENU=You must update the existing sales lines manually.;ESM=Debe actualizar las l¡neas de venta existentes manualmente.;FRC=Vous devez mettre … jour les lignes de ventes existantes manuellement.;ENC=You must update the existing sales lines manually.';
      Text020@1020 : TextConst 'ENU=The change may affect the exchange rate used in the price calculation of the sales lines.;ESM=El cambio puede afectar al tipo de cambio utilizado en el c lculo del precio en las l¡neas de vtas.;FRC=Le taux de change peut affecter le calcul de prix sur les lignes de ventes.;ENC=The change may affect the exchange rate used in the price calculation of the sales lines.';
      Text021@1021 : TextConst 'ENU=Do you want to update the exchange rate?;ESM=¨Confirma que desea modificar el tipo de cambio?;FRC=Voulez-vous mettre … jour le taux de change?;ENC=Do you want to update the exchange rate?';
      Text022@1022 : TextConst 'ENU=You cannot delete this document. Your identification is set up to process from %1 %2 only.;ESM=No puede borrar este documento. Su identificaci¢n est  configurada s¢lo para procesar %1 %2.;FRC=Vous ne pouvez pas supprimer ce document. Le param‚trage de votre code utilisateur ne vous permet de travailler que sur %1 %2.;ENC=You cannot delete this document. Your identification is set up to process from %1 %2 only.';
      Text024@1024 : TextConst 'ENU=You have modified the %1 field. The recalculation of tax may cause penny differences, so you must check the amounts afterward. Do you want to update the %2 field on the lines to reflect the new value of %1?;ESM=Ha modificado el campo %1. El nuevo c lculo de IVA puede tener alguna diferencia, por lo que deber¡a comprobar los importes. ¨Desea actualizar el campo %2 en la l¡neas para reflejar el nuevo valor de %1?;FRC=Vous avez modifi‚ le champ %1. Le nouveau calcul de la TVA va engendrer de petites diff‚rences. Veuillez v‚rifier les montants. Souhaitez-vous mettre … jour le champ %2 sur les lignes pour refl‚ter la nouvelle valeur de %1ÿ?;ENC=You have modified the %1 field. The recalculation of tax may cause penny differences, so you must check the amounts afterwards. Do you want to update the %2 field on the lines to reflect the new value of %1?';
      Text027@1027 : TextConst 'ENU=Your identification is set up to process from %1 %2 only.;ESM=Su identificaci¢n est  configurada para procesar s¢lo desde %1 %2.;FRC=Le param‚trage de votre code utilisateur ne vous permet de travailler que sur %1 %2.;ENC=Your identification is set up to process from %1 %2 only.';
      Text028@1028 : TextConst 'ENU=You cannot change the %1 when the %2 has been filled in.;ESM=No puede cambiar %1 despu‚s de introducir datos en %2.;FRC=Vous ne pouvez pas modifier le champ %1 lorsque le champ %2 a ‚t‚ renseign‚.;ENC=You cannot change the %1 when the %2 has been filled in.';
      Text030@1030 : TextConst 'ENU=Deleting this document will cause a gap in the number series for return receipts. An empty return receipt %1 will be created to fill this gap in the number series.\\Do you want to continue?;ESM=Eliminar este documento causar  un error en la serie num‚rica de las recep. devol. Se crear  una recep. devoluc. %1 para completar este error en las series num‚ricas.\\¨Desea continuar?;FRC=La suppression de ce document va engendrer un ‚cart dans la s‚rie de num‚ros des r‚ceptions retour. Une r‚ception retour vide %1 va ˆtre cr‚‚e pour ‚viter un ‚cart dans la s‚rie de num‚ros.\\Voulez-vous continuerÿ?;ENC=Deleting this document will cause a gap in the number series for return receipts. An empty return receipt %1 will be created to fill this gap in the number series.\\Do you want to continue?';
      Text031@1031 : TextConst 'ENU=You have modified %1.\\;ESM=Ha modificado %1.\\;FRC=Vous avez modifi‚ le champ %1.\\;ENC=You have modified %1.\\';
      Text032@1032 : TextConst 'ENU=Do you want to update the lines?;ESM=¨Confirma que desea actualizar las l¡neas?;FRC=Souhaitez-vous mettre les lignes … jour ?;ENC=Do you want to update the lines?';
      SalesSetup@1033 : Record 311;
      GLSetup@1034 : Record 98;
      GLAcc@1035 : Record 15;
      SalesHeader@1000000017 : Record 50005;
      SalesLine@1000000036 : Record 50006;
      MfrRep@1000000018 : Record 50027;
      MfrRepCommExcp@1000000016 : Record 51701;
      MfrRepDivComm@1000000015 : Record 51711;
      LocationDivHdlgPct@1000000014 : Record 51712;
      CustLedgEntry@1038 : Record 21;
      Cust@1039 : Record 18;
      PaymentTermDayRange@1000000034 : Record 50033;
      PaymentTerms@1040 : Record 3;
      PaymentMethod@1041 : Record 289;
      CurrExchRate@1042 : Record 330;
      SalesCommentLine@1043 : Record 44;
      PostCode@1045 : Record 225;
      BankAcc@1046 : Record 270;
      SalesShptHeader@1047 : Record 110;
      SalesInvHeader@1048 : Record 112;
      SalesCrMemoHeader@1049 : Record 114;
      ReturnRcptHeader@1050 : Record 6660;
      SalesInvHeaderPrepmt@1101 : Record 112;
      SalesCrMemoHeaderPrepmt@1100 : Record 114;
      GenBusPostingGrp@1051 : Record 250;
      RespCenter@1053 : Record 5714;
      InvtSetup@1054 : Record 313;
      Location@1055 : Record 14;
      WhseRequest@1056 : Record 5765;
      ReservEntry@1001 : Record 337;
      TempReservEntry@1000 : TEMPORARY Record 337;
      CompanyInfo@1002 : Record 79;
      UserSetupMgt@1058 : Codeunit 5700;
      NoSeriesMgt@1059 : Codeunit 396;
      CustCheckCreditLimit@1060 : Codeunit 312;
      ShippingAgent@14000701 : Record 291;
      Package@14000702 : Record 14000701;
      EShipAgentService@14000705 : Record 14000708;
      ShippingAccount@14000706 : Record 14000714;
      ReceiveHeader@14000700 : Record 14000601;
      DimMgt@1065 : Codeunit 408;
      ApprovalsMgmt@1082 : Codeunit 1535;
      WhseSourceHeader@1073 : Codeunit 5781;
      ArchiveManagement@1075 : Codeunit 5063;
      SalesLineReserve@1066 : Codeunit 99000832;
      EDIIntegration@14000351 : Codeunit 14000363;
      RunFromEDI@14000352 : Boolean;
      EDITemp@14000353 : Boolean;
      CurrencyDate@1068 : Date;
      HideValidationDialog@1069 : Boolean;
      Confirmed@1070 : Boolean;
      Text035@1076 : TextConst 'ENU=You cannot Release Quote or Make Order unless you specify a customer on the quote.\\Do you want to create customer(s) now?;ESM=No puede lanzar cotizaci¢n o hacer pedido hasta que especifique un cliente en la cotizaci¢n.\\¨Quiere crear un cliente(s) ahora?;FRC=Vous ne pouvez pas ‚mettre un devis ou cr‚er une commande … moins de sp‚cifier un client sur le devis.\\Souhaitez-vous cr‚er un client maintenant ?;ENC=You cannot Release Quote or Make Order unless you specify a customer on the quote.\\Do you want to create customer(s) now?';
      Text037@1078 : TextConst 'ENU=Contact %1 %2 is not related to customer %3.;ESM=Contacto %1 %2 no est  relacionado con el cliente %3.;FRC=Le contact %1 %2 n''est pas associ‚ au client %3.;ENC=Contact %1 %2 is not related to customer %3.';
      Text038@1074 : TextConst 'ENU=Contact %1 %2 is related to a different company than customer %3.;ESM=Contacto %1 %2 est  relacionado con una empresa diferente al cliente %3.;FRC=Le contact %1 %2 est associ‚ … une compagnie diff‚rente de celle du client %3.;ENC=Contact %1 %2 is related to a different company than customer %3.';
      Text039@1086 : TextConst 'ENU=Contact %1 %2 is not related to a customer.;ESM=Contacto %1 %2 no est  relacionado con un cliente.;FRC=Le contact %1 %2 n''est pas associ‚ … un client.;ENC=Contact %1 %2 is not related to a customer.';
      Text040@1083 : TextConst 'ENU=A won opportunity is linked to this order.\It has to be changed to status Lost before the Order can be deleted.\Do you want to change the status for this opportunity now?;ESM=Una oportunidad ganada est  vinculada a este pedido.\Antes de poder eliminar el pedido, debe cambiar el estado a Perdida.\¨Desea cambiar el estado para esta oportunidad?;FRC=Une opportunit‚ gagn‚e est associ‚e … cette commande.\L''‚tat doit ˆtre d‚fini sur Perdue pour pouvoir supprimer la commande.\Souhaitez-vous modifier l''‚tat de cette opportunit‚ maintenantÿ?;ENC=A won opportunity is linked to this order.\It has to be changed to status Lost before the Order can be deleted.\Do you want to change the status for this opportunity now?';
      Text044@1088 : TextConst 'ENU=The status of the opportunity has not been changed. The program has aborted deleting the order.;ESM=No se ha cambiado el estado de la oportunidad. El programa ha anulado la eliminaci¢n del pedido.;FRC=L''‚tat de l''opportunit‚ n''a pas ‚t‚ modifi‚. Le systŠme a abandonn‚ la suppression de la commande.;ENC=The status of the opportunity has not been changed. The program has aborted deleting the order.';
      SkipSellToContact@1016 : Boolean;
      SkipBillToContact@1025 : Boolean;
      Text045@1081 : TextConst 'ENU="You can not change the %1 field because %2 %3 has %4 = %5 and the %6 has already been assigned %7 %8.";ESM="No puede cambiar el campo %1 porque %2 %3 tiene %4 = %5 y ya se ha asignado el %6 a %7 %8.";FRC="Vous ne pouvez pas modifier le champ %1, puisque %2 %3 a un %4 = %5 et que le %6 a d‚j… ‚t‚ attribu‚ … %7 %8.";ENC="You can not change the %1 field because %2 %3 has %4 = %5 and the %6 has already been assigned %7 %8."';
      Text048@1091 : TextConst 'ENU=Sales quote %1 has already been assigned to opportunity %2. Would you like to reassign this quote?;ESM=La cotizaci¢n de ventas %1 ya fue asignada a la oportunidad %2. ¨Desea volver a asignar la cotizaci¢n?;FRC=Le devis %1 a d‚j… ‚t‚ affect‚ … l''opportunit‚ %2. Voulez-vous r‚affecter ce devis?;ENC=Sales quote %1 has already been assigned to opportunity %2. Would you like to reassign this quote?';
      Text049@1092 : TextConst 'ENU=The %1 field cannot be blank because this quote is linked to an opportunity.;ESM=El campo %1 no puede estar vac¡o porque la cotizaci¢n est  asociada a una oportunidad.;FRC=On ne peut pas laisser le champ %1 vide car ce devis est li‚ … une opportunit‚.;ENC=The %1 field cannot be blank because this quote is linked to an opportunity.';
      InsertMode@1093 : Boolean;
      HideCreditCheckDialogue@1097 : Boolean;
      Text051@1071 : TextConst 'ENU=The sales %1 %2 already exists.;ESM=Ya existen las ventas %1 %2.;FRC=Les ventes %1 %2 existent d‚j….;ENC=The sales %1 %2 already exists.';
      Text053@1102 : TextConst 'ENU=You must cancel the approval process if you wish to change the %1.;ESM=Debe cancelar el proceso de aprobaci¢n si desea cambiar el %1.;FRC=Vous devez annuler le processus d''approbation si vous voulez changer le %1.;ENC=You must cancel the approval process if you wish to change the %1.';
      Text056@1105 : TextConst 'ENU=Deleting this document will cause a gap in the number series for prepayment invoices. An empty prepayment invoice %1 will be created to fill this gap in the number series.\\Do you want to continue?;ESM=Si elimina el documento, se provocar  una discontinuidad en la numeraci¢n de la serie de facturas de anticipo. Se crear  una factura anticipo en blanco %1 para completar este error en las series num‚ricas.\\¨Desea continuar?;FRC=La suppression de ce document va engendrer un ‚cart dans la s‚rie de num‚ros des factures de paiement anticip‚. Une facture de paiement anticip‚ vide %1 va ˆtre cr‚‚e pour ‚viter un ‚cart dans la s‚rie de num‚ros.\\Voulez-vous continuer?;ENC=Deleting this document will cause a gap in the number series for prepayment invoices. An empty prepayment invoice %1 will be created to fill this gap in the number series.\\Do you want to continue?';
      Text057@1108 : TextConst 'ENU=Deleting this document will cause a gap in the number series for prepayment credit memos. An empty prepayment credit memo %1 will be created to fill this gap in the number series.\\Do you want to continue?;ESM=Si elimina el documento, se provocar  una discontinuidad en la numeraci¢n de la serie de notas de cr‚dito de anticipo. Se crear  una nota de cr‚dito anticipo en blanco %1 para completar este error en las series num‚ricas.\\¨Desea continuar?;FRC=La suppression de ce document va engendrer un ‚cart dans la s‚rie de num‚ros des notes de cr‚dit de paiement anticip‚. Une note de cr‚dit de paiement anticip‚ vide %1 va ˆtre cr‚‚e pour ‚viter un ‚cart dans la s‚rie de num‚ros.\\Voulez-vous continuer?;ENC=Deleting this document will cause a gap in the number series for prepayment credit memos. An empty prepayment credit memo %1 will be created to fill this gap in the number series.\\Do you want to continue?';
      Text061@1110 : TextConst 'ENU=%1 is set up to process from %2 %3 only.;ESM=Se ha configurado %1 para procesar s¢lo desde %2 %3.;FRC=Le param‚trage de %1 ne permet de traiter que %2 %3.;ENC=%1 is set up to process from %2 %3 only.';
      Text062@1072 : TextConst 'ENU=You cannot change %1 because the corresponding %2 %3 has been assigned to this %4.;ESM=No puede cambiar %1 porque el %2 %3 correspondiente ha sido asignado a este %4.;FRC=Vous ne pouvez pas modifier %1 car le %2 %3 correspondant a ‚t‚ affect‚ … ce %4.;ENC=You cannot change %1 because the corresponding %2 %3 has been assigned to this %4.';
      Text063@1077 : TextConst 'ENU=Reservations exist for this order. These reservations will be canceled if a date conflict is caused by this change.\\Do you want to continue?;ESM=Existen reservas para este pedido. Dichas reservas se cancelar n si este cambio provoca un conflicto de fechas.\\¨Desea continuar?;FRC=Il existe des r‚servations pour cette commande. Ces r‚servations seront annul‚es si cette modification entraŒne un conflit de dates.\\Voulez-vous continuerÿ?;ENC=Reservations exist for this order. These reservations will be cancelled if a date conflict is caused by this change.\\Do you want to continue?';
      Text064@1090 : TextConst 'ENU=You may have changed a dimension.\\Do you want to update the lines?;ESM=Puede que haya cambiado una dimensi¢n.\\¨Desea actualizar las l¡neas?;FRC=Vous avez probablement modifi‚ une dimension.\\Souhaitez-vous mettre … jour les lignesÿ?;ENC=You may have changed a dimension.\\Do you want to update the lines?';
      EDITradePrtnrDivExcp@1000000033 : Record 50040;
      UpdateDocumentDate@1120 : Boolean;
      Text066@1095 : TextConst 'ENU=You cannot change %1 to %2 because an open inventory pick on the %3.;ESM=No puede cambiar %1 a %2 debido a un picking de inventario abierto en %3.;FRC=Vous ne pouvez pas modifier %1 en %2 car un pr‚lŠvement inventaire est ouvert sur %3.;ENC=You cannot change %1 to %2 because an open inventory pick on the %3.';
      Text070@1096 : TextConst 'ENU=You cannot change %1  to %2 because an open warehouse shipment exists for the %3.;ESM=No puede cambiar %1 a %2 debido a que existe un env¡o de almac‚n abierto para %3.;FRC=Vous ne pouvez pas modifier %1 en %2 car il existe une livraison entrep“t ouverte pour %3.;ENC=You cannot change %1  to %2 because an open warehouse shipment exists for the %3.';
      BilltoCustomerNoChanged@1121 : Boolean;
      Text071@1011 : TextConst 'ENU=There are unpaid prepayment invoices that are related to the document of type %1 with the number %2.;ESM=Hay facturas de anticipo sin pagar relacionadas con el documento de tipo %1 con el n£mero %2.;FRC=Il existe des factures de paiement anticip‚ impay‚es li‚es au document de type %1 portant le num‚ro %2.;ENC=There are unpaid prepayment invoices that are related to the document of type %1 with the number %2.';
      Text072@1013 : TextConst 'ENU=There are unpaid prepayment invoices related to the document of type %1 with the number %2.;ESM=Hay facturas anticipo sin pagar relacionadas con el documento de tipo %1 con el n£mero %2.;FRC=Il existe des factures de paiement anticip‚ impay‚es li‚es au document de type %1 portant le num‚ro %2.;ENC=There are unpaid prepayment invoices related to the document of type %1 with the number %2.';
      PrepmtIncludeTaxErr@1020001 : TextConst '@@@=%1 is the feildname Prepmt. Include Tax;ENU=You cannot select the %1 field for foreign currencies.;ESM=No puede seleccionar el campo %1 para monedas extranjeras.;FRC=Vous ne pouvez pas s‚lectionner le champ %1 pour des devises ‚trangŠres.;ENC=You cannot select the %1 field for foreign currencies.';
      PrepmtInvoiceExistsErr@1020002 : TextConst 'ENU=You cannot change %1 because there is a posted Prepayment Invoice.;ESM=No puede cambiar el valor de %1 porque hay una factura de anticipo registrada.;FRC=Vous ne pouvez pas modifier %1 parce qu''une facture pour paiement anticip‚ est report‚e.;ENC=You cannot change %1 because there is a posted Prepayment Invoice.';
      DeferralLineQst@1044 : TextConst 'ENU=Do you want to update the deferral schedules for the lines?;ESM=¨Desea actualizar las previsiones de fraccionamiento para las l¡neas?;FRC=Souhaitez-vous mettre … jour les tableaux d''‚chelonnement pour les lignesÿ?;ENC=Do you want to update the deferral schedules for the lines?';
      SynchronizingMsg@1026 : TextConst 'ENU=Synchronizing ...\ from: Sales Header with %1\ to: Assembly Header with %2.;ESM=Sincronizando...\ desde: encabezado de ventas con %1\ hasta: encabezado de ensamblado con %2.;FRC=Synchronisation ...\ deÿ: En-tˆte vente avec %1\ versÿ: En-tˆte assemblage avec %2.;ENC=Synchronizing ...\ from: Sales Header with %1\ to: Assembly Header with %2.';
      ShippingAdviceErr@1029 : TextConst 'ENU=This order must be a complete shipment.;ESM=Este pedido debe ser un env¡o completo.;FRC=Cet ordre doit ˆtre une livraison trait‚e.;ENC=This order must be a complete shipment.';
      PostedDocsToPrintCreatedMsg@1084 : TextConst 'ENU=One or more related posted documents have been generated during deletion to fill gaps in the posting number series. You can view or print the documents from the respective document archive.;ESM=Durante la eliminaci¢n, se han generado uno o m s documentos registrados relacionados en sustituci¢n de los n£meros de registro que faltan de la serie. Puede ver o imprimir los documentos del archivo de documentos correspondiente.;FRC=Un ou plusieurs documents report‚s connexes ont ‚t‚ g‚n‚r‚s lors de la suppression pour ‚viter une discontinuit‚ dans la s‚rie de num‚ros de report. Vous pouvez afficher ou imprimer les documents … partir de l''archive de document correspondant.;ENC=One or more related posted documents have been generated during deletion to fill gaps in the posting number series. You can view or print the documents from the respective document archive.';
      SellToCustomerTxt@1052 : TextConst 'ENU=Sell-to Customer;ESM=Cliente de venta;FRC=Donneur d''ordre;ENC=Sell-to Customer';
      BillToCustomerTxt@1057 : TextConst 'ENU=Customer;ESM=Cliente de facturaci¢n;FRC=Client factur‚;ENC=Customer';
      DocumentNotPostedClosePageQst@1061 : TextConst 'ENU=The document has not been posted.\Are you sure you want to exit?;ESM=El documento no se registr¢.\¨Est  seguro de que desea salir?;FRC=Le document n''a pas ‚t‚ report‚.\Voulez-vous vraiment quitter?;ENC=The document has not been posted.\Are you sure you want to exit?';
      Text14000701@14000707 : TextConst 'ENU=Packages already exist for this order.';
      Text14000702@14000708 : TextConst 'ENU=Nothing to Receive';
      Text14000703@14000709 : TextConst 'ENU=Nothing Received';
      Text14000704@14000710 : TextConst 'ENU=Fully Received';
      Text14000705@14000711 : TextConst 'ENU=Overreceived';
      Text14000706@14000712 : TextConst 'ENU=Partially Received';
      Text14000707@14000713 : TextConst 'ENU=Nothing to Ship';
      Text14000708@14000714 : TextConst 'ENU=Nothing Packed';
      Text14000709@14000715 : TextConst 'ENU=Fully Packed';
      Text14000710@14000716 : TextConst 'ENU=Overpacked';
      Text14000711@14000717 : TextConst 'ENU=Partially Packed';
      "****ABCSI Variables****"@1000000013 : Integer;
      ReleaseSalesDoc@1000000012 : Codeunit 414;
      CustomerDivision@1000000011 : Record 50007;
      UserSetup@1000000010 : Record 91;
      ReasonCode@1000000009 : Record 231;
      ShipToAddrDivision@1000000008 : Record 51002;
      FromOnInsert@1000000007 : Boolean;
      ExclSalesLineDocumentType@1000000006 : 'Quote,Order,Invoice,Credit Memo,Blanket Order,Return Order';
      ExclSalesLineDocumentNo@1000000005 : Code[20];
      ExclSalesLineLineNo@1000000004 : Integer;
      SkipManualNoTest@1000000003 : Boolean;
      SkipCustBlock@1000000002 : Boolean;
      GlobalWHBilling@1000000001 : Boolean;
      SkipDeleteReceiveHeaderGlobal@1000000000 : Boolean;
      "***ABCSI Constants***"@1000000032 : TextConst 'ENU=ABCSI Constants';
      ab001@1000000031 : TextConst 'ENU=Please Select Value for Division Code.';
      ab002@1000000030 : TextConst 'ENU=Please Select %1';
      ab003@1000000029 : TextConst 'ENU=Customer Division Setup does not exist for %1 %2';
      ab004@1000000028 : TextConst 'ENU=%1 %2 is not defined in the User Setup';
      ab005@1000000027 : TextConst 'ENU=This Shortcut Dimension is not defined in the %1.;ESM=Este Shortcut de dimensi¢n no est  def. en el %1.;FRC=La dimension de ce raccourci n''est pas d‚finie dans le %1.;ENC=This Shortcut Dimension is not defined in the %1.';
      ab006@1000000026 : TextConst 'ENU=Sales Lines Exists for %1 %2 \ Are You Sure to Change %1: %2? \ All the Sales Lines will be deleted.';
      ab007@1000000025 : TextConst 'ENU=is not valid.';
      ab008@1000000024 : TextConst 'ENU=Operation aborted to respect the User Selection';
      Text51002@1000000023 : TextConst 'ENU=%1 %2 was already used on Sales Order No. %3 for Customer No. %4. Do you want to use it again?';
      Text51003@1000000022 : TextConst 'ENU=%1 %2 was already used on Posted Sales Invoice No. %3 for Customer No. %4. Do you want to use it again?';
      Text51004@1000000021 : TextConst 'ENU=%1 %2 was already used on Sales Order No. %3 for %4 %5. Do you want to use it again?';
      Text51005@1000000020 : TextConst 'ENU=%1 %2 was already used on Posted Sales Shipment No. %3 for %4 %5. Do you want to use it again?';
      Text51006@1000000019 : TextConst 'ENU=%1 %2 was already used on Posted Sales Invoice No. %3 for %4 %5. Do you want to use it again?';
      SelectNoSeriesAllowed@1000000035 : Boolean;
      Table14EventPublishers@1000000037 : Codeunit 50074;
      Codeunit408EventSubscriber@1000000038 : Codeunit 51908;

    PROCEDURE InitInsert@61();
    VAR
      NoSeries@1000000000 : Record 308;
    BEGIN
      IF "No." = '' THEN BEGIN
        TestNoSeries;
        NoSeries.GET(GetNoSeriesCode);
        IF (NOT NoSeries."Default Nos.") AND SelectNoSeriesAllowed AND (NoSeries.Code <> '') THEN
          "No." := NoSeriesMgt.GetNextNo(NoSeries.Code,"Posting Date",TRUE)
        ELSE
          NoSeriesMgt.InitSeries(NoSeries.Code,xRec."No. Series","Posting Date","No.","No. Series");
      END;

      InitRecord;
    END;

    PROCEDURE InitRecord@10();
    BEGIN
      SalesSetup.GET;

      CASE "Document Type" OF
        "Document Type"::Quote,"Document Type"::Order:
          BEGIN
            NoSeriesMgt.SetDefaultSeries("Posting No. Series",SalesSetup."Posted Invoice Nos.");
            NoSeriesMgt.SetDefaultSeries("Shipping No. Series",SalesSetup."Posted Shipment Nos.");
            IF "Document Type" = "Document Type"::Order THEN BEGIN
              NoSeriesMgt.SetDefaultSeries("Prepayment No. Series",SalesSetup."Posted Prepmt. Inv. Nos.");
              NoSeriesMgt.SetDefaultSeries("Prepmt. Cr. Memo No. Series",SalesSetup."Posted Prepmt. Cr. Memo Nos.");
            END;
          END;
        "Document Type"::Invoice:
          BEGIN
            IF ("No. Series" <> '') AND
               (SalesSetup."Invoice Nos." = SalesSetup."Posted Invoice Nos.")
            THEN
              "Posting No. Series" := "No. Series"
            ELSE
              NoSeriesMgt.SetDefaultSeries("Posting No. Series",SalesSetup."Posted Invoice Nos.");
            IF SalesSetup."Shipment on Invoice" THEN
              NoSeriesMgt.SetDefaultSeries("Shipping No. Series",SalesSetup."Posted Shipment Nos.");
          END;
        "Document Type"::"Return Order":
          BEGIN
            NoSeriesMgt.SetDefaultSeries("Posting No. Series",SalesSetup."Posted Credit Memo Nos.");
            NoSeriesMgt.SetDefaultSeries("Return Receipt No. Series",SalesSetup."Posted Return Receipt Nos.");
          END;
        "Document Type"::"Credit Memo":
          BEGIN
            IF ("No. Series" <> '') AND
               (SalesSetup."Credit Memo Nos." = SalesSetup."Posted Credit Memo Nos.")
            THEN
              "Posting No. Series" := "No. Series"
            ELSE
              NoSeriesMgt.SetDefaultSeries("Posting No. Series",SalesSetup."Posted Credit Memo Nos.");
            IF SalesSetup."Return Receipt on Credit Memo" THEN
              NoSeriesMgt.SetDefaultSeries("Return Receipt No. Series",SalesSetup."Posted Return Receipt Nos.");
          END;
      END;

      IF "Document Type" IN ["Document Type"::Order,"Document Type"::Invoice,"Document Type"::Quote] THEN
        BEGIN
        "Shipment Date" := WORKDATE;
        "Order Date" := WORKDATE;
      END;
      IF "Document Type" = "Document Type"::"Return Order" THEN
        "Order Date" := WORKDATE;

      IF NOT ("Document Type" IN ["Document Type"::"Blanket Order","Document Type"::Quote]) AND
         ("Posting Date" = 0D)
      THEN
        "Posting Date" := WORKDATE;

      IF SalesSetup."Default Posting Date" = SalesSetup."Default Posting Date"::"No Date" THEN
        "Posting Date" := 0D;

      "Document Date" := WORKDATE;

      IF NOT "Topaz WH Billing" THEN //TPZEDI
      VALIDATE("Location Code",UserSetupMgt.GetLocation(0,Cust."Location Code","Responsibility Center"));

      IF IsCreditDocType THEN BEGIN
        GLSetup.GET;
        Correction := GLSetup."Mark Cr. Memos as Corrections";
      END;

      "Posting Description" := FORMAT("Document Type") + ' ' + "No.";

      UpdateOutboundWhseHandlingTime;

      "Responsibility Center" := UserSetupMgt.GetRespCenter(0,"Responsibility Center");
    END;

    LOCAL PROCEDURE InitNoSeries@77();
    BEGIN
      IF xRec."Shipping No." <> '' THEN BEGIN
        "Shipping No. Series" := xRec."Shipping No. Series";
        "Shipping No." := xRec."Shipping No.";
      END;
      IF xRec."Posting No." <> '' THEN BEGIN
        "Posting No. Series" := xRec."Posting No. Series";
        "Posting No." := xRec."Posting No.";
      END;
      IF xRec."Return Receipt No." <> '' THEN BEGIN
        "Return Receipt No. Series" := xRec."Return Receipt No. Series";
        "Return Receipt No." := xRec."Return Receipt No.";
      END;
      IF xRec."Prepayment No." <> '' THEN BEGIN
        "Prepayment No. Series" := xRec."Prepayment No. Series";
        "Prepayment No." := xRec."Prepayment No.";
      END;
      IF xRec."Prepmt. Cr. Memo No." <> '' THEN BEGIN
        "Prepmt. Cr. Memo No. Series" := xRec."Prepmt. Cr. Memo No. Series";
        "Prepmt. Cr. Memo No." := xRec."Prepmt. Cr. Memo No.";
      END;
    END;

    PROCEDURE AssistEdit@1(OldSalesHeader@1000 : Record 50005) : Boolean;
    VAR
      SalesHeader2@1001 : Record 50005;
    BEGIN
      WITH SalesHeader DO BEGIN
        COPY(Rec);
        SalesSetup.GET;
        TestNoSeries;
        IF NoSeriesMgt.SelectSeries(GetNoSeriesCode,OldSalesHeader."No. Series","No. Series") THEN BEGIN
          IF ("Sell-to Customer No." = '') AND ("Sell-to Contact No." = '') THEN BEGIN
            HideCreditCheckDialogue := FALSE;
            CheckCreditMaxBeforeInsert;
            HideCreditCheckDialogue := TRUE;
          END;
          NoSeriesMgt.SetSeries("No.");
          IF SalesHeader2.GET("Document Type","No.") THEN
            ERROR(Text051,LOWERCASE(FORMAT("Document Type")),"No.");
          Rec := SalesHeader;
          EXIT(TRUE);
        END;
      END;
    END;

    LOCAL PROCEDURE TestNoSeries@6();
    BEGIN
      SalesSetup.GET;

      CASE "Document Type" OF
        "Document Type"::Quote:
          SalesSetup.TESTFIELD("Quote Nos.");
        "Document Type"::Order:
          SalesSetup.TESTFIELD("Order Nos.");
        "Document Type"::Invoice:
          BEGIN
            SalesSetup.TESTFIELD("Invoice Nos.");
            SalesSetup.TESTFIELD("Posted Invoice Nos.");
          END;
        "Document Type"::"Return Order":
          SalesSetup.TESTFIELD("Return Order Nos.");
        "Document Type"::"Credit Memo":
          BEGIN
            SalesSetup.TESTFIELD("Credit Memo Nos.");
            SalesSetup.TESTFIELD("Posted Credit Memo Nos.");
          END;
        "Document Type"::"Blanket Order":
          SalesSetup.TESTFIELD("Blanket Order Nos.");
      END;
    END;

    LOCAL PROCEDURE GetNoSeriesCode@9() : Code[10];
    VAR
      NoSeriesCode@1000000000 : Code[10];
    BEGIN
      CASE "Document Type" OF
        "Document Type"::Quote:
          EXIT(SalesSetup."Buffer Quote Nos.");
        "Document Type"::Order:
          EXIT(SalesSetup."Order Nos.");
        "Document Type"::Invoice:
          EXIT(SalesSetup."Invoice Nos.");
        "Document Type"::"Return Order":
          EXIT(SalesSetup."Return Order Nos.");
        "Document Type"::"Credit Memo":
          EXIT(SalesSetup."Credit Memo Nos.");
        "Document Type"::"Blanket Order":
          EXIT(SalesSetup."Blanket Order Nos.");
      END;
      EXIT(NoSeriesMgt.GetNoSeriesWithCheck(NoSeriesCode,SelectNoSeriesAllowed,"No. Series"));
    END;

    LOCAL PROCEDURE GetPostingNoSeriesCode@8() : Code[10];
    BEGIN
      IF IsCreditDocType THEN
        EXIT(SalesSetup."Posted Credit Memo Nos.");
      EXIT(SalesSetup."Posted Invoice Nos.");
    END;

    LOCAL PROCEDURE GetPostingPrepaymentNoSeriesCode@59() : Code[10];
    BEGIN
      IF IsCreditDocType THEN
        EXIT(SalesSetup."Posted Prepmt. Cr. Memo Nos.");
      EXIT(SalesSetup."Posted Prepmt. Inv. Nos.");
    END;

    LOCAL PROCEDURE TestNoSeriesDate@40(No@1000 : Code[20];NoSeriesCode@1001 : Code[10];NoCapt@1002 : Text[1024];NoSeriesCapt@1004 : Text[1024]);
    VAR
      NoSeries@1005 : Record 308;
    BEGIN
      IF (No <> '') AND (NoSeriesCode <> '') THEN BEGIN
        NoSeries.GET(NoSeriesCode);
        IF NoSeries."Date Order" THEN
          ERROR(
            Text045,
            FIELDCAPTION("Posting Date"),NoSeriesCapt,NoSeriesCode,
            NoSeries.FIELDCAPTION("Date Order"),NoSeries."Date Order","Document Type",
            NoCapt,No);
      END;
    END;

    PROCEDURE ConfirmDeletion@11() : Boolean;
    BEGIN
      IF SalesShptHeader."No." <> '' THEN
        IF NOT CONFIRM(Text009,TRUE,SalesShptHeader."No.") THEN
          EXIT;
      IF SalesInvHeader."No." <> '' THEN
        IF NOT CONFIRM(Text012,TRUE,SalesInvHeader."No.") THEN
          EXIT;
      //<TPZ1931>
      IF NOT SkipDeleteReceiveHeaderGlobal THEN BEGIN
        IF SalesCrMemoHeader."No." <> '' THEN
          IF NOT CONFIRM(Text014,TRUE,SalesCrMemoHeader."No.") THEN
            EXIT;
      END;
        //</TPZ1931>
      IF ReturnRcptHeader."No." <> '' THEN
        IF NOT CONFIRM(Text030,TRUE,ReturnRcptHeader."No.") THEN
          EXIT;
      IF "Prepayment No." <> '' THEN
        IF NOT CONFIRM(Text056,TRUE,SalesInvHeaderPrepmt."No.") THEN
          EXIT;
      IF "Prepmt. Cr. Memo No." <> '' THEN
        IF NOT CONFIRM(Text057,TRUE,SalesCrMemoHeaderPrepmt."No.") THEN
          EXIT;
      EXIT(TRUE);
    END;

    LOCAL PROCEDURE GetCust@2(CustNo@1000 : Code[20]);
    BEGIN

      IF NOT (("Document Type" = "Document Type"::Quote) AND (CustNo = '')) THEN BEGIN
        IF CustNo <> Cust."No." THEN
        //EDITPZ
        //Cust.GET(CustNo);
         IF NOT Cust.GET(CustNo) THEN
          CLEAR(Cust);
       //EDITPZ
      END ELSE
        CLEAR(Cust);
    END;

    LOCAL PROCEDURE GetLocationDivHdlgPct@1000000003(LocationCode@1000 : Code[10];ShortcutDim5Code@1000000001 : Code[20]);
    BEGIN
      // <TPZ92>
      IF LocationCode <> '' THEN BEGIN
        IF LocationCode <> LocationDivHdlgPct."Location Code" THEN
          IF NOT LocationDivHdlgPct.GET(LocationCode,ShortcutDim5Code) THEN
            CLEAR(LocationDivHdlgPct);
      END ELSE
        CLEAR(LocationDivHdlgPct);
      // </TPZ92>
    END;

    LOCAL PROCEDURE GetMfrRepDivComm@1000000004(MfrRepCode@1000 : Code[20];ShortcutDim5Code@1000000000 : Code[20]);
    BEGIN
      // <TPZ92>
      IF MfrRepCode <> '' THEN BEGIN
        IF MfrRepCode <> MfrRepDivComm."Mfr. Rep. Code" THEN
          IF NOT MfrRepDivComm.GET(MfrRepCode,ShortcutDim5Code) THEN
            CLEAR(MfrRepDivComm);
      END ELSE
        CLEAR(MfrRepDivComm);
      // </TPZ92>
    END;

    PROCEDURE GetMfrRepExcp@1000000008(MfrRepCode@1000000000 : Code[20];ShortcutDim5Code@1000000001 : Code[20];CustomerNo@1000000002 : Code[20]) : Boolean;
    VAR
      MfrCode@1000000003 : Code[20];
    BEGIN

      // <TPZ92>  <TPZ1790 - removed code>

      IF MfrRepCommExcp.GET(MfrRepCode,ShortcutDim5Code,CustomerNo,MfrCode) THEN
        EXIT(TRUE)
      ELSE
        CustomerNo := '';
      {<<<<<<<}

      IF MfrRepCommExcp.GET(MfrRepCode,ShortcutDim5Code,CustomerNo,MfrCode) THEN
        EXIT(TRUE);

      EXIT(FALSE);
      // </TPZ92>
    END;

    PROCEDURE SalesLinesExist@3() : Boolean;
    BEGIN
      SalesLine.RESET;
      SalesLine.SETRANGE("Document Type","Document Type");
      SalesLine.SETRANGE("Document No.","No.");
      EXIT(SalesLine.FINDFIRST);
    END;

    LOCAL PROCEDURE RecreateSalesLines@4(ChangedFieldName@1000 : Text[100]);
    VAR
      TempSalesLine@1001 : TEMPORARY Record 50006;
      ItemChargeAssgntSales@1004 : Record 5809;
      TempItemChargeAssgntSales@1003 : TEMPORARY Record 5809;
      TempInteger@1006 : TEMPORARY Record 2000000026;
      TempATOLink@1009 : TEMPORARY Record 904;
      ATOLink@1010 : Record 904;
      TransferExtendedText@1005 : Codeunit 378;
      ExtendedTextAdded@1002 : Boolean;
    BEGIN
      // >> EDI
      IF EDITemp THEN
        EXIT;
      // << EDI

      IF SalesLinesExist THEN BEGIN
        IF HideValidationDialog OR NOT GUIALLOWED THEN
          Confirmed := TRUE
        ELSE
          Confirmed :=
            CONFIRM(
              Text015,FALSE,ChangedFieldName);
        IF Confirmed THEN BEGIN
          SalesLine.LOCKTABLE;
          ItemChargeAssgntSales.LOCKTABLE;
          ReservEntry.LOCKTABLE;
          MODIFY;
          SalesLine.RESET;
          SalesLine.SETRANGE("Document Type","Document Type");
          SalesLine.SETRANGE("Document No.","No.");
          IF SalesLine.FINDSET THEN BEGIN
            TempReservEntry.DELETEALL;
            RecreateReservEntryReqLine(TempSalesLine,TempATOLink,ATOLink);
            ItemChargeAssgntSales.SETRANGE("Document Type","Document Type");
            ItemChargeAssgntSales.SETRANGE("Document No.","No.");
            TransferItemChargeAssgntSalesToTemp(ItemChargeAssgntSales,TempItemChargeAssgntSales);
            SalesLine.DELETEALL(TRUE);
            SalesLine.INIT;
            SalesLine."Line No." := 0;
            TempSalesLine.FINDSET;
            ExtendedTextAdded := FALSE;
            SalesLine.BlockDynamicTracking(TRUE);
            REPEAT
              IF TempSalesLine."Attached to Line No." = 0 THEN BEGIN
                CreateSalesLine(TempSalesLine);
                ExtendedTextAdded := FALSE;

                IF SalesLine.Type = SalesLine.Type::Item THEN BEGIN
                  ClearItemAssgntSalesFilter(TempItemChargeAssgntSales);
                  TempItemChargeAssgntSales.SETRANGE("Applies-to Doc. Type",TempSalesLine."Document Type");
                  TempItemChargeAssgntSales.SETRANGE("Applies-to Doc. No.",TempSalesLine."Document No.");
                  TempItemChargeAssgntSales.SETRANGE("Applies-to Doc. Line No.",TempSalesLine."Line No.");
                  IF TempItemChargeAssgntSales.FINDSET THEN
                    REPEAT
                      IF NOT TempItemChargeAssgntSales.MARK THEN BEGIN
                        TempItemChargeAssgntSales."Applies-to Doc. Line No." := SalesLine."Line No.";
                        TempItemChargeAssgntSales.Description := SalesLine.Description;
                        TempItemChargeAssgntSales.MODIFY;
                        TempItemChargeAssgntSales.MARK(TRUE);
                      END;
                    UNTIL TempItemChargeAssgntSales.NEXT = 0;
                END;
                IF SalesLine.Type = SalesLine.Type::"Charge (Item)" THEN BEGIN
                  TempInteger.INIT;
                  TempInteger.Number := SalesLine."Line No.";
                  TempInteger.INSERT;
                END;
              END ELSE
                IF NOT ExtendedTextAdded THEN BEGIN
                  //TransferExtendedText.SalesCheckIfAnyExtText(SalesLine,TRUE);
                  //TransferExtendedText.InsertSalesExtText(SalesLine);
                  SalesLine.FINDLAST;
                  ExtendedTextAdded := TRUE;
                END;
              RecreateReservEntry(TempSalesLine,SalesLine."Line No.",FALSE);
              RecreateReqLine(TempSalesLine,SalesLine."Line No.",FALSE);
              SynchronizeForReservations(SalesLine,TempSalesLine);
              //<TPZ2447>
              {
              IF TempATOLink.AsmExistsForSalesLine(TempSalesLine) THEN BEGIN
                ATOLink := TempATOLink;
                ATOLink.INSERT;
                ATOLink.UpdateAsmFromSalesLineATOExist(SalesLine);
                TempATOLink.DELETE;
              END;
              }
              //</TPZ2447>
            UNTIL TempSalesLine.NEXT = 0;

            ClearItemAssgntSalesFilter(TempItemChargeAssgntSales);
            TempSalesLine.SETRANGE(Type,SalesLine.Type::"Charge (Item)");
            CreateItemChargeAssgntSales(ItemChargeAssgntSales,TempItemChargeAssgntSales,TempSalesLine,TempInteger);
            TempSalesLine.SETRANGE(Type);
            TempSalesLine.DELETEALL;
            ClearItemAssgntSalesFilter(TempItemChargeAssgntSales);
            TempItemChargeAssgntSales.DELETEALL;
          END;
        END ELSE
          ERROR(
            Text017,ChangedFieldName);
      END;
      SalesLine.BlockDynamicTracking(FALSE);
    END;

    LOCAL PROCEDURE MessageIfSalesLinesExist@5(ChangedFieldName@1000 : Text[100]);
    BEGIN
      // >> EDI
      IF RunFromEDI THEN
        EXIT;
      // << EDI

      IF SalesLinesExist AND NOT HideValidationDialog THEN
        MESSAGE(
          Text018 +
          Text019,
          ChangedFieldName);
    END;

    LOCAL PROCEDURE PriceMessageIfSalesLinesExist@7(ChangedFieldName@1000 : Text[100]);
    BEGIN
      // >> EDI
      IF RunFromEDI THEN
        EXIT;
      // << EDI

      IF SalesLinesExist AND NOT HideValidationDialog THEN
        MESSAGE(
          Text018 +
          Text020,ChangedFieldName);
    END;

    LOCAL PROCEDURE UpdateCurrencyFactor@12();
    BEGIN
      IF "Currency Code" <> '' THEN BEGIN
        IF "Posting Date" <> 0D THEN
          CurrencyDate := "Posting Date"
        ELSE
          CurrencyDate := WORKDATE;

        "Currency Factor" := CurrExchRate.ExchangeRate(CurrencyDate,"Currency Code");
      END ELSE
        "Currency Factor" := 0;
    END;

    LOCAL PROCEDURE ConfirmUpdateCurrencyFactor@13();
    BEGIN
      IF HideValidationDialog THEN
        Confirmed := TRUE
      ELSE
        Confirmed := CONFIRM(Text021,FALSE);
      IF Confirmed THEN
        VALIDATE("Currency Factor")
      ELSE
        "Currency Factor" := xRec."Currency Factor";
    END;

    PROCEDURE SetHideValidationDialog@14(NewHideValidationDialog@1000 : Boolean);
    BEGIN
      HideValidationDialog := NewHideValidationDialog;
    END;

    LOCAL PROCEDURE UpdateSalesLines@15(ChangedFieldName@1000 : Text[100];AskQuestion@1001 : Boolean);
    VAR
      JobTransferLine@1004 : Codeunit 1004;
      PermissionManager@1003 : Codeunit 9002;
      Question@1002 : Text[250];
      NotRunningOnSaaS@1005 : Boolean;
      CustProdComm@1000000000 : Record 50039;
    BEGIN
      IF NOT SalesLinesExist THEN
        EXIT;

      CASE ChangedFieldName OF
        FIELDCAPTION("Shipping Agent Code"),
        FIELDCAPTION("Shipping Agent Service Code"):
          NotRunningOnSaaS := NOT PermissionManager.SoftwareAsAService;
      END;
      IF AskQuestion THEN BEGIN
        Question := STRSUBSTNO(
            Text031 +
            Text032,ChangedFieldName);
        IF GUIALLOWED THEN
          IF NotRunningOnSaaS THEN
            IF DIALOG.CONFIRM(Question,TRUE) THEN
              CASE ChangedFieldName OF
                FIELDCAPTION("Shipment Date"),
                FIELDCAPTION("Shipping Agent Code"),
                FIELDCAPTION("Shipping Agent Service Code"),
                FIELDCAPTION("Shipping Time"),
                FIELDCAPTION("Requested Delivery Date"),
                FIELDCAPTION("Promised Delivery Date"),
                FIELDCAPTION("Outbound Whse. Handling Time"):
                  ConfirmResvDateConflict;
              END
            ELSE
              EXIT
          ELSE
            ConfirmResvDateConflict;
      END;

      SalesLine.LOCKTABLE;
      MODIFY;

      SalesLine.RESET;
      SalesLine.SETRANGE("Document Type","Document Type");
      SalesLine.SETRANGE("Document No.","No.");
      IF SalesLine.FINDSET THEN
        REPEAT

          // <TPZ1278>
          IF NOT
               ((SalesLine."Document Type" = ExclSalesLineDocumentType) AND
                (SalesLine."Document No." = ExclSalesLineDocumentNo) AND
                (SalesLine."Line No." = ExclSalesLineLineNo))
          THEN
          // </TPZ1278>
          //<TPZ1556>
          IF ChangedFieldName = FIELDCAPTION("Shipping Agent Code") THEN
              SalesLine.SuspendStatusCheck(TRUE);
          //</TPZ1556>

          CASE ChangedFieldName OF
            FIELDCAPTION("Shipment Date"):
              IF SalesLine."No." <> '' THEN
                SalesLine.VALIDATE("Shipment Date","Shipment Date");
            FIELDCAPTION("Currency Factor"):
              IF SalesLine.Type <> SalesLine.Type::" " THEN BEGIN
                SalesLine.VALIDATE("Unit Price");
                SalesLine.VALIDATE("Unit Cost (LCY)");
                //<TPZ2447>
                {
                IF SalesLine."Job No." <> '' THEN
                  JobTransferLine.FromSalesHeaderToPlanningLine(SalesLine,"Currency Factor");
                  }
                //</TPZ2447>
              END;
            FIELDCAPTION("Transaction Type"):
              SalesLine.VALIDATE("Transaction Type","Transaction Type");
            FIELDCAPTION("Transport Method"):
              SalesLine.VALIDATE("Transport Method","Transport Method");
            FIELDCAPTION("Exit Point"):
              SalesLine.VALIDATE("Exit Point","Exit Point");
            FIELDCAPTION(Area):
              SalesLine.VALIDATE(Area,Area);
            FIELDCAPTION("Transaction Specification"):
              SalesLine.VALIDATE("Transaction Specification","Transaction Specification");

            //TOP030B KT ABCSI Lost Opportunities 03092015
            FIELDCAPTION("Reason Code") :
              IF ((SalesLine."Quantity Shipped" = 0) AND (SalesLine.Type = SalesLine.Type::Item)) THEN BEGIN
                SalesLine.VALIDATE("Reason Code","Reason Code");
                SalesLine."Lost Opportunity Description" := "Lost Opportunity Description"; //TOP230 KT ABCSI CRP 2 Fixes 06052015
              END;
            //TOP030B KT ABCSI Lost Opportunities 03092015

            FIELDCAPTION("Shipping Agent Code"):
              SalesLine.VALIDATE("Shipping Agent Code","Shipping Agent Code");
            FIELDCAPTION("Shipping Agent Service Code"):
              IF SalesLine."No." <> '' THEN
                SalesLine.VALIDATE("Shipping Agent Service Code","Shipping Agent Service Code");
            FIELDCAPTION("Shipping Time"):
              IF SalesLine."No." <> '' THEN
                SalesLine.VALIDATE("Shipping Time","Shipping Time");
            FIELDCAPTION("Prepayment %"):
              IF SalesLine."No." <> '' THEN
                SalesLine.VALIDATE("Prepayment %","Prepayment %");
            FIELDCAPTION("Requested Delivery Date"):
              IF SalesLine."No." <> '' THEN
                SalesLine.VALIDATE("Requested Delivery Date","Requested Delivery Date");
            FIELDCAPTION("Promised Delivery Date"):
              IF SalesLine."No." <> '' THEN
                SalesLine.VALIDATE("Promised Delivery Date","Promised Delivery Date");
            FIELDCAPTION("Outbound Whse. Handling Time"):
              IF SalesLine."No." <> '' THEN
                SalesLine.VALIDATE("Outbound Whse. Handling Time","Outbound Whse. Handling Time");
                //<TPZ2447>
                {
            SalesLine.FIELDCAPTION("Deferral Code"):
              IF SalesLine."No." <> '' THEN
                SalesLine.VALIDATE("Deferral Code");
                }
                //</TPZ2447>
            FIELDCAPTION("Tax Liable"):
              IF SalesLine."No." <> '' THEN
                SalesLine.VALIDATE("Tax Liable","Tax Liable");
            FIELDCAPTION("Tax Area Code"):
              IF SalesLine.Type <> SalesLine.Type::" " THEN
                SalesLine.VALIDATE("Tax Area Code","Tax Area Code");


            // <TPZ572>
            FIELDCAPTION("Mfr. Rep. Code"):
              IF SalesLine."No." <> '' THEN
                SalesLine.VALIDATE("Mfr. Rep. Code","Mfr. Rep. Code");
            FIELDCAPTION("ISR Code"):
              IF SalesLine."No." <> '' THEN
                SalesLine.VALIDATE("ISR Code","ISR Code");
            FIELDCAPTION("CSR Code"):
              IF SalesLine."No." <> '' THEN
                SalesLine.VALIDATE("CSR Code","CSR Code");
            // </TPZ572>
            // <TPZ92,TPZ1539>
            FIELDCAPTION("Mfr. Rep. Comm. %"):
            BEGIN //<TPZ1641>
              IF (SalesLine.Type = SalesLine.Type::Item) OR
                 ((SalesLine.Type = SalesLine.Type::"G/L Account") AND
                  SalesLine."Commission Payable") OR
                 ((SalesLine.Type = SalesLine.Type::"Charge (Item)") AND
                  SalesLine."Commission Payable")
              THEN
                SalesLine.VALIDATE("Mfr. Rep. Comm. %","Mfr. Rep. Comm. %");
            // </TPZ92,TPZ1539>

              //<TPZ1641>

               IF CustProdComm.GET(SalesLine."Sell-to Customer No.",SalesLine."Item Category Code",SalesLine."Product Group Code",SalesLine."Shortcut Dimension 5 Code") THEN
                  IF (CustProdComm."Commission %" <> 0) AND
                   ((SalesLine.Type = SalesLine.Type::Item) OR
                    ((SalesLine.Type = SalesLine.Type::"G/L Account") AND
                     SalesLine."Commission Payable") OR
                    ((SalesLine.Type = SalesLine.Type::"Charge (Item)") AND
                     SalesLine."Commission Payable"))
                THEN  BEGIN
                  SalesLine.VALIDATE("Mfr. Rep. Comm. %",CustProdComm."Commission %");
                  //"Mfr. Rep. Comm. Amount" := (CustProdComm."Commission %"  * "Line Amount" ) / 100;

               END;
             END;
                //</TPZ1641>

          END;
          //SalesLineReserve.AssignForPlanning(SalesLine);
          SalesLine.MODIFY(TRUE);
        UNTIL SalesLine.NEXT = 0;
    END;

    LOCAL PROCEDURE ConfirmResvDateConflict@41();
    VAR
      ResvEngMgt@1000 : Codeunit 99000831;
    BEGIN
      //<TPZ2447>
      {
      IF ResvEngMgt.ResvExistsForSalesHeader(Rec) THEN
        IF NOT CONFIRM(Text063,FALSE) THEN
          ERROR('');
      }
      //</TPZ2447>
    END;

    PROCEDURE CreateDim@16(Type1@1000 : Integer;No1@1001 : Code[20];Type2@1002 : Integer;No2@1003 : Code[20];Type3@1004 : Integer;No3@1005 : Code[20];Type4@1006 : Integer;No4@1007 : Code[20];Type5@1008 : Integer;No5@1009 : Code[20]);
    VAR
      SourceCodeSetup@1010 : Record 242;
      TableID@1011 : ARRAY [10] OF Integer;
      No@1012 : ARRAY [10] OF Code[20];
      OldDimSetID@1013 : Integer;
    BEGIN
      // >> EDI
      IF EDITemp THEN
        EXIT;
      // << EDI

      SourceCodeSetup.GET;
      TableID[1] := Type1;
      No[1] := No1;
      TableID[2] := Type2;
      No[2] := No2;
      TableID[3] := Type3;
      No[3] := No3;
      TableID[4] := Type4;
      No[4] := No4;
      TableID[5] := Type5;
      No[5] := No5;
      "Shortcut Dimension 1 Code" := '';
      "Shortcut Dimension 2 Code" := '';
      OldDimSetID := "Dimension Set ID";
      "Dimension Set ID" :=
        DimMgt.GetDefaultDimID(TableID,No,SourceCodeSetup.Sales,"Shortcut Dimension 1 Code","Shortcut Dimension 2 Code",0,0);

      IF (OldDimSetID <> "Dimension Set ID") AND SalesLinesExist THEN BEGIN
        MODIFY;
        UpdateAllLineDim("Dimension Set ID",OldDimSetID);
      END;
    END;

    LOCAL PROCEDURE ValidateShortcutDimCode@19(FieldNumber@1000 : Integer;VAR ShortcutDimCode@1001 : Code[20]);
    VAR
      OldDimSetID@1005 : Integer;
    BEGIN
      // >> EDI
      IF EDITemp THEN
        EXIT;
      // << EDI

      OldDimSetID := "Dimension Set ID";
      DimMgt.ValidateShortcutDimValues(FieldNumber,ShortcutDimCode,"Dimension Set ID");
      IF "No." <> '' THEN
        IF NOT FromOnInsert THEN  //TOP020 KT ABCSI Sales Orders by Division Code 09012015
          MODIFY;

      IF OldDimSetID <> "Dimension Set ID" THEN BEGIN
        IF NOT FromOnInsert THEN  //TOP020 KT ABCSI Sales Orders by Division Code 09012015
          MODIFY;
        IF SalesLinesExist THEN
          UpdateAllLineDim("Dimension Set ID",OldDimSetID);
      END;
    END;

    LOCAL PROCEDURE ShippedSalesLinesExist@22() : Boolean;
    BEGIN
      SalesLine.RESET;
      SalesLine.SETRANGE("Document Type","Document Type");
      SalesLine.SETRANGE("Document No.","No.");
      SalesLine.SETFILTER("Quantity Shipped",'<>0');
      EXIT(SalesLine.FINDFIRST);
    END;

    LOCAL PROCEDURE ReturnReceiptExist@5800() : Boolean;
    BEGIN
      SalesLine.RESET;
      SalesLine.SETRANGE("Document Type","Document Type");
      SalesLine.SETRANGE("Document No.","No.");
      SalesLine.SETFILTER("Return Qty. Received",'<>0');
      EXIT(SalesLine.FINDFIRST);
    END;

    LOCAL PROCEDURE DeleteSalesLines@20();
    VAR
      ReservMgt@1000 : Codeunit 99000845;
    BEGIN
      IF SalesLine.FINDSET THEN BEGIN
        ReservMgt.DeleteDocumentReservation(DATABASE::"Sales Line Quote Buffer","Document Type","No.",HideValidationDialog);
        REPEAT
          SalesLine.SuspendStatusCheck(TRUE);
          SalesLine.DELETE(TRUE);
        UNTIL SalesLine.NEXT = 0;
      END;
    END;

    LOCAL PROCEDURE ClearItemAssgntSalesFilter@17(VAR TempItemChargeAssgntSales@1000 : TEMPORARY Record 5809);
    BEGIN
      TempItemChargeAssgntSales.SETRANGE("Document Line No.");
      TempItemChargeAssgntSales.SETRANGE("Applies-to Doc. Type");
      TempItemChargeAssgntSales.SETRANGE("Applies-to Doc. No.");
      TempItemChargeAssgntSales.SETRANGE("Applies-to Doc. Line No.");
    END;

    PROCEDURE CheckCustomerCreated@18(Prompt@1000 : Boolean) : Boolean;
    VAR
      Cont@1001 : Record 5050;
    BEGIN
      IF ("Bill-to Customer No." <> '') AND ("Sell-to Customer No." <> '') THEN
        EXIT(TRUE);

      IF Prompt THEN
        IF NOT CONFIRM(Text035,TRUE) THEN
          EXIT(FALSE);

      IF "Sell-to Customer No." = '' THEN BEGIN
        TESTFIELD("Sell-to Contact No.");
        TESTFIELD("Sell-to Customer Template Code");
        Cont.GET("Sell-to Contact No.");
        Cont.CreateCustomer("Sell-to Customer Template Code");
        COMMIT;
        GET("Document Type"::Quote,"No.");
      END;

      IF "Bill-to Customer No." = '' THEN BEGIN
        TESTFIELD("Bill-to Contact No.");
        TESTFIELD("Bill-to Customer Template Code");
        Cont.GET("Bill-to Contact No.");
        Cont.CreateCustomer("Bill-to Customer Template Code");
        COMMIT;
        GET("Document Type"::Quote,"No.");
      END;

      EXIT(("Bill-to Customer No." <> '') AND ("Sell-to Customer No." <> ''));
    END;

    LOCAL PROCEDURE CheckShipmentInfo@116(VAR SalesLine@1000 : Record 50006;BillTo@1001 : Boolean);
    BEGIN
      IF "Document Type" = "Document Type"::Order THEN
        SalesLine.SETFILTER("Quantity Shipped",'<>0')
      ELSE
        IF "Document Type" = "Document Type"::Invoice THEN BEGIN
          IF NOT BillTo THEN
            SalesLine.SETRANGE("Sell-to Customer No.",xRec."Sell-to Customer No.");
          SalesLine.SETFILTER("Shipment No.",'<>%1','');
        END;

      IF SalesLine.FINDFIRST THEN
        IF "Document Type" = "Document Type"::Order THEN
          SalesLine.TESTFIELD("Quantity Shipped",0)
        ELSE
          SalesLine.TESTFIELD("Shipment No.",'');
      SalesLine.SETRANGE("Shipment No.");
      SalesLine.SETRANGE("Quantity Shipped");
    END;

    LOCAL PROCEDURE CheckPrepmtInfo@119(VAR SalesLine@1000 : Record 50006);
    BEGIN
      IF "Document Type" = "Document Type"::Order THEN BEGIN
        SalesLine.SETFILTER("Prepmt. Amt. Inv.",'<>0');
        IF SalesLine.FIND('-') THEN
          SalesLine.TESTFIELD("Prepmt. Amt. Inv.",0);
        SalesLine.SETRANGE("Prepmt. Amt. Inv.");
      END;
    END;

    LOCAL PROCEDURE CheckReturnInfo@121(VAR SalesLine@1000 : Record 50006;BillTo@1001 : Boolean);
    BEGIN
      IF "Document Type" = "Document Type"::"Return Order" THEN
        SalesLine.SETFILTER("Return Qty. Received",'<>0')
      ELSE
        IF "Document Type" = "Document Type"::"Credit Memo" THEN BEGIN
          IF NOT BillTo THEN
            SalesLine.SETRANGE("Sell-to Customer No.",xRec."Sell-to Customer No.");
          SalesLine.SETFILTER("Return Receipt No.",'<>%1','');
        END;

      IF SalesLine.FINDFIRST THEN
        IF "Document Type" = "Document Type"::"Return Order" THEN
          SalesLine.TESTFIELD("Return Qty. Received",0)
        ELSE
          SalesLine.TESTFIELD("Return Receipt No.",'');
    END;

    LOCAL PROCEDURE RecreateReservEntry@21(OldSalesLine@1000 : Record 50006;NewSourceRefNo@1001 : Integer;ToTemp@1002 : Boolean);
    BEGIN
      IF ToTemp THEN BEGIN
        CLEAR(ReservEntry);
        ReservEntry.SETCURRENTKEY("Source ID","Source Ref. No.","Source Type","Source Subtype");
        ReservEntry.SETRANGE("Source ID",OldSalesLine."Document No.");
        ReservEntry.SETRANGE("Source Ref. No.",OldSalesLine."Line No.");
        ReservEntry.SETRANGE("Source Type",DATABASE::"Sales Line Quote Buffer");
        ReservEntry.SETRANGE("Source Subtype",OldSalesLine."Document Type");
        IF ReservEntry.FINDSET THEN
          REPEAT
            TempReservEntry := ReservEntry;
            TempReservEntry.INSERT;
          UNTIL ReservEntry.NEXT = 0;
        ReservEntry.DELETEALL;
      END ELSE BEGIN
        CLEAR(TempReservEntry);
        TempReservEntry.SETCURRENTKEY("Source ID","Source Ref. No.","Source Type","Source Subtype");
        TempReservEntry.SETRANGE("Source Type",DATABASE::"Sales Line Quote Buffer");
        TempReservEntry.SETRANGE("Source Subtype",OldSalesLine."Document Type");
        TempReservEntry.SETRANGE("Source ID",OldSalesLine."Document No.");
        TempReservEntry.SETRANGE("Source Ref. No.",OldSalesLine."Line No.");
        IF TempReservEntry.FINDSET THEN
          REPEAT
            ReservEntry := TempReservEntry;
            ReservEntry."Source Ref. No." := NewSourceRefNo;
            ReservEntry.INSERT;
          UNTIL TempReservEntry.NEXT = 0;
        TempReservEntry.DELETEALL;
      END;
    END;

    LOCAL PROCEDURE RecreateReqLine@33(OldSalesLine@1000 : Record 50006;NewSourceRefNo@1001 : Integer;ToTemp@1002 : Boolean);
    VAR
      ReqLine@1003 : Record 246;
      TempReqLine@1004 : TEMPORARY Record 246;
    BEGIN
      IF ToTemp THEN BEGIN
        ReqLine.SETCURRENTKEY("Order Promising ID","Order Promising Line ID","Order Promising Line No.");
        ReqLine.SETRANGE("Order Promising ID",OldSalesLine."Document No.");
        ReqLine.SETRANGE("Order Promising Line ID",OldSalesLine."Line No.");
        IF ReqLine.FINDSET THEN
          REPEAT
            TempReqLine := ReqLine;
            TempReqLine.INSERT;
          UNTIL ReqLine.NEXT = 0;
        ReqLine.DELETEALL;
      END ELSE BEGIN
        CLEAR(TempReqLine);
        TempReqLine.SETCURRENTKEY("Order Promising ID","Order Promising Line ID","Order Promising Line No.");
        TempReqLine.SETRANGE("Order Promising ID",OldSalesLine."Document No.");
        TempReqLine.SETRANGE("Order Promising Line ID",OldSalesLine."Line No.");
        IF TempReqLine.FINDSET THEN
          REPEAT
            ReqLine := TempReqLine;
            ReqLine."Order Promising Line ID" := NewSourceRefNo;
            ReqLine.INSERT;
          UNTIL TempReqLine.NEXT = 0;
        TempReqLine.DELETEALL;
      END;
    END;

    LOCAL PROCEDURE UpdateSellToCont@24(CustomerNo@1000 : Code[20]);
    VAR
      ContBusRel@1003 : Record 5054;
      Cust@1004 : Record 18;
      OfficeContact@1001 : Record 5050;
      OfficeMgt@1002 : Codeunit 1630;
    BEGIN
      IF OfficeMgt.GetContact(OfficeContact,CustomerNo) THEN BEGIN
        HideValidationDialog := TRUE;
        UpdateSellToCust(OfficeContact."No.");
        HideValidationDialog := FALSE;
      END ELSE
        IF Cust.GET(CustomerNo) THEN BEGIN
          IF Cust."Primary Contact No." <> '' THEN
            "Sell-to Contact No." := Cust."Primary Contact No."
          ELSE BEGIN
            ContBusRel.RESET;
            ContBusRel.SETCURRENTKEY("Link to Table","No.");
            ContBusRel.SETRANGE("Link to Table",ContBusRel."Link to Table"::Customer);
            ContBusRel.SETRANGE("No.","Sell-to Customer No.");
            IF ContBusRel.FINDFIRST THEN
              "Sell-to Contact No." := ContBusRel."Contact No."
            ELSE
              "Sell-to Contact No." := '';
          END;
          "Sell-to Contact" := Cust.Contact;
        END;
    END;

    LOCAL PROCEDURE UpdateBillToCont@27(CustomerNo@1000 : Code[20]);
    VAR
      ContBusRel@1003 : Record 5054;
      Cust@1001 : Record 18;
    BEGIN
      IF Cust.GET(CustomerNo) THEN BEGIN
        IF Cust."Primary Contact No." <> '' THEN
          "Bill-to Contact No." := Cust."Primary Contact No."
        ELSE BEGIN
          ContBusRel.RESET;
          ContBusRel.SETCURRENTKEY("Link to Table","No.");
          ContBusRel.SETRANGE("Link to Table",ContBusRel."Link to Table"::Customer);
          ContBusRel.SETRANGE("No.","Bill-to Customer No.");
          IF ContBusRel.FINDFIRST THEN
            "Bill-to Contact No." := ContBusRel."Contact No."
          ELSE
            "Bill-to Contact No." := '';
        END;
        "Bill-to Contact" := Cust.Contact;
      END;
    END;

    LOCAL PROCEDURE UpdateSellToCust@25(ContactNo@1002 : Code[20]);
    VAR
      ContBusinessRelation@1007 : Record 5054;
      Customer@1006 : Record 18;
      Cont@1005 : Record 5050;
      CustTemplate@1004 : Record 5105;
      ContComp@1003 : Record 5050;
    BEGIN
      IF Cont.GET(ContactNo) THEN
        "Sell-to Contact No." := Cont."No."
      ELSE BEGIN
        "Sell-to Contact" := '';
        EXIT;
      END;

      ContBusinessRelation.RESET;
      ContBusinessRelation.SETCURRENTKEY("Link to Table","Contact No.");
      ContBusinessRelation.SETRANGE("Link to Table",ContBusinessRelation."Link to Table"::Customer);
      ContBusinessRelation.SETRANGE("Contact No.",Cont."Company No.");
      IF ContBusinessRelation.FINDFIRST THEN BEGIN
        IF ("Sell-to Customer No." <> '') AND
           ("Sell-to Customer No." <> ContBusinessRelation."No.")
        THEN
          ERROR(Text037,Cont."No.",Cont.Name,"Sell-to Customer No.");
        IF "Sell-to Customer No." = '' THEN BEGIN
          SkipSellToContact := TRUE;
          VALIDATE("Sell-to Customer No.",ContBusinessRelation."No.");
          SkipSellToContact := FALSE;
        END;
      END ELSE BEGIN
        IF "Document Type" = "Document Type"::Quote THEN BEGIN
          Cont.TESTFIELD("Company No.");
          ContComp.GET(Cont."Company No.");
          "Sell-to Customer Name" := ContComp."Company Name";
          "Sell-to Customer Name 2" := ContComp."Name 2";
          // <TPZ460>
          "Ship-to Phone No." := ContComp."Phone No.";
          // </TPZ460>
          SetShipToAddress(
            ContComp."Company Name",ContComp."Name 2",ContComp.Address,ContComp."Address 2",
            ContComp.City,ContComp."Post Code",ContComp.County,ContComp."Country/Region Code");
          IF ("Sell-to Customer Template Code" = '') AND (NOT CustTemplate.ISEMPTY) THEN
            VALIDATE("Sell-to Customer Template Code",Cont.FindCustomerTemplate);
        END ELSE
          ERROR(Text039,Cont."No.",Cont.Name);
      END;

      IF Cont.Type = Cont.Type::Person THEN
        "Sell-to Contact" := Cont.Name
      ELSE
        IF Customer.GET("Sell-to Customer No.") THEN
          "Sell-to Contact" := Customer.Contact
        ELSE
          "Sell-to Contact" := '';

      IF "Document Type" = "Document Type"::Quote THEN BEGIN
        IF Customer.GET("Sell-to Customer No.") OR Customer.GET(ContBusinessRelation."No.") THEN BEGIN
          IF Customer."Copy Sell-to Addr. to Qte From" = Customer."Copy Sell-to Addr. to Qte From"::Company THEN BEGIN
            Cont.TESTFIELD("Company No.");
            Cont.GET(Cont."Company No.");
          END;
        END ELSE BEGIN
          Cont.TESTFIELD("Company No.");
          Cont.GET(Cont."Company No.");
        END;
        "Sell-to Address" := Cont.Address;
        "Sell-to Address 2" := Cont."Address 2";
        "Sell-to City" := Cont.City;
        "Sell-to Post Code" := Cont."Post Code";
        "Sell-to County" := Cont.County;
        "Sell-to Country/Region Code" := Cont."Country/Region Code";
      END;
      IF ("Sell-to Customer No." = "Bill-to Customer No.") OR
         ("Bill-to Customer No." = '')
      THEN
        VALIDATE("Bill-to Contact No.","Sell-to Contact No.");
    END;

    LOCAL PROCEDURE UpdateBillToCust@26(ContactNo@1000 : Code[20]);
    VAR
      ContBusinessRelation@1005 : Record 5054;
      Cust@1004 : Record 18;
      Cont@1003 : Record 5050;
      CustTemplate@1002 : Record 5105;
      ContComp@1001 : Record 5050;
    BEGIN
      IF Cont.GET(ContactNo) THEN BEGIN
        "Bill-to Contact No." := Cont."No.";
        IF Cont.Type = Cont.Type::Person THEN
          "Bill-to Contact" := Cont.Name
        ELSE
          IF Cust.GET("Bill-to Customer No.") THEN
            "Bill-to Contact" := Cust.Contact
          ELSE
            "Bill-to Contact" := '';
      END ELSE BEGIN
        "Bill-to Contact" := '';
        EXIT;
      END;

      ContBusinessRelation.RESET;
      ContBusinessRelation.SETCURRENTKEY("Link to Table","Contact No.");
      ContBusinessRelation.SETRANGE("Link to Table",ContBusinessRelation."Link to Table"::Customer);
      ContBusinessRelation.SETRANGE("Contact No.",Cont."Company No.");
      IF ContBusinessRelation.FINDFIRST THEN BEGIN
        IF "Bill-to Customer No." = '' THEN BEGIN
          SkipBillToContact := TRUE;
          VALIDATE("Bill-to Customer No.",ContBusinessRelation."No.");
          SkipBillToContact := FALSE;
          "Bill-to Customer Template Code" := '';
        END ELSE
          IF "Bill-to Customer No." <> ContBusinessRelation."No." THEN
            ERROR(Text037,Cont."No.",Cont.Name,"Bill-to Customer No.");
      END ELSE BEGIN
        IF "Document Type" = "Document Type"::Quote THEN BEGIN
          Cont.TESTFIELD("Company No.");
          ContComp.GET(Cont."Company No.");
          "Bill-to Name" := ContComp."Company Name";
          "Bill-to Name 2" := ContComp."Name 2";
          "Bill-to Address" := ContComp.Address;
          "Bill-to Address 2" := ContComp."Address 2";
          "Bill-to City" := ContComp.City;
          "Bill-to Post Code" := ContComp."Post Code";
          "Bill-to County" := ContComp.County;
          "Bill-to Country/Region Code" := ContComp."Country/Region Code";
          "VAT Registration No." := ContComp."VAT Registration No.";
          VALIDATE("Currency Code",ContComp."Currency Code");
          "Language Code" := ContComp."Language Code";
          IF ("Bill-to Customer Template Code" = '') AND (NOT CustTemplate.ISEMPTY) THEN
            VALIDATE("Bill-to Customer Template Code",Cont.FindCustomerTemplate);
        END ELSE
          ERROR(Text039,Cont."No.",Cont.Name);
      END;
    END;

    LOCAL PROCEDURE GetShippingTime@23(CalledByFieldNo@1000 : Integer);
    VAR
      ShippingAgentServices@1001 : Record 5790;
    BEGIN
      IF (CalledByFieldNo <> CurrFieldNo) AND (CurrFieldNo <> 0) THEN
        EXIT;

      IF ShippingAgentServices.GET("Shipping Agent Code","Shipping Agent Service Code") THEN
        "Shipping Time" := ShippingAgentServices."Shipping Time"
      ELSE BEGIN
        GetCust("Sell-to Customer No.");
        "Shipping Time" := Cust."Shipping Time"
      END;
      IF NOT (CalledByFieldNo IN [FIELDNO("Shipping Agent Code"),FIELDNO("Shipping Agent Service Code")]) THEN
        VALIDATE("Shipping Time");
    END;

    PROCEDURE CheckCreditMaxBeforeInsert@28();
    VAR
      SalesHeader@1001 : Record 50005;
      ContBusinessRelation@1002 : Record 5054;
      Cont@1003 : Record 5050;
      CustCheckCreditLimit@1000 : Codeunit 312;
    BEGIN
      IF HideCreditCheckDialogue THEN
        EXIT;
      IF (GetFilterCustNo <> '') OR ("Sell-to Customer No." <> '') THEN BEGIN
        IF "Sell-to Customer No." <> '' THEN
          Cust.GET("Sell-to Customer No.")
        ELSE
          Cust.GET(GetFilterCustNo);
        IF Cust."Bill-to Customer No." <> '' THEN
          SalesHeader."Bill-to Customer No." := Cust."Bill-to Customer No."
        ELSE
          SalesHeader."Bill-to Customer No." := Cust."No.";
        //CustCheckCreditLimit.SalesHeaderCheck(SalesHeader);
      END ELSE
        IF GetFilterContNo <> '' THEN BEGIN
          Cont.GET(GetFilterContNo);
          ContBusinessRelation.RESET;
          ContBusinessRelation.SETCURRENTKEY("Link to Table","No.");
          ContBusinessRelation.SETRANGE("Link to Table",ContBusinessRelation."Link to Table"::Customer);
          ContBusinessRelation.SETRANGE("Contact No.",Cont."Company No.");
          IF ContBusinessRelation.FINDFIRST THEN BEGIN
            Cust.GET(ContBusinessRelation."No.");
            IF Cust."Bill-to Customer No." <> '' THEN
              SalesHeader."Bill-to Customer No." := Cust."Bill-to Customer No."
            ELSE
              SalesHeader."Bill-to Customer No." := Cust."No.";
           // CustCheckCreditLimit.SalesHeaderCheck(SalesHeader);
          END;
        END;
    END;

    PROCEDURE CreateInvtPutAwayPick@29();
    VAR
      WhseRequest@1000 : Record 5765;
    BEGIN
      IF "Document Type" = "Document Type"::Order THEN
        IF NOT IsApprovedForPosting THEN
          EXIT;
      TESTFIELD(Status,Status::Released);

      WhseRequest.RESET;
      WhseRequest.SETCURRENTKEY("Source Document","Source No.");
      CASE "Document Type" OF
        "Document Type"::Order:
          BEGIN
            IF "Shipping Advice" = "Shipping Advice"::Complete THEN
              CheckShippingAdvice;
            WhseRequest.SETRANGE("Source Document",WhseRequest."Source Document"::"Sales Order");
          END;
        "Document Type"::"Return Order":
          WhseRequest.SETRANGE("Source Document",WhseRequest."Source Document"::"Sales Return Order");
      END;
      WhseRequest.SETRANGE("Source No.","No.");
      REPORT.RUNMODAL(REPORT::"Create Invt Put-away/Pick/Mvmt",TRUE,FALSE,WhseRequest);
    END;

    PROCEDURE CreateTodo@30();
    VAR
      TempTodo@1000 : TEMPORARY Record 5080;
    BEGIN
      TESTFIELD("Sell-to Contact No.");
      //TempTodo.CreateToDoFromSalesHeader(Rec);
    END;

    LOCAL PROCEDURE UpdateShipToAddress@31();
    BEGIN
      IF IsCreditDocType THEN BEGIN
        IF "Location Code" <> '' THEN BEGIN
          Location.GET("Location Code");
          SetShipToAddress(
            Location.Name,Location."Name 2",Location.Address,Location."Address 2",Location.City,
            Location."Post Code",Location.County,Location."Country/Region Code");
          "Ship-to Contact" := Location.Contact;
        END ELSE BEGIN
          CompanyInfo.GET;
          "Ship-to Code" := '';
          SetShipToAddress(
            CompanyInfo."Ship-to Name",CompanyInfo."Ship-to Name 2",CompanyInfo."Ship-to Address",CompanyInfo."Ship-to Address 2",
            CompanyInfo."Ship-to City",CompanyInfo."Ship-to Post Code",CompanyInfo."Ship-to County",
            CompanyInfo."Ship-to Country/Region Code");
          "Ship-to Contact" := CompanyInfo."Ship-to Contact";
        END;
      END;
    END;

    PROCEDURE ShowDocDim@32();
    VAR
      OldDimSetID@1000 : Integer;
    BEGIN

      OldDimSetID := "Dimension Set ID";
      "Dimension Set ID" :=
      //TOP020 KT ABCSI Sales Orders by Division Code 01272015
      //  DimMgt.EditDimensionSet2Custom(
      //    "Dimension Set ID",STRSUBSTNO('%1 %2',"Document Type","No."),
      //    "Shortcut Dimension 1 Code","Shortcut Dimension 2 Code","Shortcut Dimension 5 Code");
      //Commented out for TOP020
      //  DimMgt.EditDimensionSet2(
      //    "Dimension Set ID",STRSUBSTNO('%1 %2',"Document Type","No."),
      //    "Shortcut Dimension 1 Code","Shortcut Dimension 2 Code");
      //Commented out for TOP020
      //TOP020 KT ABCSI Sales Orders by Division Code 01272015
      Codeunit408EventSubscriber.Cu408_EditDimensionSet2Custom("Dimension Set ID",STRSUBSTNO('%1 %2',"Document Type","No."),
      "Shortcut Dimension 1 Code","Shortcut Dimension 2 Code","Shortcut Dimension 5 Code"); //TPZ2830
      IF OldDimSetID <> "Dimension Set ID" THEN BEGIN
        MODIFY;
        IF SalesLinesExist THEN
          UpdateAllLineDim("Dimension Set ID",OldDimSetID);
      END;
    END;

    LOCAL PROCEDURE UpdateAllLineDim@34(NewParentDimSetID@1000 : Integer;OldParentDimSetID@1001 : Integer);
    VAR
      ATOLink@1003 : Record 904;
      NewDimSetID@1002 : Integer;
      ShippedReceivedItemLineDimChangeConfirmed@1004 : Boolean;
      SalesLineOldDimSetID@1000000000 : Integer;
    BEGIN

      // Update all lines with changed dimensions.

      IF NewParentDimSetID = OldParentDimSetID THEN
        EXIT;
      IF NOT HideValidationDialog AND GUIALLOWED THEN
        IF NOT CONFIRM(Text064) THEN
          EXIT;

      SalesLine.RESET;
      SalesLine.SETRANGE("Document Type","Document Type");
      SalesLine.SETRANGE("Document No.","No.");
      SalesLine.LOCKTABLE;
      IF SalesLine.FIND('-') THEN
        REPEAT
          NewDimSetID := DimMgt.GetDeltaDimSetID(SalesLine."Dimension Set ID",NewParentDimSetID,OldParentDimSetID);
          IF SalesLine."Dimension Set ID" <> NewDimSetID THEN BEGIN
            SalesLineOldDimSetID := SalesLine."Dimension Set ID";
            SalesLine."Dimension Set ID" := NewDimSetID;
            //TOP020 KT ABCSI Sales Orders by Division Code 01272015
      //      DimMgt.UpdateGlobalDimFromDimSetIDCustom(
      //        SalesLine."Dimension Set ID",SalesLine."Shortcut Dimension 1 Code",SalesLine."Shortcut Dimension 2 Code",SalesLine."Shortcut Dimension 5 Code");
              Codeunit408EventSubscriber.Cu408_UpdateGlobalDimFromDimSetIDCustom(
              SalesLine."Dimension Set ID",SalesLine."Shortcut Dimension 1 Code",SalesLine."Shortcut Dimension 2 Code",SalesLine."Shortcut Dimension 5 Code"); //TPZ2830


            //Comment Start - TOP020
            //DimMgt.UpdateGlobalDimFromDimSetID(
            //  SalesLine."Dimension Set ID",SalesLine."Shortcut Dimension 1 Code",SalesLine."Shortcut Dimension 2 Code");
            //Comment End - TOP020
            //TOP020 KT ABCSI Sales Orders by Division Code 01272015
            SalesLine.MODIFY;
            //ATOLink.UpdateAsmDimFromSalesLine(SalesLine);
          END;
        UNTIL SalesLine.NEXT = 0;
    END;

    LOCAL PROCEDURE VerifyShippedReceivedItemLineDimChange@105(VAR ShippedReceivedItemLineDimChangeConfirmed@1000 : Boolean);
    BEGIN
      //<TPZ2447>
      {
      IF SalesLine.IsShippedReceivedItemDimChanged THEN
        IF NOT ShippedReceivedItemLineDimChangeConfirmed THEN
          ShippedReceivedItemLineDimChangeConfirmed := SalesLine.ConfirmShippedReceivedItemDimChange;
      }
      //</TPZ2447>
    END;

    PROCEDURE SetAmountToApply@35(AppliesToDocNo@1000 : Code[20];CustomerNo@1001 : Code[20]);
    VAR
      CustLedgEntry@1002 : Record 21;
    BEGIN
      CustLedgEntry.SETCURRENTKEY("Document No.");
      CustLedgEntry.SETRANGE("Document No.",AppliesToDocNo);
      CustLedgEntry.SETRANGE("Customer No.",CustomerNo);
      CustLedgEntry.SETRANGE(Open,TRUE);
      IF CustLedgEntry.FINDFIRST THEN BEGIN
        IF CustLedgEntry."Amount to Apply" = 0 THEN  BEGIN
          CustLedgEntry.CALCFIELDS("Remaining Amount");
          CustLedgEntry."Amount to Apply" := CustLedgEntry."Remaining Amount";
        END ELSE
          CustLedgEntry."Amount to Apply" := 0;
        CustLedgEntry."Accepted Payment Tolerance" := 0;
        CustLedgEntry."Accepted Pmt. Disc. Tolerance" := FALSE;
        CODEUNIT.RUN(CODEUNIT::"Cust. Entry-Edit",CustLedgEntry);
      END;
    END;

    PROCEDURE LookupAdjmtValueEntries@37(QtyType@1000 : 'General,Invoicing');
    VAR
      ItemLedgEntry@1004 : Record 32;
      SalesLine@1001 : Record 50006;
      SalesShptLine@1005 : Record 111;
      ReturnRcptLine@1002 : Record 6661;
      TempValueEntry@1003 : TEMPORARY Record 5802;
    BEGIN
      SalesLine.SETRANGE("Document Type","Document Type");
      SalesLine.SETRANGE("Document No.","No.");
      TempValueEntry.RESET;
      TempValueEntry.DELETEALL;

      CASE "Document Type" OF
        "Document Type"::Order,"Document Type"::Invoice:
          BEGIN
            IF SalesLine.FINDSET THEN
              REPEAT
                IF (SalesLine.Type = SalesLine.Type::Item) AND (SalesLine.Quantity <> 0) THEN
                  WITH SalesShptLine DO BEGIN
                    IF SalesLine."Shipment No." <> '' THEN BEGIN
                      SETRANGE("Document No.",SalesLine."Shipment No.");
                      SETRANGE("Line No.",SalesLine."Shipment Line No.");
                    END ELSE BEGIN
                      SETCURRENTKEY("Order No.","Order Line No.");
                      SETRANGE("Order No.",SalesLine."Document No.");
                      SETRANGE("Order Line No.",SalesLine."Line No.");
                    END;
                    SETRANGE(Correction,FALSE);
                    IF QtyType = QtyType::Invoicing THEN
                      SETFILTER("Qty. Shipped Not Invoiced",'<>0');

                    IF FINDSET THEN
                      REPEAT
                        FilterPstdDocLnItemLedgEntries(ItemLedgEntry);
                        IF ItemLedgEntry.FINDSET THEN
                          REPEAT
                            CreateTempAdjmtValueEntries(TempValueEntry,ItemLedgEntry."Entry No.");
                          UNTIL ItemLedgEntry.NEXT = 0;
                      UNTIL NEXT = 0;
                  END;
              UNTIL SalesLine.NEXT = 0;
          END;
        "Document Type"::"Return Order","Document Type"::"Credit Memo":
          BEGIN
            IF SalesLine.FINDSET THEN
              REPEAT
                IF (SalesLine.Type = SalesLine.Type::Item) AND (SalesLine.Quantity <> 0) THEN
                  WITH ReturnRcptLine DO BEGIN
                    IF SalesLine."Return Receipt No." <> '' THEN BEGIN
                      SETRANGE("Document No.",SalesLine."Return Receipt No.");
                      SETRANGE("Line No.",SalesLine."Return Receipt Line No.");
                    END ELSE BEGIN
                      SETCURRENTKEY("Return Order No.","Return Order Line No.");
                      SETRANGE("Return Order No.",SalesLine."Document No.");
                      SETRANGE("Return Order Line No.",SalesLine."Line No.");
                    END;
                    SETRANGE(Correction,FALSE);
                    IF QtyType = QtyType::Invoicing THEN
                      SETFILTER("Return Qty. Rcd. Not Invd.",'<>0');

                    IF FINDSET THEN
                      REPEAT
                        FilterPstdDocLnItemLedgEntries(ItemLedgEntry);
                        IF ItemLedgEntry.FINDSET THEN
                          REPEAT
                            CreateTempAdjmtValueEntries(TempValueEntry,ItemLedgEntry."Entry No.");
                          UNTIL ItemLedgEntry.NEXT = 0;
                      UNTIL NEXT = 0;
                  END;
              UNTIL SalesLine.NEXT = 0;
          END;
      END;
      PAGE.RUNMODAL(0,TempValueEntry);
    END;

    PROCEDURE GetCustomerVATRegistrationNumber@63() : Text;
    BEGIN
      EXIT("VAT Registration No.");
    END;

    PROCEDURE GetCustomerVATRegistrationNumberLbl@62() : Text;
    BEGIN
      EXIT(FIELDCAPTION("VAT Registration No."));
    END;

    PROCEDURE GetCustomerGlobalLocationNumber@164() : Text;
    BEGIN
      EXIT('');
    END;

    PROCEDURE GetCustomerGlobalLocationNumberLbl@161() : Text;
    BEGIN
      EXIT('');
    END;

    LOCAL PROCEDURE CreateTempAdjmtValueEntries@38(VAR TempValueEntry@1001 : TEMPORARY Record 5802;ItemLedgEntryNo@1000 : Integer);
    VAR
      ValueEntry@1002 : Record 5802;
    BEGIN
      WITH ValueEntry DO BEGIN
        SETCURRENTKEY("Item Ledger Entry No.");
        SETRANGE("Item Ledger Entry No.",ItemLedgEntryNo);
        IF FINDSET THEN
          REPEAT
            IF Adjustment THEN BEGIN
              TempValueEntry := ValueEntry;
              IF TempValueEntry.INSERT THEN;
            END;
          UNTIL NEXT = 0;
      END;
    END;

    PROCEDURE GetPstdDocLinesToRevere@39();
    VAR
      SalesPostedDocLines@1000 : Page 5850;
    BEGIN
      GetCust("Sell-to Customer No.");
      //SalesPostedDocLines.SetToSalesHeader(Rec);
      SalesPostedDocLines.SETRECORD(Cust);
      SalesPostedDocLines.LOOKUPMODE := TRUE;
      IF SalesPostedDocLines.RUNMODAL = ACTION::LookupOK THEN
        SalesPostedDocLines.CopyLineToDoc;

      CLEAR(SalesPostedDocLines);
    END;

    PROCEDURE CalcInvDiscForHeader@45();
    VAR
      SalesInvDisc@1000 : Codeunit 50059;
    BEGIN
      SalesSetup.GET;
      IF SalesSetup."Calc. Inv. Discount" THEN;
        SalesInvDisc.CalculateIncDiscForHeader(Rec);
    END;

    PROCEDURE SetSecurityFilterOnRespCenter@43();
    BEGIN

      IF UserSetupMgt.GetSalesFilter <> '' THEN BEGIN
        FILTERGROUP(2);
        SETRANGE("Responsibility Center",UserSetupMgt.GetSalesFilter);
        FILTERGROUP(0);
      END;

      // <TPZ159>
      IF UserSetupMgt.GetDivisionFilter <> '' THEN BEGIN
        FILTERGROUP(2);
        SETFILTER("Shortcut Dimension 5 Code",UserSetupMgt.GetDivisionFilter);
        FILTERGROUP(0);
      END;

      IF UserSetupMgt.GetMfrRepSalesFilter <> '' THEN BEGIN
        FILTERGROUP(2);
        SETFILTER("Mfr. Rep. Code",UserSetupMgt.GetMfrRepSalesFilter);
        FILTERGROUP(0);
      END;
      // </TPZ159>

      SETRANGE("Date Filter",0D,WORKDATE - 1);
    END;

    LOCAL PROCEDURE SynchronizeForReservations@42(VAR NewSalesLine@1000 : Record 50006;OldSalesLine@1001 : Record 50006);
    BEGIN
      NewSalesLine.CALCFIELDS("Reserved Quantity");
      IF NewSalesLine."Reserved Quantity" = 0 THEN
        EXIT;
      IF NewSalesLine."Location Code" <> OldSalesLine."Location Code" THEN
        NewSalesLine.VALIDATE("Location Code",OldSalesLine."Location Code");
      IF NewSalesLine."Bin Code" <> OldSalesLine."Bin Code" THEN
        NewSalesLine.VALIDATE("Bin Code",OldSalesLine."Bin Code");
      IF NewSalesLine.MODIFY THEN;
    END;

    PROCEDURE InventoryPickConflict@46(DocType@1002 : 'Quote,Order,Invoice,Credit Memo,Blanket Order,Return Order';DocNo@1003 : Code[20];ShippingAdvice@1004 : 'Partial,Complete') : Boolean;
    VAR
      WarehouseActivityLine@1000 : Record 5767;
      SalesLine@1001 : Record 50006;
    BEGIN
      IF ShippingAdvice <> ShippingAdvice::Complete THEN
        EXIT(FALSE);
      WarehouseActivityLine.SETCURRENTKEY("Source Type","Source Subtype","Source No.");
      WarehouseActivityLine.SETRANGE("Source Type",DATABASE::"Sales Line Quote Buffer");
      WarehouseActivityLine.SETRANGE("Source Subtype",DocType);
      WarehouseActivityLine.SETRANGE("Source No.",DocNo);
      IF WarehouseActivityLine.ISEMPTY THEN
        EXIT(FALSE);
      SalesLine.SETRANGE("Document Type",DocType);
      SalesLine.SETRANGE("Document No.",DocNo);
      SalesLine.SETRANGE(Type,SalesLine.Type::Item);
      IF SalesLine.ISEMPTY THEN
        EXIT(FALSE);
      EXIT(TRUE);
    END;

    PROCEDURE WhseShpmntConflict@52(DocType@1002 : 'Quote,Order,Invoice,Credit Memo,Blanket Order,Return Order';DocNo@1001 : Code[20];ShippingAdvice@1000 : 'Partial,Complete') : Boolean;
    VAR
      WarehouseShipmentLine@1003 : Record 7321;
    BEGIN
      IF ShippingAdvice <> ShippingAdvice::Complete THEN
        EXIT(FALSE);
      WarehouseShipmentLine.SETCURRENTKEY("Source Type","Source Subtype","Source No.","Source Line No.");
      WarehouseShipmentLine.SETRANGE("Source Type",DATABASE::"Sales Line Quote Buffer");
      WarehouseShipmentLine.SETRANGE("Source Subtype",DocType);
      WarehouseShipmentLine.SETRANGE("Source No.",DocNo);
      IF WarehouseShipmentLine.ISEMPTY THEN
        EXIT(FALSE);
      EXIT(TRUE);
    END;

    LOCAL PROCEDURE CheckCrLimit@47();
    VAR
      SalesHeader@1000 : Record 50005;
    BEGIN
      SalesHeader := Rec;
      IF GUIALLOWED AND
         (CurrFieldNo <> 0) AND
         ("Document Type" <= "Document Type"::Invoice) AND
         SalesHeader.FIND
      THEN BEGIN
        "Amount Including VAT" := 0;
        IF "Document Type" = "Document Type"::Order THEN
          IF BilltoCustomerNoChanged THEN BEGIN
            SalesLine.SETRANGE("Document Type",SalesLine."Document Type"::Order);
            SalesLine.SETRANGE("Document No.","No.");
            SalesLine.CALCSUMS("Outstanding Amount","Shipped Not Invoiced");
            "Amount Including VAT" := SalesLine."Outstanding Amount" + SalesLine."Shipped Not Invoiced";
          END;
        //CustCheckCreditLimit.SalesHeaderCheck(Rec);
        CALCFIELDS("Amount Including VAT");
      END;
    END;

    PROCEDURE QtyToShipIsZero@49() : Boolean;
    BEGIN
      SalesLine.RESET;
      SalesLine.SETRANGE("Document Type","Document Type");
      SalesLine.SETRANGE("Document No.","No.");
      SalesLine.SETFILTER("Qty. to Ship",'<>0');
      EXIT(SalesLine.ISEMPTY);
    END;

    PROCEDURE IsApprovedForPosting@53() : Boolean;
    VAR
      PrepaymentMgt@1001 : Codeunit 441;
    BEGIN
      //<TPZ2447>
      {
      IF ApprovalsMgmt.PrePostApprovalCheckSales(Rec) THEN BEGIN
        IF PrepaymentMgt.TestSalesPrepayment(Rec) THEN
          ERROR(STRSUBSTNO(Text071,"Document Type","No."));
        IF "Document Type" = "Document Type"::Order THEN
          IF PrepaymentMgt.TestSalesPayment(Rec) THEN
            ERROR(STRSUBSTNO(Text072,"Document Type","No."));
        EXIT(TRUE);
      END;
      }
      //</TPZ2447>
    END;

    PROCEDURE IsApprovedForPostingBatch@54() : Boolean;
    VAR
      PrepaymentMgt@1000 : Codeunit 441;
    BEGIN
      //<TPZ2447>
      {
      IF ApprovalsMgmt.PrePostApprovalCheckSales(Rec) THEN BEGIN
        IF PrepaymentMgt.TestSalesPrepayment(Rec) THEN
          EXIT(FALSE);
        IF PrepaymentMgt.TestSalesPayment(Rec) THEN
          EXIT(FALSE);
        EXIT(TRUE);
      END;
      }
      //</TPZ2447>
    END;

    PROCEDURE GetLegalStatement@60() : Text;
    BEGIN
      SalesSetup.GET;
      EXIT(SalesSetup.GetLegalStatement);
    END;

    PROCEDURE SendToPosting@57(PostingCodeunitID@1000 : Integer);
    BEGIN
      IF NOT IsApprovedForPosting THEN
        EXIT;
      CODEUNIT.RUN(PostingCodeunitID,Rec);
    END;

    PROCEDURE CancelBackgroundPosting@48();
    VAR
      SalesPostViaJobQueue@1000 : Codeunit 88;
    BEGIN
      //SalesPostViaJobQueue.CancelQueueEntry(Rec);
    END;

    PROCEDURE LinkSalesDocWithOpportunity@79(OldOpportunityNo@1000 : Code[20]);
    VAR
      SalesHeader@1001 : Record 50005;
      Opportunity@1002 : Record 5092;
    BEGIN
      IF "Opportunity No." <> OldOpportunityNo THEN BEGIN
        IF "Opportunity No." <> '' THEN
          IF Opportunity.GET("Opportunity No.") THEN BEGIN
            Opportunity.TESTFIELD(Status,Opportunity.Status::"In Progress");
            IF Opportunity."Sales Document No." <> '' THEN BEGIN
              IF CONFIRM(Text048,FALSE,Opportunity."Sales Document No.",Opportunity."No.") THEN BEGIN
                IF SalesHeader.GET("Document Type"::Quote,Opportunity."Sales Document No.") THEN BEGIN
                  SalesHeader."Opportunity No." := '';
                  SalesHeader.MODIFY;
                END;
                UpdateOpportunityLink(Opportunity,Opportunity."Sales Document Type"::Quote,"No.");
              END ELSE
                "Opportunity No." := OldOpportunityNo;
            END ELSE
              UpdateOpportunityLink(Opportunity,Opportunity."Sales Document Type"::Quote,"No.");
          END;
        IF (OldOpportunityNo <> '') AND Opportunity.GET(OldOpportunityNo) THEN
          UpdateOpportunityLink(Opportunity,Opportunity."Sales Document Type"::" ",'');
      END;
    END;

    LOCAL PROCEDURE UpdateOpportunityLink@80(Opportunity@1000 : Record 5092;SalesDocumentType@1001 : Option;SalesHeaderNo@1002 : Code[20]);
    BEGIN
      Opportunity."Sales Document Type" := SalesDocumentType;
      Opportunity."Sales Document No." := SalesHeaderNo;
      Opportunity.MODIFY;
    END;

    LOCAL PROCEDURE IsPrepmtInvoicePosted@1020000() : Boolean;
    VAR
      SalesLine@1020000 : Record 50006;
    BEGIN
      SalesLine.RESET;
      SalesLine.SETRANGE("Document Type","Document Type");
      SalesLine.SETRANGE("Document No.","No.");
      SalesLine.SETFILTER("Prepmt. Amt. Inv.",'>0');
      EXIT(NOT SalesLine.ISEMPTY);
    END;

    PROCEDURE SynchronizeAsmHeader@1000000017();
    VAR
      AsmHeader@1003 : Record 900;
      ATOLink@1002 : Record 904;
      Window@1000 : Dialog;
    BEGIN
      ATOLink.SETCURRENTKEY(Type,"Document Type","Document No.");
      ATOLink.SETRANGE(Type,ATOLink.Type::Sale);
      ATOLink.SETRANGE("Document Type","Document Type");
      ATOLink.SETRANGE("Document No.","No.");
      IF ATOLink.FINDSET THEN
        REPEAT
          IF AsmHeader.GET(ATOLink."Assembly Document Type",ATOLink."Assembly Document No.") THEN
            IF "Posting Date" <> AsmHeader."Posting Date" THEN BEGIN
              Window.OPEN(STRSUBSTNO(SynchronizingMsg,"No.",AsmHeader."No."));
              AsmHeader.VALIDATE("Posting Date","Posting Date");
              AsmHeader.MODIFY;
              Window.CLOSE;
            END;
        UNTIL ATOLink.NEXT = 0;
    END;

    PROCEDURE CheckShippingAdvice@55();
    VAR
      SalesLine@1000 : Record 50006;
      QtyToShipBaseTotal@1002 : Decimal;
      Result@1001 : Boolean;
    BEGIN
      SalesLine.SETRANGE("Document Type","Document Type");
      SalesLine.SETRANGE("Document No.","No.");
      SalesLine.SETRANGE("Drop Shipment",FALSE);
      Result := TRUE;
      IF SalesLine.FINDSET THEN
        REPEAT
          IF SalesLine.IsShipment THEN BEGIN
            QtyToShipBaseTotal += SalesLine."Qty. to Ship (Base)";
            IF SalesLine."Quantity (Base)" <>
               SalesLine."Qty. to Ship (Base)" + SalesLine."Qty. Shipped (Base)"
            THEN
              Result := FALSE;
          END;
        UNTIL SalesLine.NEXT = 0;
      IF QtyToShipBaseTotal = 0 THEN
        Result := TRUE;
      IF NOT Result THEN
        ERROR(ShippingAdviceErr);
    END;

    LOCAL PROCEDURE GetFilterCustNo@64() : Code[20];
    BEGIN
      IF GETFILTER("Sell-to Customer No.") <> '' THEN
        IF GETRANGEMIN("Sell-to Customer No.") = GETRANGEMAX("Sell-to Customer No.") THEN
          EXIT(GETRANGEMAX("Sell-to Customer No."));
    END;

    LOCAL PROCEDURE GetFilterContNo@65() : Code[20];
    BEGIN
      IF GETFILTER("Sell-to Contact No.") <> '' THEN
        IF GETRANGEMIN("Sell-to Contact No.") = GETRANGEMAX("Sell-to Contact No.") THEN
          EXIT(GETRANGEMAX("Sell-to Contact No."));
    END;

    LOCAL PROCEDURE CheckCreditLimitIfLineNotInsertedYet@66();
    BEGIN
      IF "No." = '' THEN BEGIN
        HideCreditCheckDialogue := FALSE;
        CheckCreditMaxBeforeInsert;
        HideCreditCheckDialogue := TRUE;
        InitInsert;
      END;
    END;

    PROCEDURE InvoicedLineExists@156() : Boolean;
    VAR
      SalesLine@1000 : Record 50006;
    BEGIN
      SalesLine.SETRANGE("Document Type","Document Type");
      SalesLine.SETRANGE("Document No.","No.");
      SalesLine.SETFILTER(Type,'<>%1',SalesLine.Type::" ");
      SalesLine.SETFILTER("Quantity Invoiced",'<>%1',0);
      EXIT(NOT SalesLine.ISEMPTY);
    END;

    PROCEDURE CreateDimSetForPrepmtAccDefaultDim@73();
    VAR
      SalesLine@1000 : Record 50006;
      TempSalesLine@1003 : TEMPORARY Record 50006;
    BEGIN
      SalesLine.SETRANGE("Document Type","Document Type");
      SalesLine.SETRANGE("Document No.","No.");
      SalesLine.SETFILTER("Prepmt. Amt. Inv.",'<>%1',0);
      IF SalesLine.FINDSET THEN
        REPEAT
          CollectParamsInBufferForCreateDimSet(TempSalesLine,SalesLine);
        UNTIL SalesLine.NEXT = 0;
      TempSalesLine.RESET;
      TempSalesLine.MARKEDONLY(FALSE);
      IF TempSalesLine.FINDSET THEN
        REPEAT
          SalesLine.CreateDim(DATABASE::"G/L Account",TempSalesLine."No.",
            DATABASE::Job,TempSalesLine."Job No.",
            DATABASE::"Responsibility Center",TempSalesLine."Responsibility Center");
        UNTIL TempSalesLine.NEXT = 0;
    END;

    LOCAL PROCEDURE CollectParamsInBufferForCreateDimSet@72(VAR TempSalesLine@1000 : TEMPORARY Record 50006;SalesLine@1001 : Record 50006);
    VAR
      GenPostingSetup@1003 : Record 252;
      DefaultDimension@1002 : Record 352;
    BEGIN
      TempSalesLine.SETRANGE("Gen. Bus. Posting Group",SalesLine."Gen. Bus. Posting Group");
      TempSalesLine.SETRANGE("Gen. Prod. Posting Group",SalesLine."Gen. Prod. Posting Group");
      IF NOT TempSalesLine.FINDFIRST THEN BEGIN
        GenPostingSetup.GET(SalesLine."Gen. Bus. Posting Group",SalesLine."Gen. Prod. Posting Group");
        GenPostingSetup.TESTFIELD("Sales Prepayments Account");
        DefaultDimension.SETRANGE("Table ID",DATABASE::"G/L Account");
        DefaultDimension.SETRANGE("No.",GenPostingSetup."Sales Prepayments Account");
        InsertTempSalesLineInBuffer(TempSalesLine,SalesLine,GenPostingSetup."Sales Prepayments Account",DefaultDimension.ISEMPTY);
      END ELSE
        IF NOT TempSalesLine.MARK THEN BEGIN
          TempSalesLine.SETRANGE("Job No.",SalesLine."Job No.");
          TempSalesLine.SETRANGE("Responsibility Center",SalesLine."Responsibility Center");
          IF TempSalesLine.ISEMPTY THEN
            InsertTempSalesLineInBuffer(TempSalesLine,SalesLine,TempSalesLine."No.",FALSE);
        END;
    END;

    LOCAL PROCEDURE InsertTempSalesLineInBuffer@71(VAR TempSalesLine@1001 : TEMPORARY Record 50006;SalesLine@1000 : Record 50006;AccountNo@1002 : Code[20];DefaultDimensionsNotExist@1003 : Boolean);
    BEGIN
      TempSalesLine.INIT;
      TempSalesLine."Line No." := SalesLine."Line No.";
      TempSalesLine."No." := AccountNo;
      TempSalesLine."Job No." := SalesLine."Job No.";
      TempSalesLine."Responsibility Center" := SalesLine."Responsibility Center";
      TempSalesLine."Gen. Bus. Posting Group" := SalesLine."Gen. Bus. Posting Group";
      TempSalesLine."Gen. Prod. Posting Group" := SalesLine."Gen. Prod. Posting Group";
      TempSalesLine.MARK := DefaultDimensionsNotExist;
      TempSalesLine.INSERT;
    END;

    PROCEDURE OpenSalesOrderStatistics@70();
    BEGIN
      CalcInvDiscForHeader;
      CreateDimSetForPrepmtAccDefaultDim;
      COMMIT;
      //IF "Tax Area Code" = '' THEN
        PAGE.RUNMODAL(PAGE::"Sales Statistics Buffer",Rec)
      //ELSE
        //PAGE.RUNMODAL(PAGE::"Sales Order Stats.",Rec)
    END;

    PROCEDURE GetCardpageID@58() : Integer;
    BEGIN
      CASE "Document Type" OF
        "Document Type"::Quote:
          EXIT(PAGE::"Sales Quote");
        "Document Type"::Order:
          EXIT(PAGE::"Sales Order");
        "Document Type"::Invoice:
          EXIT(PAGE::"Sales Invoice");
        "Document Type"::"Credit Memo":
          EXIT(PAGE::"Sales Credit Memo");
        "Document Type"::"Blanket Order":
          EXIT(PAGE::"Blanket Sales Order");
        "Document Type"::"Return Order":
          EXIT(PAGE::"Sales Return Order");
      END;
    END;

    PROCEDURE CheckAvailableCreditLimit@67() : Decimal;
    VAR
      Customer@1000 : Record 18;
      AvailableCreditLimit@1002 : Decimal;
    BEGIN
      IF NOT Customer.GET("Bill-to Customer No.") THEN
        Customer.GET("Sell-to Customer No.");

      AvailableCreditLimit := Customer.CalcAvailableCredit;

      IF AvailableCreditLimit < 0 THEN
        OnCustomerCreditLimitExceeded
      ELSE
        OnCustomerCreditLimitNotExceeded;

      EXIT(AvailableCreditLimit);
    END;

    PROCEDURE SetStatus@99(NewStatus@1000 : Option);
    BEGIN
      Status := NewStatus;
      MODIFY;
    END;

    LOCAL PROCEDURE TestSalesLineFieldsBeforeRecreate@68();
    BEGIN
      SalesLine.TESTFIELD("Job No.",'');
      SalesLine.TESTFIELD("Job Contract Entry No.",0);
      SalesLine.TESTFIELD("Quantity Shipped",0);
      SalesLine.TESTFIELD("Quantity Invoiced",0);
      SalesLine.TESTFIELD("Return Qty. Received",0);
      SalesLine.TESTFIELD("Shipment No.",'');
      SalesLine.TESTFIELD("Return Receipt No.",'');
      SalesLine.TESTFIELD("Blanket Order No.",'');
      SalesLine.TESTFIELD("Prepmt. Amt. Inv.",0);
    END;

    LOCAL PROCEDURE RecreateReservEntryReqLine@75(VAR TempSalesLine@1000 : TEMPORARY Record 50006;VAR TempATOLink@1003 : TEMPORARY Record 904;VAR ATOLink@1002 : Record 904);
    BEGIN
      REPEAT
        TestSalesLineFieldsBeforeRecreate;
        IF (SalesLine."Location Code" <> "Location Code") AND NOT SalesLine.IsServiceItem THEN
          SalesLine.VALIDATE("Location Code","Location Code");
        TempSalesLine := SalesLine;
        IF SalesLine.Nonstock THEN BEGIN
          SalesLine.Nonstock := FALSE;
          SalesLine.MODIFY;
        END;
      //<TPZ2447>
      {
        IF ATOLink.AsmExistsForSalesLine(TempSalesLine) THEN BEGIN
          TempATOLink := ATOLink;
          TempATOLink.INSERT;
          ATOLink.DELETE;
        END;
      }
      //</TPZ2447>
        TempSalesLine.INSERT;
        RecreateReservEntry(SalesLine,0,TRUE);
        RecreateReqLine(SalesLine,0,TRUE);
      UNTIL SalesLine.NEXT = 0;
    END;

    LOCAL PROCEDURE TransferItemChargeAssgntSalesToTemp@69(VAR ItemChargeAssgntSales@1001 : Record 5809;VAR TempItemChargeAssgntSales@1000 : TEMPORARY Record 5809);
    BEGIN
      IF ItemChargeAssgntSales.FINDSET THEN BEGIN
        REPEAT
          TempItemChargeAssgntSales.INIT;
          TempItemChargeAssgntSales := ItemChargeAssgntSales;
          TempItemChargeAssgntSales.INSERT;
        UNTIL ItemChargeAssgntSales.NEXT = 0;
        ItemChargeAssgntSales.DELETEALL;
      END;
    END;

    LOCAL PROCEDURE CreateSalesLine@78(VAR TempSalesLine@1000 : TEMPORARY Record 50006);
    BEGIN
      SalesLine.INIT;
      SalesLine."Line No." := SalesLine."Line No." + 10000;
      SalesLine.VALIDATE(Type,TempSalesLine.Type);
      IF TempSalesLine."No." = '' THEN BEGIN
        SalesLine.VALIDATE(Description,TempSalesLine.Description);
        SalesLine.VALIDATE("Description 2",TempSalesLine."Description 2");
      END ELSE BEGIN
        SalesLine.VALIDATE("No.",TempSalesLine."No.");
        IF SalesLine.Type <> SalesLine.Type::" " THEN BEGIN
          SalesLine.VALIDATE("Unit of Measure Code",TempSalesLine."Unit of Measure Code");
          SalesLine.VALIDATE("Variant Code",TempSalesLine."Variant Code");
          IF TempSalesLine.Quantity <> 0 THEN BEGIN
            SalesLine.VALIDATE(Quantity,TempSalesLine.Quantity);
            SalesLine.VALIDATE("Qty. to Assemble to Order",TempSalesLine."Qty. to Assemble to Order");
          END;
          SalesLine."Purchase Order No." := TempSalesLine."Purchase Order No.";
          SalesLine."Purch. Order Line No." := TempSalesLine."Purch. Order Line No.";
          SalesLine."Drop Shipment" := SalesLine."Purch. Order Line No." <> 0;

          // >> EDI
          SalesLine."EDI Ship Confirmed" := TempSalesLine."EDI Ship Confirmed";
          SalesLine."EDI Item Cross Ref." := TempSalesLine."EDI Item Cross Ref.";
          SalesLine."EDI Unit of Measure" := TempSalesLine."EDI Unit of Measure";
          SalesLine."EDI Unit Price" := TempSalesLine."EDI Unit Price";
          SalesLine."EDI Price Discrepancy" := TempSalesLine."EDI Price Discrepancy";
          SalesLine."EDI Segment Group" := TempSalesLine."EDI Segment Group";
          SalesLine."EDI Original Qty." := TempSalesLine."EDI Original Qty.";
          SalesLine."EDI Status Pending" := TempSalesLine."EDI Status Pending";
          SalesLine."EDI Release No." := TempSalesLine."EDI Release No.";
          SalesLine."EDI Ship Req. Date" := TempSalesLine."EDI Ship Req. Date";
          SalesLine."EDI Kanban No." := TempSalesLine."EDI Kanban No.";
          SalesLine."EDI Line Type" := TempSalesLine."EDI Line Type"::Recreate;
          SalesLine."EDI Line Status" := TempSalesLine."EDI Line Status";
          SalesLine."EDI Cumulative Quantity" := TempSalesLine."EDI Cumulative Quantity";
          SalesLine."EDI Forecast Begin Date" := TempSalesLine."EDI Forecast Begin Date";
          SalesLine."EDI Forecast End Date" := TempSalesLine."EDI Forecast End Date";
          SalesLine."EDI Code" := TempSalesLine."EDI Code";
          //SalesLine."EDI ID" := TempSalesLine."EDI ID";
          //SalesLine."EDI Variant Code" := TempSalesLine."EDI Variant Code";
          //SalesLine."EDI DateTime" := TempSalesLine."EDI DateTime";
          //SalesLine."EDI Time" := TempSalesLine."EDI Time";
          // << EDI

        END;
        SalesLine.VALIDATE("Shipment Date",TempSalesLine."Shipment Date");
      END;
      SalesLine.INSERT;
    END;

    LOCAL PROCEDURE CreateItemChargeAssgntSales@83(VAR ItemChargeAssgntSales@1001 : Record 5809;VAR TempItemChargeAssgntSales@1000 : TEMPORARY Record 5809;VAR TempSalesLine@1002 : TEMPORARY Record 50006;VAR TempInteger@1003 : TEMPORARY Record 2000000026);
    BEGIN
      IF TempSalesLine.FINDSET THEN
        REPEAT
          TempItemChargeAssgntSales.SETRANGE("Document Line No.",TempSalesLine."Line No.");
          IF TempItemChargeAssgntSales.FINDSET THEN BEGIN
            REPEAT
              TempInteger.FINDFIRST;
              ItemChargeAssgntSales.INIT;
              ItemChargeAssgntSales := TempItemChargeAssgntSales;
              ItemChargeAssgntSales."Document Line No." := TempInteger.Number;
              ItemChargeAssgntSales.VALIDATE("Unit Cost",0);
              ItemChargeAssgntSales.INSERT;
            UNTIL TempItemChargeAssgntSales.NEXT = 0;
            TempInteger.DELETE;
          END;
        UNTIL TempSalesLine.NEXT = 0;
    END;

    LOCAL PROCEDURE UpdateOutboundWhseHandlingTime@88();
    BEGIN
      IF "Location Code" <> '' THEN BEGIN
        IF Location.GET("Location Code") THEN
          "Outbound Whse. Handling Time" := Location."Outbound Whse. Handling Time";
      END ELSE
        IF InvtSetup.GET THEN
          "Outbound Whse. Handling Time" := InvtSetup."Outbound Whse. Handling Time";
    END;

    [Integration(TRUE)]
    PROCEDURE OnCheckSalesPostRestrictions@115();
    BEGIN
    END;

    [Integration(TRUE)]
    PROCEDURE OnCustomerCreditLimitExceeded@74();
    BEGIN
    END;

    [Integration(TRUE)]
    PROCEDURE OnCustomerCreditLimitNotExceeded@76();
    BEGIN
    END;

    [Integration(TRUE)]
    PROCEDURE OnCheckSalesReleaseRestrictions@81();
    BEGIN
    END;

    PROCEDURE DeferralHeadersExist@82() : Boolean;
    VAR
      DeferralHeader@1000 : Record 1701;
      DeferralUtilities@1001 : Codeunit 1720;
    BEGIN
      DeferralHeader.SETRANGE("Deferral Doc. Type",DeferralUtilities.GetSalesDeferralDocType);
      DeferralHeader.SETRANGE("Gen. Jnl. Template Name",'');
      DeferralHeader.SETRANGE("Gen. Jnl. Batch Name",'');
      DeferralHeader.SETRANGE("Document Type","Document Type");
      DeferralHeader.SETRANGE("Document No.","No.");
      EXIT(NOT DeferralHeader.ISEMPTY);
    END;

    PROCEDURE SetSellToCustomerFromFilter@186();
    VAR
      SellToCustomerNo@1000 : Code[20];
    BEGIN
      SellToCustomerNo := GetFilterCustNo;
      IF SellToCustomerNo = '' THEN BEGIN
        FILTERGROUP(2);
        SellToCustomerNo := GetFilterCustNo;
        FILTERGROUP(0);
      END;
      IF SellToCustomerNo <> '' THEN
        VALIDATE("Sell-to Customer No.",SellToCustomerNo);
    END;

    PROCEDURE CopySellToCustomerFilter@44();
    VAR
      SellToCustomerFilter@1000 : Text;
    BEGIN
      SellToCustomerFilter := GETFILTER("Sell-to Customer No.");
      IF SellToCustomerFilter <> '' THEN BEGIN
        FILTERGROUP(2);
        SETFILTER("Sell-to Customer No.",SellToCustomerFilter);
        FILTERGROUP(0)
      END;
    END;

    LOCAL PROCEDURE ConfirmUpdateDeferralDate@85();
    BEGIN
      //<TPZ2447>
      {
      IF HideValidationDialog THEN
        Confirmed := TRUE
      ELSE
        Confirmed := CONFIRM(DeferralLineQst,FALSE);
      IF Confirmed THEN
        UpdateSalesLines(SalesLine.FIELDCAPTION("Deferral Code"),FALSE);
      }
      //</TPZ2447>
    END;

    PROCEDURE GetSelectedPaymentServicesText@84() : Text;
    VAR
      PaymentServiceSetup@1000 : Record 1060;
    BEGIN
      EXIT(PaymentServiceSetup.GetSelectedPaymentsText("Payment Service Set ID"));
    END;

    PROCEDURE SetDefaultPaymentServices@86();
    VAR
      PaymentServiceSetup@1000 : Record 1060;
      SetID@1001 : Integer;
    BEGIN
      IF NOT PaymentServiceSetup.CanChangePaymentService(Rec) THEN
        EXIT;

      IF PaymentServiceSetup.GetDefaultPaymentServices(SetID) THEN
        VALIDATE("Payment Service Set ID",SetID);
    END;

    PROCEDURE ChangePaymentServiceSetting@87();
    VAR
      PaymentServiceSetup@1000 : Record 1060;
      SetID@1001 : Integer;
    BEGIN
      SetID := "Payment Service Set ID";
      IF PaymentServiceSetup.SelectPaymentService(SetID) THEN BEGIN
        VALIDATE("Payment Service Set ID",SetID);
        MODIFY(TRUE);
      END;
    END;

    PROCEDURE IsCreditDocType@110() : Boolean;
    BEGIN
      EXIT("Document Type" IN ["Document Type"::"Return Order","Document Type"::"Credit Memo"]);
    END;

    LOCAL PROCEDURE UpdateCustomerAddress@89();
    VAR
      Customer@1000 : Record 18;
    BEGIN
      IF Customer.GET("Sell-to Customer No.") THEN
        IF NOT Customer.HasAddress THEN
          CASE TRUE OF
            HasSellToAddress:
              CopySellToCustomerAddressFieldsFromSalesDocument(Customer);
            HasShipToAddress:
              CopyShipToCustomerAddressFieldsFromSalesDocument(Customer);
          END;

      IF "Bill-to Customer No." <> "Sell-to Customer No." THEN
        IF Customer.GET("Bill-to Customer No.") THEN
          IF NOT Customer.HasAddress THEN
            CopyBillToCustomerAddressFieldsFromSalesDocument(Customer);
    END;

    LOCAL PROCEDURE CopySellToCustomerAddressFieldsFromSalesDocument@91(VAR Customer@1000 : Record 18);
    BEGIN
      Customer.Address := "Sell-to Address";
      Customer."Address 2" := "Sell-to Address 2";
      Customer.City := "Sell-to City";
      Customer.Contact := "Sell-to Contact";
      Customer."Country/Region Code" := "Sell-to Country/Region Code";
      Customer.County := "Sell-to County";
      Customer."Post Code" := "Sell-to Post Code";
      Customer.MODIFY(TRUE);
    END;

    LOCAL PROCEDURE CopyShipToCustomerAddressFieldsFromSalesDocument@100(VAR Customer@1000 : Record 18);
    BEGIN
      Customer.Address := "Ship-to Address";
      Customer."Address 2" := "Ship-to Address 2";
      Customer.City := "Ship-to City";
      Customer.Contact := "Ship-to Contact";
      Customer."Country/Region Code" := "Ship-to Country/Region Code";
      Customer.County := "Ship-to County";
      Customer."Post Code" := "Ship-to Post Code";
      Customer.MODIFY(TRUE);
    END;

    LOCAL PROCEDURE CopyBillToCustomerAddressFieldsFromSalesDocument@92(VAR Customer@1000 : Record 18);
    BEGIN
      Customer.Address := "Bill-to Address";
      Customer."Address 2" := "Bill-to Address 2";
      Customer.City := "Bill-to City";
      Customer.Contact := "Bill-to Contact";
      Customer."Country/Region Code" := "Bill-to Country/Region Code";
      Customer.County := "Bill-to County";
      Customer."Post Code" := "Bill-to Post Code";
      Customer.MODIFY(TRUE);
    END;

    PROCEDURE HasSellToAddress@94() : Boolean;
    BEGIN
      CASE TRUE OF
        "Sell-to Address" <> '':
          EXIT(TRUE);
        "Sell-to Address 2" <> '':
          EXIT(TRUE);
        "Sell-to City" <> '':
          EXIT(TRUE);
        "Sell-to Country/Region Code" <> '':
          EXIT(TRUE);
        "Sell-to County" <> '':
          EXIT(TRUE);
        "Sell-to Post Code" <> '':
          EXIT(TRUE);
        "Sell-to Contact" <> '':
          EXIT(TRUE);
      END;

      EXIT(FALSE);
    END;

    PROCEDURE HasShipToAddress@103() : Boolean;
    BEGIN
      CASE TRUE OF
        "Ship-to Address" <> '':
          EXIT(TRUE);
        "Ship-to Address 2" <> '':
          EXIT(TRUE);
        "Ship-to City" <> '':
          EXIT(TRUE);
        "Ship-to Country/Region Code" <> '':
          EXIT(TRUE);
        "Ship-to County" <> '':
          EXIT(TRUE);
        "Ship-to Post Code" <> '':
          EXIT(TRUE);
        "Ship-to Contact" <> '':
          EXIT(TRUE);
      END;

      EXIT(FALSE);
    END;

    PROCEDURE HasBillToAddress@95() : Boolean;
    BEGIN
      CASE TRUE OF
        "Bill-to Address" <> '':
          EXIT(TRUE);
        "Bill-to Address 2" <> '':
          EXIT(TRUE);
        "Bill-to City" <> '':
          EXIT(TRUE);
        "Bill-to Country/Region Code" <> '':
          EXIT(TRUE);
        "Bill-to County" <> '':
          EXIT(TRUE);
        "Bill-to Post Code" <> '':
          EXIT(TRUE);
        "Bill-to Contact" <> '':
          EXIT(TRUE);
      END;

      EXIT(FALSE);
    END;

    LOCAL PROCEDURE CopySellToCustomerAddressFieldsFromCustomer@90(VAR SellToCustomer@1000 : Record 18);
    BEGIN
      IF SellToCustomerIsReplaced OR ShouldCopyAddressFromSellToCustomer(SellToCustomer) THEN BEGIN
        "Sell-to Address" := SellToCustomer.Address;
        "Sell-to Address 2" := SellToCustomer."Address 2";
        "Sell-to City" := SellToCustomer.City;
        "Sell-to Post Code" := SellToCustomer."Post Code";
        "Sell-to County" := SellToCustomer.County;
        "Sell-to Country/Region Code" := SellToCustomer."Country/Region Code";
      END;
    END;

    LOCAL PROCEDURE CopyShipToCustomerAddressFieldsFromCustomer@98(VAR SellToCustomer@1000 : Record 18);
    BEGIN
      IF SellToCustomerIsReplaced OR ShipToAddressEqualsOldSellToAddress THEN BEGIN
        "Ship-to Address" := SellToCustomer.Address;
        "Ship-to Address 2" := SellToCustomer."Address 2";
        "Ship-to City" := SellToCustomer.City;
        "Ship-to Post Code" := SellToCustomer."Post Code";
        "Ship-to County" := SellToCustomer.County;
        VALIDATE("Ship-to Country/Region Code",SellToCustomer."Country/Region Code");
      END;
    END;

    LOCAL PROCEDURE CopyBillToCustomerAddressFieldsFromCustomer@93(VAR BillToCustomer@1000 : Record 18);
    BEGIN
      IF BillToCustomerIsReplaced OR ShouldCopyAddressFromBillToCustomer(BillToCustomer) THEN BEGIN
        "Bill-to Address" := BillToCustomer.Address;
        "Bill-to Address 2" := BillToCustomer."Address 2";
        "Bill-to City" := BillToCustomer.City;
        "Bill-to Post Code" := BillToCustomer."Post Code";
        "Bill-to County" := BillToCustomer.County;
        "Bill-to Country/Region Code" := BillToCustomer."Country/Region Code";
      END;
    END;

    LOCAL PROCEDURE SetShipToAddress@117(ShipToName@1000 : Text[50];ShipToName2@1001 : Text[50];ShipToAddress@1002 : Text[50];ShipToAddress2@1003 : Text[50];ShipToCity@1004 : Text[30];ShipToPostCode@1005 : Code[20];ShipToCounty@1006 : Text[30];ShipToCountryRegionCode@1007 : Code[10]);
    BEGIN
      "Ship-to Name" := ShipToName;
      "Ship-to Name 2" := ShipToName2;
      "Ship-to Address" := ShipToAddress;
      "Ship-to Address 2" := ShipToAddress2;
      "Ship-to City" := ShipToCity;
      "Ship-to Post Code" := ShipToPostCode;
      "Ship-to County" := ShipToCounty;
      "Ship-to Country/Region Code" := ShipToCountryRegionCode;
    END;

    LOCAL PROCEDURE ShouldCopyAddressFromSellToCustomer@101(SellToCustomer@1000 : Record 18) : Boolean;
    BEGIN
      EXIT((NOT HasSellToAddress) AND SellToCustomer.HasAddress);
    END;

    LOCAL PROCEDURE ShouldCopyAddressFromBillToCustomer@102(BillToCustomer@1000 : Record 18) : Boolean;
    BEGIN
      EXIT((NOT HasBillToAddress) AND BillToCustomer.HasAddress);
    END;

    LOCAL PROCEDURE SellToCustomerIsReplaced@96() : Boolean;
    BEGIN
      EXIT((xRec."Sell-to Customer No." <> '') AND (xRec."Sell-to Customer No." <> "Sell-to Customer No."));
    END;

    LOCAL PROCEDURE BillToCustomerIsReplaced@97() : Boolean;
    BEGIN
      EXIT((xRec."Bill-to Customer No." <> '') AND (xRec."Bill-to Customer No." <> "Bill-to Customer No."));
    END;

    LOCAL PROCEDURE UpdateShipToAddressFromSellToAddress@50(FieldNumber@1000 : Integer);
    BEGIN
      IF ("Ship-to Code" = '') AND ShipToAddressEqualsOldSellToAddress THEN
        CASE FieldNumber OF
          FIELDNO("Ship-to Address"):
            IF xRec."Sell-to Address" = "Ship-to Address" THEN
              "Ship-to Address" := "Sell-to Address";
          FIELDNO("Ship-to Address 2"):
            IF xRec."Sell-to Address 2" = "Ship-to Address 2" THEN
              "Ship-to Address 2" := "Sell-to Address 2";
          FIELDNO("Ship-to City"),FIELDNO("Ship-to Post Code"):
            BEGIN
              IF xRec."Sell-to City" = "Ship-to City" THEN
                "Ship-to City" := "Sell-to City";
              IF xRec."Sell-to Post Code" = "Ship-to Post Code" THEN
                "Ship-to Post Code" := "Sell-to Post Code";
              IF xRec."Sell-to County" = "Ship-to County" THEN
                "Ship-to County" := "Sell-to County";
              IF xRec."Sell-to Country/Region Code" = "Ship-to Country/Region Code" THEN
                "Ship-to Country/Region Code" := "Sell-to Country/Region Code";
            END;
          FIELDNO("Ship-to County"):
            IF xRec."Sell-to County" = "Ship-to County" THEN
              "Ship-to County" := "Sell-to County";
          FIELDNO("Ship-to Country/Region Code"):
            IF  xRec."Sell-to Country/Region Code" = "Ship-to Country/Region Code" THEN
              "Ship-to Country/Region Code" := "Sell-to Country/Region Code";
        END;
    END;

    LOCAL PROCEDURE ShipToAddressEqualsOldSellToAddress@51() : Boolean;
    BEGIN
      EXIT(IsShipToAddressEqualToSellToAddress(xRec,Rec));
    END;

    PROCEDURE ShipToAddressEqualsSellToAddress@111() : Boolean;
    BEGIN
      EXIT(IsShipToAddressEqualToSellToAddress(Rec,Rec));
    END;

    LOCAL PROCEDURE IsShipToAddressEqualToSellToAddress@113(SalesHeaderWithSellTo@1000 : Record 50005;SalesHeaderWithShipTo@1001 : Record 50005) : Boolean;
    BEGIN
      IF (SalesHeaderWithSellTo."Sell-to Address" = SalesHeaderWithShipTo."Ship-to Address") AND
         (SalesHeaderWithSellTo."Sell-to Address 2" = SalesHeaderWithShipTo."Ship-to Address 2") AND
         (SalesHeaderWithSellTo."Sell-to City" = SalesHeaderWithShipTo."Ship-to City") AND
         (SalesHeaderWithSellTo."Sell-to County" = SalesHeaderWithShipTo."Ship-to County") AND
         (SalesHeaderWithSellTo."Sell-to Post Code" = SalesHeaderWithShipTo."Ship-to Post Code") AND
         (SalesHeaderWithSellTo."Sell-to Country/Region Code" = SalesHeaderWithShipTo."Ship-to Country/Region Code") AND
         (SalesHeaderWithSellTo."Sell-to Contact" = SalesHeaderWithShipTo."Ship-to Contact")
      THEN
        EXIT(TRUE);
    END;

    PROCEDURE CopySellToAddressToShipToAddress@112();
    BEGIN
      VALIDATE("Ship-to Address","Sell-to Address");
      VALIDATE("Ship-to Address 2","Sell-to Address 2");
      VALIDATE("Ship-to City","Sell-to City");
      VALIDATE("Ship-to Contact","Sell-to Contact");
      VALIDATE("Ship-to Country/Region Code","Sell-to Country/Region Code");
      VALIDATE("Ship-to County","Sell-to County");
      VALIDATE("Ship-to Post Code","Sell-to Post Code");
    END;

    PROCEDURE ConfirmCloseUnposted@104() : Boolean;
    VAR
      InstructionMgt@1000 : Codeunit 1330;
    BEGIN
      IF SalesLinesExist THEN
        EXIT(InstructionMgt.ShowConfirm(DocumentNotPostedClosePageQst,InstructionMgt.QueryPostOnCloseCode));
      EXIT(TRUE)
    END;

    LOCAL PROCEDURE UpdateOpportunity@108();
    VAR
      Opp@1002 : Record 5092;
      OpportunityEntry@1001 : Record 5093;
    BEGIN
      IF NOT ("Opportunity No." <> '') OR NOT ("Document Type" IN ["Document Type"::Quote,"Document Type"::Order]) THEN
        EXIT;

      IF NOT Opp.GET("Opportunity No.") THEN
        EXIT;

      IF "Document Type" = "Document Type"::Order THEN BEGIN
        IF NOT CONFIRM(Text040,TRUE) THEN
          ERROR(Text044);

        OpportunityEntry.SETRANGE("Opportunity No.","Opportunity No.");
        OpportunityEntry.MODIFYALL(Active,FALSE);

        OpportunityEntry.INIT;
        OpportunityEntry.VALIDATE("Opportunity No.",Opp."No.");

        OpportunityEntry.LOCKTABLE;
        OpportunityEntry."Entry No." := GetOpportunityEntryNo;
        OpportunityEntry."Sales Cycle Code" := Opp."Sales Cycle Code";
        OpportunityEntry."Contact No." := Opp."Contact No.";
        OpportunityEntry."Contact Company No." := Opp."Contact Company No.";
        OpportunityEntry."Salesperson Code" := Opp."Salesperson Code";
        OpportunityEntry."Campaign No." := Opp."Campaign No.";
        OpportunityEntry."Action Taken" := OpportunityEntry."Action Taken"::Lost;
        OpportunityEntry.Active := TRUE;
        OpportunityEntry."Completed %" := 100;
        OpportunityEntry."Estimated Value (LCY)" := GetOpportunityEntryEstimatedValue;
        OpportunityEntry."Estimated Close Date" := Opp."Date Closed";
        OpportunityEntry.INSERT(TRUE);
      END;
      Opp.FIND;
      Opp."Sales Document Type" := Opp."Sales Document Type"::" ";
      Opp."Sales Document No." := '';
      Opp.MODIFY;
      "Opportunity No." := '';
    END;

    LOCAL PROCEDURE GetOpportunityEntryNo@106() : Integer;
    VAR
      OpportunityEntry@1000 : Record 5093;
    BEGIN
      IF OpportunityEntry.FINDLAST THEN
        EXIT(OpportunityEntry."Entry No." + 1);
      EXIT(1);
    END;

    LOCAL PROCEDURE GetOpportunityEntryEstimatedValue@107() : Decimal;
    VAR
      OpportunityEntry@1000 : Record 5093;
    BEGIN
      OpportunityEntry.SETRANGE("Opportunity No.","Opportunity No.");
      IF OpportunityEntry.FINDLAST THEN
        EXIT(OpportunityEntry."Estimated Value (LCY)");
    END;

    PROCEDURE InitFromSalesHeader@109(SourceSalesHeader@1000 : Record 50005);
    BEGIN
      "Document Date" := SourceSalesHeader."Document Date";
      "Shipment Date" := SourceSalesHeader."Shipment Date";
      "Shortcut Dimension 1 Code" := SourceSalesHeader."Shortcut Dimension 1 Code";
      "Shortcut Dimension 2 Code" := SourceSalesHeader."Shortcut Dimension 2 Code";
      "Dimension Set ID" := SourceSalesHeader."Dimension Set ID";
      "Location Code" := SourceSalesHeader."Location Code";
      SetShipToAddress(
        SourceSalesHeader."Ship-to Name",SourceSalesHeader."Ship-to Name 2",SourceSalesHeader."Ship-to Address",
        SourceSalesHeader."Ship-to Address 2",SourceSalesHeader."Ship-to City",SourceSalesHeader."Ship-to Post Code",
        SourceSalesHeader."Ship-to County",SourceSalesHeader."Ship-to Country/Region Code");
      "Ship-to Contact" := SourceSalesHeader."Ship-to Contact";
    END;

    LOCAL PROCEDURE InitFromContact@126(ContactNo@1000 : Code[20];CustomerNo@1001 : Code[20];ContactCaption@1002 : Text) : Boolean;
    BEGIN
      SalesLine.RESET;
      SalesLine.SETRANGE("Document Type","Document Type");
      SalesLine.SETRANGE("Document No.","No.");
      IF (ContactNo = '') AND (CustomerNo = '') THEN BEGIN
        IF NOT SalesLine.ISEMPTY THEN
          ERROR(Text005,ContactCaption);
        INIT;
        SalesSetup.GET;
        "No. Series" := xRec."No. Series";
        InitRecord;
        InitNoSeries;
        EXIT(TRUE);
      END;
    END;

    LOCAL PROCEDURE InitFromTemplate@118(TemplateCode@1000 : Code[20];TemplateCaption@1001 : Text) : Boolean;
    BEGIN
      SalesLine.RESET;
      SalesLine.SETRANGE("Document Type","Document Type");
      SalesLine.SETRANGE("Document No.","No.");
      IF TemplateCode = '' THEN BEGIN
        IF NOT SalesLine.ISEMPTY THEN
          ERROR(Text005,TemplateCaption);
        INIT;
        SalesSetup.GET;
        "No. Series" := xRec."No. Series";
        InitRecord;
        InitNoSeries;
        EXIT(TRUE);
      END;
    END;

    LOCAL PROCEDURE ValidateTaxAreaCode@36();
    VAR
      TaxArea@1000 : Record 318;
    BEGIN
      IF "Tax Area Code" = '' THEN
        EXIT;
      IF TaxArea.GET("Tax Area Code") THEN
        EXIT;
      TaxArea.CreateTaxArea("Tax Area Code","Sell-to City","Sell-to County");
    END;

    PROCEDURE SetWorkDescription@120(NewWorkDescription@1000 : Text);
    VAR
      TempBlob@1001 : TEMPORARY Record 99008535;
    BEGIN
      CLEAR("Work Description");
      IF NewWorkDescription = '' THEN
        EXIT;
      TempBlob.Blob := "Work Description";
      TempBlob.WriteAsText(NewWorkDescription,TEXTENCODING::Windows);
      "Work Description" := TempBlob.Blob;
      MODIFY;
    END;

    PROCEDURE GetWorkDescription@114() : Text;
    VAR
      TempBlob@1000 : TEMPORARY Record 99008535;
      CR@1004 : Text[1];
    BEGIN
      CALCFIELDS("Work Description");
      IF NOT "Work Description".HASVALUE THEN
        EXIT('');
      CR[1] := 10;
      TempBlob.Blob := "Work Description";
      EXIT(TempBlob.ReadAsText(CR,TEXTENCODING::Windows));
    END;

    LOCAL PROCEDURE LookupContact@122(CustomerNo@1000 : Code[20];ContactNo@1003 : Code[20];VAR Contact@1001 : Record 5050);
    VAR
      ContactBusinessRelation@1002 : Record 5054;
    BEGIN
      ContactBusinessRelation.SETCURRENTKEY("Link to Table","No.");
      ContactBusinessRelation.SETRANGE("Link to Table",ContactBusinessRelation."Link to Table"::Customer);
      ContactBusinessRelation.SETRANGE("No.",CustomerNo);
      IF ContactBusinessRelation.FINDFIRST THEN
        Contact.SETRANGE("Company No.",ContactBusinessRelation."Contact No.")
      ELSE
        Contact.SETRANGE("Company No.",'');
      IF ContactNo <> '' THEN
        IF Contact.GET(ContactNo) THEN ;
    END;

    PROCEDURE ReceiveStatus@14000601() : Text[30];
    VAR
      TotalQtyToReceiveBase@14000700 : Decimal;
    BEGIN
      // Additional code required in Attain
      IF "Document Type" = "Document Type"::"Return Order" THEN BEGIN
        CALCFIELDS("Total Return Qty to Rec (base)","Total Qty. Received (base)");
        TotalQtyToReceiveBase := "Total Return Qty to Rec (base)";
      END ELSE BEGIN
        CALCFIELDS("Total Qty. To Ship (base)","Total Qty. Received (base)");
        TotalQtyToReceiveBase := "Total Qty. To Ship (base)";
      END;

      CASE TRUE OF
        TotalQtyToReceiveBase = 0:
          EXIT(Text14000702);
        "Total Qty. Received (base)" = 0:
          EXIT(Text14000703);
        TotalQtyToReceiveBase = "Total Qty. Received (base)":
          EXIT(Text14000704);
        TotalQtyToReceiveBase < "Total Qty. Received (base)":
          EXIT(Text14000705);
        ELSE
          EXIT(Text14000706);
      END;
    END;

    PROCEDURE PackingStatus@14000701() : Text[30];
    VAR
      SalesLine2@1240030000 : Record 50006;
      TotalQtyToShipBase@14000701 : Decimal;
    BEGIN
      // Additional code required in Attain
      CALCFIELDS("Total Qty. To Ship (base)","Total Qty. Packed (base)");
      TotalQtyToShipBase := "Total Qty. To Ship (base)";
      IF TotalQtyToShipBase = 0 THEN BEGIN
        CALCFIELDS(
          "E-Ship Whse. Outst. Qty (Base)","E-Ship Whse. Ship. Qty (Base)",
          "E-Ship Invt. Outst. Qty (Base)");
        TotalQtyToShipBase :=
        "E-Ship Whse. Outst. Qty (Base)" + "E-Ship Whse. Ship. Qty (Base)" +
        "E-Ship Invt. Outst. Qty (Base)";
      END;

      CASE TRUE OF
        TotalQtyToShipBase = 0:
          EXIT(Text14000707);
        "Total Qty. Packed (base)" = 0:
          EXIT(Text14000708);
        TotalQtyToShipBase = "Total Qty. Packed (base)":
          EXIT(Text14000709);
        TotalQtyToShipBase < "Total Qty. Packed (base)":
          EXIT(Text14000710);
        ELSE
          EXIT(Text14000711);
      END;
    END;

    PROCEDURE SetRunFromEDI@14000351(EDI@14000351 : Boolean);
    BEGIN
      // >> EDI
      IF EDI THEN
        RunFromEDI := TRUE
      ELSE
        RunFromEDI := FALSE;
      // << EDI
    END;

    PROCEDURE DeleteEDIDiscounts@14000352();
    VAR
      EDIDiscount@14000351 : Record 14002382;
      EDILineDiscount@14000352 : Record 14002383;
      SalesHdr@14000353 : Record 50005;
      SalesInvoiceHeader@14000354 : Record 112;
    BEGIN
      // >> EDI
      EDILineDiscount.RESET;
      EDILineDiscount.SETRANGE("Internal Doc. No.","EDI Internal Doc. No.");
      EDILineDiscount.SETRANGE("Document Type","Document Type");
      EDILineDiscount.SETRANGE("Document No.","No.");
      EDILineDiscount.DELETEALL;

      EDIDiscount.RESET;
      EDIDiscount.SETRANGE("Internal Doc. No.","EDI Internal Doc. No.");
      IF EDIDiscount.FIND('-') THEN BEGIN
        SalesHdr.RESET;
        SalesHdr.SETCURRENTKEY("EDI Order","EDI Trade Partner","EDI Internal Doc. No.");
        SalesHdr.SETRANGE("EDI Internal Doc. No.","EDI Internal Doc. No.");
        SalesHdr.SETFILTER("No.",'<>%1',"No.");
        IF NOT SalesHdr.FIND('-') THEN BEGIN
          SalesInvoiceHeader.RESET;
          SalesInvoiceHeader.SETCURRENTKEY("EDI Internal Doc. No.");
          SalesInvoiceHeader.SETRANGE("EDI Internal Doc. No.","EDI Internal Doc. No.");
          IF NOT SalesInvoiceHeader.FIND('-') THEN BEGIN
            EDIDiscount.RESET;
            EDIDiscount.SETRANGE("Internal Doc. No.","EDI Internal Doc. No.");
            EDIDiscount.DELETEALL;
          END;
        END;
      END;
      // << EDI
    END;

    PROCEDURE SetEDITemp@14000353(EDI@14000352 : Boolean);
    BEGIN
      // >> EDI
      IF EDI THEN
        EDITemp := TRUE
      ELSE
        EDITemp := FALSE;
      // << EDI
    END;

    PROCEDURE DeleteShippingAgentOptionPage@14000702();
    VAR
      Shipping@14000700 : Codeunit 14000701;
    BEGIN
      SalesSetup.GET;
      IF SalesSetup."Enable Shipping" THEN
        Shipping.DeleteDocumentOptionPages("No.",DATABASE::"Sales Header Buffer","Document Type");
    END;

    PROCEDURE CheckEDIOrder@1000000010();
    BEGIN
      // <TPZ848>
      GetCust("Sell-to Customer No.");   //TPZEDI

      IF NOT RunFromEDI AND ("Document Type" IN ["Document Type"::Quote,"Document Type"::Order,"Document Type"::Invoice])
      THEN
        CASE Cust."EDI Invoice" OF
          Cust."EDI Invoice"::Always:
            BEGIN
              "EDI Order" := TRUE;
              "EDI Invoice" := TRUE;
              "EDI Trade Partner" := Cust."EDI Trade Partner";
              //EDIIntegration.EDISellToCodeValidate(Rec);
              IF EDITradePrtnrDivExcp.GET(Cust."EDI Trade Partner","Shortcut Dimension 5 Code") AND
                 EDITradePrtnrDivExcp.Exclude
              THEN BEGIN
                "EDI Order" := FALSE;
                "EDI Invoice" := FALSE;
              END;
              //IF "EDI Order" THEN
                //EDIIntegration.EDIShipToCodeValidate(Rec);
            END;
          Cust."EDI Invoice"::Never:
            "EDI Order" := FALSE;
          Cust."EDI Invoice"::"Rec. Doc. Control":
            BEGIN
              "EDI Order" := FALSE;
              "EDI Invoice" := FALSE;
              "EDI Trade Partner" := '';
              "EDI Sell-to Code" := '';
              "External Sell-to No." := '';
              "EDI Ship-to Code" := '';
              "External Ship-to No." := '';
            END;
        END;
      // </TPZ848>
    END;

    PROCEDURE "****ABCSI Functions****"@1000000000();
    BEGIN
    END;

    PROCEDURE LookupShortcutDimCode@1000000001(FieldNumber@1000 : Integer;VAR ShortcutDimCode@1001 : Code[20]);
    VAR
      DimVal@1000000000 : Record 349;
      CustDiv@1000000001 : Record 50007;
      CustDivFilter@1000000002 : Text;
      SLines@1000000003 : Record 50006;
    BEGIN
      // >> EDI
      IF EDITemp THEN
        EXIT;
      // << EDI

      //TOP140 KT ABCSI - Payment Terms for Multiple Divisions 06032015
      GLSetup.GET;
      IF GLSetup."Shortcut Dimension 5 Code" = '' THEN
        ERROR(ab005,GLSetup.TABLECAPTION);

      CLEAR(CustDivFilter);
      CustDiv.RESET;
      CustDiv.SETRANGE("Customer No.","Bill-to Customer No.");
      IF CustDiv.FINDSET THEN REPEAT
        IF CustDivFilter <> '' THEN
          CustDivFilter += '|' + CustDiv."Shortcut Dimension 5 Code"
        ELSE
          CustDivFilter := CustDiv."Shortcut Dimension 5 Code";
      UNTIL CustDiv.NEXT = 0;
      DimVal.SETRANGE("Dimension Code",GLSetup."Shortcut Dimension 5 Code");
      DimVal.SETFILTER(Code,CustDivFilter);
      DimVal."Dimension Code" := GLSetup."Shortcut Dimension 5 Code";
      IF PAGE.RUNMODAL(0,DimVal) = ACTION::LookupOK THEN BEGIN
        ShortcutDimCode := DimVal.Code;
      END;
      //TOP140 KT ABCSI - Payment Terms for Multiple Divisions 06032015
      //DimMgt.LookupDimValueCode(FieldNumber,ShortcutDimCode);

      //TOP130 - Item List Sort and filter by Status and Division 06042015
      GLSetup.GET;
      IF NOT DimVal.GET(GLSetup."Shortcut Dimension 5 Code","Shortcut Dimension 5 Code") THEN
        FIELDERROR("Shortcut Dimension 5 Code",ab007);

      IF ("Shortcut Dimension 5 Code" <> '') AND (xRec."Shortcut Dimension 5 Code" <> '') AND ("Shortcut Dimension 5 Code" <> xRec."Shortcut Dimension 5 Code") THEN BEGIN
        IF SalesLinesExist THEN
          IF CONFIRM(ab006,FALSE,FIELDCAPTION("Document Type"),"No.",FIELDCAPTION("Shortcut Dimension 5 Code"),"Shortcut Dimension 5 Code") THEN BEGIN
            SLines.RESET;
            SLines.SETRANGE("Document Type","Document Type");
            SLines.SETRANGE("Document No.","No.");
            SLines.DELETEALL(TRUE);
          END ELSE ERROR(ab008);
        END;
      //TOP130 - Item List Sort and filter by Status and Division 06042015

      ValidateShortcutDimCode(FieldNumber,ShortcutDimCode);
    END;

    PROCEDURE UpdateLostOpportunity@1000000009();
    BEGIN
      //TOP030B KT ABCSI Lost Opportunities 03092015
      CALCFIELDS("No. of Lost Opporunity Lines");
      IF "No. of Lost Opporunity Lines" > 0 THEN "Lost Opportunity" := TRUE
      ELSE CLEAR("Lost Opportunity");
      //TOP030B KT ABCSI Lost Opportunities 03092015
    END;

    PROCEDURE ClearQtySalesLines@1000000002();
    VAR
      recSalesLine@1000000000 : Record 50006;
    BEGIN
      //TOP030B KT ABCSI Lost Opportunities 03162015
      recSalesLine.RESET;
      recSalesLine.SETRANGE("Document Type","Document Type");
      recSalesLine.SETRANGE("Document No.","No.");
      recSalesLine.SETRANGE(Type,recSalesLine.Type::Item);
      recSalesLine.SETRANGE("Lost Opportunity",TRUE);
      IF recSalesLine.FINDSET THEN REPEAT
        recSalesLine.VALIDATE(Quantity,0);
        recSalesLine.MODIFY(TRUE);
      UNTIL recSalesLine.NEXT = 0;
      //TOP030B KT ABCSI Lost Opportunities 03162015
    END;

    PROCEDURE ShowItemAvailByLoc@1000000005();
    VAR
      SalesLineRec@1000000001 : Record 50006;
      MatrixRecord@1000000011 : Record 14;
      MatrixRecords@1000000010 : ARRAY [32] OF Record 14;
      MatrixRecordRef@1000000009 : RecordRef;
      SalesItemsByLocMtx@1000000000 : Page 51012;
      MatrixMgt@1000000014 : Codeunit 9200;
      MATRIX_SetWanted@1000000008 : 'Initial,Previous,Same,Next';
      MATRIX_CaptionSet@1000000005 : ARRAY [32] OF Text[1024];
      MATRIX_CaptionRange@1000000004 : Text[100];
      MATRIX_PKFirstRecInCurrSet@1000000003 : Text[100];
      MATRIX_CurrSetLength@1000000002 : Integer;
      CaptionFieldNo@1000000013 : Integer;
      CurrentMatrixRecordOrdinal@1000000012 : Integer;
    BEGIN
      // <TPZ493>
      MatrixRecord.SETRANGE("Use As In-Transit",FALSE);

      // <TPZ159>
      //<TPZ2632>
      //MatrixRecord.SetSecurityFilter;
      Table14EventPublishers.Tb14_OnSetSecurityFilter(MatrixRecord);
      //</TPZ2632>
      // </TPZ159>

      CLEAR(MATRIX_CaptionSet);
      CLEAR(MatrixRecords);
      CurrentMatrixRecordOrdinal := 1;

      MatrixRecordRef.GETTABLE(MatrixRecord);
      MatrixRecordRef.SETTABLE(MatrixRecord);

      CaptionFieldNo := MatrixRecord.FIELDNO(Code);

      MatrixMgt.GenerateMatrixData(MatrixRecordRef,0,ARRAYLEN(MatrixRecords),CaptionFieldNo,MATRIX_PKFirstRecInCurrSet,
        MATRIX_CaptionSet,MATRIX_CaptionRange,MATRIX_CurrSetLength);

      IF MATRIX_CurrSetLength > 0 THEN BEGIN
        MatrixRecord.SETPOSITION(MATRIX_PKFirstRecInCurrSet);
        MatrixRecord.FIND;
        REPEAT
          MatrixRecords[CurrentMatrixRecordOrdinal].COPY(MatrixRecord);
          CurrentMatrixRecordOrdinal := CurrentMatrixRecordOrdinal + 1;
        UNTIL (CurrentMatrixRecordOrdinal > MATRIX_CurrSetLength) OR (MatrixRecord.NEXT <> 1);
      END;

      SalesLineRec.RESET;
      SalesLineRec.SETRANGE("Document Type","Document Type");
      SalesLineRec.SETRANGE("Document No.","No.");
      SalesItemsByLocMtx.Load(MATRIX_CaptionSet,MatrixRecords,MatrixRecord);
      SalesItemsByLocMtx.SETTABLEVIEW(SalesLineRec);
      SalesItemsByLocMtx.RUNMODAL;
      // </TPZ493>
    END;

    PROCEDURE CalcFreeFreight@1000000006();
    BEGIN
      // <TPZ573>
      SalesSetup.GET;
      IF SalesSetup."Calc. Free Freight" THEN
        CODEUNIT.RUN(CODEUNIT::"Sales-Calc. Free Freight",Rec);
      // </TPZ573>
    END;

    PROCEDURE CopyLastUnitPriceToActualUnitPrice@1000000007();
    VAR
      SalesLine2@1000000001 : Record 50006;
    BEGIN
      // <TPZ929>
      SalesLine2.RESET;
      SalesLine2.SETRANGE("Document Type", "Document Type");
      SalesLine2.SETRANGE("Document No.", "No.");
      SalesLine2.SETRANGE(Type, SalesLine2.Type::Item);
      IF SalesLine2.FIND('-') THEN BEGIN
        REPEAT
          SalesLine2.GetLastSalesPrice(SalesLine2);
          SalesLine2.VALIDATE("Actual Unit Price", SalesLine2."Last Unit Price");
          SalesLine2.MODIFY;
        UNTIL SalesLine2.NEXT = 0;
      END;
      // </TPZ929>
    END;

    PROCEDURE ClearActualUnitPrice@1000000012();
    VAR
      SalesLine2@1000000001 : Record 50006;
    BEGIN
      // <TPZ929>
      SalesLine2.RESET;
      SalesLine2.SETRANGE("Document Type", "Document Type");
      SalesLine2.SETRANGE("Document No.", "No.");
      SalesLine2.SETRANGE(Type, SalesLine2.Type::Item);
      IF SalesLine2.FIND('-') THEN
        REPEAT
          SalesLine2.VALIDATE("Actual Unit Price",0);
          SalesLine2.MODIFY;
        UNTIL SalesLine2.NEXT = 0;
      // </TPZ929>
    END;

    PROCEDURE SetSalesLineException@1000000015(NewExclSalesLineDocumentType@1000000000 : Option;NewExclSalesLineDocumentNo@1000000001 : Code[20];NewExclSalesLineLineNo@1000000002 : Integer);
    BEGIN
      // <TPZ1278>
      ExclSalesLineDocumentType := NewExclSalesLineDocumentType;
      ExclSalesLineDocumentNo := NewExclSalesLineDocumentNo;
      ExclSalesLineLineNo := NewExclSalesLineLineNo;
      // </TPZ1278>
    END;

    PROCEDURE SetSkipManualNoTest@1000000011(NewSkipManualNoTest@1000000000 : Boolean);
    BEGIN
      // <TPZ1280>
      SkipManualNoTest := NewSkipManualNoTest;
      // </TPZ1280>
    END;

    PROCEDURE SetSkipCustBlock@1000000013(NewSkipCustBlock@1000000000 : Boolean);
    BEGIN
      // <TPZ9131>
      SkipCustBlock:= NewSkipCustBlock;
      // <TPZ9131>
    END;

    PROCEDURE SetWHBilling@1000000014(pWHBilling@1000000000 : Boolean);
    BEGIN
      //TPZEDI
      "Topaz WH Billing" := pWHBilling;
    END;

    PROCEDURE SkipReceive@1000000016(SkipDeleteReceiveHeaderLocal@1000000000 : Boolean);
    BEGIN
      //<TPZ1931>
      SkipDeleteReceiveHeaderGlobal := SkipDeleteReceiveHeaderLocal;
      //</TPZ1931>
    END;

    PROCEDURE SetAllowSelectNoSeries@125();
    BEGIN
      SelectNoSeriesAllowed := TRUE;
    END;

    BEGIN
    {
      2019-01-17 TPZ2417 AKUMAR
      Created new object.
      2019-05-02 TPZ2558 UCHOUHAN
        Added code for New Division "P".
      2019-09-06 TPZ2632 RTIWARI
        Code changed to call Event function instead of calling function from Table
    }
    END.
  }
}

