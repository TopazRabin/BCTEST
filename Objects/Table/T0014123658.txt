OBJECT Table 14123658 ES SQL Object Name
{
  OBJECT-PROPERTIES
  {
    Date=02/09/13;
    Time=12:00:00 PM;
    Version List=ES1.40;
  }
  PROPERTIES
  {
    CaptionML=ENU=SQL Object Name;
  }
  FIELDS
  {
    { 1   ;   ;SQL Object Name     ;Text30        ;CaptionML=ENU=SQL Object Name }
    { 11  ;   ;Table ID            ;Integer       ;CaptionML=ENU=Table ID }
    { 12  ;   ;Object Name         ;Text30        ;CaptionML=ENU=Object Name }
    { 13  ;   ;Object Caption      ;Text249       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(AllObjWithCaption."Object Caption" WHERE (Object Type=CONST(Table),
                                                                                                                Object ID=FIELD(Table ID)));
                                                   CaptionML=ENU=Object Caption;
                                                   Editable=No }
    { 14  ;   ;Object Not Found    ;Boolean       ;CaptionML=ENU=Object Not Found;
                                                   Editable=No }
    { 15  ;   ;Inserted for Faster Search;Boolean ;CaptionML=ENU=Inserted for Faster Search;
                                                   Editable=No }
  }
  KEYS
  {
    {    ;SQL Object Name                         ;Clustered=Yes }
    {    ;Table ID                                 }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      Text001@1001 : TextConst 'ENU=Inserted %1 %2';

    PROCEDURE PopulateWithAllTables@1240520001(ShowStatus@1240520005 : Boolean);
    VAR
      Object@1240520001 : Record 2000000001;
      ESSQLObjectName@1240520002 : Record 14123658;
      ESSecuritySetup@1240520006 : Record 14123521;
      TempTableName@1240520003 : Text[30];
      Inserted@1240520004 : Integer;
    BEGIN
      ESSecuritySetup.GET;
      ESSecuritySetup.TestPublishCompany;

      Object.RESET;
      Object.SETRANGE(Type,Object.Type::Table);
      IF Object.FIND('-') THEN
        REPEAT
          TempTableName := CONVERTSTR(Object.Name,'./\','___');
          IF NOT ESSQLObjectName.GET(TempTableName) THEN BEGIN
            ESSQLObjectName.INIT;
            ESSQLObjectName."SQL Object Name" := TempTableName;
            ESSQLObjectName."Table ID" := Object.ID;
            ESSQLObjectName."Object Name" := Object.Name;
            ESSQLObjectName."Inserted for Faster Search" := TRUE;
            ESSQLObjectName.INSERT(TRUE);

            Inserted := Inserted + 1;
          END;
        UNTIL Object.NEXT = 0;

      IF ShowStatus THEN
        MESSAGE(Text001,Inserted,TABLECAPTION);
      ESSecuritySetup.Comment(1,STRSUBSTNO(Text001,Inserted,TABLECAPTION));
    END;

    BEGIN
    END.
  }
}

