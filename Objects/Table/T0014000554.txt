OBJECT Table 14000554 Item Class
{
  OBJECT-PROPERTIES
  {
    Date=03/27/19;
    Time=12:00:00 PM;
    Version List=UBP3.00;
  }
  PROPERTIES
  {
    OnInsert=BEGIN
               CheckItemClass;
             END;

    OnModify=BEGIN
               CheckItemClass;
             END;

    CaptionML=ENU=Item Class;
    LookupPageID=Page14000556;
  }
  FIELDS
  {
    { 1   ;   ;Ranking             ;Integer       ;CaptionML=ENU=Ranking }
    { 11  ;   ;Description         ;Text30        ;CaptionML=ENU=Description }
    { 12  ;   ;Percentage of Items ;Decimal       ;CaptionML=ENU=Percentage of Items;
                                                   DecimalPlaces=0:5 }
    { 13  ;   ;Last Period Class Quantity %;Decimal;
                                                   CaptionML=ENU=Last Period Class Quantity %;
                                                   DecimalPlaces=0:5 }
    { 14  ;   ;Dead Stock Class    ;Boolean       ;CaptionML=ENU=Dead Stock Class }
    { 15  ;   ;Reorder Qty. (Months);Decimal      ;CaptionML=ENU=Reorder Qty. (Months);
                                                   DecimalPlaces=0:2 }
    { 16  ;   ;Percentage of COGS  ;Decimal       ;CaptionML=ENU=Percentage of COGS;
                                                   DecimalPlaces=0:2 }
  }
  KEYS
  {
    {    ;Ranking                                 ;Clustered=Yes }
    {    ;Description                              }
    {    ;Dead Stock Class                         }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      ItemClass@14000500 : Record 14000554;
      Text000@1000 : TextConst 'ENU=Dead Stock';
      Text001@1001 : TextConst 'ENU=Item class %1 is already set up as a dead stock class.';
      Text002@1002 : TextConst 'ENU=There is another entry with this item class Code.';

    PROCEDURE CheckItemClass@3();
    BEGIN
      IF "Dead Stock Class" THEN BEGIN
        ItemClass.RESET;
        ItemClass.SETFILTER(Ranking,'<>%1',Ranking);
        ItemClass.SETRANGE("Dead Stock Class",TRUE);
        IF ItemClass.FIND('-') THEN
          ERROR(Text001,ItemClass.Description);
      END;

      ItemClass.RESET;
      ItemClass.SETFILTER(Ranking,'<>%1',Ranking);
      ItemClass.SETRANGE(Description,Description);
      IF ItemClass.FIND('-') THEN
        ERROR(Text002);
    END;

    PROCEDURE CreateStandardClasses@1();
    VAR
      ItemClass2@14000500 : Record 14000554;
      Rank@14000501 : Integer;
    BEGIN
      ItemClass2.RESET;
      Rank := 0;
      REPEAT
        Rank := Rank + 1;
        ItemClass2.INIT;
        ItemClass2.Ranking := Rank;
        CASE Rank OF
          1:
            BEGIN
              ItemClass2.Description := 'A';
              ItemClass2."Percentage of COGS" := 80;
            END;
          2:
            BEGIN
              ItemClass2.Description := 'B';
              ItemClass2."Percentage of COGS" := 15;

            END;
          3:
            BEGIN
              ItemClass2.Description := 'C';
              ItemClass2."Percentage of COGS" := 4;

            END;
          4:
            BEGIN
              ItemClass2.Description := 'D';
              ItemClass2."Percentage of COGS" := 1;

            END;
          5:
            BEGIN
              ItemClass2.Description := 'X';
              ItemClass2."Percentage of COGS" := 0;
              ItemClass2."Dead Stock Class" := TRUE;
            END;
        END;
        ItemClass2.INSERT;
      UNTIL Rank = 5;
    END;

    BEGIN
    END.
  }
}

