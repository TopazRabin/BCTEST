OBJECT Table 50027 Mfr. Rep.
{
  OBJECT-PROPERTIES
  {
    Date=07/01/20;
    Time=12:00:00 AM;
    Modified=Yes;
    Version List=TOP110;
  }
  PROPERTIES
  {
    DataCaptionFields=Code,Name;
    OnInsert=BEGIN
               IF Code = '' THEN BEGIN
                 SalesSetup.GET;
                 SalesSetup.TESTFIELD("Mfr. Rep. Nos.");
                 NoSeriesMgt.InitSeries(SalesSetup."Mfr. Rep. Nos.",xRec."No. Series",0D,Code,"No. Series");
               END;
             END;

    CaptionML=ENU=Mfr. Rep.;
    LookupPageID=Page50052;
    DrillDownPageID=Page50052;
  }
  FIELDS
  {
    { 1   ;   ;Code                ;Code20        ;OnValidate=BEGIN
                                                                IF Code <> xRec.Code THEN BEGIN
                                                                  SalesSetup.GET;
                                                                  NoSeriesMgt.TestManual(SalesSetup."Mfr. Rep. Nos.");
                                                                  "No. Series" := '';
                                                                END;
                                                              END;

                                                   CaptionML=ENU=Code }
    { 2   ;   ;Name                ;Text50        ;CaptionML=ENU=Name }
    { 4   ;   ;Name 2              ;Text50        ;CaptionML=ENU=Name 2 }
    { 5   ;   ;Address             ;Text50        ;CaptionML=ENU=Address }
    { 6   ;   ;Address 2           ;Text50        ;CaptionML=ENU=Address 2 }
    { 7   ;   ;City                ;Text30        ;TableRelation=IF (Country/Region Code=CONST()) "Post Code".City
                                                                 ELSE IF (Country/Region Code=FILTER(<>'')) "Post Code".City WHERE (Country/Region Code=FIELD(Country/Region Code));
                                                   OnValidate=BEGIN
                                                                PostCode.ValidateCity(City,"Post Code",County,"Country/Region Code",(CurrFieldNo <> 0) AND GUIALLOWED);
                                                              END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=ENU=City }
    { 8   ;   ;Contact             ;Text50        ;CaptionML=ENU=Contact }
    { 9   ;   ;Phone No.           ;Text30        ;ExtendedDatatype=Phone No.;
                                                   CaptionML=ENU=Phone No. }
    { 35  ;   ;Country/Region Code ;Code10        ;InitValue=US;
                                                   TableRelation=Country/Region;
                                                   CaptionML=ENU=Country/Region Code }
    { 84  ;   ;Fax No.             ;Text30        ;CaptionML=ENU=Fax No. }
    { 91  ;   ;Post Code           ;Code20        ;TableRelation=IF (Country/Region Code=CONST()) "Post Code"
                                                                 ELSE IF (Country/Region Code=FILTER(<>'')) "Post Code" WHERE (Country/Region Code=FIELD(Country/Region Code));
                                                   OnValidate=BEGIN
                                                                PostCode.ValidatePostCode(City,"Post Code",County,"Country/Region Code",(CurrFieldNo <> 0) AND GUIALLOWED);
                                                              END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=ENU=ZIP Code }
    { 92  ;   ;County              ;Text30        ;CaptionML=ENU=State }
    { 102 ;   ;E-Mail              ;Text80        ;ExtendedDatatype=E-Mail;
                                                   CaptionML=ENU=E-Mail }
    { 103 ;   ;Home Page           ;Text80        ;ExtendedDatatype=URL;
                                                   CaptionML=ENU=Home Page }
    { 107 ;   ;No. Series          ;Code10        ;TableRelation="No. Series";
                                                   CaptionML=ENU=No. Series;
                                                   Editable=No }
    { 5700;   ;Responsibility Center;Code10       ;TableRelation="Responsibility Center";
                                                   CaptionML=[ENU=Responsibility Center;
                                                              ESM=Centro responsabilidad;
                                                              FRC=Centre de gestion;
                                                              ENC=Responsibility Centre] }
    { 50105;  ;Location Code       ;Code10        ;TableRelation=Location;
                                                   CaptionML=ENU=Location Code }
    { 51701;  ;Pay-to Mfr. Rep. Code;Code20       ;TableRelation="Mfr. Rep.";
                                                   CaptionML=ENU=Pay-to Mfr. Rep. Code }
    { 51702;  ;Pay-to Vendor No.   ;Code20        ;TableRelation=Vendor;
                                                   CaptionML=ENU=Pay-to Vendor No. }
    { 51703;  ;Comm. Statement Send Date;Date     ;CaptionML=ENU=Comm. Statement Send Date }
    { 51704;  ;Send Source Documents;Boolean      ;CaptionML=ENU=Send Source Documents }
    { 11123304;;Last Date/Time Modified;DateTime  ;CaptionML=ENU=Last Date/Time Modified;
                                                   Description=TPZ2027 }
  }
  KEYS
  {
    {    ;Code                                    ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      PostCode@1000000000 : Record 225;
      SalesSetup@1000000001 : Record 311;
      NoSeriesMgt@1000000002 : Codeunit 396;
      DimMgt@1000000003 : Codeunit 408;

    PROCEDURE AssistEdit@2(OldMfrRep@1000 : Record 50027) : Boolean;
    VAR
      MfrRep@1001 : Record 50027;
    BEGIN
      WITH MfrRep DO BEGIN
        MfrRep := Rec;
        SalesSetup.GET;
        SalesSetup.TESTFIELD("Mfr. Rep. Nos.");
        IF NoSeriesMgt.SelectSeries(SalesSetup."Mfr. Rep. Nos.",OldMfrRep."No. Series","No. Series") THEN BEGIN
          NoSeriesMgt.SetSeries(Code);
          Rec := MfrRep;
          EXIT(TRUE);
        END;
      END;
    END;

    PROCEDURE ValidateShortcutDimCode@14(FieldNumber@1000 : Integer;VAR ShortcutDimCode@1001 : Code[20]);
    BEGIN
      // <TPZ92>
      DimMgt.ValidateDimValueCode(FieldNumber,ShortcutDimCode);
      // </TPZ92>
    END;

    PROCEDURE LookupShortcutDimCode@18(FieldNumber@1000 : Integer;VAR ShortcutDimCode@1001 : Code[20]);
    BEGIN
      // <TPZ92>
      DimMgt.LookupDimValueCode(FieldNumber,ShortcutDimCode);
      DimMgt.ValidateDimValueCode(FieldNumber,ShortcutDimCode);
      // </TPZ92>
    END;

    BEGIN
    {
      TOP110 KT ABCSI Salesperson 03302015
        - Created this table as a part of this SMT

      2015-04-03 TPZ572 VCHERNYA
        Fields have been recreated
      2015-04-22 TPZ92 TAKHMETO
        Responsibility Center, Pay-to Mfr. Rep. Code,
        Pay-to Vendor No., Comm. Statement Send Date, Attach Source Documents, Send Comm. Source Documents fields have been created
      2015-07-07 TPZ195 VCHERNYA
        Location Code field has been created
      2017-10-13 TPZ2027 EBAGIM
        Swaping Salesperon with MfrRep table
    }
    END.
  }
}

