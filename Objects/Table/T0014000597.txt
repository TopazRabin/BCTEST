OBJECT Table 14000597 Transfer Calendar
{
  OBJECT-PROPERTIES
  {
    Date=03/01/20;
    Time=12:00:00 PM;
    Version List=UBP3.02;
  }
  PROPERTIES
  {
    CaptionML=ENU=Transfer Calendar;
    LookupPageID=Page14002729;
    DrillDownPageID=Page14002729;
  }
  FIELDS
  {
    { 1   ;   ;Location Code       ;Code10        ;TableRelation=Location.Code;
                                                   CaptionML=ENU=Location Code }
    { 11  ;   ;Select Repl. Path Suggestion;Boolean;
                                                   CaptionML=ENU=Select Repl. Path Suggestion }
    { 12  ;   ;Last R.P. Create Date;Date         ;CaptionML=ENU=Last R.P. Create Date }
    { 13  ;   ;Last R.P. Create Time;Time         ;CaptionML=ENU=Last R.P. Create Time }
    { 14  ;   ;Last R.P. Create User;Code60       ;CaptionML=ENU=Last R.P. Create User }
    { 15  ;   ;Next R.P. Schedule Date;Date       ;CaptionML=ENU=Next R.P. Schedule Date }
    { 16  ;   ;Repl. Path Suggestions;Integer     ;FieldClass=FlowField;
                                                   CalcFormula=Count("Suggested Transfer Header" WHERE (Document Type=CONST(Repl. Path),
                                                                                                        Transfer-to Code=FIELD(Location Code)));
                                                   CaptionML=ENU=Repl. Path Suggestions;
                                                   Editable=No }
    { 17  ;   ;Last Repl. Path Creation;DateTime  ;CaptionML=ENU=Last Repl. Path Creation }
    { 30  ;   ;Select Inv. Balancing;Boolean      ;CaptionML=ENU=Select Inv. Balancing }
    { 31  ;   ;Last Inv. Bal. Create Date;Date    ;CaptionML=ENU=Last Inv. Bal. Create Date }
    { 32  ;   ;Last Inv. Bal. Create Time;Time    ;CaptionML=ENU=Last Inv. Bal. Create Time }
    { 33  ;   ;Last Inv. Bal. Create User;Code60  ;CaptionML=ENU=Last Inv. Bal. Create User }
    { 34  ;   ;Next Inv. Bal. Schedule Date;Date  ;CaptionML=ENU=Next Inv. Bal. Schedule Date }
    { 35  ;   ;Inv. Balancing Suggestion;Integer  ;FieldClass=FlowField;
                                                   CalcFormula=Count("Suggested Transfer Header" WHERE (Document Type=CONST(Inv. Balancing),
                                                                                                        Transfer-to Code=FIELD(Location Code)));
                                                   CaptionML=ENU=Inv. Balancing Suggestion;
                                                   Editable=No }
    { 36  ;   ;Inv. Balancing Priority;Integer    ;CaptionML=ENU=Inv. Balancing Priority }
    { 37  ;   ;Replenishment Purchaser;Code10     ;TableRelation=Salesperson/Purchaser.Code;
                                                   CaptionML=ENU=Replenishment Purchaser }
    { 38  ;   ;Inv. Balancing Purchaser;Code10    ;TableRelation=Salesperson/Purchaser.Code;
                                                   CaptionML=ENU=Inv. Balancing Purchaser }
  }
  KEYS
  {
    {    ;Location Code                           ;Clustered=Yes }
    {    ;Inv. Balancing Priority                  }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      Location@1240030000 : Record 14;
      TransferCalendar@1240030001 : Record 14000597;
      SugTranHdr@1240030002 : Record 14000592;

    PROCEDURE CreateCalendar@1240030000();
    BEGIN
      Location.RESET;
      Location.SETRANGE("Enable Adv. Forecasting",TRUE);
      IF Location.FIND('-') THEN
        REPEAT
          TransferCalendar.INIT;
          TransferCalendar."Location Code" := Location.Code;
          IF TransferCalendar.INSERT THEN;
        UNTIL Location.NEXT = 0;
    END;

    PROCEDURE DeleteAllReplTranDoc@1240030001(CurrLocation@1240030000 : Code[10]);
    BEGIN
      SugTranHdr.RESET;
      SugTranHdr.SETRANGE("Document Type",SugTranHdr."Document Type"::"Repl. Path");
      SugTranHdr.SETRANGE("Transfer-to Code",CurrLocation);
      SugTranHdr.DELETEALL(TRUE);
    END;

    PROCEDURE DeleteAllInvBalDoc@1240030002(CurrLocation@1240030000 : Code[10]);
    BEGIN
      SugTranHdr.RESET;
      SugTranHdr.SETRANGE("Document Type",SugTranHdr."Document Type"::"Inv. Balancing");
      SugTranHdr.SETRANGE("Transfer-to Code",CurrLocation);
      SugTranHdr.DELETEALL(TRUE);
    END;

    BEGIN
    END.
  }
}

