OBJECT Table 14002605 Collaborative Forecast Line
{
  OBJECT-PROPERTIES
  {
    Date=12/15/17;
    Time=12:00:00 PM;
    Version List=UBP2.97;
  }
  PROPERTIES
  {
    OnModify=BEGIN
               IF Type <> Type::"New Forecast" THEN
                 ERROR(Text000);
             END;

    CaptionML=ENU=Collaborative Forecast Line;
  }
  FIELDS
  {
    { 1   ;   ;Customer No.        ;Code20        ;TableRelation=Customer.No.;
                                                   CaptionML=ENU=Customer No. }
    { 2   ;   ;Location Code       ;Code10        ;TableRelation=Location.Code;
                                                   CaptionML=ENU=Location Code }
    { 3   ;   ;Item No.            ;Code50        ;TableRelation=Item.No.;
                                                   OnValidate=BEGIN
                                                                IF "Location Code" <> xRec."Location Code" THEN
                                                                  "Item No." := '';
                                                              END;

                                                   CaptionML=ENU=Item No. }
    { 4   ;   ;Variant             ;Code10        ;TableRelation="Item Variant".Code WHERE (Item No.=FIELD(Item No.));
                                                   CaptionML=ENU=Variant }
    { 5   ;   ;Type                ;Option        ;CaptionML=ENU=Type;
                                                   OptionCaptionML=ENU=Title,Forecast,New Forecast;
                                                   OptionString=Title,Forecast,New Forecast }
    { 14  ;   ;Description         ;Text50        ;CaptionML=ENU=Description }
    { 15  ;   ;Period 1 Qty.       ;Decimal       ;CaptionML=ENU=Period 1 Qty. }
    { 16  ;   ;Period 2 Qty.       ;Decimal       ;CaptionML=ENU=Period 2 Qty. }
    { 17  ;   ;Period 3 Qty.       ;Decimal       ;CaptionML=ENU=Period 3 Qty. }
    { 18  ;   ;Period 4 Qty.       ;Decimal       ;CaptionML=ENU=Period 4 Qty. }
    { 19  ;   ;Period 5 Qty.       ;Decimal       ;CaptionML=ENU=Period 5 Qty. }
    { 20  ;   ;Period 6 Qty.       ;Decimal       ;CaptionML=ENU=Period 6 Qty. }
    { 21  ;   ;Period 7 Qty.       ;Decimal       ;CaptionML=ENU=Period 7 Qty. }
    { 22  ;   ;Period 8 Qty.       ;Decimal       ;CaptionML=ENU=Period 8 Qty. }
    { 23  ;   ;Period 9 Qty.       ;Decimal       ;CaptionML=ENU=Period 9 Qty. }
    { 24  ;   ;Period 10 Qty.      ;Decimal       ;CaptionML=ENU=Period 10 Qty. }
    { 25  ;   ;Period 11 Qty.      ;Decimal       ;CaptionML=ENU=Period 11 Qty. }
    { 26  ;   ;Period 12 Qty.      ;Decimal       ;CaptionML=ENU=Period 12 Qty. }
    { 27  ;   ;Starting Date       ;Date          ;CaptionML=ENU=Starting Date }
    { 28  ;   ;Period 1            ;Text20        ;OnValidate=BEGIN
                                                                CheckReview(1);
                                                              END;

                                                   CaptionML=ENU=Period 1 }
    { 29  ;   ;Period 2            ;Text20        ;OnValidate=BEGIN
                                                                CheckReview(2);
                                                              END;

                                                   CaptionML=ENU=Period 2 }
    { 30  ;   ;Period 3            ;Text20        ;OnValidate=BEGIN
                                                                CheckReview(3);
                                                              END;

                                                   CaptionML=ENU=Period 3 }
    { 31  ;   ;Period 4            ;Text20        ;OnValidate=BEGIN
                                                                CheckReview(4);
                                                              END;

                                                   CaptionML=ENU=Period 4 }
    { 32  ;   ;Period 5            ;Text20        ;OnValidate=BEGIN
                                                                CheckReview(5);
                                                              END;

                                                   CaptionML=ENU=Period 5 }
    { 33  ;   ;Period 6            ;Text20        ;OnValidate=BEGIN
                                                                CheckReview(6);
                                                              END;

                                                   CaptionML=ENU=Period 6 }
    { 34  ;   ;Period 7            ;Text20        ;OnValidate=BEGIN
                                                                CheckReview(7);
                                                              END;

                                                   CaptionML=ENU=Period 7 }
    { 35  ;   ;Period 8            ;Text20        ;OnValidate=BEGIN
                                                                CheckReview(8);
                                                              END;

                                                   CaptionML=ENU=Period 8 }
    { 36  ;   ;Period 9            ;Text20        ;OnValidate=BEGIN
                                                                CheckReview(9);
                                                              END;

                                                   CaptionML=ENU=Period 9 }
    { 37  ;   ;Period 10           ;Text20        ;OnValidate=BEGIN
                                                                CheckReview(10);
                                                              END;

                                                   CaptionML=ENU=Period 10 }
    { 38  ;   ;Period 11           ;Text20        ;OnValidate=BEGIN
                                                                CheckReview(11);
                                                              END;

                                                   CaptionML=ENU=Period 11 }
    { 39  ;   ;Period 12           ;Text20        ;OnValidate=BEGIN
                                                                CheckReview(12);
                                                              END;

                                                   CaptionML=ENU=Period 12 }
    { 40  ;   ;Review Forecast     ;Boolean       ;CaptionML=ENU=Review Forecast }
    { 41  ;   ;Period 13 Qty.      ;Decimal       ;CaptionML=ENU=Period 13 Qty. }
    { 42  ;   ;Period 14 Qty.      ;Decimal       ;CaptionML=ENU=Period 14 Qty. }
    { 43  ;   ;Period 15 Qty.      ;Decimal       ;CaptionML=ENU=Period 15 Qty. }
    { 44  ;   ;Period 13           ;Text20        ;OnValidate=BEGIN
                                                                CheckReview(13);
                                                              END;

                                                   CaptionML=ENU=Period 13 }
    { 45  ;   ;Period 14           ;Text20        ;OnValidate=BEGIN
                                                                CheckReview(14);
                                                              END;

                                                   CaptionML=ENU=Period 14 }
    { 46  ;   ;Period 15           ;Text20        ;OnValidate=BEGIN
                                                                CheckReview(15);
                                                              END;

                                                   CaptionML=ENU=Period 15 }
    { 47  ;   ;Period 16           ;Text20        ;OnValidate=BEGIN
                                                                CheckReview(16);
                                                              END;

                                                   CaptionML=ENU=Period 16 }
    { 48  ;   ;Period 17           ;Text20        ;OnValidate=BEGIN
                                                                CheckReview(17);
                                                              END;

                                                   CaptionML=ENU=Period 17 }
    { 49  ;   ;Period 18           ;Text20        ;OnValidate=BEGIN
                                                                CheckReview(18);
                                                              END;

                                                   CaptionML=ENU=Period 18 }
    { 50  ;   ;Period 19           ;Text20        ;OnValidate=BEGIN
                                                                CheckReview(19);
                                                              END;

                                                   CaptionML=ENU=Period 19 }
    { 51  ;   ;Period 20           ;Text20        ;OnValidate=BEGIN
                                                                CheckReview(20);
                                                              END;

                                                   CaptionML=ENU=Period 20 }
    { 52  ;   ;Period 21           ;Text20        ;OnValidate=BEGIN
                                                                CheckReview(21);
                                                              END;

                                                   CaptionML=ENU=Period 21 }
    { 53  ;   ;Period 22           ;Text20        ;OnValidate=BEGIN
                                                                CheckReview(22);
                                                              END;

                                                   CaptionML=ENU=Period 22 }
    { 54  ;   ;Period 23           ;Text20        ;OnValidate=BEGIN
                                                                CheckReview(23);
                                                              END;

                                                   CaptionML=ENU=Period 23 }
    { 55  ;   ;Period 24           ;Text20        ;OnValidate=BEGIN
                                                                CheckReview(24);
                                                              END;

                                                   CaptionML=ENU=Period 24 }
    { 56  ;   ;Period 25           ;Text20        ;OnValidate=BEGIN
                                                                CheckReview(25);
                                                              END;

                                                   CaptionML=ENU=Period 25 }
    { 57  ;   ;Period 26           ;Text20        ;OnValidate=BEGIN
                                                                CheckReview(26);
                                                              END;

                                                   CaptionML=ENU=Period 26 }
    { 58  ;   ;Period 27           ;Text20        ;OnValidate=BEGIN
                                                                CheckReview(27);
                                                              END;

                                                   CaptionML=ENU=Period 27 }
    { 59  ;   ;Period 28           ;Text20        ;OnValidate=BEGIN
                                                                CheckReview(28);
                                                              END;

                                                   CaptionML=ENU=Period 28 }
    { 60  ;   ;Period 29           ;Text20        ;OnValidate=BEGIN
                                                                CheckReview(29);
                                                              END;

                                                   CaptionML=ENU=Period 29 }
    { 61  ;   ;Period 30           ;Text20        ;OnValidate=BEGIN
                                                                CheckReview(30);
                                                              END;

                                                   CaptionML=ENU=Period 30 }
    { 62  ;   ;Period 31           ;Text20        ;OnValidate=BEGIN
                                                                CheckReview(31);
                                                              END;

                                                   CaptionML=ENU=Period 31 }
    { 63  ;   ;Period 32           ;Text20        ;OnValidate=BEGIN
                                                                CheckReview(32);
                                                              END;

                                                   CaptionML=ENU=Period 32 }
    { 64  ;   ;Period 33           ;Text20        ;OnValidate=BEGIN
                                                                CheckReview(33);
                                                              END;

                                                   CaptionML=ENU=Period 33 }
    { 65  ;   ;Period 34           ;Text20        ;OnValidate=BEGIN
                                                                CheckReview(34);
                                                              END;

                                                   CaptionML=ENU=Period 34 }
    { 66  ;   ;Period 35           ;Text20        ;OnValidate=BEGIN
                                                                CheckReview(35);
                                                              END;

                                                   CaptionML=ENU=Period 35 }
    { 67  ;   ;Period 36           ;Text20        ;OnValidate=BEGIN
                                                                CheckReview(36);
                                                              END;

                                                   CaptionML=ENU=Period 36 }
    { 68  ;   ;Period 37           ;Text20        ;OnValidate=BEGIN
                                                                CheckReview(37);
                                                              END;

                                                   CaptionML=ENU=Period 37 }
    { 69  ;   ;Period 38           ;Text20        ;OnValidate=BEGIN
                                                                CheckReview(38);
                                                              END;

                                                   CaptionML=ENU=Period 38 }
    { 70  ;   ;Period 39           ;Text20        ;OnValidate=BEGIN
                                                                CheckReview(39);
                                                              END;

                                                   CaptionML=ENU=Period 39 }
    { 71  ;   ;Period 40           ;Text20        ;OnValidate=BEGIN
                                                                CheckReview(40);
                                                              END;

                                                   CaptionML=ENU=Period 40 }
    { 72  ;   ;Period 41           ;Text20        ;OnValidate=BEGIN
                                                                CheckReview(41);
                                                              END;

                                                   CaptionML=ENU=Period 41 }
    { 73  ;   ;Period 42           ;Text20        ;OnValidate=BEGIN
                                                                CheckReview(42);
                                                              END;

                                                   CaptionML=ENU=Period 42 }
    { 74  ;   ;Period 43           ;Text20        ;OnValidate=BEGIN
                                                                CheckReview(43);
                                                              END;

                                                   CaptionML=ENU=Period 43 }
    { 75  ;   ;Period 44           ;Text20        ;OnValidate=BEGIN
                                                                CheckReview(44);
                                                              END;

                                                   CaptionML=ENU=Period 44 }
    { 76  ;   ;Period 45           ;Text20        ;OnValidate=BEGIN
                                                                CheckReview(45);
                                                              END;

                                                   CaptionML=ENU=Period 45 }
    { 77  ;   ;Period 46           ;Text20        ;OnValidate=BEGIN
                                                                CheckReview(46);
                                                              END;

                                                   CaptionML=ENU=Period 46 }
    { 78  ;   ;Period 47           ;Text20        ;OnValidate=BEGIN
                                                                CheckReview(47);
                                                              END;

                                                   CaptionML=ENU=Period 47 }
    { 79  ;   ;Period 48           ;Text20        ;OnValidate=BEGIN
                                                                CheckReview(48);
                                                              END;

                                                   CaptionML=ENU=Period 48 }
    { 80  ;   ;Period 49           ;Text20        ;OnValidate=BEGIN
                                                                CheckReview(49);
                                                              END;

                                                   CaptionML=ENU=Period 49 }
    { 81  ;   ;Period 50           ;Text20        ;OnValidate=BEGIN
                                                                CheckReview(50);
                                                              END;

                                                   CaptionML=ENU=Period 50 }
    { 82  ;   ;Period 51           ;Text20        ;OnValidate=BEGIN
                                                                CheckReview(51);
                                                              END;

                                                   CaptionML=ENU=Period 51 }
    { 83  ;   ;Period 52           ;Text20        ;OnValidate=BEGIN
                                                                CheckReview(52);
                                                              END;

                                                   CaptionML=ENU=Period 52 }
    { 84  ;   ;Period 16 Qty.      ;Decimal       ;CaptionML=ENU=Period 16 Qty. }
    { 85  ;   ;Period 17 Qty.      ;Decimal       ;CaptionML=ENU=Period 17 Qty. }
    { 86  ;   ;Period 18 Qty.      ;Decimal       ;CaptionML=ENU=Period 18 Qty. }
    { 87  ;   ;Period 19 Qty.      ;Decimal       ;CaptionML=ENU=Period 19 Qty. }
    { 88  ;   ;Period 20 Qty.      ;Decimal       ;CaptionML=ENU=Period 20 Qty. }
    { 89  ;   ;Period 21 Qty.      ;Decimal       ;CaptionML=ENU=Period 21 Qty. }
    { 90  ;   ;Period 22 Qty.      ;Decimal       ;CaptionML=ENU=Period 22 Qty. }
    { 91  ;   ;Period 23 Qty.      ;Decimal       ;CaptionML=ENU=Period 23 Qty. }
    { 92  ;   ;Period 24 Qty.      ;Decimal       ;CaptionML=ENU=Period 24 Qty. }
    { 93  ;   ;Period 25 Qty.      ;Decimal       ;CaptionML=ENU=Period 25 Qty. }
    { 94  ;   ;Period 26 Qty.      ;Decimal       ;CaptionML=ENU=Period 26 Qty. }
    { 95  ;   ;Period 27 Qty.      ;Decimal       ;CaptionML=ENU=Period 27 Qty. }
    { 96  ;   ;Period 28 Qty.      ;Decimal       ;CaptionML=ENU=Period 28 Qty. }
    { 97  ;   ;Period 29 Qty.      ;Decimal       ;CaptionML=ENU=Period 29 Qty. }
    { 98  ;   ;Period 30 Qty.      ;Decimal       ;CaptionML=ENU=Period 30 Qty. }
    { 99  ;   ;Period 31 Qty.      ;Decimal       ;CaptionML=ENU=Period 31 Qty. }
    { 100 ;   ;Period 32 Qty.      ;Decimal       ;CaptionML=ENU=Period 32 Qty. }
    { 101 ;   ;Period 33 Qty.      ;Decimal       ;CaptionML=ENU=Period 33 Qty. }
    { 102 ;   ;Period 34 Qty.      ;Decimal       ;CaptionML=ENU=Period 34 Qty. }
    { 103 ;   ;Period 35 Qty.      ;Decimal       ;CaptionML=ENU=Period 35 Qty. }
    { 104 ;   ;Period 36 Qty.      ;Decimal       ;CaptionML=ENU=Period 36 Qty. }
    { 105 ;   ;Period 37 Qty.      ;Decimal       ;CaptionML=ENU=Period 37 Qty. }
    { 106 ;   ;Period 38 Qty.      ;Decimal       ;CaptionML=ENU=Period 38 Qty. }
    { 107 ;   ;Period 39 Qty.      ;Decimal       ;CaptionML=ENU=Period 39 Qty. }
    { 108 ;   ;Period 40 Qty.      ;Decimal       ;CaptionML=ENU=Period 40 Qty. }
    { 109 ;   ;Period 41 Qty.      ;Decimal       ;CaptionML=ENU=Period 41 Qty. }
    { 110 ;   ;Period 42 Qty.      ;Decimal       ;CaptionML=ENU=Period 42 Qty. }
    { 111 ;   ;Period 43 Qty.      ;Decimal       ;CaptionML=ENU=Period 43 Qty. }
    { 112 ;   ;Period 44 Qty.      ;Decimal       ;CaptionML=ENU=Period 44 Qty. }
    { 113 ;   ;Period 45 Qty.      ;Decimal       ;CaptionML=ENU=Period 45 Qty. }
    { 114 ;   ;Period 46 Qty.      ;Decimal       ;CaptionML=ENU=Period 46 Qty. }
    { 115 ;   ;Period 47 Qty.      ;Decimal       ;CaptionML=ENU=Period 47 Qty. }
    { 116 ;   ;Period 48 Qty.      ;Decimal       ;CaptionML=ENU=Period 48 Qty. }
    { 117 ;   ;Period 49 Qty.      ;Decimal       ;CaptionML=ENU=Period 49 Qty. }
    { 118 ;   ;Period 50 Qty.      ;Decimal       ;CaptionML=ENU=Period 50 Qty. }
    { 119 ;   ;Period 51 Qty.      ;Decimal       ;CaptionML=ENU=Period 51 Qty. }
    { 120 ;   ;Period 52 Qty.      ;Decimal       ;CaptionML=ENU=Period 52 Qty. }
  }
  KEYS
  {
    {    ;Customer No.,Location Code,Item No.,Variant,Type;
                                                   Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      Text000@1240030004 : TextConst 'ENU=Only New Forecast records can be changed.';
      ColForrecastSetup@1240020000 : Record 14002607;

    PROCEDURE FormatNum@1240030000(NumValue@1240030000 : Decimal) : Text[20];
    VAR
      InvMgtSetup@1240030002 : Record 14000551;
      Pos@1240030001 : Integer;
      TextNum@1240030003 : Text[20];
    BEGIN
      IF InvMgtSetup."Usage Start Date" = 0D THEN
        InvMgtSetup.GET;
      TextNum := FORMAT(NumValue);
      Pos := STRPOS(TextNum,'.');
      IF Pos <> 0 THEN
        TextNum := COPYSTR(TextNum,1,Pos + InvMgtSetup."Item Usage Decimal Places");
      EXIT(TextNum);
    END;

    PROCEDURE ShowItem@1240030002();
    VAR
      Item@1240020002 : Record 27;
    BEGIN
      TESTFIELD("Location Code");
      Item.SETRANGE("No.","Item No.");
      PAGE.RUNMODAL(PAGE::"Item Card",Item);
    END;

    PROCEDURE ShowProcUnit@1240030001();
    VAR
      ProcUnit@1240020000 : Record 14000555;
    BEGIN
      TESTFIELD("Location Code");
      ProcUnit.SETRANGE("Location Code","Location Code");
      ProcUnit.SETRANGE("Item No.","Item No.");
      ProcUnit.SETRANGE("Variant Code",Variant);
      PAGE.RUNMODAL(PAGE::"Procurement Unit Card",ProcUnit);
    END;

    PROCEDURE ShowForecast@1240030003();
    VAR
      ForecastView@1240020001 : Page 14002661;
      ProcUnit@1240020000 : Record 14000555;
    BEGIN
      TESTFIELD("Location Code");
      ProcUnit.SETRANGE("Location Code","Location Code");
      ProcUnit.SETRANGE("Item No.","Item No.");
      ProcUnit.SETRANGE("Variant Code",Variant);
      ProcUnit.FIND('-');
      CLEAR(ForecastView);
      ForecastView.SetProcUnitandSourceNo(ProcUnit,'');
      ForecastView.RUN;
    END;

    PROCEDURE ShowItemUsage@1240030004();
    VAR
      ItemUsage@1240020001 : Record 14000557;
    BEGIN
      TESTFIELD("Location Code");
      ItemUsage.RESET;
      ItemUsage.SETCURRENTKEY(
        "Location Code","Item No.","Variant Code","Starting Date","Ending Date");
      ItemUsage.SETRANGE("Location Code","Location Code");
      ItemUsage.SETRANGE("Item No.","Item No.");
      ItemUsage.SETRANGE("Variant Code",Variant);
      PAGE.RUN(PAGE::"Item Usage List",ItemUsage);
    END;

    PROCEDURE CheckReview@1240030005(Period@1240030000 : Integer);
    VAR
      Text001@1240030001 : TextConst 'ENU=Outside the Collaborative Forecast Periods of %1';
      CurrentForecast@1240020002 : Decimal;
      NewForecast@1240020001 : Decimal;
      i@1240020000 : Integer;
      ForColForLine@1240020005 : Record 14002605;
      ForCustItem@1240020003 : Record 14002602;
    BEGIN
      IF Type = Type::Forecast THEN
        EXIT;
      ColForrecastSetup.GET;
      IF Period > ColForrecastSetup."Forecast Periods" THEN
        ERROR(Text001,ColForrecastSetup."Forecast Periods");
      IF NOT ForColForLine.GET(
        "Customer No.","Location Code","Item No.",Variant,Type::Forecast)
      THEN BEGIN
        ForColForLine.INIT;
        ForColForLine.COPY(Rec);
      END;

      "Review Forecast" := FALSE;
      i := 1;
      REPEAT
        CurrentForecast := 0;
        NewForecast := 0;
        CASE i OF
          1:  EvaluateCurrNewForecast(ForColForLine."Period 1", "Period 1", CurrentForecast, NewForecast);
          2:  EvaluateCurrNewForecast(ForColForLine."Period 2", "Period 2", CurrentForecast, NewForecast);
          3:  EvaluateCurrNewForecast(ForColForLine."Period 3", "Period 3", CurrentForecast, NewForecast);
          4:  EvaluateCurrNewForecast(ForColForLine."Period 4", "Period 4", CurrentForecast, NewForecast);
          5:  EvaluateCurrNewForecast(ForColForLine."Period 5", "Period 5", CurrentForecast, NewForecast);
          6:  EvaluateCurrNewForecast(ForColForLine."Period 6", "Period 6", CurrentForecast, NewForecast);
          7:  EvaluateCurrNewForecast(ForColForLine."Period 7", "Period 7", CurrentForecast, NewForecast);
          8:  EvaluateCurrNewForecast(ForColForLine."Period 8", "Period 8", CurrentForecast, NewForecast);
          9:  EvaluateCurrNewForecast(ForColForLine."Period 9", "Period 9", CurrentForecast, NewForecast);
          10:  EvaluateCurrNewForecast(ForColForLine."Period 10", "Period 10", CurrentForecast, NewForecast);
          11:  EvaluateCurrNewForecast(ForColForLine."Period 11", "Period 11", CurrentForecast, NewForecast);
          12:  EvaluateCurrNewForecast(ForColForLine."Period 12", "Period 12", CurrentForecast, NewForecast);
          13:  EvaluateCurrNewForecast(ForColForLine."Period 13", "Period 13", CurrentForecast, NewForecast);
          14:  EvaluateCurrNewForecast(ForColForLine."Period 14", "Period 14", CurrentForecast, NewForecast);
          15:  EvaluateCurrNewForecast(ForColForLine."Period 15", "Period 15", CurrentForecast, NewForecast);
          16:  EvaluateCurrNewForecast(ForColForLine."Period 16", "Period 16", CurrentForecast, NewForecast);
          17:  EvaluateCurrNewForecast(ForColForLine."Period 17", "Period 17", CurrentForecast, NewForecast);
          18:  EvaluateCurrNewForecast(ForColForLine."Period 18", "Period 18", CurrentForecast, NewForecast);
          19:  EvaluateCurrNewForecast(ForColForLine."Period 19", "Period 19", CurrentForecast, NewForecast);
          20:  EvaluateCurrNewForecast(ForColForLine."Period 20", "Period 20", CurrentForecast, NewForecast);
          21:  EvaluateCurrNewForecast(ForColForLine."Period 21", "Period 21", CurrentForecast, NewForecast);
          22:  EvaluateCurrNewForecast(ForColForLine."Period 22", "Period 22", CurrentForecast, NewForecast);
          23:  EvaluateCurrNewForecast(ForColForLine."Period 23", "Period 23", CurrentForecast, NewForecast);
          24:  EvaluateCurrNewForecast(ForColForLine."Period 24", "Period 24", CurrentForecast, NewForecast);
          25:  EvaluateCurrNewForecast(ForColForLine."Period 25", "Period 25", CurrentForecast, NewForecast);
          26:  EvaluateCurrNewForecast(ForColForLine."Period 26", "Period 26", CurrentForecast, NewForecast);
          27:  EvaluateCurrNewForecast(ForColForLine."Period 27", "Period 27", CurrentForecast, NewForecast);
          28:  EvaluateCurrNewForecast(ForColForLine."Period 28", "Period 28", CurrentForecast, NewForecast);
          29:  EvaluateCurrNewForecast(ForColForLine."Period 29", "Period 29", CurrentForecast, NewForecast);
          30:  EvaluateCurrNewForecast(ForColForLine."Period 30", "Period 30", CurrentForecast, NewForecast);
          31:  EvaluateCurrNewForecast(ForColForLine."Period 31", "Period 31", CurrentForecast, NewForecast);
          32:  EvaluateCurrNewForecast(ForColForLine."Period 32", "Period 32", CurrentForecast, NewForecast);
          33:  EvaluateCurrNewForecast(ForColForLine."Period 33", "Period 33", CurrentForecast, NewForecast);
          34:  EvaluateCurrNewForecast(ForColForLine."Period 34", "Period 34", CurrentForecast, NewForecast);
          35:  EvaluateCurrNewForecast(ForColForLine."Period 35", "Period 35", CurrentForecast, NewForecast);
          36:  EvaluateCurrNewForecast(ForColForLine."Period 36", "Period 36", CurrentForecast, NewForecast);
          37:  EvaluateCurrNewForecast(ForColForLine."Period 37", "Period 37", CurrentForecast, NewForecast);
          38:  EvaluateCurrNewForecast(ForColForLine."Period 38", "Period 38", CurrentForecast, NewForecast);
          39:  EvaluateCurrNewForecast(ForColForLine."Period 39", "Period 39", CurrentForecast, NewForecast);
          40:  EvaluateCurrNewForecast(ForColForLine."Period 40", "Period 40", CurrentForecast, NewForecast);
          41:  EvaluateCurrNewForecast(ForColForLine."Period 41", "Period 41", CurrentForecast, NewForecast);
          42:  EvaluateCurrNewForecast(ForColForLine."Period 42", "Period 42", CurrentForecast, NewForecast);
          43:  EvaluateCurrNewForecast(ForColForLine."Period 43", "Period 43", CurrentForecast, NewForecast);
          44:  EvaluateCurrNewForecast(ForColForLine."Period 44", "Period 44", CurrentForecast, NewForecast);
          45:  EvaluateCurrNewForecast(ForColForLine."Period 45", "Period 45", CurrentForecast, NewForecast);
          46:  EvaluateCurrNewForecast(ForColForLine."Period 46", "Period 46", CurrentForecast, NewForecast);
          47:  EvaluateCurrNewForecast(ForColForLine."Period 47", "Period 47", CurrentForecast, NewForecast);
          48:  EvaluateCurrNewForecast(ForColForLine."Period 48", "Period 48", CurrentForecast, NewForecast);
          49:  EvaluateCurrNewForecast(ForColForLine."Period 49", "Period 49", CurrentForecast, NewForecast);
          50:  EvaluateCurrNewForecast(ForColForLine."Period 50", "Period 50", CurrentForecast, NewForecast);
          51:  EvaluateCurrNewForecast(ForColForLine."Period 51", "Period 51", CurrentForecast, NewForecast);
          52:  EvaluateCurrNewForecast(ForColForLine."Period 52", "Period 52", CurrentForecast, NewForecast);
        END;
        i := i + 1;
      UNTIL i > ColForrecastSetup."Forecast Periods";
    END;

    PROCEDURE CheckField@1240030006(Forecast@1240030000 : Decimal;NewForecast@1240030001 : Decimal);
    VAR
      VariancePercent@1240020001 : Decimal;
    BEGIN
      IF Forecast <> 0 THEN
        VariancePercent :=
          ROUND((NewForecast - Forecast) / Forecast * 100)
      ELSE
        IF NewForecast <> 0 THEN
          VariancePercent := 100
        ELSE
          VariancePercent := 0;
      IF ABS(VariancePercent) > ColForrecastSetup."Forecast Review %" THEN
        "Review Forecast" := TRUE;
    END;

    LOCAL PROCEDURE EvaluateCurrNewForecast@1240020015(TextCurrentForecast@1240020002 : Text[12];TextNewForecast@1240020003 : Text[12];VAR CurrentForecast@1240020005 : Decimal;VAR NewForecast@1240020004 : Decimal);
    BEGIN
      CurrentForecast := 0;
      NewForecast := 0;
      IF TextCurrentForecast <> '' THEN
       EVALUATE(CurrentForecast,TextCurrentForecast);
      IF TextNewForecast <> '' THEN
        EVALUATE(NewForecast,TextNewForecast);
      CheckField(CurrentForecast,NewForecast);
    END;

    BEGIN
    END.
  }
}

