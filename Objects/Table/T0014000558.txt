OBJECT Table 14000558 Item Usage Adjustment
{
  OBJECT-PROPERTIES
  {
    Date=03/01/20;
    Time=12:00:00 PM;
    Version List=UBP3.02;
  }
  PROPERTIES
  {
    OnInsert=BEGIN
               "Original Location Code" := "Location Code";
               "Original Item No." := "Item No.";
               "Original Variant Code" := "Variant Code";
               "Adjusted By" := USERID;
               "Adjusted Date" := TODAY;
             END;

    OnModify=BEGIN
               "Adjusted By" := USERID;
               "Adjusted Date" := TODAY;
             END;

    OnDelete=BEGIN
               CheckPeriod;
             END;

    CaptionML=ENU=Item Usage Adjustment;
    LookupPageID=Page14000567;
    DrillDownPageID=Page14000567;
  }
  FIELDS
  {
    { 1   ;   ;Location Code       ;Code10        ;TableRelation=Location.Code;
                                                   CaptionML=ENU=Location Code }
    { 2   ;   ;Item No.            ;Code50        ;TableRelation=Item.No.;
                                                   CaptionML=ENU=Item No. }
    { 3   ;   ;Variant Code        ;Code10        ;TableRelation="Item Variant".Code WHERE (Item No.=FIELD(Item No.));
                                                   CaptionML=ENU=Variant Code }
    { 4   ;   ;Starting Date       ;Date          ;TableRelation="Location Inventory Period"."Starting Date" WHERE (Location Code=FIELD(Location Code));
                                                   CaptionML=ENU=Starting Date }
    { 5   ;   ;Ending Date         ;Date          ;CaptionML=ENU=Ending Date }
    { 6   ;   ;Line No.            ;Integer       ;CaptionML=ENU=Line No. }
    { 11  ;   ;Original Quantity   ;Decimal       ;CaptionML=ENU=Original Quantity;
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 12  ;   ;Adjustment Quantity ;Decimal       ;OnValidate=BEGIN
                                                                CheckPeriod;
                                                              END;

                                                   CaptionML=ENU=Adjustment Quantity;
                                                   DecimalPlaces=0:5 }
    { 13  ;   ;Reason              ;Code10        ;TableRelation="Usage Adjustment Reason".Code WHERE (Type=CONST(Usage Adjustment));
                                                   OnValidate=BEGIN
                                                                CheckPeriod;
                                                              END;

                                                   CaptionML=ENU=Reason }
    { 14  ;   ;Adjusted By         ;Code60        ;CaptionML=ENU=Adjusted By }
    { 15  ;   ;Adjusted Date       ;Date          ;CaptionML=ENU=Adjusted Date }
    { 16  ;   ;Original Location Code;Code10      ;CaptionML=ENU=Original Location Code }
    { 17  ;   ;Original Item No.   ;Code20        ;CaptionML=ENU=Original Item No. }
    { 18  ;   ;Original Variant Code;Code10       ;CaptionML=ENU=Original Variant Code }
    { 19  ;   ;Original Customer Code;Code20      ;CaptionML=ENU=Original Customer Code }
    { 20  ;   ;Temporary Adjustment;Boolean       ;CaptionML=ENU=Temporary Adjustment }
    { 21  ;   ;Order No.           ;Code20        ;CaptionML=ENU=Order No. }
    { 22  ;   ;Order Line No.      ;Integer       ;CaptionML=ENU=Order Line No. }
    { 23  ;   ;Promotion Code      ;Code10        ;TableRelation="AFP Promotion Header".Code;
                                                   CaptionML=ENU=Promotion Code }
  }
  KEYS
  {
    {    ;Location Code,Item No.,Variant Code,Starting Date,Ending Date,Line No.;
                                                   Clustered=Yes }
    {    ;Item No.,Location Code,Variant Code,Starting Date,Ending Date,Line No.;
                                                   SumIndexFields=Adjustment Quantity }
    {    ;Location Code,Adjustment Quantity        }
    {    ;Original Location Code,Original Item No.,Original Variant Code }
    {    ;Order No.,Order Line No.,Temporary Adjustment }
    {    ;Location Code,Starting Date,Temporary Adjustment }
    {    ;Item No.,Starting Date                   }
    {    ;Promotion Code                           }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      ProcUnit@1240030001 : Record 14000555;

    PROCEDURE CheckPeriod@1();
    VAR
      LocInvPeriod@14000500 : Record 14000553;
      UBP@1240020000 : Codeunit 14000564;
    BEGIN
      ProcUnit.GET("Location Code","Item No.","Variant Code");
      ProcUnit."Change Reforecast Required" := TRUE;
      IF (ProcUnit."Replenishment Source Type" = ProcUnit."Replenishment Source Type"::Location) OR
        UBP.SpokesExist(ProcUnit) THEN BEGIN
      ProcUnit."Reforecast Item" := TRUE;

      END;
      ProcUnit.MODIFY(FALSE);
    END;

    BEGIN
    END.
  }
}

