OBJECT Table 14050305 E.D.I. Job Routine
{
  OBJECT-PROPERTIES
  {
    Date=01/07/16;
    Time=12:00:00 PM;
    Version List=SE0.60.10;
  }
  PROPERTIES
  {
    CaptionML=ENU=E.D.I. Job Routine;
  }
  FIELDS
  {
    { 1   ;   ;Job Code            ;Code20        ;TableRelation="E.D.I. Job".Code;
                                                   ValidateTableRelation=Yes;
                                                   CaptionML=ENU=Job Code }
    { 2   ;   ;Line No.            ;Integer       ;CaptionML=ENU=Line No. }
    { 3   ;   ;Routine             ;Code30        ;TableRelation="E.D.I. Job Routine Command";
                                                   ValidateTableRelation=Yes;
                                                   TestTableRelation=No;
                                                   CaptionML=ENU=Routine;
                                                   Editable=Yes }
    { 11  ;   ;Trade Partner Filter;Text250       ;TableRelation="E.D.I. Trade Partner";
                                                   OnValidate=BEGIN
                                                                IF (Routine = 'SENDPURCHORDER') OR
                                                                   (Routine = 'SENDWHSESHIPORDER') OR
                                                                   (Routine = 'SENDWHSEPURCHADVICE') OR
                                                                   (Routine = 'SENDTRANSFERORDER') OR
                                                                   (Routine = 'SENDTRANSFERSHIPMENT')
                                                                THEN BEGIN
                                                                  IF "Trade Partner Filter" <> '' THEN
                                                                    ERROR(Text001,Routine);
                                                                END;
                                                              END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=ENU=Trade Partner Filter }
    { 12  ;   ;Navision Document Filter;Text250   ;TableRelation=IF (Routine=FILTER(RECEIVEEDI)) "E.D.I. Navision Available Doc." WHERE (Type=CONST(Import))
                                                                 ELSE IF (Routine=FILTER(EXPORTALLSENDDOCS)) "E.D.I. Navision Available Doc." WHERE (Type=CONST(Export))
                                                                 ELSE IF (Routine=FILTER(PROCESSRECEIVEDOC)) "E.D.I. Navision Available Doc." WHERE (Type=CONST(Import));
                                                   OnValidate=BEGIN
                                                                IF (Routine <> 'RECEIVEEDI') AND (Routine <> 'EXPORTALLSENDDOCS') AND (Routine <> 'PROCESSRECEIVEDOC') THEN
                                                                  ERROR(Text002,Routine);
                                                                IF "Navision Document Filter" <> '' THEN BEGIN
                                                                  CASE Routine OF
                                                                    'RECEIVEEDI':
                                                                      BEGIN
                                                                        EDINavisionAvailableDoc.RESET;
                                                                        EDINavisionAvailableDoc.SETRANGE(Type,EDINavisionAvailableDoc.Type::Import);
                                                                        EDINavisionAvailableDoc.SETRANGE(Document,"Navision Document Filter");
                                                                        IF NOT EDINavisionAvailableDoc.FIND('-') THEN
                                                                          ERROR(Text005,"Navision Document Filter",Routine);
                                                                      END;
                                                                    'PROCESSRECEIVEDOC':
                                                                      BEGIN
                                                                        EDINavisionAvailableDoc.RESET;
                                                                        EDINavisionAvailableDoc.SETRANGE(Type,EDINavisionAvailableDoc.Type::Import);
                                                                        EDINavisionAvailableDoc.SETRANGE(Document,"Navision Document Filter");
                                                                        IF NOT EDINavisionAvailableDoc.FIND('-') THEN
                                                                          ERROR(Text005,"Navision Document Filter",Routine);
                                                                      END;
                                                                    'EXPORTALLSENDDOCS':
                                                                      BEGIN
                                                                        EDINavisionAvailableDoc.RESET;
                                                                        EDINavisionAvailableDoc.SETRANGE(Type,EDINavisionAvailableDoc.Type::Export);
                                                                        EDINavisionAvailableDoc.SETRANGE(Document,"Navision Document Filter");
                                                                        IF NOT EDINavisionAvailableDoc.FIND('-') THEN
                                                                          ERROR(Text005,"Navision Document Filter",Routine);
                                                                      END;
                                                                  END;
                                                                END;
                                                              END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=ENU=Navision Document Filter }
    { 13  ;   ;EDI Document No. Filter;Text100    ;OnValidate=BEGIN
                                                                IF (Routine = 'RECEIVEEDI') OR (Routine = 'EXPORTALLSENDDOCS') OR (Routine = 'PROCESSRECEIVEDOC') THEN
                                                                  EXIT
                                                                ELSE BEGIN
                                                                  IF "EDI Document No. Filter" <> '' THEN
                                                                    ERROR(Text007,Routine);
                                                                END;
                                                              END;

                                                   ValidateTableRelation=Yes;
                                                   TestTableRelation=Yes;
                                                   CaptionML=ENU=EDI Document No. Filter }
    { 15  ;   ;Inactive            ;Boolean       ;CaptionML=ENU=Inactive }
    { 16  ;   ;Company Filter      ;Text250       ;TableRelation=Company;
                                                   OnValidate=BEGIN
                                                                IF (Routine = 'SENDPURCHORDER') OR
                                                                   (Routine = 'SENDWHSESHIPORDER') OR
                                                                   (Routine = 'SENDWHSEPURCHADVICE') OR
                                                                   (Routine = 'SENDTRANSFERORDER') OR
                                                                   (Routine = 'SENDTRANSFERSHIPMENT')
                                                                THEN BEGIN
                                                                  IF "Company Filter" <> '' THEN
                                                                    ERROR(Text003,Routine);
                                                                END;
                                                              END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=ENU=Company Filter }
    { 17  ;   ;Location Filter     ;Text250       ;TableRelation=IF (Routine=FILTER(SENDWHSESHIPORDER)) Location;
                                                   OnValidate=BEGIN
                                                                IF (Routine <> 'SENDWHSESHIPORDER')
                                                                THEN BEGIN
                                                                  IF "Location Filter" <> '' THEN
                                                                    ERROR(Text004,Routine);
                                                                END;
                                                              END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=ENU=Location Filter }
    { 18  ;   ;Process Data Error  ;Boolean       ;CaptionML=ENU=Process Data Error }
  }
  KEYS
  {
    {    ;Job Code,Line No.                       ;Clustered=Yes }
    {    ;Routine                                  }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      Text001@1240020001 : TextConst 'ENU=User defined Trade Partner filter not supported for %1.';
      Text002@1240020000 : TextConst 'ENU=User defined Navision Document filter not supported for %1.';
      Text003@1240020002 : TextConst 'ENU=User defined Company filter not supported for %1.';
      Text004@1240020003 : TextConst 'ENU=User defined Location filter not supported for %1.';
      EDITradePartner@1240020004 : Record 14002360;
      EDINavisionAvailableDoc@1240020005 : Record 14002357;
      Text005@1240020006 : TextConst 'ENU=%1 is not a valid Navision Document for %2 routine.';
      EDISetup@1240020008 : Record 14002367;
      Text007@1240020009 : TextConst 'ENU=User defined EDI Document No.filter not supported for %1.';

    BEGIN
    END.
  }
}

