OBJECT Table 14002651 Advanced Forecasting Setup
{
  OBJECT-PROPERTIES
  {
    Date=11/01/20;
    Time=12:00:00 PM;
    Version List=UBP3.03;
  }
  PROPERTIES
  {
    CaptionML=ENU=Advanced Forecasting Setup;
    LookupPageID=Page14002651;
  }
  FIELDS
  {
    { 1   ;   ;Primary Key         ;Code10        ;CaptionML=ENU=Primary Key }
    { 2   ;   ;Periods to Re-Forecast;Integer     ;CaptionML=ENU=Periods to Re-Forecast }
    { 3   ;   ;Auto Adj. Unusual Usage;Boolean    ;CaptionML=ENU=Auto Adj. Unusual Usage }
    { 4   ;   ;Save Unusual Usage Adj.;Boolean    ;CaptionML=ENU=Save Unusual Usage Adj. }
    { 5   ;   ;Max. Unusual Adj. % ;Integer       ;CaptionML=ENU=Max. Unusual Adj. % }
    { 6   ;   ;Min. Unusual Adj. % ;Integer       ;CaptionML=ENU=Min. Unusual Adj. % }
    { 7   ;   ;Periods to Forecast ;Integer       ;CaptionML=ENU=Periods to Forecast }
    { 8   ;   ;Max. Non Seasonal Trend %;Integer  ;CaptionML=ENU=Max. Non Seasonal Trend % }
    { 9   ;   ;Max. Seasonal Trend %;Integer      ;CaptionML=ENU=Max. Seasonal Trend % }
    { 10  ;   ;New Item Forecast Method;Option    ;CaptionML=ENU=New Item Forecast Method;
                                                   OptionCaptionML=ENU=Moving Average,Sporadic Stock Qty.;
                                                   OptionString=Moving Average,Sporadic Stock Qty. }
    { 11  ;   ;Safety Stock Days   ;Decimal       ;CaptionML=ENU=Safety Stock Days;
                                                   DecimalPlaces=0:2 }
    { 12  ;   ;Check Sporadic Frozen Formula;Boolean;
                                                   CaptionML=ENU=Check Sporadic Frozen Formula }
    { 14  ;   ;Auto Calc. Safety Stock;Boolean    ;CaptionML=ENU=Auto Calc. Safety Stock }
    { 15  ;   ;For. Deviation Calc. Periods;Integer;
                                                   CaptionML=ENU=For. Deviation Calc. Periods }
    { 16  ;   ;Include Over Forecast Periods;Boolean;
                                                   CaptionML=ENU=Include Over Forecast Periods }
    { 17  ;   ;Use Absolute Deviation;Boolean     ;CaptionML=ENU=Use Absolute Deviation }
    { 18  ;   ;Vend. Forc. Excel File Path;Text100;CaptionML=ENU=Vend. Forc. Excel File Path }
    { 19  ;   ;Vend. Forc. Sequence No.;Code10    ;CaptionML=ENU=Vend. Forc. Sequence No. }
    { 20  ;   ;Vend. Forc. Excel File Name;Option ;CaptionML=ENU=Vend. Forc. Excel File Name;
                                                   OptionCaptionML=ENU=Vendor No,Vendor No. + Seq.;
                                                   OptionString=Vendor No,Vendor No. + Seq. }
    { 21  ;   ;Include Variant Code;Boolean       ;CaptionML=ENU=Include Variant Code }
    { 22  ;   ;Assembly Increment Days;Integer    ;CaptionML=ENU=Assembly Increment Days }
    { 23  ;   ;Assembly Max. Increments;Integer   ;CaptionML=ENU=Assembly Max. Increments }
    { 24  ;   ;Maintain Target Stock;Boolean      ;CaptionML=ENU=Maintain Target Stock }
    { 25  ;   ;Auto Update Kit Forecast;Boolean   ;CaptionML=ENU=Auto Update Kit Forecast }
    { 26  ;   ;Max. LTH Days       ;Integer       ;CaptionML=ENU=Max. LTH Days }
    { 27  ;   ;Max. LTH Warning    ;Boolean       ;CaptionML=ENU=Max. LTH Warning }
    { 28  ;   ;Periods to Calculate;Integer       ;CaptionML=ENU=Periods to Calculate }
    { 29  ;   ;Def. Sporadic Rule  ;Code10        ;TableRelation="Sporadic Rule".Code;
                                                   CaptionML=ENU=Def. Sporadic Rule }
    { 30  ;   ;Auto. Adj. Sea. Usage;Boolean      ;CaptionML=ENU=Auto. Adj. Sea. Usage }
    { 31  ;   ;Seasonal Formula Group;Code10      ;TableRelation="Formula Group".Code;
                                                   CaptionML=ENU=Seasonal Formula Group }
    { 32  ;   ;Sea. Periods in Group;Integer      ;CaptionML=ENU=Sea. Periods in Group }
    { 33  ;   ;Sea. Min. 24 Per. Total Usage;Integer;
                                                   CaptionML=ENU=Sea. Min. 24 Per. Total Usage }
    { 34  ;   ;Sea. Pct. as Sea. Usage;Integer    ;CaptionML=ENU=Sea. Pct. as Sea. Usage }
    { 35  ;   ;Sea. Min. 24 Per. With Usage;Integer;
                                                   CaptionML=ENU=Sea. Min. 24 Per. With Usage }
    { 36  ;   ;Sea. Frozen Formula ;Code10        ;TableRelation=Formula.Code;
                                                   CaptionML=ENU=Sea. Frozen Formula }
    { 37  ;   ;Sporadic Base Calc. Method;Option  ;CaptionML=ENU=Sporadic Base Calc. Method;
                                                   OptionCaptionML=ENU=Ave. of Per. With Sales,Median Usage;
                                                   OptionString=Ave. of Per. With Sales,Median Usage }
    { 38  ;   ;Forecast Alloc. Adjust Method;Option;
                                                   CaptionML=ENU=Forecast Alloc. Adjust Method;
                                                   OptionCaptionML=ENU=Hub,Spoke;
                                                   OptionString=Hub,Spoke }
    { 39  ;   ;Exclude Usage on Nonstock Unit;Boolean;
                                                   CaptionML=ENU=Exclude Usage on Nonstock Unit }
    { 40  ;   ;Prorate Per. 1 Before Cons.;Boolean;CaptionML=ENU=Prorate Per. 1 Before Cons. }
    { 41  ;   ;Prorate Forc. Adj. Min. Days;Integer;
                                                   CaptionML=ENU=Prorate Forc. Adj. Min. Days }
    { 42  ;   ;Forecast View Show Chart;Boolean   ;InitValue=Yes;
                                                   CaptionML=ENU=Forecast View Show Chart }
    { 43  ;   ;FC View Show Production Orders;Boolean;
                                                   InitValue=Yes;
                                                   CaptionML=ENU=FC View Show Production Orders }
    { 44  ;   ;FC View Show Components;Boolean    ;InitValue=Yes;
                                                   CaptionML=ENU=FC View Show Components }
    { 45  ;   ;FC View Show Sales Ret. Orders;Boolean;
                                                   InitValue=Yes;
                                                   CaptionML=ENU=FC View Show Sales Ret. Orders }
    { 46  ;   ;FC View Show Forecast Adjust;Boolean;
                                                   InitValue=Yes;
                                                   CaptionML=ENU=FC View Show Forecast Adjust }
    { 47  ;   ;FC View Show Customer Forecast;Boolean;
                                                   InitValue=Yes;
                                                   CaptionML=ENU=FC View Show Customer Forecast }
    { 48  ;   ;FC View Show Transfer Orders;Boolean;
                                                   InitValue=Yes;
                                                   CaptionML=ENU=FC View Show Transfer Orders }
    { 49  ;   ;FC View Show Prior Year;Boolean    ;InitValue=Yes;
                                                   CaptionML=ENU=FC View Show Prior Year }
    { 50  ;   ;New Proc. Unit Sporadic Rule;Code10;TableRelation="Sporadic Rule".Code;
                                                   CaptionML=ENU=New Proc. Unit Sporadic Rule }
    { 51  ;   ;FC View Default No. of Columns;Integer;
                                                   InitValue=0;
                                                   CaptionML=ENU=FC View Default No. of Columns;
                                                   MinValue=0;
                                                   MaxValue=52 }
    { 52  ;   ;Periods Required for Formulas;Integer;
                                                   OnValidate=VAR
                                                                InvMgtSetup@1240020000 : Record 14000551;
                                                              BEGIN
                                                                InvMgtSetup.GET;
                                                                InvMgtSetup.TESTFIELD("No. of Periods in a Year");
                                                                IF "Periods Required for Formulas" <= 0 THEN
                                                                  ERROR(Text002, FIELDCAPTION("Periods Required for Formulas"));
                                                                IF (InvMgtSetup."No. of Periods in a Year" > 0) THEN
                                                                  "Pct Year Per. Req. for Formula" := "Periods Required for Formulas"/InvMgtSetup."No. of Periods in a Year";
                                                              END;

                                                   CaptionML=ENU=Yearly Periods Required to Qualify a Formula }
    { 53  ;   ;Pct Year Per. Req. for Formula;Decimal;
                                                   InitValue=0.666;
                                                   CaptionML=ENU=Percentage of Yearly Periods Required for Formulas;
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 54  ;   ;Auto Forcast Adj. Option;Option    ;CaptionML=ENU=Auto Forcast Adj. Option;
                                                   OptionCaptionML=ENU=Period,Lead Time Horizon,Period and LTH;
                                                   OptionString=Period,Lead Time Horizon,Period and LTH }
    { 56  ;   ;Rounding Rule       ;Option        ;CaptionML=ENU=Rounding Rule;
                                                   OptionCaptionML=ENU=Natural,Round Down,Round Up;
                                                   OptionString=Natural,Round Down,Round Up }
    { 57  ;   ;Forecast Decimal Places;Integer    ;InitValue=0;
                                                   CaptionML=ENU=Forecast Decimal Places;
                                                   MinValue=0;
                                                   MaxValue=5 }
    { 58  ;   ;Hub to Spoke Forc. Calc.;Option    ;CaptionML=ENU=Hub to Spoke Forecast Calculation;
                                                   OptionCaptionML=ENU=Loc. Forecast,Accumulated;
                                                   OptionString=Loc. Forecast,Accumulated }
    { 59  ;   ;Small Forc. Alt. Rounding Rule;Option;
                                                   CaptionML=ENU=Small Forecast Alternative Rounding Rule;
                                                   OptionCaptionML=ENU=Natural,Round Down,Round Up;
                                                   OptionString=Natural,Round Down,Round Up }
    { 60  ;   ;Require Forc. Adj. Notes;Boolean   ;DataClassification=ToBeClassified;
                                                   CaptionML=ENU=Manditory Forecast Adjustment Notes }
    { 61  ;   ;Auto External Forecast;Boolean     ;CaptionML=ENU=Auto External Forecast }
  }
  KEYS
  {
    {    ;Primary Key                             ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      Text001@1240030000 : TextConst 'ENU=Periods to Forecast must not be greater than 15.';
      Text002@1240020000 : TextConst 'ENU=%1 must be greater than 0';
      FirstTimeAutoInstallOverride@1240020001 : Boolean;

    PROCEDURE SetInitialValues@1240030000();
    VAR
      Formula@1240020002 : Record 14002652;
      FormulaGroup@1240020000 : Record 14002664;
      SporadicRule@1240020001 : Record 14002662;
    BEGIN
      "Periods to Re-Forecast" := 4;
      "Auto Adj. Unusual Usage" := TRUE;
      "Max. Unusual Adj. %" := 300;
      "Min. Unusual Adj. %" := 20;
      "Periods to Forecast" := 15;
      "Periods to Calculate" := 15;
      "Max. Non Seasonal Trend %" := 200;
      "Max. Seasonal Trend %" := 200;
      "New Item Forecast Method" :=
        "New Item Forecast Method"::"Sporadic Stock Qty.";
      "Safety Stock Days" := 7;
      "Auto Calc. Safety Stock" := TRUE;
      "For. Deviation Calc. Periods" := 4;
      "Include Over Forecast Periods" := TRUE;
      "Use Absolute Deviation" := TRUE;
      "Vend. Forc. Sequence No." := 'VF00001';
      "Vend. Forc. Excel File Name" :=
        "Vend. Forc. Excel File Name"::"Vendor No. + Seq.";
      "Vend. Forc. Sequence No." := 'VF00001';
      "Vend. Forc. Excel File Name" := "Vend. Forc. Excel File Name"::"Vendor No. + Seq.";
      "Assembly Increment Days" := 7;
      "Assembly Max. Increments" := 13;
      "Maintain Target Stock" := TRUE;
      "Max. LTH Days" := 365;
      "Max. LTH Warning" := FALSE;
      IF NOT FirstTimeAutoInstallOverride THEN BEGIN
      IF FormulaGroup.GET(GetDefaultSeasonalFormulaGroup) THEN
        "Seasonal Formula Group" := FormulaGroup.Code;
      END ELSE
        "Seasonal Formula Group" := GetDefaultSeasonalFormulaGroup;
      IF NOT FirstTimeAutoInstallOverride THEN BEGIN
      IF SporadicRule.GET(GetDefaultSporadicRule) THEN
        "Def. Sporadic Rule" := SporadicRule.Code;
      END ELSE
        "Def. Sporadic Rule" := GetDefaultSporadicRule();
      "Sea. Periods in Group" := 5;
      "Sea. Min. 24 Per. Total Usage" := 40;
      "Sea. Pct. as Sea. Usage" := 70;
      "Sea. Min. 24 Per. With Usage" := 8;
      IF NOT FirstTimeAutoInstallOverride THEN BEGIN
      IF Formula.GET(GetDefaultSeasonalFormula) THEN
        "Sea. Frozen Formula" := Formula.Code;
      END ELSE
        "Sea. Frozen Formula" := GetDefaultSeasonalFormula();
      "FC View Default No. of Columns" := 6;
      "Periods Required for Formulas" := 8;
      "Pct Year Per. Req. for Formula" := 0.666;
      "Auto Forcast Adj. Option" := "Auto Forcast Adj. Option"::Period;
      "Require Forc. Adj. Notes" := TRUE;
    END;

    PROCEDURE GetDefaultSeasonalFormulaGroup@1240020001() : Code[10];
    BEGIN
      EXIT('SEASONAL');
    END;

    PROCEDURE GetDefaultSeasonalFormula@1240020005() : Code[10];
    BEGIN
      EXIT('SEA1-3');
    END;

    PROCEDURE GetDefaultSporadicRule@1240020002() : Code[10];
    BEGIN
      EXIT('GLOBAL');
    END;

    PROCEDURE GetNewItemSporadicRule@1240020003() : Code[10];
    BEGIN
      EXIT('NEWITEM');
    END;

    PROCEDURE SetFirstTimeAutoInstallOverride@1240020000();
    BEGIN
      FirstTimeAutoInstallOverride := TRUE;
    END;

    BEGIN
    END.
  }
}

