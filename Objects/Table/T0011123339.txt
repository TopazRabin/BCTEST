OBJECT Table 11123339 SC - Webshop Orders Overview
{
  OBJECT-PROPERTIES
  {
    Date=07/01/20;
    Time=12:00:00 AM;
    Modified=Yes;
    Version List=SCW19.2.0;
  }
  PROPERTIES
  {
    CaptionML=ENU=Webshop Orders Overview;
  }
  FIELDS
  {
    { 1   ;   ;Table No.           ;Integer       ;CaptionML=ENU=Table No. }
    { 2   ;   ;Document No.        ;Code20        ;CaptionML=ENU=Document No. }
    { 3   ;   ;Document Type       ;Option        ;CaptionML=ENU=Document Type;
                                                   OptionCaptionML=ENU=Quote,Order,Invoice,Credit Memo,Blanket Order,Return Order,Posted Shipment,Posted Invoice,Posted Credit Memo,Posted Receipt;
                                                   OptionString=Quote,Order,Invoice,Credit Memo,Blanket Order,Return Order,Posted Shipment,Posted Invoice,Posted Credit Memo,Posted Receipt }
    { 4   ;   ;Document Date       ;Date          ;CaptionML=ENU=Document Date }
    { 5   ;   ;Currency Code       ;Code10        ;TableRelation=Currency;
                                                   CaptionML=ENU=Currency Code }
    { 6   ;   ;Location Code       ;Code10        ;TableRelation=Location;
                                                   CaptionML=ENU=Location Code }
    { 7   ;   ;Salesperson Code    ;Code10        ;TableRelation=Salesperson/Purchaser;
                                                   CaptionML=ENU=Salesperson Code }
    { 8   ;   ;Shipment Method Code;Code10        ;TableRelation="Shipment Method";
                                                   CaptionML=ENU=Shipment Method Code }
    { 9   ;   ;Shipping Agent Code ;Code10        ;TableRelation="Shipping Agent";
                                                   CaptionML=ENU=Shipping Agent Code }
    { 10  ;   ;Shipping Agent Service Code;Code10 ;TableRelation="Shipping Agent Services".Code WHERE (Shipping Agent Code=FIELD(Shipping Agent Code));
                                                   CaptionML=ENU=Shipping Agent Service Code }
    { 11  ;   ;Requested Delivery Date;Date       ;CaptionML=ENU=Requested Delivery Date }
    { 99  ;   ;Unique Webshop Document Id;GUID    ;CaptionML=ENU=Unique Webshop Document Id;
                                                   Editable=No }
  }
  KEYS
  {
    {    ;Table No.,Document No.,Document Type    ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    PROCEDURE ShowDocument@11123304();
    VAR
      SalesHeader@11123302 : Record 36;
      SalesShipmentHeader@11123303 : Record 110;
      SalesInvoiceHeader@11123304 : Record 112;
      SalesCrMemoHeader@11123305 : Record 114;
      ReturnReceiptHeader@11123306 : Record 6660;
      Context@11123308 : Codeunit 11123305;
      FilterHelper@11123307 : Codeunit 11123321;
    BEGIN
      CASE "Table No." OF
        DATABASE::"Sales Header" :
          BEGIN
            SalesHeader.GET("Document Type","Document No.");
            Context.SetDocStateFilter(SalesHeader."Webshop Document State");
            FilterHelper.FilterSalesHeaderByDocState(SalesHeader);

            IF "Document Type" = "Document Type"::Quote THEN
              PAGE.RUN(PAGE::"Sales Quote",SalesHeader);
            IF "Document Type" = "Document Type"::Order THEN
              PAGE.RUN(PAGE::"Sales Order",SalesHeader);
            IF "Document Type" = "Document Type"::Invoice THEN
              PAGE.RUN(PAGE::"Sales Invoice",SalesHeader);
            IF "Document Type" = "Document Type"::"Return Order" THEN
              PAGE.RUN(PAGE::"Sales Return Order",SalesHeader);

            Context.SetDocStateFilter(SalesHeader."Webshop Document State"::Normal);
          END;
        DATABASE::"Sales Shipment Header" :
          BEGIN
            SalesShipmentHeader.GET("Document No.");
            PAGE.RUN(PAGE::"Posted Sales Shipment",SalesShipmentHeader);
          END;
        DATABASE::"Sales Invoice Header" :
          BEGIN
            SalesInvoiceHeader.GET("Document No.");
            PAGE.RUN(PAGE::"Posted Sales Invoice",SalesInvoiceHeader);
          END;
        DATABASE::"Sales Cr.Memo Header" :
          BEGIN
            SalesCrMemoHeader.GET("Document No.");
            PAGE.RUN(PAGE::"Posted Sales Credit Memo",SalesCrMemoHeader);
          END;
        DATABASE::"Return Receipt Header" :
          BEGIN
            ReturnReceiptHeader.GET("Document No.");
            PAGE.RUN(PAGE::"Posted Return Receipt",ReturnReceiptHeader);
          END;
      END;
    END;

    PROCEDURE UpdateRecords@11123303(VAR SalesDocHeader@11123302 : Record 11123323);
    BEGIN
      RESET;
      DELETEALL;

      FindDocuments36(SalesDocHeader);
      FindDocuments110(SalesDocHeader);
      FindDocuments112(SalesDocHeader);
      FindDocuments114(SalesDocHeader);
      FindDocuments6660(SalesDocHeader);
    END;

    LOCAL PROCEDURE FindDocuments36@11123310(VAR SalesDocHeader@11123302 : Record 11123323);
    VAR
      SalesHeader@11123303 : Record 36;
    BEGIN
      IF SalesHeader.GET(SalesDocHeader."Document Type",SalesDocHeader."Document No.") THEN BEGIN
        INIT;
        "Table No." := DATABASE::"Sales Header";
        "Document No." := SalesHeader."No.";
        CASE SalesHeader."Document Type" OF
          SalesHeader."Document Type"::Order :
            "Document Type" := "Document Type"::Order;
          SalesHeader."Document Type"::Quote :
            "Document Type" := "Document Type"::Quote;
          SalesHeader."Document Type"::Invoice :
            "Document Type" := "Document Type"::Invoice;
          SalesHeader."Document Type"::"Return Order" :
            "Document Type" := "Document Type"::"Return Order";
        END;
        "Document Date" := SalesHeader."Order Date";
        "Currency Code" := SalesHeader."Currency Code";
        "Location Code" := SalesHeader."Location Code";
        "Salesperson Code" := SalesHeader."Salesperson Code";
        "Shipment Method Code" := SalesHeader."Shipment Method Code";
        "Shipping Agent Code" := SalesHeader."Shipping Agent Code";
        "Shipping Agent Service Code" := SalesHeader."Shipping Agent Service Code";
        "Requested Delivery Date" := SalesHeader."Requested Delivery Date";
        "Unique Webshop Document Id" := SalesHeader."Unique Webshop Document Id";
        IF INSERT THEN;
      END;
    END;

    LOCAL PROCEDURE FindDocuments110@11123311(VAR SalesDocHeader@11123302 : Record 11123323);
    VAR
      SalesShipmentHeader@11123303 : Record 110;
    BEGIN
      IF SalesDocHeader."Document Type" <> SalesDocHeader."Document Type"::Order THEN
        EXIT;

      SalesShipmentHeader.SETRANGE("Order No.",SalesDocHeader."Document No.");
      IF SalesShipmentHeader.FINDSET THEN
        REPEAT
          INIT;
          "Table No." := DATABASE::"Sales Shipment Header";
          "Document No." := SalesShipmentHeader."No.";
          "Document Type" := "Document Type"::"Posted Shipment";
          "Document Date" := SalesShipmentHeader."Order Date";
          "Currency Code" := SalesShipmentHeader."Currency Code";
          "Location Code" := SalesShipmentHeader."Location Code";
          "Salesperson Code" := SalesShipmentHeader."Salesperson Code";
          "Shipment Method Code" := SalesShipmentHeader."Shipment Method Code";
          "Shipping Agent Code" := SalesShipmentHeader."Shipping Agent Code";
          "Shipping Agent Service Code" := SalesShipmentHeader."Shipping Agent Service Code";
          "Requested Delivery Date" := SalesShipmentHeader."Requested Delivery Date";
          "Unique Webshop Document Id" := SalesShipmentHeader."Unique Webshop Document Id";
          IF INSERT THEN;
        UNTIL SalesShipmentHeader.NEXT = 0;
    END;

    LOCAL PROCEDURE FindDocuments112@11123312(VAR SalesDocHeader@11123302 : Record 11123323);
    VAR
      SalesInvoiceHeader@11123303 : Record 112;
    BEGIN
      IF SalesDocHeader."Document Type" <> SalesDocHeader."Document Type"::Order THEN
        EXIT;

      SalesInvoiceHeader.SETRANGE("Order No.",SalesDocHeader."Document No.");
      IF SalesInvoiceHeader.FINDSET THEN
        REPEAT
          INIT;
          "Table No." := DATABASE::"Sales Invoice Header";
          "Document No." := SalesInvoiceHeader."No.";
          "Document Type" := "Document Type"::"Posted Invoice";
          "Document Date" := SalesInvoiceHeader."Order Date";
          "Currency Code" := SalesInvoiceHeader."Currency Code";
          "Location Code" := SalesInvoiceHeader."Location Code";
          "Salesperson Code" := SalesInvoiceHeader."Salesperson Code";
          "Shipment Method Code" := SalesInvoiceHeader."Shipment Method Code";
          "Shipping Agent Code" := SalesInvoiceHeader."Shipping Agent Code";
          "Unique Webshop Document Id" := SalesInvoiceHeader."Unique Webshop Document Id";
          IF INSERT THEN;
        UNTIL SalesInvoiceHeader.NEXT = 0;

      SalesInvoiceHeader.RESET;
      SalesInvoiceHeader.SETRANGE("Pre-Assigned No.",SalesDocHeader."Document No.");
      IF SalesInvoiceHeader.FINDSET THEN
        REPEAT
          INIT;
          "Table No." := DATABASE::"Sales Invoice Header";
          "Document No." := SalesInvoiceHeader."No.";
          "Document Type" := "Document Type"::"Posted Invoice";
          "Document Date" := SalesInvoiceHeader."Order Date";
          "Currency Code" := SalesInvoiceHeader."Currency Code";
          "Location Code" := SalesInvoiceHeader."Location Code";
          "Salesperson Code" := SalesInvoiceHeader."Salesperson Code";
          "Shipment Method Code" := SalesInvoiceHeader."Shipment Method Code";
          "Shipping Agent Code" := SalesInvoiceHeader."Shipping Agent Code";
          "Unique Webshop Document Id" := SalesInvoiceHeader."Unique Webshop Document Id";
          IF INSERT THEN;
        UNTIL SalesInvoiceHeader.NEXT = 0;

      SalesInvoiceHeader.RESET;
      SalesInvoiceHeader.SETRANGE("Prepayment Order No.",SalesDocHeader."Document No.");
      IF SalesInvoiceHeader.FINDSET THEN
        REPEAT
          INIT;
          "Table No." := DATABASE::"Sales Invoice Header";
          "Document No." := SalesInvoiceHeader."No.";
          "Document Type" := "Document Type"::"Posted Invoice";
          "Document Date" := SalesInvoiceHeader."Order Date";
          "Currency Code" := SalesInvoiceHeader."Currency Code";
          "Location Code" := SalesInvoiceHeader."Location Code";
          "Salesperson Code" := SalesInvoiceHeader."Salesperson Code";
          "Shipment Method Code" := SalesInvoiceHeader."Shipment Method Code";
          "Shipping Agent Code" := SalesInvoiceHeader."Shipping Agent Code";
          "Unique Webshop Document Id" := SalesInvoiceHeader."Unique Webshop Document Id";
          IF INSERT THEN;
        UNTIL SalesInvoiceHeader.NEXT = 0;
    END;

    LOCAL PROCEDURE FindDocuments114@11123313(VAR SalesDocHeader@11123302 : Record 11123323);
    VAR
      SalesCrMemoHeader@11123303 : Record 114;
    BEGIN
      IF SalesDocHeader."Document Type" <> SalesDocHeader."Document Type"::Order THEN
        EXIT;

      IF ISNULLGUID(SalesDocHeader."Unique Webshop Document Id") THEN
        EXIT;

      SalesCrMemoHeader.SETRANGE("Unique Webshop Document Id",SalesDocHeader."Unique Webshop Document Id");
      IF SalesCrMemoHeader.FINDSET THEN
        REPEAT
          INIT;
          "Table No." := DATABASE::"Sales Cr.Memo Header";
          "Document No." := SalesCrMemoHeader."No.";
          "Document Type" := "Document Type"::"Posted Credit Memo";
          "Document Date" := SalesCrMemoHeader."Posting Date";
          "Currency Code" := SalesCrMemoHeader."Currency Code";
          "Location Code" := SalesCrMemoHeader."Location Code";
          "Salesperson Code" := SalesCrMemoHeader."Salesperson Code";
          "Shipment Method Code" := SalesCrMemoHeader."Shipment Method Code";
          "Unique Webshop Document Id" := SalesCrMemoHeader."Unique Webshop Document Id";
          IF INSERT THEN;
        UNTIL SalesCrMemoHeader.NEXT = 0;
    END;

    LOCAL PROCEDURE FindDocuments6660@11123314(VAR SalesDocHeader@11123302 : Record 11123323);
    VAR
      ReturnReceiptHeader@11123303 : Record 6660;
    BEGIN
      IF SalesDocHeader."Document Type" <> SalesDocHeader."Document Type"::Order THEN
        EXIT;

      IF ISNULLGUID(SalesDocHeader."Unique Webshop Document Id") THEN
        EXIT;

      ReturnReceiptHeader.SETRANGE("Unique Webshop Document Id",SalesDocHeader."Unique Webshop Document Id");
      IF ReturnReceiptHeader.FINDSET THEN
        REPEAT
          INIT;
          "Table No." := DATABASE::"Return Receipt Header";
          "Document No." := ReturnReceiptHeader."No.";
          "Document Type" := "Document Type"::"Posted Receipt";
          "Document Date" := ReturnReceiptHeader."Posting Date";
          "Currency Code" := ReturnReceiptHeader."Currency Code";
          "Location Code" := ReturnReceiptHeader."Location Code";
          "Salesperson Code" := ReturnReceiptHeader."Salesperson Code";
          "Shipment Method Code" := ReturnReceiptHeader."Shipment Method Code";
          "Shipping Agent Code" := ReturnReceiptHeader."Shipping Agent Code";
          "Requested Delivery Date" := ReturnReceiptHeader."Requested Delivery Date";
          "Unique Webshop Document Id" := ReturnReceiptHeader."Unique Webshop Document Id";
          IF INSERT THEN;
        UNTIL ReturnReceiptHeader.NEXT = 0;
    END;

    BEGIN
    END.
  }
}

