OBJECT Table 14002380 E.D.I. Statistics Cue
{
  OBJECT-PROPERTIES
  {
    Date=04/16/21;
    Time=[ 6:25:42 AM];
    Modified=Yes;
    Version List=SE0.60.14,001;
  }
  PROPERTIES
  {
    CaptionML=ENU=E.D.I. Statistics Cue;
  }
  FIELDS
  {
    { 1   ;   ;Primary Key         ;Code10        ;CaptionML=ENU=Primary Key;
                                                   Editable=No }
    { 2   ;   ;Sales Documents Not Created;Integer;FieldClass=FlowField;
                                                   CalcFormula=Count("E.D.I. Receive Document Hdr." WHERE (Sales Doc. Created=CONST(No),
                                                                                                           Navision Document=CONST(I_SLSORD),
                                                                                                           Trade Partner No.=FIELD(Trade Partner Filter),
                                                                                                           Date Received=FIELD(Date Filter)));
                                                   CaptionML=ENU=Sales Documents Not Created;
                                                   Editable=No }
    { 3   ;   ;Send Doc. Created Not Sent;Integer ;FieldClass=FlowField;
                                                   CalcFormula=Count("E.D.I. Send Document Hdr." WHERE (Sent Date=FILTER(=''),
                                                                                                        Trade Partner No.=FIELD(Trade Partner Filter),
                                                                                                        Created Date=FIELD(Date Filter)));
                                                   CaptionML=ENU=Documents to Export;
                                                   Editable=No }
    { 4   ;   ;Sales Price Discr.  ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("Sales Header" WHERE (EDI Order=FILTER(Yes),
                                                                                           Document Type=FILTER(Order),
                                                                                           Pricing Discrepancy=FILTER(Yes),
                                                                                           EDI Trade Partner=FIELD(Trade Partner Filter),
                                                                                           Posting Date=FIELD(Date Filter)));
                                                   CaptionML=ENU=Sales Price Discrepancy;
                                                   Editable=No }
    { 5   ;   ;Invoices Sent - Today;Integer      ;FieldClass=FlowField;
                                                   CalcFormula=Count("Sales Invoice Header" WHERE (EDI Order=CONST(Yes),
                                                                                                   EDI Invoice Generated=CONST(Yes),
                                                                                                   Posting Date=FIELD(Date Filter),
                                                                                                   EDI Trade Partner=FIELD(Trade Partner Filter),
                                                                                                   EDI Inv. Gen. Date=FIELD(Date Filter)));
                                                   CaptionML=ENU=Invoices Sent - Today;
                                                   Editable=No }
    { 6   ;   ;Invoices To Send    ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("Sales Invoice Header" WHERE (EDI Invoice=CONST(Yes),
                                                                                                   EDI Invoice Generated=CONST(No),
                                                                                                   EDI Trade Partner=FIELD(Trade Partner Filter)));
                                                   CaptionML=ENU=Send Sales Invoices;
                                                   Editable=No }
    { 7   ;   ;Adv. Ship Notices To Send;Integer  ;FieldClass=FlowField;
                                                   CalcFormula=Count("Bill of Lading" WHERE (EDI ASN=CONST(Yes),
                                                                                             EDI ASN Generated=CONST(No),
                                                                                             EDI ASN Gen. Date=FILTER(''),
                                                                                             EDI BSN=CONST(No)));
                                                   CaptionML=ENU=Send Advanced Ship Notices;
                                                   Editable=No }
    { 8   ;   ;Funct. Ack. Created Not Sent;Integer;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Count("E.D.I. Send Document Hdr." WHERE (Navision Document=CONST(E_FUNCTACK),
                                                                                                        Sent Date=FILTER(''),
                                                                                                        Trade Partner No.=FIELD(Trade Partner Filter),
                                                                                                        Created Date=FIELD(Date Filter)));
                                                   CaptionML=ENU=Funct. Ack. Created Not Sent;
                                                   Editable=No }
    { 9   ;   ;Funct. Ack. Status  ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("E.D.I. Send Document Hdr." WHERE (Document Sent=CONST(Yes),
                                                                                                        Funct. Ack. Required=CONST(Yes),
                                                                                                        Funct. Group Ack. Status=FILTER(<>Accepted),
                                                                                                        Tran. Set Funct. Ack. Status=FILTER(<>Accepted),
                                                                                                        Trade Partner No.=FIELD(Trade Partner Filter),
                                                                                                        Sent Date=FIELD(Date Filter)));
                                                   CaptionML=ENU=Functional Acknowledgment Status;
                                                   Editable=No }
    { 10  ;   ;Rec. Doc. With Errors;Integer      ;FieldClass=FlowField;
                                                   CalcFormula=Count("E.D.I. Receive Document Hdr." WHERE (Data Error=CONST(Yes),
                                                                                                           Trade Partner No.=FIELD(Trade Partner Filter),
                                                                                                           Date Received=FIELD(Date Filter)));
                                                   CaptionML=ENU=Receive Document with Errors;
                                                   Editable=No }
    { 11  ;   ;Open Sales Orders   ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("Sales Header" WHERE (EDI Order=FILTER(Yes),
                                                                                           Document Type=FILTER(Order),
                                                                                           Status=FILTER(Open),
                                                                                           EDI Trade Partner=FIELD(Trade Partner Filter),
                                                                                           Posting Date=FIELD(Date Filter)));
                                                   CaptionML=ENU=Open Sales Orders;
                                                   Editable=No }
    { 12  ;   ;Received Sales Orders;Integer      ;FieldClass=FlowField;
                                                   CalcFormula=Count("Sales Header" WHERE (EDI Order=FILTER(Yes),
                                                                                           EDI Trade Partner=FIELD(Trade Partner Filter),
                                                                                           Posting Date=FIELD(Date Filter)));
                                                   CaptionML=ENU=Received Sales Orders;
                                                   Editable=No }
    { 13  ;   ;Purchase Orders To Send;Integer    ;FieldClass=FlowField;
                                                   CalcFormula=Count("Purchase Header" WHERE (EDI Order=CONST(Yes),
                                                                                              EDI PO Generated=CONST(No)));
                                                   CaptionML=ENU=Purchase Orders To Send;
                                                   Editable=No }
    { 14  ;   ;Purchase Orders Sent;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("Purchase Header" WHERE (EDI Order=CONST(Yes),
                                                                                              EDI PO Generated=CONST(Yes)));
                                                   CaptionML=ENU=Purchase Orders Sent;
                                                   Editable=No }
    { 15  ;   ;Send Doc. With Errors;Integer      ;FieldClass=FlowField;
                                                   CalcFormula=Count("E.D.I. Send Document Hdr." WHERE (Document Sent=CONST(No),
                                                                                                        Data Error=CONST(Yes),
                                                                                                        Trade Partner No.=FIELD(Trade Partner Filter),
                                                                                                        Created Date=FIELD(Date Filter)));
                                                   CaptionML=ENU=Send Documents with Errors;
                                                   Editable=No }
    { 16  ;   ;Date Filter         ;Date          ;FieldClass=FlowFilter;
                                                   CaptionML=ENU=Date Filter;
                                                   Editable=Yes }
    { 17  ;   ;Date Filter2        ;Date          ;FieldClass=FlowFilter;
                                                   CaptionML=ENU=Date Filter2;
                                                   Editable=Yes }
    { 18  ;   ;Trade Partner Filter;Code20        ;FieldClass=FlowFilter;
                                                   CaptionML=ENU=Trade Partner Filter }
    { 19  ;   ;Ship-to No. Filter  ;Code20        ;CaptionML=ENU=Ship-to No. Filter }
    { 20  ;   ;Formatted Report Not Printed;Integer;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Count("E.D.I. Receive Document Hdr." WHERE (Navision Document=FILTER(I_SLSGEN),
                                                                                                           Document Printed=FILTER(No),
                                                                                                           Trade Partner No.=FIELD(Trade Partner Filter),
                                                                                                           Date Received=FIELD(Date Filter)));
                                                   CaptionML=ENU=Formatted Report Not Printed;
                                                   Editable=No }
    { 21  ;   ;ASN to Send         ;Integer       ;CaptionML=ENU=Send Advanced Ship Notices;
                                                   Editable=No }
    { 22  ;   ;Ship and Bill Notices To Send;Integer;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Count("Bill of Lading" WHERE (EDI ASN=CONST(Yes),
                                                                                             EDI BSN=CONST(Yes),
                                                                                             EDI BSN Generated=CONST(No)));
                                                   CaptionML=ENU=Send Ship and Bill Notices;
                                                   Editable=No }
    { 23  ;   ;Inventory Advices To Send;Integer  ;FieldClass=FlowField;
                                                   CalcFormula=Count("E.D.I. Inventory Advice Header" WHERE (EDI Inventory Advice Generated=CONST(No)));
                                                   CaptionML=ENU=Send Inventory Advices;
                                                   Editable=No }
    { 24  ;   ;Purch. Payment Advice To Send;Integer;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Count("E.D.I. Purchase Payment Advice" WHERE (Payment Advice Generated=CONST(No)));
                                                   CaptionML=ENU=Send Purchase Payment Advices;
                                                   Editable=No }
    { 25  ;   ;Sales Orders To Cancel;Integer     ;FieldClass=FlowField;
                                                   CalcFormula=Count("Sales Header" WHERE (EDI Order=CONST(Yes),
                                                                                           EDI Cancellation Request=CONST(Yes)));
                                                   CaptionML=ENU=Sales Orders To Cancel;
                                                   Editable=No }
    { 26  ;   ;PO Change To Process;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("E.D.I. Receive Document Hdr." WHERE (Enable PO Change=CONST(Yes),
                                                                                                           PO Change Updated=CONST(No),
                                                                                                           Evaluate PO Change=CONST(Yes)));
                                                   CaptionML=ENU=Process PO Change;
                                                   Editable=No }
    { 27  ;   ;3PL ASN To Process  ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("E.D.I. Receive Document Hdr." WHERE (Navision Document=CONST('I_SLSASN'),
                                                                                                           ASN Processed=CONST(No)));
                                                   CaptionML=ENU=3PL ASN To Process;
                                                   Editable=No }
    { 28  ;   ;3PL ASN with Errors ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("E.D.I. Receive Document Hdr." WHERE (Navision Document=CONST(I_SLSASN),
                                                                                                           ASN Error=CONST(Yes)));
                                                   CaptionML=ENU=3PL ASN with Errors;
                                                   Editable=No }
    { 29  ;   ;Purchase Orders To Update;Integer  ;FieldClass=FlowField;
                                                   CalcFormula=Count("E.D.I. Receive Document Hdr." WHERE (Navision Document=FILTER(I_PURINV|U_PURWSA),
                                                                                                           Purchase Order Updated=CONST(No)));
                                                   CaptionML=ENU=Purchase Orders To Update;
                                                   Editable=No }
    { 30  ;   ;Released Sales Orders;Integer      ;FieldClass=FlowField;
                                                   CalcFormula=Count("Sales Header" WHERE (EDI Order=FILTER(Yes),
                                                                                           Document Type=FILTER(Order),
                                                                                           Status=FILTER(Released),
                                                                                           EDI Trade Partner=FIELD(Trade Partner Filter),
                                                                                           Posting Date=FIELD(Date Filter)));
                                                   CaptionML=ENU=Released Sales Orders;
                                                   Editable=No }
    { 31  ;   ;Alerts              ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("E.D.I. Alert" WHERE (Review Alert=CONST(Yes),
                                                                                           Trade Partner No.=FIELD(Trade Partner Filter),
                                                                                           Alert Date=FIELD(Date Filter)));
                                                   CaptionML=ENU=Alerts;
                                                   Editable=No }
    { 32  ;   ;Cancelled Orders    ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("Sales Header" WHERE (Document Type=CONST(Order),
                                                                                           EDI Order=CONST(Yes),
                                                                                           EDI Cancellation Request=CONST(Yes)));
                                                   CaptionML=ENU=Cancelled Orders;
                                                   Editable=No }
    { 33  ;   ;Orders Received - Today;Integer    ;FieldClass=FlowField;
                                                   CalcFormula=Count("Sales Header" WHERE (Document Type=CONST(Order),
                                                                                           EDI Order=CONST(Yes),
                                                                                           Document Date=FIELD(Date Filter3)));
                                                   CaptionML=ENU=Today's Orders;
                                                   Editable=No }
    { 34  ;   ;Date Filter3        ;Date          ;FieldClass=FlowFilter;
                                                   CaptionML=ENU=Date Filter3;
                                                   Editable=No }
    { 35  ;   ;Adv. Acknowledgements To Send;Integer;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Count("Order Status Header" WHERE (Document Type=FILTER(Advance P.O. Ack.),
                                                                                                  Released=CONST(Yes),
                                                                                                  Exported=CONST(No)));
                                                   CaptionML=ENU=Send Advance PO Acknowledgements;
                                                   Editable=No }
    { 36  ;   ;Common Receive File Count;Integer  ;CaptionML=ENU=Common Receive File Count }
    { 37  ;   ;Open Sales Orders - Today;Integer  ;FieldClass=FlowField;
                                                   CalcFormula=Count("Sales Header" WHERE (EDI Order=FILTER(Yes),
                                                                                           Document Type=FILTER(Order),
                                                                                           Status=FILTER(Open),
                                                                                           EDI Trade Partner=FIELD(Trade Partner Filter),
                                                                                           Posting Date=FIELD(Date Filter3)));
                                                   CaptionML=ENU="Open Sales Orders ";
                                                   Editable=No }
    { 38  ;   ;Released Sales Orders - Today;Integer;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Count("Sales Header" WHERE (EDI Order=FILTER(Yes),
                                                                                           Document Type=FILTER(Order),
                                                                                           Status=FILTER(Released),
                                                                                           EDI Trade Partner=FIELD(Trade Partner Filter),
                                                                                           Posting Date=FIELD(Date Filter3)));
                                                   CaptionML=ENU="Released Sales Orders ";
                                                   Editable=No }
    { 39  ;   ;Rec. Doc. With Errors - Today;Integer;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Count("E.D.I. Receive Document Hdr." WHERE (Data Error=FILTER(Yes),
                                                                                                           Trade Partner No.=FIELD(Trade Partner Filter),
                                                                                                           Date Received=FIELD(Date Filter3)));
                                                   CaptionML=ENU=Receive Documents with Errors;
                                                   Editable=No }
    { 40  ;   ;Send Doc. With Errors - Today;Integer;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Count("E.D.I. Send Document Hdr." WHERE (Document Sent=CONST(No),
                                                                                                        Data Error=FILTER(Yes),
                                                                                                        Trade Partner No.=FIELD(Trade Partner Filter),
                                                                                                        Created Date=FIELD(Date Filter3)));
                                                   CaptionML=ENU=Send Documents with Errors;
                                                   Editable=No }
    { 41  ;   ;Sales Price Discr. - Today;Integer ;FieldClass=FlowField;
                                                   CalcFormula=Count("Sales Header" WHERE (EDI Order=FILTER(Yes),
                                                                                           Document Type=FILTER(Order),
                                                                                           Pricing Discrepancy=FILTER(Yes),
                                                                                           EDI Trade Partner=FIELD(Trade Partner Filter),
                                                                                           Posting Date=FIELD(Date Filter3)));
                                                   CaptionML=ENU=Sales Prices Discrepancies;
                                                   Editable=No }
    { 42  ;   ;Cancelled Orders - Today;Integer   ;FieldClass=FlowField;
                                                   CalcFormula=Count("Sales Header" WHERE (Document Type=CONST(Order),
                                                                                           EDI Order=CONST(Yes),
                                                                                           EDI Cancellation Request=CONST(Yes),
                                                                                           Posting Date=FIELD(Date Filter3)));
                                                   CaptionML=ENU=Cancelled Orders;
                                                   Editable=No }
    { 43  ;   ;Send Order Status   ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("Order Status Header" WHERE (Document Type=FILTER(' '),
                                                                                                  Released=CONST(Yes),
                                                                                                  Exported=CONST(No)));
                                                   CaptionML=ENU=Send Order Status;
                                                   Editable=No }
    { 44  ;   ;File Processing Errors;Integer     ;FieldClass=FlowField;
                                                   CalcFormula=Count("E.D.I. Log" WHERE (Error=CONST(Yes)));
                                                   CaptionML=ENU=File Processing Errors;
                                                   Editable=No }
    { 45  ;   ;Outbound Processing Errors;Integer ;FieldClass=FlowField;
                                                   CalcFormula=Count("E.D.I. Outbound Log" WHERE (Error=CONST(Yes)));
                                                   CaptionML=ENU=Outbound Processing Errors;
                                                   Editable=No }
    { 46  ;   ;Adv. Ackowledgements To Send;Integer;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Count("Order Status Header" WHERE (Document Type=FILTER(Advance P.O. Ack.),
                                                                                                  Released=CONST(Yes),
                                                                                                  Exported=CONST(No)));
                                                   CaptionML=ENU=Advance P.O. Ackowledgements To Send>;
                                                   Editable=No }
    { 47  ;   ;Unassigned General Cross XRef;Integer;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Count("E.D.I. General Cross Reference" WHERE (Unassigned=CONST(Yes),
                                                                                                             Trade Partner=FIELD(Trade Partner Filter)));
                                                   CaptionML=ENU=Unassigned General Cross XRef;
                                                   Editable=No }
    { 48  ;   ;Unassigned Item Cross XRef;Integer ;FieldClass=FlowField;
                                                   CalcFormula=Count("E.D.I. Trade Partner Item" WHERE (Unassigned=CONST(Yes),
                                                                                                        Trade Partner No.=FIELD(Trade Partner Filter)));
                                                   CaptionML=ENU=Unassigned Item Cross XRef;
                                                   Editable=No }
    { 49  ;   ;Unassigned UOM Cross Reference;Integer;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Count("E.D.I. Trade Partner UOM" WHERE (Unassigned=CONST(Yes),
                                                                                                       Trade Partner No.=FIELD(Trade Partner Filter)));
                                                   CaptionML=ENU=Unassigned UOM Cross Reference;
                                                   Editable=No }
    { 50  ;   ;Unassigned Customer XRef;Integer   ;FieldClass=FlowField;
                                                   CalcFormula=Count("E.D.I. Cust. Cross Reference" WHERE (Unassigned=CONST(Yes),
                                                                                                           Trade Partner No.=FIELD(Trade Partner Filter)));
                                                   CaptionML=ENU=Unassigned Customer XRef;
                                                   Editable=No }
    { 60  ;   ;Receive Documents - Today;Integer  ;FieldClass=FlowField;
                                                   CalcFormula=Count("E.D.I. Receive Document Hdr." WHERE (Date Received=FIELD(Date Filter3)));
                                                   CaptionML=ENU=Receive Documents - Today;
                                                   Editable=No }
    { 61  ;   ;Send Documents - Today;Integer     ;FieldClass=FlowField;
                                                   CalcFormula=Count("E.D.I. Send Document Hdr." WHERE (Created Date=FIELD(Date Filter3)));
                                                   CaptionML=ENU=Send Documents - Today;
                                                   Editable=No }
    { 62  ;   ;Quote Request       ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("Sales Header" WHERE (EDI Order=CONST(Yes),
                                                                                           EDI Response to Request Req.=CONST(Yes),
                                                                                           EDI Response Generated=CONST(No)));
                                                   CaptionML=ENU=Quote Request;
                                                   Editable=No }
    { 63  ;   ;Shipment Advices To Send;Integer   ;FieldClass=FlowField;
                                                   CalcFormula=Count("Sales Shipment Header" WHERE (EDI Order=CONST(Yes),
                                                                                                    Shipment Release=CONST(Yes),
                                                                                                    EDI Shipment Advice Generated=CONST(No)));
                                                   CaptionML=ENU=Send Shipment Advices;
                                                   Editable=No }
    { 50003;  ;Receive XML Doc with error;Integer ;FieldClass=FlowField;
                                                   CalcFormula=Count("TTS Order Header" WHERE (Order Status=CONST(Error)));
                                                   Editable=No }
    { 50004;  ;Receive XML Doc - Today;Integer    ;FieldClass=FlowField;
                                                   CalcFormula=Count("TTS Order Header" WHERE (Date Received=FIELD(Date Filter3)));
                                                   Editable=No }
  }
  KEYS
  {
    {    ;Primary Key                             ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      EDITradePartner@1240030000 : Record 14002360;
      BillofLading@1240030002 : Record 14000822;
      CustomerNo@1240030004 : Code[20];
      BillofLadingLine@1240030003 : Record 14000823;
      SalesHeader@1240030005 : Record 36;
      SalesShipmentHdr@1240030006 : Record 110;
      BillofLadingTmp@1240030008 : TEMPORARY Record 14000822;
      PostedPackage@1240030007 : Record 14000704;
      EDIRecDocHdr@1240020002 : Record 14002358;
      EDISetup@1240020000 : Record 14002367;
      SalesHeaderTmp@1240020001 : TEMPORARY Record 36;
      xFile@1240020003 : Record 2000000022;
      Original@1240030009 : Boolean;
      ASNCount@1240030010 : Integer;

    PROCEDURE ASNToSend@1240030000(TradePartnerNo@1240030000 : Code[20]) ASNCount : Integer;
    BEGIN
      ASNCount := 0;

      Original := FALSE;
      BillofLadingTmp.RESET;
      BillofLadingTmp.DELETEALL;
      IF TradePartnerNo = '' THEN BEGIN
        BillofLading.RESET;
        BillofLading.SETCURRENTKEY("EDI ASN");
        BillofLading.SETRANGE("EDI ASN",TRUE);
        BillofLading.SETRANGE("EDI BSN",FALSE);
        BillofLading.SETRANGE("EDI ASN Generated",FALSE);
        IF BillofLading.FIND('-') THEN BEGIN
          ASNCount := BillofLading.COUNT;
          Original := TRUE;
        END;
      END ELSE BEGIN
        EDITradePartner.RESET;
        EDITradePartner.SETRANGE("No.",TradePartnerNo);
        IF EDITradePartner.FIND('-') THEN
          IF EDITradePartner."Customer No." <> '' THEN BEGIN
            CustomerNo := EDITradePartner."Customer No.";
            BillofLading.RESET;
            BillofLading.SETCURRENTKEY("EDI ASN");
            BillofLading.SETRANGE("EDI ASN",TRUE);
            BillofLading.SETRANGE("EDI BSN",FALSE);
            BillofLading.SETRANGE("EDI ASN Generated",FALSE);
            BillofLading.SETRANGE("Ship-to No.",CustomerNo);
            IF BillofLading.FIND('-') THEN BEGIN
              ASNCount := BillofLading.COUNT;
              Original := TRUE;
            END;
          END ELSE BEGIN
            BillofLading.RESET;
            BillofLading.SETCURRENTKEY("EDI ASN");
            BillofLading.SETRANGE("EDI ASN",TRUE);
            BillofLading.SETRANGE("EDI BSN",FALSE);
            BillofLading.SETRANGE("EDI ASN Generated",FALSE);
            IF BillofLading.FIND('-') THEN
              REPEAT
                BillofLadingLine.RESET;
                BillofLadingLine.SETRANGE("Bill of Lading No.",BillofLading."No.");
                IF BillofLadingLine.FIND('-') THEN
                  CASE BillofLadingLine.Type OF
                    BillofLadingLine.Type::Order:
                      IF SalesHeader.GET(BillofLadingLine.Type::Order,BillofLadingLine."No.") THEN
                        IF SalesHeader."EDI Trade Partner" = TradePartnerNo THEN BEGIN
                          BillofLadingTmp.COPY(BillofLading);
                          BillofLadingTmp.INSERT;
                        END;
                    BillofLadingLine.Type::"Sales Shipment (Posted)":
                      IF SalesShipmentHdr.GET(BillofLadingLine."No.") THEN
                        IF SalesShipmentHdr."EDI Trade Partner" = TradePartnerNo THEN BEGIN
                          BillofLadingTmp.COPY(BillofLading);
                          BillofLadingTmp.INSERT;
                        END;
                    BillofLadingLine.Type::Package:
                      IF PostedPackage.GET(BillofLadingLine."No.") THEN
                        IF PostedPackage."EDI Trade Partner" = TradePartnerNo THEN BEGIN
                          BillofLadingTmp.COPY(BillofLading);
                          BillofLadingTmp.INSERT;
                        END;
                  END;
              UNTIL BillofLading.NEXT = 0;
            ASNCount := BillofLadingTmp.COUNT;
          END;
      END;

      EXIT(ASNCount);
    END;

    PROCEDURE GetBillofLading@1240030001();
    BEGIN
      IF Original THEN
        PAGE.RUN(PAGE::"Bill of Ladings",BillofLading)
      ELSE
        PAGE.RUN(PAGE::"Bill of Ladings",BillofLadingTmp);
    END;

    PROCEDURE BSNToSend@1240030002(TradePartnerNo@1240030000 : Code[20]) BSNCount : Integer;
    BEGIN
      BSNCount := 0;

      Original := FALSE;
      BillofLadingTmp.RESET;
      BillofLadingTmp.DELETEALL;
      IF TradePartnerNo = '' THEN BEGIN
        BillofLading.RESET;
        BillofLading.SETCURRENTKEY("EDI ASN");
        BillofLading.SETRANGE("EDI ASN",TRUE);
        BillofLading.SETRANGE("EDI BSN",TRUE);
        BillofLading.SETRANGE("EDI BSN Generated",FALSE);
        IF BillofLading.FIND('-') THEN BEGIN
          BSNCount := BillofLading.COUNT;
          Original := TRUE;
        END;
      END ELSE BEGIN
        EDITradePartner.RESET;
        EDITradePartner.SETRANGE("No.",TradePartnerNo);
        IF EDITradePartner.FIND('-') THEN
          IF EDITradePartner."Customer No." <> '' THEN BEGIN
            CustomerNo := EDITradePartner."Customer No.";
            BillofLading.RESET;
            BillofLading.SETCURRENTKEY("EDI ASN");
            BillofLading.SETRANGE("EDI ASN",TRUE);
            BillofLading.SETRANGE("EDI BSN",TRUE);
            BillofLading.SETRANGE("EDI BSN Generated",FALSE);
            BillofLading.SETRANGE("Ship-to No.",CustomerNo);
            IF BillofLading.FIND('-') THEN BEGIN
              BSNCount := BillofLading.COUNT;
              Original := TRUE;
            END;
          END ELSE BEGIN
            BillofLading.RESET;
            BillofLading.SETCURRENTKEY("EDI ASN");
            BillofLading.SETRANGE("EDI ASN",TRUE);
            BillofLading.SETRANGE("EDI BSN",TRUE);
            BillofLading.SETRANGE("EDI BSN Generated",FALSE);
            IF BillofLading.FIND('-') THEN
              REPEAT
                BillofLadingLine.RESET;
                BillofLadingLine.SETRANGE("Bill of Lading No.",BillofLading."No.");
                IF BillofLadingLine.FIND('-') THEN
                  CASE BillofLadingLine.Type OF
                    BillofLadingLine.Type::Order:
                      IF SalesHeader.GET(BillofLadingLine.Type::Order,BillofLadingLine."No.") THEN
                        IF SalesHeader."EDI Trade Partner" = TradePartnerNo THEN BEGIN
                          BillofLadingTmp.COPY(BillofLading);
                          BillofLadingTmp.INSERT;
                        END;
                    BillofLadingLine.Type::"Sales Shipment (Posted)":
                      IF SalesShipmentHdr.GET(BillofLadingLine."No.") THEN
                        IF SalesShipmentHdr."EDI Trade Partner" = TradePartnerNo THEN BEGIN
                          BillofLadingTmp.COPY(BillofLading);
                          BillofLadingTmp.INSERT;
                        END;
                    BillofLadingLine.Type::Package:
                      IF PostedPackage.GET(BillofLadingLine."No.") THEN
                        IF PostedPackage."EDI Trade Partner" = TradePartnerNo THEN BEGIN
                          BillofLadingTmp.COPY(BillofLading);
                          BillofLadingTmp.INSERT;
                        END;
                  END;
              UNTIL BillofLading.NEXT = 0;
            BSNCount := BillofLadingTmp.COUNT;
          END;
      END;

      EXIT(BSNCount);
    END;

    PROCEDURE SameDayShipOrders@1240020005() : Integer;
    VAR
      SalesHeader@1240020002 : Record 36;
      EDIRecDocHdr@1240020000 : Record 14002358;
    BEGIN
      SalesHeaderTmp.RESET;
      SalesHeaderTmp.DELETEALL;

      EDIRecDocHdr.RESET;
      EDIRecDocHdr.SETRANGE("Date Received",TODAY);
      EDIRecDocHdr.SETRANGE("Use Same Day Ship Time",TRUE);
      IF EDIRecDocHdr.FIND('-') THEN
        REPEAT
          IF EDIRecDocHdr."Transaction Time" <= EDIRecDocHdr."Same Day Ship Time" THEN BEGIN
            SalesHeader.RESET;
            SalesHeader.SETCURRENTKEY("EDI Order","EDI Trade Partner","EDI Internal Doc. No.");
            SalesHeader.SETRANGE("Document Type",SalesHeader."Document Type"::Order);
            SalesHeader.SETRANGE("EDI Order",TRUE);
            SalesHeader.SETRANGE("EDI Trade Partner",EDIRecDocHdr."Trade Partner No.");
            SalesHeader.SETRANGE("EDI Internal Doc. No.",EDIRecDocHdr."Internal Doc. No.");
            IF SalesHeader.FIND('-') THEN
              REPEAT
                IF NOT SalesHeaderTmp.GET(SalesHeader."Document Type",SalesHeader."No.") THEN BEGIN
                  SalesHeaderTmp := SalesHeader;
                  SalesHeaderTmp.INSERT;
                END;
              UNTIL SalesHeader.NEXT = 0;
          END;
        UNTIL EDIRecDocHdr.NEXT = 0;
      EXIT(SalesHeaderTmp.COUNT);
    END;

    PROCEDURE GetSalesOrder@1240020006();
    BEGIN
      PAGE.RUN(PAGE::"Sales Order List",SalesHeaderTmp)
    END;

    PROCEDURE DocumentsReceivedToday@1240020000(TradePartnerNo@1240020002 : Code[20]) DocReceivedCount : Integer;
    BEGIN
      DocReceivedCount := 0;

      EDIRecDocHdr.RESET;
      IF TradePartnerNo <> '' THEN
        EDIRecDocHdr.SETRANGE("Trade Partner No.",TradePartnerNo);
      EDIRecDocHdr.SETRANGE("Date Received",TODAY);
      DocReceivedCount := EDIRecDocHdr.COUNT;

      EXIT(DocReceivedCount);
    END;

    PROCEDURE SalesOrdersReceivedToday@1240020001();
    BEGIN
    END;

    PROCEDURE GetReceiveDocuments@1240020002();
    BEGIN
      PAGE.RUN(PAGE::"E.D.I. Receive Document List",EDIRecDocHdr);
    END;

    PROCEDURE CommonReceiveFiles@1240020003() CommonRecFileCount : Integer;
    BEGIN
      EDISetup.GET;

      CommonRecFileCount := 0;
      xFile.RESET;
      xFile.SETRANGE("Is a file",TRUE);
      xFile.SETRANGE(Path,EDISetup."Common Receive Path");
      CommonRecFileCount := xFile.COUNT;

      EXIT(CommonRecFileCount);
    END;

    PROCEDURE GetEDIFiles@1240020004();
    BEGIN
      PAGE.RUN(PAGE::"E.D.I. Files");
    END;

    BEGIN
    {
      001 TPZ2986 GKG 04162021 add field 'Receive XML Doc with error' and 'Receive XML Doc - Today' for tradetech integration
    }
    END.
  }
}

