OBJECT Table 14050301 E.D.I. Cue
{
  OBJECT-PROPERTIES
  {
    Date=07/27/09;
    Time=12:00:00 PM;
    Version List=SE0.54;
  }
  PROPERTIES
  {
    CaptionML=ENU=E.D.I. Cue;
  }
  FIELDS
  {
    { 1   ;   ;Primary Key         ;Code10        ;CaptionML=ENU=Primary Key;
                                                   Editable=No }
    { 2   ;   ;Sales Documents Not Created;Integer;FieldClass=FlowField;
                                                   CalcFormula=Count("E.D.I. Receive Document Hdr." WHERE (Sales Doc. Created=CONST(No),
                                                                                                           Navision Document=CONST(I_SLSORD),
                                                                                                           Trade Partner No.=FIELD(Trade Partner Filter),
                                                                                                           Date Received=FIELD(Date Filter)));
                                                   CaptionML=ENU=Sales Documents Not Created;
                                                   Editable=No }
    { 3   ;   ;Send Doc. Created Not Sent;Integer ;FieldClass=FlowField;
                                                   CalcFormula=Count("E.D.I. Send Document Hdr." WHERE (Sent Date=FILTER(=''),
                                                                                                        Trade Partner No.=FIELD(Trade Partner Filter),
                                                                                                        Created Date=FIELD(Date Filter)));
                                                   CaptionML=ENU=Send Doc. Created Not Sent;
                                                   Editable=No }
    { 4   ;   ;Sales Price Discr.  ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("Sales Header" WHERE (EDI Order=FILTER(Yes),
                                                                                           Document Type=FILTER(Order),
                                                                                           Pricing Discrepancy=FILTER(Yes),
                                                                                           EDI Trade Partner=FIELD(Trade Partner Filter),
                                                                                           Posting Date=FIELD(Date Filter)));
                                                   CaptionML=ENU=Sales Price Discr.;
                                                   Editable=No }
    { 5   ;   ;Invoices Sent - Today;Integer      ;FieldClass=FlowField;
                                                   CalcFormula=Count("Sales Invoice Header" WHERE (EDI Order=CONST(Yes),
                                                                                                   EDI Invoice Generated=CONST(Yes),
                                                                                                   Posting Date=FIELD(Date Filter),
                                                                                                   EDI Trade Partner=FIELD(Trade Partner Filter),
                                                                                                   EDI Inv. Gen. Date=FIELD(Date Filter)));
                                                   CaptionML=ENU=Invoices Sent - Today;
                                                   Editable=No }
    { 6   ;   ;Invoices To Send    ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("Sales Invoice Header" WHERE (EDI Order=CONST(Yes),
                                                                                                   EDI Invoice Generated=CONST(No),
                                                                                                   EDI Trade Partner=FIELD(Trade Partner Filter)));
                                                   CaptionML=ENU=Invoices To Send;
                                                   Editable=No }
    { 7   ;   ;Adv. Ship Notices To Send;Integer  ;FieldClass=FlowField;
                                                   CalcFormula=Count("Bill of Lading" WHERE (EDI ASN=CONST(Yes),
                                                                                             EDI ASN Generated=CONST(No)));
                                                   CaptionML=ENU=Adv. Ship Notices To Send;
                                                   Editable=No }
    { 8   ;   ;Funct. Ack. Created Not Sent;Integer;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Count("E.D.I. Send Document Hdr." WHERE (Navision Document=CONST(E_FUNCTACK),
                                                                                                        Sent Date=FILTER(''),
                                                                                                        Trade Partner No.=FIELD(Trade Partner Filter),
                                                                                                        Created Date=FIELD(Date Filter)));
                                                   CaptionML=ENU=Funct. Ack. Created Not Sent;
                                                   Editable=No }
    { 9   ;   ;Funct. Ack. Status  ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("E.D.I. Send Document Hdr." WHERE (Document Sent=CONST(Yes),
                                                                                                        Funct. Ack. Required=CONST(Yes),
                                                                                                        Funct. Group Ack. Status=FILTER(<>Accepted),
                                                                                                        Tran. Set Funct. Ack. Status=FILTER(<>Accepted),
                                                                                                        Trade Partner No.=FIELD(Trade Partner Filter),
                                                                                                        Sent Date=FIELD(Date Filter)));
                                                   CaptionML=ENU=Funct. Ack. Status;
                                                   Editable=No }
    { 10  ;   ;Rec. Doc. With Errors;Integer      ;FieldClass=FlowField;
                                                   CalcFormula=Count("E.D.I. Receive Document Hdr." WHERE (Data Error=CONST(Yes),
                                                                                                           Trade Partner No.=FIELD(Trade Partner Filter),
                                                                                                           Date Received=FIELD(Date Filter)));
                                                   CaptionML=ENU=Rec. Doc. With Errors;
                                                   Editable=No }
    { 11  ;   ;Open Sales Orders   ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("Sales Header" WHERE (EDI Order=FILTER(Yes),
                                                                                           Document Type=FILTER(Order),
                                                                                           Status=FILTER(Open),
                                                                                           EDI Trade Partner=FIELD(Trade Partner Filter),
                                                                                           Posting Date=FIELD(Date Filter)));
                                                   CaptionML=ENU=Open Sales Orders;
                                                   Editable=No }
    { 12  ;   ;Received Sales Orders;Integer      ;FieldClass=FlowField;
                                                   CalcFormula=Count("Sales Header" WHERE (EDI Order=FILTER(Yes),
                                                                                           EDI Trade Partner=FIELD(Trade Partner Filter),
                                                                                           Posting Date=FIELD(Date Filter)));
                                                   CaptionML=ENU=Received Sales Orders;
                                                   Editable=No }
    { 13  ;   ;Purchase Orders To Send;Integer    ;FieldClass=FlowField;
                                                   CalcFormula=Count("Purchase Header" WHERE (EDI Order=CONST(Yes),
                                                                                              EDI PO Generated=CONST(No)));
                                                   CaptionML=ENU=Purchase Orders To Send;
                                                   Editable=No }
    { 14  ;   ;Purchase Orders Sent;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("Purchase Header" WHERE (EDI Order=CONST(Yes),
                                                                                              EDI PO Generated=CONST(Yes)));
                                                   CaptionML=ENU=Purchase Orders Sent;
                                                   Editable=No }
    { 15  ;   ;Send Doc. With Errors;Integer      ;FieldClass=FlowField;
                                                   CalcFormula=Count("E.D.I. Send Document Hdr." WHERE (Document Sent=CONST(No),
                                                                                                        Data Error=CONST(Yes),
                                                                                                        Trade Partner No.=FIELD(Trade Partner Filter),
                                                                                                        Created Date=FIELD(Date Filter)));
                                                   CaptionML=ENU=Send Doc. With Errors;
                                                   Editable=No }
    { 16  ;   ;Date Filter         ;Date          ;FieldClass=FlowFilter;
                                                   CaptionML=ENU=Date Filter;
                                                   Editable=Yes }
    { 17  ;   ;Date Filter2        ;Date          ;FieldClass=FlowFilter;
                                                   CaptionML=ENU=Date Filter2;
                                                   Editable=Yes }
    { 18  ;   ;Trade Partner Filter;Code20        ;FieldClass=FlowFilter;
                                                   CaptionML=ENU=Trade Partner Filter }
    { 19  ;   ;Ship-to No. Filter  ;Code20        ;CaptionML=ENU=Ship-to No. Filter }
    { 20  ;   ;Formatted Report Not Printed;Integer;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Count("E.D.I. Receive Document Hdr." WHERE (Navision Document=FILTER(I_SLSGEN),
                                                                                                           Document Printed=FILTER(No),
                                                                                                           Trade Partner No.=FIELD(Trade Partner Filter),
                                                                                                           Date Received=FIELD(Date Filter)));
                                                   CaptionML=ENU=Formatted Report Not Printed;
                                                   Editable=No }
    { 21  ;   ;ASN to Send         ;Integer       ;CaptionML=ENU=ASN to Send;
                                                   Editable=No }
  }
  KEYS
  {
    {    ;Primary Key                             ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      Text000@1000 : TextConst 'ENU=''''';
      EDITradePartner@1240030000 : Record 14002360;
      ASNTradePartnerNo@1240030001 : Code[20];
      BillofLading@1240030002 : Record 14000822;
      CustomerNo@1240030004 : Code[20];
      BillofLadingLine@1240030003 : Record 14000823;
      SalesHeader@1240030005 : Record 36;
      SalesShipmentHdr@1240030006 : Record 110;
      BillofLadingTmp@1240030008 : TEMPORARY Record 14000822;
      PostedPackage@1240030007 : Record 14000704;
      Original@1240030009 : Boolean;
      ASNCount@1240030010 : Integer;

    PROCEDURE ASNToSend@1240030000(TradePartnerNo@1240030000 : Code[20]) ASNCount : Integer;
    BEGIN
      ASNCount := 0;

      Original := FALSE;
      BillofLadingTmp.RESET;
      BillofLadingTmp.DELETEALL;
      IF TradePartnerNo = '' THEN BEGIN
        BillofLading.RESET;
        BillofLading.SETCURRENTKEY("EDI ASN");
        BillofLading.SETRANGE("EDI ASN",TRUE);
        BillofLading.SETRANGE("EDI ASN Generated",FALSE);
        IF BillofLading.FIND('-') THEN BEGIN
          ASNCount := BillofLading.COUNT;
          Original := TRUE;
        END;
      END ELSE BEGIN
        EDITradePartner.RESET;
        EDITradePartner.SETRANGE("No.",TradePartnerNo);
        IF EDITradePartner.FIND('-') THEN
          IF EDITradePartner."Customer No." <> '' THEN BEGIN
            CustomerNo := EDITradePartner."Customer No.";
            BillofLading.RESET;
            BillofLading.SETCURRENTKEY("EDI ASN");
            BillofLading.SETRANGE("EDI ASN",TRUE);
            BillofLading.SETRANGE("EDI ASN Generated",FALSE);
            BillofLading.SETRANGE("Ship-to No.",CustomerNo);
            IF BillofLading.FIND('-') THEN BEGIN
              ASNCount := BillofLading.COUNT;
              Original := TRUE;
            END;
          END ELSE BEGIN
            BillofLading.RESET;
            BillofLading.SETCURRENTKEY("EDI ASN");
            BillofLading.SETRANGE("EDI ASN",TRUE);
            BillofLading.SETRANGE("EDI ASN Generated",FALSE);
            IF BillofLading.FIND('-') THEN
              REPEAT
                BillofLadingLine.RESET;
                BillofLadingLine.SETRANGE("Bill of Lading No.",BillofLading."No.");
                IF BillofLadingLine.FIND('-') THEN
                  CASE BillofLadingLine.Type OF
                    BillofLadingLine.Type::Order:
                      IF SalesHeader.GET(BillofLadingLine.Type::Order,BillofLadingLine."No.") THEN
                        IF SalesHeader."EDI Trade Partner" = TradePartnerNo THEN BEGIN
                          BillofLadingTmp.COPY(BillofLading);
                          BillofLadingTmp.INSERT;
                        END;
                    BillofLadingLine.Type::"Sales Shipment (Posted)":
                      IF SalesShipmentHdr.GET(BillofLadingLine."No.") THEN
                        IF SalesShipmentHdr."EDI Trade Partner" = TradePartnerNo THEN BEGIN
                          BillofLadingTmp.COPY(BillofLading);
                          BillofLadingTmp.INSERT;
                        END;
                    BillofLadingLine.Type::Package:
                      IF PostedPackage.GET(BillofLadingLine."No.") THEN
                        IF PostedPackage."EDI Trade Partner" = TradePartnerNo THEN BEGIN
                          BillofLadingTmp.COPY(BillofLading);
                          BillofLadingTmp.INSERT;
                        END;
                  END;
              UNTIL BillofLading.NEXT = 0;
            ASNCount := BillofLadingTmp.COUNT;
          END;
      END;

      EXIT(ASNCount);
    END;

    PROCEDURE GetBillofLading@1240030001();
    BEGIN
      IF Original THEN
        PAGE.RUN(PAGE::"Open Bill of Ladings",BillofLading)
      ELSE
        PAGE.RUN(PAGE::"Open Bill of Ladings",BillofLadingTmp);
    END;

    BEGIN
    END.
  }
}

