OBJECT Table 14097493 DP BOM Demo Line
{
  OBJECT-PROPERTIES
  {
    Date=03/01/20;
    Time=12:00:00 PM;
    Version List=UBP3.02;
  }
  PROPERTIES
  {
    DataCaptionFields=Parent Item No.,No.;
    OnInsert=BEGIN
               //Item.GET("Parent Item No.");
               //ValidateAgainstRecursion("No.")
             END;

    OnModify=BEGIN
               //Item.GET("Parent Item No.");
               //ValidateAgainstRecursion("No.")
             END;

    OnRename=BEGIN
               //Item.GET("Parent Item No.");
               //ValidateAgainstRecursion("No.")
             END;

    CaptionML=ENU=BOM Component;
    LookupPageID=Page14097593;
    DrillDownPageID=Page14097593;
  }
  FIELDS
  {
    { 1   ;   ;Parent Item No.     ;Code50        ;TableRelation=Item.No.;
                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=ENU=Parent Item No. }
    { 2   ;   ;Line No.            ;Integer       ;CaptionML=ENU=Line No. }
    { 4   ;   ;No.                 ;Code50        ;TableRelation=Item.No.;
                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=ENU=No. }
    { 8   ;   ;Quantity per        ;Decimal       ;CaptionML=ENU=Quantity per;
                                                   DecimalPlaces=0:5;
                                                   MinValue=0 }
  }
  KEYS
  {
    {    ;Parent Item No.,Line No.                ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      Text001@1000 : TextConst 'ENU=You cannot insert item %1 as a component of itself.';
      Item@1001 : Record 27;

    PROCEDURE ValidateAgainstRecursion@3(ItemNo@1003 : Code[20]);
    VAR
      BOMComp@1001 : Record 14097493;
    BEGIN
      IF "Parent Item No." = ItemNo THEN
        ERROR(Text001,ItemNo);
      BOMComp.SETRANGE("No.","Parent Item No.");
      IF BOMComp.FINDSET THEN
        REPEAT
          BOMComp.ValidateAgainstRecursion(ItemNo);
        UNTIL BOMComp.NEXT = 0
    END;

    BEGIN
    END.
  }
}

