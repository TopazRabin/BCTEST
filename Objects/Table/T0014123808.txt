OBJECT Table 14123808 ES Data Security Object
{
  OBJECT-PROPERTIES
  {
    Date=11/01/16;
    Time=12:00:00 PM;
    Version List=ES1.41.22;
  }
  PROPERTIES
  {
    OnInsert=BEGIN
               CALCFIELDS("From Setup Company");
               TESTFIELD("From Setup Company",FALSE);

               ESFLADSSetup.GET('');

               IF ESFLADSSetup."Use Login Setup" THEN BEGIN
                 ESLoginSetup.GET(USERID);
                 ESLoginSetup.TESTFIELD("Edit Data Security Codes");
               END;

               ESSourceTableSetup.GET("Source Table ID");

               ESDataSecurityCode.GET("Source Table ID","Data Security Code");

               ESSourceTableSetup.GET("Source Table ID");

               ESFLADSUpdateNo.UpdateNo;
             END;

    OnModify=BEGIN
               CALCFIELDS("From Setup Company");
               TESTFIELD("From Setup Company",FALSE);

               ESFLADSSetup.GET('');

               IF ESFLADSSetup."Use Login Setup" THEN BEGIN
                 ESLoginSetup.GET(USERID);
                 ESLoginSetup.TESTFIELD("Edit Data Security Codes");
               END;

               ESDataSecurityCode.GET("Source Table ID","Data Security Code");

               ESSourceTableSetup.GET("Source Table ID");

               ESFLADSUpdateNo.UpdateNo;
             END;

    OnDelete=BEGIN
               CALCFIELDS("From Setup Company");
               TESTFIELD("From Setup Company",FALSE);

               ESFLADSSetup.GET('');

               IF ESFLADSSetup."Use Login Setup" THEN BEGIN
                 ESLoginSetup.GET(USERID);
                 ESLoginSetup.TESTFIELD("Edit Data Security Codes");
               END;

               ESDataSecurityCode.GET("Source Table ID","Data Security Code");

               ESSourceTableSetup.GET("Source Table ID");

               DeleteRelated;

               ESFLADSUpdateNo.UpdateNo;
             END;

    OnRename=BEGIN
               xRec.CALCFIELDS("From Setup Company");
               xRec.TESTFIELD("From Setup Company",FALSE);
               TESTFIELD("Object ID");
               xRec.TESTFIELD("Object ID");

               CALCFIELDS("From Setup Company");
               TESTFIELD("From Setup Company",FALSE);

               ESDataSecurityCode.GET("Source Table ID","Data Security Code");

               ESSourceTableSetup.GET("Source Table ID");

               ESFLADSUpdateNo.UpdateNo;
             END;

    CaptionML=ENU=Data Security Object;
    LookupPageID=Page14123808;
    DrillDownPageID=Page14123808;
  }
  FIELDS
  {
    { 1   ;   ;Source Table ID     ;Integer       ;TableRelation="ES Source Table Setup";
                                                   OnValidate=BEGIN
                                                                CALCFIELDS("Source Table Caption");
                                                              END;

                                                   CaptionML=ENU=Source Table ID;
                                                   NotBlank=Yes }
    { 2   ;   ;Data Security Code  ;Code20        ;TableRelation="ES Data Security Code".Code WHERE (Source Table ID=FIELD(Source Table ID));
                                                   CaptionML=ENU=Data Security Code;
                                                   NotBlank=Yes }
    { 3   ;   ;Object Type         ;Option        ;InitValue=Page;
                                                   OnValidate=BEGIN
                                                                IF "Object Type" = "Object Type"::"2" THEN BEGIN
                                                                  ESFLADSSetup.GET;
                                                                  ESFLADSSetup.TESTFIELD("Use Page Setup for Forms",FALSE);
                                                                END;

                                                                IF "Object Type" = "Object Type"::Page THEN BEGIN
                                                                  ESFLADSSetup.GET;
                                                                  ESFLADSSetup.TESTFIELD("Use Form Setup for Pages",FALSE);
                                                                END;
                                                              END;

                                                   CaptionML=ENU=Object Type;
                                                   OptionCaptionML=ENU=" ,,,,,,,,Page";
                                                   OptionString=[ ,,,,,,,,Page];
                                                   NotBlank=Yes }
    { 4   ;   ;Object ID           ;Integer       ;TableRelation="ES FLADS Relation"."Object ID" WHERE (Object Type=FIELD(Object Type),
                                                                                                        Type=FILTER(Source Table|Data Item),
                                                                                                        Relation Object Type=CONST(Table),
                                                                                                        Relation Object ID=FIELD(Source Table ID));
                                                   OnValidate=BEGIN
                                                                IF "Object ID" <> 0 THEN BEGIN
                                                                  ESFLADSSetup.GET;

                                                                  ESFLADSRelation.RESET;
                                                                  IF ESFLADSSetup."Use Form Setup for Pages" OR ESFLADSSetup."Use Page Setup for Forms" THEN
                                                                    ESFLADSRelation.SETFILTER("Object Type",'%1|%2',"Object Type"::"2","Object Type"::Page)
                                                                  ELSE
                                                                    ESFLADSRelation.SETRANGE("Object Type","Object Type");
                                                                  ESFLADSRelation.SETRANGE("Object ID","Object ID");
                                                                  ESFLADSRelation.SETRANGE(Type,ESFLADSRelation.Type::"Source Table");
                                                                  ESFLADSRelation.SETRANGE("Relation Object Type",ESFLADSRelation."Relation Object Type"::Table);
                                                                  ESFLADSRelation.SETRANGE("Relation Object ID","Source Table ID");
                                                                  ESFLADSRelation.FIND('-');
                                                                END;

                                                                CALCFIELDS("Object Caption");
                                                              END;

                                                   TestTableRelation=No;
                                                   CaptionML=ENU=Object ID }
    { 11  ;   ;Comment             ;Text250       ;CaptionML=ENU=Comment }
    { 12  ;   ;Source Table Caption;Text250       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(AllObjWithCaption."Object Caption" WHERE (Object Type=CONST(Table),
                                                                                                                Object ID=FIELD(Source Table ID)));
                                                   CaptionML=ENU=Source Table Caption;
                                                   Editable=No }
    { 13  ;   ;Object Caption      ;Text250       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(AllObjWithCaption."Object Caption" WHERE (Object Type=FIELD(Object Type),
                                                                                                                Object ID=FIELD(Object ID)));
                                                   CaptionML=ENU=Object Caption;
                                                   Editable=No }
    { 14  ;   ;Data Security Description;Text250  ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("ES Data Security Code".Description WHERE (Source Table ID=FIELD(Source Table ID),
                                                                                                                 Code=FIELD(Data Security Code)));
                                                   CaptionML=ENU=Data Security Description;
                                                   Editable=No }
    { 21  ;   ;Fields              ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("ES Data Security Field" WHERE (Source Table ID=FIELD(Source Table ID),
                                                                                                     Data Security Code=FIELD(Data Security Code),
                                                                                                     Object Type=FIELD(Object Type),
                                                                                                     Object ID=FIELD(Object ID)));
                                                   CaptionML=ENU=Fields;
                                                   BlankZero=Yes;
                                                   Editable=No }
    { 22  ;   ;Code Implemented    ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("ES FLADS Relation"."Code Implemented" WHERE (Object Type=FIELD(Object Type),
                                                                                                                    Object ID=FIELD(Object ID),
                                                                                                                    Type=CONST(Source Table),
                                                                                                                    Relation Object Type=CONST(Table),
                                                                                                                    Relation Object ID=FIELD(Source Table ID)));
                                                   CaptionML=ENU=Code Implemented;
                                                   Editable=No }
    { 23  ;   ;From Setup Company  ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("ES FLADS Copy Setup"."From Setup Company" WHERE (Table ID=CONST(14123804),
                                                                                                                        Source Table ID=FIELD(Source Table ID),
                                                                                                                        Code=FIELD(Data Security Code)));
                                                   CaptionML=ENU=From Setup Company;
                                                   Editable=No }
  }
  KEYS
  {
    {    ;Source Table ID,Data Security Code,Object Type,Object ID;
                                                   Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      ESSourceTableSetup@1240520011 : Record 14123802;
      ESDataSecurityCode@1240520009 : Record 14123804;
      ESFLADSUpdateNo@1240520013 : Record 14123813;
      ESFLADSRelation@1240520014 : Record 14123810;
      ESFLADSSetup@1240520010 : Record 14123801;
      Text001@1001 : TextConst 'ENU=<%1 not specified later>';
      Text002@1002 : TextConst 'ENU=%1 %2 %3 %4 %5 %6';
      Text003@1003 : TextConst 'ENU=%1 already exists.';
      ESLoginSetup@1240520001 : Record 14123540;

    PROCEDURE DrillDownFields@1240520008();
    VAR
      ESDataSecurityObject@1240520001 : Record 14123808;
    BEGIN
      IF ISSERVICETIER THEN
        IF NOT ESDataSecurityObject.GET(
                 "Source Table ID","Data Security Code","Object Type","Object ID")
        THEN BEGIN
          INSERT(TRUE);

          COMMIT;
        END;

      PAGE.RUNMODAL(PAGE::"ES Data Security Object",Rec);
    END;

    PROCEDURE ObjectCaption@1240520011() : Text[250];
    BEGIN
      IF "Object ID" = 0 THEN
        EXIT(STRSUBSTNO(Text001,"Object Type"));

      CALCFIELDS("Object Caption");
      EXIT("Object Caption");
    END;

    PROCEDURE DataCaption@1240520009() : Text[250];
    BEGIN
      CALCFIELDS("Source Table Caption");
      EXIT(
        STRSUBSTNO(
          Text002,
          "Source Table ID","Source Table Caption","Data Security Code",
          "Object Type","Object ID",ObjectCaption));
    END;

    PROCEDURE CopyDetailsFromObject@1240520010();
    VAR
      ESDataSecurityField@1240520008 : Record 14123809;
      ESDataSecurityField2@1240520009 : Record 14123809;
      ESDataSecurityObject@1240520010 : Record 14123808;
    BEGIN
      ESDataSecurityField.RESET;
      ESDataSecurityField.SETRANGE("Source Table ID","Source Table ID");
      ESDataSecurityField.SETRANGE("Data Security Code","Data Security Code");
      ESDataSecurityField.SETRANGE("Object Type","Object Type");
      ESDataSecurityField.SETRANGE("Object ID","Object ID");
      IF ESDataSecurityField.FIND('-') THEN
        ERROR(Text003,ESDataSecurityField.TABLECAPTION);

      ESDataSecurityObject.RESET;
      ESDataSecurityObject.SETRANGE("Source Table ID","Source Table ID");
      IF PAGE.RUNMODAL(0,ESDataSecurityObject) <> ACTION::LookupOK THEN
        EXIT;

      ESDataSecurityField.RESET;
      ESDataSecurityField.SETRANGE("Source Table ID",ESDataSecurityObject."Source Table ID");
      ESDataSecurityField.SETRANGE("Data Security Code",ESDataSecurityObject."Data Security Code");
      ESDataSecurityField.SETRANGE("Object Type",ESDataSecurityObject."Object Type");
      ESDataSecurityField.SETRANGE("Object ID",ESDataSecurityObject."Object ID");
      IF ESDataSecurityField.FIND('-') THEN
        REPEAT
          ESDataSecurityField2 := ESDataSecurityField;
          ESDataSecurityField2."Source Table ID" := "Source Table ID";
          ESDataSecurityField2."Data Security Code" := "Data Security Code";
          ESDataSecurityField2."Object Type" := "Object Type";
          ESDataSecurityField2."Object ID" := "Object ID";
          ESDataSecurityField2.INSERT(TRUE);
        UNTIL ESDataSecurityField.NEXT = 0;
    END;

    PROCEDURE DeleteRelated@1240520012();
    VAR
      ESDataSecurityField@1240520008 : Record 14123809;
      ESDataSecurityField2@1240520009 : Record 14123809;
    BEGIN
      ESDataSecurityField.RESET;
      ESDataSecurityField.SETRANGE("Source Table ID","Source Table ID");
      ESDataSecurityField.SETRANGE("Data Security Code","Data Security Code");
      ESDataSecurityField.SETRANGE("Object Type","Object Type");
      ESDataSecurityField.SETRANGE("Object ID","Object ID");
      IF ESDataSecurityField.FIND('-') THEN
        REPEAT
          ESDataSecurityField2 := ESDataSecurityField;
          ESDataSecurityField2.DELETE(TRUE);
        UNTIL ESDataSecurityField.NEXT = 0;
    END;

    PROCEDURE ObjectWhereUsed@1240520014();
    VAR
      ESObjectWhereUsed@1240520008 : Page 14123562;
    BEGIN
      CLEAR(ESObjectWhereUsed);
      ESObjectWhereUsed.InitObject("Object Type","Object ID");
      ESObjectWhereUsed.RUN;
    END;

    BEGIN
    END.
  }
}

