OBJECT Table 14000567 Posted Suggested Order Header
{
  OBJECT-PROPERTIES
  {
    Date=03/27/19;
    Time=12:00:00 PM;
    Version List=UBP3.00;
  }
  PROPERTIES
  {
    DataCaptionFields=No.,Buy-from Vendor Name;
    OnDelete=BEGIN
               PostedSugOrderLine.LOCKTABLE;
               PostedSugOrderLine.RESET;
               PostedSugOrderLine.SETRANGE("Buy-from Vendor No.","Buy-from Vendor No.");
               PostedSugOrderLine.SETRANGE("Document No.","No.");
               PostedSugOrderLine.DELETEALL;
             END;

    CaptionML=ENU=Posted Suggested Order Header;
    LookupPageID=Page14000582;
  }
  FIELDS
  {
    { 1   ;   ;Buy-from Vendor No. ;Code20        ;TableRelation=Vendor;
                                                   CaptionML=ENU=Buy-from Vendor No. }
    { 2   ;   ;No.                 ;Code20        ;CaptionML=ENU=No. }
    { 11  ;   ;Your Reference      ;Text30        ;CaptionML=ENU=Your Reference }
    { 12  ;   ;Ship-to Name        ;Text50        ;CaptionML=ENU=Ship-to Name }
    { 13  ;   ;Ship-to Name 2      ;Text50        ;CaptionML=ENU=Ship-to Name 2 }
    { 14  ;   ;Ship-to Address     ;Text50        ;CaptionML=ENU=Ship-to Address }
    { 15  ;   ;Ship-to Address 2   ;Text50        ;CaptionML=ENU=Ship-to Address 2 }
    { 16  ;   ;Ship-to City        ;Text30        ;CaptionML=ENU=Ship-to City }
    { 17  ;   ;Ship-to Contact     ;Text50        ;CaptionML=ENU=Ship-to Contact }
    { 18  ;   ;Order Date          ;Date          ;CaptionML=ENU=Order Date }
    { 19  ;   ;Shipment Method Code;Code10        ;TableRelation="Shipment Method";
                                                   CaptionML=ENU=Shipment Method Code }
    { 20  ;   ;Location Code       ;Code10        ;TableRelation=Location WHERE (Use As In-Transit=CONST(No));
                                                   CaptionML=ENU=Location Code }
    { 21  ;   ;Buy-from Vendor Name;Text50        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Vendor.Name WHERE (No.=FIELD(Buy-from Vendor No.)));
                                                   CaptionML=ENU=Buy-from Vendor Name;
                                                   Editable=No }
    { 22  ;   ;Buy-from Vendor Name 2;Text50      ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Vendor."Name 2" WHERE (No.=FIELD(Buy-from Vendor No.)));
                                                   CaptionML=ENU=Buy-from Vendor Name 2;
                                                   Editable=No }
    { 23  ;   ;Buy-from Address    ;Text50        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Vendor.Address WHERE (No.=FIELD(Buy-from Vendor No.)));
                                                   CaptionML=ENU=Buy-from Address;
                                                   Editable=No }
    { 24  ;   ;Buy-from Address 2  ;Text50        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Vendor."Address 2" WHERE (No.=FIELD(Buy-from Vendor No.)));
                                                   CaptionML=ENU=Buy-from Address 2 }
    { 25  ;   ;Buy-from City       ;Text30        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Vendor.City WHERE (No.=FIELD(Buy-from Vendor No.)));
                                                   CaptionML=ENU=Buy-from City;
                                                   Editable=No }
    { 26  ;   ;Buy-from Contact    ;Text50        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Vendor.Contact WHERE (No.=FIELD(Buy-from Vendor No.)));
                                                   CaptionML=ENU=Buy-from Contact;
                                                   Editable=No }
    { 27  ;   ;Buy-from Post Code  ;Code20        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Vendor."Post Code" WHERE (No.=FIELD(Buy-from Vendor No.)));
                                                   TableRelation="Post Code";
                                                   ValidateTableRelation=No;
                                                   CaptionML=ENU=Buy-from Post Code;
                                                   Editable=No }
    { 28  ;   ;Buy-from County     ;Text30        ;CaptionML=ENU=Buy-from County }
    { 29  ;   ;Buy-from Country Code;Code10       ;TableRelation=Country/Region.Code;
                                                   CaptionML=ENU=Buy-from Country Code }
    { 30  ;   ;Ship-to Post Code   ;Code20        ;TableRelation="Post Code";
                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=ENU=Ship-to Post Code }
    { 31  ;   ;Ship-to County      ;Text30        ;CaptionML=ENU=Ship-to County }
    { 32  ;   ;Ship-to Country Code;Code10        ;TableRelation=Country/Region.Code;
                                                   CaptionML=ENU=Ship-to Country Code }
    { 33  ;   ;Document Date       ;Date          ;CaptionML=ENU=Document Date }
    { 34  ;   ;Requested Receipt Date;Date        ;CaptionML=ENU=Requested Receipt Date }
    { 35  ;   ;Creation Date       ;Date          ;CaptionML=ENU=Creation Date }
    { 36  ;   ;Created By          ;Code60        ;CaptionML=ENU=Created By }
    { 37  ;   ;Amount (Order Point);Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Posted Suggested Order Line"."Line Amount" WHERE (Buy-from Vendor No.=FIELD(Buy-from Vendor No.),
                                                                                                                      Document No.=FIELD(No.),
                                                                                                                      Purchase Reason=CONST(Order Point),
                                                                                                                      Override Vendor No.=FIELD(Override Vendor Filter)));
                                                   CaptionML=ENU=Amount (Order Point);
                                                   Editable=No }
    { 38  ;   ;Amount (Line Point) ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Posted Suggested Order Line"."Line Amount" WHERE (Buy-from Vendor No.=FIELD(Buy-from Vendor No.),
                                                                                                                      Document No.=FIELD(No.),
                                                                                                                      Purchase Reason=CONST(Line Point),
                                                                                                                      Override Vendor No.=FIELD(Override Vendor Filter)));
                                                   CaptionML=ENU=Amount (Line Point);
                                                   Editable=No }
    { 39  ;   ;Net Weight (Order Point);Decimal   ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Posted Suggested Order Line"."Line Net Weight" WHERE (Buy-from Vendor No.=FIELD(Buy-from Vendor No.),
                                                                                                                          Document No.=FIELD(No.),
                                                                                                                          Purchase Reason=CONST(Order Point),
                                                                                                                          Override Vendor No.=FIELD(Override Vendor Filter)));
                                                   CaptionML=ENU=Net Weight (Order Point);
                                                   Editable=No }
    { 40  ;   ;Net Weight (Line Point);Decimal    ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Posted Suggested Order Line"."Line Net Weight" WHERE (Buy-from Vendor No.=FIELD(Buy-from Vendor No.),
                                                                                                                          Document No.=FIELD(No.),
                                                                                                                          Purchase Reason=CONST(Line Point),
                                                                                                                          Override Vendor No.=FIELD(Override Vendor Filter)));
                                                   CaptionML=ENU=Net Weight (Line Point);
                                                   Editable=No }
    { 41  ;   ;Gross Weight (Order Point);Decimal ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Posted Suggested Order Line"."Line Gross Weight" WHERE (Buy-from Vendor No.=FIELD(Buy-from Vendor No.),
                                                                                                                            Document No.=FIELD(No.),
                                                                                                                            Purchase Reason=CONST(Order Point),
                                                                                                                            Override Vendor No.=FIELD(Override Vendor Filter)));
                                                   CaptionML=ENU=Gross Weight (Order Point);
                                                   Editable=No }
    { 42  ;   ;Gross Weight (Line Point);Decimal  ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Posted Suggested Order Line"."Line Gross Weight" WHERE (Buy-from Vendor No.=FIELD(Buy-from Vendor No.),
                                                                                                                            Document No.=FIELD(No.),
                                                                                                                            Purchase Reason=CONST(Line Point),
                                                                                                                            Override Vendor No.=FIELD(Override Vendor Filter)));
                                                   CaptionML=ENU=Gross Weight (Line Point);
                                                   Editable=No }
    { 43  ;   ;Volume (Order Point);Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Posted Suggested Order Line"."Line Volume" WHERE (Buy-from Vendor No.=FIELD(Buy-from Vendor No.),
                                                                                                                      Document No.=FIELD(No.),
                                                                                                                      Purchase Reason=CONST(Order Point),
                                                                                                                      Override Vendor No.=FIELD(Override Vendor Filter)));
                                                   CaptionML=ENU=Volume (Order Point);
                                                   Editable=No }
    { 44  ;   ;Volume (Line Point) ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Posted Suggested Order Line"."Line Volume" WHERE (Buy-from Vendor No.=FIELD(Buy-from Vendor No.),
                                                                                                                      Document No.=FIELD(No.),
                                                                                                                      Purchase Reason=CONST(Line Point),
                                                                                                                      Override Vendor No.=FIELD(Override Vendor Filter)));
                                                   CaptionML=ENU=Volume (Line Point);
                                                   Editable=No }
    { 45  ;   ;Procurement Group Code;Code20      ;CaptionML=ENU=Procurement Group Code;
                                                   Editable=No }
    { 46  ;   ;Posting No.         ;Code20        ;CaptionML=ENU=Posting No.;
                                                   Editable=No }
    { 47  ;   ;Posting No. Series  ;Code20        ;CaptionML=ENU=Posting No. Series }
    { 48  ;   ;Amount              ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Posted Suggested Order Line"."Line Amount" WHERE (Buy-from Vendor No.=FIELD(Buy-from Vendor No.),
                                                                                                                      Document No.=FIELD(No.),
                                                                                                                      Override Vendor No.=FIELD(Override Vendor Filter)));
                                                   CaptionML=ENU=Amount;
                                                   Editable=No }
    { 49  ;   ;Net Weight          ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Posted Suggested Order Line"."Line Net Weight" WHERE (Buy-from Vendor No.=FIELD(Buy-from Vendor No.),
                                                                                                                          Document No.=FIELD(No.),
                                                                                                                          Override Vendor No.=FIELD(Override Vendor Filter)));
                                                   CaptionML=ENU=Net Weight;
                                                   Editable=No }
    { 50  ;   ;Gross Weight        ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Posted Suggested Order Line"."Line Gross Weight" WHERE (Buy-from Vendor No.=FIELD(Buy-from Vendor No.),
                                                                                                                            Document No.=FIELD(No.),
                                                                                                                            Override Vendor No.=FIELD(Override Vendor Filter)));
                                                   CaptionML=ENU=Gross Weight;
                                                   Editable=No }
    { 51  ;   ;Volume              ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Posted Suggested Order Line"."Line Volume" WHERE (Buy-from Vendor No.=FIELD(Buy-from Vendor No.),
                                                                                                                      Document No.=FIELD(No.),
                                                                                                                      Override Vendor No.=FIELD(Override Vendor Filter)));
                                                   CaptionML=ENU=Volume;
                                                   Editable=No }
    { 52  ;   ;Amount (Seasonal)   ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Posted Suggested Order Line"."Line Amount" WHERE (Buy-from Vendor No.=FIELD(Buy-from Vendor No.),
                                                                                                                      Document No.=FIELD(No.),
                                                                                                                      Purchase Reason=CONST(Seasonal),
                                                                                                                      Override Vendor No.=FIELD(Override Vendor Filter)));
                                                   CaptionML=ENU=Amount (Seasonal);
                                                   Editable=No }
    { 53  ;   ;Amount (Min/Max)    ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Posted Suggested Order Line"."Line Amount" WHERE (Buy-from Vendor No.=FIELD(Buy-from Vendor No.),
                                                                                                                      Document No.=FIELD(No.),
                                                                                                                      Purchase Reason=CONST(Min/Max),
                                                                                                                      Override Vendor No.=FIELD(Override Vendor Filter)));
                                                   CaptionML=ENU=Amount (Min/Max);
                                                   Editable=No }
    { 54  ;   ;Net Weight (Seasonal);Decimal      ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Posted Suggested Order Line"."Line Net Weight" WHERE (Buy-from Vendor No.=FIELD(Buy-from Vendor No.),
                                                                                                                          Document No.=FIELD(No.),
                                                                                                                          Purchase Reason=CONST(Seasonal),
                                                                                                                          Override Vendor No.=FIELD(Override Vendor Filter)));
                                                   CaptionML=ENU=Net Weight (Seasonal);
                                                   Editable=No }
    { 55  ;   ;Net Weight (Min/Max);Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Posted Suggested Order Line"."Line Net Weight" WHERE (Buy-from Vendor No.=FIELD(Buy-from Vendor No.),
                                                                                                                          Document No.=FIELD(No.),
                                                                                                                          Purchase Reason=CONST(Min/Max),
                                                                                                                          Override Vendor No.=FIELD(Override Vendor Filter)));
                                                   CaptionML=ENU=Net Weight (Min/Max);
                                                   Editable=No }
    { 56  ;   ;Gross Weight (Seasonal);Decimal    ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Posted Suggested Order Line"."Line Gross Weight" WHERE (Buy-from Vendor No.=FIELD(Buy-from Vendor No.),
                                                                                                                            Document No.=FIELD(No.),
                                                                                                                            Purchase Reason=CONST(Seasonal),
                                                                                                                            Override Vendor No.=FIELD(Override Vendor Filter)));
                                                   CaptionML=ENU=Gross Weight (Seasonal);
                                                   Editable=No }
    { 57  ;   ;Gross Weight (Min/Max);Decimal     ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Posted Suggested Order Line"."Line Gross Weight" WHERE (Buy-from Vendor No.=FIELD(Buy-from Vendor No.),
                                                                                                                            Document No.=FIELD(No.),
                                                                                                                            Purchase Reason=CONST(Min/Max),
                                                                                                                            Override Vendor No.=FIELD(Override Vendor Filter)));
                                                   CaptionML=ENU=Gross Weight (Min/Max);
                                                   Editable=No }
    { 58  ;   ;Volume (Seasonal)   ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Posted Suggested Order Line"."Line Volume" WHERE (Buy-from Vendor No.=FIELD(Buy-from Vendor No.),
                                                                                                                      Document No.=FIELD(No.),
                                                                                                                      Purchase Reason=CONST(Seasonal),
                                                                                                                      Override Vendor No.=FIELD(Override Vendor Filter)));
                                                   CaptionML=ENU=Volume (Seasonal);
                                                   Editable=No }
    { 59  ;   ;Volume (Min/Max)    ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Posted Suggested Order Line"."Line Volume" WHERE (Buy-from Vendor No.=FIELD(Buy-from Vendor No.),
                                                                                                                      Document No.=FIELD(No.),
                                                                                                                      Purchase Reason=CONST(Min/Max),
                                                                                                                      Override Vendor No.=FIELD(Override Vendor Filter)));
                                                   CaptionML=ENU=Volume (Min/Max);
                                                   Editable=No }
    { 60  ;   ;Amount (Other)      ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Posted Suggested Order Line"."Line Amount" WHERE (Document No.=FIELD(No.),
                                                                                                                      Purchase Reason=FILTER(<>Order Point&<>Line Point),
                                                                                                                      Override Vendor No.=FIELD(Override Vendor Filter)));
                                                   CaptionML=ENU=Amount (Other);
                                                   Editable=No }
    { 61  ;   ;Net Weight (Other)  ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Posted Suggested Order Line"."Line Net Weight" WHERE (Document No.=FIELD(No.),
                                                                                                                          Purchase Reason=FILTER(<>Order Point&<>Line Point),
                                                                                                                          Override Vendor No.=FIELD(Override Vendor Filter)));
                                                   CaptionML=ENU=Net Weight (Other);
                                                   Editable=No }
    { 62  ;   ;Gross Weight (Other);Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Posted Suggested Order Line"."Line Gross Weight" WHERE (Document No.=FIELD(No.),
                                                                                                                            Purchase Reason=FILTER(<>Order Point&<>Line Point),
                                                                                                                            Override Vendor No.=FIELD(Override Vendor Filter)));
                                                   CaptionML=ENU=Gross Weight (Other);
                                                   Editable=No }
    { 63  ;   ;Volume (Other)      ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Posted Suggested Order Line"."Line Volume" WHERE (Document No.=FIELD(No.),
                                                                                                                      Purchase Reason=FILTER(<>Order Point&<>Line Point),
                                                                                                                      Override Vendor No.=FIELD(Override Vendor Filter)));
                                                   CaptionML=ENU=Volume (Other);
                                                   Editable=No }
    { 64  ;   ;Override Vendor Filter;Code20      ;FieldClass=FlowFilter;
                                                   CaptionML=ENU=Override Vendor Filter }
    { 66  ;   ;Posted Date         ;Date          ;CaptionML=ENU=Posted Date;
                                                   Editable=No }
    { 67  ;   ;Purchaser Code      ;Code20        ;TableRelation=Salesperson/Purchaser.Code;
                                                   CaptionML=ENU=Purchaser Code }
    { 68  ;   ;Container Plan No.  ;Code20        ;CaptionML=ENU=Container Plan No.;
                                                   Editable=No }
  }
  KEYS
  {
    {    ;Buy-from Vendor No.,No.                 ;Clustered=Yes }
    {    ;No.                                      }
    {    ;Purchaser Code                           }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      PostedSugOrderLine@14000502 : Record 14000568;
      ProcGroup@14000503 : Record 14000564;
      VendBuyingCalendar@14000504 : Record 14000563;

    PROCEDURE PurchTargetsMet@1000000003() Resp@14000500 : Boolean;
    BEGIN
      IF "No." = '' THEN
        EXIT(FALSE)
      ELSE
        Resp := TRUE;
      CALCFIELDS(
        "Amount (Order Point)","Amount (Line Point)","Net Weight (Order Point)",
        "Net Weight (Line Point)","Gross Weight (Order Point)","Gross Weight (Line Point)",
        "Volume (Order Point)","Volume (Line Point)");

      IF "Procurement Group Code" <> '' THEN BEGIN
        ProcGroup.SETRANGE("Vendor No.","Buy-from Vendor No.");
        ProcGroup.SETRANGE(Code,"No.");
        IF ProcGroup.FIND('-') THEN BEGIN
          IF ("Amount (Order Point)" + "Amount (Line Point)") < ProcGroup."Amount Target" THEN
            Resp := FALSE;
          IF ("Net Weight (Order Point)" + "Net Weight (Line Point)") < ProcGroup."Net Weight Target" THEN
            Resp := FALSE;
          IF ("Gross Weight (Order Point)" + "Gross Weight (Line Point)") < ProcGroup."Gross Weight Target" THEN
            Resp := FALSE;
          IF ("Volume (Order Point)" + "Volume (Line Point)") < ProcGroup."Volume Target" THEN
            Resp := FALSE;
        END;
      END ELSE BEGIN
        VendBuyingCalendar.SETRANGE("Vendor No.","Buy-from Vendor No.");
        VendBuyingCalendar.SETRANGE(VendBuyingCalendar."Location Code","No.");
        IF VendBuyingCalendar.FIND('-') THEN BEGIN
          IF ("Amount (Order Point)" + "Amount (Line Point)") < VendBuyingCalendar."Amount Target" THEN
            Resp := FALSE;
          IF ("Net Weight (Order Point)" + "Net Weight (Line Point)") < VendBuyingCalendar."Net Weight Target" THEN
            Resp := FALSE;
          IF ("Gross Weight (Order Point)" + "Gross Weight (Line Point)") < VendBuyingCalendar."Gross Weight Target" THEN
            Resp := FALSE;
          IF ("Volume (Order Point)" + "Volume (Line Point)") < VendBuyingCalendar."Volume Target" THEN
            Resp := FALSE;
        END;
      END;
      EXIT (Resp);
    END;

    BEGIN
    END.
  }
}

