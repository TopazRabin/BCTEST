OBJECT Table 51002 Ship-to Address Division
{
  OBJECT-PROPERTIES
  {
    Date=10/26/20;
    Time=[ 5:35:50 AM];
    Modified=Yes;
    Version List=TPZ000.00.00;
  }
  PROPERTIES
  {
    CaptionML=ENU=Ship-to Address Division;
    LookupPageID=Page51002;
    DrillDownPageID=Page51002;
  }
  FIELDS
  {
    { 1   ;   ;Customer No.        ;Code20        ;TableRelation=Customer;
                                                   CaptionML=[ENU=Customer No.;
                                                              ESM=N§ cliente;
                                                              FRC=Nø client;
                                                              ENC=Customer No.];
                                                   NotBlank=Yes }
    { 2   ;   ;Ship-to Code        ;Code10        ;TableRelation="Ship-to Address".Code WHERE (Customer No.=FIELD(Customer No.));
                                                   CaptionML=[ENU=Ship-to Code;
                                                              ESM=C¢d. direcci¢n env¡o cliente;
                                                              FRC=Code de livraison;
                                                              ENC=Ship-to Code];
                                                   NotBlank=Yes }
    { 3   ;   ;Shortcut Dimension 5 Code;Code10   ;OnValidate=BEGIN
                                                                ValidateShortcutDimCode(5,"Shortcut Dimension 5 Code");
                                                              END;

                                                   OnLookup=BEGIN
                                                              LookupShortcutDimCode(5,"Shortcut Dimension 5 Code");
                                                            END;

                                                   CaptionML=ENU=Shortcut Dimension 5 Code;
                                                   NotBlank=Yes;
                                                   CaptionClass='1,2,5' }
    { 29  ;   ;Salesperson Code    ;Code10        ;TableRelation=Salesperson/Purchaser;
                                                   DataClassification=ToBeClassified;
                                                   CaptionML=ENU=OSR Code;
                                                   Description=TPZ2959 }
    { 31  ;   ;Shipping Agent Code ;Code10        ;TableRelation="Shipping Agent";
                                                   OnValidate=BEGIN
                                                                SalesSetup.GET;
                                                                IF ("Shipping Agent Code" <> xRec."Shipping Agent Code") AND SalesSetup."Enable Shipping" THEN
                                                                  IF "Shipping Agent Code" = '' THEN
                                                                    "E-Ship Agent Service" := ''
                                                                  ELSE BEGIN
                                                                    ShippingAgent.GET("Shipping Agent Code");
                                                                    ShipToAddr.GET("Customer No.","Ship-to Code");
                                                                    VALIDATE(
                                                                      "E-Ship Agent Service",
                                                                      EShipAgentService.DefaultShipAgentService(ShippingAgent,ShipToAddr."Country/Region Code"));
                                                                  END;
                                                              END;

                                                   CaptionML=[ENU=Shipping Agent Code;
                                                              ESM=C¢d. transportista;
                                                              FRC=Code agent de livraison;
                                                              ENC=Shipping Agent Code] }
    { 83  ;   ;Location Code       ;Code10        ;TableRelation=Location WHERE (Use As In-Transit=CONST(No));
                                                   CaptionML=[ENU=Location Code;
                                                              ESM=C¢d. almac‚n;
                                                              FRC=Code d'emplacement;
                                                              ENC=Location Code] }
    { 5750;   ;Shipping Advice     ;Option        ;CaptionML=ENU=Shipping Advice;
                                                   OptionCaptionML=ENU=Partial,Complete,No Back Order;
                                                   OptionString=Partial,Complete,No Back Order }
    { 14000701;;E-Ship Agent Service;Code30       ;TableRelation="E-Ship Agent Service".Code WHERE (Shipping Agent Code=FIELD(Shipping Agent Code));
                                                   OnValidate=BEGIN
                                                                IF "E-Ship Agent Service" <> '' THEN BEGIN
                                                                  TESTFIELD("Shipping Agent Code");
                                                                  ShippingAgent.GET("Shipping Agent Code");
                                                                  ShipToAddr.GET("Customer No.","Ship-to Code");

                                                                  EShipAgentService.ValidateEShipAgentService(ShippingAgent,"E-Ship Agent Service",ShipToAddr."Country/Region Code");
                                                                END;
                                                              END;

                                                   OnLookup=BEGIN
                                                              TESTFIELD("Shipping Agent Code");
                                                              ShippingAgent.GET("Shipping Agent Code");
                                                              ShipToAddr.GET("Customer No.","Ship-to Code");
                                                              EShipAgentService.LookupEShipAgentService(ShippingAgent,"E-Ship Agent Service",ShipToAddr."Country/Region Code");
                                                              IF PAGE.RUNMODAL(0,EShipAgentService) = ACTION::LookupOK THEN
                                                                VALIDATE("E-Ship Agent Service",EShipAgentService.Code);
                                                            END;

                                                   CaptionML=ENU=E-Ship Agent Service }
    { 14000702;;Free Freight       ;Boolean       ;CaptionML=ENU=Free Freight }
    { 14000708;;Shipping Payment Type;Option      ;OnValidate=BEGIN
                                                                IF ShippingAgent.GET("Shipping Agent Code") THEN
                                                                  ShippingAccount.ValidateShippingAccount(
                                                                    ShippingAgent,"Shipping Payment Type",
                                                                    ShippingAccount."Ship-to Type"::Customer,"Customer No.","Ship-to Code");
                                                              END;

                                                   CaptionML=ENU=Shipping Payment Type;
                                                   OptionCaptionML=ENU=Prepaid,Third Party,Freight Collect,Consignee;
                                                   OptionString=Prepaid,Third Party,Freight Collect,Consignee }
  }
  KEYS
  {
    {    ;Customer No.,Ship-to Code,Shortcut Dimension 5 Code;
                                                   Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      SalesSetup@1000000000 : Record 311;
      ShippingAgent@1000000001 : Record 291;
      EShipAgentService@1000000002 : Record 14000708;
      ShipToAddr@1000000003 : Record 222;
      ShippingAccount@1000000004 : Record 14000714;
      DimMgt@1000000005 : Codeunit 408;

    PROCEDURE ValidateShortcutDimCode@19(FieldNumber@1000 : Integer;VAR ShortcutDimCode@1001 : Code[20]);
    VAR
      OldDimSetID@1005 : Integer;
    BEGIN
      DimMgt.ValidateDimValueCode(FieldNumber,ShortcutDimCode);
    END;

    PROCEDURE LookupShortcutDimCode@1000000000(FieldNumber@1000000001 : Integer;VAR ShortcutDimCode@1000000000 : Code[20]);
    BEGIN
      DimMgt.LookupDimValueCode(FieldNumber,ShortcutDimCode);
    END;

    BEGIN
    {
      2015-05-27 TPZ717 VCHERNYA
        Table has been created
      2015-12-21 TPZ1342 VCHERNYA
        Shipping Advice field has been created
      2020-10-26 TPZ2959 UCHOUHAN
        Added New Field Salesperson Code (OSR Code).
    }
    END.
  }
}

