OBJECT Table 14000731 Serial Number Conversion
{
  OBJECT-PROPERTIES
  {
    Date=06/28/17;
    Time=12:00:00 PM;
    Version List=SE0.50.32;
  }
  PROPERTIES
  {
    CaptionML=ENU=Serial Number Conversion;
    LookupPageID=Page14000734;
  }
  FIELDS
  {
    { 1   ;   ;Code                ;Code10        ;CaptionML=ENU=Code }
    { 2   ;   ;Description         ;Text30        ;CaptionML=ENU=Description }
  }
  KEYS
  {
    {    ;Code                                    ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    PROCEDURE ConvertString@1(OriginalString@1000000001 : Text[250]) OutputString@1000000000 : Text[250];
    VAR
      ConvNumberLine@1000000002 : Record 14000732;
    BEGIN
      OutputString := '';

      ConvNumberLine.RESET;
      ConvNumberLine.SETRANGE("Serial Number Conversion Code",Code);
      ConvNumberLine.SETRANGE("Setup OK",TRUE);
      IF ConvNumberLine.FIND('-') THEN
        REPEAT
          IF STRLEN(OriginalString) >=
             ConvNumberLine."First Characters" + ConvNumberLine."Last Characters"
          THEN
            CASE TRUE OF
              (ConvNumberLine."First Characters" <> 0) AND (ConvNumberLine."Last Characters" <> 0):
                IF (COPYSTR(OriginalString,1,ConvNumberLine."First Characters") =
                    ConvNumberLine."First String") AND
                   (COPYSTR(
                      OriginalString,STRLEN(OriginalString) - ConvNumberLine."Last Characters" + 1,
                      ConvNumberLine."First Characters") =
                    ConvNumberLine."Last String")
                THEN
                  OutputString :=
                    COPYSTR(
                      OriginalString,ConvNumberLine."First Characters" + 1,
                      STRLEN(OriginalString) -
                      (ConvNumberLine."First Characters" + ConvNumberLine."Last Characters"));
              ConvNumberLine."First Characters" <> 0:
                IF COPYSTR(OriginalString,1,ConvNumberLine."First Characters") =
                   ConvNumberLine."First String"
                THEN
                  OutputString := COPYSTR(OriginalString,ConvNumberLine."First Characters" + 1);
              ConvNumberLine."Last Characters" <> 0:
                IF COPYSTR(
                     OriginalString,STRLEN(OriginalString) - ConvNumberLine."Last Characters" + 1,
                     ConvNumberLine."Last Characters") =
                   ConvNumberLine."Last String"
                THEN
                  OutputString :=
                    COPYSTR(OriginalString,1,STRLEN(OriginalString) - ConvNumberLine."Last Characters");
              ELSE
                ;
            END;
        UNTIL (ConvNumberLine.NEXT = 0) OR (OutputString <> '');

      IF OutputString = '' THEN
        OutputString := OriginalString;
    END;

    BEGIN
    END.
  }
}

