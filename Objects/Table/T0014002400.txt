OBJECT Table 14002400 Order Status Header
{
  OBJECT-PROPERTIES
  {
    Date=07/07/17;
    Time=12:00:00 PM;
    Version List=SE0.60.14;
  }
  PROPERTIES
  {
    DataCaptionFields=Trade Partner Code,Internal Doc. No.,Source Doc. Type,Source Doc. No.;
    OnDelete=BEGIN
               EDIOrderStatusLine.RESET;
               EDIOrderStatusLine.SETRANGE("Internal Doc. No.","Internal Doc. No.");
               EDIOrderStatusLine.SETRANGE("Export Version","Export Version");
               EDIOrderStatusLine.SETRANGE("Source Doc. No.","Source Doc. No.");
               EDIOrderStatusLine.SETRANGE("Document Type","Document Type");
               EDIOrderStatusLine.DELETEALL;

               OrderStatusEntry.RESET;
               OrderStatusEntry.SETRANGE("Trade Partner No.","Trade Partner Code");
               OrderStatusEntry.SETRANGE("EDI Internal Doc. No.","Internal Doc. No.");
               OrderStatusEntry.SETRANGE("Export Version","Export Version");
               OrderStatusEntry.SETRANGE("Source Doc. Type","Source Doc. Type"::Order);
               OrderStatusEntry.SETRANGE("Source Doc. No.","Source Doc. No.");
               OrderStatusEntry.SETRANGE("Document Type","Document Type");
               OrderStatusEntry.DELETEALL;
             END;

    CaptionML=ENU=Order Status Header;
    LookupPageID=Page14002431;
    DrillDownPageID=Page14002431;
  }
  FIELDS
  {
    { 1   ;   ;Trade Partner Code  ;Code20        ;TableRelation="E.D.I. Trade Partner".No.;
                                                   CaptionML=ENU=Trade Partner Code;
                                                   Editable=No }
    { 2   ;   ;Internal Doc. No.   ;Code10        ;TableRelation="E.D.I. Receive Document Hdr.";
                                                   CaptionML=ENU=Internal Doc. No.;
                                                   Editable=No }
    { 3   ;   ;Export Version      ;Integer       ;CaptionML=ENU=Export Version;
                                                   Editable=No }
    { 4   ;   ;Source Doc. Type    ;Option        ;CaptionML=ENU=Source Doc. Type;
                                                   OptionCaptionML=ENU=Quote,Order,Invoice,Credit Memo,Blanket Order;
                                                   OptionString=Quote,Order,Invoice,Credit Memo,Blanket Order;
                                                   Editable=No }
    { 5   ;   ;Source Doc. No.     ;Code20        ;OnLookup=VAR
                                                              SalesHeader@1240020000 : Record 36;
                                                            BEGIN
                                                              CASE "Source Doc. Type" OF
                                                                "Source Doc. Type"::Quote:
                                                                  BEGIN
                                                                    SalesHeader.RESET;
                                                                    SalesHeader.SETRANGE("Document Type",SalesHeader."Document Type"::Quote);
                                                                    SalesHeader.SETRANGE("No.","Source Doc. No.");
                                                                    IF SalesHeader.FIND('-') THEN
                                                                      SalesHeader.SETRANGE("No.")
                                                                    ELSE
                                                                      SalesHeader.SETRANGE("No.");

                                                                    PAGE.RUN(PAGE::"Sales Quotes",SalesHeader,SalesHeader."No.")
                                                                  END;
                                                                "Source Doc. Type"::Order:
                                                                  BEGIN
                                                                    SalesHeader.RESET;
                                                                    SalesHeader.SETRANGE("Document Type",SalesHeader."Document Type"::Order);
                                                                    SalesHeader.SETRANGE("No.","Source Doc. No.");
                                                                    IF SalesHeader.FIND('-') THEN
                                                                      SalesHeader.SETRANGE("No.")
                                                                    ELSE
                                                                      SalesHeader.SETRANGE("No.");
                                                                    PAGE.RUN(PAGE::"Sales Order List",SalesHeader,SalesHeader."No.")
                                                                  END;
                                                              END;
                                                            END;

                                                   CaptionML=ENU=Source Doc. No.;
                                                   Editable=No }
    { 6   ;   ;Document Type       ;Option        ;CaptionML=ENU=Document Type;
                                                   OptionCaptionML=ENU=" ,Order Change Status,Advance P.O. Ack.";
                                                   OptionString=[ ,Order Change Status,Advance P.O. Ack.] }
    { 8   ;   ;EDI Document No.    ;Code30        ;CaptionML=ENU=EDI Document No. }
    { 9   ;   ;Released            ;Boolean       ;CaptionML=ENU=Released;
                                                   Editable=No }
    { 11  ;   ;Exported            ;Boolean       ;CaptionML=ENU=Exported;
                                                   Editable=No }
    { 12  ;   ;Date Exported       ;Date          ;CaptionML=ENU=Date Exported;
                                                   Editable=No }
    { 13  ;   ;Time Exported       ;Time          ;CaptionML=ENU=Time Exported;
                                                   Editable=No }
    { 14  ;   ;Exported By         ;Code50        ;CaptionML=ENU=Exported By;
                                                   Editable=No }
    { 23  ;   ;EDI Status Code     ;Code10        ;OnValidate=BEGIN
                                                                CASE "Document Type" OF
                                                                  "Document Type"::" ":
                                                                    NavisionDocument := 'E_SLSSTA';
                                                                  "Document Type"::"Order Change Status":
                                                                    NavisionDocument := 'E_SLSPOC';
                                                                  "Document Type"::"Advance P.O. Ack.":
                                                                    NavisionDocument := 'E_ADVPOA';
                                                                END;
                                                                EDIDocument.RESET;
                                                                EDIDocument.SETRANGE("Trade Partner No.","Trade Partner Code");
                                                                EDIDocument.SETFILTER(Status,'%1|%2',EDIDocument.Status::Test,EDIDocument.Status::Production);
                                                                EDIDocument.SETRANGE("Navision Document",NavisionDocument);
                                                                EDIDocument.SETRANGE(Type,EDIDocument.Type::Export);
                                                                IF NOT EDIDocument.FIND('-') THEN
                                                                  ERROR(
                                                                    Text002,
                                                                    NavisionDocument,"Trade Partner Code");

                                                                IF Rec."EDI Status Code" <> '' THEN BEGIN
                                                                  EDIStatusCode.RESET;
                                                                  EDIStatusCode.SETRANGE("Trade Partner No.","Trade Partner Code");
                                                                  EDIStatusCode.SETRANGE("EDI Document No.",EDIDocument."EDI Document No.");
                                                                  EDIStatusCode.SETRANGE(Type,EDIStatusCode.Type::Status);
                                                                  EDIStatusCode.SETRANGE(Code,"EDI Status Code");
                                                                  EDIStatusCode.SETRANGE(Header,TRUE);
                                                                  EDIStatusCode.FIND('-');
                                                                  IF EDIStatusCode."Clear Line Codes" THEN BEGIN
                                                                    EDIOrderStatusLine.RESET;
                                                                    EDIOrderStatusLine.SETRANGE("Internal Doc. No.","Internal Doc. No.");
                                                                    EDIOrderStatusLine.SETRANGE("Export Version","Export Version");
                                                                    EDIOrderStatusLine.SETRANGE("Source Doc. Type","Source Doc. Type");
                                                                    EDIOrderStatusLine.SETRANGE("Source Doc. No.","Source Doc. No.");
                                                                    IF EDIOrderStatusLine.FIND('-') THEN
                                                                      REPEAT
                                                                        EDIOrderStatusLine."EDI Status Code" := '';
                                                                        EDIOrderStatusLine.MODIFY;
                                                                      UNTIL EDIOrderStatusLine.NEXT = 0;
                                                                  END;

                                                                  IF EDIStatusCode."Header Status Send Only" THEN BEGIN
                                                                    "Send Hdr. Status Only" := TRUE;
                                                                    MODIFY;
                                                                  END;

                                                                  IF EDIStatusCode.Line THEN BEGIN
                                                                    EDIOrderStatusLine.RESET;
                                                                    EDIOrderStatusLine.SETRANGE("Internal Doc. No.","Internal Doc. No.");
                                                                    EDIOrderStatusLine.SETRANGE("Export Version","Export Version");
                                                                    EDIOrderStatusLine.SETRANGE("Source Doc. Type","Source Doc. Type");
                                                                    EDIOrderStatusLine.SETRANGE("Source Doc. No.","Source Doc. No.");
                                                                    EDIOrderStatusLine.SETRANGE("Document Type","Document Type");
                                                                    IF EDIOrderStatusLine.FIND('-') THEN BEGIN
                                                                      IF NOT CONFIRM(Text001) THEN
                                                                        EXIT;
                                                                      REPEAT
                                                                        EDIOrderStatusLine."EDI Status Code" := "EDI Status Code";
                                                                        EDIOrderStatusLine.MODIFY;
                                                                      UNTIL EDIOrderStatusLine.NEXT = 0;
                                                                    END;
                                                                  END;
                                                                END;
                                                              END;

                                                   OnLookup=BEGIN
                                                              CASE "Document Type" OF
                                                                "Document Type"::" ":
                                                                  NavisionDocument := 'E_SLSSTA';
                                                                "Document Type"::"Order Change Status":
                                                                  NavisionDocument := 'E_SLSPOC';
                                                                "Document Type"::"Advance P.O. Ack.":
                                                                  NavisionDocument := 'E_ADVPOA';
                                                              END;
                                                              EDIDocument.RESET;
                                                              EDIDocument.SETRANGE("Trade Partner No.","Trade Partner Code");
                                                              EDIDocument.SETFILTER(Status,'%1|%2',EDIDocument.Status::Test,EDIDocument.Status::Production);
                                                              EDIDocument.SETRANGE("Navision Document",NavisionDocument);
                                                              EDIDocument.SETRANGE(Type,EDIDocument.Type::Export);
                                                              IF NOT EDIDocument.FIND('-') THEN
                                                                ERROR(
                                                                  Text002,
                                                                  NavisionDocument,"Trade Partner Code");

                                                              EDIStatusCode.RESET;
                                                              EDIStatusCode.SETRANGE("Trade Partner No.","Trade Partner Code");
                                                              EDIStatusCode.SETRANGE("EDI Document No.",EDIDocument."EDI Document No.");
                                                              EDIStatusCode.SETRANGE(Type,EDIStatusCode.Type::Status);
                                                              EDIStatusCode.SETRANGE(Header,TRUE);
                                                              IF NOT EDIStatusCode.FIND('-') THEN
                                                                ERROR(Text003,"Trade Partner Code",EDIDocument."EDI Document No.");
                                                              IF PAGE.RUNMODAL(PAGE::"E.D.I. Status Codes",EDIStatusCode) = ACTION::LookupOK THEN
                                                                VALIDATE("EDI Status Code",EDIStatusCode.Code);
                                                            END;

                                                   CaptionML=ENU=EDI Status Code }
    { 24  ;   ;EDI Reason Code     ;Code10        ;OnValidate=BEGIN
                                                                CASE "Document Type" OF
                                                                  "Document Type"::" ":
                                                                    NavisionDocument := 'E_SLSSTA';
                                                                  "Document Type"::"Order Change Status":
                                                                    NavisionDocument := 'E_SLSPOC';
                                                                  "Document Type"::"Advance P.O. Ack.":
                                                                    NavisionDocument := 'E_ADVPOA';
                                                                END;
                                                                EDIDocument.RESET;
                                                                EDIDocument.SETRANGE("Trade Partner No.","Trade Partner Code");
                                                                EDIDocument.SETFILTER(Status,'%1|%2',EDIDocument.Status::Test,EDIDocument.Status::Production);
                                                                EDIDocument.SETRANGE("Navision Document",NavisionDocument);
                                                                EDIDocument.SETRANGE(Type,EDIDocument.Type::Export);
                                                                IF NOT EDIDocument.FIND('-') THEN
                                                                  ERROR(
                                                                    Text002,
                                                                    NavisionDocument,"Trade Partner Code");

                                                                IF Rec."EDI Status Code" <> '' THEN BEGIN
                                                                  EDIStatusCode.RESET;
                                                                  EDIStatusCode.SETRANGE("Trade Partner No.","Trade Partner Code");
                                                                  EDIStatusCode.SETRANGE("EDI Document No.",EDIDocument."EDI Document No.");
                                                                  EDIStatusCode.SETRANGE(Type,EDIStatusCode.Type::Reason);
                                                                  EDIStatusCode.SETRANGE(Code,"EDI Reason Code");
                                                                  EDIStatusCode.SETRANGE(Header,TRUE);
                                                                  EDIStatusCode.FIND('-');
                                                                  IF EDIStatusCode."Clear Line Codes" THEN BEGIN
                                                                    EDIOrderStatusLine.RESET;
                                                                    EDIOrderStatusLine.SETRANGE("Internal Doc. No.","Internal Doc. No.");
                                                                    EDIOrderStatusLine.SETRANGE("Export Version","Export Version");
                                                                    EDIOrderStatusLine.SETRANGE("Source Doc. Type","Source Doc. Type");
                                                                    EDIOrderStatusLine.SETRANGE("Source Doc. No.","Source Doc. No.");
                                                                    EDIOrderStatusLine.SETRANGE("Document Type","Document Type");
                                                                    IF EDIOrderStatusLine.FIND('-') THEN
                                                                      REPEAT
                                                                        EDIOrderStatusLine."EDI Reason Code" := '';
                                                                        EDIOrderStatusLine.MODIFY;
                                                                      UNTIL EDIOrderStatusLine.NEXT = 0;
                                                                  END;

                                                                  IF EDIStatusCode.Line THEN BEGIN
                                                                    EDIOrderStatusLine.RESET;
                                                                    EDIOrderStatusLine.SETRANGE("Internal Doc. No.","Internal Doc. No.");
                                                                    EDIOrderStatusLine.SETRANGE("Export Version","Export Version");
                                                                    EDIOrderStatusLine.SETRANGE("Source Doc. Type","Source Doc. Type");
                                                                    EDIOrderStatusLine.SETRANGE("Source Doc. No.","Source Doc. No.");
                                                                    EDIOrderStatusLine.SETRANGE("Document Type","Document Type");
                                                                    IF EDIOrderStatusLine.FIND('-') THEN BEGIN
                                                                      IF NOT CONFIRM(Text001,FALSE) THEN
                                                                        EXIT;
                                                                      REPEAT
                                                                        EDIOrderStatusLine."EDI Reason Code" := "EDI Reason Code";
                                                                        EDIOrderStatusLine.MODIFY;
                                                                      UNTIL EDIOrderStatusLine.NEXT = 0;
                                                                    END;
                                                                  END;
                                                                END;
                                                              END;

                                                   OnLookup=BEGIN
                                                              CASE "Document Type" OF
                                                                "Document Type"::" ":
                                                                  NavisionDocument := 'E_SLSSTA';
                                                                "Document Type"::"Order Change Status":
                                                                  NavisionDocument := 'E_SLSPOC';
                                                                "Document Type"::"Advance P.O. Ack.":
                                                                  NavisionDocument := 'E_ADVPOA';
                                                              END;
                                                              EDIDocument.RESET;
                                                              EDIDocument.SETRANGE("Trade Partner No.","Trade Partner Code");
                                                              EDIDocument.SETFILTER(Status,'%1|%2',EDIDocument.Status::Test,EDIDocument.Status::Production);
                                                              EDIDocument.SETRANGE("Navision Document",NavisionDocument);
                                                              EDIDocument.SETRANGE(Type,EDIDocument.Type::Export);
                                                              IF NOT EDIDocument.FIND('-') THEN
                                                                ERROR(
                                                                  Text002,
                                                                  NavisionDocument,"Trade Partner Code");

                                                              EDIStatusCode.RESET;
                                                              EDIStatusCode.SETRANGE("Trade Partner No.","Trade Partner Code");
                                                              EDIStatusCode.SETRANGE("EDI Document No.",EDIDocument."EDI Document No.");
                                                              EDIStatusCode.SETRANGE(Type,EDIStatusCode.Type::Reason);
                                                              EDIStatusCode.SETRANGE(Header,TRUE);
                                                              IF NOT EDIStatusCode.FIND('-') THEN
                                                                ERROR(Text004,"Trade Partner Code",EDIDocument."EDI Document No.");
                                                              IF PAGE.RUNMODAL(PAGE::"E.D.I. Status Codes",EDIStatusCode) = ACTION::LookupOK THEN
                                                                VALIDATE("EDI Reason Code",EDIStatusCode.Code);
                                                            END;

                                                   CaptionML=ENU=EDI Reason Code }
    { 25  ;   ;Expected Date       ;Date          ;OnValidate=BEGIN
                                                                EDIOrderStatusLine.RESET;
                                                                EDIOrderStatusLine.SETRANGE("Internal Doc. No.","Internal Doc. No.");
                                                                EDIOrderStatusLine.SETRANGE("Export Version","Export Version");
                                                                EDIOrderStatusLine.SETRANGE("Source Doc. Type","Source Doc. Type");
                                                                EDIOrderStatusLine.SETRANGE("Source Doc. No.","Source Doc. No.");
                                                                EDIOrderStatusLine.SETRANGE("Document Type","Document Type");
                                                                IF EDIOrderStatusLine.FIND('-') THEN BEGIN
                                                                  IF NOT CONFIRM(Text001,FALSE) THEN
                                                                    EXIT;
                                                                  REPEAT
                                                                    EDIOrderStatusLine."Expected Date" := "Expected Date";
                                                                    EDIOrderStatusLine.MODIFY;
                                                                  UNTIL EDIOrderStatusLine.NEXT = 0;
                                                                END;
                                                              END;

                                                   CaptionML=ENU=Expected Date }
    { 26  ;   ;Send Hdr. Status Only;Boolean      ;CaptionML=ENU=Send Hdr. Status Only }
    { 27  ;   ;Archive Version No. ;Integer       ;CaptionML=ENU=Archive Version No. }
    { 28  ;   ;Date Archived       ;Date          ;CaptionML=ENU=Date Archived }
    { 29  ;   ;Time Archived       ;Time          ;CaptionML=ENU=Time Archived }
    { 30  ;   ;Archived By         ;Code50        ;CaptionML=ENU=Archived By }
    { 31  ;   ;Order Change Status Generated;Boolean;
                                                   CaptionML=ENU=Order Change Status Generated }
    { 32  ;   ;Order Change Status Gen. Date;Date ;CaptionML=ENU=Order Change Status Gen. Date }
    { 33  ;   ;Order Change Status Gen. Time;Time ;CaptionML=ENU=Order Change Status Gen. Time }
    { 34  ;   ;EDI Released        ;Boolean       ;CaptionML=ENU=EDI Released }
    { 35  ;   ;Buyer Initiated Change;Boolean     ;CaptionML=ENU=Buyer Initiated Change;
                                                   Editable=No }
    { 36  ;   ;Assoc. Source Doc. Type;Option     ;CaptionML=ENU=Assoc. Source Doc. Type;
                                                   OptionCaptionML=ENU=Quote,Order,Invoice,Credit Memo,Blanket Order;
                                                   OptionString=Quote,Order,Invoice,Credit Memo,Blanket Order;
                                                   Editable=No }
    { 37  ;   ;Assoc. Source Doc. No.;Code20      ;OnLookup=VAR
                                                              SalesHeader@1240020000 : Record 36;
                                                            BEGIN
                                                              CASE "Assoc. Source Doc. Type" OF
                                                                "Assoc. Source Doc. Type"::Quote:
                                                                  BEGIN
                                                                    SalesHeader.RESET;
                                                                    SalesHeader.SETRANGE("Document Type",SalesHeader."Document Type"::Quote);
                                                                    SalesHeader.SETRANGE("No.","Assoc. Source Doc. No.");
                                                                    IF SalesHeader.FIND('-') THEN
                                                                      SalesHeader.SETRANGE("No.")
                                                                    ELSE
                                                                      SalesHeader.SETRANGE("No.");
                                                                    PAGE.RUN(PAGE::"Sales Quotes",SalesHeader,SalesHeader."No.")
                                                                  END;
                                                                "Assoc. Source Doc. Type"::Order:
                                                                  BEGIN
                                                                    SalesHeader.RESET;
                                                                    SalesHeader.SETRANGE("Document Type",SalesHeader."Document Type"::Order);
                                                                    SalesHeader.SETRANGE("No.","Assoc. Source Doc. No.");
                                                                    IF SalesHeader.FIND('-') THEN
                                                                      SalesHeader.SETRANGE("No.")
                                                                    ELSE
                                                                      SalesHeader.SETRANGE("No.");
                                                                    PAGE.RUN(PAGE::"Sales Order List",SalesHeader,SalesHeader."No.")
                                                                  END;
                                                              END;
                                                            END;

                                                   CaptionML=ENU=Assoc. Source Doc. No.;
                                                   Editable=No }
    { 38  ;   ;P.O. Change Processed;Boolean      ;CaptionML=ENU=P.O. Change Processed;
                                                   Editable=No }
    { 39  ;   ;P.O. Change Processed Time;Time    ;CaptionML=ENU=P.O. Change Processed Time;
                                                   Editable=No }
    { 40  ;   ;P.O. Change Processed Date;Date    ;CaptionML=ENU=P.O. Change Processed Date;
                                                   Editable=No }
    { 41  ;   ;Pricing Discrepancy ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Order Status Line" WHERE (Internal Doc. No.=FIELD(Internal Doc. No.),
                                                                                                Export Version=FIELD(Export Version),
                                                                                                Source Doc. Type=FIELD(Source Doc. Type),
                                                                                                Source Doc. No.=FIELD(Source Doc. No.),
                                                                                                Document Type=FIELD(Document Type),
                                                                                                Pricing Discrepancy=FILTER(Yes)));
                                                   CaptionML=ENU=Pricing Discrepancy;
                                                   Editable=No }
    { 42  ;   ;Cancel Released Order Update;Boolean;
                                                   CaptionML=ENU=Cancel Released Order Update;
                                                   Editable=No }
    { 43  ;   ;Sales Order Find Error;Boolean     ;CaptionML=ENU=Sales Order Find Error;
                                                   Editable=No }
    { 44  ;   ;Change Processed    ;Boolean       ;CaptionML=ENU=Change Processed;
                                                   Editable=No }
    { 45  ;   ;Released Order Cancellation;Boolean;CaptionML=ENU=Released Order Cancellation;
                                                   Editable=No }
  }
  KEYS
  {
    {    ;Trade Partner Code,Internal Doc. No.,Export Version,Source Doc. Type,Source Doc. No.,Document Type;
                                                   Clustered=Yes }
    {    ;Exported                                 }
    {    ;Internal Doc. No.,Source Doc. Type,Source Doc. No.,Exported }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      EDIOrderStatusLine@1240030000 : Record 14002401;
      Text001@1240030001 : TextConst 'ENU=Change this field on the Order Status Lines?';
      EDIStatusCode@1240030002 : Record 14002406;
      OrderStatusEntry@1240030004 : Record 14002407;
      EDISetupRetrieved@1240030005 : Boolean;
      EDISetup@1240030006 : Record 14002367;
      EDIDocument@1240020000 : Record 14002353;
      Text002@1240020001 : TextConst 'ENU=An active EDI Document %1 was not found for Trading Partner %2.';
      Text003@1240020003 : TextConst 'ENU=EDI Status Code, type Header not found for Trade Partner %1 EDI Document No. %2';
      Text004@1240020002 : TextConst 'ENU=EDI Reason Code, type Header not found for Trade Partner %1 EDI Document No. %2';
      NavisionDocument@1240020004 : Code[10];

    PROCEDURE GetEDISetup@1240030007();
    BEGIN
      IF NOT EDISetupRetrieved THEN BEGIN
        EDISetup.GET;
        EDISetupRetrieved := TRUE;
      END;
    END;

    PROCEDURE Order@1240030008(VAR OrderStatusHdr@1240030009 : Record 14002400);
    VAR
      SalesHeader@1240030010 : Record 36;
    BEGIN
      GetEDISetup;

      SalesHeader.RESET;
      SalesHeader.SETRANGE("Document Type",SalesHeader."Document Type"::Order);
      IF OrderStatusHdr."Buyer Initiated Change" THEN
        SalesHeader.SETRANGE("No.",OrderStatusHdr."Assoc. Source Doc. No.")
      ELSE
        SalesHeader.SETRANGE("No.",OrderStatusHdr."Source Doc. No.");
      IF EDISetup.ListView THEN
        PAGE.RUN(PAGE::"Sales Order List",SalesHeader)
      ELSE
        PAGE.RUN(PAGE::"Sales Order",SalesHeader);
    END;

    PROCEDURE Shipments@1240030011(VAR OrderStatusHdr@1240030012 : Record 14002400);
    VAR
      SalesShipmentHdr@1240030013 : Record 110;
    BEGIN
      GetEDISetup;

      SalesShipmentHdr.RESET;
      SalesShipmentHdr.SETCURRENTKEY("Order No.");
      IF OrderStatusHdr."Buyer Initiated Change" THEN
        SalesShipmentHdr.SETRANGE("Order No.",OrderStatusHdr."Assoc. Source Doc. No.")
      ELSE
        SalesShipmentHdr.SETRANGE("Order No.",OrderStatusHdr."Source Doc. No.");
      IF EDISetup.ListView THEN
        PAGE.RUN(PAGE::"Posted Sales Shipments",SalesShipmentHdr)
      ELSE
        PAGE.RUN(PAGE::"Posted Sales Shipment",SalesShipmentHdr);
    END;

    PROCEDURE OrderStatusEntries@1240030014(VAR EDIReceiveDocHdr@1240030015 : Record 14002358);
    VAR
      OrderStatusHdr@1240030016 : Record 14002400;
    BEGIN
      GetEDISetup;
      OrderStatusHdr.RESET;
      OrderStatusHdr.SETRANGE("Internal Doc. No.",EDIReceiveDocHdr."Internal Doc. No.");
      OrderStatusHdr.SETRANGE("Trade Partner Code",EDIReceiveDocHdr."Trade Partner No.");
      IF EDISetup.ListView THEN
        PAGE.RUN(PAGE::"Order Status List",OrderStatusHdr)
      ELSE
        PAGE.RUN(PAGE::"Order Status",OrderStatusHdr);
    END;

    BEGIN
    END.
  }
}

