OBJECT Table 14097491 DP Setup Process
{
  OBJECT-PROPERTIES
  {
    Date=03/27/19;
    Time=12:00:00 PM;
    Version List=UBP3.00;
  }
  PROPERTIES
  {
    OnInsert=BEGIN
               "Created By User" := USERID;
               Created := CURRENTDATETIME;
             END;

    OnModify=BEGIN
               "Last Modified User" := USERID;
               "Last Modified" := CURRENTDATETIME;
             END;

    CaptionML=ENU=DP Setup Process;
  }
  FIELDS
  {
    { 7   ;   ;Object Type to Run  ;Option        ;InitValue=Report;
                                                   OnValidate=BEGIN
                                                                IF "Object Type to Run" <> xRec."Object Type to Run" THEN
                                                                  VALIDATE("Object ID to Run",0);
                                                              END;

                                                   CaptionML=ENU=Object Type to Run;
                                                   OptionCaptionML=ENU=,,,Report,,Codeunit;
                                                   OptionString=,,,Report,,Codeunit }
    { 8   ;   ;Object ID to Run    ;Integer       ;TableRelation=AllObjWithCaption."Object ID" WHERE (Object Type=FIELD(Object Type to Run));
                                                   OnValidate=VAR
                                                                Object@1000 : Record 2000000058;
                                                              BEGIN
                                                                IF "Object ID to Run" <> 0 THEN
                                                                  Object.GET("Object Type to Run",'',"Object ID to Run");
                                                                CALCFIELDS("Object Name to Run");
                                                              END;

                                                   OnLookup=VAR
                                                              Object@1001 : Record 2000000058;
                                                              Objects@1000 : Page 358;
                                                            BEGIN
                                                              IF Object.GET("Object Type to Run",'',"Object ID to Run") THEN;
                                                              Object.FILTERGROUP(2);
                                                              Object.SETRANGE("Object Type","Object Type to Run");
                                                              Object.FILTERGROUP(0);
                                                              Objects.SETRECORD(Object);
                                                              Objects.SETTABLEVIEW(Object);
                                                              Objects.LOOKUPMODE := TRUE;
                                                              IF Objects.RUNMODAL = ACTION::LookupOK THEN BEGIN
                                                                Objects.GETRECORD(Object);
                                                                VALIDATE("Object ID to Run",Object."Object ID");
                                                              END;
                                                            END;

                                                   CaptionML=ENU=Object ID to Run }
    { 9   ;   ;Object Name to Run  ;Text250       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(AllObjWithCaption."Object Caption" WHERE (Object Type=FIELD(Object Type to Run),
                                                                                                                Object ID=FIELD(Object ID to Run)));
                                                   CaptionML=ENU=Object Name to Run;
                                                   Editable=No }
    { 10  ;   ;Process No.         ;Integer       ;InitValue=1;
                                                   CaptionML=ENU=Process No. }
    { 15  ;   ;Action Description  ;Text250       ;CaptionML=ENU=Action Description }
    { 20  ;   ;Error               ;Boolean       ;CaptionML=ENU=Error;
                                                   Editable=No }
    { 25  ;   ;Error Text          ;Text250       ;CaptionML=ENU=Error Text;
                                                   Editable=No }
    { 30  ;   ;Completed           ;Boolean       ;OnValidate=BEGIN
                                                                IF Completed THEN
                                                                  "Completed Date" := TODAY;
                                                              END;

                                                   CaptionML=ENU=Completed }
    { 35  ;   ;Completed Date      ;Date          ;CaptionML=ENU=Completed Date;
                                                   Editable=No }
    { 40  ;   ;Manually Marked Complete;Boolean   ;CaptionML=ENU=Manually Marked Complete;
                                                   Editable=No }
    { 45  ;   ;Last Modified User  ;Code80        ;CaptionML=ENU=Last Modified User;
                                                   Editable=No }
    { 46  ;   ;Last Modified       ;DateTime      ;CaptionML=ENU=Last Modified;
                                                   Editable=No }
    { 50  ;   ;Created By User     ;Code80        ;CaptionML=ENU=Created By User;
                                                   Editable=No }
    { 51  ;   ;Created             ;DateTime      ;CaptionML=ENU=Created;
                                                   Editable=No }
    { 60  ;   ;Manual Parameter    ;Text250       ;CaptionML=ENU=Manual Parameter }
    { 61  ;   ;Automated Parameter XML;BLOB       ;CaptionML=ENU=Automated Parameter XML }
  }
  KEYS
  {
    {    ;Process No.                             ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    PROCEDURE GetLastEntryNo@3() : Integer;
    VAR
      AFPSetupProcessEntry@1000 : Record 14097491;
    BEGIN
      AFPSetupProcessEntry.LOCKTABLE;
      IF AFPSetupProcessEntry.FINDLAST THEN
        EXIT(AFPSetupProcessEntry."Process No.")
      ELSE
        EXIT(1);
    END;

    BEGIN
    END.
  }
}

