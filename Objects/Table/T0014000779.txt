OBJECT Table 14000779 UPS WS Shipping Account
{
  OBJECT-PROPERTIES
  {
    Date=06/28/17;
    Time=12:00:00 PM;
    Version List=SE0.60.13;
  }
  PROPERTIES
  {
    CaptionML=ENU=UPS WS Shipping Account;
    LookupPageID=Page14050011;
  }
  FIELDS
  {
    { 1   ;   ;Account No.         ;Code6         ;TableRelation="UPSlink Shipping Agent Account"."Account No.";
                                                   CaptionML=ENU=Account No. }
    { 2   ;   ;Description         ;Text30        ;CaptionML=ENU=Description }
    { 3   ;   ;Postal Code         ;Code20        ;CaptionML=ENU=Postal Code }
    { 4   ;   ;Rating Option       ;Option        ;InitValue=Discount;
                                                   CaptionML=ENU=Rating Option;
                                                   OptionCaptionML=ENU=List,Discount;
                                                   OptionString=List,Discount }
    { 5   ;   ;Demo                ;Boolean       ;CaptionML=ENU=Demo }
    { 6   ;   ;Account Added       ;Boolean       ;CaptionML=ENU=Account Added;
                                                   Editable=No }
    { 7   ;   ;Invoice No.         ;Text15        ;CaptionML=ENU=Invoice No. }
    { 8   ;   ;Invoice Date        ;Date          ;CaptionML=ENU=Invoice Date }
    { 9   ;   ;Currency Code       ;Code3         ;InitValue=USD;
                                                   CaptionML=ENU=Currency Code }
    { 10  ;   ;Invoice Amount      ;Decimal       ;CaptionML=ENU=Invoice Amount }
    { 11  ;   ;Control ID          ;Text4         ;CaptionML=ENU=Control ID }
  }
  KEYS
  {
    {    ;Account No.                             ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      Text001@1240020001 : TextConst 'ENU=Account #%1 must also be setup in UPSlink Shipping Agent Accounts.';
      Text002@1240020000 : TextConst 'ENU=Please complete the UPS Web Service Registration process.';
      Text003@1240020002 : TextConst 'ENU=Please create a UPS WS Profile.';

    PROCEDURE AddAccountRequest@1240020000();
    VAR
      UPSlinkShippingAgentAcct@1240020001 : Record 14050005;
      UPSWSRegistration@1240020002 : Record 14000777;
      UPSWSTransaction@1240020000 : Codeunit 14000766;
    BEGIN
      IF NOT(UPSWSRegistration.GET) THEN
        ERROR(Text002)
      ELSE IF NOT(UPSWSRegistration."Registration Complete") THEN
        ERROR(Text002)
      ELSE BEGIN
        TESTFIELD("Account No.");
        TESTFIELD("Postal Code");
        IF NOT(UPSWSRegistration."Create UPS WS Profile") THEN
          ERROR(Text003);
      END;

      UPSlinkShippingAgentAcct.RESET;
      IF UPSlinkShippingAgentAcct.GET("Account No.") THEN
        UPSWSTransaction.AddAccountRequest(Rec)
      ELSE
        ERROR(Text001,
          "Account No.");
    END;

    BEGIN
    END.
  }
}

