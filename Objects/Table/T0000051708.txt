OBJECT Table 51708 Det. Comm. Ledg. Entry Buffer
{
  OBJECT-PROPERTIES
  {
    Date=07/01/20;
    Time=12:00:00 AM;
    Modified=Yes;
    Version List=TPZ000.00.00;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Det. Comm. Ledg. Entry Buffer;
               ESM=Mem. inter. mov. CV detallado;
               FRC=Tampon ‚criture CF d‚taill‚e;
               ENC=Detailed CV Ledg. Entry Buffer];
    LookupPageID=Page573;
    DrillDownPageID=Page573;
  }
  FIELDS
  {
    { 1   ;   ;Entry No.           ;Integer       ;CaptionML=[ENU=Entry No.;
                                                              ESM=N§ mov.;
                                                              FRC=Nø ‚criture;
                                                              ENC=Entry No.] }
    { 2   ;   ;Comm. Ledger Entry No.;Integer     ;CaptionML=[ENU=CV Ledger Entry No.;
                                                              ESM=N§ mov. CV;
                                                              FRC=Nø ‚criture CF;
                                                              ENC=CV Ledger Entry No.] }
    { 3   ;   ;Entry Type          ;Option        ;CaptionML=[ENU=Entry Type;
                                                              ESM=Tipo movimiento;
                                                              FRC=Type d'‚criture;
                                                              ENC=Entry Type];
                                                   OptionCaptionML=ENU=,Initial Entry;
                                                   OptionString=,Initial Entry }
    { 4   ;   ;Posting Date        ;Date          ;CaptionML=[ENU=Posting Date;
                                                              ESM=Fecha registro;
                                                              FRC=Date de report;
                                                              ENC=Posting Date] }
    { 5   ;   ;Document Type       ;Option        ;CaptionML=[ENU=Document Type;
                                                              ESM=Tipo documento;
                                                              FRC=Type de document;
                                                              ENC=Document Type];
                                                   OptionCaptionML=[ENU=" ,Payment,Invoice,Credit Memo,Finance Charge Memo,Reminder,Refund";
                                                                    ESM=" ,Pago,Factura,Nota cr‚dito,Docs. inter‚s,Recordatorio,Reembolso";
                                                                    FRC=" ,Paiement,Facture,Note de cr‚dit,Note de frais financiers,Rappel,Remboursement";
                                                                    ENC=" ,Payment,Invoice,Credit Memo,Finance Charge Memo,Reminder,Refund"];
                                                   OptionString=[ ,Payment,Invoice,Credit Memo,Finance Charge Memo,Reminder,Refund] }
    { 6   ;   ;Document No.        ;Code20        ;CaptionML=[ENU=Document No.;
                                                              ESM=N§ documento;
                                                              FRC=Nø de document;
                                                              ENC=Document No.] }
    { 7   ;   ;Amount              ;Decimal       ;CaptionML=[ENU=Amount;
                                                              ESM=Importe;
                                                              FRC=Montant;
                                                              ENC=Amount];
                                                   AutoFormatType=1 }
    { 9   ;   ;Account Type        ;Option        ;CaptionML=[ENU=Account Type;
                                                              ESM=Tipo mov.;
                                                              FRC=Type de compte;
                                                              ENC=Account Type];
                                                   OptionCaptionML=ENU=Mfr. Rep.,Location;
                                                   OptionString=Mfr. Rep.,Location }
    { 10  ;   ;Account No.         ;Code20        ;TableRelation=IF (Account Type=CONST(Mfr. Rep.)) "Mfr. Rep."
                                                                 ELSE IF (Account Type=CONST(Location)) Location;
                                                   CaptionML=[ENU=Account No.;
                                                              ESM=N§ cuenta;
                                                              FRC=Nø de compte;
                                                              ENC=Account No.] }
    { 11  ;   ;User ID             ;Code50        ;TableRelation=User."User Name";
                                                   OnLookup=VAR
                                                              UserMgt@1000 : Codeunit 418;
                                                            BEGIN
                                                              UserMgt.LookupUserID("User ID");
                                                            END;

                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=User ID;
                                                              ESM=Id. usuario;
                                                              FRC=Code utilisateur;
                                                              ENC=User ID] }
    { 12  ;   ;Source Code         ;Code10        ;TableRelation="Source Code";
                                                   CaptionML=[ENU=Source Code;
                                                              ESM=C¢d. origen;
                                                              FRC=Code d'origine;
                                                              ENC=Source Code] }
    { 13  ;   ;Transaction No.     ;Integer       ;CaptionML=[ENU=Transaction No.;
                                                              ESM=N§ asiento;
                                                              FRC=Nø transaction;
                                                              ENC=Transaction No.] }
    { 14  ;   ;Journal Batch Name  ;Code10        ;TestTableRelation=No;
                                                   CaptionML=[ENU=Journal Batch Name;
                                                              ESM=Nombre secci¢n diario;
                                                              FRC=Nom lot de journal;
                                                              ENC=Journal Batch Name] }
    { 21  ;   ;Initial Entry Global Dim. 1;Code20 ;CaptionML=[ENU=Initial Entry Global Dim. 1;
                                                              ESM=Dim. global mov. inicial 1;
                                                              FRC=Axe principal 1 ‚cr. initiale;
                                                              ENC=Initial Entry Global Dim. 1] }
    { 22  ;   ;Initial Entry Global Dim. 2;Code20 ;CaptionML=[ENU=Initial Entry Global Dim. 2;
                                                              ESM=Dim. global mov. inicial 2;
                                                              FRC=Axe principal 2 ‚cr. initiale;
                                                              ENC=Initial Entry Global Dim. 2] }
    { 35  ;   ;Initial Document Type;Option       ;CaptionML=[ENU=Initial Document Type;
                                                              ESM=Tipo documento inicial;
                                                              FRC=Type document initial;
                                                              ENC=Initial Document Type];
                                                   OptionCaptionML=[ENU=" ,Payment,Invoice,Credit Memo,Finance Charge Memo,Reminder,Refund";
                                                                    ESM=" ,Pago,Factura,Nota cr‚dito,Docs. inter‚s,Recordatorio,Reembolso";
                                                                    FRC=" ,Paiement,Facture,Note de cr‚dit,Note de frais financiers,Rappel,Remboursement";
                                                                    ENC=" ,Payment,Invoice,Credit Memo,Finance Charge Memo,Reminder,Refund"];
                                                   OptionString=[ ,Payment,Invoice,Credit Memo,Finance Charge Memo,Reminder,Refund] }
    { 50200;  ;Shortcut Dimension 5 Code;Code20   ;CaptionClass='1,2,5' }
  }
  KEYS
  {
    {    ;Entry No.                               ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    PROCEDURE InsertDtldCommLedgEntry@53(VAR DtldCommLedgEntryBuf@1000 : Record 51708;VAR CommLedgEntryBuf@1001 : Record 51707;InsertZeroAmout@1004 : Boolean);
    VAR
      NewDtldCommLedgEntryBuf@1002 : Record 51708;
      NextDtldBufferEntryNo@1003 : Integer;
    BEGIN
      IF (DtldCommLedgEntryBuf.Amount = 0) AND
         (NOT InsertZeroAmout)
      THEN
        EXIT;

      DtldCommLedgEntryBuf.TESTFIELD("Entry Type" );

      NewDtldCommLedgEntryBuf.INIT;
      NewDtldCommLedgEntryBuf := DtldCommLedgEntryBuf;

      IF NextDtldBufferEntryNo = 0 THEN BEGIN
        DtldCommLedgEntryBuf.RESET;
        IF DtldCommLedgEntryBuf.FINDLAST THEN
          NextDtldBufferEntryNo := DtldCommLedgEntryBuf."Entry No." + 1
        ELSE
          NextDtldBufferEntryNo := 1;
      END;

      DtldCommLedgEntryBuf.RESET;
      DtldCommLedgEntryBuf.SETRANGE("Comm. Ledger Entry No.",CommLedgEntryBuf."Entry No.");
      DtldCommLedgEntryBuf.SETRANGE("Entry Type",NewDtldCommLedgEntryBuf."Entry Type");
      DtldCommLedgEntryBuf.SETRANGE("Posting Date",NewDtldCommLedgEntryBuf."Posting Date");
      DtldCommLedgEntryBuf.SETRANGE("Document Type",NewDtldCommLedgEntryBuf."Document Type");
      DtldCommLedgEntryBuf.SETRANGE("Document No.",NewDtldCommLedgEntryBuf."Document No.");
      DtldCommLedgEntryBuf.SETRANGE("Account Type",NewDtldCommLedgEntryBuf."Account Type");
      DtldCommLedgEntryBuf.SETRANGE("Account No.",NewDtldCommLedgEntryBuf."Account No.");

      IF DtldCommLedgEntryBuf.FINDFIRST THEN BEGIN
        DtldCommLedgEntryBuf.Amount := DtldCommLedgEntryBuf.Amount + NewDtldCommLedgEntryBuf.Amount;
        DtldCommLedgEntryBuf.MODIFY;
      END ELSE BEGIN
        NewDtldCommLedgEntryBuf."Entry No." := NextDtldBufferEntryNo;
        NextDtldBufferEntryNo := NextDtldBufferEntryNo + 1;
        DtldCommLedgEntryBuf := NewDtldCommLedgEntryBuf;
        DtldCommLedgEntryBuf.INSERT;
      END;

      DtldCommLedgEntryBuf.RESET;
    END;

    PROCEDURE CopyFromCommJnlLine@2(CommJnlLine@1000 : Record 51705);
    BEGIN
      "Entry Type" := "Entry Type"::"Initial Entry";
      "Posting Date" := CommJnlLine."Posting Date";
      "Document Type" := CommJnlLine."Document Type";
      "Document No." := CommJnlLine."Document No.";
      Amount := CommJnlLine.Amount;
      "Account Type" := CommJnlLine."Account Type";
      "Account No." := CommJnlLine."Account No.";
      "User ID" := USERID;
      "Initial Entry Global Dim. 1" := CommJnlLine."Shortcut Dimension 1 Code";
      "Initial Entry Global Dim. 2" := CommJnlLine."Shortcut Dimension 2 Code";
      "Shortcut Dimension 5 Code" := CommJnlLine."Shortcut Dimension 5 Code";
      "Initial Document Type" := CommJnlLine."Document Type";
    END;

    PROCEDURE InitFromCommJnlLine@7(CommJnlLine@1001 : Record 51705);
    BEGIN
      INIT;
      "Posting Date" := CommJnlLine."Posting Date";
      "Document Type" := CommJnlLine."Document Type";
      "Document No." := CommJnlLine."Document No.";
      "User ID" := USERID;
    END;

    PROCEDURE CopyFromCommLedgEntryBuf@20(CommLedgEntryBuf@1001 : Record 51707);
    BEGIN
      "Comm. Ledger Entry No." := CommLedgEntryBuf."Entry No.";
      "Account Type" := CommLedgEntryBuf."Account Type";
      "Account No." := CommLedgEntryBuf."Account No.";
      "Initial Entry Global Dim. 1" := CommLedgEntryBuf."Global Dimension 1 Code";
      "Initial Entry Global Dim. 2" := CommLedgEntryBuf."Global Dimension 2 Code";
      "Shortcut Dimension 5 Code" := CommLedgEntryBuf."Shortcut Dimension 5 Code";
      "Initial Document Type" := CommLedgEntryBuf."Document Type";
    END;

    PROCEDURE InitDtldCommLedgEntryBuf@26(CommJnlLine@1000 : Record 51705;VAR CommLedgEntryBuf@1001 : Record 51707;VAR DtldCommLedgEntryBuf@1002 : Record 51708;EntryType@1009 : Option;AmountFCY@1000000001 : Decimal;AppliedEntryNo@1000000002 : Integer);
    BEGIN
      WITH DtldCommLedgEntryBuf DO BEGIN
        InitFromCommJnlLine(CommJnlLine);
        CopyFromCommLedgEntryBuf(CommLedgEntryBuf);
        "Entry Type" := EntryType;
        Amount := AmountFCY;
        InsertDtldCommLedgEntry(DtldCommLedgEntryBuf,CommLedgEntryBuf,FALSE);
      END;
    END;

    BEGIN
    {
      2015-05-11 TPZ92 TAKHMETO
        Table has been created
    }
    END.
  }
}

