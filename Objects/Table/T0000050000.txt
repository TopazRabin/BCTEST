OBJECT Table 50000 Stock Status Wksh. Line
{
  OBJECT-PROPERTIES
  {
    Date=06/16/21;
    Time=[ 3:07:33 AM];
    Modified=Yes;
    Version List=TOP010,130,230,010E,RS1.04,TPZ2531,TPZ2839,TPZ2785,001,002,TPZ2970,TPZ3090,TPZ3168,TPZ3163,3189,005;
  }
  PROPERTIES
  {
  }
  FIELDS
  {
    { 2   ;   ;Sell-to Customer No.;Code20         }
    { 6   ;   ;Item No.            ;Code20        ;TableRelation=Item }
    { 7   ;   ;Location Code       ;Code10        ;TableRelation=Location.Code WHERE (Use As In-Transit=CONST(No)) }
    { 8   ;   ;Base Unit of Measure;Code10        ;TableRelation="Item Unit of Measure".Code WHERE (Item No.=FIELD(Item No.)) }
    { 11  ;   ;Description         ;Text50         }
    { 12  ;   ;Description 2       ;Text70         }
    { 19  ;   ;Order Date          ;Date           }
    { 22  ;   ;Unit Price          ;Decimal       ;AutoFormatType=2 }
    { 23  ;   ;Unit Cost           ;Decimal       ;AutoFormatType=2 }
    { 32  ;   ;Vendor Item No.     ;Text30         }
    { 54  ;   ;Blocked             ;Boolean        }
    { 84  ;   ;Qty. on Purch. Order;Decimal       ;DecimalPlaces=0:5;
                                                   Editable=No }
    { 85  ;   ;Qty. on Sales Order ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Sales Line"."Outstanding Qty. (Base)" WHERE (Document Type=CONST(Order),
                                                                                                                 Type=CONST(Item),
                                                                                                                 No.=FIELD(Item No.),
                                                                                                                 Location Code=FIELD(Location Code),
                                                                                                                 Drop Shipment=CONST(No)));
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 95  ;   ;Country/Region of Origin Code;Code10;
                                                   TableRelation=Country/Region;
                                                   CaptionML=[ENU=Country/Region of Origin Code;
                                                              ESM=C¢d. pa¡s/regi¢n de origen;
                                                              FRC=Code pays/r‚gion origine;
                                                              ENC=Country/Region of Origin Code] }
    { 800 ;   ;Location Filter     ;Code10        ;FieldClass=FlowFilter;
                                                   TableRelation=Location }
    { 5701;   ;Manufacturer Code   ;Code10        ;TableRelation=Manufacturer;
                                                   CaptionML=[ENU=Manufacturer Code;
                                                              ESM=C¢d. fabricante;
                                                              FRC=Code fabricant;
                                                              ENC=Manufacturer Code] }
    { 5709;   ;Item Category Code  ;Code10        ;TableRelation="Item Category";
                                                   CaptionML=[ENU=Item Category Code;
                                                              ESM=C¢d. categor¡a producto;
                                                              FRC=Code cat‚gorie;
                                                              ENC=Item Category Code] }
    { 5712;   ;Product Group Code  ;Code10        ;TableRelation="Product Group".Code WHERE (Item Category Code=FIELD(Item Category Code));
                                                   CaptionML=[ENU=Product Group Code;
                                                              ESM=C¢d. grupo producto;
                                                              FRC=Code groupe produits;
                                                              ENC=Product Group Code] }
    { 5777;   ;Qty. on Pick Loc.   ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Warehouse Activity Line"."Qty. Outstanding (Base)" WHERE (Activity Type=CONST(Pick),
                                                                                                                              Item No.=FIELD(Item No.),
                                                                                                                              Location Code=FIELD(Location Code),
                                                                                                                              Action Type=FILTER(' '|Take),
                                                                                                                              Breakbulk No.=CONST(0)));
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 50000;  ;Quantity Available on Location;Decimal;
                                                   DecimalPlaces=0:5 }
    { 50001;  ;Main Loc. Qty. Avail;Decimal       ;DecimalPlaces=0:5 }
    { 50002;  ;Last Quoted Unit Price;Decimal     ;AutoFormatType=2 }
    { 50003;  ;Last Quoted UOM     ;Code10        ;TableRelation="Item Unit of Measure".Code WHERE (Item No.=FIELD(Item No.)) }
    { 50004;  ;Last Quoted Qty.    ;Decimal       ;DecimalPlaces=0:5 }
    { 50005;  ;Current Qty.        ;Decimal       ;DecimalPlaces=0:5 }
    { 50006;  ;Current UOM         ;Code10        ;TableRelation="Item Unit of Measure".Code WHERE (Item No.=FIELD(Item No.)) }
    { 50007;  ;Last Unit Price     ;Decimal       ;AutoFormatType=2 }
    { 50008;  ;Last Price UOM      ;Code10        ;Editable=No }
    { 50009;  ;Last Price Qty.     ;Decimal       ;DecimalPlaces=0:5;
                                                   Editable=No }
    { 50010;  ;Last Reason Code    ;Code10        ;TableRelation="Reason Code" }
    { 50011;  ;Last Reason Code Comment;Text60     }
    { 50012;  ;Last Lost Opportunity;Boolean       }
    { 50013;  ;Last Price Date     ;Date          ;Editable=No }
    { 50014;  ;Last Invoice Price  ;Decimal       ;AutoFormatType=2 }
    { 50015;  ;Last Invoiced Qty.  ;Decimal       ;DecimalPlaces=0:5 }
    { 50016;  ;Cust. Qty. on SO    ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Sales Line"."Outstanding Qty. (Base)" WHERE (Document Type=CONST(Order),
                                                                                                                 Type=CONST(Item),
                                                                                                                 Sell-to Customer No.=FIELD(Sell-to Customer No.),
                                                                                                                 No.=FIELD(Item No.),
                                                                                                                 Location Code=FIELD(Location Code),
                                                                                                                 Drop Shipment=CONST(No)));
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 50017;  ;Qty. on Hand        ;Decimal       ;DecimalPlaces=0:5;
                                                   BlankZero=Yes }
    { 50018;  ;Total Qty. on Hand  ;Decimal       ;DecimalPlaces=0:5;
                                                   Editable=No }
    { 50019;  ;Qty. Avail. to Pick ;Decimal       ;FieldClass=Normal;
                                                   DecimalPlaces=0:5 }
    { 50020;  ;Promotion Code      ;Code10         }
    { 50021;  ;Curr. Unit Price Starting Date;Date }
    { 50022;  ;Curr. Unit Price Ending Date;Date   }
    { 50023;  ;Low Unit Price      ;Decimal       ;AutoFormatType=2 }
    { 50024;  ;High Unit Price     ;Decimal       ;OnValidate=BEGIN
                                                                "MSRP Price" := "High Unit Price"*1.6;//TPZ3090
                                                              END;

                                                   AutoFormatType=2 }
    { 50025;  ;Last Price Change Date;Date         }
    { 50026;  ;Lost Opportunity    ;Boolean        }
    { 50027;  ;Reason Code         ;Code10        ;TableRelation="Reason Code" WHERE (Order Type=FILTER(Quote|Stock Status));
                                                   OnValidate=BEGIN

                                                                IF ReasonCode.GET("Reason Code") AND (ReasonCode.Type = ReasonCode.Type::"Lost Opportunity") THEN BEGIN
                                                                  "Lost Opportunity" := TRUE;
                                                                  "Lost Opportunity Description" := ReasonCode.Description; //TOP230 KT ABCSI CRP 2 Fixes 06022015
                                                                END ELSE CLEAR("Lost Opportunity");
                                                              END;
                                                               }
    { 50028;  ;Reason Code Comment ;Text60         }
    { 50029;  ;Lost Opportunity Description;Text50 }
    { 50030;  ;Medium Unit Price   ;Decimal       ;CaptionML=ENU=Clearance Price;
                                                   Description=TPZ3168;
                                                   AutoFormatType=2 }
    { 50031;  ;Last Price User ID  ;Code50        ;TableRelation=User."User Name";
                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   Description=TOP010E }
    { 50032;  ;Pre Increase Unit Price;Decimal    ;Description=TPZ2447 }
    { 50033;  ;Post Increase Unit Price;Decimal   ;Description=TPZ2447 }
    { 50034;  ;Special Price       ;Boolean       ;DataClassification=ToBeClassified;
                                                   Description=TPZ2970 }
    { 50040;  ;Blocked Sequence    ;Boolean       ;Description=TOP130 }
    { 50100;  ;Shortcut Dimension 5 Code;Code20   ;OnLookup=BEGIN
                                                              LookupShortcutDimCode(5,"Shortcut Dimension 5 Code");
                                                            END;

                                                   CaptionClass='1,2,5' }
    { 50202;  ;Recomm. Unit Price  ;Decimal       ;Description=TOP230;
                                                   AutoFormatType=2 }
    { 50206;  ;Recomm. Multiplier  ;Decimal       ;DecimalPlaces=3:3;
                                                   MinValue=0;
                                                   MaxValue=1;
                                                   Description=TOP230 }
    { 50300;  ;Average Unit Cost   ;Decimal       ;OnValidate=BEGIN
                                                                //MESSAGE('Pankaj');
                                                              END;

                                                   DataClassification=ToBeClassified;
                                                   DecimalPlaces=2:4;
                                                   Description=TPZ2881;
                                                   Editable=No }
    { 50301;  ;Replacement Cost    ;Decimal       ;DataClassification=ToBeClassified;
                                                   DecimalPlaces=2:4;
                                                   Description=TPZ3189;
                                                   Editable=No }
    { 50302;  ;Replacement Margin  ;Decimal       ;DataClassification=ToBeClassified;
                                                   Description=TPZ3189;
                                                   Editable=No }
    { 51017;  ;MSRP Price          ;Decimal       ;DataClassification=ToBeClassified;
                                                   Description=TPZ3090 }
    { 51077;  ;Sorting Order       ;Integer       ;CaptionML=ENU=Sorting Order }
    { 51078;  ;Temp Order No.      ;Code10        ;CaptionML=ENU=Temp Order No. }
    { 51079;  ;ABC Code            ;Code10        ;TableRelation="ABC Code";
                                                   DataClassification=ToBeClassified;
                                                   CaptionML=ENU=ABC Code;
                                                   Description=TPZ2839 }
    { 51080;  ;Item Attribute Value ID;Integer    ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Item Attribute Value Mapping"."Item Attribute Value ID" WHERE (Table ID=FILTER(27),
                                                                                                                                      No.=FIELD(Item No.),
                                                                                                                                      Item Attribute ID=FILTER(1)));
                                                   Description=TPZ2859;
                                                   Editable=No }
    { 51081;  ;Scaled Date         ;Date          ;DataClassification=ToBeClassified;
                                                   Description=TPZ3163;
                                                   Editable=No }
  }
  KEYS
  {
    {    ;Item No.                                ;Clustered=Yes }
    {    ;Blocked Sequence                         }
    {    ;Sorting Order                            }
    {    ;Vendor Item No.                          }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      SRSetup@1000000000 : Record 311;
      ReasonCode@1000000001 : Record 231;
      "****ABCSI Globals****"@1000000003 : Integer;
      DimMgt@1000000002 : Codeunit 408;

    PROCEDURE UpDateLostOpportunity@1000000000("Order Type"@1000000004 : 'Quote,Order,Stock Status';VAR "Order No."@1000000005 : Code[20];"LineNo."@1000000006 : Integer;WorkSheet@1000000010 : Record 50001;LocationCode@1000000007 : Code[10]);
    VAR
      LostOpporunity@1000000000 : Record 50002;
      NoSeriesMgr@1000000001 : Codeunit 396;
      UOMMgt@1000000011 : Codeunit 5402;
      Item@1000000012 : Record 27;
      "LostNo."@1000000002 : Code[10];
      QperUOM@1000000013 : Decimal;
    BEGIN
      IF "Order No." = '' THEN BEGIN
        SRSetup.GET;
        SRSetup.TESTFIELD("Lost Opportunity Nos.");
        EVALUATE("LostNo.",SRSetup."Lost Opportunity Nos.");
        NoSeriesMgr.InitSeries("LostNo.",SRSetup."Lost Opportunity Nos.",TODAY,"Order No.","LostNo.");
      END;
      IF NOT LostOpporunity.GET("Order Type","Order No.","LineNo.") THEN BEGIN
        LostOpporunity.INIT;
        LostOpporunity."Document Type" := "Order Type";
        LostOpporunity."Document No." := "Order No.";
        LostOpporunity."Line No." := "LineNo.";
        LostOpporunity.INSERT;
      END;
      IF Item.GET(WorkSheet."Item No.") THEN
        QperUOM := UOMMgt.GetQtyPerUnitOfMeasure(Item,WorkSheet."Last Price UOM")
      ELSE QperUOM := 1;
      LostOpporunity."Sell-to Customer No." := WorkSheet."Sell-To Customer No.";
      LostOpporunity.Type := LostOpporunity.Type::Item;
      LostOpporunity."No." := WorkSheet."Item No.";
      LostOpporunity."Location Code" := LocationCode;
      LostOpporunity."Shipment Date" := TODAY;
      LostOpporunity."Lost Date" := TODAY;
      LostOpporunity."Unit of Measure Code" := WorkSheet."Current UOM";
      LostOpporunity.Quantity := WorkSheet."Current Qty.";
      LostOpporunity."Quantity(Base)" := WorkSheet."Current Qty." * QperUOM;
      LostOpporunity."Actual Unit Price" := WorkSheet."Last Unit Price";
      LostOpporunity."Reason Code" := WorkSheet."Reason Code";
      LostOpporunity."Reason Code Comment" := WorkSheet."Reason Code Comment";
      LostOpporunity."User ID" := USERID;
      LostOpporunity.MODIFY;
    END;

    PROCEDURE "****ABCSI Functions****"@1000000001();
    BEGIN
    END;

    PROCEDURE LookupShortcutDimCode@28(FieldNumber@1000 : Integer;VAR ShortcutDimCode@1001 : Code[20]);
    BEGIN

      DimMgt.LookupDimValueCode(FieldNumber,ShortcutDimCode);
    END;

    BEGIN
    {
      TOP010 KT ABCSI Stock Status Quick Quote Screen 12082014
        - Main table for Stock Status Quick Quote
      TOP130 KT ABCSI Item List Sort and Filter by Status 04082015
        - Added a new field "Blocked Sequence"
      TOP230 KT ABCSI CRP 2 Fixes 05202015
        - Set the AutoFormatType property to 2 for pricing/cost fields
        - Added new fields "Recomm. Unit Price", "Recomm. Multiplier"
        - code to populate Reason Code Comment on OnValidate trigger of Reason Code field
        - Added a new field Lost Opportunity Description
      TOP010E KT ABCSI Additional Stock Status 07282015
        - Added a new field 'Last Price User ID'
      2015-06-19 TPZ591 VCHERNYA
        Sorting Order field has been created
      2016-03-09 TPZ1470 TAKHMETO
        Temp Order No. field added
      2016-07-08 TPZ1545 EBAGIM
        Add NPI Blocking option to Blocked field
      2018.11.09 BUG2386 RIS  - revamp code to eliminate error failures
      2018-11-20 TPZ2447 AKUMAR
        Added "Pre Increase Unit Price" and "Post Increase Unit Price"
      2019-05-03 TPZ2531 UCHOUHAN
        Removed NPI Blocked option
      2020-05-13 TPZ2839 UCHOUHAN
        Added new field 'ABC Code'.
      TPZ2785 05112020 GGUPTA Remove Item blocking Topaz Customization
      TPZ2859 05192020 RSAH
        - Filter Item by attribute on the stock status screen
      001 TPZ2881 PKS 07232020  Added new fields Average Unit Cost and Gross Margin % Avg Cost
      001 TPZ2970 VAH 11252020 Added new field : Special Price
      003 TPZ3168 GKG 05052021 Change the caption of 'Medium Unit Price' field to 'Clearance Price'
      004 TPZ3189 PKS 05252021 Added Replacemnt cost field
      005 TPZ3163 UTK 06162021 Added new Field 'Scaled Date'.
    }
    END.
  }
}

