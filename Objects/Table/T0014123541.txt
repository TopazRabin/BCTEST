OBJECT Table 14123541 ES NAS Process Entry
{
  OBJECT-PROPERTIES
  {
    Date=12/14/18;
    Time=12:00:00 PM;
    Version List=ES1.41.56;
  }
  PROPERTIES
  {
    OnInsert=BEGIN
               TESTFIELD(Status,Status::"On Hold");

               IF "Entry No." = 0 THEN BEGIN
                 ESNASProcessEntry.RESET;
                 IF NOT ESNASProcessEntry.FIND('+') THEN
                   CLEAR(ESNASProcessEntry);

                 "Entry No." := ESNASProcessEntry."Entry No." + 1;
               END;

               "Creation Date Time" := CURRENTDATETIME;
               "Created By User" := USERID;
             END;

    OnModify=BEGIN
               TESTFIELD(Status,Status::"On Hold");
             END;

    OnRename=BEGIN
               TESTFIELD(Status,Status::"On Hold");
             END;

    CaptionML=ENU=NAS Process Entry;
  }
  FIELDS
  {
    { 1   ;   ;Entry No.           ;Integer       ;CaptionML=ENU=Entry No. }
    { 11  ;   ;Type                ;Option        ;CaptionML=ENU=Type;
                                                   OptionCaptionML=ENU=" ,Get New Data and Publish,Get New Data,Publish,Live Restore Point,Easy Security Restore Point,Update FLADS Lookup Data,Copy FLADS Setup Data,Copy Windows Groups";
                                                   OptionString=[ ,Get New Data and Publish,Get New Data,Publish,Live Restore Point,Easy Security Restore Point,Update FLADS Lookup Data,Copy FLADS Setup Data,Copy Windows Groups] }
    { 12  ;   ;Description         ;Text250       ;CaptionML=ENU=Description }
    { 13  ;   ;Creation Date Time  ;DateTime      ;CaptionML=ENU=Creation Date Time;
                                                   Editable=No }
    { 14  ;   ;Start Date Time     ;DateTime      ;CaptionML=ENU=Start Date Time;
                                                   Editable=No }
    { 15  ;   ;End Date Time       ;DateTime      ;CaptionML=ENU=End Date Time;
                                                   Editable=No }
    { 16  ;   ;Status              ;Option        ;InitValue=On Hold;
                                                   CaptionML=ENU=Status;
                                                   OptionCaptionML=ENU=Ready,In Process,Error,On Hold,Finished;
                                                   OptionString=Ready,In Process,Error,On Hold,Finished;
                                                   Editable=No }
    { 18  ;   ;Created By User     ;Code50        ;CaptionML=ENU=Created By User;
                                                   Editable=No }
    { 19  ;   ;Last Modified By User;Code50       ;CaptionML=ENU=Last Modified By User;
                                                   Editable=No }
    { 20  ;   ;Error Text          ;Text250       ;CaptionML=ENU=Error Text;
                                                   Editable=No }
  }
  KEYS
  {
    {    ;Entry No.                               ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      ESNASProcessEntry@1240520008 : Record 14123541;
      Text001@1001 : TextConst 'ENU=Add Job Queue Entry?';

    PROCEDURE ResetStatus@1240520008(ASkToAddJobQueueEntry@1240520003 : Boolean;AddJobQueueEntry@1240520001 : Boolean);
    VAR
      ESNASHandler@1240520002 : Codeunit 14123508;
    BEGIN
      TESTFIELD(Type);

      IF ASkToAddJobQueueEntry THEN
        AddJobQueueEntry := CONFIRM(Text001,AddJobQueueEntry);

      Status := Status::Ready;
      "Error Text" := '';
      MODIFY;

      IF AddJobQueueEntry THEN
        ESNASHandler.CreateJobQueueEntry;
    END;

    PROCEDURE ProcessNASEntries@1240520009();
    VAR
      ESNASProcessEntry@1240520010 : Record 14123541;
      JobQueueEntry@1240520008 : Record 472;
      ESNASHandler@1240520009 : Codeunit 14123508;
    BEGIN
      ESNASProcessEntry.RESET;
      ESNASProcessEntry.SETRANGE(Status,ESNASProcessEntry.Status::Ready);
      ESNASProcessEntry.FIND('-');

      CLEAR(JobQueueEntry);
      ESNASHandler.RUN(JobQueueEntry);
    END;

    BEGIN
    END.
  }
}

