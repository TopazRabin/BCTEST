OBJECT XMLport 50045 Item_ABC Code_Change
{
  OBJECT-PROPERTIES
  {
    Date=07/01/20;
    Time=12:00:00 AM;
    Modified=Yes;
    Version List=NAVW18.00;
  }
  PROPERTIES
  {
    CaptionML=ENU=Import/Export Permission Sets;
    Format=Variable Text;
  }
  ELEMENTS
  {
    { [{9AA0C0BD-F3C1-48AD-A2FB-A38EAC807F76}];  ;Root                ;Element ;Text     }

    { [{8040A803-A933-4F6A-8F74-82563FC17C1C}];1 ;integer             ;Element ;Table   ;
                                                  SourceTable=Table2000000026;
                                                  AutoSave=No;
                                                  AutoReplace=Yes;
                                                  Import::OnBeforeModifyRecord=BEGIN
                                                                                 //<TPZ2248>
                                                                                 IF ItemModify.GET(ItemNo) THEN BEGIN
                                                                                    LineNo := 0;
                                                                                    Des2 := '';
                                                                                    Des2 := ItemModify."Description 2";
                                                                                    ItemModify.VALIDATE("Description 2",'Transitioned to US replacement');
                                                                                    ItemModify.VALIDATE(ItemModify."ABC Code",'DIS');
                                                                                    ItemModify.MODIFY;
                                                                                    {
                                                                                    IF Des2 <> '' THEN BEGIN
                                                                                      CommentLine.RESET;
                                                                                      CommentLine.SETRANGE("Table Name",CommentLine."Table Name"::Item);
                                                                                      CommentLine.SETRANGE("No.",ItemNo);
                                                                                      IF CommentLine.FINDLAST THEN
                                                                                        LineNo := CommentLine."Line No." + 10000
                                                                                      ELSE
                                                                                        LineNo := 10000;

                                                                                      CommentLineInsert.RESET;
                                                                                      CommentLineInsert.INIT;
                                                                                      CommentLineInsert."Table Name" := CommentLineInsert."Table Name"::Item;
                                                                                      CommentLineInsert."No." := ItemNo;
                                                                                      CommentLineInsert."Line No." := LineNo;
                                                                                      CommentLineInsert.Date := TODAY;
                                                                                      CommentLineInsert.Comment := Des2;
                                                                                      CommentLineInsert.INSERT;
                                                                                    END;
                                                                                    }
                                                                                 END;
                                                                                 //</TPZ2248>
                                                                               END;
                                                                                }

    { [{2612CEEB-5154-4A67-8BD3-734A00CA077A}];2 ;ItemNo              ;Element ;Text    ;
                                                  DataType=Code }

  }
  EVENTS
  {
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      ItemModify@1000 : Record 27;
      Des2@1000000000 : Text[250];
      CommentLine@1000000001 : Record 97;
      LineNo@1000000002 : Integer;
      CommentLineInsert@1000000003 : Record 97;

    BEGIN
    {
      2018-03-17 TPZ2248 Dkumar
        New data import XML port created.
    }
    END.
  }
}

