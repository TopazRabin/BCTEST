OBJECT XMLport 50061 Update Email Entry List
{
  OBJECT-PROPERTIES
  {
    Date=07/01/20;
    Time=12:00:00 AM;
    Modified=Yes;
    Version List=TPZ000.00.00;
  }
  PROPERTIES
  {
    OnPostXMLport=BEGIN
                    MESSAGE('Successfully Uploaded');
                  END;

    Format=Variable Text;
  }
  ELEMENTS
  {
    { [{9155BC16-2588-4CC4-A90F-34F19E9A964D}];  ;Root                ;Element ;Text     }

    { [{158FAA80-90D1-489F-97CE-BCCDE6C91EDA}];1 ;Integer             ;Element ;Table   ;
                                                  SourceTable=Table2000000026;
                                                  Temporary=Yes;
                                                  AutoReplace=Yes;
                                                  Import::OnBeforeModifyRecord=BEGIN
                                                                                 //EntryNo := 10000;
                                                                                 NextEntryNo := 0;
                                                                                 EMailListEntry.RESET;
                                                                                 EMailListEntry.SETFILTER("Table ID",'%1',18);
                                                                                 EMailListEntry.SETFILTER(Type,'%1',0);
                                                                                 EMailListEntry.SETRANGE(Code,ECode);
                                                                                 //EMailListEntry.ASCENDING()
                                                                                 IF   EMailListEntry.FINDLAST THEN// BEGIN
                                                                                    NextEntryNo := EMailListEntry."Entry No." + 10000;

                                                                                 EMailListEntry1.INIT;
                                                                                 EMailListEntry1."Table ID" := 18;
                                                                                 EMailListEntry1.Type := 0;
                                                                                 EMailListEntry1.Code := ECode;
                                                                                 EMailListEntry1."Entry No." := NextEntryNo;
                                                                                 EMailListEntry1.Name := Name;
                                                                                 EMailListEntry1."E-Mail" := EMail;
                                                                                 EMailListEntry1."Sales Shipment E-Mail" := EMailListEntry1."Sales Shipment E-Mail" :: CC;
                                                                                 EMailListEntry1."Shortcut Dimension 5 Code" := DivisionCode;
                                                                                 EMailListEntry1.INSERT;
                                                                                 //END
                                                                               END;
                                                                                }

    { [{48A48304-8264-4805-AC0D-FFB14468C978}];2 ;Name                ;Element ;Text     }

    { [{0270EA98-86F7-4D16-9AAE-878F0A36B3F3}];2 ;EMail               ;Element ;Text     }

    { [{E4B2E856-1A8A-4041-AA8F-4DDA98030AC3}];2 ;ECode               ;Element ;Text     }

    { [{C328FD81-5555-4B1F-854E-18CDF64597B1}];2 ;ASNEMail            ;Element ;Text     }

    { [{17485CF3-FA57-43B8-A84E-2AC69FFB2CFB}];2 ;DivisionCode        ;Element ;Text     }

  }
  EVENTS
  {
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      EMailListEntry@1000000000 : Record 14000908;
      EMailListEntry1@1000000002 : Record 14000908;
      EntryNo@1000000001 : Integer;
      NextEntryNo@1000000003 : Integer;

    BEGIN
    END.
  }
}

