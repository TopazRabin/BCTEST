OBJECT XMLport 50015 Import Hot Sheet Prices
{
  OBJECT-PROPERTIES
  {
    Date=05/01/21;
    Time=[ 3:16:11 AM];
    Modified=Yes;
    Version List=PRICE;
  }
  PROPERTIES
  {
    Format=Variable Text;
  }
  ELEMENTS
  {
    { [{29BD2CCB-3B4B-4B54-AFA1-7CA23C70F7B9}];  ;root                ;Element ;Text     }

    { [{34BBA0A1-C350-4644-8FB3-71AC9016EC92}];1 ;HotSheetPrice       ;Element ;Table   ;
                                                  SourceTable=Table2000000026;
                                                  Import::OnBeforeModifyRecord=VAR
                                                                                 TopazSetup@1000000000 : Record 50056;
                                                                                 UnitPriceVar@1000000001 : Decimal;
                                                                                 HotSheetPrice@1000000002 : Record 50017;
                                                                                 numvar@1000000003 : Integer;
                                                                               BEGIN
                                                                                 EVALUATE(UnitPriceVar,UnitPrice);
                                                                                 HotSheetPrice.RESET;
                                                                                 HotSheetPrice.SETRANGE(Code,HotSheetCode);
                                                                                 HotSheetPrice.SETRANGE("Item No.",ItemNo);
                                                                                 //HotSheetPrice.SETRANGE("Unit of Measure Code",UOMPara); //04/28/21 commented as the file has no UOM
                                                                                 IF HotSheetPrice.FINDFIRST THEN BEGIN
                                                                                   HotSheetPrice."Unit Price" := UnitPriceVar;
                                                                                   HotSheetPrice.MODIFY(TRUE);
                                                                                 END ELSE BEGIN
                                                                                   //-->test record to identify missing entry
                                                                                   TopazSetup.INIT;
                                                                                   TopazSetup.Option := HotSheetCode;
                                                                                   TopazSetup."Option Choice" := FORMAT(numvar);
                                                                                   TopazSetup."DefaultCode 20_1" := ItemNo;
                                                                                   TopazSetup."DefaultCode 20" := 'HOTSHEETPRICE';
                                                                                   TopazSetup.DefaultDecimal := UnitPriceVar;
                                                                                   IF TopazSetup.INSERT THEN;
                                                                                   numvar += 1;
                                                                                   //<--
                                                                                 END;
                                                                               END;
                                                                                }

    { [{3B7DD58B-1DCA-4D39-BFCE-A71F46CCA8A8}];2 ;HotSheetCode        ;Element ;Text    ;
                                                  DataType=Code }

    { [{46094D1B-577F-4C28-B16F-24B78B7D8B28}];2 ;ItemNo              ;Element ;Text    ;
                                                  DataType=Code }

    { [{7B2146E6-5A66-4D8C-B73D-2D44326F8D57}];2 ;UOM                 ;Element ;Text    ;
                                                  DataType=Code }

    { [{353CC82D-CF1B-4A11-B4CE-B002E87241C4}];2 ;UnitPrice           ;Element ;Text    ;
                                                  DataType=Decimal }

    { [{0F43B842-34A8-446D-B3D0-4EAE312F312A}];2 ;StartDate           ;Element ;Text    ;
                                                  DataType=Date }

    { [{1FDC06E2-6169-4B50-B9B0-349CC9E91E6E}];2 ;EndDate             ;Element ;Text    ;
                                                  DataType=Date }

  }
  EVENTS
  {
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {

    BEGIN
    END.
  }
}

