OBJECT XMLport 50064 Import Items Pictures
{
  OBJECT-PROPERTIES
  {
    Date=07/01/20;
    Time=12:00:00 AM;
    Modified=Yes;
    Version List=TPZ000.00.00;
  }
  PROPERTIES
  {
    CaptionML=ENU=Upload Prospect Contact Feeder;
    OnPostXMLport=BEGIN

                    MESSAGE('Successfully Uploaded');
                  END;

    Format=Variable Text;
  }
  ELEMENTS
  {
    { [{9AA0C0BD-F3C1-48AD-A2FB-A38EAC807F76}];  ;Root                ;Element ;Text     }

    { [{75F2EC91-9087-4E56-BD9A-4DF8EA1A2834}];1 ;integer             ;Element ;Table   ;
                                                  SourceTable=Table2000000026;
                                                  AutoSave=No;
                                                  AutoUpdate=No;
                                                  AutoReplace=Yes;
                                                  Import::OnBeforeModifyRecord=BEGIN

                                                                                 IF Item.GET(ItemNo) THEN BEGIN
                                                                                   FileName := '\\10.10.100.172\UserData\Images\'+FORMAT(Item."No.")+'.jpg';
                                                                                   //FileName := '\\10.10.100.191\UserData\Images 1\New folder\'+FORMAT(Item."No.")+'.jpg';
                                                                                   //FileName := '\\10.10.100.211\UserData\Images_PriceBook\'+FORMAT(Item."No.")+'.jpg';

                                                                                   IF FILE.EXISTS(FileName) THEN BEGIN
                                                                                     importFile.OPEN(FileName);
                                                                                     importFile.CREATEINSTREAM(imageInStream);
                                                                                     CLEAR(Item.Picture);
                                                                                     imageID := Item.Picture.IMPORTSTREAM(imageInStream, 'Image for item '+ FORMAT( Item."No."));
                                                                                     //MESSAGE(imageID);
                                                                                     Item."Picture grouping Item Number" := PicGrpItemNo;
                                                                                     Item.MODIFY;
                                                                                     importFile.CLOSE;
                                                                                   END;
                                                                                 END ELSE
                                                                                   currXMLport.SKIP
                                                                               END;
                                                                                }

    { [{BA12732E-E338-4D63-AB8E-2DB36B9C1E15}];2 ;ItemNo              ;Element ;Text     }

    { [{41B55017-7B1B-4DEF-8128-F1202B1F0497}];2 ;PicGrpItemNo        ;Element ;Text     }

  }
  EVENTS
  {
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      FileManagement@1000000006 : Codeunit 419;
      FileName@1000000005 : Text;
      ClientFileName@1000000004 : Text;
      importFile@1000000003 : File;
      imageInStream@1000000002 : InStream;
      imageID@1000000001 : GUID;
      item1@1000000000 : Record 27;
      Item@1000000007 : Record 27;

    BEGIN
    {
      2019-04-17 TPZ2534 UCHOUHAN
        Created new XMLport to update Item Pictures on Item Card.
    }
    END.
  }
}

