OBJECT XMLport 14000802 LTL Rate Import
{
  OBJECT-PROPERTIES
  {
    Date=06/28/17;
    Time=12:00:00 PM;
    Version List=SE0.55.13;
  }
  PROPERTIES
  {
    CaptionML=ENU=LTL Rate Import;
    DefaultFieldsValidation=No;
    OnPreXMLport=BEGIN
                   currXMLport.FILENAME := CurrDataportFilename;

                   IF NOT LTLRate.GET(LTLRate.Code) THEN BEGIN
                     LTLRate.Description := Text001;
                     LTLRate."Import File Name" := CurrDataportFilename;
                     LTLRate.INSERT;
                   END ELSE BEGIN
                     LTLRate."Import File Name" := CurrDataportFilename;
                     LTLRate.MODIFY;
                   END;

                   LTLRateLine.RESET;
                   LTLRateLine.SETRANGE("LTL Rate Code",LTLRate.Code);
                   IF LTLRateLine.FIND('+') THEN
                     IF CONFIRM(Text002,FALSE) THEN
                       LTLRateLine.DELETEALL;

                   IF NOT LTLRateLine.FIND('+') THEN BEGIN
                     LTLRateLine."LTL Rate Code" := LTLRate.Code;
                     LTLRateLine."Line No." := 0;
                   END;

                   Window.OPEN('LTL Rate Import\#1###### records processed.');
                 END;

    OnPostXMLport=BEGIN
                    MESSAGE(Text003,LinesImported);

                    Window.CLOSE;
                  END;

    Format=Variable Text;
  }
  ELEMENTS
  {
    { [{A7C30AE5-731B-4E75-8382-DBF4505BA6AF}];  ;LTLRateImport       ;Element ;Text     }

    { [{16E39F92-430A-471B-B7B0-5D61203663D2}];1 ;LTLRateLine         ;Element ;Table   ;
                                                  SourceTable=Table14000805;
                                                  SourceTableView=SORTING(Field1,Field2);
                                                  AutoSave=No;
                                                  Import::OnBeforeInsertRecord=BEGIN
                                                                                 LinesImported := LinesImported + 1;

                                                                                 LTLRateLine.INIT;
                                                                                 LTLRateLine."Line No." := LTLRateLine."Line No." + 100;
                                                                                 LTLRateLine.VALIDATE("LTL Freight Type","LTL Rate Line"."LTL Freight Type");
                                                                                 LTLRateLine.VALIDATE("From Zip Code Min","LTL Rate Line"."From Zip Code Min");
                                                                                 LTLRateLine.VALIDATE("From Zip Code Max","LTL Rate Line"."From Zip Code Max");
                                                                                 LTLRateLine.VALIDATE("To Country Code","LTL Rate Line"."To Country Code");
                                                                                 LTLRateLine.VALIDATE("To ZIP Code Min","LTL Rate Line"."To ZIP Code Min");
                                                                                 LTLRateLine.VALIDATE("To ZIP Code Max","LTL Rate Line"."To ZIP Code Max");
                                                                                 LTLRateLine.VALIDATE("Minimum Weight","LTL Rate Line"."Minimum Weight");
                                                                                 LTLRateLine.VALIDATE(Type,"LTL Rate Line".Type);
                                                                                 LTLRateLine.VALIDATE("Rate per 100 Pound","LTL Rate Line"."Rate per 100 Pound");
                                                                                 LTLRateLine.VALIDATE("Rebate %","LTL Rate Line"."Rebate %");
                                                                                 LTLRateLine.VALIDATE("Minimum Charge","LTL Rate Line"."Minimum Charge");
                                                                                 LTLRateLine.VALIDATE(Description,"LTL Rate Line".Description);
                                                                                 LTLRateLine.INSERT(TRUE);
                                                                               END;

                                                  Export::OnAfterGetRecord=BEGIN
                                                                             UpdateWindow;
                                                                           END;

                                                  Import::OnAfterInsertRecord=BEGIN
                                                                                UpdateWindow;
                                                                              END;

                                                  Import::OnBeforeModifyRecord=BEGIN
                                                                                 LinesImported := LinesImported + 1;

                                                                                 LTLRateLine.INIT;
                                                                                 LTLRateLine."Line No." := LTLRateLine."Line No." + 100;
                                                                                 LTLRateLine.VALIDATE("LTL Freight Type","LTL Rate Line"."LTL Freight Type");
                                                                                 LTLRateLine.VALIDATE("From Zip Code Min","LTL Rate Line"."From Zip Code Min");
                                                                                 LTLRateLine.VALIDATE("From Zip Code Max","LTL Rate Line"."From Zip Code Max");
                                                                                 LTLRateLine.VALIDATE("To Country Code","LTL Rate Line"."To Country Code");
                                                                                 LTLRateLine.VALIDATE("To ZIP Code Min","LTL Rate Line"."To ZIP Code Min");
                                                                                 LTLRateLine.VALIDATE("To ZIP Code Max","LTL Rate Line"."To ZIP Code Max");
                                                                                 LTLRateLine.VALIDATE("Minimum Weight","LTL Rate Line"."Minimum Weight");
                                                                                 LTLRateLine.VALIDATE(Type,"LTL Rate Line".Type);
                                                                                 LTLRateLine.VALIDATE("Rate per 100 Pound","LTL Rate Line"."Rate per 100 Pound");
                                                                                 LTLRateLine.VALIDATE("Rebate %","LTL Rate Line"."Rebate %");
                                                                                 LTLRateLine.VALIDATE("Minimum Charge","LTL Rate Line"."Minimum Charge");
                                                                                 LTLRateLine.VALIDATE(Description,"LTL Rate Line".Description);
                                                                                 LTLRateLine.INSERT(TRUE);
                                                                               END;
                                                                                }

    { [{BF969586-5910-46B0-9023-78C8D95958F2}];2 ;LTLFreightType      ;Element ;Field   ;
                                                  DataType=Code;
                                                  FieldValidate=No;
                                                  SourceField=LTL Rate Line::LTL Freight Type;
                                                  MinOccurs=Zero }

    { [{FF630A99-4CFA-4953-B13F-204FA95BD602}];2 ;FromZipCodeMin      ;Element ;Field   ;
                                                  DataType=Code;
                                                  FieldValidate=No;
                                                  SourceField=LTL Rate Line::From Zip Code Min;
                                                  MinOccurs=Zero }

    { [{43E3A7F3-13D6-4476-8EF2-418A7377B50B}];2 ;FromZipCodeMax      ;Element ;Field   ;
                                                  DataType=Code;
                                                  FieldValidate=No;
                                                  SourceField=LTL Rate Line::From Zip Code Max;
                                                  MinOccurs=Zero }

    { [{7F28B92E-F11E-4027-91F7-3D61F549F2A3}];2 ;ToCountryCode       ;Element ;Field   ;
                                                  DataType=Code;
                                                  FieldValidate=No;
                                                  SourceField=LTL Rate Line::To Country Code;
                                                  MinOccurs=Zero }

    { [{738417A2-D794-411F-8DED-B5CDB8ED040A}];2 ;ToZIPCodeMin        ;Element ;Field   ;
                                                  DataType=Code;
                                                  FieldValidate=No;
                                                  SourceField=LTL Rate Line::To ZIP Code Min;
                                                  MinOccurs=Zero }

    { [{CEB04A8F-C887-4581-8C46-8C469FA8ED59}];2 ;ToZIPCodeMax        ;Element ;Field   ;
                                                  DataType=Code;
                                                  FieldValidate=No;
                                                  SourceField=LTL Rate Line::To ZIP Code Max;
                                                  MinOccurs=Zero }

    { [{78799DE6-622F-4986-BF24-A7A9DE75353D}];2 ;MinimumWeight       ;Element ;Field   ;
                                                  DataType=Decimal;
                                                  FieldValidate=No;
                                                  SourceField=LTL Rate Line::Minimum Weight;
                                                  MinOccurs=Zero }

    { [{FD6F81B1-2963-4225-9126-97A9BC1961BE}];2 ;Type                ;Element ;Field   ;
                                                  DataType=Option;
                                                  FieldValidate=No;
                                                  SourceField=LTL Rate Line::Type;
                                                  MinOccurs=Zero }

    { [{5A36DC08-6E04-40C5-B4F5-2F0B0B328EB2}];2 ;FromState           ;Element ;Field   ;
                                                  DataType=Text;
                                                  FieldValidate=No;
                                                  SourceField=LTL Rate Line::From State;
                                                  MinOccurs=Zero }

    { [{0129AFEF-ABB1-4853-AD97-67D7CAB582CA}];2 ;ToState             ;Element ;Field   ;
                                                  DataType=Text;
                                                  FieldValidate=No;
                                                  SourceField=LTL Rate Line::To State;
                                                  MinOccurs=Zero }

    { [{089D62B0-6387-476F-AE57-10B6EE540AF6}];2 ;Rateper100Pound     ;Element ;Field   ;
                                                  DataType=Decimal;
                                                  FieldValidate=No;
                                                  SourceField=LTL Rate Line::Rate per 100 Pound;
                                                  MinOccurs=Zero }

    { [{CC41C7FF-DC6F-4AD8-BE6A-FDA1132E6F0E}];2 ;Rebate              ;Element ;Field   ;
                                                  DataType=Decimal;
                                                  FieldValidate=No;
                                                  SourceField=LTL Rate Line::Rebate %;
                                                  MinOccurs=Zero }

    { [{9596208B-15E0-4130-87CF-CAD530600707}];2 ;MinimumCharge       ;Element ;Field   ;
                                                  DataType=Decimal;
                                                  FieldValidate=No;
                                                  SourceField=LTL Rate Line::Minimum Charge;
                                                  MinOccurs=Zero }

    { [{C56F2809-B75D-470B-962C-2FC2CFC0D5AD}];2 ;Description         ;Element ;Field   ;
                                                  DataType=Text;
                                                  FieldValidate=No;
                                                  SourceField=LTL Rate Line::Description;
                                                  MinOccurs=Zero }

  }
  EVENTS
  {
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      SaveValues=Yes;
    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=ENU=Options }

      { 1   ;2   ;Field     ;
                  AssistEdit=Yes;
                  CaptionML=ENU=File Name;
                  SourceExpr=CurrDataportFilename }

      { 3   ;2   ;Field     ;
                  CaptionML=ENU=LTL Rate Code;
                  SourceExpr=LTLRate.Code;
                  TableRelation="LTL Rate" }

    }
  }
  CODE
  {
    VAR
      Window@1241120000 : Dialog;
      x@1241120001 : Integer;
      LTLRate@1000000000 : Record 14000804;
      LTLRateLine@1000000001 : Record 14000805;
      CurrDataportFilename@1000000002 : Text[250];
      LinesImported@1000000004 : Integer;
      Text001@1001 : TextConst 'ENU=Imported';
      Text002@1002 : TextConst 'ENU=LTL Rate Lines already exists. Do you want Delete the old lines.';
      Text003@1003 : TextConst 'ENU=%1 LTL Rate Lines imported.';

    PROCEDURE UpdateWindow@1240020001();
    BEGIN
      x := x + 1;
      IF ((ROUND(x/1000,1) - (x/1000)) = 0) THEN
        Window.UPDATE(1,x);
    END;

    BEGIN
    END.
  }
}

