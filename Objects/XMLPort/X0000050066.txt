OBJECT XMLport 50066 Update Email Entry List1
{
  OBJECT-PROPERTIES
  {
    Date=07/01/20;
    Time=12:00:00 AM;
    Modified=Yes;
    Version List=TPZ000.00.00;
  }
  PROPERTIES
  {
    OnPostXMLport=BEGIN
                    MESSAGE('Successfully Uploaded');
                  END;

    Format=Variable Text;
  }
  ELEMENTS
  {
    { [{9155BC16-2588-4CC4-A90F-34F19E9A964D}];  ;Root                ;Element ;Text     }

    { [{158FAA80-90D1-489F-97CE-BCCDE6C91EDA}];1 ;Integer             ;Element ;Table   ;
                                                  SourceTable=Table2000000026;
                                                  Temporary=Yes;
                                                  AutoReplace=Yes;
                                                  Import::OnBeforeModifyRecord=BEGIN
                                                                                 NextEntryNo:= 0;
                                                                                 EMailListEntry.RESET;
                                                                                 EMailListEntry.SETRANGE("Table ID",18);
                                                                                 EMailListEntry.SETFILTER(Type,'%1',0);
                                                                                 EMailListEntry.SETFILTER(Code,ECode);
                                                                                 IF   EMailListEntry.FINDLAST THEN
                                                                                    NextEntryNo := EMailListEntry."Entry No." + 10000;

                                                                                 EMailListEntry2.RESET;
                                                                                 EMailListEntry2.SETRANGE("Table ID",18);
                                                                                 EMailListEntry2.SETFILTER(Type,'%1',0);
                                                                                 EMailListEntry2.SETFILTER(Code,ECode);
                                                                                 EMailListEntry2.SETFILTER("Shortcut Dimension 5 Code",'L');
                                                                                 //EMailListEntry2.SETFILTER("Sales Quote Conf. E-Mail",'<>%1',0);
                                                                                 IF EMailListEntry2.FINDLAST THEN;
                                                                                   IF EMailListEntry2.FINDFIRST THEN BEGIN
                                                                                    FOR i := 1 TO EMailListEntry2.COUNT DO BEGIN
                                                                                     IF (EMailListEntry2."Sales Quote Conf. E-Mail" = EMailListEntry."Sales Quote Conf. E-Mail" :: "To") OR
                                                                                       (EMailListEntry2."Sales Quote Conf. E-Mail" = EMailListEntry."Sales Quote Conf. E-Mail" :: CC) OR
                                                                                       (EMailListEntry2."Sales Quote Conf. E-Mail" = EMailListEntry."Sales Quote Conf. E-Mail" :: BCC) THEN BEGIN

                                                                                       IF (EMailListEntry2."Sales Shipment E-Mail" <> 0) OR (EMailListEntry2."Sales Invoice E-Mail" <> 0) OR
                                                                                          (EMailListEntry2."Sales Order Conf. E-Mail" <> 0) OR (EMailListEntry2."Bill of Lading E-Mail" <> 0) OR
                                                                                          (EMailListEntry2."Customer Statement E-Mail" <> 0) OR (EMailListEntry2."Sales Invoice Conf. E-Mail" <> 0) OR
                                                                                          (EMailListEntry2."Sales Credit Memo Conf. E-Mail" <> 0) OR
                                                                                          (EMailListEntry2."Sales Bl. Order Conf. E-Mail" <> 0) OR (EMailListEntry2."Sales Ret. Order Conf. E-Mail" <> 0) OR
                                                                                          (EMailListEntry2."Purchase Quote Conf. E-Mail" <> 0) OR (EMailListEntry2."Purch. Bl. Order Conf. E-Mail" <> 0) OR
                                                                                          (EMailListEntry2."Purchase Order Conf. E-Mail" <> 0) OR
                                                                                          (EMailListEntry2."Purchase Invoice Conf. E-Mail" <> 0) OR (EMailListEntry2."Purchase Cr. Memo Conf. E-Mail" <> 0) OR
                                                                                          (EMailListEntry2."Purch. Ret. Order Conf. E-Mail" <> 0) OR
                                                                                          (EMailListEntry2."Issued Reminder E-Mail" <> 0) OR
                                                                                          (EMailListEntry2."Issued Fin. Charge Memo E-Mail" <> 0) OR
                                                                                          (EMailListEntry2."Purchase Receipt E-Mail" <> 0) OR
                                                                                          (EMailListEntry2."Purchase Invoice E-Mail" <> 0) OR
                                                                                          (EMailListEntry2."ProForma Invoice E-Mail" <> 0) OR
                                                                                          (EMailListEntry2."Sales Credit Memo E-Mail" <> 0) OR
                                                                                          (EMailListEntry2."Mfr. Rep. Statement E-Mail" <> 0) OR
                                                                                          (EMailListEntry2."Loc. Hdlg. Statement E-Mail" <> 0)
                                                                                          THEN BEGIN
                                                                                           EMailListEntry1.INIT;
                                                                                           EMailListEntry1."Table ID" := 18;
                                                                                           EMailListEntry1.Type := 0;
                                                                                           EMailListEntry1.Code := ECode;
                                                                                           EMailListEntry1."Entry No." := NextEntryNo;
                                                                                           EMailListEntry1.Name := EMailListEntry2.Name;
                                                                                           EMailListEntry1."E-Mail" := EMailListEntry2."E-Mail";
                                                                                           EMailListEntry1."Sales Quote Conf. E-Mail" := EMailListEntry2."Sales Quote Conf. E-Mail";
                                                                                           EMailListEntry1."Shortcut Dimension 5 Code" := EMailListEntry2."Shortcut Dimension 5 Code";
                                                                                           EMailListEntry1."Use for Ship-to/Order Address" := EMailListEntry2."Use for Ship-to/Order Address";
                                                                                           EMailListEntry1.INSERT;
                                                                                           NextEntryNo := NextEntryNo + 10000;

                                                                                           EMailListEntry2."Sales Quote Conf. E-Mail" := EMailListEntry2."Sales Quote Conf. E-Mail" ::" ";
                                                                                           EMailListEntry2."Shortcut Dimension 5 Code" := '';
                                                                                           EMailListEntry2.MODIFY;
                                                                                       END;
                                                                                     END;
                                                                                           EMailListEntry2.NEXT;
                                                                                    END;
                                                                                   END;
                                                                               END;
                                                                                }

    { [{E4B2E856-1A8A-4041-AA8F-4DDA98030AC3}];2 ;ECode               ;Element ;Text     }

  }
  EVENTS
  {
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      EMailListEntry@1000000000 : Record 14000908;
      EMailListEntry1@1000000002 : Record 14000908;
      EntryNo@1000000001 : Integer;
      NextEntryNo@1000000003 : Integer;
      EMailListEntry2@1000000004 : Record 14000908;
      i@1000000005 : Integer;

    BEGIN
    END.
  }
}

