OBJECT XMLport 50009 ImportItemJnl-No-Bins
{
  OBJECT-PROPERTIES
  {
    Date=01/26/21;
    Time=[ 9:53:30 AM];
    Modified=Yes;
    Version List=TOP190,TPZHOTFIX;
  }
  PROPERTIES
  {
    PreserveWhiteSpace=Yes;
    TextEncoding=UTF-8;
    OnInitXMLport=BEGIN
                    LineNo:=0;
                    ItemTemplate:='ITEM';
                    ItemBatch:='DEFAULT';
                    PostingDate:=TODAY;
                  END;

    Format=Variable Text;
    FieldDelimiter=<None>;
    FieldSeparator=<TAB>;
  }
  ELEMENTS
  {
    { [{2E685AC5-1B3E-47E6-B065-93C6E719DDC8}];  ;ROOT                ;Element ;Text     }

    { [{38669EDA-EFB4-4FBF-A3AE-3077FF9FC79F}];1 ;ItemJnl             ;Element ;Table   ;
                                                  SourceTable=Table83;
                                                  Import::OnAfterInitRecord=BEGIN
                                                                                "Item Journal Line"."Journal Template Name":=ItemTemplate;
                                                                                "Item Journal Line"."Journal Batch Name":= ItemBatch;
                                                                                LineNo+=1000;
                                                                                "Item Journal Line"."Line No.":=LineNo;
                                                                                "Item Journal Line"."Entry Type":="Item Journal Line"."Entry Type"::"Positive Adjmt.";
                                                                                "Item Journal Line"."Document No.":=DocumentNo;
                                                                            END;

                                                  Import::OnBeforeInsertRecord=BEGIN
                                                                                 //IF "Item Journal Line".Quantity <= 0 THEN
                                                                                 //  currXMLport.SKIP;
                                                                                 "Item Journal Line".VALIDATE("Posting Date",PostingDate);

                                                                                 //"Item Journal Line".VALIDATE("Item No.");
                                                                                 IF LocRec.GET(LocationCode) THEN BEGIN
                                                                                   IF LocationMapping.GET(LocationCode) AND (LocationMapping."No." <> '') THEN
                                                                                     "Item Journal Line".VALIDATE("Location Code",LocationMapping."No.")
                                                                                   ELSE
                                                                                     "Item Journal Line".VALIDATE("Location Code",LocationCode);
                                                                                 END ELSE BEGIN
                                                                                   IF LocationMapping.GET(LocationCode) AND (LocationMapping."No." <> '') THEN BEGIN
                                                                                     {
                                                                                     IF LocationMapping."New Code" = '1T' THEN
                                                                                       "Item Journal Line".VALIDATE("Location Code",'1')
                                                                                     ELSE IF LocationMapping."New Code" = '25T' THEN
                                                                                       "Item Journal Line".VALIDATE("Location Code",'25')
                                                                                     ELSE IF LocationMapping."New Code" = '30T' THEN
                                                                                       "Item Journal Line".VALIDATE("Location Code",'30')
                                                                                     ELSE
                                                                                     }
                                                                                       "Item Journal Line".VALIDATE("Location Code",LocationMapping."No.")
                                                                                   END ELSE BEGIN
                                                                                     "Item Journal Line"."Location Code" := LocationCode
                                                                                   END;
                                                                                 END;


                                                                                 {
                                                                                 IF UnitCost <> '' THEN
                                                                                   "Item Journal Line".VALIDATE("Bin Code",UnitCost);

                                                                                 IF AssignDefBin AND (UnitCost = '') THEN
                                                                                   "Item Journal Line".VALIDATE("Bin Code",'ADJ');
                                                                                 }

                                                                                 EvalUnitCost := 0;
                                                                                 IF UnitCost <> '' THEN BEGIN
                                                                                   IF EVALUATE(EvalUnitCost,UnitCost) THEN BEGIN
                                                                                     "Item Journal Line"."Unit Cost" := EvalUnitCost;
                                                                                     "Item Journal Line"."Unit Amount" := EvalUnitCost;
                                                                                     //"Item Journal Line".UpdateAmount;  //PKS commented line and added new code to update amount, since the updateamount is local function in table
                                                                                     "Item Journal Line".Amount := ROUND("Item Journal Line".Quantity * "Item Journal Line"."Unit Amount");  //PKS
                                                                                   END;
                                                                                 END;
                                                                               END;
                                                                                }

    { [{E96BC882-6EFE-49E2-872D-7C4DD2003672}];2 ;LocationCode        ;Element ;Text    ;
                                                  DataType=Code }

    { [{1D932EB0-E54D-4D98-92FD-A0C915B26AE5}];2 ;ItemNo              ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=Item Journal Line::Item No. }

    { [{430DD5F6-CB7E-44BD-B20E-38B2B94D8F52}];2 ;BaseUOM             ;Element ;Text     }

    { [{064EBA48-5E43-4365-AEE4-4736DD36361C}];2 ;UnitCost            ;Element ;Text    ;
                                                  DataType=Decimal }

    { [{1AD85154-8C4A-49C0-B580-3FD7A5577F49}];2 ;Qty                 ;Element ;Field   ;
                                                  DataType=Decimal;
                                                  SourceField=Item Journal Line::Quantity }

  }
  EVENTS
  {
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
      { 1000000000;;Container;
                  Name=options;
                  ContainerType=ContentArea }

      { 1000000001;1;Field  ;
                  CaptionML=ENU=Item Jnl. Batch Name;
                  SourceExpr=ItemBatch;
                  TableRelation="Item Journal Batch".Name WHERE (Journal Template Name=FILTER(ITEM)) }

      { 1000000002;1;Field  ;
                  CaptionML=ENU=Posting Date;
                  SourceExpr=PostingDate }

      { 1000000003;1;Field  ;
                  CaptionML=ENU=Document No.;
                  SourceExpr=DocumentNo }

    }
  }
  CODE
  {
    VAR
      LineNo@1000000000 : Integer;
      ItemTemplate@1000000001 : Code[10];
      ItemBatch@1000000002 : Code[10];
      PostingDate@1000000003 : Date;
      DocumentNo@1000000004 : Code[20];
      LocRec@1000000005 : Record 14;
      ItemJnlLine@1000000006 : Record 83;
      LocationMapping@1000000007 : Record 50009;
      IJB@1000000008 : Record 233;
      EvalUnitCost@1000000009 : Decimal;
      BinRec@1000000013 : Record 7354;
      BinRec1@1000000012 : Record 7354;
      BinContent@1000000011 : Record 7302;
      BinContent1@1000000010 : Record 7302;

    BEGIN
    END.
  }
}

