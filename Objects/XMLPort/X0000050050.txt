OBJECT XMLport 50050 Send Inv
{
  OBJECT-PROPERTIES
  {
    Date=03/19/21;
    Time=[ 9:43:11 AM];
    Modified=Yes;
    Version List=NAVW18.00;
  }
  PROPERTIES
  {
    CaptionML=ENU=Import/Export Permission Sets;
    Format=Variable Text;
  }
  ELEMENTS
  {
    { [{9AA0C0BD-F3C1-48AD-A2FB-A38EAC807F76}];  ;Root                ;Element ;Text     }

    { [{8040A803-A933-4F6A-8F74-82563FC17C1C}];1 ;integer             ;Element ;Table   ;
                                                  SourceTable=Table2000000026;
                                                  AutoSave=No;
                                                  AutoReplace=Yes;
                                                  Import::OnBeforeModifyRecord=BEGIN
                                                                                 {IF InvoiceNo <> '' THEN
                                                                                   IF SalesInvoiceHeader.GET(InvoiceNo) THEN
                                                                                     IF SalesInvoiceHeader."E-Mail Invoice Notice Handled" = FALSE THEN
                                                                                       InvoiceNotificationHandling.GlobalTPZ_SendNotifications(InvoiceNo);}
                                                                                 //ELSE
                                                                                   //currXMLport.SKIP

                                                                                 {
                                                                                 SalesSetup.GET;
                                                                                 IF OrderNo <> '' THEN BEGIN
                                                                                  SalesShptHeader.RESET;
                                                                                  SalesShptHeader.SETRANGE("Order No.",OrderNo);
                                                                                  IF SalesShptHeader.FINDFIRST THEN BEGIN
                                                                                   REPEAT
                                                                                    IF SalesShptHeader."E-Mail Shipment Notice Handled" = FALSE THEN
                                                                                     EMailMgt.SendSalesShipmentNotice(SalesShptHeader,FALSE,FALSE);
                                                                                   UNTIL SalesShptHeader.NEXT = 0;
                                                                                  END;
                                                                                 END ELSE
                                                                                   currXMLport.SKIP;
                                                                                   }

                                                                                 SalesSetup.GET;
                                                                                 IF OrderNo <> '' THEN BEGIN
                                                                                  SalesInvoiceHeader.RESET;
                                                                                  SalesInvoiceHeader.SETRANGE("Order No.",OrderNo);
                                                                                  IF SalesInvoiceHeader.FINDFIRST THEN BEGIN
                                                                                   REPEAT
                                                                                    IF SalesInvoiceHeader."E-Mail Invoice Notice Handled" = FALSE THEN
                                                                                     InvoiceNotificationHandling.GlobalTPZ_SendNotifications(SalesInvoiceHeader."No.");
                                                                                   UNTIL SalesInvoiceHeader.NEXT = 0;
                                                                                  END;
                                                                                 END ELSE
                                                                                   currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{2612CEEB-5154-4A67-8BD3-734A00CA077A}];2 ;OrderNo             ;Element ;Text    ;
                                                  DataType=Code }

  }
  EVENTS
  {
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      ItemModify@1000 : Record 27;
      InvoiceNotificationHandling@1000000000 : Codeunit 50043;
      SalesInvoiceHeader@1000000001 : Record 112;
      SalesSetup@1000000002 : Record 311;
      SalesShptHeader@1000000003 : Record 110;
      EMailMgt@1000000005 : Codeunit 14000903;

    BEGIN
    END.
  }
}

