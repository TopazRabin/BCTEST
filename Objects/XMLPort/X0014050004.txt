OBJECT XMLport 14050004 UPSlink Standard List Rates
{
  OBJECT-PROPERTIES
  {
    Date=06/28/17;
    Time=12:00:00 PM;
    Version List=SE0.55.13;
  }
  PROPERTIES
  {
    CaptionML=ENU=UPSlink List Rates;
    DefaultFieldsValidation=No;
    OnInitXMLport=BEGIN
                    ShippingAgent.RESET;
                    ShippingAgent.SETRANGE("Shipper Type",ShippingAgent."Shipper Type"::UPS);
                    ShippingAgent.FIND('-');
                  END;

    OnPreXMLport=BEGIN
                   Window.OPEN('UPSlink Standard List Rates\#1###### records processed.');
                 END;

    OnPostXMLport=BEGIN
                    Window.CLOSE;
                  END;

    Format=Variable Text;
  }
  ELEMENTS
  {
    { [{F25664D3-0138-4352-BCA4-D2345025310A}];  ;UPSlinkStandardListRates;Element;Text  }

    { [{960AE4AC-B771-4E22-8CAE-CEC41929D360}];1 ;UPSlinkListRateChart;Element ;Table   ;
                                                  SourceTable=Table14050018;
                                                  SourceTableView=SORTING(Field1,Field2,Field3,Field4);
                                                  AutoUpdate=Yes;
                                                  Export::OnPreXMLItem=BEGIN
                                                                         "UPSlink List Rate Chart".RESET;
                                                                         "UPSlink List Rate Chart".DELETEALL;
                                                                       END;

                                                  Export::OnAfterGetRecord=BEGIN
                                                                             UpdateWindow;
                                                                           END;

                                                  Import::OnAfterInsertRecord=BEGIN
                                                                                UpdateWindow;
                                                                              END;
                                                                               }

    { [{78561CF8-BD72-4A3A-9D1F-F4F3A6297E79}];2 ;ServiceIndicator    ;Element ;Field   ;
                                                  DataType=Text;
                                                  FieldValidate=No;
                                                  SourceField=UPSlink List Rate Chart::Service Indicator;
                                                  MinOccurs=Zero }

    { [{1F724DEC-197E-4C1F-A32A-5EDE2F926438}];2 ;Zone                ;Element ;Field   ;
                                                  DataType=Code;
                                                  FieldValidate=No;
                                                  SourceField=UPSlink List Rate Chart::Zone;
                                                  MinOccurs=Zero }

    { [{2AC7DFB7-602F-4D1A-9FCB-8D63C35C07F4}];2 ;MaxWeight           ;Element ;Field   ;
                                                  DataType=Decimal;
                                                  FieldValidate=No;
                                                  SourceField=UPSlink List Rate Chart::Max. Weight;
                                                  MinOccurs=Zero }

    { [{9C32824B-0372-47E1-87D7-3FB7D5FF064D}];2 ;Amount              ;Element ;Field   ;
                                                  DataType=Decimal;
                                                  FieldValidate=No;
                                                  SourceField=UPSlink List Rate Chart::Amount;
                                                  MinOccurs=Zero }

    { [{15F9C520-067D-4085-85D0-5318FF81CD39}];2 ;MinimumAmount       ;Element ;Field   ;
                                                  DataType=Decimal;
                                                  FieldValidate=No;
                                                  SourceField=UPSlink List Rate Chart::Minimum Amount;
                                                  MinOccurs=Zero }

    { [{8A715A99-C012-4B99-8AF4-537109196A0B}];2 ;RateperPound        ;Element ;Field   ;
                                                  DataType=Boolean;
                                                  FieldValidate=No;
                                                  SourceField=UPSlink List Rate Chart::Rate per Pound;
                                                  MinOccurs=Zero }

    { [{29B3420D-E15D-4F28-BFE8-E55618D90AA8}];2 ;CustomerDefault     ;Element ;Field   ;
                                                  DataType=Boolean;
                                                  FieldValidate=No;
                                                  SourceField=UPSlink List Rate Chart::Customer Default;
                                                  MinOccurs=Zero }

    { [{9B9A7A29-F5B0-4DF9-8E55-58C69FA3B352}];2 ;Residential         ;Element ;Field   ;
                                                  DataType=Boolean;
                                                  FieldValidate=No;
                                                  SourceField=UPSlink List Rate Chart::Residential;
                                                  MinOccurs=Zero }

    { [{07A7CFF3-BEE3-4E4A-A39D-369D62FF1B8B}];1 ;UPSlinkHundredWgtListRate;Element;Table;
                                                  SourceTable=Table14050019;
                                                  SourceTableView=SORTING(Field1,Field2,Field3,Field4,Field5);
                                                  AutoUpdate=Yes;
                                                  Export::OnPreXMLItem=BEGIN
                                                                         "UPSlink HundredWgt List Rate".RESET;
                                                                         "UPSlink HundredWgt List Rate".DELETEALL;
                                                                       END;

                                                  Export::OnAfterGetRecord=BEGIN
                                                                             UpdateWindow;
                                                                           END;

                                                  Import::OnAfterInsertRecord=BEGIN
                                                                                UpdateWindow;
                                                                              END;
                                                                               }

    { [{092F08E7-93B3-471E-89A2-A2D7B592B99A}];2 ;ServiceIndicator    ;Element ;Field   ;
                                                  DataType=Text;
                                                  FieldValidate=No;
                                                  SourceField=UPSlink HundredWgt List Rate::Service Indicator;
                                                  MinOccurs=Zero }

    { [{EFD83CD9-0C24-4E39-B0DD-4E8FC45A88E2}];2 ;Zone                ;Element ;Field   ;
                                                  DataType=Code;
                                                  FieldValidate=No;
                                                  SourceField=UPSlink HundredWgt List Rate::Zone;
                                                  MinOccurs=Zero }

    { [{116E6AD9-644D-43C3-9AB5-42783FAE80AA}];2 ;Tier                ;Element ;Field   ;
                                                  DataType=Code;
                                                  FieldValidate=No;
                                                  SourceField=UPSlink HundredWgt List Rate::Tier;
                                                  MinOccurs=Zero }

    { [{DD879D8C-469B-414D-95CA-6B9937491C38}];2 ;MinimumWeight       ;Element ;Field   ;
                                                  DataType=Decimal;
                                                  FieldValidate=No;
                                                  SourceField=UPSlink HundredWgt List Rate::Minimum Weight;
                                                  MinOccurs=Zero }

    { [{95D9D850-301C-4394-8D03-ED7076395518}];2 ;MaximumWeight       ;Element ;Field   ;
                                                  DataType=Decimal;
                                                  FieldValidate=No;
                                                  SourceField=UPSlink HundredWgt List Rate::Maximum Weight;
                                                  MinOccurs=Zero }

    { [{E06FEBD6-3BFF-41D4-B4F9-3FB3651EA0EE}];2 ;RateperPound        ;Element ;Field   ;
                                                  DataType=Decimal;
                                                  FieldValidate=No;
                                                  SourceField=UPSlink HundredWgt List Rate::Rate per Pound;
                                                  MinOccurs=Zero }

    { [{C93C73D3-0744-40F8-B6C8-80E76259FDE6}];2 ;WorldWideService    ;Element ;Field   ;
                                                  DataType=Boolean;
                                                  FieldValidate=No;
                                                  SourceField=UPSlink HundredWgt List Rate::World Wide Service;
                                                  MinOccurs=Zero }

    { [{E4C8748A-4F81-45B4-B26B-B53FEFFBDA0C}];2 ;Residential         ;Element ;Field   ;
                                                  DataType=Boolean;
                                                  FieldValidate=No;
                                                  SourceField=UPSlink HundredWgt List Rate::Residential;
                                                  MinOccurs=Zero }

    { [{C20E73D4-E30E-400D-9134-ABC0EEBF2880}];2 ;MinTierCharge       ;Element ;Field   ;
                                                  DataType=Decimal;
                                                  FieldValidate=No;
                                                  SourceField=UPSlink HundredWgt List Rate::Min. Tier Charge;
                                                  MinOccurs=Zero }

    { [{B42D4F20-A75B-4D10-BE74-F993D7D614A4}];2 ;MaxTierCharge       ;Element ;Field   ;
                                                  DataType=Decimal;
                                                  FieldValidate=No;
                                                  SourceField=UPSlink HundredWgt List Rate::Max. Tier Charge;
                                                  MinOccurs=Zero }

    { [{FF1698B1-A8A7-4805-8A06-23F4CA55FE65}];2 ;MinWgtPerPackage    ;Element ;Field   ;
                                                  DataType=Decimal;
                                                  FieldValidate=No;
                                                  SourceField=UPSlink HundredWgt List Rate::Min Wgt. Per Package;
                                                  MinOccurs=Zero }

    { [{652B5E7A-64C8-4CBA-968E-8BDFDA738639}];1 ;UPSShippingZone     ;Element ;Table   ;
                                                  SourceTable=Table14000766;
                                                  SourceTableView=SORTING(Field1,Field2);
                                                  AutoSave=No;
                                                  AutoUpdate=Yes;
                                                  Import::OnBeforeInsertRecord=BEGIN
                                                                                 IF COPYSTR("UPS Shipping Zone".Zone,1,2) = 'HW' THEN BEGIN
                                                                                   UpdateHWMinPkgWt(
                                                                                     COPYSTR(
                                                                                       "UPS Shipping Zone".Zone,3,1),"UPS Shipping Zone"."Service Indicator",
                                                                                       "UPS Shipping Zone"."Minimum Hundred Weight");
                                                                                 //  currXMLport.SKIP;
                                                                                 END;
                                                                                   currXMLport.SKIP;
                                                                               END;

                                                  Export::OnAfterGetRecord=BEGIN
                                                                             UpdateWindow;
                                                                           END;

                                                  Import::OnAfterInsertRecord=BEGIN
                                                                                UpdateWindow;
                                                                              END;

                                                  Import::OnBeforeModifyRecord=BEGIN
                                                                                 IF COPYSTR("UPS Shipping Zone".Zone,1,2) = 'HW' THEN BEGIN
                                                                                   UpdateHWMinPkgWt(
                                                                                     COPYSTR(
                                                                                       "UPS Shipping Zone".Zone,3,1),"UPS Shipping Zone"."Service Indicator",
                                                                                       "UPS Shipping Zone"."Minimum Hundred Weight");
                                                                                 //  currXMLport.SKIP;
                                                                                 END;
                                                                                   currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{AE0356CF-7A64-4BF9-83DF-AA35609368D3}];2 ;ServiceIndicator    ;Element ;Field   ;
                                                  DataType=Text;
                                                  FieldValidate=No;
                                                  SourceField=UPS Shipping Zone::Service Indicator;
                                                  MinOccurs=Zero }

    { [{A931FBDB-FD35-4198-BE80-2D804A1A09F2}];2 ;Zone                ;Element ;Field   ;
                                                  DataType=Code;
                                                  FieldValidate=No;
                                                  SourceField=UPS Shipping Zone::Zone;
                                                  MinOccurs=Zero }

    { [{3C374C35-2D56-44D8-A61B-767E370C9D4C}];2 ;MinimumHundredWeight;Element ;Field   ;
                                                  DataType=Decimal;
                                                  FieldValidate=No;
                                                  SourceField=UPS Shipping Zone::Minimum Hundred Weight;
                                                  MinOccurs=Zero }

    { [{9364BEB4-1777-4CDD-9EEC-4837321A93BC}];2 ;HundredWeightAvailable;Element;Field  ;
                                                  DataType=Boolean;
                                                  FieldValidate=No;
                                                  SourceField=UPS Shipping Zone::Hundred Weight Available;
                                                  MinOccurs=Zero }

  }
  EVENTS
  {
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      Window@1240020000 : Dialog;
      x@1240020001 : Integer;
      ShippingAgent@1000000000 : Record 291;

    PROCEDURE UpdateWindow@1240020001();
    BEGIN
      x := x + 1;
      IF ((ROUND(x/1000,1) - (x/1000)) = 0) THEN
        Window.UPDATE(1,x);
    END;

    PROCEDURE UpdateHWMinPkgWt@1240030000(HWTier@1240030002 : Code[10];ServiceIndicator@1240030001 : Text[2];MinPackageWt@1240030000 : Decimal);
    VAR
      Window@1240020000 : Dialog;
      x@1240020001 : Integer;
      UPSHWListRatesService@1240030003 : Record 14050019;
    BEGIN
      UPSHWListRatesService.RESET;
      UPSHWListRatesService.SETRANGE(Tier,HWTier);
      UPSHWListRatesService.SETRANGE("Service Indicator",ServiceIndicator);
      IF UPSHWListRatesService.FIND('-') THEN
        REPEAT
          UPSHWListRatesService."Min Wgt. Per Package" := MinPackageWt;
          UPSHWListRatesService.MODIFY;
        UNTIL UPSHWListRatesService.NEXT = 0;
    END;

    BEGIN
    END.
  }
}

