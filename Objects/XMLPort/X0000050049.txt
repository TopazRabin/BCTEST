OBJECT XMLport 50049 Upload Prospect Contact Feeder
{
  OBJECT-PROPERTIES
  {
    Date=07/01/20;
    Time=12:00:00 AM;
    Modified=Yes;
    Version List=NAVW18.00;
  }
  PROPERTIES
  {
    CaptionML=ENU=Upload Prospect Contact Feeder;
    OnPreXMLport=BEGIN
                   FirstLine := TRUE;

                   ContactFeederHeader.RESET;
                   IF ContactFeederHeader.FIND('+') THEN
                     EntryNo := ContactFeederHeader."Entry No.";

                   ContactFeederHeader.RESET;
                 END;

    OnPostXMLport=BEGIN

                    MESSAGE('Successfully Uploaded');
                  END;

    Format=Variable Text;
  }
  ELEMENTS
  {
    { [{9AA0C0BD-F3C1-48AD-A2FB-A38EAC807F76}];  ;Root                ;Element ;Text     }

    { [{75F2EC91-9087-4E56-BD9A-4DF8EA1A2834}];1 ;integer             ;Element ;Table   ;
                                                  SourceTable=Table2000000026;
                                                  AutoSave=No;
                                                  AutoReplace=Yes;
                                                  Import::OnBeforeModifyRecord=BEGIN
                                                                                 IF FirstLine THEN BEGIN
                                                                                   FirstLine := FALSE;
                                                                                   currXMLport.SKIP;
                                                                                 END;

                                                                                 FirstNameString := '';
                                                                                 LastNameString := '';
                                                                                 SpacePosition := 0;
                                                                                 LastPosition := 0;
                                                                                 FirstNameString1 :='';

                                                                                 EntryNo := EntryNo + 1;
                                                                                 ContactFeederHeader.INIT;
                                                                                 ContactFeederHeader."Entry No." := EntryNo;
                                                                                 ContactFeederHeader."Line No." := 0;
                                                                                 ContactFeederHeader.Type:= ContactFeederHeader.Type :: Prospect;
                                                                                 FirstNameString := DELCHR(Name,'<>',' ');
                                                                                 SpacePosition := STRPOS(FirstNameString,' ');
                                                                                 LastPosition  := STRLEN(FirstNameString);
                                                                                 FirstNameString1 := FirstNameString;
                                                                                 IF SpacePosition <> 0 THEN BEGIN
                                                                                  FirstNameString := COPYSTR(FirstNameString,1,SpacePosition-1);
                                                                                  LastNameString := COPYSTR(FirstNameString1,SpacePosition+1,LastPosition);
                                                                                 END ELSE BEGIN
                                                                                  FirstNameString := FirstNameString;
                                                                                  LastNameString := '';
                                                                                 END;
                                                                                 ContactFeederHeader."First Name" := FirstNameString;
                                                                                 ContactFeederHeader."Last Name" := LastNameString;
                                                                                 ContactFeederHeader."Customer Name" := FirstNameString + ' '+LastNameString;
                                                                                 ContactFeederHeader."E-Mail Address" := EmailAddress;

                                                                                 JobResponsibility.RESET;
                                                                                 JobResponsibility.SETRANGE(JobResponsibility.Description,CustomerIdentification);
                                                                                 IF JobResponsibility.FINDFIRST THEN
                                                                                   ContactFeederHeader."Job Responsibility" := CustomerIdentification
                                                                                 ELSE
                                                                                   ContactFeederHeader."Job Responsibility" := '';


                                                                                 ContactFeederHeader.INSERT(TRUE);
                                                                               END;
                                                                                }

    { [{BA12732E-E338-4D63-AB8E-2DB36B9C1E15}];2 ;DateText            ;Element ;Text     }

    { [{33BBA281-CB4F-4C96-9CE9-B3148805B059}];2 ;TimeText            ;Element ;Text     }

    { [{7505ED85-F2BF-42F6-9503-4AAAB0D427ED}];2 ;Name                ;Element ;Text     }

    { [{567F794C-88E9-46CD-8760-F38152A6C21F}];2 ;EmailAddress        ;Element ;Text     }

    { [{FC9A6AF5-E3F8-4FBC-B859-AAB9AD75291F}];2 ;CustomerIdentification;Element;Text    }

    { [{E9474A37-3105-4028-8AF6-DB2712DECC02}];2 ;PdfFileName         ;Element ;Text     }

    { [{BDED09A5-0356-4833-B942-9E496F57E174}];2 ;UserType            ;Element ;Text     }

  }
  EVENTS
  {
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      ContactFeederHeader@1000000001 : Record 50019;
      EntryNo@1000000000 : Integer;
      FirstNameString@1000000002 : Text;
      FirstNameString1@1000000006 : Text;
      LastNameString@1000000004 : Text;
      SpacePosition@1000000003 : Integer;
      LastPosition@1000000005 : Integer;
      JobResponsibility@1000000007 : Record 5066;
      FirstLine@1000000008 : Boolean;

    BEGIN
    {
      2018-05-16 TPZ2305 UCHOUHAN
        New data import XML port created.
    }
    END.
  }
}

