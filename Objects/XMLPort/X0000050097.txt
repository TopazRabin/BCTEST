OBJECT XMLport 50097 PVC Item Increase
{
  OBJECT-PROPERTIES
  {
    Date=04/22/21;
    Time=[ 1:27:42 PM];
    Modified=Yes;
    Version List=price;
  }
  PROPERTIES
  {
    Format=Variable Text;
  }
  ELEMENTS
  {
    { [{75FDE9AE-B95D-4A51-A7F4-7CB17A35B17F}];  ;Root                ;Element ;Text     }

    { [{1768536A-87A2-4C2B-93D1-85EA6DEE8533}];1 ;integer             ;Element ;Table   ;
                                                  SourceTable=Table2000000026;
                                                  AutoSave=No;
                                                  Import::OnBeforeInsertRecord=VAR
                                                                                 tmpBarcode1@1000000000 : Code[20];
                                                                                 tmpBarcode2@1000000001 : Code[20];
                                                                                 tmpBarcode3@1000000002 : Code[20];
                                                                                 item@1000000003 : Record 27;
                                                                                 barcodeConversion@1000000004 : Record 14000733;
                                                                                 itemvendor@1000000005 : Record 99;
                                                                                 ProductGroup@1000000006 : Record 5723;
                                                                                 tmpitem@1000000007 : Record 27;
                                                                                 CustomerDivision@1000000008 : Record 50007;
                                                                               BEGIN
                                                                                 IF ItemNo <> 'Item No.' THEN BEGIN
                                                                                   EVALUATE(PriceIncPerDecimal,PriceInc);
                                                                                   IF CostIncreaseBool THEN BEGIN
                                                                                     IF item.GET(ItemNo) THEN BEGIN
                                                                                       IF AvgCost = '#N/A' THEN BEGIN
                                                                                         item."Average Unit Cost" := item."Average Unit Cost" ;
                                                                                       END ELSE BEGIN
                                                                                         EVALUATE(AvgCostDec,AvgCost);
                                                                                         item."Average Unit Cost" := AvgCostDec;
                                                                                       END;
                                                                                       item.MODIFY;
                                                                                     END;
                                                                                   END;
                                                                                   //IF AvgCost = '#N/A' THEN
                                                                                     //PriceIncPerDecimal := 10;
                                                                                   IF PriceIncreaseBool THEN
                                                                                     PriceIncrease(ItemNo,PriceIncPerDecimal);
                                                                                 END;
                                                                               END;
                                                                                }

    { [{FFE43D35-7D3B-4D53-A1E3-5B101C7551DA}];2 ;ItemNo              ;Element ;Text     }

    { [{6705261F-596F-4BF4-B107-5D4DE61DC6C4}];2 ;AvgCost             ;Element ;Text     }

    { [{23BBCE40-030D-4EA0-8E96-36C785642790}];2 ;PriceInc            ;Element ;Text     }

  }
  EVENTS
  {
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
      { 1000000000;;Container;
                  Name=Filter;
                  ContainerType=ContentArea }

      { 1000000001;1;Field  ;
                  Name=Price Increase;
                  SourceExpr=PriceIncreaseBool }

      { 1000000002;1;Field  ;
                  Name=Cost Increase;
                  SourceExpr=CostIncreaseBool }

    }
  }
  CODE
  {
    VAR
      PriceIncPerDecimal@1000000000 : Decimal;
      Item@1000000001 : Record 27;
      AvgCostDec@1000000002 : Decimal;
      PriceIncreaseBool@1000000003 : Boolean;
      CostIncreaseBool@1000000004 : Boolean;

    LOCAL PROCEDURE PriceIncrease@1000000003(ItemCode1@1000000006 : Code[20];IncreasePer@1000000007 : Decimal);
    VAR
      ItemModify@1000000001 : Record 27;
      UnitPriceDec@1000000000 : Decimal;
      SalesPrice@1000000005 : Record 7002;
      HotSheetPrice@1000000004 : Record 50017;
      tmpsalepriceunitprice@1000000003 : Decimal;
      tmpsalepricehotsheet@1000000002 : Decimal;
    BEGIN

      IF ItemModify.GET(ItemCode1) THEN BEGIN
      //  IF NOT (ItemModify."No." IN ['3001','3002','3003']) THEN
      //  EXIT;
         UnitPriceDec:=IncreasePer;
         ItemModify.VALIDATE("Unit Price",((ItemModify."Unit Price")*(UnitPriceDec/100)+ItemModify."Unit Price"));
         ItemModify.MODIFY(TRUE);

         SalesPrice.SETRANGE("Item No.",ItemModify."No.");
         IF SalesPrice.FINDSET THEN
              REPEAT
                 tmpsalepriceunitprice:=(SalesPrice."Unit Price"*UnitPriceDec/100)+SalesPrice."Unit Price";
                 SalesPrice.VALIDATE("Unit Price",tmpsalepriceunitprice);
                 SalesPrice.MODIFY(TRUE);
               UNTIL SalesPrice.NEXT=0;

          HotSheetPrice.SETRANGE("Item No.",ItemModify."No.");
          IF HotSheetPrice.FINDSET THEN
              REPEAT
                 tmpsalepricehotsheet:=(HotSheetPrice."Unit Price"*UnitPriceDec/100)+HotSheetPrice."Unit Price";
                 HotSheetPrice.VALIDATE("Unit Price",tmpsalepricehotsheet);
                 HotSheetPrice.MODIFY(TRUE);
             UNTIL HotSheetPrice.NEXT=0;

      END;
    END;

    BEGIN
    END.
  }
}

