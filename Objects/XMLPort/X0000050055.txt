OBJECT XMLport 50055 Update Last Sales Price
{
  OBJECT-PROPERTIES
  {
    Date=07/01/20;
    Time=12:00:00 AM;
    Modified=Yes;
    Version List=TPZ000.00.00;
  }
  PROPERTIES
  {
    Format/Evaluate=C/SIDE Format/Evaluate;
    OnPostXMLport=BEGIN
                    MESSAGE('Successfully Uploaded');
                  END;

    Format=Variable Text;
  }
  ELEMENTS
  {
    { [{D3D279CB-C3A1-45C0-9085-B70209F70FD1}];  ;Root                ;Element ;Text     }

    { [{C585B59D-B170-4351-B52A-1576E09CE58A}];1 ;Integer             ;Element ;Table   ;
                                                  SourceTable=Table2000000026;
                                                  Temporary=Yes;
                                                  AutoSave=No;
                                                  MinOccurs=Zero;
                                                  Import::OnAfterInsertRecord=VAR
                                                                                tmpitem@1000000000 : Record 27;
                                                                                tmpCust@1000000001 : Record 18;
                                                                                tmpDate@1000000002 : Date;
                                                                              BEGIN
                                                                                tmpitem.GET(ItemNo);
                                                                                CustNo := '';
                                                                                LatsSP := 0;
                                                                                PUnitPrice:=0;
                                                                                //CustomerDivision.SETFILTER("Shortcut Dimension 5 Code",'%1','L');
                                                                                //IF CustomerDivision.FINDFIRST THEN
                                                                                  //REPEAT
                                                                                    //LastSalesPriceNew.RESET;
                                                                                    //LastSalesPriceNew.SETCURRENTKEY("Sell-to Customer No.");
                                                                                    //LastSalesPriceNew.SETCURRENTKEY("Sell-to Customer No.","Item No.","Document Date");
                                                                                    //LastSalesPriceNew.SETRANGE("Item No.",ItemNo);
                                                                                    //LastSalesPriceNew.SETRANGE("Sell-to Customer No.",CustomerDivision."Customer No.");
                                                                                    //IF LastSalesPriceNew.FINDSET THEN BEGIN
                                                                                     //IF LastSalesPriceNew.FINDLAST THEN BEGIN
                                                                                     IF PostUnitPrice = '' THEN
                                                                                       PostUnitPrice := FORMAT(0);
                                                                                     IF PreUnitPrice = '' THEN
                                                                                       PreUnitPrice := FORMAT(0);
                                                                                     //PostUnitPrice := COPYSTR(PostUnitPrice, 1, 15);
                                                                                     //PreUnitPrice := COPYSTR(PreUnitPrice, 1, 15);
                                                                                     //EVALUATE(LatsSP,DELCHR(PostUnitPrice, '=',' '));
                                                                                     //EVALUATE(PUnitPrice,DELCHR(PreUnitPrice, '=',' '));
                                                                                     EVALUATE(LatsSP,PostUnitPrice);
                                                                                     EVALUATE(PUnitPrice,PreUnitPrice);
                                                                                     {
                                                                                    StockStatusWkshLine.SETRANGE("Item No.",LastSalesPriceNew."Item No.");
                                                                                    StockStatusWkshLine.SETRANGE("Sell-to Customer No.",LastSalesPriceNew."Sell-to Customer No.");
                                                                                    StockStatusWkshLine.SETFILTER("Shortcut Dimension 5 Code",'%1','L');
                                                                                    IF StockStatusWkshLine.FINDFIRST THEN BEGIN
                                                                                      StockStatusWkshLine."Pre Increase Unit Price" := StockStatusWkshLine."Unit Price";
                                                                                      StockStatusWkshLine."Post Increase Unit Price" := LatsSP;
                                                                                      StockStatusWkshLine.MODIFY;
                                                                                    END;}

                                                                                    //IF CustNo <> LastSalesPriceNewCust."Sell-to Customer No." THEN BEGIN
                                                                                      LastSalesPriceNew1.INIT;
                                                                                      LastSalesPriceNew1."Document Type" := LastSalesPriceNew1."Document Type"::"Stock Status";
                                                                                      LastSalesPriceNew1."Document No." := 'Price_Inc_060119';

                                                                                      //EVALUATE(EItemNo,DELCHR(ItemNo,'=','"'));
                                                                                      //MESSAGE(EItemNo)
                                                                                      LastSalesPriceNew1."Item No." := ItemNo;
                                                                                      LastSalesPriceNew1."Sell-to Customer No." := CustomerNo; //LastSalesPriceNew."Sell-to Customer No.";

                                                                                      LastSalesPriceNew1."Unit of Measure Code" := tmpitem."Base Unit of Measure";
                                                                                      //LastSalesPriceNew1.INSERT(TRUE);
                                                                                      //CustNo := LastSalesPriceNewCust."Sell-to Customer No.";
                                                                                  //END;

                                                                                    LastSalesPriceNew1."Item Description" := tmpitem.Description;
                                                                                    LastSalesPriceNew1."Last Price UOM" := tmpitem."Base Unit of Measure";
                                                                                    LastSalesPriceNew1."Product Group Code" := tmpitem."Product Group Code";
                                                                                    LastSalesPriceNew1."Item Category Group" := tmpitem."Item Category Code";
                                                                                    LastSalesPriceNew1."Product Group Code" := tmpitem."Product Group Code";
                                                                                    EVALUATE(tmpDate,DocumentDate);
                                                                                    LastSalesPriceNew1."Document Date" := 060119D;//WORKDATE;//CALCDATE('-1D',WORKDATE);
                                                                                    LastSalesPriceNew1."Last Price Date" := tmpDate;
                                                                                    LastSalesPriceNew1."Last Price User ID" := USERID;
                                                                                    LastSalesPriceNew1."Price Increase" := TRUE;
                                                                                    LastSalesPriceNew1."Pre Increase Unit Price":=PUnitPrice;
                                                                                    LastSalesPriceNew1."Last Unit Price" := LatsSP; //((LastSalesPriceNewCust."Last Unit Price"*LatsSP)/100) + LastSalesPriceNewCust."Last Unit Price";
                                                                                    //LastQty := COPYSTR(LastQty, 1, 15);
                                                                                    //EVALUATE(LastSalesPriceNew1."Last Price Qty.",DELCHR(LastQty, '=',' '));
                                                                                    IF LastQty = '' THEN
                                                                                      LastQty := FORMAT(0);
                                                                                    EVALUATE(LastSalesPriceNew1."Last Price Qty.",LastQty);
                                                                                    LastSalesPriceNew1."Sell-to Customer Name" := CustomerNo;
                                                                                    LastSalesPriceNew1."Shortcut Dimension 5 Code" := 'L';
                                                                                    LastSalesPriceNew1."Country/Region Code" := 'US';
                                                                                    //LastSalesPriceNew1.MODIFY;
                                                                                    LastSalesPriceNew1.INSERT(TRUE);
                                                                                //END;
                                                                                    {
                                                                                   END ELSE BEGIN
                                                                                       EVALUATE(LatsSP,LastSalesPrice);
                                                                                       {
                                                                                    StockStatusWkshLine.RESET;
                                                                                    StockStatusWkshLine.SETFILTER("Item No.",'%1',ItemNo);
                                                                                    StockStatusWkshLine.SETRANGE("Sell-to Customer No.",CustomerDivision."Customer No.");
                                                                                    StockStatusWkshLine.SETFILTER("Shortcut Dimension 5 Code",'%1','L');
                                                                                    IF StockStatusWkshLine.FINDFIRST THEN BEGIN
                                                                                      StockStatusWkshLine."Pre Increase Unit Price" := StockStatusWkshLine."Unit Price";
                                                                                      StockStatusWkshLine."Post Increase Unit Price" := LatsSP;
                                                                                      StockStatusWkshLine.MODIFY;
                                                                                    END;
                                                                                    }
                                                                                    //IF CustNo <> LastSalesPriceNewCust."Sell-to Customer No." THEN BEGIN
                                                                                      LastSalesPriceNew1.INIT;
                                                                                      LastSalesPriceNew1."Document Type" := LastSalesPriceNew."Document Type"::"Stock Status";
                                                                                      LastSalesPriceNew1."Document No." := 'Price_Inc_120218';
                                                                                      LastSalesPriceNew1."Item No." := ItemNo;
                                                                                      LastSalesPriceNew1."Sell-to Customer No." :=CustomerDivision."Customer No.";
                                                                                      tmpitem.GET(ItemNo);
                                                                                      LastSalesPriceNew1."Unit of Measure Code" :=tmpitem."Base Unit of Measure";    //LastSalesPriceNew1.INSERT(TRUE);
                                                                                      //CustNo := LastSalesPriceNewCust."Sell-to Customer No.";
                                                                                  //END;
                                                                                    LastSalesPriceNew1."Item Description" :=tmpitem.Description;
                                                                                    //LastSalesPriceNew1."Last Price UOM" := LastSalesPriceNew."Last Price UOM";
                                                                                    LastSalesPriceNew1."Product Group Code" := tmpitem."Product Group Code";
                                                                                    LastSalesPriceNew1."Item Category Group" := tmpitem."Item Category Code";
                                                                                    LastSalesPriceNew1."Product Group Code" :=tmpitem."Product Group Code";
                                                                                    LastSalesPriceNew1."Document Date" := WORKDATE;
                                                                                    LastSalesPriceNew1."Last Price Date" := WORKDATE;
                                                                                    LastSalesPriceNew1."Last Price User ID" := USERID;
                                                                                    LastSalesPriceNew1."Price Increase" := TRUE;
                                                                                    LastSalesPriceNew1."Last Unit Price" := LatsSP; //((LastSalesPriceNewCust."Last Unit Price"*LatsSP)/100) + LastSalesPriceNewCust."Last Unit Price";

                                                                                    LastSalesPriceNew1."Sell-to Customer Name" :=CustomerDivision."Customer Name";

                                                                                    LastSalesPriceNew1."Shortcut Dimension 5 Code" := tmpitem."Shortcut Dimension 5 Code";
                                                                                    LastSalesPriceNew1."Country/Region Code" := tmpitem."Country/Region of Origin Code";
                                                                                    //LastSalesPriceNew1.MODIFY;
                                                                                    LastSalesPriceNew1.INSERT(TRUE);
                                                                                // UNTIL LastSalesPriceNew.NEXT = 0;
                                                                                    END;
                                                                                    UNTIL CustomerDivision.NEXT = 0;
                                                                                }
                                                                              END;
                                                                               }

    { [{09994CC3-7125-42AA-90EF-6825E0AB13B7}];2 ;CustomerNo          ;Element ;Text    ;
                                                  VariableName=CustomerNo;
                                                  MinOccurs=Zero }

    { [{33A6CDCA-FDE8-4BDD-B3F4-8EB2BEB4166D}];2 ;ItemNo              ;Element ;Text    ;
                                                  VariableName=ItemNo;
                                                  MinOccurs=Zero }

    { [{7296CF4F-6C58-4A88-981E-B6E3C37878FC}];2 ;PreUnitPrice        ;Element ;Text    ;
                                                  VariableName=PreUnitPrice;
                                                  DataType=Decimal;
                                                  MinOccurs=Zero }

    { [{410E7299-CFC9-47F8-A6F8-C1608823E989}];2 ;PostUnitPrice       ;Element ;Text    ;
                                                  VariableName=PostUnitPrice;
                                                  MinOccurs=Zero }

    { [{B94D1D84-02A9-4BCE-8503-97800630F41B}];2 ;InvoiceNo           ;Element ;Text    ;
                                                  VariableName=InvoiceNo;
                                                  MinOccurs=Zero }

    { [{6098EFE7-16E1-4ED1-B303-EBB9C500CC36}];2 ;DocumentDate        ;Element ;Text    ;
                                                  VariableName=DocumentDate;
                                                  MinOccurs=Zero }

    { [{09476F61-D9EC-46C0-9694-AE7155EB7CBB}];2 ;LastQty             ;Element ;Text    ;
                                                  VariableName=LastQty;
                                                  MinOccurs=Zero }

  }
  EVENTS
  {
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      DocumentDate1@1000000000 : Date;
      LastPriceDate1@1000000001 : Date;
      LastSalesPriceNew@1000000002 : Record 50004;
      LastSalesPriceNew1@1000000003 : Record 50004;
      LastSalesPriceNewCust@1000000004 : Record 50004;
      CustNo@1000000005 : Code[20];
      LatsSP@1000000006 : Decimal;
      PUnitPrice@1000000009 : Decimal;
      StockStatusWkshLine@1000000007 : Record 50000;
      CustomerDivision@1000000008 : Record 50007;
      EItemNo@1000000010 : Code[50];

    BEGIN
    END.
  }
}

